<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>PlantWatertoWaterGSHP.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>PlantWatertoWaterGSHP.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 0.5% of total for source files.">1954 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/PlantWatertoWaterGSHP.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">PlantWatertoWaterGSHP.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/heatpumpwatertowaterheating.html">HeatPumpWaterToWaterHEATING</a>

      <a class="list-group-item" href="../module/heatpumpwatertowatercooling.html">HeatPumpWaterToWaterCOOLING</a>

      <a class="list-group-item" href="../module/heatpumpwatertowatersimple.html">HeatPumpWaterToWaterSimple</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html#src">PlantWatertoWaterGSHP.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~plantwatertowatergshp.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileplantwatertowatergshpf90EfferentGraph" width="641pt" height="824pt"
 viewBox="0.00 0.00 641.00 824.26" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph" class="graph" transform="scale(.2825 .2825) rotate(0) translate(4 2914.1928)">
<title>sourcefile~~plantwatertowatergshp.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2914.1928 2265.3826,-2914.1928 2265.3826,4 -4,4"/>
<!-- sourcefile~plantwatertowatergshp.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~plantwatertowatergshp.f90</title>
<polygon fill="none" stroke="#000000" points="2261.3048,-2455.9369 2115.6161,-2455.9369 2115.6161,-2433.926 2261.3048,-2433.926 2261.3048,-2455.9369"/>
<text text-anchor="middle" x="2188.4604" y="-2441.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">PlantWatertoWaterGSHP.f90</text>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="846.1377,-2438.9369 745.8318,-2438.9369 745.8318,-2416.926 846.1377,-2416.926 846.1377,-2438.9369"/>
<text text-anchor="middle" x="795.9847" y="-2424.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M815.574,-2439.0278C914.5704,-2494.2381 1371.204,-2738.6032 1781.1273,-2786.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1781.1273,-2786.9315C1982.8453,-2796.1149 2137.1694,-2540.0513 2177.8759,-2465.2009"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2181.0309,-2466.7232 2182.6658,-2456.2553 2174.8598,-2463.419 2181.0309,-2466.7232"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1956.0678,-2190.9369 1880.815,-2190.9369 1880.815,-2168.926 1956.0678,-2168.926 1956.0678,-2190.9369"/>
<text text-anchor="middle" x="1918.4414" y="-2176.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M846.2276,-2425.2931C958.1123,-2419.6529 1236.2989,-2406.9315 1469.339,-2406.9315 1469.339,-2406.9315 1469.339,-2406.9315 1622.2083,-2406.9315 1757.8758,-2406.9315 1869.7902,-2255.0712 1906.0477,-2199.7688"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1909.1012,-2201.4915 1911.5707,-2191.1884 1903.2152,-2197.7027 1909.1012,-2201.4915"/>
</g>
<!-- sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~plantutilities.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/plantutilities.f90.html" xlink:title="PlantUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2079.6809,-2455.9369 1992.1116,-2455.9369 1992.1116,-2433.926 2079.6809,-2433.926 2079.6809,-2455.9369"/>
<text text-anchor="middle" x="2035.8962" y="-2441.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M846.3108,-2432.6886C1002.9651,-2447.9969 1479.918,-2498.522 1622.2083,-2558.9315"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1681.5438,-1542.9369 1562.8727,-1542.9369 1562.8727,-1520.926 1681.5438,-1520.926 1681.5438,-1542.9369"/>
<text text-anchor="middle" x="1622.2083" y="-1528.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M1145.9073,-2292.9315C1463.3935,-2136.898 1592.3126,-1659.3592 1617.47,-1553.0533"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1620.9072,-1553.7245 1619.7549,-1543.1925 1614.0878,-1552.1444 1620.9072,-1553.7245"/>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M823.5078,-2416.8607C882.3708,-2393.284 1024.9818,-2336.6967 1145.9073,-2292.9315"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1052.9524,-1772.9369 906.4431,-1772.9369 906.4431,-1750.926 1052.9524,-1750.926 1052.9524,-1772.9369"/>
<text text-anchor="middle" x="979.6978" y="-1758.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M835.1953,-2416.8009C848.6034,-2410.9912 862.2939,-2402.4037 870.5706,-2389.9315 931.9213,-2297.4804 874.6,-1998.1811 906.5706,-1891.9315 919.3398,-1849.4948 947.7167,-1805.6997 965.1273,-1781.3272"/>
<polygon fill="#b600ff" stroke="#b600ff" points="968.1485,-1783.1241 971.2077,-1772.9805 962.4906,-1779.0024 968.1485,-1783.1241"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1844.63,-2038.9369 1717.6246,-2038.9369 1717.6246,-2016.926 1844.63,-2016.926 1844.63,-2038.9369"/>
<text text-anchor="middle" x="1781.1273" y="-2024.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-2292.9315C1150.1285,-2291.0798 1302.9206,-2255.8454 1307.4386,-2254.9315"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1029.0877,-2112.9369 930.3078,-2112.9369 930.3078,-2090.926 1029.0877,-2090.926 1029.0877,-2112.9369"/>
<text text-anchor="middle" x="979.6978" y="-2098.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M830.9648,-2416.8139C844.9612,-2410.8156 860.1916,-2402.0899 870.5706,-2389.9315 904.243,-2350.486 888.6551,-2327.6019 906.5706,-2278.9315 927.7124,-2221.4958 956.2597,-2155.1428 970.6313,-2122.3932"/>
<polygon fill="#ff0000" stroke="#ff0000" points="973.9431,-2123.5572 974.772,-2112.9948 967.5372,-2120.7349 973.9431,-2123.5572"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1029.825,-1922.9369 929.5705,-1922.9369 929.5705,-1900.926 1029.825,-1900.926 1029.825,-1922.9369"/>
<text text-anchor="middle" x="979.6978" y="-1908.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1030.177,-1901.5164C1140.8914,-1880.9001 1411.9389,-1842.6632 1622.2083,-1912.9315"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M985.1378,-1923.0564C1008.8925,-1970.6453 1108.2131,-2159.6291 1238.9897,-2268.9315 1271.1512,-2295.8118 1881.1422,-2616.0542 1918.4414,-2596.9315"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M1469.339,-1722.9315C1536.3944,-1675.3454 1589.4542,-1590.5024 1611.3386,-1551.9652"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1614.4042,-1553.6541 1616.2203,-1543.2161 1608.2913,-1550.2433 1614.4042,-1553.6541"/>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M998.9668,-1900.8819C1041.2509,-1876.9994 1145.8402,-1819.9069 1238.9897,-1784.9315 1338.2447,-1747.6636 1382.8771,-1784.2894 1469.339,-1722.9315"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="829.3535,-1618.9369 762.616,-1618.9369 762.616,-1596.926 829.3535,-1596.926 829.3535,-1618.9369"/>
<text text-anchor="middle" x="795.9847" y="-1604.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1608.9315C1055.1936,-1615.453 1070.1308,-1647.1695 1145.9073,-1646.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1646.9315C1216.9904,-1646.7081 1747.7324,-1508.181 1781.1273,-1570.9315"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M802.7411,-1619.1115C830.029,-1664.2663 932.3316,-1833.5521 967.6319,-1891.9655"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="964.7123,-1893.9014 972.88,-1900.6498 970.7033,-1890.2809 964.7123,-1893.9014"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1145.9073,-1646.9315C1217.6987,-1646.7059 1236.1255,-1638.6563 1307.4386,-1646.9315"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M1918.4414,-2596.9315C1974.4211,-2568.9992 2011.429,-2500.3831 2027.2098,-2465.7074"/>
<polygon fill="#0091ff" stroke="#0091ff" points="2030.6048,-2466.6814 2031.4233,-2456.1183 2024.1961,-2463.8654 2030.6048,-2466.6814"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M827.5833,-1618.9992C878.9716,-1638.1117 982.0217,-1681.178 1052.825,-1741.9315 1155.138,-1829.7221 1314.2351,-2137.9843 1411.8875,-2230.9315 1578.8759,-2389.874 1669.0186,-2367.5697 1844.6287,-2516.9315 1881.4799,-2548.2746 1875.1532,-2618.5311 1918.4414,-2596.9315"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M979.6978,-1608.9315C1128.7667,-1620.6348 1164.1472,-1490.1986 1307.4386,-1532.9315"/>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M829.6217,-1606.086C866.5479,-1604.5319 927.5276,-1603.3545 979.6978,-1608.9315"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M812.3511,-1619.0002C828.5767,-1630.5624 853.4255,-1649.9185 870.5706,-1670.9315 891.6941,-1696.8205 881.024,-1715.395 906.5706,-1736.9315 911.0393,-1740.6987 916.1047,-1743.9078 921.4343,-1746.6395"/>
<polygon fill="#b600ff" stroke="#b600ff" points="920.0421,-1749.8513 930.5943,-1750.8005 922.9372,-1743.478 920.0421,-1749.8513"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1034.8358,-1312.9369 924.5597,-1312.9369 924.5597,-1290.926 1034.8358,-1290.926 1034.8358,-1312.9369"/>
<text text-anchor="middle" x="979.6978" y="-1298.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M802.7411,-1596.6779C830.0903,-1551.1239 932.7917,-1380.0601 967.8689,-1321.6341"/>
<polygon fill="#ff006d" stroke="#ff006d" points="970.9271,-1323.3398 973.0737,-1312.9647 964.9257,-1319.7367 970.9271,-1323.3398"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1608.9315C1021.5518,-1613.4056 1267.0427,-1787.1015 1307.4386,-1798.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1622.2083,-1950.9315C1667.6814,-1970.3744 1718.9472,-1995.8879 1750.6499,-2012.1015"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1749.3381,-2015.3624 1759.8326,-2016.8178 1752.5363,-2009.1357 1749.3381,-2015.3624"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1798.9315C1428.2134,-1838.0429 1447.0962,-1874.6717 1562.7905,-1926.9315 1588.7462,-1938.6558 1596.0208,-1939.7345 1622.2083,-1950.9315"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M799.4041,-1618.95C812.3376,-1660.3953 859.9021,-1810.7384 906.5706,-1931.9315 927.7192,-1986.8522 956.0428,-2050.2152 970.4458,-2081.8206"/>
<polygon fill="#ff0000" stroke="#ff0000" points="967.2634,-2083.2776 974.6062,-2090.9153 973.6289,-2080.3656 967.2634,-2083.2776"/>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1203.0723,-1047.9369 1088.7424,-1047.9369 1088.7424,-1025.926 1203.0723,-1025.926 1203.0723,-1047.9369"/>
<text text-anchor="middle" x="1145.9073" y="-1033.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M799.2727,-1596.8389C809.7359,-1561.5258 843.1826,-1448.5455 870.5706,-1354.9315 886.6843,-1299.8535 873.3386,-1277.7168 906.5706,-1230.9315 952.759,-1165.9055 991.4802,-1177.9076 1052.825,-1126.9315 1080.6596,-1103.8015 1110.2997,-1074.1676 1128.4651,-1055.359"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1131.1152,-1057.6522 1135.509,-1048.0114 1126.0621,-1052.8079 1131.1152,-1057.6522"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1523.0647,-1007.9369 1415.6133,-1007.9369 1415.6133,-985.926 1523.0647,-985.926 1523.0647,-1007.9369"/>
<text text-anchor="middle" x="1469.339" y="-993.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1145.9073,-1494.9315C1207.2079,-1457.5646 1250.9584,-1539.2488 1307.4386,-1494.9315"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1195.4562,-1466.9369 1096.3585,-1466.9369 1096.3585,-1444.926 1195.4562,-1444.926 1195.4562,-1466.9369"/>
<text text-anchor="middle" x="1145.9073" y="-1452.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M829.6741,-1597.4804C842.5762,-1593.2591 857.3623,-1588.1539 870.5706,-1582.9315 920.1828,-1563.3153 929.7743,-1551.7415 979.6978,-1532.9315"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M979.6978,-1532.9315C1011.7076,-1520.8709 1022.6286,-1525.0022 1052.825,-1508.9315 1070.7184,-1499.4084 1071.4074,-1491.2993 1088.825,-1480.9315 1094.6963,-1477.4365 1101.1449,-1474.1445 1107.5285,-1471.1679"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1109.0561,-1474.3189 1116.7601,-1467.0456 1106.202,-1467.9272 1109.0561,-1474.3189"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1375.8363,-1122.9369 1239.0409,-1122.9369 1239.0409,-1100.926 1375.8363,-1100.926 1375.8363,-1122.9369"/>
<text text-anchor="middle" x="1307.4386" y="-1108.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1145.9073,-1494.9315C1168.7384,-1481.0144 1184.4828,-1495.2301 1202.9897,-1475.9315 1251.8065,-1425.0264 1292.1633,-1203.7665 1303.9508,-1133.4603"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1307.4727,-1133.6142 1305.6503,-1123.1773 1300.5664,-1132.4727 1307.4727,-1133.6142"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M979.6978,-1532.9315C1050.6084,-1506.214 1081.2038,-1534.3726 1145.9073,-1494.9315"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1201.7241,-703.9369 1090.0905,-703.9369 1090.0905,-681.926 1201.7241,-681.926 1201.7241,-703.9369"/>
<text text-anchor="middle" x="1145.9073" y="-689.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M800.1505,-1596.5155C812.8772,-1561.1602 851.5361,-1450.1274 870.5706,-1354.9315 899.6713,-1209.3918 852.9396,-1161.3235 906.5706,-1022.9315 946.3619,-920.2517 994.1227,-916.1009 1052.825,-822.9315 1070.845,-794.3309 1069.3323,-783.5495 1088.825,-755.9315 1100.135,-739.9069 1115.0848,-723.5426 1126.8478,-711.5095"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1129.4746,-713.8317 1134.0473,-704.2745 1124.5127,-708.8941 1129.4746,-713.8317"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="658.8752,-1651.9369 543.4891,-1651.9369 543.4891,-1629.926 658.8752,-1629.926 658.8752,-1651.9369"/>
<text text-anchor="middle" x="601.1821" y="-1637.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M604.7619,-1629.6243C621.4778,-1576.9607 692.2622,-1355.4816 721.3989,-1288.9315 790.7223,-1130.5922 758.0742,-1035.3955 906.5706,-946.9315 953.0242,-919.2575 1572.9147,-854.1544 1622.2083,-957.9315"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M659.1019,-1631.1197C689.0359,-1626.0488 724.9586,-1619.9635 752.4918,-1615.2993"/>
<polygon fill="#ffda00" stroke="#ffda00" points="753.3285,-1618.7075 762.6034,-1613.5863 752.1593,-1611.8058 753.3285,-1618.7075"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M659.2345,-1645.7827C669.1429,-1649.0941 678.4596,-1654.1886 685.3989,-1661.9315 764.7268,-1750.4453 633.4929,-1846.9306 721.3989,-1926.9315 769.5974,-1970.7955 1243.2037,-1939.9305 1307.4386,-1950.9315"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1918.9606,-2168.6048C1921.7989,-2119.2219 1939.1205,-1926.293 2035.8962,-1950.9315"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M1923.3388,-2190.9808C1941.248,-2231.3875 2003.36,-2371.5238 2026.8249,-2424.4648"/>
<polygon fill="#0091ff" stroke="#0091ff" points="2023.7261,-2426.111 2030.978,-2433.835 2030.1256,-2423.2745 2023.7261,-2426.111"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-811.9369 -.2403,-811.9369 -.2403,-789.926 130.719,-789.926 130.719,-811.9369"/>
<text text-anchor="middle" x="65.2394" y="-797.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-160.9315C264.4198,-133.3145 271.9118,-120.8559 317.2024,-101.9315 351.6729,-87.5282 363.4998,-94.3089 399.0839,-82.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1622.2083,-957.9315C1731.4454,-1217.319 1649.5332,-1322.1391 1781.1273,-1570.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-44.9315C1011.0862,-55.4097 1020.5367,-51.6858 1052.825,-58.9315 1094.5112,-68.2861 1103.3228,-79.4952 1145.9073,-82.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-82.9315C645.4023,-4.1751 734.4019,36.9545 979.6978,-44.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1781.1273,-1570.9315C1802.1179,-1610.6164 1874.9009,-1939.9897 1918.4414,-1950.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M66.0596,-789.7451C72.123,-710.6299 112.8812,-236.4471 223.8406,-160.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1918.4414,-1950.9315C1969.0694,-1963.6544 1985.3079,-1938.052 2035.8962,-1950.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-82.9315C1320.2469,-96.9996 1417.125,-45.6756 1526.7905,-181.9315 1744.6632,-452.6311 1487.3413,-637.6852 1622.2083,-957.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2035.8962,-1950.9315C2132.9686,-1975.6454 2176.7426,-2332.7576 2186.3684,-2423.887"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2182.8892,-2424.2698 2187.396,-2433.8582 2189.8523,-2423.5521 2182.8892,-2424.2698"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1950.9315C332.8808,-2112.2277 178.3568,-2242.4465 317.2024,-2378.9315 375.0441,-2435.7898 620.5097,-2434.5903 735.7601,-2430.6907"/>
<polygon fill="#ff0000" stroke="#ff0000" points="735.9617,-2434.1858 745.8307,-2430.3317 735.7123,-2427.1903 735.9617,-2434.1858"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M223.8406,-1950.9315C256.1753,-1998.6413 263.7549,-2019.3646 317.2024,-2040.9315 469.6405,-2102.4425 524.0934,-2037.5782 685.3989,-2005.9315 768.1138,-1989.7035 790.9649,-1992.6448 870.5706,-1964.9315 898.9868,-1955.0389 929.6716,-1939.6824 951.244,-1928.0409"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="953.0941,-1931.0182 960.1854,-1923.1465 949.733,-1924.8779 953.0941,-1931.0182"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M399.0839,-1874.9315C523.086,-1836.7464 590.6782,-1906.6029 685.3989,-1817.9315 730.4182,-1775.7873 690.7987,-1737.4711 721.3989,-1683.9315 734.5228,-1660.9694 756.2715,-1639.9367 772.9068,-1625.848"/>
<polygon fill="#ffda00" stroke="#ffda00" points="775.5646,-1628.194 781.0671,-1619.14 771.1195,-1622.7865 775.5646,-1628.194"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M223.8406,-1950.9315C256.1099,-1998.6856 273.5484,-1898.5624 317.2024,-1860.9315 386.7596,-1800.9712 422.7528,-1805.9579 480.9653,-1734.9315 503.8964,-1706.9528 488.8026,-1684.6362 516.9653,-1661.9315 521.9694,-1657.8972 527.644,-1654.6243 533.6269,-1651.9711"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="535.1445,-1655.1378 543.2301,-1648.2914 532.6398,-1648.6013 535.1445,-1655.1378"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M979.6978,-2824.9315C1121.9168,-2793.446 1162.7426,-2841.6848 1307.4386,-2824.9315"/>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1307.4386,-2824.9315C1443.8125,-2811.2763 1763.3413,-2632.2794 1844.6287,-2521.9315 1883.0266,-2469.8062 1908.657,-2267.3571 1916.1587,-2201.0717"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1919.653,-2201.3153 1917.2776,-2190.9902 1912.6958,-2200.5431 1919.653,-2201.3153"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="868.5702,-2380.9369 723.3993,-2380.9369 723.3993,-2358.926 868.5702,-2358.926 868.5702,-2380.9369"/>
<text text-anchor="middle" x="795.9847" y="-2366.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M399.0839,-2330.9315C412.3627,-2338.856 600.4432,-2354.7165 712.8557,-2363.5751"/>
<polygon fill="#00ff91" stroke="#00ff91" points="712.9115,-2367.0902 723.1548,-2364.3838 713.4596,-2360.1116 712.9115,-2367.0902"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-1247.9369 180.0456,-1247.9369 180.0456,-1225.926 267.6355,-1225.926 267.6355,-1247.9369"/>
<text text-anchor="middle" x="223.8406" y="-1233.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M67.0435,-812.1244C74.5618,-857.0109 105.8722,-1027.6784 166.4788,-1154.9315 177.5094,-1178.092 194.8985,-1201.815 207.6415,-1217.7465"/>
<polygon fill="#00ffff" stroke="#00ffff" points="205.1363,-1220.2122 214.1731,-1225.7428 210.5576,-1215.7839 205.1363,-1220.2122"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M1307.4386,-2824.9315C1379.2393,-2820.211 1397.4184,-2827.1809 1469.339,-2824.9315"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M979.6978,-44.9315C1056.7452,-70.6519 1065.2323,-111.4769 1145.9073,-120.9315"/>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M1145.9073,-120.9315C1335.1957,-143.1149 1435.3998,-150.6894 1526.7905,-317.9315 1561.6891,-381.7948 1556.9493,-899.3896 1562.7905,-971.9315 1579.7361,-1182.3775 1610.3727,-1436.2598 1619.5444,-1510.5512"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1616.1233,-1511.4048 1620.8267,-1520.8984 1623.0702,-1510.5438 1616.1233,-1511.4048"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-1961.9369 350.2841,-1961.9369 350.2841,-1939.926 447.8836,-1939.926 447.8836,-1961.9369"/>
<text text-anchor="middle" x="399.0839" y="-1947.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M223.8406,-1950.9315C252.3422,-1994.2161 320.505,-1979.8971 362.928,-1965.4691"/>
<polygon fill="#4800ff" stroke="#4800ff" points="364.3533,-1968.6769 372.601,-1962.0266 362.0063,-1962.0821 364.3533,-1968.6769"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="650.7412,-1370.9369 551.623,-1370.9369 551.623,-1348.926 650.7412,-1348.926 650.7412,-1370.9369"/>
<text text-anchor="middle" x="601.1821" y="-1356.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M65.4769,-812.1355C67.9156,-918.4124 91.1115,-1749.359 223.8406,-1950.9315"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M223.8406,-1950.9315C312.1436,-2085.0352 231.4751,-1737.6962 317.2024,-1601.9315 384.6888,-1495.0544 514.2924,-1410.5029 572.1035,-1376.3403"/>
<polygon fill="#ff00da" stroke="#ff00da" points="574.1957,-1379.1717 581.068,-1371.1081 570.6671,-1373.1261 574.1957,-1379.1717"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M223.8406,-1140.9315C238.1066,-1151.1716 734.8328,-1252.3953 915.1382,-1288.8955"/>
<polygon fill="#ff006d" stroke="#ff006d" points="914.5242,-1292.3421 925.0198,-1290.8952 915.9127,-1285.4812 914.5242,-1292.3421"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="647.8111,-476.9369 554.5531,-476.9369 554.5531,-454.926 647.8111,-454.926 647.8111,-476.9369"/>
<text text-anchor="middle" x="601.1821" y="-462.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-479.9315C276.019,-448.1959 452.126,-455.2394 544.1294,-461.4249"/>
<polygon fill="#ff0000" stroke="#ff0000" points="544.1624,-464.9354 554.3801,-462.1339 544.6455,-457.9521 544.1624,-464.9354"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-1632.9369 344.7839,-1632.9369 344.7839,-1610.926 453.3838,-1610.926 453.3838,-1632.9369"/>
<text text-anchor="middle" x="399.0839" y="-1618.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M223.8406,-1950.9315C301.5702,-2068.9776 217.1786,-1746.7915 317.2024,-1646.9315 322.4091,-1641.7333 328.6636,-1637.6107 335.3661,-1634.342"/>
<polygon fill="#7fff00" stroke="#7fff00" points="336.8738,-1637.5047 344.7272,-1630.3932 334.1531,-1631.0551 336.8738,-1637.5047"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="669.6908,-1808.9369 532.6734,-1808.9369 532.6734,-1786.926 669.6908,-1786.926 669.6908,-1808.9369"/>
<text text-anchor="middle" x="601.1821" y="-1794.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1950.9315C247.6135,-1986.0973 358.5163,-1887.4238 399.0839,-1874.9315"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-1874.9315C453.8106,-1858.079 463.2138,-1842.6746 516.9653,-1822.9315 527.706,-1818.9864 539.3842,-1815.2065 550.5281,-1811.8338"/>
<polygon fill="#00ffff" stroke="#00ffff" points="551.5547,-1815.1801 560.1466,-1808.9808 549.5641,-1808.469 551.5547,-1815.1801"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-432.9369 168.8556,-432.9369 168.8556,-410.926 278.8255,-410.926 278.8255,-432.9369"/>
<text text-anchor="middle" x="223.8406" y="-418.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M66.1443,-789.7491C70.2387,-745.0247 90.2845,-576.1245 166.4788,-465.9315 173.9516,-455.1242 184.9052,-445.7978 195.243,-438.5484"/>
<polygon fill="#ff0000" stroke="#ff0000" points="197.2818,-441.3963 203.692,-432.9606 193.4203,-435.5576 197.2818,-441.3963"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-442.9369 340.6161,-442.9369 340.6161,-420.926 457.5516,-420.926 457.5516,-442.9369"/>
<text text-anchor="middle" x="399.0839" y="-428.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-479.9315C256.22,-460.2379 296.8041,-448.457 330.7606,-441.4994"/>
<polygon fill="#00ffff" stroke="#00ffff" points="331.4642,-444.9282 340.6084,-439.577 330.123,-438.0579 331.4642,-444.9282"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M66.5624,-789.8955C72.96,-742.0784 105.4082,-551.9636 223.8406,-479.9315"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1950.9315C331.3175,-2107.6419 178.0085,-2671.5695 317.2024,-2800.9315 533.0239,-3001.5085 689.0729,-2873.3801 979.6978,-2824.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-2824.9315C1294.9993,-2735.9785 1299.5256,-2566.8941 1526.7905,-2330.9315 1572.6253,-2283.3425 1566.2534,-2252.0683 1622.2083,-2216.9315"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-2456.9369 358.7923,-2456.9369 358.7923,-2434.926 439.3754,-2434.926 439.3754,-2456.9369"/>
<text text-anchor="middle" x="399.0839" y="-2442.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1950.9315C340.9637,-2128.8036 174.3433,-2262.9833 317.2024,-2420.9315 325.459,-2430.0602 336.9422,-2435.8989 348.7004,-2439.621"/>
<polygon fill="#00ffff" stroke="#00ffff" points="348.0115,-2443.06 358.5772,-2442.2754 349.8283,-2436.2999 348.0115,-2443.06"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1950.9315C328.5454,-2104.6408 235.4121,-2242.607 399.0839,-2330.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2330.9315C451.0305,-2358.9642 835.1943,-2173.368 948.3948,-2117.502"/>
<polygon fill="#ff0000" stroke="#ff0000" points="950.1748,-2120.5264 957.5873,-2112.9563 947.072,-2114.2516 950.1748,-2120.5264"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1526.7421,-2170.9369 1411.9359,-2170.9369 1411.9359,-2148.926 1526.7421,-2148.926 1526.7421,-2170.9369"/>
<text text-anchor="middle" x="1469.339" y="-2156.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-2330.9315C444.0168,-2357.9977 821.4035,-2325.2112 870.5706,-2306.9315 889.5697,-2299.8678 888.1861,-2287.4681 906.5706,-2278.9315 994.3164,-2238.1876 1271.6057,-2190.9522 1401.2651,-2170.3903"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1402.136,-2173.7962 1411.4676,-2168.7791 1401.044,-2166.8819 1402.136,-2173.7962"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-1084.9369 334.3841,-1084.9369 334.3841,-1062.926 463.7837,-1062.926 463.7837,-1084.9369"/>
<text text-anchor="middle" x="399.0839" y="-1070.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1140.9315C260.8035,-1167.4635 274.6121,-1114.94 317.2024,-1098.9315 327.535,-1095.0477 338.7636,-1091.3134 349.4988,-1087.9686"/>
<polygon fill="#ff0000" stroke="#ff0000" points="350.6368,-1091.2807 359.179,-1085.0133 348.5928,-1084.5858 350.6368,-1091.2807"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M66.584,-812.2018C73.0721,-861.1016 105.843,-1056.2328 223.8406,-1140.9315"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-479.9315C262.5754,-455.7114 273.9504,-508.2255 317.2024,-522.9315 556.0123,-604.1288 680.8795,-482.6772 870.5706,-648.9315 905.1525,-679.2408 884.8397,-705.4057 906.5706,-745.9315 958.7798,-843.2962 993.4477,-853.7648 1052.825,-946.9315 1070.5736,-974.7802 1064.4135,-989.6907 1088.825,-1011.9315 1092.675,-1015.4391 1097.0956,-1018.5116 1101.736,-1021.1886"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1100.3437,-1024.408 1110.8386,-1025.8594 1103.5395,-1018.18 1100.3437,-1024.408"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M979.6978,-44.9315C1039.4444,-64.4937 1037.8916,-98.0785 1088.825,-134.9315 1181.9137,-202.2861 1231.1767,-186.988 1307.4386,-272.9315"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1307.4386,-272.9315C1407.2156,-383.2022 1347.4652,-799.8984 1411.8875,-933.9315 1420.2512,-951.3327 1435.0058,-967.356 1447.468,-978.8884"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1445.4351,-981.764 1455.2362,-985.7877 1450.0835,-976.5302 1445.4351,-981.764"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="870.6565,-132.9369 721.313,-132.9369 721.313,-110.926 870.6565,-110.926 870.6565,-132.9369"/>
<text text-anchor="middle" x="795.9847" y="-118.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-82.9315C524.7107,-43.752 682.5699,-84.2446 755.5567,-107.7039"/>
<polygon fill="#00ffff" stroke="#00ffff" points="754.6872,-111.102 765.2799,-110.891 756.8676,-104.4503 754.6872,-111.102"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M223.8406,-1950.9315C282.7192,-2037.3668 241.1809,-1806.7542 317.2024,-1734.9315 373.5476,-1681.6983 425.0381,-1728.6036 480.9653,-1674.9315 511.1576,-1645.9566 484.7627,-1614.6541 516.9653,-1587.9315 560.9322,-1551.4466 937.1969,-1488.8392 1085.8465,-1465.2703"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1086.8175,-1468.6603 1096.1482,-1463.6417 1085.7244,-1461.7462 1086.8175,-1468.6603"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-1140.9315C265.605,-1170.5986 1095.3447,-1159.1672 1145.9073,-1150.9315"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="470.9214,-132.9369 327.2463,-132.9369 327.2463,-110.926 470.9214,-110.926 470.9214,-132.9369"/>
<text text-anchor="middle" x="399.0839" y="-118.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-160.9315C251.1395,-142.3078 285.8856,-132.4209 317.2275,-127.2284"/>
<polygon fill="#0000ff" stroke="#0000ff" points="317.9095,-130.665 327.2701,-125.7023 316.8578,-123.7445 317.9095,-130.665"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M223.8406,-160.9315C283.8121,-120.0182 802.6423,-228.3144 870.5706,-253.9315 961.0874,-288.0672 995.2298,-295.2053 1052.825,-372.9315 1123.575,-468.4106 1140.7153,-616.6655 1144.7273,-671.5518"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1141.252,-672.0446 1145.3987,-681.7942 1148.237,-671.5866 1141.252,-672.0446"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.0438,-1276.9369 353.1239,-1276.9369 353.1239,-1254.926 445.0438,-1254.926 445.0438,-1276.9369"/>
<text text-anchor="middle" x="399.0839" y="-1262.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1140.9315C273.2362,-1176.3877 265.6225,-1208.7354 317.2024,-1240.9315 325.2503,-1245.9549 334.3751,-1250.0275 343.5397,-1253.3111"/>
<polygon fill="#ff0000" stroke="#ff0000" points="342.4678,-1256.643 353.061,-1256.4542 344.6621,-1249.9958 342.4678,-1256.643"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-248.9369 323.0941,-248.9369 323.0941,-226.926 475.0737,-226.926 475.0737,-248.9369"/>
<text text-anchor="middle" x="399.0839" y="-234.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-160.9315C249.7355,-143.2657 332.6361,-193.4547 374.4595,-221.0824"/>
<polygon fill="#ff0000" stroke="#ff0000" points="372.7043,-224.1189 382.9637,-226.7638 376.5929,-218.2984 372.7043,-224.1189"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-326.9369 317.3208,-326.9369 317.3208,-304.926 480.847,-304.926 480.847,-326.9369"/>
<text text-anchor="middle" x="399.0839" y="-312.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-160.9315C273.2695,-127.2104 271.8409,-218.9101 317.2024,-257.9315 334.8083,-273.0766 356.2824,-288.1766 372.8215,-299.1714"/>
<polygon fill="#00ffff" stroke="#00ffff" points="371.1656,-302.271 381.4464,-304.8315 375.0062,-296.4187 371.1656,-302.271"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-2292.9315C1027.8672,-2284.5191 1040.026,-2303.814 1088.825,-2306.9315 1353.9081,-2323.8659 1448.5575,-2358.348 1681.626,-2230.9315 1777.1963,-2178.684 1775.3753,-2131.9996 1844.6287,-2047.9315 1879.0734,-2006.1183 1866.6897,-1934.9146 1918.4414,-1950.9315"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M868.7396,-2374.7249C1002.7176,-2385.3754 1295.8674,-2417.229 1526.7905,-2502.9315 1572.8901,-2520.0404 1578.1245,-2537.1482 1622.2083,-2558.9315"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M1622.2083,-2558.9315C1694.1424,-2589.8364 1702.8475,-2636.3122 1781.1273,-2634.9315"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M1781.1273,-2634.9315C1844.4397,-2633.8148 1861.781,-2625.2035 1918.4414,-2596.9315"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-2292.9315C1123.4583,-2264.0224 1163.0096,-2280.291 1307.4386,-2254.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-2254.9315C1379.8826,-2240.2777 1395.4278,-2216.9315 1469.339,-2216.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M834.124,-2358.812C845.9971,-2354.9106 859.0034,-2350.177 870.5706,-2344.9315 887.4403,-2337.2814 890.01,-2332.2297 906.5706,-2323.9315 938.1308,-2308.1171 944.9234,-2299.0045 979.6978,-2292.9315"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M803.6448,-2358.757C831.832,-2317.6375 930.0244,-2174.3948 966.1901,-2121.6364"/>
<polygon fill="#ff0000" stroke="#ff0000" points="969.2378,-2123.3807 972.005,-2113.1536 963.4641,-2119.4228 969.2378,-2123.3807"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M234.7163,-1225.8861C248.4379,-1211.1383 271.4233,-1183.5361 281.2024,-1154.9315 307.9395,-1076.7231 271.0564,-480.5023 317.2024,-411.9315 362.0013,-345.3624 414.8848,-381.4479 480.9653,-335.9315 603.7666,-251.3455 584.5417,-161.1347 721.3989,-101.9315 894.7347,-26.9479 957.3538,-72.1893 1145.9073,-82.9315"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.7689,-1248.2301C234.3403,-1364.6884 314.7498,-2342.2541 317.2024,-2344.9315 345.2617,-2375.5627 613.5618,-2408.1917 735.817,-2421.6121"/>
<polygon fill="#ff0000" stroke="#ff0000" points="735.4522,-2425.093 745.7728,-2422.6979 736.2112,-2418.1342 735.4522,-2425.093"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M399.0839,-2026.9315C408.5132,-2036.0598 772.8352,-1957.3414 919.4732,-1925.203"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="920.6292,-1928.5327 929.647,-1922.9713 919.1293,-1921.6952 920.6292,-1928.5327"/>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M224.0279,-1248.0757C225.5856,-1330.1992 238.3889,-1842.0168 317.2024,-1970.9315 340.1993,-2008.5474 368.1598,-1995.5066 399.0839,-2026.9315"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M399.0839,-1660.9315C431.0931,-1680.1949 446.2446,-1655.7206 480.9653,-1641.9315 498.1807,-1635.0945 499.7292,-1627.7158 516.9653,-1620.9315 552.6695,-1606.878 562.9379,-1605.0404 601.1821,-1601.9315"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M224.8609,-1248.3176C230.4321,-1307.9474 259.0788,-1583.724 317.2024,-1641.9315 343.5999,-1668.3671 367.0746,-1641.6681 399.0839,-1660.9315"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M399.0839,-1660.9315C422.7321,-1675.1632 493.044,-1664.507 544.0983,-1654.0815"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="544.9595,-1657.4773 554.0328,-1652.0069 543.5285,-1650.6251 544.9595,-1657.4773"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M399.0839,-2026.9315C424.3794,-2053.8241 448.74,-2022.9147 480.9653,-2040.9315 502.1316,-2052.7652 496.0127,-2069.7235 516.9653,-2081.9315 583.0283,-2120.4228 613.4522,-2091.0554 685.3989,-2116.9315 702.423,-2123.0543 703.838,-2131.5817 721.3989,-2135.9315 785.7526,-2151.8718 804.3208,-2138.4722 870.5706,-2135.9315 951.7515,-2132.8181 973.0908,-2137.5037 1052.825,-2121.9315 1243.5475,-2084.683 1275.0131,-1988.9315 1469.339,-1988.9315 1469.339,-1988.9315 1469.339,-1988.9315 1622.2083,-1988.9315 1721.4218,-1988.9315 1764.1887,-1949.8562 1844.6287,-2007.9315 1894.5294,-2043.9583 1910.9957,-2120.8286 1916.1858,-2158.3835"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1912.759,-2159.1922 1917.459,-2168.6875 1919.7061,-2158.3338 1912.759,-2159.1922"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M223.9544,-1247.974C225.0093,-1333.9487 235.0162,-1896.7151 317.2024,-2040.9315 417.741,-2217.3516 656.2802,-2319.7709 753.5682,-2355.4667"/>
<polygon fill="#00ff91" stroke="#00ff91" points="752.4864,-2358.7973 763.0807,-2358.9086 754.8682,-2352.2149 752.4864,-2358.7973"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M224.809,-1248.0414C230.5115,-1313.6035 260.1831,-1656.6581 281.2024,-1936.9315 290.0142,-2054.429 271.7402,-2357.2278 317.2024,-2465.9315 390.6976,-2641.6643 410.6997,-2786.9315 601.1821,-2786.9315 601.1821,-2786.9315 601.1821,-2786.9315 1145.9073,-2786.9315 1248.6758,-2786.9315 1273.9381,-2797.982 1375.8875,-2810.9315 1417.5502,-2816.2234 1427.4131,-2822.4798 1469.339,-2824.9315"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M1469.339,-2824.9315C1564.9703,-2828.4707 1590.0105,-2816.5807 1681.626,-2788.9315 1698.3883,-2783.8727 1701.4303,-2779.5848 1717.626,-2772.9315 1745.5341,-2761.4666 1755.7804,-2765.2972 1781.1273,-2748.9315"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M234.5932,-1225.843C248.1817,-1211.0487 271.0234,-1183.3962 281.2024,-1154.9315 316.4738,-1056.298 269.1148,-777.9918 317.2024,-684.9315 370.1958,-582.3772 412.692,-568.4566 516.9653,-518.9315 585.8709,-486.2044 631.466,-539.8785 685.3989,-485.9315 744.3132,-427.0018 662.9018,-361.2753 721.3989,-301.9315 823.7204,-198.1289 1262.719,-167.0753 1375.8875,-258.9315 1478.8302,-342.4876 1600.9174,-1350.411 1619.7252,-1510.5518"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1616.2614,-1511.0667 1620.8992,-1520.5925 1623.2141,-1510.2537 1616.2614,-1511.0667"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M224.5513,-1248.0689C228.7514,-1310.2236 252.3929,-1613.616 317.2024,-1674.9315 398.9378,-1752.2603 737.2202,-1762.3508 896.3047,-1762.702"/>
<polygon fill="#b600ff" stroke="#b600ff" points="896.5162,-1766.2022 906.5195,-1762.7117 896.5229,-1759.2022 896.5162,-1766.2022"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M399.0839,-1359.9315C445.6164,-1373.0866 500.6209,-1372.0773 541.4889,-1368.342"/>
<polygon fill="#ff00da" stroke="#ff00da" points="541.9561,-1371.8129 551.5607,-1367.3405 541.2634,-1364.8472 541.9561,-1371.8129"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M399.0839,-1359.9315C416.728,-1364.9196 703.1709,-1290.9153 721.3989,-1288.9315 787.3082,-1281.7582 804.3885,-1285.0033 870.5706,-1288.9315 884.6706,-1289.7684 899.7417,-1291.2084 914.0431,-1292.8327"/>
<polygon fill="#ff006d" stroke="#ff006d" points="913.9546,-1296.3465 924.2957,-1294.0421 914.7746,-1289.3946 913.9546,-1296.3465"/>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M234.3764,-1248.0535C259.738,-1273.9068 327.4134,-1337.5494 399.0839,-1359.9315"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-508.9315C409.0774,-498.2801 488.1509,-483.7778 544.3644,-474.6353"/>
<polygon fill="#ff0000" stroke="#ff0000" points="545.2559,-478.037 554.5729,-472.9927 544.1438,-471.1258 545.2559,-478.037"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M228.8963,-1248.0386C253.1801,-1301.3887 357.9792,-1531.6268 389.8525,-1601.6506"/>
<polygon fill="#7fff00" stroke="#7fff00" points="386.6793,-1603.1278 394.0076,-1610.7793 393.0503,-1600.2278 386.6793,-1603.1278"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.0209,-1248.2264C225.3967,-1318.8211 236.5163,-1698.8014 317.2024,-1772.9315 378.7819,-1829.5074 482.7789,-1822.2928 546.3777,-1810.8469"/>
<polygon fill="#00ffff" stroke="#00ffff" points="547.0509,-1814.2817 556.2254,-1808.9827 545.7489,-1807.4039 547.0509,-1814.2817"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M234.6895,-1225.8769C248.3823,-1211.1192 271.3365,-1183.5063 281.2024,-1154.9315 329.14,-1016.0895 248.7571,-624.8944 317.2024,-494.9315 327.9495,-474.525 348.5585,-458.7238 366.411,-448.0501"/>
<polygon fill="#00ffff" stroke="#00ffff" points="368.4549,-450.9147 375.4285,-442.9386 365.003,-444.825 368.4549,-450.9147"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2026.9315C424.3487,-2053.853 451.5491,-2018.621 480.9653,-2040.9315 510.7447,-2063.5174 493.0275,-2088.2275 516.9653,-2116.9315 575.9995,-2187.7195 612.9761,-2180.9148 685.3989,-2237.9315 701.9891,-2250.9925 701.6042,-2261.5832 721.3989,-2268.9315 783.553,-2292.0045 809.6671,-2295.128 870.5706,-2268.9315 891.9419,-2259.739 886.3585,-2242.4513 906.5706,-2230.9315 1017.9968,-2167.4241 1350.033,-2055.8667 1469.339,-2102.9315"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.7564,-1248.0455C230.16,-1313.6309 258.4186,-1656.796 281.2024,-1936.9315 289.2628,-2036.0377 269.7264,-2295.5642 317.2024,-2382.9315 328.2144,-2403.1963 348.8222,-2418.998 366.6078,-2429.7075"/>
<polygon fill="#00ffff" stroke="#00ffff" points="365.167,-2432.9154 375.5855,-2434.8404 368.6414,-2426.8385 365.167,-2432.9154"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2026.9315C412.0317,-2040.089 462.8733,-2037.2644 480.9653,-2040.9315 572.4356,-2059.4715 601.1914,-2048.6868 685.3989,-2088.9315 703.6874,-2097.672 702.2263,-2110.3532 721.3989,-2116.9315 784.1089,-2138.4478 804.4266,-2121.4561 870.5706,-2116.9315 886.691,-2115.8287 904.0578,-2113.8199 920.0923,-2111.6233"/>
<polygon fill="#ff0000" stroke="#ff0000" points="921.0007,-2115.0296 930.4103,-2110.1603 920.0179,-2108.0989 921.0007,-2115.0296"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-808.9315C779.4177,-842.0509 818.3599,-878.2579 979.6978,-960.9315"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M233.859,-1225.9009C246.8636,-1210.9537 269.2975,-1182.9076 281.2024,-1154.9315 363.1675,-962.3168 238.6564,-833.3997 399.0839,-698.9315"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-698.9315C434.0674,-669.6087 446.1249,-666.4241 480.9653,-636.9315 497.7629,-622.7122 498.9232,-615.5341 516.9653,-602.9315 585.5439,-555.0286 630.379,-581.9435 685.3989,-518.9315 718.1232,-481.4537 690.8312,-452.1879 721.3989,-412.9315 781.6502,-335.554 813.7675,-324.6344 906.5706,-292.9315 1007.5818,-258.4245 1039.4223,-265.5198 1145.9073,-272.9315"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-508.9315C429.4234,-476.595 445.4158,-478.4337 480.9653,-451.9315 574.1302,-382.477 606.9323,-374.6439 685.3989,-288.9315 728.8086,-241.5133 767.1935,-175.4879 785.1719,-142.4603"/>
<polygon fill="#00ffff" stroke="#00ffff" points="788.4293,-143.7924 790.0792,-133.3268 782.263,-140.4793 788.4293,-143.7924"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M234.6397,-1225.8595C248.2785,-1211.083 271.1745,-1183.4498 281.2024,-1154.9315 361.8745,-925.508 227.907,-835.1381 317.2024,-608.9315 338.2941,-555.5011 363.0645,-553.6783 399.0839,-508.9315"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M399.0839,-1359.9315C646.0131,-1437.0454 957.4458,-1452.3039 1086.1066,-1455.2577"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1086.0801,-1458.7579 1096.1524,-1455.4716 1086.2292,-1451.7595 1086.0801,-1458.7579"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-1043.9369 334.8633,-1043.9369 334.8633,-1021.926 463.3044,-1021.926 463.3044,-1043.9369"/>
<text text-anchor="middle" x="399.0839" y="-1029.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M233.0366,-1225.8737C245.3259,-1210.6722 267.1799,-1182.1042 281.2024,-1154.9315 303.0564,-1112.5828 282.0018,-1086.0552 317.2024,-1053.9315 319.8294,-1051.5341 322.6929,-1049.4023 325.7244,-1047.5075"/>
<polygon fill="#ff0000" stroke="#ff0000" points="327.4615,-1050.5481 334.6563,-1042.7708 324.1819,-1044.3639 327.4615,-1050.5481"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-1002.9369 354.6193,-1002.9369 354.6193,-980.926 443.5485,-980.926 443.5485,-1002.9369"/>
<text text-anchor="middle" x="399.0839" y="-988.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M233.6333,-1225.8012C246.388,-1210.7437 268.5459,-1182.5757 281.2024,-1154.9315 308.3055,-1095.7332 271.228,-1059.0332 317.2024,-1012.9315 324.7414,-1005.3716 334.6081,-1000.4125 344.8707,-997.1866"/>
<polygon fill="#ffff00" stroke="#ffff00" points="345.9803,-1000.5142 354.7684,-994.5964 344.2081,-993.7422 345.9803,-1000.5142"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M601.1821,-808.9315C660.6038,-821.2247 1102.7353,-727.2908 1145.9073,-769.9315"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="860.8052,-742.9369 731.1643,-742.9369 731.1643,-720.926 860.8052,-720.926 860.8052,-742.9369"/>
<text text-anchor="middle" x="795.9847" y="-728.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M601.1821,-808.9315C639.447,-816.0418 650.6874,-802.5346 685.3989,-784.9315 703.477,-775.7637 703.5355,-766.5108 721.3989,-756.9315 728.8384,-752.942 737.0337,-749.4216 745.1861,-746.3762"/>
<polygon fill="#00ffff" stroke="#00ffff" points="746.4252,-749.6506 754.6887,-743.0199 744.0939,-743.0502 746.4252,-749.6506"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-698.9315C481.2411,-638.0364 500.6388,-790.2487 601.1821,-808.9315"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M234.7604,-1225.901C248.5298,-1211.1694 271.5667,-1183.5847 281.2024,-1154.9315 347.6216,-957.4246 241.4043,-412.0323 317.2024,-217.9315 329.6685,-186.0088 357.4777,-157.2507 377.2216,-139.7112"/>
<polygon fill="#0000ff" stroke="#0000ff" points="379.5753,-142.3031 384.8619,-133.1215 375.0034,-137.0024 379.5753,-142.3031"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M399.0839,-698.9315C547.136,-589.1949 621.7308,-638.9075 795.9847,-578.9315"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M795.9847,-578.9315C920.2761,-539.5064 1068.7815,-635.3897 1123.9045,-675.9023"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1121.8258,-678.7182 1131.9316,-681.8997 1126.0155,-673.1105 1121.8258,-678.7182"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M267.6098,-1244.1746C290.5091,-1247.9641 318.7923,-1252.6445 343.2521,-1256.6922"/>
<polygon fill="#ff0000" stroke="#ff0000" points="342.6831,-1260.1456 353.1204,-1258.3252 343.826,-1253.2395 342.6831,-1260.1456"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M234.745,-1225.8959C248.4978,-1211.1586 271.5168,-1183.5679 281.2024,-1154.9315 311.8094,-1064.4392 271.5556,-379.8482 317.2024,-295.9315 327.246,-277.4674 346.0111,-263.5241 363.0455,-253.9418"/>
<polygon fill="#ff0000" stroke="#ff0000" points="365.0612,-256.8352 372.2646,-249.0659 361.7885,-250.6473 365.0612,-256.8352"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M234.7348,-1225.8924C248.4766,-1211.1514 271.4837,-1183.5567 281.2024,-1154.9315 310.308,-1069.2048 261.743,-412.4888 317.2024,-340.9315 319.6921,-337.7191 322.5841,-334.9078 325.764,-332.4484"/>
<polygon fill="#00ffff" stroke="#00ffff" points="327.674,-335.3815 334.1965,-327.0323 323.8911,-329.4917 327.674,-335.3815"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="685.6163,-1692.9369 516.748,-1692.9369 516.748,-1670.926 685.6163,-1670.926 685.6163,-1692.9369"/>
<text text-anchor="middle" x="601.1821" y="-1678.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1660.9315C430.9929,-1680.1346 470.9549,-1687.0706 506.9009,-1688.5913"/>
<polygon fill="#ff0000" stroke="#ff0000" points="506.8256,-1692.0905 516.923,-1688.8824 507.0289,-1685.0935 506.8256,-1692.0905"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2079.615,-2444.9315C2087.7398,-2444.9315 2096.4714,-2444.9315 2105.3271,-2444.9315"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2105.3526,-2448.4316 2115.3526,-2444.9315 2105.3525,-2441.4316 2105.3526,-2448.4316"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1681.8555,-1527.1145C1718.9376,-1527.8846 1762.9094,-1536.6993 1781.1273,-1570.9315"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1625.8261,-1543.2231C1646.2748,-1607.0454 1747.4228,-1922.7369 1774.4679,-2007.1467"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1771.1997,-2008.4175 1777.5841,-2016.8727 1777.8659,-2006.2816 1771.1997,-2008.4175"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M422.8282,-1962.0283C441.9933,-1972.3413 467.851,-1989.6208 480.9653,-2012.9315 557.8566,-2149.6053 461.3954,-2217.2891 516.9653,-2363.9315 572.2042,-2509.7002 588.2481,-2567.8715 721.3989,-2648.9315 802.1019,-2698.062 1468.848,-2761.8529 1562.7905,-2771.9315 1659.5028,-2782.3072 1684.1925,-2794.9669 1781.1273,-2786.9315"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M795.9847,-1912.9315C836.4164,-1904.8985 882.848,-1904.7216 918.9164,-1906.5159"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="919.098,-1910.0315 929.2789,-1907.0992 919.4914,-1903.0426 919.098,-1910.0315"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M601.1821,-1912.9315C634.6933,-1893.1386 659.84,-1918.2828 685.3989,-1888.9315 760.8527,-1802.2821 647.9489,-1721.2857 721.3989,-1632.9315 729.3109,-1623.414 740.9681,-1617.5021 752.7274,-1613.8355"/>
<polygon fill="#ffda00" stroke="#ffda00" points="753.7675,-1617.1811 762.5493,-1611.254 751.988,-1610.4111 753.7675,-1617.1811"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M418.2689,-1961.961C436.2388,-1973.0361 462.9552,-1991.4995 480.9653,-2012.9315 503.4723,-2039.7146 499.7426,-2052.4802 516.9653,-2082.9315 586.9654,-2206.6975 622.0331,-2227.6412 685.3989,-2354.9315 705.1507,-2394.6091 687.0998,-2419.8599 721.3989,-2447.9315 869.5468,-2569.1807 954.4676,-2520.9315 1145.9073,-2520.9315 1145.9073,-2520.9315 1145.9073,-2520.9315 1622.2083,-2520.9315 1792.6259,-2520.9315 1887.1796,-2275.2096 1911.866,-2200.9411"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1915.2445,-2201.8692 1915.0021,-2191.2772 1908.5863,-2199.7085 1915.2445,-2201.8692"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M422.0936,-1962.0281C441.0755,-1972.4447 467.0657,-1989.8719 480.9653,-2012.9315 532.1134,-2097.7865 477.587,-2142.0148 516.9653,-2232.9315 546.5957,-2301.3421 658.605,-2458.7457 721.3989,-2498.9315 812.4808,-2557.2205 1373.1227,-2642.1279 1781.1273,-2634.9315"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M441.7043,-1961.9467C498.4395,-1977.2106 601.3863,-2007.0137 685.3989,-2042.9315 736.8146,-2064.9131 740.1945,-2099.1627 795.9847,-2102.9315"/>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M795.9847,-2102.9315C967.7709,-2106.2148 1336.1233,-1831.4435 1469.339,-1722.9315"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M601.1821,-1912.9315C675.7292,-1868.9013 711.0656,-1929.8032 795.9847,-1912.9315"/>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M795.9847,-1912.9315C874.379,-1897.3561 939.267,-1818.9843 966.2445,-1781.6998"/>
<polygon fill="#b600ff" stroke="#b600ff" points="969.3597,-1783.356 972.2715,-1773.1691 963.6426,-1779.3168 969.3597,-1783.356"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M422.7276,-1939.7774C441.8312,-1929.4295 467.6553,-1912.1309 480.9653,-1888.9315 548.0125,-1772.0676 485.4066,-1718.9144 516.9653,-1587.9315 536.0192,-1508.8493 574.1315,-1419.5829 591.7951,-1380.313"/>
<polygon fill="#ff00da" stroke="#ff00da" points="595.0644,-1381.5783 596.0124,-1371.026 588.6908,-1378.684 595.0644,-1381.5783"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M795.9847,-1340.9315C803.4261,-1331.3099 864.6109,-1319.6543 914.3578,-1311.6049"/>
<polygon fill="#ff006d" stroke="#ff006d" points="915.1314,-1315.0259 924.4554,-1309.9945 914.0289,-1308.1132 915.1314,-1315.0259"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M418.1525,-1939.8029C436.0382,-1928.6561 462.6957,-1910.1427 480.9653,-1888.9315 502.7712,-1863.6145 490.9843,-1843.9417 516.9653,-1822.9315 521.6756,-1819.1224 526.9516,-1815.8934 532.5043,-1813.1564"/>
<polygon fill="#00ffff" stroke="#00ffff" points="534.2862,-1816.198 542.0593,-1808.9988 531.4932,-1809.7793 534.2862,-1816.198"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M414.8071,-1962.238C480.3794,-2008.2437 739.8256,-2178.9315 979.6978,-2178.9315 979.6978,-2178.9315 979.6978,-2178.9315 1145.9073,-2178.9315 1290.6435,-2178.9315 1324.6029,-2216.9315 1469.339,-2216.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-2216.9315C1537.2517,-2214.9407 1565.8321,-2254.8502 1622.2083,-2216.9315"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-2102.9315C837.2577,-2105.7195 883.8648,-2105.4259 919.8074,-2104.4575"/>
<polygon fill="#ff0000" stroke="#ff0000" points="920.2318,-2107.9466 930.1242,-2104.1533 920.0254,-2100.9496 920.2318,-2107.9466"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M424.077,-1939.7215C493.0558,-1908.7314 681.2903,-1823.7946 685.3989,-1817.9315 738.5218,-1742.1231 678.4962,-1484.9576 721.3989,-1402.9315 741.3776,-1364.7341 769.6128,-1375.0299 795.9847,-1340.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1340.9315C817.1059,-1313.2449 847.5207,-1343.0342 870.5706,-1316.9315 927.4599,-1252.5074 851.2557,-1192.7124 906.5706,-1126.9315 930.9444,-1097.9459 1029.1446,-1067.6186 1091.9346,-1050.6137"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1092.9369,-1053.9688 1101.6912,-1048.0012 1091.1262,-1047.207 1092.9369,-1053.9688"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M601.1821,-1912.9315C738.6616,-1840.1473 770.6654,-1817.6146 906.5706,-1741.9315 971.4883,-1705.7799 990.8107,-1701.8642 1052.825,-1660.9315 1069.7419,-1649.7654 1072.7524,-1645.2821 1088.825,-1632.9315 1155.2673,-1581.8752 1165.1862,-1558.6096 1238.9897,-1518.9315 1267.384,-1503.6662 1282.4058,-1515.2444 1307.4386,-1494.9315"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M601.1821,-1912.9315C634.6933,-1893.1386 657.1237,-1915.676 685.3989,-1888.9315 720.9342,-1855.3199 690.7913,-1823.0847 721.3989,-1784.9315 781.8746,-1709.5468 818.9055,-1711.613 906.5706,-1670.9315 968.6274,-1642.1336 1006.1427,-1672.9428 1052.825,-1622.9315 1097.2517,-1575.3366 1046.7251,-1530.5965 1088.825,-1480.9315 1091.6189,-1477.6355 1094.9303,-1474.7595 1098.5298,-1472.2526"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1100.5116,-1475.1471 1107.3434,-1467.0491 1096.9528,-1469.1192 1100.5116,-1475.1471"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M448.226,-1950.4445C491.1284,-1948.0581 553.7706,-1939.6963 601.1821,-1912.9315"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M601.1821,-1912.9315C637.6053,-1892.3698 661.1866,-1905.0371 685.3989,-1870.9315 758.7959,-1767.5441 659.3402,-1698.4972 721.3989,-1587.9315 725.5903,-1580.4639 1196.4156,-1208.419 1202.9897,-1202.9315 1232.8185,-1178.0333 1266.5961,-1148.3193 1287.4591,-1129.7834"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1289.9032,-1132.2936 1295.0453,-1123.0302 1285.2488,-1127.0651 1289.9032,-1132.2936"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M423.4364,-1939.7508C442.6947,-1929.4876 468.3658,-1912.322 480.9653,-1888.9315 538.9462,-1781.2922 486.8461,-1458.4255 516.9653,-1339.9315 560.9786,-1166.776 635.3057,-1146.4268 685.3989,-974.9315 736.634,-799.5273 623.0707,-638.028 795.9847,-578.9315"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1760.9315C1318.7076,-1770.5378 1374.9461,-1758.8926 1526.7905,-1841.9315 1573.1685,-1867.2941 1572.8027,-1894.1359 1622.2083,-1912.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1053.0099,-1758.9746C1081.9818,-1758.4632 1115.5467,-1758.6878 1145.9073,-1760.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1622.2083,-1912.9315C1748.4477,-1953.9555 1791.0565,-1913.6158 1918.4414,-1950.9315"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M1010.0817,-1750.8346C1054.129,-1734.1687 1137.5993,-1700.3879 1202.9897,-1660.9315 1220.3449,-1650.4594 1221.5555,-1643.2712 1238.9897,-1632.9315 1334.9855,-1575.9993 1358.5138,-1546.1306 1469.339,-1532.9315"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1760.9315C1219.5451,-1765.0251 1236.6598,-1778.2038 1307.4386,-1798.9315"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M603.1521,-1348.8136C611.9043,-1301.0539 650.0162,-1109.3178 721.3989,-967.9315 736.9783,-937.0737 877.8023,-737.0967 906.5706,-717.9315 1185.7603,-531.9374 1482.4612,-652.9537 1622.2083,-957.9315"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M604.7952,-1371.2449C622.6168,-1426.8839 701.1135,-1669.9693 721.3989,-1698.9315 785.2555,-1790.1014 898.1159,-1864.0629 950.9319,-1895.5443"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="949.3794,-1898.6918 959.7724,-1900.75 952.9313,-1892.6598 949.3794,-1898.6918"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M610.0586,-1371.2319C640.743,-1410.2957 742.5512,-1539.9061 781.0567,-1588.9268"/>
<polygon fill="#ffda00" stroke="#ffda00" points="778.3492,-1591.146 787.2788,-1596.848 783.854,-1586.822 778.3492,-1591.146"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1307.4386,-1646.9315C1585.3119,-1679.176 1667.8367,-1758.1416 1844.6287,-1974.9315 1890.7362,-2031.4705 1909.2656,-2119.1744 1915.6007,-2158.9936"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1912.1396,-2159.5151 1917.0769,-2168.8892 1919.063,-2158.4822 1912.1396,-2159.5151"/>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M650.8414,-1362.4553C711.0257,-1368.1921 811.6727,-1386.8086 870.5706,-1446.9315 903.6264,-1480.6749 871.5243,-1515.2602 906.5706,-1546.9315 940.6294,-1577.7104 1262.6001,-1637.09 1307.4386,-1646.9315"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M795.9847,-1302.9315C815.6361,-1300.6047 1133.5941,-1375.7087 1202.9897,-1435.9315 1230.3113,-1459.6416 1211.9112,-1484.9441 1238.9897,-1508.9315 1263.1208,-1530.3078 1276.4018,-1524.2149 1307.4386,-1532.9315"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M617.5576,-1371.0376C662.0287,-1401.7408 787.2852,-1491.8712 870.5706,-1587.9315 914.1537,-1638.1998 952.1755,-1707.6225 969.5911,-1741.5762"/>
<polygon fill="#b600ff" stroke="#b600ff" points="966.4912,-1743.2019 974.1317,-1750.5418 972.736,-1740.0392 966.4912,-1743.2019"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M603.316,-1371.1869C611.4503,-1411.2594 644.0399,-1548.8066 721.3989,-1627.9315 772.7291,-1680.4334 819.5673,-1646.1118 870.5706,-1698.9315 898.5011,-1727.8568 877.9926,-1753.6456 906.5706,-1781.9315 1043.9895,-1917.9461 1118.8519,-1908.2819 1307.4386,-1950.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1950.9315C1447.0966,-1959.1168 1490.4495,-1903.9104 1622.2083,-1950.9315"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M605.1807,-1371.0098C618.0128,-1406.8162 658.8628,-1522.8024 685.3989,-1620.9315 704.8792,-1692.9683 681.3072,-1721.9915 721.3989,-1784.9315 766.2281,-1855.3087 816.4493,-1835.4217 870.5706,-1898.9315 920.3872,-1957.3899 956.8512,-2042.3139 971.9785,-2081.1479"/>
<polygon fill="#ff0000" stroke="#ff0000" points="968.8345,-2082.726 975.6727,-2090.8186 975.3737,-2080.228 968.8345,-2082.726"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1036.9315C1012.511,-1020.6944 1053.6246,-1020.5517 1086.7514,-1024.5387"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1086.3781,-1028.02 1096.7577,-1025.8954 1087.3186,-1021.0835 1086.3781,-1028.02"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M979.6978,-1036.9315C1047.7045,-1003.2797 1071.0296,-985.6564 1145.9073,-997.9315"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M609.2842,-1348.7945C641.605,-1305.1564 766.3805,-1144.082 906.5706,-1059.9315 935.7825,-1042.3967 949.1612,-1052.0419 979.6978,-1036.9315"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M795.9847,-1302.9315C881.0135,-1292.8639 895.9297,-1262.6563 979.6978,-1244.9315"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M634.1676,-1348.8292C680.9776,-1333.3255 764.4906,-1306.6605 795.9847,-1302.9315"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M607.2901,-1348.9119C623.1016,-1319.8383 665.5202,-1238.25 685.3989,-1164.9315 719.8473,-1037.876 681.5957,-996.4125 721.3989,-870.9315 735.7799,-825.5949 764.9756,-777.7989 782.2666,-751.7459"/>
<polygon fill="#00ffff" stroke="#00ffff" points="785.357,-753.4233 788.0488,-743.1761 779.5543,-749.508 785.357,-753.4233"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M608.7402,-1348.7188C641.9619,-1299.6552 779.0415,-1099.5135 906.5706,-946.9315 983.9584,-854.3409 1085.7941,-752.0824 1127.1978,-711.2403"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1129.7533,-713.636 1134.4273,-704.1279 1124.8441,-708.646 1129.7533,-713.636"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwatertowatergshp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1340.9315C1268.3581,-1380.5812 1275.4865,-1245.4668 1375.8875,-1164.9315 1403.7744,-1142.5623 1606.8881,-925.6305 1622.2083,-957.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1030.8399,-1313.0023C1063.8235,-1320.371 1107.5655,-1330.5708 1145.9073,-1340.9315"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M1469.339,-1532.9315C1496.3879,-1530.2759 1526.2585,-1529.5849 1552.3648,-1529.7116"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1552.5159,-1533.213 1562.5468,-1529.8027 1552.5785,-1526.2133 1552.5159,-1533.213"/>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M1307.4386,-1532.9315C1376.3933,-1553.4954 1397.7276,-1539.9621 1469.339,-1532.9315"/>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M1145.9073,-1340.9315C1172.0901,-1349.4095 1185.0738,-1344.0405 1202.9897,-1364.9315 1245.9352,-1415.0083 1194.5427,-1460.1825 1238.9897,-1508.9315 1260.7098,-1532.7537 1276.5456,-1523.7184 1307.4386,-1532.9315"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M990.3291,-1290.664C1005.4668,-1274.2435 1033.5323,-1242.3696 1052.825,-1211.9315 1072.6193,-1180.7018 1071.6492,-1169.6745 1088.825,-1136.9315 1103.5886,-1108.7869 1122.0304,-1077.0316 1133.8879,-1057.0051"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1137.031,-1058.5672 1139.1349,-1048.1834 1131.0148,-1054.9888 1137.031,-1058.5672"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1145.9073,-1188.9315C1242.252,-1146.422 1293.6776,-1197.741 1375.8875,-1131.9315 1403.8177,-1109.5731 1391.6417,-1089.4291 1411.8875,-1059.9315 1423.0191,-1043.7129 1438.0752,-1027.3561 1449.9817,-1015.3749"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1452.6159,-1017.6927 1457.2782,-1008.1788 1447.7006,-1012.7087 1452.6159,-1017.6927"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M991.6511,-1313.0068C1019.9042,-1339.1844 1091.0453,-1405.0996 1125.9567,-1437.4464"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1123.8997,-1440.3119 1133.6138,-1444.541 1128.6572,-1435.1771 1123.8997,-1440.3119"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M999.9356,-1290.848C1014.8292,-1282.4963 1035.4258,-1270.5353 1052.825,-1258.9315 1095.8891,-1230.2112 1098.5496,-1209.8268 1145.9073,-1188.9315"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1145.9073,-1188.9315C1171.0865,-1177.8219 1178.0176,-1176.4989 1202.9897,-1164.9315 1228.4306,-1153.1469 1256.7664,-1138.6818 1277.4984,-1127.8422"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1279.2257,-1130.8884 1286.4512,-1123.1397 1275.9706,-1124.6913 1279.2257,-1130.8884"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M983.7212,-1290.5893C996.0238,-1255.466 1033.476,-1145.1889 1052.825,-1050.9315 1079.3849,-921.5457 1033.9077,-876.0573 1088.825,-755.9315 1096.8289,-738.4237 1111.4945,-722.4024 1123.9559,-710.8976"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1126.5617,-713.2655 1131.7344,-704.0193 1121.9247,-708.0217 1126.5617,-713.2655"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M604.8663,-477.1356C618.3472,-518.668 665.2517,-667.9882 685.3989,-794.9315 724.4923,-1041.2512 677.8676,-1109.3572 721.3989,-1354.9315 737.0197,-1443.0535 772.2601,-1544.0799 788.0596,-1586.9481"/>
<polygon fill="#ffda00" stroke="#ffda00" points="784.8652,-1588.3996 791.6338,-1596.5505 791.4255,-1585.9577 784.8652,-1588.3996"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M648.0625,-461.2891C661.8121,-457.7037 675.734,-451.5203 685.3989,-440.9315 740.3989,-380.6737 693.8118,-337.7101 721.3989,-260.9315 737.4819,-216.1703 766.0703,-168.1691 782.7946,-141.9245"/>
<polygon fill="#00ffff" stroke="#00ffff" points="785.8885,-143.5852 788.3743,-133.2861 780.0085,-139.7872 785.8885,-143.5852"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M648.2196,-469.7996C703.8257,-475.868 797.9729,-490.9159 870.5706,-526.9315 894.2562,-538.6819 1033.1836,-662.2312 1052.825,-679.9315 1095.5732,-718.4549 1104.9654,-729.4935 1145.9073,-769.9315"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1145.9073,-769.9315C1239.2103,-862.086 1167.3554,-940.0842 1238.9897,-1049.9315 1250.4842,-1067.5576 1268.1832,-1083.4063 1282.7039,-1094.6675"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1280.7141,-1097.5501 1290.8153,-1100.7465 1284.9121,-1091.9485 1280.7141,-1097.5501"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M643.9939,-454.9248C696.9485,-441.6894 781.87,-421.8441 795.9847,-426.9315"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M453.5053,-1616.024C494.1577,-1611.7381 551.1048,-1606.0023 601.1821,-1601.9315"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M601.1821,-1601.9315C653.0371,-1597.7161 712.8763,-1600.7289 752.402,-1603.8078"/>
<polygon fill="#ffda00" stroke="#ffda00" points="752.2403,-1607.3061 762.4915,-1604.6297 752.8087,-1600.3292 752.2403,-1607.3061"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M453.5183,-1613.5472C463.6738,-1609.8497 473.4422,-1604.5424 480.9653,-1596.9315 521.0079,-1556.4217 491.6528,-1524.9581 516.9653,-1473.9315 535.1139,-1437.3464 565.1279,-1400.283 583.9941,-1378.7386"/>
<polygon fill="#ff00da" stroke="#ff00da" points="586.832,-1380.8144 590.8641,-1371.0168 581.6022,-1376.1615 586.832,-1380.8144"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M453.6235,-1632.7617C463.3147,-1636.2574 472.8814,-1640.865 480.9653,-1646.9315 504.3326,-1664.4672 492.9617,-1685.2774 516.9653,-1701.9315 548.4909,-1723.8044 581.7276,-1687.8586 601.1821,-1720.9315"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M402.262,-1610.7358C430.5725,-1513.2254 646.2858,-815.1072 979.6978,-960.9315"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1307.4386,-1494.9315C1386.7501,-1432.6995 1450.1517,-1104.5364 1465.685,-1017.9131"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1469.1506,-1018.4145 1467.449,-1007.9572 1462.258,-1017.1932 1469.1506,-1018.4145"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M413.4532,-1610.8163C434.8149,-1594.8559 476.7605,-1565.6431 516.9653,-1549.9315 758.3492,-1455.6014 830.9174,-1461.3879 1088.825,-1435.9315 1139.3195,-1430.9475 1153.9175,-1423.0298 1202.9897,-1435.9315 1254.5533,-1449.4882 1265.4938,-1527.8436 1307.4386,-1494.9315"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M612.5092,-1786.8498C629.6515,-1769.6998 662.5984,-1735.2233 685.3989,-1701.9315 704.9439,-1673.3931 695.0923,-1655.3905 721.3989,-1632.9315 730.316,-1625.3186 741.6405,-1620.0002 752.7549,-1616.2935"/>
<polygon fill="#ffda00" stroke="#ffda00" points="753.8093,-1619.6316 762.4022,-1613.4338 751.8199,-1612.9202 753.8093,-1619.6316"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-877.9369 166.6166,-877.9369 166.6166,-855.926 281.0645,-855.926 281.0645,-877.9369"/>
<text text-anchor="middle" x="223.8406" y="-863.7815" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M224.1995,-878.0059C226.1514,-920.7528 238.5998,-1077.1326 317.2024,-1167.9315 369.967,-1228.8832 429.3777,-1183.9804 480.9653,-1245.9315 520.4266,-1293.32 483.4765,-1328.1496 516.9653,-1379.9315 582.6134,-1481.4391 708.1381,-1559.6151 765.737,-1591.844"/>
<polygon fill="#ffda00" stroke="#ffda00" points="764.2571,-1595.025 774.703,-1596.7955 767.6412,-1588.8973 764.2571,-1595.025"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M226.1095,-877.9541C233.7241,-912.8151 261.1022,-1022.5797 317.2024,-1093.9315 372.8114,-1164.6585 415.5563,-1151.155 480.9653,-1212.9315 524.6248,-1254.1663 567.0185,-1311.1462 587.8429,-1340.5872"/>
<polygon fill="#ff00da" stroke="#ff00da" points="584.9865,-1342.6099 593.5907,-1348.792 590.7197,-1338.5936 584.9865,-1342.6099"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.078,-878.178C233.1466,-910.6594 258.1237,-1005.3202 317.2024,-1052.9315 319.7734,-1055.0035 322.525,-1056.8734 325.4056,-1058.5609"/>
<polygon fill="#ff0000" stroke="#ff0000" points="323.8787,-1061.7108 334.3827,-1063.0954 327.0348,-1055.4626 323.8787,-1061.7108"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M225.5535,-855.6587C231.2986,-822.304 253.2602,-723.9951 317.2024,-684.9315 413.7124,-625.9715 758.1548,-612.3565 870.5706,-711.9315 933.9271,-768.0511 863.866,-825.8577 906.5706,-898.9315 928.0699,-935.72 941.6766,-941.6958 979.6978,-960.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-960.9315C1024.0318,-983.6493 1076.502,-1007.0873 1110.4536,-1021.8175"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1109.3729,-1025.1632 1119.941,-1025.916 1112.149,-1018.7372 1109.3729,-1025.1632"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M225.6714,-855.654C233.0099,-810.3238 260.879,-636.9625 281.2024,-493.9315 289.9037,-432.6937 270.7234,-258.7417 317.2024,-217.9315 455.8904,-96.1584 962.3384,-253.8134 1145.9073,-272.9315"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M224.4131,-855.8595C227.0429,-817.8438 241.382,-692.1166 317.2024,-639.9315 470.7557,-534.245 1013.4999,-638.7198 1145.9073,-769.9315"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M278.6905,-412.0084C331.2144,-404.3265 412.3848,-397.2359 480.9653,-411.9315 514.7383,-419.1684 550.4837,-436.648 574.1312,-449.7736"/>
<polygon fill="#ff0000" stroke="#ff0000" points="572.4513,-452.8446 582.8759,-454.7364 575.9064,-446.7566 572.4513,-452.8446"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.8078,-425.0681C295.254,-426.0066 313.4912,-427.0473 330.689,-428.0286"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.4901,-431.5229 340.6733,-428.5984 330.889,-424.5342 330.4901,-431.5229"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M227.9939,-410.7797C238.3518,-384.8177 268.0843,-320.669 317.2024,-295.9315 382.2072,-263.1928 408.3419,-291.1064 480.9653,-295.9315 593.3767,-303.4 894.7806,-312.8965 979.6978,-386.9315"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M457.5391,-441.7657C484.8289,-446.3568 517.192,-451.8014 544.2844,-456.3593"/>
<polygon fill="#ff0000" stroke="#ff0000" points="543.9461,-459.8515 554.3882,-458.0591 545.1075,-452.9485 543.9461,-459.8515"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M446.6809,-420.8904C523.0157,-405.447 676.3744,-383.8205 795.9847,-426.9315"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M795.9847,-426.9315C946.6681,-477.7735 1083.9114,-622.1139 1129.7405,-674.0344"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1127.3184,-676.582 1136.5311,-681.8143 1132.5921,-671.9789 1127.3184,-676.582"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1791.4482,-2039.3562C1814.9226,-2065.3412 1872.5074,-2129.0848 1901.3694,-2161.0336"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1899.0732,-2163.713 1908.3739,-2168.7873 1904.2676,-2159.0206 1899.0732,-2163.713"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M795.9847,-2634.9315C869.5845,-2620.8424 1394.4028,-2596.9315 1469.339,-2596.9315 1469.339,-2596.9315 1469.339,-2596.9315 1622.2083,-2596.9315 1743.2081,-2596.9315 1774.6806,-2538.6645 1844.6287,-2439.9315 1898.631,-2363.7062 1913.2811,-2248.7954 1917.1261,-2201.4681"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1920.6383,-2201.4268 1917.8728,-2191.1993 1913.6567,-2200.9191 1920.6383,-2201.4268"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M1781.1273,-2748.9315C1815.0515,-2728.8073 1817.97,-2716.0029 1844.6287,-2686.9315 1879.5923,-2648.8034 1872.3211,-2620.3651 1918.4414,-2596.9315"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M601.1821,-2672.9315C641.6579,-2691.0886 1629.9469,-2838.6133 1781.1273,-2748.9315"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M412.3006,-2434.834C431.5019,-2417.7888 466.405,-2383.1064 480.9653,-2344.9315 540.9822,-2187.5762 483.3958,-1752.9642 516.9653,-1587.9315 533.1798,-1508.2187 572.729,-1419.2714 591.2755,-1380.1976"/>
<polygon fill="#ff00da" stroke="#ff00da" points="594.538,-1381.489 595.7128,-1370.9594 588.2281,-1378.4582 594.538,-1381.489"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-2634.9315C1184.6451,-2499.654 1280.7332,-2446.6088 1622.2083,-2216.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-2672.9315C681.6658,-2709.0359 709.3471,-2651.5164 795.9847,-2634.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M404.5891,-2457.1372C424.4739,-2496.1491 496.952,-2626.1746 601.1821,-2672.9315"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1622.2083,-2216.9315C1692.1811,-2169.8675 1653.6449,-2107.8645 1717.626,-2052.9315 1721.8397,-2049.3136 1726.6394,-2046.1824 1731.6692,-2043.4811"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1733.3822,-2046.5416 1740.8944,-2039.0704 1730.3628,-2040.2262 1733.3822,-2046.5416"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-2102.9315C1496.8733,-2115.7482 1502.1708,-2122.1473 1526.7905,-2139.9315 1570.9649,-2171.841 1576.9908,-2247.3449 1622.2083,-2216.9315"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1021.2065,-2090.8852C1108.8751,-2069.86 1317.3239,-2032.1714 1469.339,-2102.9315"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M1479.6948,-2148.8469C1492.8575,-2134.0909 1515.252,-2106.6223 1526.7905,-2078.9315 1537.2112,-2053.9233 1602.9276,-1650.9177 1618.7735,-1553.1658"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1622.2335,-1553.6941 1620.3774,-1543.2632 1615.3235,-1552.5749 1622.2335,-1553.6941"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1487.8838,-2171.0402C1523.3758,-2191.6249 1599.4104,-2232.2654 1622.2083,-2216.9315"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M417.8238,-1085.0688C435.7192,-1096.4045 462.6068,-1115.3426 480.9653,-1136.9315 536.5324,-1202.2759 577.2047,-1297.4794 593.4277,-1339.1251"/>
<polygon fill="#ff00da" stroke="#ff00da" points="590.2595,-1340.6393 597.1021,-1348.7282 596.7973,-1338.1377 590.2595,-1340.6393"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1720.9315C624.0978,-1759.8883 660.517,-1740.2002 685.3989,-1777.9315 731.9936,-1848.5883 671.0811,-1896.8758 721.3989,-1964.9315 771.4253,-2032.5929 864.9714,-2070.0728 924.6985,-2088.0875"/>
<polygon fill="#ff0000" stroke="#ff0000" points="923.765,-2091.4611 934.3458,-2090.917 925.7351,-2084.744 923.765,-2091.4611"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M406.1709,-1085.0478C422.6967,-1111.6157 463.6911,-1181.3977 480.9653,-1245.9315 507.2491,-1344.1232 450.4115,-1625.1003 516.9653,-1701.9315 542.0881,-1730.9338 581.452,-1688.0224 601.1821,-1720.9315"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-960.9315C760.8937,-908.0801 824.0557,-897.0832 979.6978,-960.9315"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1145.9073,-997.9315C1234.9296,-1012.5253 1339.5957,-1008.4083 1405.2111,-1003.3173"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1405.7125,-1006.7883 1415.3983,-1002.4946 1405.149,-999.811 1405.7125,-1006.7883"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M455.7948,-1062.9042C464.464,-1060.2262 473.1263,-1056.942 480.9653,-1052.9315 499.5069,-1043.4453 500.5718,-1035.7778 516.9653,-1022.9315 553.5498,-994.2632 557.9315,-977.9512 601.1821,-960.9315"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M601.1821,-960.9315C654.5654,-939.9244 665.0242,-924.5599 721.3989,-913.9315 866.8651,-886.5065 913.2789,-897.541 1052.825,-946.9315 1097.2943,-962.6708 1099.5865,-989.0077 1145.9073,-997.9315"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M601.1821,-960.9315C721.5209,-916.7228 1018.8974,-1168.3761 1145.9073,-1150.9315"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1145.9073,-1150.9315C1187.9672,-1144.0807 1197.5562,-1137.8926 1238.9897,-1127.9315 1242.5828,-1127.0677 1246.2836,-1126.1843 1250.0163,-1125.2982"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1250.9928,-1128.6639 1259.9196,-1122.9574 1249.3826,-1121.8516 1250.9928,-1128.6639"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M1307.4386,-1035.9315C1536.055,-1021.5029 1605.8119,-1414.2034 1619.4825,-1510.7335"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1616.0309,-1511.327 1620.8489,-1520.7629 1622.9668,-1510.3819 1616.0309,-1511.327"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1307.4386,-1035.9315C1349.4081,-1033.2827 1395.9508,-1021.0537 1428.3212,-1010.9861"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1429.4216,-1014.309 1437.8914,-1007.9441 1427.301,-1007.6379 1429.4216,-1014.309"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1203.1512,-1038.1583C1234.0643,-1038.4224 1272.8728,-1038.113 1307.4386,-1035.9315"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1169.7418,-1047.998C1197.4188,-1060.8486 1243.2438,-1082.1254 1274.3586,-1096.5722"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1272.9623,-1099.7827 1283.5063,-1100.8196 1275.9103,-1093.4337 1272.9623,-1099.7827"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M1509.0335,-1008.0646C1515.7848,-1011.5387 1522.114,-1016.0608 1526.7905,-1021.9315 1588.8291,-1099.8117 1614.8765,-1423.5168 1620.829,-1510.3927"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1617.3532,-1510.8734 1621.5107,-1520.6184 1624.3377,-1510.4077 1617.3532,-1510.8734"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M870.7994,-119.1351C941.6976,-117.0965 1051.1381,-115.5323 1145.9073,-120.9315"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M1175.0546,-1467.0456C1184.2335,-1470.9773 1194.251,-1475.7297 1202.9897,-1480.9315 1220.4073,-1491.2993 1221.193,-1499.229 1238.9897,-1508.9315 1267.2942,-1524.3626 1276.5456,-1523.7184 1307.4386,-1532.9315"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M463.3642,-1042.9347C469.7662,-1045.7656 475.7968,-1049.3639 480.9653,-1053.9315 569.194,-1131.9023 593.292,-1282.9097 599.324,-1338.6169"/>
<polygon fill="#ff00da" stroke="#ff00da" points="595.8561,-1339.1139 600.3286,-1348.7184 602.8217,-1338.4211 595.8561,-1339.1139"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M463.5818,-1024.3415C470.1063,-1021.2724 476.1055,-1017.2318 480.9653,-1011.9315 547.0348,-939.8735 455.8917,-871.2698 516.9653,-794.9315 578.2262,-718.3591 625.1542,-730.7242 721.3989,-711.9315 786.4686,-699.226 804.5442,-705.931 870.5706,-711.9315 919.677,-716.3942 930.6518,-726.8475 979.6978,-731.9315"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M979.6978,-731.9315C1052.4935,-734.2077 1246.1712,-692.5526 1307.4386,-731.9315"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M443.3366,-995.1965C456.7889,-998.1611 470.7091,-1003.4878 480.9653,-1012.9315 579.2239,-1103.4054 597.1715,-1278.1861 600.4496,-1338.698"/>
<polygon fill="#ff00da" stroke="#ff00da" points="596.9639,-1339.0915 600.9182,-1348.9208 603.9565,-1338.7709 596.9639,-1339.0915"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M403.0636,-980.8936C415.9879,-945.9121 459.3031,-835.2072 516.9653,-756.9315 578.5678,-673.3069 611.3119,-667.726 685.3989,-594.9315 784.7444,-497.3191 790.9587,-450.5949 906.5706,-372.9315 954.4186,-340.789 1088.6292,-266.4672 1145.9073,-272.9315"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1322.9623,-1100.9048C1351.2969,-1080.7783 1411.5742,-1037.9626 1445.2697,-1014.0282"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1447.4986,-1016.7381 1453.6244,-1008.0937 1443.4449,-1011.0313 1447.4986,-1016.7381"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M860.7689,-728.6791C896.0273,-727.7263 940.3592,-727.8538 979.6978,-731.9315"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M453.553,-110.9091C542.1033,-94.9236 722.3037,-70.4678 870.5706,-101.9315 957.2811,-120.3323 979.3367,-133.3654 1052.825,-182.9315 1100.533,-215.1094 1088.7921,-265.9089 1145.9073,-272.9315"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1145.9073,-272.9315C1217.3128,-280.3681 1259.789,-219.2327 1307.4386,-272.9315"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1201.8517,-697.2375C1234.7275,-701.9132 1275.8891,-711.6534 1307.4386,-731.9315"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1307.4386,-731.9315C1392.4606,-786.5784 1354.1298,-850.9912 1411.8875,-933.9315 1423.1288,-950.0741 1438.1807,-966.4339 1450.0578,-978.4354"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1447.7664,-981.0922 1457.3324,-985.6467 1452.6945,-976.1209 1447.7664,-981.0922"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1160.0784,-704.0201C1173.5724,-715.4564 1193.2282,-734.5906 1202.9897,-755.9315 1257.7481,-875.6449 1178.3964,-933.0631 1238.9897,-1049.9315 1248.5521,-1068.3748 1265.9695,-1084.0312 1280.8409,-1094.9971"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1279.0319,-1098.0039 1289.2241,-1100.8972 1283.0608,-1092.2795 1279.0319,-1098.0039"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M445.2759,-1269.5779C544.4422,-1276.2528 784.5541,-1286.2227 979.6978,-1244.9315"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M979.6978,-1244.9315C1058.9084,-1214.4689 1062.1449,-1164.5749 1145.9073,-1150.9315"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M979.6978,-386.9315C1070.7821,-471.7055 1122.8421,-617.9615 1139.7516,-672.041"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1136.4803,-673.3128 1142.7472,-681.8554 1143.1753,-671.2692 1136.4803,-673.3128"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M475.0538,-235.3186C571.08,-234.7543 739.6355,-243.0093 870.5706,-298.9315 884.8952,-305.0495 968.2956,-376.3193 979.6978,-386.9315"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M481.0015,-324.7341C638.8394,-341.8586 970.465,-378.701 979.6978,-386.9315"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M653.4157,-1692.9711C722.3714,-1707.5451 843.6333,-1733.174 917.3213,-1748.7481"/>
<polygon fill="#b600ff" stroke="#b600ff" points="916.8852,-1752.2332 927.3929,-1750.8767 918.3328,-1745.3845 916.8852,-1752.2332"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileplantwatertowatergshpf90EfferentGraph = svgPanZoom('#sourcefileplantwatertowatergshpf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~plantwatertowatergshp.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileplantwatertowatergshpf90AfferentGraph" width="641pt" height="47pt"
 viewBox="0.00 0.00 641.00 46.78" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph" class="graph" transform="scale(.3781 .3781) rotate(0) translate(4 119.7261)">
<title>sourcefile~~plantwatertowatergshp.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-119.7261 1691.467,-119.7261 1691.467,4 -4,4"/>
<!-- sourcefile~plantwatertowatergshp.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~plantwatertowatergshp.f90</title>
<polygon fill="none" stroke="#000000" points="145.7664,-95.4815 .0778,-95.4815 .0778,-73.4707 145.7664,-73.4707 145.7664,-95.4815"/>
<text text-anchor="middle" x="72.9221" y="-81.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">PlantWatertoWaterGSHP.f90</text>
</g>
<!-- sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~plantloopequipment.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/plantloopequipment.f90.html" xlink:title="PlantLoopEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="308.8483,-95.4815 181.8429,-95.4815 181.8429,-73.4707 308.8483,-73.4707 308.8483,-95.4815"/>
<text text-anchor="middle" x="245.3456" y="-81.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantwatertowatergshp.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~plantwatertowatergshp.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M146.0452,-84.4761C154.4629,-84.4761 163.051,-84.4761 171.4785,-84.4761"/>
<polygon fill="#ff0000" stroke="#ff0000" points="171.6562,-87.9762 181.6562,-84.4761 171.6562,-80.9762 171.6562,-87.9762"/>
</g>
<!-- sourcefile~plantmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~plantmanager.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/plantmanager.f90.html" xlink:title="PlantManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="581.3097,-95.4815 486.6822,-95.4815 486.6822,-73.4707 581.3097,-73.4707 581.3097,-95.4815"/>
<text text-anchor="middle" x="533.996" y="-81.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M309.0417,-85.2114C320.9411,-85.3217 333.2725,-85.4179 344.8469,-85.4761 391.9541,-85.7128 403.7325,-85.7593 450.8394,-85.4761 459.0508,-85.4267 467.7181,-85.3499 476.2334,-85.2603"/>
<polygon fill="#ff0000" stroke="#ff0000" points="476.5437,-88.7572 486.5039,-85.1457 476.4655,-81.7576 476.5437,-88.7572"/>
</g>
<!-- sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~plantloopsolver.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/plantloopsolver.f90.html" xlink:title="PlantLoopSolver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="450.8356,-76.4815 344.8507,-76.4815 344.8507,-54.4707 450.8356,-54.4707 450.8356,-76.4815"/>
<text text-anchor="middle" x="397.8431" y="-62.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopSolver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M309.1347,-76.5285C317.4903,-75.4874 326.0511,-74.4208 334.4009,-73.3805"/>
<polygon fill="#ff0000" stroke="#ff0000" points="334.9628,-76.8376 344.4533,-72.1281 334.0973,-69.8914 334.9628,-76.8376"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1555.0496,-75.4815 1435.2392,-75.4815 1435.2392,-53.4707 1555.0496,-53.4707 1555.0496,-75.4815"/>
<text text-anchor="middle" x="1495.1444" y="-61.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1349.9528,-104.4761C1387.7532,-101.8848 1429.2829,-89.4098 1458.2071,-79.0712"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1459.7012,-82.2513 1467.8854,-75.5231 1457.2917,-75.679 1459.7012,-82.2513"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M581.3319,-89.757C638.6194,-95.6824 738.049,-104.4761 823.6,-104.4761 823.6,-104.4761 823.6,-104.4761 1014.6138,-104.4761 1163.6533,-104.4761 1201.2622,-114.669 1349.9528,-104.4761"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1687.278,-115.4815 1591.0358,-115.4815 1591.0358,-93.4707 1687.278,-93.4707 1687.278,-115.4815"/>
<text text-anchor="middle" x="1639.1569" y="-101.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1349.9528,-104.4761C1429.7541,-98.2074 1522.3242,-99.7465 1580.8094,-101.7999"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1580.8432,-105.3034 1590.9653,-102.1737 1581.1008,-98.3081 1580.8432,-105.3034"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="715.821,-76.4815 617.2629,-76.4815 617.2629,-54.4707 715.821,-54.4707 715.821,-76.4815"/>
<text text-anchor="middle" x="666.542" y="-62.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M581.4737,-77.6703C589.8027,-76.4764 598.5634,-75.2206 607.1673,-73.9873"/>
<polygon fill="#ff0000" stroke="#ff0000" points="607.7581,-77.4384 617.1602,-72.5548 606.7648,-70.5093 607.7581,-77.4384"/>
</g>
<!-- sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M450.8732,-72.8764C459.3526,-74.0597 468.1598,-75.2887 476.7322,-76.485"/>
<polygon fill="#00ffff" stroke="#00ffff" points="476.2662,-79.9538 486.654,-77.8696 477.2337,-73.021 476.2662,-79.9538"/>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1534.8777,-75.5122C1551.7369,-80.1949 1571.5723,-85.7042 1589.3923,-90.6538"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1588.4814,-94.0332 1599.0533,-93.3372 1590.3548,-87.2886 1588.4814,-94.0332"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1680.8654,-74.4815 1597.4483,-74.4815 1597.4483,-52.4707 1680.8654,-52.4707 1680.8654,-74.4815"/>
<text text-anchor="middle" x="1639.1569" y="-60.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1554.9675,-64.0607C1565.6321,-63.9866 1576.664,-63.91 1587.0903,-63.8376"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1587.3034,-67.3363 1597.2788,-63.7669 1587.2547,-60.3365 1587.3034,-67.3363"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M715.8654,-64.1301C783.3549,-62.6281 908.2448,-61.0607 1014.6138,-66.4761"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="895.4375,-38.4815 751.7624,-38.4815 751.7624,-16.4707 895.4375,-16.4707 895.4375,-38.4815"/>
<text text-anchor="middle" x="823.6" y="-24.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M712.3919,-54.3828C729.81,-50.1685 749.8388,-45.3225 768.0575,-40.9146"/>
<polygon fill="#0000ff" stroke="#0000ff" points="769.0682,-44.2711 777.9646,-38.5175 767.422,-37.4674 769.0682,-44.2711"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M860.8637,-38.5558C899.0541,-49.0856 960.3608,-63.714 1014.6138,-66.4761"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1014.6138,-66.4761C1096.5509,-70.6476 1117.3284,-61.3458 1199.2112,-66.4761"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1097.8045,-38.4815 931.4231,-38.4815 931.4231,-16.4707 1097.8045,-16.4707 1097.8045,-38.4815"/>
<text text-anchor="middle" x="1014.6138" y="-24.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M895.2699,-27.4761C903.7157,-27.4761 912.4271,-27.4761 921.1163,-27.4761"/>
<polygon fill="#ff0000" stroke="#ff0000" points="921.2893,-30.9762 931.2893,-27.4761 921.2892,-23.9762 921.2893,-30.9762"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1050.5968,-38.5545C1087.4815,-49.0832 1146.7112,-63.7109 1199.2112,-66.4761"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1199.2112,-66.4761C1276.4498,-70.5443 1365.1828,-69.1363 1425.1822,-67.2859"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1425.4164,-70.7802 1435.299,-66.9612 1425.1919,-63.7838 1425.4164,-70.7802"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1264.2165,-38.4815 1134.2058,-38.4815 1134.2058,-16.4707 1264.2165,-16.4707 1264.2165,-38.4815"/>
<text text-anchor="middle" x="1199.2112" y="-24.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1098.0014,-27.4761C1106.723,-27.4761 1115.5517,-27.4761 1124.1722,-27.4761"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1124.1773,-30.9762 1134.1772,-27.4761 1124.1772,-23.9762 1124.1773,-30.9762"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1234.2273,-16.3906C1274.7142,-5.3016 1343.0235,8.0525 1399.4421,-7.4761 1427.4495,-15.1848 1455.5388,-33.4716 1473.9713,-47.2689"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1471.9058,-50.0958 1481.9635,-53.4265 1476.178,-44.5507 1471.9058,-50.0958"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_node12"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1399.4315,-38.4815 1300.474,-38.4815 1300.474,-16.4707 1399.4315,-16.4707 1399.4315,-38.4815"/>
<text text-anchor="middle" x="1349.9528" y="-24.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1264.4519,-27.4761C1272.9373,-27.4761 1281.5971,-27.4761 1289.9906,-27.4761"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1290.0671,-30.9762 1300.0671,-27.4761 1290.0671,-23.9762 1290.0671,-30.9762"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwatertowatergshp.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1393.515,-38.5773C1408.8022,-42.473 1426.146,-46.8928 1442.1227,-50.9643"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1441.3086,-54.3686 1451.8632,-53.4465 1443.0373,-47.5854 1441.3086,-54.3686"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileplantwatertowatergshpf90AfferentGraph = svgPanZoom('#sourcefileplantwatertowatergshpf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/heatpumpwatertowaterheating.html">HeatPumpWaterToWaterHEATING</a>

      <a class="list-group-item" href="../module/heatpumpwatertowatercooling.html">HeatPumpWaterToWaterCOOLING</a>

      <a class="list-group-item" href="../module/heatpumpwatertowatersimple.html">HeatPumpWaterToWaterSimple</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html#src">PlantWatertoWaterGSHP.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!  Three modules are contained in this file:</span>
<a name="ln-2"></a><span class="c">! HeatPumpWaterToWaterHEATING</span>
<a name="ln-3"></a><span class="c">! HeatPumpWaterToWaterCOOLING</span>
<a name="ln-4"></a><span class="c">! HeatPumpWaterToWaterSimple</span>
<a name="ln-5"></a><span class="c">!************************************************************************************</span>
<a name="ln-6"></a><span class="c">!</span>
<a name="ln-7"></a><span class="c">!==================================== MODULE HeatPumpWaterToWaterHEATING ======================</span>
<a name="ln-8"></a><span class="c">!</span>
<a name="ln-9"></a><span class="c">!************************************************************************************</span>
<a name="ln-10"></a><span class="k">MODULE </span><span class="n">HeatPumpWaterToWaterHEATING</span>
<a name="ln-11"></a>  <span class="c">! Module containing the routines dealing with the Water to Water Heat Pump (Heating)</span>
<a name="ln-12"></a>
<a name="ln-13"></a>  <span class="c">! MODULE INFORMATION:</span>
<a name="ln-14"></a>  <span class="c">!       AUTHOR         ARUN</span>
<a name="ln-15"></a>  <span class="c">!       DATE WRITTEN   7/18/2000</span>
<a name="ln-16"></a>  <span class="c">!       MODIFIED       ARUN: 6/27/2002: Cycle Time</span>
<a name="ln-17"></a>  <span class="c">!                      L Lawrie: V1.1.1 (5/20/2003) add meters and energy to several reporting variables</span>
<a name="ln-18"></a>  <span class="c">!                      L Lawrie: V1.1.1 (5/20/2003) restructure modules to comply with standard templates</span>
<a name="ln-19"></a>  <span class="c">!                      B. Griffith, Sept 2010, plant upgrades, generalize fluid properties</span>
<a name="ln-20"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-21"></a>
<a name="ln-22"></a>  <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-23"></a>  <span class="c">! This module simulates a water to Water Heat Pump (Heating)</span>
<a name="ln-24"></a>
<a name="ln-25"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-26"></a>  <span class="c">! This simulation is based on a set of selected parameters,</span>
<a name="ln-27"></a>  <span class="c">! Which are obtained using Parameter Estimation technique.</span>
<a name="ln-28"></a>
<a name="ln-29"></a>  <span class="c">! REFERENCES: none</span>
<a name="ln-30"></a>
<a name="ln-31"></a>  <span class="c">! OTHER NOTES: none</span>
<a name="ln-32"></a>
<a name="ln-33"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-34"></a>  <span class="c">! Use statements for data only modules</span>
<a name="ln-35"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-36"></a><span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MaxNameLength</span><span class="p">,</span> <span class="n">BeginSimFlag</span><span class="p">,</span><span class="n">InitconvTemp</span><span class="p">,</span><span class="n">BeginEnvrnFlag</span><span class="p">,</span> <span class="n">HourOfDay</span><span class="p">,</span> <span class="n">KelvinConv</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-37"></a>                              <span class="n">TimeStep</span><span class="p">,</span><span class="n">TimeStepZone</span><span class="p">,</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">WarmupFlag</span><span class="p">,</span><span class="n">SecInHour</span>
<a name="ln-38"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-39"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-40"></a>
<a name="ln-41"></a>  <span class="c">! Use statements for access to subroutines in other modules</span>
<a name="ln-42"></a>
<a name="ln-43"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-44"></a>
<a name="ln-45"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-46"></a>
<a name="ln-47"></a>  <span class="c">! MODULE PARAMETER DEFINITIONS</span>
<a name="ln-48"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ModuleCompName</span><span class="o">=</span><span class="s1">&#39;HeatPump:WaterToWater:ParameterEstimation:Heating&#39;</span>
<a name="ln-49"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ModuleCompNameUC</span><span class="o">=</span><span class="s1">&#39;HEATPUMP:WATERTOWATER:PARAMETERESTIMATION:HEATING&#39;</span>
<a name="ln-50"></a>
<a name="ln-51"></a>  <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-52"></a>
<a name="ln-53"></a>    <span class="c">! Type Description of Heat Pump</span>
<a name="ln-54"></a><span class="k">TYPE </span><span class="n">GshpSpecs</span>
<a name="ln-55"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>          <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! user identifier</span>
<a name="ln-56"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">WWHPPlantTypeOfNum</span>      <span class="o">=</span> <span class="mi">0</span>       <span class="c">! equipment type num</span>
<a name="ln-57"></a>  <span class="kt">LOGICAL</span>            <span class="kd">::</span> <span class="n">Available</span>               <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! need an array of logicals--load identifiers of available equipment</span>
<a name="ln-58"></a>  <span class="kt">LOGICAL</span>            <span class="kd">::</span> <span class="n">ON</span>                      <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! simulate the machine at it&#39;s operating part load ratio</span>
<a name="ln-59"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">COP</span>                     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Coefficient of Performance of the machine</span>
<a name="ln-60"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">NomCap</span>                  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Nominal Capcity of the HeatPump</span>
<a name="ln-61"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">MinPartLoadRat</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Minimum operating Part Load Ratio</span>
<a name="ln-62"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">MaxPartLoadRat</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Maximum operating Part Load Ratio</span>
<a name="ln-63"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">OptPartLoadRat</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Optimal operating Part Load Ratio</span>
<a name="ln-64"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">LoadSideVolFlowRate</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Design Flow Rate on the Load side m3/sec</span>
<a name="ln-65"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">LoadSideDesignMassFlow</span>  <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! Design flow rate (kg/s)</span>
<a name="ln-66"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">SourceSideVolFlowRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Design Flow Rate on th Source Side m3/sec</span>
<a name="ln-67"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">SourceSideDesignMassFlow</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! Design flow rate (kg/s)</span>
<a name="ln-68"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SourceSideInletNodeNum</span>  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Node number on the inlet side of the plant</span>
<a name="ln-69"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SourceSideOutletNodeNum</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Node number on the outlet side of the plant</span>
<a name="ln-70"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">LoadSideInletNodeNum</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Node number on the inlet side of the Load Side</span>
<a name="ln-71"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">LoadSideOutletNodeNum</span>   <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Node number on the outlet side of the Load Side</span>
<a name="ln-72"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">SourceSideUACoeff</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side heat transfer coeff W/K</span>
<a name="ln-73"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">LoadSideUACoeff</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Load Side heat transfer coeff  W/K</span>
<a name="ln-74"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CompPistonDisp</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! compressor piston displacement m3</span>
<a name="ln-75"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CompClearanceFactor</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! compressor clearance factor</span>
<a name="ln-76"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CompSucPressDrop</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! deltap ,  compressor suction and discharge pressure drop Pascals</span>
<a name="ln-77"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">SuperheatTemp</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! deltatsh , super heating  °C</span>
<a name="ln-78"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">PowerLosses</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! constant part of electro mechanical power losses  watts Joules/sec</span>
<a name="ln-79"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">LossFactor</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! loss factor used ot define the electro mechanical</span>
<a name="ln-80"></a>                                                      <span class="c">! loss that is supposed to be proportional to the theoretical power</span>
<a name="ln-81"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">HighPressCutOff</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Maximum Design Pressure on the Load Side Pascals</span>
<a name="ln-82"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">LowPressCutOff</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Minimum Design Pressure on the Source Side Pascals</span>
<a name="ln-83"></a>
<a name="ln-84"></a>  <span class="c">! Added by Arun 6-27-02</span>
<a name="ln-85"></a>  <span class="c">! to implement cycletime - removed 9/10/2013 LKL</span>
<a name="ln-86"></a>  <span class="kt">LOGICAL</span>            <span class="kd">::</span> <span class="n">IsOn</span>                    <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-87"></a>  <span class="kt">LOGICAL</span>            <span class="kd">::</span> <span class="n">MustRun</span>                 <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-88"></a>  <span class="c">!loop topology variables</span>
<a name="ln-89"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SourceLoopNum</span>           <span class="o">=</span> <span class="mi">0</span> <span class="c">! source side plant loop index number</span>
<a name="ln-90"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SourceLoopSideNum</span>       <span class="o">=</span> <span class="mi">0</span> <span class="c">! source side plant loop side index</span>
<a name="ln-91"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SourceBranchNum</span>         <span class="o">=</span> <span class="mi">0</span> <span class="c">! source side plant loop branch index</span>
<a name="ln-92"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SourceCompNum</span>           <span class="o">=</span> <span class="mi">0</span> <span class="c">! source side plant loop component index</span>
<a name="ln-93"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">LoadLoopNum</span>             <span class="o">=</span> <span class="mi">0</span> <span class="c">! load side plant loop index number</span>
<a name="ln-94"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">LoadLoopSideNum</span>         <span class="o">=</span> <span class="mi">0</span> <span class="c">! load side plant loop side index</span>
<a name="ln-95"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">LoadBranchNum</span>           <span class="o">=</span> <span class="mi">0</span> <span class="c">! load side plant loop branch index</span>
<a name="ln-96"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">LoadCompNum</span>             <span class="o">=</span> <span class="mi">0</span> <span class="c">! load side plant loop component index</span>
<a name="ln-97"></a><span class="k">END TYPE </span><span class="n">GshpSpecs</span>
<a name="ln-98"></a>
<a name="ln-99"></a>
<a name="ln-100"></a>    <span class="c">! Output Variables Type definition</span>
<a name="ln-101"></a><span class="k">TYPE </span><span class="n">ReportVars</span>
<a name="ln-102"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Power</span>                              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Power Consumption Watts</span>
<a name="ln-103"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Energy</span>                             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Energy Consumption Joules</span>
<a name="ln-104"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QLoad</span>                              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Load Side heat transfer rate Watts</span>
<a name="ln-105"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QLoadEnergy</span>                        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Load Side heat transfer Joules</span>
<a name="ln-106"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QSource</span>                            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side heat transfer rate Watts</span>
<a name="ln-107"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QSourceEnergy</span>                      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side heat transfer Joules</span>
<a name="ln-108"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LoadSideWaterInletTemp</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Load Side outlet temperature °C</span>
<a name="ln-109"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SourceSideWaterInletTemp</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side outlet temperature °C</span>
<a name="ln-110"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LoadSideWaterOutletTemp</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Load Side outlet temperature °C</span>
<a name="ln-111"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SourceSideWaterOutletTemp</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side outlet temperature °C</span>
<a name="ln-112"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LoadSidemdot</span>                       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Mass flow rate of the cooling water in Load Side Kg/s</span>
<a name="ln-113"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SourceSidemdot</span>                     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Mass flow rate of chilled water in Eavporator Kg/s</span>
<a name="ln-114"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">Running</span>                             <span class="o">=</span> <span class="mi">0</span>   <span class="c">! On reporting Flag</span>
<a name="ln-115"></a><span class="k">END TYPE </span><span class="n">ReportVars</span>
<a name="ln-116"></a>
<a name="ln-117"></a>
<a name="ln-118"></a>  <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-119"></a>
<a name="ln-120"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">GSHPSpecs</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>  <span class="kd">::</span><span class="n">GSHP</span>   <span class="c">!dimension to number of machines</span>
<a name="ln-121"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">ReportVars</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">GSHPReport</span>
<a name="ln-122"></a>
<a name="ln-123"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">GSHPRefrigerant</span><span class="o">=</span><span class="s1">&#39;R22&#39;</span>            <span class="c">! Refrigerent name and index</span>
<a name="ln-124"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">GSHPRefrigIndex</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-125"></a>
<a name="ln-126"></a>  <span class="kt">INTEGER</span>         <span class="kd">::</span> <span class="n">NumGSHPs</span>                      <span class="o">=</span> <span class="mi">0</span>   <span class="c">! number of Gshps specified in input</span>
<a name="ln-127"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">LoadSideWaterMassFlowRate</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Load Side mass flow rate, water side Kg/s</span>
<a name="ln-128"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">SourceSideWaterMassFlowRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side mass flow rate, water side Kg/s</span>
<a name="ln-129"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">Power</span>                         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! power consumption Watts Joules/sec</span>
<a name="ln-130"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">QLoad</span>                         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! heat rejection from Load Side coil Joules</span>
<a name="ln-131"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">QSource</span>                       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! cooling capacity Joules</span>
<a name="ln-132"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">SourceSideWaterOutletTemp</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side outlet temperature °C</span>
<a name="ln-133"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">SourceSideWaterInletTemp</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side outlet temperature °C</span>
<a name="ln-134"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">LoadSideWaterOutletTemp</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side outlet temperature °C</span>
<a name="ln-135"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">LoadSideWaterInletTemp</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side outlet temperature °C</span>
<a name="ln-136"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckEquipName</span>
<a name="ln-137"></a>
<a name="ln-138"></a>
<a name="ln-139"></a>  <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE</span>
<a name="ln-140"></a>
<a name="ln-141"></a>  <span class="c">! Name Public routines, optionally name Private routines within this module</span>
<a name="ln-142"></a><span class="k">PUBLIC     </span><span class="n">SimHPWatertoWaterHEATING</span>
<a name="ln-143"></a><span class="k">PRIVATE    </span><span class="n">CalcGshpModel</span>
<a name="ln-144"></a><span class="k">PRIVATE    </span><span class="n">GetGshpInput</span>
<a name="ln-145"></a><span class="k">PRIVATE    </span><span class="n">InitGshp</span>
<a name="ln-146"></a><span class="k">PRIVATE    </span><span class="n">UpdateGSHPRecords</span>
<a name="ln-147"></a>
<a name="ln-148"></a>
<a name="ln-149"></a>
<a name="ln-150"></a><span class="k">CONTAINS</span>
<a name="ln-151"></a>         <span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-152"></a>
<a name="ln-153"></a><span class="k">SUBROUTINE </span><span class="n">SimHPWatertoWaterHEATING</span><span class="p">(</span><span class="n">GSHPType</span><span class="p">,</span> <span class="n">GSHPName</span><span class="p">,</span> <span class="n">CompIndex</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-154"></a>                                    <span class="n">InitLoopEquip</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">,</span> <span class="n">MaxCap</span><span class="p">,</span> <span class="n">MinCap</span><span class="p">,</span> <span class="n">OptCap</span><span class="p">,</span> <span class="n">LoopNum</span><span class="p">)</span>
<a name="ln-155"></a>          <span class="c">!       SUBROUTINE INFORMATION:</span>
<a name="ln-156"></a>          <span class="c">!       AUTHOR    Arun</span>
<a name="ln-157"></a>          <span class="c">!       DATE WRITTEN   Feb 2000</span>
<a name="ln-158"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-159"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-160"></a>
<a name="ln-161"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE: This is the  water to water Heat Pump driver.</span>
<a name="ln-162"></a>          <span class="c">! It gets the input for the models, initializes simulation variables, calls</span>
<a name="ln-163"></a>          <span class="c">! the appropriate model and sets up reporting variables.</span>
<a name="ln-164"></a>
<a name="ln-165"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-166"></a>
<a name="ln-167"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-168"></a>
<a name="ln-169"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-170"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">UpdateChillerComponentCondenserSide</span>
<a name="ln-171"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TypeOf_HPWaterEFHeating</span>
<a name="ln-172"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-173"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span>
<a name="ln-174"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-175"></a>
<a name="ln-176"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-177"></a>
<a name="ln-178"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-179"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GshpType</span>  <span class="c">! type ofGSHP</span>
<a name="ln-180"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GshpName</span>  <span class="c">! user specified name ofGSHP</span>
<a name="ln-181"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-182"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">LoopNum</span>
<a name="ln-183"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">CompIndex</span>
<a name="ln-184"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InitLoopEquip</span>   <span class="c">! If not zero, calculate the max load for operating conditions</span>
<a name="ln-185"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MyLoad</span>          <span class="c">! loop demand component will meet</span>
<a name="ln-186"></a>
<a name="ln-187"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-188"></a>          <span class="c">! na</span>
<a name="ln-189"></a>
<a name="ln-190"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-191"></a>          <span class="c">! na</span>
<a name="ln-192"></a>
<a name="ln-193"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-194"></a>          <span class="c">! na</span>
<a name="ln-195"></a>
<a name="ln-196"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-197"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>     <span class="kd">::</span> <span class="n">GetInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>    <span class="c">! then TRUE, calls subroutine to read input file.</span>
<a name="ln-198"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">MinCap</span>               <span class="c">! W - minimum operating capacity of GSHP</span>
<a name="ln-199"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">MaxCap</span>               <span class="c">! W - maximum operating capacity of GSHP</span>
<a name="ln-200"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">OptCap</span>               <span class="c">! W - optimal operating capacity of GSHP</span>
<a name="ln-201"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">GSHPNum</span>
<a name="ln-202"></a>
<a name="ln-203"></a>
<a name="ln-204"></a>    <span class="c">!Get input from IDF</span>
<a name="ln-205"></a>
<a name="ln-206"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-207"></a><span class="k">    CALL </span><span class="n">GetGshpInput</span>
<a name="ln-208"></a>    <span class="n">GetInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-209"></a>  <span class="k">END IF</span>
<a name="ln-210"></a>
<a name="ln-211"></a>  <span class="c">! Find the correct Equipment</span>
<a name="ln-212"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-213"></a><span class="k">    </span><span class="n">GSHPNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span> <span class="n">GSHPName</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">NumGSHPs</span> <span class="p">)</span>
<a name="ln-214"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GSHPNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-215"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimHPWatertoWaterHEATING: Unit not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">))</span>
<a name="ln-216"></a>    <span class="n">ENDIF</span>
<a name="ln-217"></a>    <span class="n">CompIndex</span><span class="o">=</span><span class="n">GSHPNum</span>
<a name="ln-218"></a>  <span class="k">ELSE</span>
<a name="ln-219"></a><span class="k">    </span><span class="n">GSHPNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-220"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GSHPNum</span> <span class="o">&gt;</span> <span class="n">NumGSHPs</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">GSHPNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-221"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimHPWatertoWaterHEATING:  Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-222"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-223"></a>                          <span class="s1">&#39;, Number of Units=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumGSHPs</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-224"></a>                          <span class="s1">&#39;, Entered Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">))</span>
<a name="ln-225"></a>    <span class="n">ENDIF</span>
<a name="ln-226"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-227"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GSHPName</span> <span class="o">/=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-228"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimHPWatertoWaterHEATING: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-229"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-230"></a>                            <span class="s1">&#39;, Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Unit Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-231"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-232"></a>      <span class="n">ENDIF</span>
<a name="ln-233"></a>      <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-234"></a>    <span class="n">ENDIF</span>
<a name="ln-235"></a>  <span class="n">ENDIF</span>
<a name="ln-236"></a>
<a name="ln-237"></a>     <span class="c">! Calculate Demand on heat pump</span>
<a name="ln-238"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-239"></a><span class="k">    </span><span class="n">MinCap</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">NomCap</span><span class="o">*</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MinPartLoadRat</span>
<a name="ln-240"></a>    <span class="n">MaxCap</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">NomCap</span><span class="o">*</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MaxPartLoadRat</span>
<a name="ln-241"></a>    <span class="n">OptCap</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">NomCap</span><span class="o">*</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">OptPartLoadRat</span>
<a name="ln-242"></a>    <span class="k">Return</span>
<a name="ln-243"></a><span class="k">  END IF</span>
<a name="ln-244"></a>
<a name="ln-245"></a> <span class="c">! Simulate the model for the Demand &quot;MyLoad&quot;</span>
<a name="ln-246"></a>
<a name="ln-247"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">LoopNum</span> <span class="o">==</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! chilled water loop</span>
<a name="ln-248"></a>   <span class="k">CALL </span><span class="n">InitGshp</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span>
<a name="ln-249"></a>   <span class="k">CALL </span><span class="n">CalcGshpModel</span><span class="p">(</span> <span class="n">GSHPType</span><span class="p">,</span> <span class="n">GSHPName</span><span class="p">,</span> <span class="n">GSHPNum</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-250"></a>   <span class="k">CALL </span><span class="n">UpdateGshpRecords</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span>
<a name="ln-251"></a> <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">LoopNum</span> <span class="o">==</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! condenser loop</span>
<a name="ln-252"></a>   <span class="k">CALL </span><span class="n">UpdateChillerComponentCondenserSide</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-253"></a>                                     <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-254"></a>                                     <span class="n">TypeOf_HPWaterEFHeating</span><span class="p">,</span>                     <span class="p">&amp;</span>
<a name="ln-255"></a>                                     <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-256"></a>                                     <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-257"></a>                                     <span class="o">-</span> <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-258"></a>                                     <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterInletTemp</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-259"></a>                                     <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterOutletTemp</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-260"></a>                                     <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSidemdot</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-261"></a>                                     <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-262"></a> <span class="k">ELSE</span>
<a name="ln-263"></a><span class="k">   CALL </span><span class="n">ShowFatalError</span> <span class="p">(</span><span class="s1">&#39;SimHPWatertoWaterHEATING:: Invalid loop connection &#39;</span><span class="o">//</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;, Requested Unit=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">))</span>
<a name="ln-264"></a> <span class="n">ENDIF</span>
<a name="ln-265"></a>
<a name="ln-266"></a><span class="k">RETURN</span>
<a name="ln-267"></a><span class="k">END SUBROUTINE </span><span class="n">SimHPWatertoWaterHEATING</span>
<a name="ln-268"></a>
<a name="ln-269"></a><span class="k">SUBROUTINE </span><span class="n">GetGshpInput</span>
<a name="ln-270"></a>            <span class="c">!       SUBROUTINE INFORMATION:</span>
<a name="ln-271"></a>            <span class="c">!       AUTHOR:</span>
<a name="ln-272"></a>            <span class="c">!       DATE WRITTEN:    April 1998</span>
<a name="ln-273"></a>
<a name="ln-274"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-275"></a>            <span class="c">! This routine will get the input</span>
<a name="ln-276"></a>            <span class="c">! required by the GSHP models.  As such</span>
<a name="ln-277"></a>            <span class="c">! it will interact with the Input Scanner to retrieve</span>
<a name="ln-278"></a>            <span class="c">! information from the input file, count the number of</span>
<a name="ln-279"></a>            <span class="c">! GSHPs and begin to fill the</span>
<a name="ln-280"></a>            <span class="c">! arrays associated with the type GSHP.</span>
<a name="ln-281"></a>
<a name="ln-282"></a>
<a name="ln-283"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-284"></a>
<a name="ln-285"></a>            <span class="c">! REFERENCES:</span>
<a name="ln-286"></a>
<a name="ln-287"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-288"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TypeOf_HPWaterPEHeating</span><span class="p">,</span> <span class="n">ScanPlantLoopsForObject</span>
<a name="ln-289"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>        <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-290"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span>      <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-291"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-292"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>       <span class="n">ONLY</span> <span class="p">:</span> <span class="n">FindRefrigerant</span>
<a name="ln-293"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-294"></a>
<a name="ln-295"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-296"></a>
<a name="ln-297"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-298"></a>          <span class="c">! na</span>
<a name="ln-299"></a>
<a name="ln-300"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-301"></a>          <span class="c">! na</span>
<a name="ln-302"></a>
<a name="ln-303"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-304"></a>          <span class="c">! na</span>
<a name="ln-305"></a>
<a name="ln-306"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-307"></a>          <span class="c">! na</span>
<a name="ln-308"></a>
<a name="ln-309"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-310"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">GshpNum</span>                    <span class="c">!Gshp counter</span>
<a name="ln-311"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumAlphas</span>                 <span class="c">! Number of elements in the alpha array</span>
<a name="ln-312"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumNums</span>                   <span class="c">! Number of elements in the numeric array</span>
<a name="ln-313"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">IOStat</span>                    <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-314"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">AlphArray</span> <span class="c">!character string data</span>
<a name="ln-315"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>                        <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NumArray</span>  <span class="c">!numeric data</span>
<a name="ln-316"></a>
<a name="ln-317"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-318"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsNotOk</span>          <span class="c">! Flag to verify name</span>
<a name="ln-319"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsBlank</span>          <span class="c">! Flag for blank name</span>
<a name="ln-320"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-321"></a>
<a name="ln-322"></a>  <span class="n">NumGshps</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="p">)</span>
<a name="ln-323"></a>
<a name="ln-324"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">NumGshps</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-325"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;: No Equipment found&#39;</span><span class="p">)</span>
<a name="ln-326"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-327"></a> <span class="k">END IF</span>
<a name="ln-328"></a>
<a name="ln-329"></a>   <span class="c">! Allocate Arrays</span>
<a name="ln-330"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">NumGshps</span><span class="p">))</span>
<a name="ln-331"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">GshpReport</span><span class="p">(</span><span class="n">NumGshps</span><span class="p">))</span>
<a name="ln-332"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">NumGshps</span><span class="p">))</span>
<a name="ln-333"></a>  <span class="n">CheckEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-334"></a>
<a name="ln-335"></a>
<a name="ln-336"></a>  <span class="k">DO </span><span class="n">GshpNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumGshps</span>
<a name="ln-337"></a>   <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">ModuleCompNameUC</span><span class="p">,</span><span class="n">GshpNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">)</span>
<a name="ln-338"></a>        <span class="n">IsNotOk</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-339"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-340"></a>   <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">GSHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">GSHPNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ISNotOK</span><span class="p">,</span><span class="n">ISBlank</span><span class="p">,</span><span class="s1">&#39;GHSP Name&#39;</span><span class="p">)</span>
<a name="ln-341"></a>
<a name="ln-342"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">ISNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-343"></a><span class="k">       </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-344"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">ISBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-345"></a>   <span class="k">END IF</span>
<a name="ln-346"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span>                <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-347"></a>
<a name="ln-348"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">WWHPPlantTypeOfNum</span>    <span class="o">=</span> <span class="n">TypeOf_HPWaterPEHeating</span>
<a name="ln-349"></a>
<a name="ln-350"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">COP</span>                 <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-351"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-352"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:COP = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-353"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-354"></a>    <span class="k">END IF</span>
<a name="ln-355"></a>
<a name="ln-356"></a>    <span class="c">! zero values for NumArray 3 - 6 checked in input - idd</span>
<a name="ln-357"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">NomCap</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-358"></a>
<a name="ln-359"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MinPartLoadRat</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-360"></a>
<a name="ln-361"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MaxPartLoadRat</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-362"></a>
<a name="ln-363"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">OptPartLoadRat</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-364"></a>
<a name="ln-365"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideVolFlowRate</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-366"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-367"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Load Side Flow Rate = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-368"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-369"></a>    <span class="k">END IF</span>
<a name="ln-370"></a>
<a name="ln-371"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideVolFlowRate</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-372"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-373"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Source Side Flow Rate = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-374"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-375"></a>    <span class="k">END IF</span>
<a name="ln-376"></a>
<a name="ln-377"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideUACoeff</span>          <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-378"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-379"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Load Side Heat Transfer Coeffcient = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-380"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-381"></a>    <span class="k">END IF</span>
<a name="ln-382"></a>
<a name="ln-383"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideUACoeff</span>          <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-384"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-385"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Source Side Heat Transfer Coeffcient = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-386"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-387"></a>    <span class="k">END IF</span>
<a name="ln-388"></a>
<a name="ln-389"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CompPistonDisp</span>       <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-390"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-391"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Compressor Piston displacement/Storke = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-392"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-393"></a>    <span class="k">END IF</span>
<a name="ln-394"></a>
<a name="ln-395"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CompClearanceFactor</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-396"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-397"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Compressor Clearance Factor = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-398"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-399"></a>    <span class="k">END IF</span>
<a name="ln-400"></a>
<a name="ln-401"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CompSucPressDrop</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-402"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-403"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;: Pressure Drop = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-404"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-405"></a>    <span class="k">END IF</span>
<a name="ln-406"></a>
<a name="ln-407"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SuperheatTemp</span>        <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-408"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-409"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Source Side SuperHeat = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-410"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-411"></a>    <span class="k">END IF</span>
<a name="ln-412"></a>
<a name="ln-413"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">PowerLosses</span>          <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-414"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-415"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Compressor Power Loss = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-416"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-417"></a>    <span class="k">END IF</span>
<a name="ln-418"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LossFactor</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-419"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-420"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Efficiency = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-421"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-422"></a>    <span class="k">END IF</span>
<a name="ln-423"></a>
<a name="ln-424"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HighPressCutOff</span>        <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-425"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-426"></a><span class="k">       </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HighPressCutOff</span>        <span class="o">=</span> <span class="mi">50000000</span><span class="mf">0.0d0</span>
<a name="ln-427"></a>       <span class="c">!CALL ShowWarningError(ModuleCompName//&#39;: High Pressure Cut Off= 0.0 Heat Pump&#39;//TRIM(AlphArray(1)))</span>
<a name="ln-428"></a>    <span class="k">END IF</span>
<a name="ln-429"></a>
<a name="ln-430"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LowPressCutOff</span>        <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-431"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-432"></a><span class="k">       </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LowPressCutOff</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-433"></a>       <span class="c">!CALL ShowWarningError(ModuleCompName//&#39;: Low Pressure Cut Off= 0.0 Heat Pump&#39;//TRIM(AlphArray(1)))</span>
<a name="ln-434"></a>    <span class="k">END IF</span>
<a name="ln-435"></a>
<a name="ln-436"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span>   <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-437"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">ModuleCompName</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-438"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-439"></a>
<a name="ln-440"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-441"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">ModuleCompName</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-442"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-443"></a>
<a name="ln-444"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span>    <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-445"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">ModuleCompName</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-446"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-447"></a>
<a name="ln-448"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletNodeNum</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-449"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">ModuleCompName</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-450"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-451"></a>
<a name="ln-452"></a>
<a name="ln-453"></a>    <span class="c">! Test node sets</span>
<a name="ln-454"></a>    <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">ModuleCompNameUC</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Condenser Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-455"></a>    <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">ModuleCompNameUC</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;Hot Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-456"></a>
<a name="ln-457"></a>    <span class="c">! save the design source side flow rate for use by plant loop sizing algorithms</span>
<a name="ln-458"></a>    <span class="k">CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideVolFlowRate</span><span class="p">)</span>
<a name="ln-459"></a>
<a name="ln-460"></a>  <span class="k">END DO</span>
<a name="ln-461"></a>
<a name="ln-462"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-463"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors Found in getting &#39;</span><span class="o">//</span><span class="n">ModuleCompNameUC</span><span class="o">//</span><span class="s1">&#39; Input&#39;</span><span class="p">)</span>
<a name="ln-464"></a>  <span class="k">END IF</span>
<a name="ln-465"></a>
<a name="ln-466"></a><span class="k">  </span><span class="n">GSHPRefrigIndex</span><span class="o">=</span><span class="n">FindRefrigerant</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">)</span>
<a name="ln-467"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GSHPRefrigIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-468"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Refrigerant for HeatPump:WaterToWater Heating not found, should have been=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">))</span>
<a name="ln-469"></a>  <span class="n">ENDIF</span>
<a name="ln-470"></a>
<a name="ln-471"></a>  <span class="c">! CurrentModuleObject=&#39;HeatPump:WaterToWater:ParameterEstimation:Heating&#39;</span>
<a name="ln-472"></a>  <span class="k">DO </span><span class="n">GSHPNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumGshps</span>
<a name="ln-473"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-474"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Power</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-475"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-476"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Energy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-477"></a>        <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Heating&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-478"></a>
<a name="ln-479"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Load Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-480"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoad</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-481"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Load Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-482"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoadEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-483"></a>
<a name="ln-484"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Source Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-485"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-486"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Source Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-487"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSourceEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-488"></a>
<a name="ln-489"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Load Side Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-490"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterOutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-491"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Load Side Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-492"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-493"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Source Side Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-494"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterOutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-495"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Source Side Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-496"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-497"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Load Side Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-498"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSidemdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-499"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Source Side Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-500"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSidemdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-501"></a>
<a name="ln-502"></a>    <span class="c">!scan for loop connection data</span>
<a name="ln-503"></a>   <span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-504"></a>    <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-505"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">WWHPPlantTypeOfNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-506"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-507"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-508"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-509"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceCompNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-510"></a>                                 <span class="n">inletNodeNumber</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-511"></a>                                 <span class="n">errflag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-512"></a>    <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-513"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">WWHPPlantTypeOfNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-514"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-515"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-516"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-517"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadCompNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-518"></a>                                 <span class="n">inletNodeNumber</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-519"></a>                                 <span class="n">errflag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-520"></a>
<a name="ln-521"></a>
<a name="ln-522"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-523"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;GetWatertoWaterHPInput: Program terminated on scan for loop data&#39;</span><span class="p">)</span>
<a name="ln-524"></a>    <span class="n">ENDIF</span>
<a name="ln-525"></a>
<a name="ln-526"></a>
<a name="ln-527"></a>  <span class="k">END DO</span>
<a name="ln-528"></a>
<a name="ln-529"></a><span class="k">RETURN</span>
<a name="ln-530"></a><span class="k">END SUBROUTINE </span><span class="n">GetGshpInput</span>
<a name="ln-531"></a>
<a name="ln-532"></a><span class="k">SUBROUTINE </span><span class="n">InitGshp</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span>
<a name="ln-533"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-534"></a>            <span class="c">!       AUTHOR:          Dan Fisher</span>
<a name="ln-535"></a>            <span class="c">!       DATE WRITTEN:    July 2007</span>
<a name="ln-536"></a>
<a name="ln-537"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-538"></a>            <span class="c">! initialization</span>
<a name="ln-539"></a>
<a name="ln-540"></a>
<a name="ln-541"></a>            <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-542"></a>
<a name="ln-543"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-544"></a>
<a name="ln-545"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-546"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-547"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span>
<a name="ln-548"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">InitComponentNodes</span>
<a name="ln-549"></a>
<a name="ln-550"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-551"></a>
<a name="ln-552"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-553"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">GSHPNum</span>       <span class="c">! GSHP number</span>
<a name="ln-554"></a>
<a name="ln-555"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-556"></a>          <span class="c">! na</span>
<a name="ln-557"></a>
<a name="ln-558"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-559"></a>          <span class="c">! na</span>
<a name="ln-560"></a>
<a name="ln-561"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-562"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>  <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>  <span class="kd">::</span> <span class="n">MyEnvrnFlag</span>
<a name="ln-563"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>  <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>  <span class="kd">::</span> <span class="n">MyPlanScanFlag</span>
<a name="ln-564"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-565"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">rho</span>  <span class="c">! local fluid density</span>
<a name="ln-566"></a>
<a name="ln-567"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-568"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">MyPlanScanFlag</span><span class="p">(</span><span class="n">NumGSHPs</span><span class="p">))</span>
<a name="ln-569"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumGSHPs</span><span class="p">))</span>
<a name="ln-570"></a>    <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-571"></a>    <span class="n">MyEnvrnFlag</span>  <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-572"></a>    <span class="n">MyPlanScanFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-573"></a>  <span class="k">END IF</span>
<a name="ln-574"></a>
<a name="ln-575"></a>
<a name="ln-576"></a>  <span class="c">!For each new environment</span>
<a name="ln-577"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">))</span><span class="k">Then</span>
<a name="ln-578"></a><span class="k">    </span><span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-579"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-580"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Power</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-581"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoadEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-582"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSourceEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-583"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Energy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-584"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterInletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-585"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterInletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-586"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterOutletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-587"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterOutletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-588"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSidemdot</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-589"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSidemdot</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-590"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">isOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-591"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-592"></a>
<a name="ln-593"></a>    <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-594"></a>
<a name="ln-595"></a>    <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-596"></a>                         <span class="n">InitconvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-597"></a>                         <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-598"></a>                         <span class="s1">&#39;InitGshp&#39;</span><span class="p">)</span>
<a name="ln-599"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideDesignMassFlow</span>   <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-600"></a>
<a name="ln-601"></a>    <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideDesignMassFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-602"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-603"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-604"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-605"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-606"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-607"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadCompNum</span><span class="p">)</span>
<a name="ln-608"></a>
<a name="ln-609"></a>    <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-610"></a>                         <span class="n">InitconvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-611"></a>                         <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-612"></a>                         <span class="s1">&#39;InitGshp&#39;</span><span class="p">)</span>
<a name="ln-613"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideDesignMassFlow</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-614"></a>
<a name="ln-615"></a>    <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span> <span class="mf">0.d0</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideDesignMassFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-616"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-617"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-618"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-619"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-620"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-621"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceCompNum</span><span class="p">)</span>
<a name="ln-622"></a>
<a name="ln-623"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPoint</span> <span class="o">==</span> <span class="n">SensedNodeFlagValue</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-624"></a>                       <span class="n">Node</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPoint</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-625"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPoint</span><span class="o">+</span><span class="mi">30</span>
<a name="ln-626"></a>
<a name="ln-627"></a>  <span class="k">END IF</span>
<a name="ln-628"></a>
<a name="ln-629"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span><span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-630"></a>
<a name="ln-631"></a>  <span class="c">!On every call</span>
<a name="ln-632"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Running</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-633"></a>
<a name="ln-634"></a>  <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>        <span class="c">! Reset MustRun Flag to TRUE</span>
<a name="ln-635"></a>
<a name="ln-636"></a>  <span class="n">LoadSideWaterMassFlowRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Load Side mass flow rate, water side</span>
<a name="ln-637"></a>  <span class="n">SourceSideWaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Source Side mass flow rate, water side</span>
<a name="ln-638"></a>  <span class="n">Power</span>   <span class="o">=</span> <span class="mf">0.0d0</span>                         <span class="c">! power consumption</span>
<a name="ln-639"></a>  <span class="n">QLoad</span>   <span class="o">=</span> <span class="mf">0.0d0</span>                         <span class="c">! heat rejection from Load Side coil</span>
<a name="ln-640"></a>  <span class="n">QSource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-641"></a>
<a name="ln-642"></a><span class="k">RETURN</span>
<a name="ln-643"></a><span class="k">END SUBROUTINE </span><span class="n">InitGshp</span>
<a name="ln-644"></a>
<a name="ln-645"></a>
<a name="ln-646"></a><span class="k">SUBROUTINE </span><span class="n">CalcGshpModel</span><span class="p">(</span> <span class="n">GSHPType</span><span class="p">,</span> <span class="n">GSHPName</span><span class="p">,</span> <span class="n">GSHPNum</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span> <span class="p">)</span>
<a name="ln-647"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-648"></a>          <span class="c">!       AUTHOR</span>
<a name="ln-649"></a>          <span class="c">!       DATE WRITTEN   Sept. 1998</span>
<a name="ln-650"></a>          <span class="c">!       MODIFIED       April 1999</span>
<a name="ln-651"></a>          <span class="c">!                      September 2002, SJR</span>
<a name="ln-652"></a>          <span class="c">!       RE-ENGINEERED  Mar2000</span>
<a name="ln-653"></a>
<a name="ln-654"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE: This routine performs</span>
<a name="ln-655"></a>
<a name="ln-656"></a>          <span class="c">! METHODOLOGY EMPLOYED: under development</span>
<a name="ln-657"></a>
<a name="ln-658"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-659"></a>
<a name="ln-660"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-661"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TimeStepSys</span> <span class="p">,</span><span class="n">SysTimeElapsed</span><span class="p">,</span> <span class="n">FirstTimeStepSysFlag</span>
<a name="ln-662"></a>  <span class="k">USE </span><span class="n">FluidProperties</span>
<a name="ln-663"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-664"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-665"></a>  <span class="k">USE </span><span class="n">DataBranchAirLoopPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MassFlowTolerance</span>
<a name="ln-666"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-667"></a>
<a name="ln-668"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-669"></a>
<a name="ln-670"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-671"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GshpType</span>  <span class="c">! type ofGSHP</span>
<a name="ln-672"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GshpName</span>  <span class="c">! user specified name ofGSHP</span>
<a name="ln-673"></a>  <span class="kt">INTEGER</span>  <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">GSHPNum</span>      <span class="c">! GSHP Number</span>
<a name="ln-674"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">MyLoad</span>           <span class="c">! Operating Load</span>
<a name="ln-675"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-676"></a>
<a name="ln-677"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-678"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="nb">gamma</span>            <span class="o">=</span> <span class="mf">1.114d0</span>             <span class="c">! Expnasion Coefficient</span>
<a name="ln-679"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">HeatBalTol</span>       <span class="o">=</span> <span class="mf">0.0005d0</span>
<a name="ln-680"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">RelaxParam</span>       <span class="o">=</span> <span class="mf">0.6d0</span>
<a name="ln-681"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">SmallNum</span>         <span class="o">=</span> <span class="mf">1.0d-20</span>
<a name="ln-682"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>     <span class="kd">::</span> <span class="n">IterationLimit</span>   <span class="o">=</span> <span class="mi">500</span>
<a name="ln-683"></a>
<a name="ln-684"></a>
<a name="ln-685"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-686"></a>          <span class="c">! na</span>
<a name="ln-687"></a>
<a name="ln-688"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-689"></a>          <span class="c">! na</span>
<a name="ln-690"></a>
<a name="ln-691"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-692"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideEffect</span>         <span class="c">! Source Side effectiveness</span>
<a name="ln-693"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideEffect</span>           <span class="c">! Load Side effectiveness</span>
<a name="ln-694"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideTemp</span>           <span class="c">! Source Side temperature °C</span>
<a name="ln-695"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideTemp</span>             <span class="c">! Load Side temperature °C</span>
<a name="ln-696"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideUA</span>             <span class="c">! Source Side heat transfer coefficient    w/k</span>
<a name="ln-697"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideUA</span>               <span class="c">! Load Side heat transfer coefficient W/k</span>
<a name="ln-698"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSidePressure</span>       <span class="c">! Source Side pressure Pascals</span>
<a name="ln-699"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSidePressure</span>         <span class="c">! Load Side pressure Pascals</span>
<a name="ln-700"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SuctionPr</span>                <span class="c">! Suction Pressure  pascals</span>
<a name="ln-701"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">DischargePr</span>              <span class="c">! Discharge Pressure pascals</span>
<a name="ln-702"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CompressInletTemp</span>        <span class="c">! Compressor inlet temperature  °C</span>
<a name="ln-703"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">PressureDrop</span>             <span class="c">! Suction Pressure drop °C</span>
<a name="ln-704"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">ClearanceFactor</span>          <span class="c">! Clearance factor</span>
<a name="ln-705"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">PistonDisp</span>               <span class="c">! Compressor piston displacement  m3</span>
<a name="ln-706"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">ShTemp</span>                   <span class="c">! Superheat temperature °C</span>
<a name="ln-707"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LosFac</span>                   <span class="c">! Loss factor used to define the electromechanical loss for compressor</span>
<a name="ln-708"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">MassRef</span>                  <span class="c">! mass flow rate of refrigerant Kg/s</span>
<a name="ln-709"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideOutletEnth</span>     <span class="c">! Enthalpy at Source Side pressure Joules</span>
<a name="ln-710"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideOutletEnth</span>       <span class="c">! Enthalpy at Condensor Pressure  Joules</span>
<a name="ln-711"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">initialQSource</span>           <span class="c">! Guess Source Side Heat rate Joules</span>
<a name="ln-712"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">initialQLoad</span>             <span class="c">! Guess Load Side Heat rate Joules</span>
<a name="ln-713"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">qual</span>                     <span class="c">! quality</span>
<a name="ln-714"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SuperHeatEnth</span>
<a name="ln-715"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">T110</span>
<a name="ln-716"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">T111</span>
<a name="ln-717"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CompSuctionTemp</span>
<a name="ln-718"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CompSuctionEnth</span>
<a name="ln-719"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CompSuctionDensity</span>
<a name="ln-720"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">PowerLosses</span>
<a name="ln-721"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CompSuctionSatTemp</span>
<a name="ln-722"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">HighPressCutOff</span>
<a name="ln-723"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LowPressCutOff</span>
<a name="ln-724"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">ErrString</span>
<a name="ln-725"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">DutyFactor</span>
<a name="ln-726"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">IterationCount</span>
<a name="ln-727"></a>
<a name="ln-728"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">CurrentSimTime</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-729"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">PrevSimTime</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-730"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>          <span class="kd">::</span> <span class="n">OneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-731"></a>  <span class="c">! Nodes</span>
<a name="ln-732"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">SourceSideInletNode</span>      <span class="c">! Source Side inlet node number, water side</span>
<a name="ln-733"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">SourceSideOutletNode</span>     <span class="c">! Source Side outlet node number, water side</span>
<a name="ln-734"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">LoadSideInletNode</span>        <span class="c">! Load Side inlet node number, water side</span>
<a name="ln-735"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">LoadSideOutletNode</span>       <span class="c">! Load Side outlet node number, water side</span>
<a name="ln-736"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopNum</span>
<a name="ln-737"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopSideNum</span>
<a name="ln-738"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpSourceSide</span> <span class="c">! local temporary for fluid specific heat</span>
<a name="ln-739"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpLoadSide</span> <span class="c">! local temporary for fluid specific heat</span>
<a name="ln-740"></a>
<a name="ln-741"></a>  <span class="c">!  LOAD LOCAL VARIABLES FROM DATA STRUCTURE (for code readability)</span>
<a name="ln-742"></a>  <span class="n">PressureDrop</span>      <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CompSucPressDrop</span>
<a name="ln-743"></a>  <span class="n">ClearanceFactor</span>   <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CompClearanceFactor</span>
<a name="ln-744"></a>  <span class="n">PistonDisp</span>        <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CompPistonDisp</span>
<a name="ln-745"></a>  <span class="n">ShTemp</span>            <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SuperheatTemp</span>
<a name="ln-746"></a>  <span class="n">LosFac</span>            <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LossFactor</span>
<a name="ln-747"></a>  <span class="n">SourceSideUA</span>      <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideUACoeff</span>
<a name="ln-748"></a>  <span class="n">LoadSideUA</span>        <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideUACoeff</span>
<a name="ln-749"></a>  <span class="n">PowerLosses</span>       <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">PowerLosses</span>
<a name="ln-750"></a>  <span class="n">HighPressCutOff</span>   <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HighPressCutOff</span>
<a name="ln-751"></a>  <span class="n">LowPressCutOff</span>    <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LowPressCutOff</span>
<a name="ln-752"></a>  <span class="c">! REPORT VAR</span>
<a name="ln-753"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Running</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-754"></a>
<a name="ln-755"></a>  <span class="c">! Init Module level Variables</span>
<a name="ln-756"></a>  <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>      <span class="c">! Reset MustRun Flag to TRUE</span>
<a name="ln-757"></a>  <span class="n">LoadSideWaterMassFlowRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Load Side mass flow rate, water side</span>
<a name="ln-758"></a>  <span class="n">SourceSideWaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! Source Side mass flow rate, water side</span>
<a name="ln-759"></a>  <span class="n">Power</span> <span class="o">=</span> <span class="mf">0.0d0</span>                         <span class="c">! power consumption</span>
<a name="ln-760"></a>  <span class="n">QLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>                         <span class="c">! heat rejection from Load Side coil</span>
<a name="ln-761"></a>  <span class="n">QSource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-762"></a>
<a name="ln-763"></a>  <span class="n">LoadSideInletNode</span>    <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span>
<a name="ln-764"></a>  <span class="n">LoadSideOutletNode</span>   <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletNodeNum</span>
<a name="ln-765"></a>  <span class="n">SourceSideInletNode</span>  <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span>
<a name="ln-766"></a>  <span class="n">SourceSideOutletNode</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span>
<a name="ln-767"></a>  <span class="n">LoopNum</span>              <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span>
<a name="ln-768"></a>  <span class="n">LoopSideNum</span>          <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span>
<a name="ln-769"></a>
<a name="ln-770"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">PrevSimTime</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">CurrentSimTime</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-771"></a><span class="k">     </span><span class="n">PrevSimTime</span> <span class="o">=</span> <span class="n">CurrentSimTime</span>
<a name="ln-772"></a>  <span class="k">END IF</span>
<a name="ln-773"></a>
<a name="ln-774"></a>  <span class="c">! CALCULATE THE SIMULATION TIME</span>
<a name="ln-775"></a>  <span class="n">CurrentSimTime</span> <span class="o">=</span> <span class="p">(</span><span class="n">dayofSim</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">24</span> <span class="o">+</span> <span class="n">hourofday</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">timestep</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">timestepZone</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-776"></a>
<a name="ln-777"></a>  <span class="c">! initialize event time array when the environment simulation begins</span>
<a name="ln-778"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">CurrentSimTime</span> <span class="o">==</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">OneTimeFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-779"></a><span class="k">    </span><span class="n">OneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-780"></a>  <span class="k">END IF</span>
<a name="ln-781"></a>
<a name="ln-782"></a><span class="k">  IF</span><span class="p">(</span><span class="n">CurrentSimTime</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">)</span><span class="n">OneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-783"></a>
<a name="ln-784"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">MyLoad</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-785"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-786"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">IsOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-787"></a>  <span class="k">ELSE</span>
<a name="ln-788"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-789"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">IsOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-790"></a>  <span class="k">END IF</span>
<a name="ln-791"></a>
<a name="ln-792"></a>
<a name="ln-793"></a><span class="c">!*******Set flow based on &quot;run&quot; flags**********</span>
<a name="ln-794"></a><span class="c">! Set flows if the heat pump is not running</span>
<a name="ln-795"></a>  <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-796"></a><span class="k">    </span><span class="n">LoadSideWaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-797"></a>    <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">LoadSideWaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-798"></a>          <span class="n">LoadSideInletNode</span><span class="p">,</span> <span class="n">LoadSideOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-799"></a>          <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-800"></a>          <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadBranchNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadCompNum</span><span class="p">)</span>
<a name="ln-801"></a>    <span class="n">SourceSideWaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-802"></a>    <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">SourceSideWaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-803"></a>          <span class="n">SourceSideInletNode</span><span class="p">,</span> <span class="n">SourceSideOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-804"></a>          <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-805"></a>          <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceBranchNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceCompNum</span><span class="p">)</span>
<a name="ln-806"></a>        <span class="c">!now initialize simulation variables for &quot;heat pump off&quot;</span>
<a name="ln-807"></a>    <span class="n">QLoad</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-808"></a>    <span class="n">QSource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-809"></a>    <span class="n">Power</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-810"></a>    <span class="n">LoadSideWaterInletTemp</span>      <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-811"></a>    <span class="n">LoadSideWaterOutletTemp</span>     <span class="o">=</span> <span class="n">LoadSideWaterInletTemp</span>
<a name="ln-812"></a>    <span class="n">SourceSideWaterInletTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-813"></a>    <span class="n">SourceSideWaterOutletTemp</span>   <span class="o">=</span> <span class="n">SourceSideWaterInletTemp</span>
<a name="ln-814"></a>    <span class="k">RETURN</span> <span class="c">!if heat pump is not running return without simulation</span>
<a name="ln-815"></a>
<a name="ln-816"></a><span class="c">! Set flows if the heat pump is running</span>
<a name="ln-817"></a>  <span class="k">ELSE</span> <span class="c">! the heat pump must run, request design flow</span>
<a name="ln-818"></a>
<a name="ln-819"></a>    <span class="n">LoadSideWaterMassFlowRate</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideDesignMassFlow</span>
<a name="ln-820"></a>    <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">LoadSideWaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-821"></a>          <span class="n">LoadSideInletNode</span><span class="p">,</span> <span class="n">LoadSideOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-822"></a>          <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-823"></a>          <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadBranchNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadCompNum</span><span class="p">)</span>
<a name="ln-824"></a>
<a name="ln-825"></a>    <span class="n">SourceSideWaterMassFlowRate</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideDesignMassFlow</span>
<a name="ln-826"></a>    <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">SourceSideWaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-827"></a>          <span class="n">SourceSideInletNode</span><span class="p">,</span> <span class="n">SourceSideOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-828"></a>          <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-829"></a>          <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceBranchNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceCompNum</span><span class="p">)</span>
<a name="ln-830"></a>    <span class="c">! get inlet temps</span>
<a name="ln-831"></a>    <span class="n">LoadSideWaterInletTemp</span>      <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-832"></a>    <span class="n">SourceSideWaterInletTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-833"></a>    <span class="c">!if there&#39;s no flow, turn the &quot;heat pump off&quot;</span>
<a name="ln-834"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">LoadSideWaterMassFlowRate</span> <span class="o">&lt;</span> <span class="n">MassFlowTolerance</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-835"></a>         <span class="n">SourceSideWaterMassFlowRate</span> <span class="o">&lt;</span> <span class="n">MassFlowTolerance</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-836"></a><span class="k">        </span><span class="n">LoadSideWaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-837"></a>        <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">LoadSideWaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-838"></a>              <span class="n">LoadSideInletNode</span><span class="p">,</span> <span class="n">LoadSideOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-839"></a>              <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-840"></a>              <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadBranchNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadCompNum</span><span class="p">)</span>
<a name="ln-841"></a>        <span class="n">SourceSideWaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-842"></a>        <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">SourceSideWaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-843"></a>              <span class="n">SourceSideInletNode</span><span class="p">,</span> <span class="n">SourceSideOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-844"></a>              <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-845"></a>              <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceBranchNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceCompNum</span><span class="p">)</span>
<a name="ln-846"></a>        <span class="n">QLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-847"></a>        <span class="n">QSource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-848"></a>        <span class="n">Power</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-849"></a>        <span class="n">LoadSideWaterInletTemp</span>      <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-850"></a>        <span class="n">LoadSideWaterOutletTemp</span>     <span class="o">=</span> <span class="n">LoadSideWaterInletTemp</span>
<a name="ln-851"></a>        <span class="n">SourceSideWaterInletTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-852"></a>        <span class="n">SourceSideWaterOutletTemp</span>   <span class="o">=</span> <span class="n">SourceSideWaterInletTemp</span>
<a name="ln-853"></a>      <span class="k">RETURN</span>
<a name="ln-854"></a><span class="k">    END IF</span>
<a name="ln-855"></a><span class="k">  END IF</span>
<a name="ln-856"></a>
<a name="ln-857"></a><span class="c">!***********BEGIN CALCULATION****************</span>
<a name="ln-858"></a><span class="c">! initialize the source and load side heat transfer rates for the simulation</span>
<a name="ln-859"></a>  <span class="n">initialQSource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-860"></a>  <span class="n">initialQLoad</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-861"></a>  <span class="n">IterationCount</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-862"></a>
<a name="ln-863"></a>  <span class="n">CpSourceSide</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-864"></a>                                       <span class="n">SourceSideWaterInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-865"></a>                                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-866"></a>                                       <span class="s1">&#39;CalcGshpModel&#39;</span><span class="p">)</span>
<a name="ln-867"></a>
<a name="ln-868"></a>  <span class="n">CpLoadSide</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-869"></a>                                       <span class="n">LoadSideWaterInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-870"></a>                                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-871"></a>                                       <span class="s1">&#39;CalcGshpModel&#39;</span><span class="p">)</span>
<a name="ln-872"></a>
<a name="ln-873"></a>  <span class="c">! Determine effectiveness of Source Side (the Evaporator in heating mode)</span>
<a name="ln-874"></a>  <span class="n">SourceSideEffect</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">-</span> <span class="nb">EXP</span><span class="p">(</span> <span class="o">-</span><span class="n">SourceSideUA</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-875"></a>                            <span class="p">(</span><span class="n">CpSourceSide</span> <span class="o">*</span> <span class="n">SourceSideWaterMassFlowRate</span><span class="p">))</span>
<a name="ln-876"></a>  <span class="c">!Determine effectiveness of Load Side the condenser in heating mode</span>
<a name="ln-877"></a>  <span class="n">LoadSideEffect</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">-</span> <span class="nb">EXP</span> <span class="p">(</span> <span class="o">-</span><span class="n">LoadSideUA</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-878"></a>                           <span class="p">(</span><span class="n">CpLoadSide</span> <span class="o">*</span> <span class="n">LoadSideWaterMassFlowRate</span><span class="p">))</span>
<a name="ln-879"></a>
<a name="ln-880"></a>  <span class="n">LOOPLoadEnth</span><span class="p">:</span> <span class="k">DO</span>  <span class="c">! main loop to solve model equations</span>
<a name="ln-881"></a>    <span class="n">IterationCount</span> <span class="o">=</span> <span class="n">IterationCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-882"></a>    <span class="c">! Determine Source Side tempertaure</span>
<a name="ln-883"></a>    <span class="n">SourceSideTemp</span> <span class="o">=</span> <span class="n">SourceSideWaterInletTemp</span> <span class="o">-</span> <span class="n">initialQSource</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-884"></a>                     <span class="p">(</span><span class="n">SourceSideEffect</span> <span class="o">*</span> <span class="n">CpSourceSide</span> <span class="o">*</span> <span class="n">SourceSideWaterMassFlowRate</span><span class="p">)</span>
<a name="ln-885"></a>
<a name="ln-886"></a>    <span class="c">! To determine Load Side temperature condenser</span>
<a name="ln-887"></a>    <span class="n">LoadSideTemp</span> <span class="o">=</span> <span class="n">LoadSideWaterInletTemp</span> <span class="o">+</span> <span class="n">initialQLoad</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-888"></a>                   <span class="p">(</span><span class="n">LoadSideEffect</span> <span class="o">*</span> <span class="n">CpLoadSide</span> <span class="o">*</span> <span class="n">LoadSideWaterMassFlowRate</span><span class="p">)</span>
<a name="ln-889"></a>
<a name="ln-890"></a>    <span class="c">! Determine the evaporating and condensing pressures</span>
<a name="ln-891"></a>    <span class="n">SourceSidePressure</span> <span class="o">=</span> <span class="n">GetSatPressureRefrig</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">,</span><span class="n">SourceSideTemp</span><span class="p">,</span><span class="n">GSHPRefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcGSHPModel:SourceSideTemp&#39;</span><span class="p">)</span>
<a name="ln-892"></a>    <span class="n">LoadSidePressure</span> <span class="o">=</span> <span class="n">GetSatPressureRefrig</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">,</span><span class="n">LoadSideTemp</span><span class="p">,</span><span class="n">GSHPRefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcGSHPModel:LoadSideTemp&#39;</span><span class="p">)</span>
<a name="ln-893"></a>
<a name="ln-894"></a>    <span class="c">! check cutoff pressures</span>
<a name="ln-895"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SourceSidePressure</span> <span class="o">&lt;</span> <span class="n">LowPressCutOff</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-896"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Heating Source Side Pressure Less than the Design Minimum&#39;</span><span class="p">)</span>
<a name="ln-897"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Source Side Pressure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SourceSidePressure</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-898"></a>                             <span class="s1">&#39; and user specified Design Minimum Pressure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">LowPressCutoff</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-899"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding Conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-900"></a>    <span class="k">END IF</span>
<a name="ln-901"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">LoadSidePressure</span> <span class="o">&gt;</span> <span class="n">HighPressCutOff</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-902"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Heating Load Side Pressure greater than the Design Maximum&#39;</span><span class="p">)</span>
<a name="ln-903"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Load Side Pressure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">LoadSidePressure</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-904"></a>                             <span class="s1">&#39; and user specified Design Maximum Pressure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HighPressCutOff</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-905"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding Conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-906"></a>    <span class="k">END IF</span>
<a name="ln-907"></a>
<a name="ln-908"></a>    <span class="c">! Determine Suction Pressure at compressor inlet</span>
<a name="ln-909"></a>    <span class="n">SuctionPr</span> <span class="o">=</span> <span class="n">SourceSidePressure</span> <span class="o">-</span> <span class="n">PressureDrop</span>
<a name="ln-910"></a>    <span class="c">! Determine Discharge Pressure at compressor exit</span>
<a name="ln-911"></a>    <span class="n">DischargePr</span> <span class="o">=</span> <span class="n">LoadSidePressure</span> <span class="o">+</span> <span class="n">PressureDrop</span>
<a name="ln-912"></a>    <span class="c">! check cutoff pressures</span>
<a name="ln-913"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SuctionPr</span> <span class="o">&lt;</span> <span class="n">LowPressCutOff</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-914"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Heating Suction Pressure Less than the Design Minimum&#39;</span><span class="p">)</span>
<a name="ln-915"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heating Suction Pressure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SuctionPr</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-916"></a>                             <span class="s1">&#39; and user specified Design Minimum Pressure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">LowPressCutoff</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-917"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding Conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-918"></a>    <span class="k">END IF</span>
<a name="ln-919"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DischargePr</span> <span class="o">&gt;</span> <span class="n">HighPressCutOff</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-920"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Heating Discharge Pressure greater than the Design Maximum&#39;</span><span class="p">)</span>
<a name="ln-921"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heating Discharge Pressure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DischargePr</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-922"></a>                             <span class="s1">&#39; and user specified Design Maximum Pressure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HighPressCutOff</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-923"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding Conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-924"></a>    <span class="k">END IF</span>
<a name="ln-925"></a>
<a name="ln-926"></a>    <span class="c">! Determine the Source Side Outlet Enthalpy</span>
<a name="ln-927"></a>    <span class="n">qual</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-928"></a>    <span class="n">SourceSideOutletEnth</span> <span class="o">=</span> <span class="n">GetSatEnthalpyRefrig</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">,</span> <span class="n">SourceSideTemp</span><span class="p">,</span> <span class="n">qual</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-929"></a>       <span class="n">GSHPRefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcGSHPModel:SourceSideTemp&#39;</span><span class="p">)</span>
<a name="ln-930"></a>
<a name="ln-931"></a>    <span class="c">! Determine Load Side Outlet Enthalpy</span>
<a name="ln-932"></a>    <span class="n">qual</span><span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-933"></a>    <span class="n">LoadSideOutletEnth</span> <span class="o">=</span> <span class="n">GetSatEnthalpyRefrig</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">,</span><span class="n">LoadSideTemp</span><span class="p">,</span><span class="n">qual</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-934"></a>       <span class="n">GSHPRefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcGSHPModel:LoadSideTemp&#39;</span><span class="p">)</span>
<a name="ln-935"></a>
<a name="ln-936"></a>    <span class="c">! Determine superheated temperature of the Source Side outlet/compressor inlet</span>
<a name="ln-937"></a>    <span class="n">CompressInletTemp</span> <span class="o">=</span> <span class="n">SourceSideTemp</span> <span class="o">+</span> <span class="n">ShTemp</span>
<a name="ln-938"></a>    <span class="c">! Determine the enathalpy of the super heated fluid at Source Side outlet</span>
<a name="ln-939"></a>    <span class="n">SuperHeatEnth</span> <span class="o">=</span> <span class="n">GetSupHeatEnthalpyRefrig</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">,</span><span class="n">CompressInletTemp</span><span class="p">,</span><span class="n">SourceSidePressure</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-940"></a>       <span class="n">GSHPRefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcGSHPModel:CompressInletTemp&#39;</span><span class="p">)</span>
<a name="ln-941"></a>
<a name="ln-942"></a>    <span class="c">! Determining the suction state of the fluid from inlet state involves interation</span>
<a name="ln-943"></a>    <span class="c">! Method employed...</span>
<a name="ln-944"></a>    <span class="c">! Determine the saturated temp at suction pressure, shoot out into the superheated region find the enthalpy</span>
<a name="ln-945"></a>    <span class="c">! check that with the inlet enthalpy ( as suction loss is isenthalpic). Iterate till desired accuracy is reached</span>
<a name="ln-946"></a>
<a name="ln-947"></a>    <span class="n">CompSuctionSatTemp</span> <span class="o">=</span> <span class="n">GetSatTemperatureRefrig</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">,</span><span class="n">SuctionPr</span><span class="p">,</span><span class="n">GSHPRefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcGSHPModel:SuctionPr&#39;</span><span class="p">)</span>
<a name="ln-948"></a>
<a name="ln-949"></a>    <span class="n">T110</span> <span class="o">=</span> <span class="n">CompSuctionSatTemp</span>
<a name="ln-950"></a>    <span class="c">!Shoot into the super heated region</span>
<a name="ln-951"></a>    <span class="n">T111</span> <span class="o">=</span> <span class="n">CompSuctionSatTemp</span> <span class="o">+</span> <span class="mi">80</span>
<a name="ln-952"></a>
<a name="ln-953"></a>    <span class="c">! Iterate to find the Suction State - given suction pressure and superheat enthalpy</span>
<a name="ln-954"></a>    <span class="n">LOOP</span><span class="p">:</span> <span class="k">DO</span>
<a name="ln-955"></a><span class="k">      </span><span class="n">CompSuctionTemp</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="p">(</span> <span class="n">T110</span> <span class="o">+</span> <span class="n">T111</span> <span class="p">)</span>
<a name="ln-956"></a>
<a name="ln-957"></a>      <span class="n">CompSuctionEnth</span> <span class="o">=</span> <span class="n">GetSupHeatEnthalpyRefrig</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">,</span><span class="n">CompSuctionTemp</span><span class="p">,</span><span class="n">SuctionPr</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-958"></a>         <span class="n">GSHPRefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcGSHPModel:CompSuctionTemp&#39;</span><span class="p">)</span>
<a name="ln-959"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CompsuctionEnth</span><span class="o">-</span><span class="n">SuperHeatEnth</span><span class="p">)</span><span class="o">/</span><span class="n">SuperHeatEnth</span> <span class="o">&lt;</span> <span class="p">.</span><span class="mi">0001</span><span class="n">d0</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-960"></a><span class="k">          EXIT </span><span class="n">LOOP</span>
<a name="ln-961"></a>      <span class="k">END IF</span>
<a name="ln-962"></a>
<a name="ln-963"></a><span class="k">      IF</span> <span class="p">(</span> <span class="n">CompsuctionEnth</span> <span class="o">&lt;</span> <span class="n">SuperHeatEnth</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-964"></a><span class="k">        </span><span class="n">T110</span> <span class="o">=</span> <span class="n">CompSuctionTemp</span>
<a name="ln-965"></a>      <span class="k">ELSE</span>
<a name="ln-966"></a><span class="k">        </span><span class="n">T111</span> <span class="o">=</span> <span class="n">CompSuctionTemp</span>
<a name="ln-967"></a>      <span class="k">END IF</span>
<a name="ln-968"></a><span class="k">    END DO </span><span class="n">LOOP</span>
<a name="ln-969"></a>
<a name="ln-970"></a>    <span class="c">! Determine the Mass flow rate of refrigerant</span>
<a name="ln-971"></a>    <span class="n">CompSuctionDensity</span> <span class="o">=</span> <span class="n">GetSupHeatDensityRefrig</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">,</span> <span class="n">CompSuctionTemp</span><span class="p">,</span> <span class="n">SuctionPr</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-972"></a>       <span class="n">GSHPRefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcGSHPModel:CompSuctionTemp&#39;</span><span class="p">)</span>
<a name="ln-973"></a>    <span class="n">MassRef</span> <span class="o">=</span> <span class="n">PistonDisp</span> <span class="o">*</span> <span class="n">CompSuctionDensity</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">ClearanceFactor</span><span class="o">-</span><span class="n">ClearanceFactor</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-974"></a>              <span class="p">((</span><span class="n">DischargePr</span><span class="o">/</span><span class="n">SuctionPr</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="nb">gamma</span><span class="p">)))</span>
<a name="ln-975"></a>
<a name="ln-976"></a>    <span class="c">! Find the  Source Side Heat Transfer</span>
<a name="ln-977"></a>    <span class="n">QSource</span> <span class="o">=</span> <span class="n">MassRef</span> <span class="o">*</span> <span class="p">(</span> <span class="n">SourceSideOutletEnth</span> <span class="o">-</span> <span class="n">LoadSideOutletEnth</span> <span class="p">)</span>
<a name="ln-978"></a>
<a name="ln-979"></a>    <span class="c">! Determine the theoretical power</span>
<a name="ln-980"></a>    <span class="n">Power</span> <span class="o">=</span> <span class="n">PowerLosses</span><span class="o">+</span><span class="p">(</span><span class="n">MassRef</span><span class="o">*</span><span class="nb">gamma</span><span class="o">/</span><span class="p">(</span><span class="nb">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">SuctionPr</span> <span class="o">/</span><span class="n">CompSuctionDensity</span><span class="o">/</span><span class="n">LosFac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-981"></a>            <span class="p">((</span><span class="n">DischargePr</span><span class="o">/</span><span class="n">SuctionPr</span><span class="p">)</span><span class="o">**</span><span class="p">((</span><span class="nb">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">gamma</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-982"></a>
<a name="ln-983"></a>    <span class="c">! Determine the Loadside HeatRate (QLoad)</span>
<a name="ln-984"></a>    <span class="n">QLoad</span> <span class="o">=</span> <span class="n">Power</span> <span class="o">+</span> <span class="n">QSource</span>
<a name="ln-985"></a>
<a name="ln-986"></a>    <span class="c">! convergence and iteration limit check</span>
<a name="ln-987"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">((</span><span class="n">QLoad</span> <span class="o">-</span> <span class="n">initialQLoad</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">initialQLoad</span><span class="o">+</span><span class="n">SmallNum</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">HeatBalTol</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">IterationCount</span><span class="o">&gt;</span><span class="n">IterationLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-988"></a><span class="k">      IF</span><span class="p">(</span><span class="n">IterationCount</span><span class="o">&gt;</span><span class="n">IterationLimit</span><span class="p">)</span><span class="k">then</span>
<a name="ln-989"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39; did not converge&#39;</span><span class="p">)</span>
<a name="ln-990"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">)</span>
<a name="ln-991"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heatpump Name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-992"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="nb">ABS</span><span class="p">(</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="o">*</span><span class="p">(</span><span class="n">QLoad</span> <span class="o">-</span> <span class="n">initialQLoad</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">initialQLoad</span><span class="o">+</span><span class="n">SmallNum</span><span class="p">))</span>
<a name="ln-993"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heat Inbalance (%)             = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)))</span>
<a name="ln-994"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">QLoad</span>
<a name="ln-995"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Load-side heat transfer rate   = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)))</span>
<a name="ln-996"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">Qsource</span>
<a name="ln-997"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Source-side heat transfer rate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)))</span>
<a name="ln-998"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">SourceSideWaterMassFlowRate</span>
<a name="ln-999"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Source-side mass flow rate     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)))</span>
<a name="ln-1000"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">LoadSideWaterMassFlowRate</span>
<a name="ln-1001"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Load-side mass flow rate       = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)))</span>
<a name="ln-1002"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">SourceSideWaterInletTemp</span>
<a name="ln-1003"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Source-side inlet temperature  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)))</span>
<a name="ln-1004"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">LoadSideWaterInletTemp</span>
<a name="ln-1005"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Load-side inlet temperature    = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)))</span>
<a name="ln-1006"></a>      <span class="k">END IF</span>
<a name="ln-1007"></a><span class="k">      EXIT </span><span class="n">LOOPLoadEnth</span>
<a name="ln-1008"></a>
<a name="ln-1009"></a>    <span class="k">ELSE</span> <span class="c">! update load</span>
<a name="ln-1010"></a>      <span class="n">initialQLoad</span><span class="o">=</span> <span class="n">initialQLoad</span><span class="o">+</span> <span class="n">RelaxParam</span><span class="o">*</span><span class="p">(</span><span class="n">QLoad</span><span class="o">-</span><span class="n">initialQLoad</span><span class="p">)</span>
<a name="ln-1011"></a>      <span class="n">initialQSource</span> <span class="o">=</span> <span class="n">initialQSource</span> <span class="o">+</span> <span class="n">RelaxParam</span><span class="o">*</span><span class="p">(</span><span class="n">QSource</span> <span class="o">-</span> <span class="n">initialQSource</span><span class="p">)</span>
<a name="ln-1012"></a>    <span class="k">END IF</span>
<a name="ln-1013"></a>
<a name="ln-1014"></a><span class="k">  END DO </span><span class="n">LOOPLoadEnth</span>
<a name="ln-1015"></a>
<a name="ln-1016"></a>  <span class="c">!Control Strategy</span>
<a name="ln-1017"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">QLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1018"></a><span class="k">    </span><span class="n">DutyFactor</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span><span class="o">/</span><span class="n">QLoad</span>
<a name="ln-1019"></a>    <span class="n">QLoad</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-1020"></a>    <span class="n">Power</span> <span class="o">=</span> <span class="n">DutyFactor</span> <span class="o">*</span> <span class="n">Power</span>
<a name="ln-1021"></a>    <span class="n">QSource</span> <span class="o">=</span> <span class="n">QSource</span> <span class="o">*</span> <span class="n">DutyFactor</span>
<a name="ln-1022"></a>
<a name="ln-1023"></a>    <span class="c">! Determine the Exterior fluid temperature at the Load Side oulet and eveporator outlet...</span>
<a name="ln-1024"></a>    <span class="c">! Refrigerant = &quot;Steam&quot;</span>
<a name="ln-1025"></a>    <span class="n">LoadSideWaterOutletTemp</span>   <span class="o">=</span> <span class="n">LoadSideWaterInletTemp</span> <span class="o">+</span> <span class="n">QLoad</span><span class="o">/</span><span class="p">(</span><span class="n">LoadSideWaterMassFlowRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1026"></a>                                <span class="n">CpLoadSide</span><span class="p">)</span>
<a name="ln-1027"></a>    <span class="n">SourceSideWaterOutletTemp</span> <span class="o">=</span> <span class="n">SourceSideWaterInletTemp</span> <span class="o">-</span> <span class="n">QSource</span><span class="o">/</span><span class="p">(</span><span class="n">SourceSideWaterMassFlowRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1028"></a>                                <span class="n">CpSourceSide</span><span class="p">)</span>
<a name="ln-1029"></a>    <span class="k">RETURN</span>
<a name="ln-1030"></a><span class="k">  END IF</span>
<a name="ln-1031"></a>
<a name="ln-1032"></a><span class="k">  </span><span class="n">LoadSideWaterOutletTemp</span>   <span class="o">=</span> <span class="n">LoadSideWaterInletTemp</span> <span class="o">+</span> <span class="n">QLoad</span><span class="o">/</span><span class="p">(</span><span class="n">LoadSideWaterMassFlowRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1033"></a>                              <span class="n">CpLoadSide</span><span class="p">)</span>
<a name="ln-1034"></a>  <span class="n">SourceSideWaterOutletTemp</span> <span class="o">=</span> <span class="n">SourceSideWaterInletTemp</span> <span class="o">-</span> <span class="n">QSource</span><span class="o">/</span><span class="p">(</span><span class="n">SourceSideWaterMassFlowRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1035"></a>                              <span class="n">CpSourceSide</span> <span class="p">)</span>
<a name="ln-1036"></a>  <span class="c">! REPORT VAR</span>
<a name="ln-1037"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Running</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1038"></a>
<a name="ln-1039"></a>  <span class="k">RETURN</span>
<a name="ln-1040"></a>
<a name="ln-1041"></a><span class="k">END SUBROUTINE </span><span class="n">CalcGshpModel</span>
<a name="ln-1042"></a>
<a name="ln-1043"></a><span class="k">SUBROUTINE </span><span class="n">UpdateGSHPRecords</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span>
<a name="ln-1044"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1045"></a>            <span class="c">!       AUTHOR:          Arun</span>
<a name="ln-1046"></a>            <span class="c">!       DATE WRITTEN:    October 1998</span>
<a name="ln-1047"></a>
<a name="ln-1048"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1049"></a>            <span class="c">! reporting</span>
<a name="ln-1050"></a>
<a name="ln-1051"></a>
<a name="ln-1052"></a>            <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-1053"></a>
<a name="ln-1054"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-1055"></a>
<a name="ln-1056"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-1057"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-1058"></a>
<a name="ln-1059"></a>
<a name="ln-1060"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-1061"></a>
<a name="ln-1062"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1063"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">GSHPNum</span>       <span class="c">! GSHP number</span>
<a name="ln-1064"></a>
<a name="ln-1065"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1066"></a>          <span class="c">! na</span>
<a name="ln-1067"></a>
<a name="ln-1068"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1069"></a>          <span class="c">! na</span>
<a name="ln-1070"></a>
<a name="ln-1071"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1072"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">SourceSideInletNode</span>      <span class="c">! Source Side inlet node number, water side</span>
<a name="ln-1073"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">SourceSideOutletNode</span>     <span class="c">! Source Side outlet node number, water side</span>
<a name="ln-1074"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">LoadSideInletNode</span>        <span class="c">! Load Side inlet node number, water side</span>
<a name="ln-1075"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">LoadSideOutletNode</span>       <span class="c">! Load Side outlet node number, water side</span>
<a name="ln-1076"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReportingConstant</span>
<a name="ln-1077"></a>
<a name="ln-1078"></a>    <span class="n">LoadSideInletNode</span>    <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span>
<a name="ln-1079"></a>    <span class="n">LoadSideOutletNode</span>   <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletNodeNum</span>
<a name="ln-1080"></a>    <span class="n">SourceSideInletNode</span>  <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span>
<a name="ln-1081"></a>    <span class="n">SourceSideOutletNode</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span>
<a name="ln-1082"></a>
<a name="ln-1083"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-1084"></a>          <span class="c">!set node temperatures</span>
<a name="ln-1085"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1086"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1087"></a>
<a name="ln-1088"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Power</span>                <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1089"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Energy</span>               <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1090"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span>              <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1091"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSourceEnergy</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1092"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoad</span>                <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1093"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoadEnergy</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1094"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterInletTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1095"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterOutletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1096"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterInletTemp</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1097"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterOutletTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1098"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSidemdot</span>       <span class="o">=</span> <span class="n">SourceSideWaterMassFlowRate</span>
<a name="ln-1099"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSidemdot</span>         <span class="o">=</span> <span class="n">LoadSideWaterMassFlowRate</span>
<a name="ln-1100"></a>
<a name="ln-1101"></a>  <span class="k">ELSE</span>
<a name="ln-1102"></a>         <span class="c">!set node temperatures</span>
<a name="ln-1103"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>      <span class="o">=</span> <span class="n">LoadSideWaterOutletTemp</span>
<a name="ln-1104"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>    <span class="o">=</span> <span class="n">SourceSideWaterOutletTemp</span>
<a name="ln-1105"></a>
<a name="ln-1106"></a>    <span class="n">ReportingConstant</span> <span class="o">=</span> <span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-1107"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Power</span>       <span class="o">=</span> <span class="n">Power</span>
<a name="ln-1108"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Energy</span>      <span class="o">=</span> <span class="n">Power</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-1109"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span>     <span class="o">=</span> <span class="n">QSource</span>
<a name="ln-1110"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoad</span>       <span class="o">=</span> <span class="n">QLoad</span>
<a name="ln-1111"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSourceEnergy</span> <span class="o">=</span> <span class="n">QSource</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-1112"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoadEnergy</span>   <span class="o">=</span> <span class="n">QLoad</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-1113"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterInletTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1114"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterOutletTemp</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1115"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterInletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1116"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterOutletTemp</span><span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1117"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSidemdot</span>       <span class="o">=</span> <span class="n">SourceSideWaterMassFlowRate</span>
<a name="ln-1118"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSidemdot</span>         <span class="o">=</span> <span class="n">LoadSideWaterMassFlowRate</span>
<a name="ln-1119"></a>
<a name="ln-1120"></a>  <span class="k">END IF</span>
<a name="ln-1121"></a><span class="k">RETURN</span>
<a name="ln-1122"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateGSHPRecords</span>
<a name="ln-1123"></a>
<a name="ln-1124"></a><span class="k">END MODULE </span><span class="n">HeatPumpWaterToWaterHEATING</span>
<a name="ln-1125"></a><span class="c">!************************************************************************************</span>
<a name="ln-1126"></a><span class="c">!</span>
<a name="ln-1127"></a><span class="c">!==================================== MODULE HeatPumpWaterToWaterCOOLING ======================</span>
<a name="ln-1128"></a><span class="c">!</span>
<a name="ln-1129"></a><span class="c">!************************************************************************************</span>
<a name="ln-1130"></a><span class="k">MODULE </span><span class="n">HeatPumpWaterToWaterCOOLING</span>
<a name="ln-1131"></a>  <span class="c">! Module containing the routines dealing with the Water to Water Heat Pump (Cooling)</span>
<a name="ln-1132"></a>
<a name="ln-1133"></a>  <span class="c">! MODULE INFORMATION:</span>
<a name="ln-1134"></a>  <span class="c">!       AUTHOR         ARUN</span>
<a name="ln-1135"></a>  <span class="c">!       DATE WRITTEN   7/18/2000</span>
<a name="ln-1136"></a>  <span class="c">!       MODIFIED       ARUN: 6/27/2002: Cycle Time</span>
<a name="ln-1137"></a>  <span class="c">!                      L Lawrie: V1.1.1 (5/20/2003) add meters and energy to several reporting variables</span>
<a name="ln-1138"></a>  <span class="c">!                      L Lawrie: V1.1.1 (5/20/2003) restructure modules to comply with standard templates</span>
<a name="ln-1139"></a>  <span class="c">!                      B Griffith, Sept 2010, plant upgrades, general fluid properties</span>
<a name="ln-1140"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1141"></a>
<a name="ln-1142"></a>  <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-1143"></a>  <span class="c">! This module simulates a water to Water Heat Pump (Cooling)</span>
<a name="ln-1144"></a>
<a name="ln-1145"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1146"></a>  <span class="c">! This simulation is based on a set of selected parameters,</span>
<a name="ln-1147"></a>  <span class="c">! Which are obtained using Parameter Estimation technique.</span>
<a name="ln-1148"></a>
<a name="ln-1149"></a>  <span class="c">! REFERENCES: none</span>
<a name="ln-1150"></a>
<a name="ln-1151"></a>  <span class="c">! OTHER NOTES: none</span>
<a name="ln-1152"></a>
<a name="ln-1153"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-1154"></a>  <span class="c">! Use statements for data only modules</span>
<a name="ln-1155"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-1156"></a><span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MaxNameLength</span><span class="p">,</span> <span class="n">BeginSimFlag</span><span class="p">,</span><span class="n">InitconvTemp</span><span class="p">,</span><span class="n">BeginEnvrnFlag</span><span class="p">,</span> <span class="n">HourOfDay</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1157"></a>                              <span class="n">TimeStep</span><span class="p">,</span><span class="n">TimeStepZone</span><span class="p">,</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">WarmupFlag</span><span class="p">,</span><span class="n">SecInHour</span>
<a name="ln-1158"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-1159"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-1160"></a>
<a name="ln-1161"></a>  <span class="c">! Use statements for access to subroutines in other modules</span>
<a name="ln-1162"></a>
<a name="ln-1163"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-1164"></a>
<a name="ln-1165"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-1166"></a>
<a name="ln-1167"></a>  <span class="c">! MODULE PARAMETER DEFINITIONS</span>
<a name="ln-1168"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ModuleCompName</span><span class="o">=</span><span class="s1">&#39;HeatPump:WaterToWater:ParameterEstimation:Cooling&#39;</span>
<a name="ln-1169"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ModuleCompNameUC</span><span class="o">=</span><span class="s1">&#39;HEATPUMP:WATERTOWATER:PARAMETERESTIMATION:COOLING&#39;</span>
<a name="ln-1170"></a>
<a name="ln-1171"></a>  <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1172"></a>
<a name="ln-1173"></a>    <span class="c">! Type Description of Heat Pump</span>
<a name="ln-1174"></a><span class="k">TYPE </span><span class="n">GshpSpecs</span>   <span class="c">! Needs Some Modifications talk with Dr.Fisher and decide....</span>
<a name="ln-1175"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>          <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! user identifier</span>
<a name="ln-1176"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">WWHPPlantTypeOfNum</span>
<a name="ln-1177"></a>  <span class="kt">LOGICAL</span>            <span class="kd">::</span> <span class="n">Available</span>           <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! need an array of logicals--load identifiers of available equipment</span>
<a name="ln-1178"></a>  <span class="kt">LOGICAL</span>            <span class="kd">::</span> <span class="n">ON</span>                  <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! simulate the machine at it&#39;s operating part load ratio</span>
<a name="ln-1179"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">COP</span>                     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Coefficeint of Performance of the machine</span>
<a name="ln-1180"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">NomCap</span>                  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Nomial Capcity of the HeatPump</span>
<a name="ln-1181"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">MinPartLoadRat</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Minimum operating Part Load Ratio</span>
<a name="ln-1182"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">MaxPartLoadRat</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Maximum operating Part Load Ratio</span>
<a name="ln-1183"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">OptPartLoadRat</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Optimal operating Part Load Ratio</span>
<a name="ln-1184"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">LoadSideVolFlowRate</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Design Flow Rate on the Load side</span>
<a name="ln-1185"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">LoadSideDesignMassFlow</span>  <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! Design flow rate (kg/s)</span>
<a name="ln-1186"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">SourceSideVolFlowRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Design Flow Rate on th Source Side</span>
<a name="ln-1187"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">SourceSideDesignMassFlow</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! Design flow rate (kg/s)</span>
<a name="ln-1188"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SourceSideInletNodeNum</span>  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Node number on the inlet side of the plant</span>
<a name="ln-1189"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SourceSideOutletNodeNum</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Node number on the outlet side of the plant</span>
<a name="ln-1190"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">LoadSideInletNodeNum</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Node number on the inlet side of the Load Side</span>
<a name="ln-1191"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">LoadSideOutletNodeNum</span>   <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Node number on the outlet side of the Load Side</span>
<a name="ln-1192"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">SourceSideUACoeff</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side heat transfer coeff</span>
<a name="ln-1193"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">LoadSideUACoeff</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Load Side heat transfer coeff</span>
<a name="ln-1194"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CompPistonDisp</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! compressor piston displacement</span>
<a name="ln-1195"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CompClearanceFactor</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! compressor clearance factor</span>
<a name="ln-1196"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CompSucPressDrop</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! deltap ,  compressor suction and discharge pressure drop</span>
<a name="ln-1197"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">SuperheatTemp</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! deltatsh , super heating</span>
<a name="ln-1198"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">PowerLosses</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! constant part of electro mechanical power losses</span>
<a name="ln-1199"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">LossFactor</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! loss factor used ot define the electro mechanical loss</span>
<a name="ln-1200"></a>                                                      <span class="c">!  that is supposed to be proportional to the theoretical power</span>
<a name="ln-1201"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">HighPressCutOff</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Maximum Design Pressure on the Load Side</span>
<a name="ln-1202"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">LowPressCutOff</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Minimum Design Pressure on the Source Side</span>
<a name="ln-1203"></a>
<a name="ln-1204"></a>      <span class="c">! Added by Arun 6-27-02</span>
<a name="ln-1205"></a>  <span class="c">! to implement cycletime - removed 9/10/2013 LKL</span>
<a name="ln-1206"></a>  <span class="kt">LOGICAL</span>            <span class="kd">::</span> <span class="n">IsOn</span>                      <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1207"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">MustRun</span>                         <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1208"></a>  <span class="c">!loop topology variables</span>
<a name="ln-1209"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SourceLoopNum</span>           <span class="o">=</span> <span class="mi">0</span> <span class="c">! source side plant loop index number</span>
<a name="ln-1210"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SourceLoopSideNum</span>       <span class="o">=</span> <span class="mi">0</span> <span class="c">! source side plant loop side index</span>
<a name="ln-1211"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SourceBranchNum</span>         <span class="o">=</span> <span class="mi">0</span> <span class="c">! source side plant loop branch index</span>
<a name="ln-1212"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SourceCompNum</span>           <span class="o">=</span> <span class="mi">0</span> <span class="c">! source side plant loop component index</span>
<a name="ln-1213"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">LoadLoopNum</span>             <span class="o">=</span> <span class="mi">0</span> <span class="c">! load side plant loop index number</span>
<a name="ln-1214"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">LoadLoopSideNum</span>         <span class="o">=</span> <span class="mi">0</span> <span class="c">! load side plant loop side index</span>
<a name="ln-1215"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">LoadBranchNum</span>           <span class="o">=</span> <span class="mi">0</span> <span class="c">! load side plant loop branch index</span>
<a name="ln-1216"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">LoadCompNum</span>             <span class="o">=</span> <span class="mi">0</span> <span class="c">! load side plant loop component index</span>
<a name="ln-1217"></a><span class="k">END TYPE </span><span class="n">GshpSpecs</span>
<a name="ln-1218"></a>
<a name="ln-1219"></a>
<a name="ln-1220"></a>    <span class="c">! Output Variables Type definition</span>
<a name="ln-1221"></a><span class="k">TYPE </span><span class="n">ReportVars</span>
<a name="ln-1222"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Power</span>                       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Power Consumption Watts</span>
<a name="ln-1223"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Energy</span>                      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Energy Consumption Joules</span>
<a name="ln-1224"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QLoad</span>                       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Load Side heat transfer rate Watts</span>
<a name="ln-1225"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QLoadEnergy</span>                 <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Load Side heat transfer Joules</span>
<a name="ln-1226"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QSource</span>                     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side heat transfer rate Watts</span>
<a name="ln-1227"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QSourceEnergy</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side heat transfer Joules</span>
<a name="ln-1228"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LoadSideWaterInletTemp</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Load Side outlet temperature °C</span>
<a name="ln-1229"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SourceSideWaterInletTemp</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side outlet temperature °C</span>
<a name="ln-1230"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LoadSideWaterOutletTemp</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Load Side outlet temperature °C</span>
<a name="ln-1231"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SourceSideWaterOutletTemp</span>   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side outlet temperature °C</span>
<a name="ln-1232"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LoadSidemdot</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Mass flow rate of the cooling water in Load Side kg/s</span>
<a name="ln-1233"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SourceSidemdot</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Mass flow rate of chilled water in Eavporator kg/s</span>
<a name="ln-1234"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Running</span>                       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! On reporting Flag</span>
<a name="ln-1235"></a><span class="k">END TYPE </span><span class="n">ReportVars</span>
<a name="ln-1236"></a>
<a name="ln-1237"></a>
<a name="ln-1238"></a>    <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-1239"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">GSHPSpecs</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>  <span class="kd">::</span><span class="n">GSHP</span>          <span class="c">!dimension to number of machines</span>
<a name="ln-1240"></a><span class="k">TYPE</span><span class="p">(</span><span class="n">ReportVars</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">GSHPReport</span>
<a name="ln-1241"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckEquipName</span>
<a name="ln-1242"></a>
<a name="ln-1243"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">GSHPRefrigerant</span><span class="o">=</span><span class="s1">&#39;R22&#39;</span>        <span class="c">! refrigerent name and index</span>
<a name="ln-1244"></a>    <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">GSHPRefrigIndex</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1245"></a>
<a name="ln-1246"></a>    <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">NumGSHPs</span>                  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! number of Gshps specified in input</span>
<a name="ln-1247"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">LoadSideWaterMassFlowRate</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Load Side mass flow rate, water side kg/s</span>
<a name="ln-1248"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SourceSideWaterMassFlowRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side mass flow rate, water side kg/s</span>
<a name="ln-1249"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Power</span>                         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! power consumption Watts</span>
<a name="ln-1250"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">QLoad</span>                         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! heat rejection from Load Side coil Watts</span>
<a name="ln-1251"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">QSource</span>                       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! cooling capacity Watts</span>
<a name="ln-1252"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SourceSideWaterOutletTemp</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side outlet temperature °C</span>
<a name="ln-1253"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SourceSideWaterInletTemp</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side outlet temperature °C</span>
<a name="ln-1254"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">LoadSideWaterOutletTemp</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side outlet temperature °C</span>
<a name="ln-1255"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">LoadSidewaterInletTemp</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side outlet temperature °C</span>
<a name="ln-1256"></a>
<a name="ln-1257"></a>
<a name="ln-1258"></a>
<a name="ln-1259"></a>  <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE</span>
<a name="ln-1260"></a>
<a name="ln-1261"></a>  <span class="c">! Name Public routines, optionally name Private routines within this module</span>
<a name="ln-1262"></a><span class="k">PUBLIC     </span><span class="n">SimHPWatertoWaterCOOLING</span>
<a name="ln-1263"></a><span class="k">PRIVATE    </span><span class="n">CalcGshpModel</span>
<a name="ln-1264"></a><span class="k">PRIVATE    </span><span class="n">GetGshpInput</span>
<a name="ln-1265"></a><span class="k">PRIVATE    </span><span class="n">InitGshp</span>
<a name="ln-1266"></a><span class="k">PRIVATE    </span><span class="n">UpdateGSHPRecords</span>
<a name="ln-1267"></a>
<a name="ln-1268"></a><span class="k">CONTAINS</span>
<a name="ln-1269"></a>         <span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-1270"></a>
<a name="ln-1271"></a><span class="k">SUBROUTINE </span><span class="n">SimHPWatertoWaterCOOLING</span><span class="p">(</span><span class="n">GSHPType</span><span class="p">,</span><span class="n">GSHPName</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1272"></a>                                    <span class="n">InitLoopEquip</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">MaxCap</span><span class="p">,</span><span class="n">MinCap</span><span class="p">,</span><span class="n">OptCap</span><span class="p">,</span><span class="n">LoopNum</span><span class="p">)</span>
<a name="ln-1273"></a>          <span class="c">!       SUBROUTINE INFORMATION:</span>
<a name="ln-1274"></a>          <span class="c">!       AUTHOR</span>
<a name="ln-1275"></a>          <span class="c">!       DATE WRITTEN   Feb 2000</span>
<a name="ln-1276"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-1277"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1278"></a>
<a name="ln-1279"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE: This is the  water to water Heat Pump driver.</span>
<a name="ln-1280"></a>          <span class="c">! It gets the input for the models, initializes simulation variables, calls</span>
<a name="ln-1281"></a>          <span class="c">! the appropriate model and sets up reporting variables.</span>
<a name="ln-1282"></a>
<a name="ln-1283"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1284"></a>
<a name="ln-1285"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1286"></a>
<a name="ln-1287"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1288"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">UpdateChillerComponentCondenserSide</span>
<a name="ln-1289"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TypeOf_HPWaterEFCooling</span>
<a name="ln-1290"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-1291"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span>
<a name="ln-1292"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-1293"></a>
<a name="ln-1294"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-1295"></a>
<a name="ln-1296"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1297"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GshpType</span>  <span class="c">! type ofGSHP</span>
<a name="ln-1298"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GshpName</span>  <span class="c">! user specified name ofGSHP</span>
<a name="ln-1299"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">LoopNum</span>
<a name="ln-1300"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">CompIndex</span>
<a name="ln-1301"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-1302"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">InitLoopEquip</span>  <span class="c">! If not zero, calculate the max load for operating conditions</span>
<a name="ln-1303"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MyLoad</span>         <span class="c">! loop demand component will meet</span>
<a name="ln-1304"></a>
<a name="ln-1305"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1306"></a>          <span class="c">! na</span>
<a name="ln-1307"></a>
<a name="ln-1308"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1309"></a>          <span class="c">! na</span>
<a name="ln-1310"></a>
<a name="ln-1311"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1312"></a>          <span class="c">! na</span>
<a name="ln-1313"></a>
<a name="ln-1314"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1315"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>     <span class="kd">::</span> <span class="n">GetInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! then TRUE, calls subroutine to read input file.</span>
<a name="ln-1316"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">MinCap</span>             <span class="c">! W - minimum operating capacity of GSHP</span>
<a name="ln-1317"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">MaxCap</span>             <span class="c">! W - maximum operating capacity of GSHP</span>
<a name="ln-1318"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">OptCap</span>             <span class="c">! W - optimal operating capacity of GSHP</span>
<a name="ln-1319"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">GSHPNum</span>
<a name="ln-1320"></a>
<a name="ln-1321"></a>    <span class="c">!Get input from IDF</span>
<a name="ln-1322"></a>
<a name="ln-1323"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1324"></a><span class="k">    CALL </span><span class="n">GetGshpInput</span>
<a name="ln-1325"></a>    <span class="n">GetInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1326"></a>  <span class="k">END IF</span>
<a name="ln-1327"></a>
<a name="ln-1328"></a>  <span class="c">! Find the correct Equipment</span>
<a name="ln-1329"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1330"></a><span class="k">    </span><span class="n">GSHPNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span> <span class="n">GSHPName</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">NumGSHPs</span> <span class="p">)</span>
<a name="ln-1331"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GSHPNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1332"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimHPWatertoWaterCOOLING: Unit not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">))</span>
<a name="ln-1333"></a>    <span class="n">ENDIF</span>
<a name="ln-1334"></a>    <span class="n">CompIndex</span><span class="o">=</span><span class="n">GSHPNum</span>
<a name="ln-1335"></a>  <span class="k">ELSE</span>
<a name="ln-1336"></a><span class="k">    </span><span class="n">GSHPNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-1337"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GSHPNum</span> <span class="o">&gt;</span> <span class="n">NumGSHPs</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">GSHPNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1338"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimHPWatertoWaterCOOLING:  Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1339"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1340"></a>                          <span class="s1">&#39;, Number of Units=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumGSHPs</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1341"></a>                          <span class="s1">&#39;, Entered Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">))</span>
<a name="ln-1342"></a>    <span class="n">ENDIF</span>
<a name="ln-1343"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1344"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GSHPName</span> <span class="o">/=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1345"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimHPWatertoWaterCOOLING: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1346"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1347"></a>                            <span class="s1">&#39;, Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Unit Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1348"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1349"></a>      <span class="n">ENDIF</span>
<a name="ln-1350"></a>      <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1351"></a>    <span class="n">ENDIF</span>
<a name="ln-1352"></a>  <span class="n">ENDIF</span>
<a name="ln-1353"></a>
<a name="ln-1354"></a>     <span class="c">! Calculate Demand on heat pump</span>
<a name="ln-1355"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1356"></a><span class="k">    </span><span class="n">MinCap</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">NomCap</span><span class="o">*</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MinPartLoadRat</span>
<a name="ln-1357"></a>    <span class="n">MaxCap</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">NomCap</span><span class="o">*</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MaxPartLoadRat</span>
<a name="ln-1358"></a>    <span class="n">OptCap</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">NomCap</span><span class="o">*</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">OptPartLoadRat</span>
<a name="ln-1359"></a>    <span class="k">Return</span>
<a name="ln-1360"></a><span class="k">  END IF</span>
<a name="ln-1361"></a>
<a name="ln-1362"></a>  <span class="c">! Simulate the model for the Demand &quot;MyLoad&quot;</span>
<a name="ln-1363"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">LoopNum</span> <span class="o">==</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! chilled water loop</span>
<a name="ln-1364"></a>   <span class="k">CALL </span><span class="n">InitGshp</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span>
<a name="ln-1365"></a>   <span class="k">CALL </span><span class="n">CalcGshpModel</span><span class="p">(</span> <span class="n">GSHPType</span><span class="p">,</span> <span class="n">GSHPName</span><span class="p">,</span> <span class="n">GSHPNum</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-1366"></a>   <span class="k">CALL </span><span class="n">UpdateGshpRecords</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span>
<a name="ln-1367"></a> <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">LoopNum</span> <span class="o">==</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! condenser loop</span>
<a name="ln-1368"></a>   <span class="k">CALL </span><span class="n">UpdateChillerComponentCondenserSide</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1369"></a>                                     <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-1370"></a>                                     <span class="n">TypeOf_HPWaterEFCooling</span><span class="p">,</span>                     <span class="p">&amp;</span>
<a name="ln-1371"></a>                                     <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1372"></a>                                     <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1373"></a>                                     <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-1374"></a>                                     <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterInletTemp</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-1375"></a>                                     <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterOutletTemp</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1376"></a>                                     <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSidemdot</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-1377"></a>                                     <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-1378"></a> <span class="k">ELSE</span>
<a name="ln-1379"></a><span class="k">   CALL </span><span class="n">ShowFatalError</span> <span class="p">(</span><span class="s1">&#39;SimHPWatertoWaterCOOLING:: Invalid loop connection &#39;</span><span class="o">//</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;, Requested Unit=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">))</span>
<a name="ln-1380"></a> <span class="n">ENDIF</span>
<a name="ln-1381"></a>
<a name="ln-1382"></a><span class="k">RETURN</span>
<a name="ln-1383"></a><span class="k">END SUBROUTINE </span><span class="n">SimHPWatertoWaterCOOLING</span>
<a name="ln-1384"></a>
<a name="ln-1385"></a><span class="k">SUBROUTINE </span><span class="n">GetGshpInput</span>
<a name="ln-1386"></a>            <span class="c">!       SUBROUTINE INFORMATION:</span>
<a name="ln-1387"></a>            <span class="c">!       AUTHOR:</span>
<a name="ln-1388"></a>            <span class="c">!       DATE WRITTEN:    April 1998</span>
<a name="ln-1389"></a>
<a name="ln-1390"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1391"></a>            <span class="c">! This routine will get the input</span>
<a name="ln-1392"></a>            <span class="c">! required by the GSHP models.  As such</span>
<a name="ln-1393"></a>            <span class="c">! it will interact with the Input Scanner to retrieve</span>
<a name="ln-1394"></a>            <span class="c">! information from the input file, count the number of</span>
<a name="ln-1395"></a>            <span class="c">! GSHPs and begin to fill the</span>
<a name="ln-1396"></a>            <span class="c">! arrays associated with the typeGSHP.</span>
<a name="ln-1397"></a>
<a name="ln-1398"></a>
<a name="ln-1399"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1400"></a>
<a name="ln-1401"></a>            <span class="c">! REFERENCES:</span>
<a name="ln-1402"></a>
<a name="ln-1403"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-1404"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TypeOf_HPWaterPECooling</span><span class="p">,</span> <span class="n">ScanPlantLoopsForObject</span>
<a name="ln-1405"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>        <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-1406"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span>      <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-1407"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-1408"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>       <span class="n">ONLY</span> <span class="p">:</span> <span class="n">FindRefrigerant</span>
<a name="ln-1409"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>        <span class="n">ONLY</span> <span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-1410"></a>
<a name="ln-1411"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1412"></a>
<a name="ln-1413"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1414"></a>          <span class="c">! na</span>
<a name="ln-1415"></a>
<a name="ln-1416"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1417"></a>          <span class="c">! na</span>
<a name="ln-1418"></a>
<a name="ln-1419"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1420"></a>          <span class="c">! na</span>
<a name="ln-1421"></a>
<a name="ln-1422"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1423"></a>          <span class="c">! na</span>
<a name="ln-1424"></a>
<a name="ln-1425"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1426"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">GshpNum</span>                    <span class="c">!Gshp counter</span>
<a name="ln-1427"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumAlphas</span>                 <span class="c">! Number of elements in the alpha array</span>
<a name="ln-1428"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumNums</span>                   <span class="c">! Number of elements in the numeric array</span>
<a name="ln-1429"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">IOStat</span>                    <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-1430"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">AlphArray</span> <span class="c">!character string data</span>
<a name="ln-1431"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>                        <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NumArray</span>  <span class="c">!numeric data</span>
<a name="ln-1432"></a>
<a name="ln-1433"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1434"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsNotOk</span>          <span class="c">! Flag to verify name</span>
<a name="ln-1435"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsBlank</span>          <span class="c">! Flag for blank name</span>
<a name="ln-1436"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-1437"></a>
<a name="ln-1438"></a>
<a name="ln-1439"></a>  <span class="n">NumGshps</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">ModuleCompNameUC</span><span class="p">)</span>
<a name="ln-1440"></a>
<a name="ln-1441"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">NumGshps</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1442"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No Equipment found in SimGshp&#39;</span><span class="p">)</span>
<a name="ln-1443"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1444"></a>  <span class="k">END IF</span>
<a name="ln-1445"></a>
<a name="ln-1446"></a>   <span class="c">! Allocate Arrays</span>
<a name="ln-1447"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">NumGshps</span><span class="p">))</span>
<a name="ln-1448"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">GshpReport</span><span class="p">(</span><span class="n">NumGshps</span><span class="p">))</span>
<a name="ln-1449"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">NumGshps</span><span class="p">))</span>
<a name="ln-1450"></a>  <span class="n">CheckEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1451"></a>
<a name="ln-1452"></a>
<a name="ln-1453"></a>  <span class="k">DO </span><span class="n">GshpNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumGshps</span>
<a name="ln-1454"></a>   <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">ModuleCompNameUC</span><span class="p">,</span><span class="n">GshpNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1455"></a>                   <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">)</span>
<a name="ln-1456"></a>        <span class="n">IsNotOk</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1457"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1458"></a>   <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">GSHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">GSHPNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ISNotOK</span><span class="p">,</span><span class="n">ISBlank</span><span class="p">,</span><span class="s1">&#39;GHSP Name&#39;</span><span class="p">)</span>
<a name="ln-1459"></a>
<a name="ln-1460"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">ISNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1461"></a><span class="k">       </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1462"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">ISBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-1463"></a>   <span class="k">END IF</span>
<a name="ln-1464"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span>                <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1465"></a>
<a name="ln-1466"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">WWHPPlantTypeOfNum</span>    <span class="o">=</span> <span class="n">TypeOf_HPWaterPECooling</span>
<a name="ln-1467"></a>
<a name="ln-1468"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">COP</span>                 <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1469"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1470"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:COP = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1471"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1472"></a>    <span class="k">END IF</span>
<a name="ln-1473"></a>
<a name="ln-1474"></a>    <span class="c">! zero values for NumArray 3 - 6 checked in input - idd</span>
<a name="ln-1475"></a>
<a name="ln-1476"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">NomCap</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1477"></a>
<a name="ln-1478"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MinPartLoadRat</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1479"></a>
<a name="ln-1480"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MaxPartLoadRat</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1481"></a>
<a name="ln-1482"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">OptPartLoadRat</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1483"></a>
<a name="ln-1484"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideVolFlowRate</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1485"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1486"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Load Side Vol Flow Rate = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1487"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1488"></a>    <span class="k">END IF</span>
<a name="ln-1489"></a>
<a name="ln-1490"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideVolFlowRate</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1491"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1492"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Source Side Vol Flow Rate = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1493"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1494"></a>    <span class="k">END IF</span>
<a name="ln-1495"></a>
<a name="ln-1496"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideUACoeff</span>          <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1497"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1498"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Load Side Heat Transfer Coeffcient = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1499"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1500"></a>    <span class="k">END IF</span>
<a name="ln-1501"></a>
<a name="ln-1502"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideUACoeff</span>          <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1503"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1504"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Source Side Heat Transfer Coeffcient = 0.0, Heatpump=&#39;</span> <span class="p">&amp;</span>
<a name="ln-1505"></a>                             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1506"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1507"></a>    <span class="k">END IF</span>
<a name="ln-1508"></a>
<a name="ln-1509"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CompPistonDisp</span>       <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1510"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1511"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Compressor Piston displacement/Storke = 0.0, Heatpump=&#39;</span> <span class="p">&amp;</span>
<a name="ln-1512"></a>                             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1513"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1514"></a>    <span class="k">END IF</span>
<a name="ln-1515"></a>
<a name="ln-1516"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CompClearanceFactor</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-1517"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1518"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Compressor Clearance Factor = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1519"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1520"></a>    <span class="k">END IF</span>
<a name="ln-1521"></a>
<a name="ln-1522"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CompSucPressDrop</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-1523"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1524"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;: Pressure Drop = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1525"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1526"></a>    <span class="k">END IF</span>
<a name="ln-1527"></a>
<a name="ln-1528"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SuperheatTemp</span>        <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-1529"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1530"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Source Side SuperHeat = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1531"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1532"></a>    <span class="k">END IF</span>
<a name="ln-1533"></a>
<a name="ln-1534"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">PowerLosses</span>          <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-1535"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1536"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Compressor Power Loss = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1537"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1538"></a>    <span class="k">END IF</span>
<a name="ln-1539"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LossFactor</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-1540"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1541"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;:Efficiency = 0.0, Heatpump=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1542"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1543"></a>    <span class="k">END IF</span>
<a name="ln-1544"></a>
<a name="ln-1545"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HighPressCutOff</span>        <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-1546"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1547"></a><span class="k">       </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HighPressCutOff</span>        <span class="o">=</span> <span class="mi">50000000</span><span class="mf">0.0d0</span>
<a name="ln-1548"></a>       <span class="c">!CALL ShowWarningError(ModuleCompName//&#39;: High Pressure Cut Off= 0.0 Heat Pump&#39;//TRIM(AlphArray(1)))</span>
<a name="ln-1549"></a>    <span class="k">END IF</span>
<a name="ln-1550"></a>
<a name="ln-1551"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LowPressCutOff</span>        <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-1552"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1553"></a><span class="k">       </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LowPressCutOff</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1554"></a>       <span class="c">!CALL ShowWarningError(ModuleCompName//&#39;: Low Pressure Cut Off= 0.0 Heat Pump&#39;//TRIM(AlphArray(1)))</span>
<a name="ln-1555"></a>    <span class="k">END IF</span>
<a name="ln-1556"></a>
<a name="ln-1557"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span>   <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-1558"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="s1">&#39;HeatPump:WaterToWater Cooling&#39;</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1559"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1560"></a>
<a name="ln-1561"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1562"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="s1">&#39;HeatPump:WaterToWater Cooling&#39;</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1563"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1564"></a>
<a name="ln-1565"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span>    <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1566"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="s1">&#39;HeatPump:WaterToWater Cooling&#39;</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1567"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1568"></a>
<a name="ln-1569"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletNodeNum</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1570"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="s1">&#39;HeatPump:WaterToWater Cooling&#39;</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1571"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1572"></a>
<a name="ln-1573"></a>    <span class="c">! Test node sets</span>
<a name="ln-1574"></a>    <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">ModuleCompNameUC</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Condenser Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-1575"></a>    <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">ModuleCompNameUC</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;Chilled Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-1576"></a>
<a name="ln-1577"></a>    <span class="c">! save the design source side flow rate for use by plant loop sizing algorithms</span>
<a name="ln-1578"></a>    <span class="k">CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideVolFlowRate</span><span class="p">)</span>
<a name="ln-1579"></a>
<a name="ln-1580"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1581"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1582"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Power</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1583"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterInletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1584"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterInletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1585"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterOutletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1586"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterOutletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1587"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSidemdot</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1588"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSidemdot</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1589"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">isOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1590"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1591"></a>
<a name="ln-1592"></a>  <span class="k">END DO</span>
<a name="ln-1593"></a>
<a name="ln-1594"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1595"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors Found in getting Gshp input&#39;</span><span class="p">)</span>
<a name="ln-1596"></a>  <span class="k">END IF</span>
<a name="ln-1597"></a>
<a name="ln-1598"></a><span class="k">  </span><span class="n">GSHPRefrigIndex</span><span class="o">=</span><span class="n">FindRefrigerant</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">)</span>
<a name="ln-1599"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GSHPRefrigIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1600"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Refrigerant for HeatPump:WaterToWater Heating not found, should have been=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">))</span>
<a name="ln-1601"></a>  <span class="n">ENDIF</span>
<a name="ln-1602"></a>
<a name="ln-1603"></a>   <span class="c">!CurrentModuleObject=&#39;HeatPump:WaterToWater:ParameterEstimation:Cooling&#39;</span>
<a name="ln-1604"></a>  <span class="k">DO </span><span class="n">GSHPNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumGshps</span>
<a name="ln-1605"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1606"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Power</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1607"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1608"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Energy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1609"></a>        <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-1610"></a>
<a name="ln-1611"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Load Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1612"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoad</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1613"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Load Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1614"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoadEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1615"></a>
<a name="ln-1616"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Source Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1617"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1618"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Source Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1619"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSourceEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1620"></a>
<a name="ln-1621"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Load Side Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1622"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterOutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1623"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Load Side Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1624"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1625"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Source Side Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1626"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterOutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1627"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Source Side Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1628"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1629"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Load Side Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1630"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSidemdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1631"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Source Side Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1632"></a>        <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSidemdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1633"></a>
<a name="ln-1634"></a>    <span class="c">!scan for loop connection data</span>
<a name="ln-1635"></a>   <span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1636"></a>    <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1637"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">WWHPPlantTypeOfNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1638"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1639"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1640"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1641"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceCompNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1642"></a>                                 <span class="n">inletNodeNumber</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1643"></a>                                 <span class="n">errflag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-1644"></a>    <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1645"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">WWHPPlantTypeOfNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1646"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1647"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1648"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1649"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadCompNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1650"></a>                                 <span class="n">inletNodeNumber</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1651"></a>                                 <span class="n">errflag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-1652"></a>
<a name="ln-1653"></a>
<a name="ln-1654"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1655"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;GetWatertoWaterHPInput: Program terminated on scan for loop data&#39;</span><span class="p">)</span>
<a name="ln-1656"></a>    <span class="n">ENDIF</span>
<a name="ln-1657"></a>
<a name="ln-1658"></a>  <span class="k">END DO</span>
<a name="ln-1659"></a>
<a name="ln-1660"></a>
<a name="ln-1661"></a><span class="k">RETURN</span>
<a name="ln-1662"></a><span class="k">END SUBROUTINE </span><span class="n">GetGshpInput</span>
<a name="ln-1663"></a>
<a name="ln-1664"></a>
<a name="ln-1665"></a><span class="k">SUBROUTINE </span><span class="n">InitGshp</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span>
<a name="ln-1666"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1667"></a>            <span class="c">!       AUTHOR:          Dan Fisher</span>
<a name="ln-1668"></a>            <span class="c">!       DATE WRITTEN:    July 2007</span>
<a name="ln-1669"></a>
<a name="ln-1670"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1671"></a>            <span class="c">! initialization</span>
<a name="ln-1672"></a>
<a name="ln-1673"></a>
<a name="ln-1674"></a>            <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-1675"></a>
<a name="ln-1676"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-1677"></a>
<a name="ln-1678"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-1679"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TypeOf_HPWaterPECooling</span><span class="p">,</span> <span class="n">ScanPlantLoopsForObject</span><span class="p">,</span> <span class="n">PlantLoop</span>
<a name="ln-1680"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span>
<a name="ln-1681"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">InitComponentNodes</span>
<a name="ln-1682"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-1683"></a>
<a name="ln-1684"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1685"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">GSHPNum</span>       <span class="c">! GSHP number</span>
<a name="ln-1686"></a>
<a name="ln-1687"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1688"></a>          <span class="c">! na</span>
<a name="ln-1689"></a>
<a name="ln-1690"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1691"></a>          <span class="c">! na</span>
<a name="ln-1692"></a>
<a name="ln-1693"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1694"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>  <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>  <span class="kd">::</span> <span class="n">MyEnvrnFlag</span>
<a name="ln-1695"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>  <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>  <span class="kd">::</span> <span class="n">MyPlanScanFlag</span>
<a name="ln-1696"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>                            <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1697"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">rho</span> <span class="c">! local fluid density</span>
<a name="ln-1698"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-1699"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1700"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">MyPlanScanFlag</span><span class="p">(</span><span class="n">NumGSHPs</span><span class="p">))</span>
<a name="ln-1701"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumGSHPs</span><span class="p">))</span>
<a name="ln-1702"></a>    <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1703"></a>    <span class="n">MyEnvrnFlag</span>  <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1704"></a>    <span class="n">MyPlanScanFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1705"></a>  <span class="k">END IF</span>
<a name="ln-1706"></a>
<a name="ln-1707"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">MyPlanScanFlag</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1708"></a>    <span class="c">! Locate the heating on the plant loops for later usage</span>
<a name="ln-1709"></a>    <span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1710"></a>    <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1711"></a>                                 <span class="n">TypeOf_HPWaterPECooling</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1712"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1713"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1714"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1715"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceCompNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1716"></a>                                 <span class="n">InletNodeNumber</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1717"></a>                                 <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-1718"></a>    <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1719"></a>                                 <span class="n">TypeOf_HPWaterPECooling</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1720"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1721"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1722"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1723"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadCompNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1724"></a>                                 <span class="n">InletNodeNumber</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1725"></a>                                 <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-1726"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1727"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitGshp: Program terminated due to previous condition(s).&#39;</span><span class="p">)</span>
<a name="ln-1728"></a>    <span class="n">ENDIF</span>
<a name="ln-1729"></a>    <span class="n">MyPlanScanFlag</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1730"></a>  <span class="n">ENDIF</span>
<a name="ln-1731"></a>
<a name="ln-1732"></a>  <span class="c">!For each new environment</span>
<a name="ln-1733"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">))</span><span class="k">Then</span>
<a name="ln-1734"></a><span class="k">    </span><span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1735"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1736"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Power</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1737"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoadEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1738"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSourceEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1739"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Energy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1740"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterInletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1741"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterInletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1742"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterOutletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1743"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterOutletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1744"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSidemdot</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1745"></a>    <span class="n">GshpReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSidemdot</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1746"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">isOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1747"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1748"></a>
<a name="ln-1749"></a>    <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1750"></a>    <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1751"></a>                         <span class="n">InitconvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1752"></a>                         <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1753"></a>                         <span class="s1">&#39;InitGshp&#39;</span><span class="p">)</span>
<a name="ln-1754"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideDesignMassFlow</span>   <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-1755"></a>
<a name="ln-1756"></a>    <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideDesignMassFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1757"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1758"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1759"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1760"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1761"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1762"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadCompNum</span><span class="p">)</span>
<a name="ln-1763"></a>
<a name="ln-1764"></a>    <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1765"></a>                         <span class="n">InitconvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1766"></a>                         <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1767"></a>                         <span class="s1">&#39;InitGshp&#39;</span><span class="p">)</span>
<a name="ln-1768"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideDesignMassFlow</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-1769"></a>
<a name="ln-1770"></a>    <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span> <span class="mf">0.d0</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideDesignMassFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1771"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1772"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1773"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1774"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1775"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1776"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceCompNum</span><span class="p">)</span>
<a name="ln-1777"></a>
<a name="ln-1778"></a>
<a name="ln-1779"></a>     <span class="n">Node</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span>  <span class="mi">3</span><span class="mf">5.0d0</span>
<a name="ln-1780"></a>  <span class="k">END IF</span>
<a name="ln-1781"></a>
<a name="ln-1782"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1783"></a>
<a name="ln-1784"></a>
<a name="ln-1785"></a><span class="c">! Init more variables</span>
<a name="ln-1786"></a>
<a name="ln-1787"></a>  <span class="c">!On every call</span>
<a name="ln-1788"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Running</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1789"></a>
<a name="ln-1790"></a>  <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>        <span class="c">! Reset MustRun Flag to TRUE</span>
<a name="ln-1791"></a>
<a name="ln-1792"></a>  <span class="n">LoadSideWaterMassFlowRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Load Side mass flow rate, water side</span>
<a name="ln-1793"></a>  <span class="n">SourceSideWaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Source Side mass flow rate, water side</span>
<a name="ln-1794"></a>  <span class="n">Power</span>   <span class="o">=</span> <span class="mf">0.0d0</span>                         <span class="c">! power consumption</span>
<a name="ln-1795"></a>  <span class="n">QLoad</span>   <span class="o">=</span> <span class="mf">0.0d0</span>                         <span class="c">! heat rejection from Load Side coil</span>
<a name="ln-1796"></a>  <span class="n">QSource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1797"></a>
<a name="ln-1798"></a><span class="k">RETURN</span>
<a name="ln-1799"></a><span class="k">END SUBROUTINE </span><span class="n">InitGshp</span>
<a name="ln-1800"></a>
<a name="ln-1801"></a><span class="k">SUBROUTINE </span><span class="n">CalcGshpModel</span><span class="p">(</span><span class="n">GSHPType</span><span class="p">,</span><span class="n">GSHPName</span><span class="p">,</span><span class="n">GSHPNum</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-1802"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1803"></a>          <span class="c">!       AUTHOR</span>
<a name="ln-1804"></a>          <span class="c">!       DATE WRITTEN   Sept. 1998</span>
<a name="ln-1805"></a>          <span class="c">!       MODIFIED       April 1999</span>
<a name="ln-1806"></a>          <span class="c">!                      September 2002, SJR</span>
<a name="ln-1807"></a>          <span class="c">!       RE-ENGINEERED  Mar2000</span>
<a name="ln-1808"></a>
<a name="ln-1809"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE: This routine performs</span>
<a name="ln-1810"></a>
<a name="ln-1811"></a>          <span class="c">! METHODOLOGY EMPLOYED: under development</span>
<a name="ln-1812"></a>
<a name="ln-1813"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1814"></a>
<a name="ln-1815"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1816"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TimeStepSys</span> <span class="p">,</span><span class="n">SysTimeElapsed</span><span class="p">,</span><span class="n">FirstTimeStepSysFlag</span>
<a name="ln-1817"></a>  <span class="k">USE </span><span class="n">FluidProperties</span>
<a name="ln-1818"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-1819"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span> <span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-1820"></a>  <span class="k">USE </span><span class="n">DataBranchAirLoopPlant</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">MassFlowTolerance</span>
<a name="ln-1821"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span> <span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-1822"></a>
<a name="ln-1823"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-1824"></a>
<a name="ln-1825"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1826"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GshpType</span>  <span class="c">! type ofGSHP</span>
<a name="ln-1827"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GshpName</span>  <span class="c">! user specified name ofGSHP</span>
<a name="ln-1828"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">GSHPNum</span>                      <span class="c">! GSHP Number</span>
<a name="ln-1829"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">MyLoad</span>                       <span class="c">! Operating Load</span>
<a name="ln-1830"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-1831"></a>
<a name="ln-1832"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1833"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="nb">gamma</span>            <span class="o">=</span> <span class="mf">1.114d0</span>    <span class="c">! Expnasion Coefficient</span>
<a name="ln-1834"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">HeatBalTol</span>       <span class="o">=</span> <span class="mf">0.0005d0</span>
<a name="ln-1835"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">RelaxParam</span>       <span class="o">=</span> <span class="mf">0.6d0</span>
<a name="ln-1836"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">SmallNum</span>         <span class="o">=</span> <span class="mf">1.0d-20</span>
<a name="ln-1837"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>          <span class="kd">::</span> <span class="n">IterationLimit</span>   <span class="o">=</span> <span class="mi">500</span>
<a name="ln-1838"></a>
<a name="ln-1839"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1840"></a>          <span class="c">! na</span>
<a name="ln-1841"></a>
<a name="ln-1842"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1843"></a>          <span class="c">! na</span>
<a name="ln-1844"></a>
<a name="ln-1845"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1846"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideEffect</span>         <span class="c">! Source Side effectiveness</span>
<a name="ln-1847"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideEffect</span>           <span class="c">! Load Side effectiveness</span>
<a name="ln-1848"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideRefridgTemp</span>    <span class="c">! Source Side temperature</span>
<a name="ln-1849"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideRefridgTemp</span>      <span class="c">! Load Side temperature</span>
<a name="ln-1850"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideUA</span>             <span class="c">! Source Side heat transfer coefficient</span>
<a name="ln-1851"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideUA</span>               <span class="c">! Load Side heat transfer coefficient</span>
<a name="ln-1852"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSidePressure</span>       <span class="c">! Source Side pressure</span>
<a name="ln-1853"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSidePressure</span>         <span class="c">! Load Side pressure</span>
<a name="ln-1854"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SuctionPr</span>                <span class="c">! Suction Pressure</span>
<a name="ln-1855"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">DischargePr</span>              <span class="c">! Discharge Pressure</span>
<a name="ln-1856"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CompressInletTemp</span>        <span class="c">! Compressor inlet temperature</span>
<a name="ln-1857"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">PressureDrop</span>             <span class="c">! Suction Pressure drop</span>
<a name="ln-1858"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">ClearanceFactor</span>          <span class="c">! Clearance factor</span>
<a name="ln-1859"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">PistonDisp</span>               <span class="c">! Compressor piston displacement</span>
<a name="ln-1860"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">ShTemp</span>                   <span class="c">! Superheat temperature</span>
<a name="ln-1861"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LosFac</span>                   <span class="c">! Loss factor used to define the electromechanical loss for compressor</span>
<a name="ln-1862"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">MassRef</span>                  <span class="c">! mass flow rate of refrigerant</span>
<a name="ln-1863"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SourceSideOutletEnth</span>     <span class="c">! Enthalpy at Source Side pressure</span>
<a name="ln-1864"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LoadSideOutletEnth</span>       <span class="c">! Enthalpy at Condensor Pressure</span>
<a name="ln-1865"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">initialQSource</span>           <span class="c">! Guess Source Side Heat rate</span>
<a name="ln-1866"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">initialQLoad</span>             <span class="c">! Guess Load Side Heat rate</span>
<a name="ln-1867"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">qual</span>                     <span class="c">! quality</span>
<a name="ln-1868"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">COP</span>
<a name="ln-1869"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SuperHeatEnth</span>
<a name="ln-1870"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">T110</span>
<a name="ln-1871"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">T111</span>
<a name="ln-1872"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CompSuctionTemp</span>
<a name="ln-1873"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CompSuctionEnth</span>
<a name="ln-1874"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CompSuctionDensity</span>
<a name="ln-1875"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">PowerLosses</span>
<a name="ln-1876"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CompSuctionSatTemp</span>
<a name="ln-1877"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">HighPressCutOff</span>
<a name="ln-1878"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LowPressCutOff</span>
<a name="ln-1879"></a>   <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">ErrString</span>
<a name="ln-1880"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">DutyFactor</span>
<a name="ln-1881"></a>   <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">IterationCount</span>
<a name="ln-1882"></a>
<a name="ln-1883"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">CurrentSimTime</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1884"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">PrevSimTime</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1885"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>          <span class="kd">::</span> <span class="n">OneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1886"></a>  <span class="c">! Nodes</span>
<a name="ln-1887"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">SourceSideInletNode</span>      <span class="c">! Source Side inlet node number, water side</span>
<a name="ln-1888"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">SourceSideOutletNode</span>     <span class="c">! Source Side outlet node number, water side</span>
<a name="ln-1889"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">LoadSideInletNode</span>        <span class="c">! Load Side inlet node number, water side</span>
<a name="ln-1890"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">LoadSideOutletNode</span>       <span class="c">! Load Side outlet node number, water side</span>
<a name="ln-1891"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopNum</span>
<a name="ln-1892"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopSideNum</span>
<a name="ln-1893"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpSourceSide</span> <span class="c">! local temporary for fluid specific heat</span>
<a name="ln-1894"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpLoadSide</span> <span class="c">! local temporary for fluid specific heat</span>
<a name="ln-1895"></a>
<a name="ln-1896"></a>  <span class="c">!  LOAD LOCAL VARIABLES FROM DATA STRUCTURE (for code readability)</span>
<a name="ln-1897"></a>  <span class="n">PressureDrop</span>      <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CompSucPressDrop</span>
<a name="ln-1898"></a>  <span class="n">ClearanceFactor</span>   <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CompClearanceFactor</span>
<a name="ln-1899"></a>  <span class="n">PistonDisp</span>        <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CompPistonDisp</span>
<a name="ln-1900"></a>  <span class="n">ShTemp</span>            <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SuperheatTemp</span>
<a name="ln-1901"></a>  <span class="n">LosFac</span>            <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LossFactor</span>
<a name="ln-1902"></a>  <span class="n">SourceSideUA</span>      <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideUACoeff</span>
<a name="ln-1903"></a>  <span class="n">LoadSideUA</span>        <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideUACoeff</span>
<a name="ln-1904"></a>  <span class="n">PowerLosses</span>       <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">PowerLosses</span>
<a name="ln-1905"></a>  <span class="n">COP</span>               <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">COP</span>
<a name="ln-1906"></a>  <span class="n">HighPressCutOff</span>   <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HighPressCutOff</span>
<a name="ln-1907"></a>  <span class="n">LowPressCutOff</span>    <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LowPressCutOff</span>
<a name="ln-1908"></a>  <span class="n">LoadSideInletNode</span>    <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span>
<a name="ln-1909"></a>  <span class="n">LoadSideOutletNode</span>   <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletNodeNum</span>
<a name="ln-1910"></a>  <span class="n">SourceSideInletNode</span>  <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span>
<a name="ln-1911"></a>  <span class="n">SourceSideOutletNode</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span>
<a name="ln-1912"></a>  <span class="n">LoopNum</span>              <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span>
<a name="ln-1913"></a>  <span class="n">LoopSideNum</span>          <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span>
<a name="ln-1914"></a>
<a name="ln-1915"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">PrevSimTime</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">CurrentSimTime</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1916"></a><span class="k">     </span><span class="n">PrevSimTime</span> <span class="o">=</span> <span class="n">CurrentSimTime</span>
<a name="ln-1917"></a>  <span class="k">END IF</span>
<a name="ln-1918"></a>
<a name="ln-1919"></a>  <span class="c">! CALCULATE THE SIMULATION TIME</span>
<a name="ln-1920"></a>  <span class="n">CurrentSimTime</span> <span class="o">=</span> <span class="p">(</span><span class="n">dayofSim</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">24</span> <span class="o">+</span> <span class="n">hourofday</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">timestep</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">timestepZone</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-1921"></a>
<a name="ln-1922"></a>  <span class="c">! initialize event time array when the environment simulation begins</span>
<a name="ln-1923"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">CurrentSimTime</span> <span class="o">==</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">OneTimeFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1924"></a><span class="k">    </span><span class="n">OneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1925"></a>  <span class="k">END IF</span>
<a name="ln-1926"></a>
<a name="ln-1927"></a><span class="k">  IF</span><span class="p">(</span><span class="n">CurrentSimTime</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="n">OneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1928"></a>
<a name="ln-1929"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">MyLoad</span> <span class="o">&lt;</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1930"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1931"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">IsOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1932"></a>  <span class="k">ELSE</span>
<a name="ln-1933"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1934"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">IsOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1935"></a>  <span class="k">END IF</span>
<a name="ln-1936"></a>
<a name="ln-1937"></a><span class="c">!*******Set flow based on &quot;flowlock&quot; and &quot;run&quot; flags**********</span>
<a name="ln-1938"></a><span class="c">! Set flows if the heat pump is not running</span>
<a name="ln-1939"></a>  <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-1940"></a><span class="k">    </span><span class="n">LoadSideWaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1941"></a>    <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">LoadSideWaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1942"></a>          <span class="n">LoadSideInletNode</span><span class="p">,</span> <span class="n">LoadSideOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1943"></a>          <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1944"></a>          <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadBranchNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadCompNum</span><span class="p">)</span>
<a name="ln-1945"></a>    <span class="n">SourceSideWaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1946"></a>    <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">SourceSideWaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1947"></a>          <span class="n">SourceSideInletNode</span><span class="p">,</span> <span class="n">SourceSideOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1948"></a>          <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1949"></a>          <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceBranchNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceCompNum</span><span class="p">)</span>
<a name="ln-1950"></a>        <span class="c">!now initialize simulation variables for &quot;heat pump off&quot;</span>
<a name="ln-1951"></a>    <span class="n">QLoad</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1952"></a>    <span class="n">QSource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1953"></a>    <span class="n">Power</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1954"></a>    <span class="n">LoadSideWaterInletTemp</span>      <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1955"></a>    <span class="n">LoadSideWaterOutletTemp</span>     <span class="o">=</span> <span class="n">LoadSideWaterInletTemp</span>
<a name="ln-1956"></a>    <span class="n">SourceSideWaterInletTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1957"></a>    <span class="n">SourceSideWaterOutletTemp</span>   <span class="o">=</span> <span class="n">SourceSideWaterInletTemp</span>
<a name="ln-1958"></a>    <span class="k">RETURN</span> <span class="c">!if heat pump is not running return without simulation</span>
<a name="ln-1959"></a>
<a name="ln-1960"></a><span class="c">! Set flows if the heat pump is running</span>
<a name="ln-1961"></a>  <span class="k">ELSE</span> <span class="c">! the heat pump must run</span>
<a name="ln-1962"></a>    <span class="n">LoadSideWaterMassFlowRate</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideDesignMassFlow</span>
<a name="ln-1963"></a>    <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">LoadSideWaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1964"></a>          <span class="n">LoadSideInletNode</span><span class="p">,</span> <span class="n">LoadSideOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1965"></a>          <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1966"></a>          <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadBranchNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadCompNum</span><span class="p">)</span>
<a name="ln-1967"></a>
<a name="ln-1968"></a>    <span class="n">SourceSideWaterMassFlowRate</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideDesignMassFlow</span>
<a name="ln-1969"></a>    <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">SourceSideWaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1970"></a>          <span class="n">SourceSideInletNode</span><span class="p">,</span> <span class="n">SourceSideOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1971"></a>          <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1972"></a>          <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceBranchNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceCompNum</span><span class="p">)</span>
<a name="ln-1973"></a>    <span class="c">! get inlet temps</span>
<a name="ln-1974"></a>    <span class="n">LoadSideWaterInletTemp</span>      <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1975"></a>    <span class="n">SourceSideWaterInletTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1976"></a>    <span class="c">!if there&#39;s no flow, turn the &quot;heat pump off&quot;</span>
<a name="ln-1977"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">LoadSideWaterMassFlowRate</span> <span class="o">&lt;</span> <span class="n">MassFlowTolerance</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1978"></a>      <span class="n">SourceSideWaterMassFlowRate</span> <span class="o">&lt;</span> <span class="n">MassFlowTolerance</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1979"></a><span class="k">        </span><span class="n">LoadSideWaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1980"></a>        <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">LoadSideWaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1981"></a>              <span class="n">LoadSideInletNode</span><span class="p">,</span> <span class="n">LoadSideOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1982"></a>              <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1983"></a>              <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadBranchNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadCompNum</span><span class="p">)</span>
<a name="ln-1984"></a>        <span class="n">SourceSideWaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1985"></a>        <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">SourceSideWaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1986"></a>              <span class="n">SourceSideInletNode</span><span class="p">,</span> <span class="n">SourceSideOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1987"></a>              <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1988"></a>              <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceBranchNum</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceCompNum</span><span class="p">)</span>
<a name="ln-1989"></a>        <span class="n">QLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1990"></a>        <span class="n">QSource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1991"></a>        <span class="n">Power</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1992"></a>        <span class="n">LoadSideWaterInletTemp</span>      <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1993"></a>        <span class="n">LoadSideWaterOutletTemp</span>     <span class="o">=</span> <span class="n">LoadSideWaterInletTemp</span>
<a name="ln-1994"></a>        <span class="n">SourceSideWaterInletTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1995"></a>        <span class="n">SourceSideWaterOutletTemp</span>   <span class="o">=</span> <span class="n">SourceSideWaterInletTemp</span>
<a name="ln-1996"></a>      <span class="k">RETURN</span>
<a name="ln-1997"></a><span class="k">    END IF</span>
<a name="ln-1998"></a><span class="k">  END IF</span>
<a name="ln-1999"></a>
<a name="ln-2000"></a>
<a name="ln-2001"></a><span class="c">!**********BEGIN THE CALCULATION**************</span>
<a name="ln-2002"></a>
<a name="ln-2003"></a><span class="c">! initialize the source and load side heat transfer rates for the simulation</span>
<a name="ln-2004"></a>  <span class="n">initialQSource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2005"></a>  <span class="n">initialQLoad</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2006"></a>  <span class="n">IterationCount</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2007"></a>
<a name="ln-2008"></a>  <span class="n">CpSourceSide</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2009"></a>                                       <span class="n">SourceSideWaterInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2010"></a>                                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2011"></a>                                       <span class="s1">&#39;CalcGshpModel&#39;</span><span class="p">)</span>
<a name="ln-2012"></a>
<a name="ln-2013"></a>  <span class="n">CpLoadSide</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2014"></a>                                       <span class="n">LoadSideWaterInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2015"></a>                                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2016"></a>                                       <span class="s1">&#39;CalcGshpModel&#39;</span><span class="p">)</span>
<a name="ln-2017"></a>
<a name="ln-2018"></a>
<a name="ln-2019"></a>  <span class="c">!Determine effectiveness of Load Side</span>
<a name="ln-2020"></a>  <span class="n">LoadSideEffect</span>   <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">EXP</span> <span class="p">(</span> <span class="o">-</span><span class="n">LoadSideUA</span> <span class="o">/</span> <span class="p">(</span><span class="n">CpLoadSide</span> <span class="o">*</span> <span class="n">LoadSidewaterMassFlowRate</span><span class="p">))</span>
<a name="ln-2021"></a>  <span class="c">! Determine effectiveness of Source Side</span>
<a name="ln-2022"></a>  <span class="n">SourceSideEffect</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">EXP</span><span class="p">(</span> <span class="o">-</span><span class="n">SourceSideUA</span> <span class="o">/</span> <span class="p">(</span><span class="n">CpSourceSide</span> <span class="o">*</span> <span class="n">SourceSideWaterMassFlowRate</span> <span class="p">))</span>
<a name="ln-2023"></a>
<a name="ln-2024"></a>  <span class="c">! main iteration loop to solve model equations</span>
<a name="ln-2025"></a>  <span class="n">LOOPSourceEnth</span><span class="p">:</span> <span class="k">DO</span>
<a name="ln-2026"></a><span class="k">    </span><span class="n">IterationCount</span> <span class="o">=</span> <span class="n">IterationCount</span> <span class="o">+</span><span class="mi">1</span>
<a name="ln-2027"></a>
<a name="ln-2028"></a>    <span class="c">! To determine Load Side temperature</span>
<a name="ln-2029"></a>    <span class="n">LoadSideRefridgTemp</span> <span class="o">=</span> <span class="n">LoadSideWaterInletTemp</span> <span class="o">-</span> <span class="n">initialQLoad</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-2030"></a>    <span class="p">(</span><span class="n">LoadSideEffect</span> <span class="o">*</span> <span class="n">CpLoadSide</span> <span class="o">*</span> <span class="n">LoadSideWaterMassFlowRate</span><span class="p">)</span>
<a name="ln-2031"></a>
<a name="ln-2032"></a>    <span class="c">! Determine Source Side tempertaure</span>
<a name="ln-2033"></a>    <span class="n">SourceSideRefridgTemp</span> <span class="o">=</span> <span class="n">SourceSideWaterInletTemp</span> <span class="o">+</span> <span class="n">initialQSource</span><span class="o">/</span><span class="p">&amp;</span>
<a name="ln-2034"></a>    <span class="p">(</span><span class="n">SourceSideEffect</span> <span class="o">*</span> <span class="n">CpSourceSide</span> <span class="o">*</span> <span class="n">SourceSideWaterMassFlowRate</span> <span class="p">)</span>
<a name="ln-2035"></a>
<a name="ln-2036"></a>    <span class="c">! Determine the evaporating and condensing pressures</span>
<a name="ln-2037"></a>    <span class="n">SourceSidePressure</span>  <span class="o">=</span> <span class="n">GetSatPressureRefrig</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">,</span><span class="n">SourceSideRefridgTemp</span><span class="p">,</span><span class="n">GSHPRefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcGSHPModel&#39;</span><span class="p">)</span>
<a name="ln-2038"></a>    <span class="n">LoadSidePressure</span>  <span class="o">=</span> <span class="n">GetSatPressureRefrig</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">,</span><span class="n">LoadSideRefridgTemp</span><span class="p">,</span><span class="n">GSHPRefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcGSHPModel&#39;</span><span class="p">)</span>
<a name="ln-2039"></a>
<a name="ln-2040"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SourceSidePressure</span> <span class="o">&lt;</span> <span class="n">LowPressCutOff</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2041"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Cooling Source Side Pressure Less than the Design Minimum&#39;</span><span class="p">)</span>
<a name="ln-2042"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Cooling Source Side Pressure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SourceSidePressure</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2043"></a>                             <span class="s1">&#39; and user specified Design Minimum Pressure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">LowPressCutOff</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-2044"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">)</span>
<a name="ln-2045"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding Conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-2046"></a>    <span class="k">END IF</span>
<a name="ln-2047"></a>
<a name="ln-2048"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">LoadSidePressure</span> <span class="o">&gt;</span> <span class="n">HighPressCutOff</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2049"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Cooling Load Side Pressure greater than the Design Maximum&#39;</span><span class="p">)</span>
<a name="ln-2050"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Cooling Load Side Pressure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">LoadSidePressure</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2051"></a>                             <span class="s1">&#39; and user specified Design Maximum Pressure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HighPressCutOff</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-2052"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">)</span>
<a name="ln-2053"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding Conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-2054"></a>    <span class="k">END IF</span>
<a name="ln-2055"></a>    <span class="c">! Determine Suction Pressure at compressor inlet</span>
<a name="ln-2056"></a>    <span class="n">SuctionPr</span> <span class="o">=</span> <span class="n">LoadSidePressure</span> <span class="o">-</span> <span class="n">PressureDrop</span>
<a name="ln-2057"></a>    <span class="c">! Determine Discharge Pressure at compressor exit</span>
<a name="ln-2058"></a>    <span class="n">DischargePr</span> <span class="o">=</span> <span class="n">SourceSidePressure</span> <span class="o">+</span> <span class="n">PressureDrop</span>
<a name="ln-2059"></a>
<a name="ln-2060"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SuctionPr</span> <span class="o">&lt;</span> <span class="n">LowPressCutOff</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2061"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Cooling Suction Pressure Less than the Design Minimum&#39;</span><span class="p">)</span>
<a name="ln-2062"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Cooling Suction Pressure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SuctionPr</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2063"></a>                             <span class="s1">&#39; and user specified Design Minimum Pressure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">LowPressCutOff</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-2064"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">)</span>
<a name="ln-2065"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding Conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-2066"></a>    <span class="k">END IF</span>
<a name="ln-2067"></a>
<a name="ln-2068"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DischargePr</span> <span class="o">&gt;</span> <span class="n">HighPressCutOff</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2069"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">ModuleCompName</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Cooling Discharge Pressure greater than the Design Maximum&#39;</span><span class="p">)</span>
<a name="ln-2070"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Cooling Discharge Pressure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DischargePr</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2071"></a>                             <span class="s1">&#39; and user specified Design Maximum Pressure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HighPressCutOff</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-2072"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">)</span>
<a name="ln-2073"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding Conditions cause termination.&#39;</span><span class="p">)</span>
<a name="ln-2074"></a>    <span class="k">END IF</span>
<a name="ln-2075"></a>
<a name="ln-2076"></a>    <span class="c">! Determine the Source Side Outlet Enthalpy</span>
<a name="ln-2077"></a>
<a name="ln-2078"></a>    <span class="n">qual</span><span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2079"></a>    <span class="n">LoadSideOutletEnth</span> <span class="o">=</span> <span class="n">GetSatEnthalpyRefrig</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">,</span><span class="n">LoadSideRefridgTemp</span><span class="p">,</span><span class="n">qual</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2080"></a>       <span class="n">GSHPRefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcGSHPModel:LoadSideRefridgTemp&#39;</span><span class="p">)</span>
<a name="ln-2081"></a>
<a name="ln-2082"></a>    <span class="n">qual</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2083"></a>    <span class="n">SourceSideOutletEnth</span> <span class="o">=</span> <span class="n">GetSatEnthalpyRefrig</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">,</span> <span class="n">SourceSideRefridgTemp</span><span class="p">,</span> <span class="n">qual</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2084"></a>       <span class="n">GSHPRefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcGSHPModel:SourceSideRefridgTemp&#39;</span><span class="p">)</span>
<a name="ln-2085"></a>
<a name="ln-2086"></a>    <span class="c">! Determine Load Side Outlet Enthalpy</span>
<a name="ln-2087"></a>    <span class="c">! Determine superheated temperature of the LoadSide outlet/compressor inlet</span>
<a name="ln-2088"></a>    <span class="n">CompressInletTemp</span> <span class="o">=</span> <span class="n">LoadSideRefridgTemp</span> <span class="o">+</span> <span class="n">ShTemp</span>
<a name="ln-2089"></a>
<a name="ln-2090"></a>    <span class="c">! Determine the enathalpy of the super heated fluid at Source Side outlet</span>
<a name="ln-2091"></a>    <span class="n">SuperHeatEnth</span> <span class="o">=</span> <span class="n">GetSupHeatEnthalpyRefrig</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">,</span><span class="n">CompressInletTemp</span><span class="p">,</span><span class="n">LoadSidePressure</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2092"></a>       <span class="n">GSHPRefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcGSHPModel:CompressInletTemp&#39;</span><span class="p">)</span>
<a name="ln-2093"></a>
<a name="ln-2094"></a>    <span class="c">! Determining the suction state of the fluid from inlet state involves interation</span>
<a name="ln-2095"></a>    <span class="c">! Method employed...</span>
<a name="ln-2096"></a>    <span class="c">! Determine the saturated temp at suction pressure, shoot out into the superheated region find the enthalpy</span>
<a name="ln-2097"></a>    <span class="c">! check that with the inlet enthalpy ( as suction loss is isenthalpic). Iterate till desired accuracy is reached</span>
<a name="ln-2098"></a>
<a name="ln-2099"></a>    <span class="c">!this routine was reenginerred from HVACsim + takes pressure in Pascals, tolrance, refrgerant # R22 =6</span>
<a name="ln-2100"></a>    <span class="n">CompSuctionSatTemp</span> <span class="o">=</span> <span class="n">GetSatTemperatureRefrig</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">,</span><span class="n">SuctionPr</span><span class="p">,</span><span class="n">GSHPRefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcGSHPModel:SuctionPr&#39;</span><span class="p">)</span>
<a name="ln-2101"></a>
<a name="ln-2102"></a>    <span class="n">T110</span> <span class="o">=</span> <span class="n">CompSuctionSatTemp</span>
<a name="ln-2103"></a>    <span class="c">!            Shoot into the super heated region</span>
<a name="ln-2104"></a>    <span class="n">T111</span> <span class="o">=</span> <span class="n">CompSuctionSatTemp</span> <span class="o">+</span> <span class="mi">10</span><span class="mf">0.d0</span>
<a name="ln-2105"></a>    <span class="c">! Iterate to find the Suction State</span>
<a name="ln-2106"></a>    <span class="n">LOOP</span><span class="p">:</span> <span class="k">DO</span>
<a name="ln-2107"></a><span class="k">      </span><span class="n">CompSuctionTemp</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="p">(</span> <span class="n">T110</span> <span class="o">+</span> <span class="n">T111</span> <span class="p">)</span>
<a name="ln-2108"></a>
<a name="ln-2109"></a>      <span class="n">CompSuctionEnth</span> <span class="o">=</span> <span class="n">GetSupHeatEnthalpyRefrig</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">,</span><span class="n">CompSuctionTemp</span><span class="p">,</span><span class="n">SuctionPr</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2110"></a>         <span class="n">GSHPRefrigIndex</span><span class="p">,</span><span class="s1">&#39;CalcGSHPModel:CompSuctionTemp&#39;</span><span class="p">)</span>
<a name="ln-2111"></a>
<a name="ln-2112"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CompsuctionEnth</span><span class="o">-</span><span class="n">SuperHeatEnth</span><span class="p">)</span><span class="o">/</span><span class="n">SuperHeatEnth</span> <span class="o">&lt;</span> <span class="p">.</span><span class="mi">0001</span><span class="n">d0</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-2113"></a><span class="k">        EXIT </span><span class="n">LOOP</span>
<a name="ln-2114"></a>      <span class="k">END IF</span>
<a name="ln-2115"></a>
<a name="ln-2116"></a><span class="k">      IF</span> <span class="p">(</span> <span class="n">CompsuctionEnth</span> <span class="o">&lt;</span> <span class="n">SuperHeatEnth</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2117"></a><span class="k">        </span><span class="n">T110</span> <span class="o">=</span> <span class="n">CompSuctionTemp</span>
<a name="ln-2118"></a>      <span class="k">ELSE</span>
<a name="ln-2119"></a><span class="k">        </span><span class="n">T111</span> <span class="o">=</span> <span class="n">CompSuctionTemp</span>
<a name="ln-2120"></a>      <span class="k">END IF</span>
<a name="ln-2121"></a><span class="k">    END DO </span><span class="n">LOOP</span>
<a name="ln-2122"></a>
<a name="ln-2123"></a>    <span class="c">! Determine the Mass flow rate of refrigerant</span>
<a name="ln-2124"></a>    <span class="n">CompSuctionDensity</span> <span class="o">=</span> <span class="n">GetSupHeatDensityRefrig</span><span class="p">(</span><span class="n">GSHPRefrigerant</span><span class="p">,</span> <span class="n">CompSuctionTemp</span><span class="p">,</span> <span class="n">SuctionPr</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2125"></a>          <span class="n">GSHPRefrigIndex</span> <span class="p">,</span><span class="s1">&#39;CalcGSHPModel:CompSuctionTemp&#39;</span><span class="p">)</span>
<a name="ln-2126"></a>    <span class="n">MassRef</span> <span class="o">=</span> <span class="n">PistonDisp</span> <span class="o">*</span> <span class="n">CompSuctionDensity</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">ClearanceFactor</span><span class="o">-</span><span class="n">ClearanceFactor</span><span class="o">*</span><span class="p">((</span><span class="n">DischargePr</span><span class="o">/</span><span class="n">SuctionPr</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">gamma</span><span class="p">)))</span>
<a name="ln-2127"></a>
<a name="ln-2128"></a>    <span class="c">! Find the Source Side Heat Transfer</span>
<a name="ln-2129"></a>
<a name="ln-2130"></a>    <span class="n">QLoad</span> <span class="o">=</span> <span class="n">MassRef</span> <span class="o">*</span> <span class="p">(</span> <span class="n">LoadSideOutletEnth</span> <span class="o">-</span> <span class="n">SourceSideOutletEnth</span> <span class="p">)</span>
<a name="ln-2131"></a>
<a name="ln-2132"></a>    <span class="c">! Determine the theoretical power</span>
<a name="ln-2133"></a>    <span class="n">Power</span> <span class="o">=</span> <span class="n">PowerLosses</span><span class="o">+</span><span class="p">(</span><span class="n">MassRef</span><span class="o">*</span><span class="nb">gamma</span><span class="o">/</span><span class="p">(</span><span class="nb">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">SuctionPr</span> <span class="o">/</span><span class="n">CompSuctionDensity</span><span class="o">/</span><span class="n">LosFac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2134"></a>    <span class="p">((</span><span class="n">DischargePr</span><span class="o">/</span><span class="n">SuctionPr</span><span class="p">)</span><span class="o">**</span><span class="p">((</span><span class="nb">gamma</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">gamma</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-2135"></a>
<a name="ln-2136"></a>    <span class="c">! Determine the Loadside HeatRate (QLoad)</span>
<a name="ln-2137"></a>    <span class="n">QSource</span> <span class="o">=</span> <span class="n">Power</span> <span class="o">+</span> <span class="n">QLoad</span>
<a name="ln-2138"></a>    <span class="c">! convergence and iteration limit check</span>
<a name="ln-2139"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">((</span><span class="n">QSource</span> <span class="o">-</span> <span class="n">initialQSource</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">initialQSource</span><span class="o">+</span><span class="n">SmallNum</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">HeatBalTol</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">IterationCount</span><span class="o">&gt;</span><span class="n">IterationLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2140"></a><span class="k">      IF</span><span class="p">(</span><span class="n">IterationCount</span><span class="o">&gt;</span><span class="n">IterationLimit</span><span class="p">)</span><span class="k">then</span>
<a name="ln-2141"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;HeatPump:WaterToWater:ParameterEstimation, Cooling did not converge&#39;</span><span class="p">)</span>
<a name="ln-2142"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">)</span>
<a name="ln-2143"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heatpump Name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2144"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="nb">ABS</span><span class="p">(</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="o">*</span><span class="p">(</span><span class="n">QSource</span> <span class="o">-</span> <span class="n">initialQSource</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">initialQSource</span><span class="o">+</span><span class="n">SmallNum</span><span class="p">))</span>
<a name="ln-2145"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heat Inbalance (%)             = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)))</span>
<a name="ln-2146"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">QLoad</span>
<a name="ln-2147"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Load-side heat transfer rate   = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)))</span>
<a name="ln-2148"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">Qsource</span>
<a name="ln-2149"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Source-side heat transfer rate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)))</span>
<a name="ln-2150"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">SourceSideWaterMassFlowRate</span>
<a name="ln-2151"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Source-side mass flow rate     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)))</span>
<a name="ln-2152"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">LoadSideWaterMassFlowRate</span>
<a name="ln-2153"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Load-side mass flow rate       = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)))</span>
<a name="ln-2154"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">SourceSideWaterInletTemp</span>
<a name="ln-2155"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Source-side inlet temperature  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)))</span>
<a name="ln-2156"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">ErrString</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">LoadSideWaterInletTemp</span>
<a name="ln-2157"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Load-side inlet temperature    = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">ErrString</span><span class="p">)))</span>
<a name="ln-2158"></a>
<a name="ln-2159"></a>      <span class="k">END IF</span>
<a name="ln-2160"></a><span class="k">      EXIT </span><span class="n">LOOPSourceEnth</span>
<a name="ln-2161"></a>
<a name="ln-2162"></a>    <span class="k">ELSE</span> <span class="c">! update load</span>
<a name="ln-2163"></a>      <span class="n">initialQSource</span> <span class="o">=</span> <span class="n">initialQSource</span><span class="o">+</span> <span class="n">RelaxParam</span><span class="o">*</span><span class="p">(</span><span class="n">QSource</span><span class="o">-</span><span class="n">initialQSource</span><span class="p">)</span>
<a name="ln-2164"></a>      <span class="n">initialQLoad</span> <span class="o">=</span> <span class="n">initialQLoad</span> <span class="o">+</span> <span class="n">RelaxParam</span><span class="o">*</span><span class="p">(</span><span class="n">QLoad</span> <span class="o">-</span> <span class="n">initialQLoad</span><span class="p">)</span>
<a name="ln-2165"></a>
<a name="ln-2166"></a>    <span class="k">END IF</span>
<a name="ln-2167"></a>
<a name="ln-2168"></a><span class="k">  END DO </span><span class="n">LOOPSourceEnth</span>
<a name="ln-2169"></a>
<a name="ln-2170"></a>  <span class="c">!Control Strategy</span>
<a name="ln-2171"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">QLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2172"></a><span class="k">    </span><span class="n">DutyFactor</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span><span class="o">/</span><span class="n">QLoad</span>
<a name="ln-2173"></a>    <span class="n">QLoad</span>      <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-2174"></a>    <span class="n">Power</span>      <span class="o">=</span> <span class="n">DutyFactor</span> <span class="o">*</span> <span class="n">Power</span>
<a name="ln-2175"></a>    <span class="n">QSource</span>    <span class="o">=</span> <span class="n">QSource</span> <span class="o">*</span> <span class="n">DutyFactor</span>
<a name="ln-2176"></a>    <span class="c">! Determine the Exterior fluid temperature at the Load Side oulet and eveporator outlet...</span>
<a name="ln-2177"></a>    <span class="n">LoadSideWaterOutletTemp</span>   <span class="o">=</span> <span class="n">LoadSideWaterInletTemp</span> <span class="o">-</span> <span class="n">QLoad</span><span class="o">/</span><span class="p">&amp;</span> <span class="c">! Chilled water</span>
<a name="ln-2178"></a>                                <span class="p">(</span><span class="n">LoadSideWaterMassFlowRate</span> <span class="o">*</span> <span class="n">CpLoadSide</span><span class="p">)</span>
<a name="ln-2179"></a>    <span class="n">SourceSideWaterOutletTemp</span> <span class="o">=</span> <span class="n">SourceSideWaterInletTemp</span> <span class="o">+</span> <span class="n">QSource</span><span class="o">/</span> <span class="p">&amp;</span> <span class="c">! cooling water</span>
<a name="ln-2180"></a>                                <span class="p">(</span><span class="n">SourceSideWaterMassFlowRate</span>  <span class="o">*</span> <span class="n">CpSourceSide</span><span class="p">)</span>
<a name="ln-2181"></a>    <span class="k">RETURN</span>
<a name="ln-2182"></a><span class="k">  END IF</span>
<a name="ln-2183"></a>
<a name="ln-2184"></a><span class="k">  </span><span class="n">LoadSideWaterOutletTemp</span>   <span class="o">=</span> <span class="n">LoadSideWaterInletTemp</span> <span class="o">-</span> <span class="n">QLoad</span><span class="o">/</span><span class="p">&amp;</span> <span class="c">! Chilled water</span>
<a name="ln-2185"></a>                              <span class="p">(</span><span class="n">LoadSideWaterMassFlowRate</span> <span class="o">*</span> <span class="n">CpLoadSide</span><span class="p">)</span>
<a name="ln-2186"></a>  <span class="n">SourceSideWaterOutletTemp</span> <span class="o">=</span> <span class="n">SourceSideWaterInletTemp</span> <span class="o">+</span> <span class="n">QSource</span><span class="o">/</span><span class="p">&amp;</span>
<a name="ln-2187"></a>                              <span class="p">(</span><span class="n">SourceSideWaterMassFlowRate</span>  <span class="o">*</span> <span class="n">CpSourceSide</span><span class="p">)</span>
<a name="ln-2188"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Running</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2189"></a>
<a name="ln-2190"></a> <span class="k">RETURN</span>
<a name="ln-2191"></a>
<a name="ln-2192"></a><span class="k">END SUBROUTINE </span><span class="n">CalcGshpModel</span>
<a name="ln-2193"></a>
<a name="ln-2194"></a><span class="k">SUBROUTINE </span><span class="n">UpdateGSHPRecords</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span>
<a name="ln-2195"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2196"></a>            <span class="c">!       AUTHOR:          Dan Fisher</span>
<a name="ln-2197"></a>            <span class="c">!       DATE WRITTEN:    October 1998</span>
<a name="ln-2198"></a>
<a name="ln-2199"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2200"></a>            <span class="c">! reporting</span>
<a name="ln-2201"></a>
<a name="ln-2202"></a>
<a name="ln-2203"></a>            <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-2204"></a>
<a name="ln-2205"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-2206"></a>
<a name="ln-2207"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-2208"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-2209"></a>
<a name="ln-2210"></a>
<a name="ln-2211"></a><span class="k">IMPLICIT NONE</span>
<a name="ln-2212"></a>
<a name="ln-2213"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2214"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">GSHPNum</span>       <span class="c">! GSHP number</span>
<a name="ln-2215"></a>
<a name="ln-2216"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2217"></a>          <span class="c">! na</span>
<a name="ln-2218"></a>
<a name="ln-2219"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2220"></a>          <span class="c">! na</span>
<a name="ln-2221"></a>
<a name="ln-2222"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2223"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">SourceSideInletNode</span>      <span class="c">! Source Side inlet node number, water side</span>
<a name="ln-2224"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">SourceSideOutletNode</span>     <span class="c">! Source Side outlet node number, water side</span>
<a name="ln-2225"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">LoadSideInletNode</span>        <span class="c">! Load Side inlet node number, water side</span>
<a name="ln-2226"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">LoadSideOutletNode</span>       <span class="c">! Load Side outlet node number, water side</span>
<a name="ln-2227"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReportingConstant</span>
<a name="ln-2228"></a>
<a name="ln-2229"></a>    <span class="n">LoadSideInletNode</span>    <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span>
<a name="ln-2230"></a>    <span class="n">LoadSideOutletNode</span>   <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletNodeNum</span>
<a name="ln-2231"></a>    <span class="n">SourceSideInletNode</span>  <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span>
<a name="ln-2232"></a>    <span class="n">SourceSideOutletNode</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span>
<a name="ln-2233"></a>
<a name="ln-2234"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-2235"></a>          <span class="c">!set node temperatures</span>
<a name="ln-2236"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2237"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2238"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Power</span>                <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2239"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Energy</span>               <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2240"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span>              <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2241"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoad</span>                <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2242"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSourceEnergy</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2243"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoadEnergy</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2244"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSidemdot</span>       <span class="o">=</span> <span class="n">SourceSideWaterMassFlowRate</span>
<a name="ln-2245"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSidemdot</span>         <span class="o">=</span> <span class="n">LoadSideWaterMassFlowRate</span>
<a name="ln-2246"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterInletTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2247"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterOutletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2248"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterInletTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2249"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterOutletTemp</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2250"></a>
<a name="ln-2251"></a>  <span class="k">ELSE</span>
<a name="ln-2252"></a>          <span class="c">!set node temperatures</span>
<a name="ln-2253"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>      <span class="o">=</span> <span class="n">LoadSideWaterOutletTemp</span>
<a name="ln-2254"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>    <span class="o">=</span> <span class="n">SourceSideWaterOutletTemp</span>
<a name="ln-2255"></a>
<a name="ln-2256"></a>      <span class="c">!set node flow rates;  for these load based models</span>
<a name="ln-2257"></a>          <span class="c">!assume that the sufficient Source Side flow rate available</span>
<a name="ln-2258"></a>
<a name="ln-2259"></a>    <span class="n">ReportingConstant</span> <span class="o">=</span> <span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-2260"></a>
<a name="ln-2261"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Power</span>       <span class="o">=</span> <span class="n">Power</span>
<a name="ln-2262"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span>     <span class="o">=</span> <span class="n">QSource</span>
<a name="ln-2263"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoad</span>       <span class="o">=</span> <span class="n">QLoad</span>
<a name="ln-2264"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Energy</span>      <span class="o">=</span> <span class="n">Power</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-2265"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSourceEnergy</span> <span class="o">=</span> <span class="n">QSource</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-2266"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoadEnergy</span>   <span class="o">=</span> <span class="n">QLoad</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-2267"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSidemdot</span>       <span class="o">=</span> <span class="n">SourceSideWaterMassFlowRate</span>
<a name="ln-2268"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSidemdot</span>         <span class="o">=</span> <span class="n">LoadSideWaterMassFlowRate</span>
<a name="ln-2269"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterInletTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2270"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideWaterOutletTemp</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2271"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterInletTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2272"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideWaterOutletTemp</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2273"></a>
<a name="ln-2274"></a>  <span class="k">END IF</span>
<a name="ln-2275"></a><span class="c">!    Node(SourceSideInletNode)%MassFlowRate = SourceSideWaterMassFlowRate</span>
<a name="ln-2276"></a><span class="c">!    Node(SourceSideOutletNode)%MassFlowRate = SourceSideWaterMassFlowRate</span>
<a name="ln-2277"></a><span class="c">!</span>
<a name="ln-2278"></a><span class="c">!    Node(LoadSideInletNode)%MassFlowRate = LoadSideWaterMassFlowRate</span>
<a name="ln-2279"></a><span class="c">!    Node(LoadSideOutletNode)%MassFlowRate = LoadSideWaterMassFlowRate</span>
<a name="ln-2280"></a><span class="c">!</span>
<a name="ln-2281"></a><span class="c">!    Node(SourceSideOutletNode)%MassFlowRateMaxAvail = Node(SourceSideInletNode)%MassFlowRateMaxAvail</span>
<a name="ln-2282"></a><span class="c">!    Node(SourceSideOutletNode)%MassFlowRateMinAvail = Node(SourceSideInletNode)%MassFlowRateMinAvail</span>
<a name="ln-2283"></a><span class="c">!    Node(LoadSideOutletNode)%MassFlowRateMaxAvail = Node(LoadSideInletNode)%MassFlowRateMaxAvail</span>
<a name="ln-2284"></a><span class="c">!    Node(LoadSideOutletNode)%MassFlowRateMinAvail = Node(LoadSideInletNode)%MassFlowRateMinAvail</span>
<a name="ln-2285"></a><span class="k">RETURN</span>
<a name="ln-2286"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateGSHPRecords</span>
<a name="ln-2287"></a>
<a name="ln-2288"></a><span class="k">END MODULE </span><span class="n">HeatPumpWaterToWaterCOOLING</span>
<a name="ln-2289"></a><span class="c">!************************************************************************************</span>
<a name="ln-2290"></a><span class="c">!</span>
<a name="ln-2291"></a><span class="c">!==================================== MODULE HeatPumpWaterToWaterSimple ======================</span>
<a name="ln-2292"></a><span class="c">!</span>
<a name="ln-2293"></a><span class="c">!************************************************************************************</span>
<a name="ln-2294"></a><span class="k">MODULE </span><span class="n">HeatPumpWaterToWaterSimple</span>
<a name="ln-2295"></a>
<a name="ln-2296"></a>  <span class="c">! MODULE INFORMATION:</span>
<a name="ln-2297"></a>  <span class="c">!       AUTHOR         Kenneth Tang</span>
<a name="ln-2298"></a>  <span class="c">!       DATE WRITTEN   March 2005</span>
<a name="ln-2299"></a>  <span class="c">!       MODIFIED       Brent Griffith, plant upgrades, fluid properties</span>
<a name="ln-2300"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2301"></a>
<a name="ln-2302"></a>  <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-2303"></a>  <span class="c">! This module simulates a Water-to-Water Heat Pump Simple (Equation-Fit Model)</span>
<a name="ln-2304"></a>
<a name="ln-2305"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2306"></a>  <span class="c">! This simulation is based on a set of coefficients generated from</span>
<a name="ln-2307"></a>  <span class="c">! the manufacturer catalog data using the generalized least square method</span>
<a name="ln-2308"></a>
<a name="ln-2309"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-2310"></a>  <span class="c">! (1) Tang,C.C.. 2005. Modeling Packaged Heat Pumps in a Quasi-Steady</span>
<a name="ln-2311"></a>  <span class="c">! State Energy Simulation Program. M.S. Thesis, Department of Mechanical and Aerospace Engineering,</span>
<a name="ln-2312"></a>  <span class="c">! Oklahoma State University. (downloadable from http://www.hvac.okstate.edu/)</span>
<a name="ln-2313"></a>  <span class="c">! (2) Murugappan, Arun. 2002. Implementing Ground Source Heat Pump and Ground</span>
<a name="ln-2314"></a>  <span class="c">! Loop Heat Exchanger Models in the EnergyPlus Simulation Environment,</span>
<a name="ln-2315"></a>  <span class="c">! M.S. Thesis, Department of Mechanical and Aerospace Engineering,</span>
<a name="ln-2316"></a>  <span class="c">! Oklahoma State University. (downloadable from http://www.hvac.okstate.edu/)</span>
<a name="ln-2317"></a>
<a name="ln-2318"></a>
<a name="ln-2319"></a>  <span class="c">! OTHER NOTES: none</span>
<a name="ln-2320"></a>
<a name="ln-2321"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-2322"></a>  <span class="c">! Use statements for data only modules</span>
<a name="ln-2323"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-2324"></a><span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MaxNameLength</span><span class="p">,</span> <span class="n">BeginSimFlag</span><span class="p">,</span><span class="n">InitconvTemp</span><span class="p">,</span><span class="n">BeginEnvrnFlag</span><span class="p">,</span> <span class="n">HourOfDay</span><span class="p">,</span> <span class="n">KelvinConv</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2325"></a>                              <span class="n">TimeStep</span><span class="p">,</span><span class="n">TimeStepZone</span><span class="p">,</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">WarmupFlag</span><span class="p">,</span><span class="n">SecInHour</span>
<a name="ln-2326"></a><span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="n">ShowContinueError</span><span class="p">,</span> <span class="n">SetupOutputVariable</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2327"></a>                              <span class="n">ShowContinueErrorTimeStamp</span><span class="p">,</span> <span class="n">ShowRecurringWarningErrorAtEnd</span>
<a name="ln-2328"></a><span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-2329"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-2330"></a>
<a name="ln-2331"></a>  <span class="c">! Use statements for access to subroutines in other modules</span>
<a name="ln-2332"></a>
<a name="ln-2333"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-2334"></a>
<a name="ln-2335"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-2336"></a>
<a name="ln-2337"></a>  <span class="c">! MODULE PARAMETER DEFINITIONS</span>
<a name="ln-2338"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HPEqFitHeating</span><span class="o">=</span><span class="s1">&#39;HeatPump:WatertoWater:EquationFit:Heating&#39;</span>
<a name="ln-2339"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HPEqFitHeatingUC</span><span class="o">=</span><span class="s1">&#39;HEATPUMP:WATERTOWATER:EQUATIONFIT:HEATING&#39;</span>
<a name="ln-2340"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HPEqFitCooling</span><span class="o">=</span><span class="s1">&#39;HeatPump:WatertoWater:EquationFit:Cooling&#39;</span>
<a name="ln-2341"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HPEqFitCoolingUC</span><span class="o">=</span><span class="s1">&#39;HEATPUMP:WATERTOWATER:EQUATIONFIT:COOLING&#39;</span>
<a name="ln-2342"></a>
<a name="ln-2343"></a>  <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2344"></a>
<a name="ln-2345"></a>  <span class="c">! Type Description of Heat Pump</span>
<a name="ln-2346"></a><span class="k">TYPE </span><span class="n">GshpSpecs</span>
<a name="ln-2347"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>               <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! user identifier</span>
<a name="ln-2348"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WatertoWaterHPType</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! Type of WatertoAirHP ie. Heating or Cooling</span>
<a name="ln-2349"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">WWHPPlantTypeOfNum</span>  <span class="o">=</span> <span class="mi">0</span>       <span class="c">! equipment type num</span>
<a name="ln-2350"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">Available</span>           <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! need an array of logicals--load identifiers of available equipment</span>
<a name="ln-2351"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">ON</span>                  <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! simulate the machine at it&#39;s operating part load ratio</span>
<a name="ln-2352"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">IsOn</span>                <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! flag that the heat pump is ON during current time step</span>
<a name="ln-2353"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">MustRun</span>             <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! flag that the heat pump is MUST RUN during current time step</span>
<a name="ln-2354"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SourceSideDesignMassFlow</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! Design flow rate (kg/s)</span>
<a name="ln-2355"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LoadSideDesignMassFlow</span>  <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! Design flow rate (kg/s)</span>
<a name="ln-2356"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RatedLoadVolFlowCool</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Rated Cooling Load Side Volumetric Flow Rate [m3/s]</span>
<a name="ln-2357"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RatedSourceVolFlowCool</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Rated Cooling Source Side Volumetric Flow Rate [m3/s]</span>
<a name="ln-2358"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RatedCapCool</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Rated Cooling Capacity [W]</span>
<a name="ln-2359"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RatedPowerCool</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Rated Cooling Power Consumption[W]</span>
<a name="ln-2360"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolCap1</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 1st coefficient of the Cooling capacity performance curve</span>
<a name="ln-2361"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolCap2</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 2nd coefficient of the Cooling capacity performance curve</span>
<a name="ln-2362"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolCap3</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 3rd coefficient of the Cooling capacity performance curve</span>
<a name="ln-2363"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolCap4</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 4th coefficient of the Cooling capacity performance curve</span>
<a name="ln-2364"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolCap5</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 5th coefficient of the Cooling capacity performance curve</span>
<a name="ln-2365"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolPower1</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 1st coefficient of the Cooling power consumption curve</span>
<a name="ln-2366"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolPower2</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 2nd coefficient of the Cooling power consumption curve</span>
<a name="ln-2367"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolPower3</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 3rd coefficient of the Cooling power consumption curve</span>
<a name="ln-2368"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolPower4</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 4th coefficient of the Cooling power consumption curve</span>
<a name="ln-2369"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolPower5</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 5th coefficient of the Cooling power consumption curve</span>
<a name="ln-2370"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoolCapNegativeCounter</span>  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Counter for number of times cooling capacity curve is &lt;= 0.0</span>
<a name="ln-2371"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoolCapNegativeIndex</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for recurring warning message regarding cooling capacity curve is &lt;= 0.0</span>
<a name="ln-2372"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoolPowerNegativeCounter</span>  <span class="o">=</span> <span class="mi">0</span> <span class="c">! Counter for number of times cooling power curve is &lt;= 0.0</span>
<a name="ln-2373"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoolPowerNegativeIndex</span>  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for recurring warning message regarding cooling power curve is &lt;= 0.0</span>
<a name="ln-2374"></a>
<a name="ln-2375"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RatedLoadVolFlowHeat</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Rated Heating Load Side Volumetric Flow Rate [m3/s]</span>
<a name="ln-2376"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RatedSourceVolFlowHeat</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Rated Heating Source Side Volumetric Flow Rate [m3/s]</span>
<a name="ln-2377"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RatedCapHeat</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Rated Heating Capacity [W]</span>
<a name="ln-2378"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RatedPowerHeat</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Rated Heating Compressor Power[W]</span>
<a name="ln-2379"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatCap1</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 1st coefficient of the Heating capacity performance curve</span>
<a name="ln-2380"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatCap2</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 2nd coefficient of the Heating capacity performance curve</span>
<a name="ln-2381"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatCap3</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 3rd coefficient of the Heating capacity performance curve</span>
<a name="ln-2382"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatCap4</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 4th coefficient of the Heating capacity performance curve</span>
<a name="ln-2383"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatCap5</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 5th coefficient of the Heating capacity performance curve</span>
<a name="ln-2384"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatPower1</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 1st coefficient of the Heating power consumption curve</span>
<a name="ln-2385"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatPower2</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 2nd coefficient of the Heating power consumption curve</span>
<a name="ln-2386"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatPower3</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 3rd coefficient of the Heating power consumption curve</span>
<a name="ln-2387"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatPower4</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 4th coefficient of the Heating power consumption curve</span>
<a name="ln-2388"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatPower5</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! 5th coefficient of the Heating power consumption curve</span>
<a name="ln-2389"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoadSideInletNodeNum</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Load Side Inlet Node</span>
<a name="ln-2390"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoadSideOutletNodeNum</span>   <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Load Side Outlet Node</span>
<a name="ln-2391"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SourceSideInletNodeNum</span>  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Source Side Inlet Node</span>
<a name="ln-2392"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SourceSideOutletNodeNum</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Source Side Outlet Node</span>
<a name="ln-2393"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatCapNegativeCounter</span>  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Counter for number of times heating capacity curve is &lt;= 0.0</span>
<a name="ln-2394"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatCapNegativeIndex</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for recurring warning message regarding heating capacity curve is &lt;= 0.0</span>
<a name="ln-2395"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatPowerNegativeCounter</span>  <span class="o">=</span> <span class="mi">0</span> <span class="c">! Counter for number of times heating power curve is &lt;= 0.0</span>
<a name="ln-2396"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatPowerNegativeIndex</span>  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for recurring warning message regarding heating power curve is &lt;= 0.0</span>
<a name="ln-2397"></a>  <span class="c">!loop topology variables</span>
<a name="ln-2398"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SourceLoopNum</span>           <span class="o">=</span> <span class="mi">0</span> <span class="c">! source side plant loop index number</span>
<a name="ln-2399"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SourceLoopSideNum</span>       <span class="o">=</span> <span class="mi">0</span> <span class="c">! source side plant loop side index</span>
<a name="ln-2400"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SourceBranchNum</span>         <span class="o">=</span> <span class="mi">0</span> <span class="c">! source side plant loop branch index</span>
<a name="ln-2401"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SourceCompNum</span>           <span class="o">=</span> <span class="mi">0</span> <span class="c">! source side plant loop component index</span>
<a name="ln-2402"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoadLoopNum</span>             <span class="o">=</span> <span class="mi">0</span> <span class="c">! load side plant loop index number</span>
<a name="ln-2403"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoadLoopSideNum</span>         <span class="o">=</span> <span class="mi">0</span> <span class="c">! load side plant loop side index</span>
<a name="ln-2404"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoadBranchNum</span>           <span class="o">=</span> <span class="mi">0</span> <span class="c">! load side plant loop branch index</span>
<a name="ln-2405"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoadCompNum</span>             <span class="o">=</span> <span class="mi">0</span> <span class="c">! load side plant loop component index</span>
<a name="ln-2406"></a><span class="k">END TYPE </span><span class="n">GshpSpecs</span>
<a name="ln-2407"></a>
<a name="ln-2408"></a>    <span class="c">! Output Variables Type definition</span>
<a name="ln-2409"></a><span class="k">TYPE </span><span class="n">ReportVars</span>
<a name="ln-2410"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Power</span>                   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Power Consumption [W]</span>
<a name="ln-2411"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Energy</span>                  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Energy Consumption [J]</span>
<a name="ln-2412"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QLoad</span>                   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Load Side Heat Transfer Rate [W]</span>
<a name="ln-2413"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QLoadEnergy</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Load Side Heat Transfer [J]</span>
<a name="ln-2414"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QSource</span>                 <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side Heat Transfer Rate [W]</span>
<a name="ln-2415"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QSourceEnergy</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side Heat Transfer [J]</span>
<a name="ln-2416"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LoadSideMassFlowRate</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Load side volumetric flow rate m3/s</span>
<a name="ln-2417"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LoadSideInletTemp</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Load Side outlet temperature °C</span>
<a name="ln-2418"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LoadSideOutletTemp</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Load Side outlet temperature °C</span>
<a name="ln-2419"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SourceSideMassFlowRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source side volumetric flow rate m3/s</span>
<a name="ln-2420"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SourceSideInletTemp</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side outlet temperature °C</span>
<a name="ln-2421"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SourceSideOutletTemp</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source Side outlet temperature °C</span>
<a name="ln-2422"></a><span class="k">END TYPE </span><span class="n">ReportVars</span>
<a name="ln-2423"></a>
<a name="ln-2424"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">GSHPSpecs</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>  <span class="kd">::</span><span class="n">GSHP</span>
<a name="ln-2425"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">ReportVars</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">GSHPReport</span>
<a name="ln-2426"></a>
<a name="ln-2427"></a>  <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-2428"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumGSHPs</span>                      <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Number of GSHPs specified in input</span>
<a name="ln-2429"></a>
<a name="ln-2430"></a>  <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE</span>
<a name="ln-2431"></a>
<a name="ln-2432"></a>          <span class="c">! Driver/Manager Routines</span>
<a name="ln-2433"></a><span class="k">PUBLIC </span><span class="n">SimHPWatertoWaterSimple</span>
<a name="ln-2434"></a>
<a name="ln-2435"></a>          <span class="c">! Get Input routines for module</span>
<a name="ln-2436"></a><span class="k">PRIVATE </span><span class="n">GetWatertoWaterHPInput</span>
<a name="ln-2437"></a>
<a name="ln-2438"></a>          <span class="c">! Initialization routines for module</span>
<a name="ln-2439"></a><span class="k">PRIVATE </span><span class="n">InitWatertoWaterHP</span>
<a name="ln-2440"></a>
<a name="ln-2441"></a>          <span class="c">! Computational routines</span>
<a name="ln-2442"></a><span class="k">PRIVATE </span><span class="n">CalcWatertoWaterHPCooling</span>
<a name="ln-2443"></a><span class="k">PRIVATE </span><span class="n">CalcWatertoWaterHPHeating</span>
<a name="ln-2444"></a>
<a name="ln-2445"></a>          <span class="c">! Update routine to check convergence and update nodes</span>
<a name="ln-2446"></a><span class="k">PRIVATE </span><span class="n">UpdateGSHPRecords</span>
<a name="ln-2447"></a>
<a name="ln-2448"></a>          <span class="c">! Other routines</span>
<a name="ln-2449"></a>
<a name="ln-2450"></a><span class="k">CONTAINS</span>
<a name="ln-2451"></a>
<a name="ln-2452"></a>         <span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-2453"></a>
<a name="ln-2454"></a><span class="k">SUBROUTINE </span><span class="n">SimHPWatertoWaterSimple</span><span class="p">(</span><span class="n">GSHPType</span><span class="p">,</span> <span class="n">GSHPTypeNum</span><span class="p">,</span> <span class="n">GSHPName</span><span class="p">,</span> <span class="n">GSHPNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2455"></a>                                    <span class="n">InitLoopEquip</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">,</span> <span class="n">MaxCap</span><span class="p">,</span> <span class="n">MinCap</span><span class="p">,</span> <span class="n">OptCap</span><span class="p">,</span> <span class="n">LoopNum</span><span class="p">)</span>
<a name="ln-2456"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2457"></a>          <span class="c">!       AUTHOR         Kenneth Tang</span>
<a name="ln-2458"></a>          <span class="c">!       DATE WRITTEN   March 2005</span>
<a name="ln-2459"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-2460"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2461"></a>
<a name="ln-2462"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2463"></a>          <span class="c">! This subroutine manages Water-to-Water Heat Pump Simple (Equation-Fit Model)</span>
<a name="ln-2464"></a>
<a name="ln-2465"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2466"></a>
<a name="ln-2467"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2468"></a>
<a name="ln-2469"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2470"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-2471"></a>   <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span><span class="n">UpdateChillerComponentCondenserSide</span>
<a name="ln-2472"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span>
<a name="ln-2473"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-2474"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">TypeOf_HPWaterEFCooling</span><span class="p">,</span> <span class="n">TypeOf_HPWaterEFHeating</span>
<a name="ln-2475"></a>
<a name="ln-2476"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-2477"></a>
<a name="ln-2478"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2479"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">GSHPType</span>         <span class="c">! Type of GSHP</span>
<a name="ln-2480"></a>  <span class="kt">INTEGER</span>         <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">GSHPTypeNum</span>      <span class="c">! Type of GSHP in Plant equipment</span>
<a name="ln-2481"></a>  <span class="kt">INTEGER</span>         <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LoopNum</span>          <span class="c">! The calling loop number</span>
<a name="ln-2482"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">GSHPName</span>         <span class="c">! User Specified Name of GSHP</span>
<a name="ln-2483"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">GSHPNum</span>          <span class="c">! Index of Equipment</span>
<a name="ln-2484"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-2485"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">InitLoopEquip</span>    <span class="c">! If not zero, calculate the max load for operating conditions</span>
<a name="ln-2486"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">MyLoad</span>           <span class="c">! Loop demand component will meet</span>
<a name="ln-2487"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">MinCap</span>           <span class="c">! Minimum operating capacity of GSHP [W]</span>
<a name="ln-2488"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">MaxCap</span>           <span class="c">! Maximum operating capacity of GSHP [W]</span>
<a name="ln-2489"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">OptCap</span>           <span class="c">! Optimal operating capacity of GSHP [W]</span>
<a name="ln-2490"></a>
<a name="ln-2491"></a>
<a name="ln-2492"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2493"></a>          <span class="c">! na</span>
<a name="ln-2494"></a>
<a name="ln-2495"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2496"></a>          <span class="c">! na</span>
<a name="ln-2497"></a>
<a name="ln-2498"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2499"></a>          <span class="c">! na</span>
<a name="ln-2500"></a>
<a name="ln-2501"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2502"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>     <span class="kd">::</span> <span class="n">GetInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>    <span class="c">! then TRUE, calls subroutine to read input file.</span>
<a name="ln-2503"></a>
<a name="ln-2504"></a>  <span class="c">!Get input from IDF</span>
<a name="ln-2505"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2506"></a><span class="k">    CALL </span><span class="n">GetWatertoWaterHPInput</span>
<a name="ln-2507"></a>    <span class="n">GetInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2508"></a>  <span class="k">END IF</span>
<a name="ln-2509"></a>
<a name="ln-2510"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2511"></a><span class="k">     </span><span class="n">GSHPNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span> <span class="n">GSHPName</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">NumGSHPs</span> <span class="p">)</span>
<a name="ln-2512"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">GSHPNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! if 0, fall through to next</span>
<a name="ln-2513"></a>       <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">GSHPTypeNum</span><span class="p">)</span>
<a name="ln-2514"></a>       <span class="k">CASE</span> <span class="p">(</span><span class="n">TypeOf_HPWaterEFCooling</span><span class="p">)</span>
<a name="ln-2515"></a>            <span class="n">MinCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2516"></a>            <span class="n">MaxCap</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedCapCool</span>
<a name="ln-2517"></a>            <span class="n">OptCap</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedCapCool</span>
<a name="ln-2518"></a>       <span class="k">CASE</span> <span class="p">(</span><span class="n">TypeOf_HPWaterEFHeating</span><span class="p">)</span>
<a name="ln-2519"></a>            <span class="n">MinCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2520"></a>            <span class="n">MaxCap</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span>
<a name="ln-2521"></a>            <span class="n">OptCap</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span>
<a name="ln-2522"></a>       <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2523"></a>            <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimHPWatertoWaterSimple: Module called with incorrect GSHPType=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHPTYpe</span><span class="p">))</span>
<a name="ln-2524"></a>       <span class="k">END SELECT</span>
<a name="ln-2525"></a><span class="k">       Return</span>
<a name="ln-2526"></a><span class="k">     </span><span class="n">ENDIF</span>
<a name="ln-2527"></a>  <span class="k">END IF</span>
<a name="ln-2528"></a>
<a name="ln-2529"></a>  <span class="c">! Calculate Demand on heat pump</span>
<a name="ln-2530"></a>  <span class="n">TypeOfEquip</span><span class="p">:</span> <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">GSHPTypeNum</span><span class="p">)</span>
<a name="ln-2531"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">TypeOf_HPWaterEFCooling</span><span class="p">)</span>
<a name="ln-2532"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">GSHPNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2533"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">LoopNum</span> <span class="o">==</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! chilled water loop</span>
<a name="ln-2534"></a>
<a name="ln-2535"></a>          <span class="k">CALL </span><span class="n">InitWatertoWaterHP</span><span class="p">(</span><span class="n">GSHPTypeNum</span><span class="p">,</span> <span class="n">GSHPName</span><span class="p">,</span> <span class="n">GSHPNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-2536"></a>          <span class="k">CALL </span><span class="n">CalcWatertoWaterHPCooling</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-2537"></a>          <span class="k">CALL </span><span class="n">UpdateGshpRecords</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span>
<a name="ln-2538"></a>
<a name="ln-2539"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">LoopNum</span> <span class="o">==</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! condenser loop</span>
<a name="ln-2540"></a>          <span class="k">CALL </span><span class="n">UpdateChillerComponentCondenserSide</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2541"></a>                                     <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-2542"></a>                                     <span class="n">TypeOf_HPWaterEFCooling</span><span class="p">,</span>                     <span class="p">&amp;</span>
<a name="ln-2543"></a>                                     <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2544"></a>                                     <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2545"></a>                                     <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-2546"></a>                                     <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletTemp</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-2547"></a>                                     <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletTemp</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2548"></a>                                     <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideMassFlowRate</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-2549"></a>                                     <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-2550"></a>        <span class="k">ELSE</span>
<a name="ln-2551"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span> <span class="p">(</span><span class="s1">&#39;SimHPWatertoWaterSimple:: Invalid loop connection &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2552"></a>             <span class="n">HPEqFitCooling</span><span class="o">//</span><span class="s1">&#39;, Requested Unit=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">))</span>
<a name="ln-2553"></a>        <span class="n">ENDIF</span>
<a name="ln-2554"></a>      <span class="k">ELSE</span>
<a name="ln-2555"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span> <span class="p">(</span><span class="s1">&#39;SimHPWatertoWaterSimple:: Invalid &#39;</span><span class="o">//</span><span class="n">HPEqFitCooling</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2556"></a>           <span class="s1">&#39;, Requested Unit=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">))</span>
<a name="ln-2557"></a>      <span class="n">ENDIF</span>
<a name="ln-2558"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">TypeOf_HPWaterEFHeating</span><span class="p">)</span>
<a name="ln-2559"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">GSHPNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2560"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">LoopNum</span> <span class="o">==</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! chilled water loop</span>
<a name="ln-2561"></a>
<a name="ln-2562"></a>          <span class="k">CALL </span><span class="n">InitWatertoWaterHP</span><span class="p">(</span><span class="n">GSHPTypeNum</span><span class="p">,</span> <span class="n">GSHPName</span><span class="p">,</span> <span class="n">GSHPNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-2563"></a>          <span class="k">CALL </span><span class="n">CalcWatertoWaterHPHeating</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-2564"></a>          <span class="k">CALL </span><span class="n">UpdateGshpRecords</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span>
<a name="ln-2565"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">LoopNum</span> <span class="o">==</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! condenser loop</span>
<a name="ln-2566"></a>          <span class="k">CALL </span><span class="n">UpdateChillerComponentCondenserSide</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2567"></a>                                     <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-2568"></a>                                     <span class="n">TypeOf_HPWaterEFHeating</span><span class="p">,</span>                     <span class="p">&amp;</span>
<a name="ln-2569"></a>                                     <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2570"></a>                                     <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2571"></a>                                     <span class="o">-</span> <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-2572"></a>                                     <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletTemp</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-2573"></a>                                     <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletTemp</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2574"></a>                                     <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideMassFlowRate</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-2575"></a>                                     <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-2576"></a>        <span class="k">ELSE</span>
<a name="ln-2577"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span> <span class="p">(</span><span class="s1">&#39;SimHPWatertoWaterSimple:: Invalid loop connection &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2578"></a>             <span class="n">HPEqFitCooling</span><span class="o">//</span><span class="s1">&#39;, Requested Unit=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">))</span>
<a name="ln-2579"></a>        <span class="n">ENDIF</span>
<a name="ln-2580"></a>      <span class="k">ELSE</span>
<a name="ln-2581"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span> <span class="p">(</span><span class="s1">&#39;SimHPWatertoWaterSimple:: Invalid &#39;</span><span class="o">//</span><span class="n">HPEqFitHeating</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2582"></a>           <span class="s1">&#39;, Requested Unit=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHPName</span><span class="p">))</span>
<a name="ln-2583"></a>      <span class="n">ENDIF</span>
<a name="ln-2584"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2585"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimHPWatertoWaterSimple: Module called with incorrect GSHPType=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHPTYpe</span><span class="p">))</span>
<a name="ln-2586"></a>    <span class="k">END SELECT </span><span class="n">TypeOfEquip</span>
<a name="ln-2587"></a>
<a name="ln-2588"></a>
<a name="ln-2589"></a><span class="k">RETURN</span>
<a name="ln-2590"></a><span class="k">END SUBROUTINE </span><span class="n">SimHPWatertoWaterSimple</span>
<a name="ln-2591"></a>
<a name="ln-2592"></a><span class="k">SUBROUTINE </span><span class="n">GetWatertoWaterHPInput</span>
<a name="ln-2593"></a>
<a name="ln-2594"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2595"></a>          <span class="c">!       AUTHOR         Kenneth Tang</span>
<a name="ln-2596"></a>          <span class="c">!       DATE WRITTEN   March 2005</span>
<a name="ln-2597"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-2598"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2599"></a>
<a name="ln-2600"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2601"></a>          <span class="c">! Obtain input from IDF and store them in data structures</span>
<a name="ln-2602"></a>
<a name="ln-2603"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2604"></a>
<a name="ln-2605"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2606"></a>
<a name="ln-2607"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2608"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>        <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-2609"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span>      <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-2610"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-2611"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>        <span class="n">ONLY</span> <span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-2612"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">TypeOf_HPWaterEFCooling</span><span class="p">,</span> <span class="n">TypeOf_HPWaterEFHeating</span><span class="p">,</span><span class="n">ScanPlantLoopsForObject</span>
<a name="ln-2613"></a>
<a name="ln-2614"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2615"></a>
<a name="ln-2616"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2617"></a>          <span class="c">! na</span>
<a name="ln-2618"></a>
<a name="ln-2619"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2620"></a>          <span class="c">! na</span>
<a name="ln-2621"></a>
<a name="ln-2622"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2623"></a>          <span class="c">! na</span>
<a name="ln-2624"></a>
<a name="ln-2625"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2626"></a>          <span class="c">! na</span>
<a name="ln-2627"></a>
<a name="ln-2628"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2629"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">GSHPNum</span>                   <span class="c">! GSHP number</span>
<a name="ln-2630"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">HPNum</span>                     <span class="c">! Counter</span>
<a name="ln-2631"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumCoolCoil</span>               <span class="c">! Number of Cooling Coils</span>
<a name="ln-2632"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumHeatCoil</span>               <span class="c">! Number of Heating Coils</span>
<a name="ln-2633"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumAlphas</span>                 <span class="c">! Number of elements in the alpha array</span>
<a name="ln-2634"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumNums</span>                   <span class="c">! Number of elements in the numeric array</span>
<a name="ln-2635"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">IOStat</span>                    <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-2636"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">AlphArray</span> <span class="c">! character string data</span>
<a name="ln-2637"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>                   <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NumArray</span>  <span class="c">! numeric data</span>
<a name="ln-2638"></a>
<a name="ln-2639"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2640"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsNotOk</span>          <span class="c">! Flag to verify name</span>
<a name="ln-2641"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsBlank</span>          <span class="c">! Flag for blank name</span>
<a name="ln-2642"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-2643"></a>
<a name="ln-2644"></a>  <span class="n">NumCoolCoil</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">HPEqFitCoolingUC</span><span class="p">)</span>
<a name="ln-2645"></a>  <span class="n">NumHeatCoil</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">HPEqFitHeatingUC</span><span class="p">)</span>
<a name="ln-2646"></a>  <span class="n">NumGSHPs</span> <span class="o">=</span> <span class="n">NumCoolCoil</span> <span class="o">+</span> <span class="n">NumHeatCoil</span>
<a name="ln-2647"></a>
<a name="ln-2648"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">NumGSHPs</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2649"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetEquationFitWaterToWater Input: No Equipment found&#39;</span><span class="p">)</span>
<a name="ln-2650"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2651"></a>  <span class="k">END IF</span>
<a name="ln-2652"></a>
<a name="ln-2653"></a><span class="k">  IF</span><span class="p">(</span><span class="n">NumGSHPs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2654"></a><span class="k">    ALLOCATE</span> <span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">NumGSHPs</span><span class="p">))</span>
<a name="ln-2655"></a>    <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">GSHPReport</span><span class="p">(</span><span class="n">NumGSHPs</span><span class="p">))</span>
<a name="ln-2656"></a>    <span class="c">! initialize the data structures</span>
<a name="ln-2657"></a>  <span class="k">END IF</span>
<a name="ln-2658"></a>
<a name="ln-2659"></a>  <span class="c">!Load data structure for cooling coil</span>
<a name="ln-2660"></a>  <span class="k">DO </span><span class="n">HPNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCoolCoil</span>
<a name="ln-2661"></a>
<a name="ln-2662"></a>        <span class="n">GSHPNum</span> <span class="o">=</span> <span class="n">HPNum</span>
<a name="ln-2663"></a>
<a name="ln-2664"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">HPEqFitCoolingUC</span><span class="p">,</span><span class="n">HPNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2665"></a>                   <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">)</span>
<a name="ln-2666"></a>        <span class="n">IsNotOk</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2667"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2668"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">GSHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">HPNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ISNotOK</span><span class="p">,</span><span class="n">ISBlank</span><span class="p">,</span><span class="s1">&#39;GHSP Name&#39;</span><span class="p">)</span>
<a name="ln-2669"></a>
<a name="ln-2670"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ISNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2671"></a><span class="k">            </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2672"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ISBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-2673"></a>        <span class="k">END IF</span>
<a name="ln-2674"></a><span class="k">        </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">WWHPPlantTypeOfNum</span>    <span class="o">=</span> <span class="n">TypeOf_HPWaterEFCooling</span>
<a name="ln-2675"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span>                  <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2676"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedLoadVolFlowCool</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2677"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedSourceVolFlowCool</span><span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2678"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedCapCool</span>          <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2679"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedPowerCool</span>        <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-2680"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolCap1</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-2681"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolCap2</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-2682"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolCap3</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-2683"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolCap4</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2684"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolCap5</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-2685"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolPower1</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-2686"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolPower2</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-2687"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolPower3</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-2688"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolPower4</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-2689"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolPower5</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-2690"></a>
<a name="ln-2691"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span>   <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-2692"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">HPEqFitCoolingUC</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2693"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2694"></a>
<a name="ln-2695"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2696"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">HPEqFitCoolingUC</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2697"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2698"></a>
<a name="ln-2699"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span>    <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-2700"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">HPEqFitCoolingUC</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2701"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2702"></a>
<a name="ln-2703"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletNodeNum</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2704"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">HPEqFitCoolingUC</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2705"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2706"></a>
<a name="ln-2707"></a>        <span class="c">! Test node sets</span>
<a name="ln-2708"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">HPEqFitCoolingUC</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Condenser Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-2709"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">HPEqFitCoolingUC</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;Hot Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-2710"></a>
<a name="ln-2711"></a>        <span class="c">! save the design source side flow rate for use by plant loop sizing algorithms</span>
<a name="ln-2712"></a>        <span class="k">CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedSourceVolFlowCool</span><span class="p">)</span>
<a name="ln-2713"></a>
<a name="ln-2714"></a>        <span class="c">! CurrentModuleObject=&#39;HeatPump:WatertoWater:EquationFit:Cooling&#39;</span>
<a name="ln-2715"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2716"></a>             <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Energy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2717"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2718"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Load Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2719"></a>             <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoadEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2720"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Source Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2721"></a>             <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSourceEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2722"></a>  <span class="k">END DO</span>
<a name="ln-2723"></a>
<a name="ln-2724"></a>  <span class="c">!Load data structure for heating coil</span>
<a name="ln-2725"></a>  <span class="k">DO </span><span class="n">HPNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumHeatCoil</span>
<a name="ln-2726"></a>
<a name="ln-2727"></a>        <span class="n">GSHPNum</span> <span class="o">=</span> <span class="n">NumCoolCoil</span> <span class="o">+</span> <span class="n">HPNum</span>
<a name="ln-2728"></a>
<a name="ln-2729"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">HPEqFitHeatingUC</span><span class="p">,</span><span class="n">HPNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2730"></a>                   <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">)</span>
<a name="ln-2731"></a>        <span class="n">IsNotOk</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2732"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2733"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">GSHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">HPNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ISNotOK</span><span class="p">,</span><span class="n">ISBlank</span><span class="p">,</span><span class="s1">&#39;GHSP Name&#39;</span><span class="p">)</span>
<a name="ln-2734"></a>
<a name="ln-2735"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ISNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2736"></a><span class="k">            </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2737"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ISBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-2738"></a>        <span class="k">END IF</span>
<a name="ln-2739"></a><span class="k">        </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">WWHPPlantTypeOfNum</span>    <span class="o">=</span> <span class="n">TypeOf_HPWaterEFHeating</span>
<a name="ln-2740"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span>                  <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2741"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedLoadVolFlowHeat</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2742"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedSourceVolFlowHeat</span><span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2743"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span>          <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2744"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedPowerHeat</span>        <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-2745"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatCap1</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-2746"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatCap2</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-2747"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatCap3</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-2748"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatCap4</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2749"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatCap5</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-2750"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatPower1</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-2751"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatPower2</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-2752"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatPower3</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-2753"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatPower4</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-2754"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatPower5</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-2755"></a>
<a name="ln-2756"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span>   <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-2757"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">HPEqFitHeatingUC</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2758"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2759"></a>
<a name="ln-2760"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2761"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">HPEqFitHeatingUC</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2762"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2763"></a>
<a name="ln-2764"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span>    <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-2765"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">HPEqFitHeatingUC</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2766"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2767"></a>
<a name="ln-2768"></a>        <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletNodeNum</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2769"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">HPEqFitHeatingUC</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2770"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2771"></a>
<a name="ln-2772"></a>        <span class="c">! Test node sets</span>
<a name="ln-2773"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">HPEqFitHeatingUC</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Condenser Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-2774"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">HPEqFitHeatingUC</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s1">&#39;Hot Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-2775"></a>
<a name="ln-2776"></a>        <span class="c">! save the design source side flow rate for use by plant loop sizing algorithms</span>
<a name="ln-2777"></a>        <span class="k">CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedSourceVolFlowHeat</span><span class="p">)</span>
<a name="ln-2778"></a>
<a name="ln-2779"></a>        <span class="c">! CurrentModuleObject=&#39;HeatPump:WatertoWater:EquationFit:Heating&#39;</span>
<a name="ln-2780"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2781"></a>             <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Energy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2782"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Heating&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2783"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Load Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2784"></a>             <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoadEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2785"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Source Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2786"></a>             <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSourceEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2787"></a>  <span class="k">END DO</span>
<a name="ln-2788"></a>
<a name="ln-2789"></a><span class="k">  DO </span><span class="n">GSHPNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumGSHPs</span>
<a name="ln-2790"></a>    <span class="c">!setup output variables</span>
<a name="ln-2791"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2792"></a>        <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Power</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2793"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Load Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2794"></a>        <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoad</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2795"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Source Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2796"></a>        <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2797"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Load Side Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2798"></a>        <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2799"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Load Side Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2800"></a>        <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2801"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Source Side Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2802"></a>        <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2803"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Source Side Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2804"></a>        <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2805"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Load Side Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2806"></a>        <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2807"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water to Water Heat Pump Source Side Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2808"></a>        <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2809"></a>
<a name="ln-2810"></a>    <span class="c">!scan for loop connection data</span>
<a name="ln-2811"></a>   <span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2812"></a>    <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2813"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">WWHPPlantTypeOfNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2814"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2815"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2816"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2817"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceCompNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2818"></a>                                 <span class="n">inletNodeNumber</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2819"></a>                                 <span class="n">errflag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-2820"></a>    <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2821"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">WWHPPlantTypeOfNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2822"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2823"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2824"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2825"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadCompNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2826"></a>                                 <span class="n">inletNodeNumber</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2827"></a>                                 <span class="n">errflag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-2828"></a>
<a name="ln-2829"></a>
<a name="ln-2830"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2831"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;GetWatertoWaterHPInput: Program terminated on scan for loop data&#39;</span><span class="p">)</span>
<a name="ln-2832"></a>    <span class="n">ENDIF</span>
<a name="ln-2833"></a>
<a name="ln-2834"></a>  <span class="k">END DO</span>
<a name="ln-2835"></a>
<a name="ln-2836"></a>
<a name="ln-2837"></a><span class="k">RETURN</span>
<a name="ln-2838"></a><span class="k">END SUBROUTINE </span><span class="n">GetWatertoWaterHPInput</span>
<a name="ln-2839"></a>
<a name="ln-2840"></a>
<a name="ln-2841"></a><span class="k">SUBROUTINE </span><span class="n">InitWatertoWaterHP</span><span class="p">(</span><span class="n">GSHPTypeNum</span><span class="p">,</span> <span class="n">GSHPName</span><span class="p">,</span> <span class="n">GSHPNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-2842"></a>
<a name="ln-2843"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2844"></a>          <span class="c">!       AUTHOR         Kenneth Tang</span>
<a name="ln-2845"></a>          <span class="c">!       DATE WRITTEN   March 2005</span>
<a name="ln-2846"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-2847"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-2848"></a>
<a name="ln-2849"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2850"></a>          <span class="c">! This subroutine is for initializations of the Water-to-Water HP Simple</span>
<a name="ln-2851"></a>
<a name="ln-2852"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2853"></a>          <span class="c">! Uses the status flags to trigger initializations.</span>
<a name="ln-2854"></a>
<a name="ln-2855"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2856"></a>          <span class="c">! (1) Tang,C.C.. 2005. Modeling Packaged Heat Pumps in a Quasi-Steady</span>
<a name="ln-2857"></a>          <span class="c">! State Energy Simulation Program. M.S. Thesis, Department of Mechanical and Aerospace Engineering,</span>
<a name="ln-2858"></a>          <span class="c">! Oklahoma State University. (downloadable from http://www.hvac.okstate.edu/)</span>
<a name="ln-2859"></a>          <span class="c">! (2) Murugappan, Arun. 2002. Implementing Ground Source Heat Pump and Ground</span>
<a name="ln-2860"></a>          <span class="c">! Loop Heat Exchanger Models in the EnergyPlus Simulation Environment,</span>
<a name="ln-2861"></a>          <span class="c">! M.S. Thesis, Department of Mechanical and Aerospace Engineering,</span>
<a name="ln-2862"></a>          <span class="c">! Oklahoma State University. (downloadable from http://www.hvac.okstate.edu/)</span>
<a name="ln-2863"></a>
<a name="ln-2864"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2865"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>   <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TimeStepSys</span><span class="p">,</span><span class="n">SysTimeElapsed</span>
<a name="ln-2866"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>         <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TypeOf_HPWaterEFCooling</span><span class="p">,</span> <span class="n">TypeOf_HPWaterEFHeating</span><span class="p">,</span> <span class="n">PlantLoop</span>
<a name="ln-2867"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>    <span class="n">ONLY</span> <span class="p">:</span> <span class="n">SameString</span>
<a name="ln-2868"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetDensityGlycol</span>
<a name="ln-2869"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>    <span class="n">ONLY</span> <span class="p">:</span> <span class="n">InitComponentNodes</span><span class="p">,</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-2870"></a>
<a name="ln-2871"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-2872"></a>
<a name="ln-2873"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2874"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">GSHPTypeNum</span>  <span class="c">! Type of GSHP</span>
<a name="ln-2875"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GSHPName</span>  <span class="c">! User Specified Name of GSHP</span>
<a name="ln-2876"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">GSHPNum</span>   <span class="c">! GSHP Number</span>
<a name="ln-2877"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-2878"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">MyLoad</span>    <span class="c">! Demand Load</span>
<a name="ln-2879"></a>
<a name="ln-2880"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2881"></a>          <span class="c">! na</span>
<a name="ln-2882"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2883"></a>          <span class="c">! na</span>
<a name="ln-2884"></a>
<a name="ln-2885"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2886"></a>          <span class="c">! na</span>
<a name="ln-2887"></a>
<a name="ln-2888"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2889"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">LoadSideInletNode</span>       <span class="c">! Load Side Inlet Node</span>
<a name="ln-2890"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">LoadSideOutletNode</span>      <span class="c">! Load Side Outlet Node</span>
<a name="ln-2891"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">SourceSideInletNode</span>     <span class="c">! Source Side Inlet Node</span>
<a name="ln-2892"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">SourceSideOutletNode</span>    <span class="c">! Source Side Outlet Node</span>
<a name="ln-2893"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>  <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>     <span class="kd">::</span> <span class="n">MyEnvrnFlag</span>   <span class="c">! Flag required to keep track of initialization</span>
<a name="ln-2894"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>          <span class="kd">::</span> <span class="n">OneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>    <span class="c">! One Time Flag</span>
<a name="ln-2895"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">CurrentSimTime</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Current Simulation Time</span>
<a name="ln-2896"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">PrevSimTime</span> <span class="o">=</span> <span class="mf">0.0d0</span>       <span class="c">! Previous Simulation Time</span>
<a name="ln-2897"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>  <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>  <span class="kd">::</span> <span class="n">MyPlanScanFlag</span>
<a name="ln-2898"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>                            <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2899"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopNum</span>
<a name="ln-2900"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopSideNum</span>
<a name="ln-2901"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span> <span class="c">! local fluid density</span>
<a name="ln-2902"></a>
<a name="ln-2903"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2904"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">MyPlanScanFlag</span><span class="p">(</span><span class="n">NumGSHPs</span><span class="p">))</span>
<a name="ln-2905"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumGSHPs</span><span class="p">))</span>
<a name="ln-2906"></a>    <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2907"></a>    <span class="n">MyEnvrnFlag</span>  <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2908"></a>    <span class="n">MyPlanScanFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2909"></a>  <span class="k">END IF</span>
<a name="ln-2910"></a>
<a name="ln-2911"></a>
<a name="ln-2912"></a>
<a name="ln-2913"></a>
<a name="ln-2914"></a><span class="k">  </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! Reset MustRun flag to TRUE</span>
<a name="ln-2915"></a>  <span class="n">LoadSideInletNode</span>    <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span>
<a name="ln-2916"></a>  <span class="n">LoadSideOutletNode</span>   <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletNodeNum</span>
<a name="ln-2917"></a>  <span class="n">SourceSideInletNode</span>  <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span>
<a name="ln-2918"></a>  <span class="n">SourceSideOutletNode</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span>
<a name="ln-2919"></a>
<a name="ln-2920"></a>
<a name="ln-2921"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2922"></a>    <span class="c">!Initialize all report variables to a known state at beginning of simulation</span>
<a name="ln-2923"></a>
<a name="ln-2924"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Power</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2925"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Energy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2926"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2927"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoadEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2928"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2929"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSourceEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2930"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2931"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2932"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2933"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2934"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2935"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2936"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">IsOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2937"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2938"></a>
<a name="ln-2939"></a>
<a name="ln-2940"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">WWHPPlantTypeOfNum</span>  <span class="o">==</span> <span class="n">TypeOf_HPWaterEFHeating</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2941"></a><span class="k">      </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2942"></a>                           <span class="n">InitconvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2943"></a>                           <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2944"></a>                           <span class="s1">&#39;InitGshp&#39;</span><span class="p">)</span>
<a name="ln-2945"></a>      <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideDesignMassFlow</span>   <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedLoadVolFlowHeat</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-2946"></a>      <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2947"></a>                           <span class="n">InitconvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2948"></a>                           <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2949"></a>                           <span class="s1">&#39;InitGshp&#39;</span><span class="p">)</span>
<a name="ln-2950"></a>      <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideDesignMassFlow</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedSourceVolFlowHeat</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-2951"></a>    <span class="n">ELSEIF</span>  <span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">WWHPPlantTypeOfNum</span>  <span class="o">==</span> <span class="n">TypeOf_HPWaterEFCooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2952"></a><span class="k">      </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2953"></a>                           <span class="n">InitconvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2954"></a>                           <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2955"></a>                           <span class="s1">&#39;InitGshp&#39;</span><span class="p">)</span>
<a name="ln-2956"></a>      <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideDesignMassFlow</span>   <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedLoadVolFlowCool</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-2957"></a>      <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2958"></a>                           <span class="n">InitconvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2959"></a>                           <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2960"></a>                           <span class="s1">&#39;InitGshp&#39;</span><span class="p">)</span>
<a name="ln-2961"></a>      <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideDesignMassFlow</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedSourceVolFlowCool</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-2962"></a>    <span class="n">ENDIF</span>
<a name="ln-2963"></a>
<a name="ln-2964"></a>    <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideDesignMassFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2965"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2966"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2967"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2968"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2969"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2970"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadCompNum</span><span class="p">)</span>
<a name="ln-2971"></a>
<a name="ln-2972"></a>    <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span> <span class="mf">0.d0</span><span class="p">,</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideDesignMassFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2973"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2974"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2975"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2976"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2977"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2978"></a>                                 <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceCompNum</span><span class="p">)</span>
<a name="ln-2979"></a>
<a name="ln-2980"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPoint</span> <span class="o">==</span> <span class="n">SensedNodeFlagValue</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2981"></a>                            <span class="n">Node</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPoint</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2982"></a>     <span class="n">Node</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>  <span class="p">&amp;</span>
<a name="ln-2983"></a>                <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPoint</span><span class="o">+</span><span class="mi">30</span>
<a name="ln-2984"></a>
<a name="ln-2985"></a>     <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2986"></a>  <span class="k">END IF</span>
<a name="ln-2987"></a><span class="c">! Reset the environment flag</span>
<a name="ln-2988"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2989"></a>
<a name="ln-2990"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">PrevSimTime</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">CurrentSimTime</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2991"></a><span class="k">     </span><span class="n">PrevSimTime</span> <span class="o">=</span> <span class="n">CurrentSimTime</span>
<a name="ln-2992"></a>  <span class="k">END IF</span>
<a name="ln-2993"></a>
<a name="ln-2994"></a>  <span class="c">! Calculate the simulation time</span>
<a name="ln-2995"></a>  <span class="n">CurrentSimTime</span> <span class="o">=</span> <span class="p">(</span><span class="n">DayOfSim</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">24</span> <span class="o">+</span> <span class="p">(</span><span class="n">HourOfDay</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">TimeStep</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">TimeStepZone</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-2996"></a>
<a name="ln-2997"></a>  <span class="c">! Initialize event time array when the environment simulation begins</span>
<a name="ln-2998"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">CurrentSimTime</span> <span class="o">==</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">OneTimeFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2999"></a><span class="k">    </span><span class="n">OneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3000"></a>  <span class="k">END IF</span>
<a name="ln-3001"></a>
<a name="ln-3002"></a><span class="k">  </span><span class="n">LoopNum</span>              <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span>
<a name="ln-3003"></a>  <span class="n">LoopSideNum</span>          <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span>
<a name="ln-3004"></a>
<a name="ln-3005"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">CurrentSimTime</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">)</span><span class="n">OneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3006"></a>
<a name="ln-3007"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">MyLoad</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">GSHPTypeNum</span> <span class="o">==</span> <span class="n">TypeOf_HPWaterEFHeating</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-3008"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3009"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">IsOn</span>    <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3010"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">MyLoad</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">GSHPTypeNum</span> <span class="o">==</span> <span class="n">TypeOf_HPWaterEFCooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3011"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3012"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">IsOn</span>    <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3013"></a>  <span class="k">ELSE</span>
<a name="ln-3014"></a><span class="k">    </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3015"></a>    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">IsOn</span>    <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3016"></a>  <span class="k">END IF</span>
<a name="ln-3017"></a>
<a name="ln-3018"></a><span class="c">!*******Set flow based on &quot;flowlock&quot; and &quot;run&quot; flags**********</span>
<a name="ln-3019"></a><span class="c">! Set flows if the heat pump is not running</span>
<a name="ln-3020"></a> <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-3021"></a><span class="k">    </span><span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideMassFlowRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3022"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3023"></a>
<a name="ln-3024"></a>    <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3025"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3026"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3027"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3028"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3029"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3030"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadCompNum</span><span class="p">)</span>
<a name="ln-3031"></a>    <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3032"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3033"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3034"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3035"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3036"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3037"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceCompNum</span><span class="p">)</span>
<a name="ln-3038"></a>
<a name="ln-3039"></a><span class="c">! Set flows if the heat pump is running</span>
<a name="ln-3040"></a>  <span class="k">ELSE</span> <span class="c">! the heat pump must run</span>
<a name="ln-3041"></a>
<a name="ln-3042"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideMassFlowRate</span>     <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideDesignMassFlow</span>
<a name="ln-3043"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideMassFlowRate</span>   <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideDesignMassFlow</span>
<a name="ln-3044"></a>  <span class="c">! now check against and request in plant</span>
<a name="ln-3045"></a>    <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3046"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3047"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3048"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3049"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3050"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3051"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadCompNum</span><span class="p">)</span>
<a name="ln-3052"></a>    <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3053"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3054"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3055"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3056"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3057"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3058"></a>                                    <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceCompNum</span><span class="p">)</span>
<a name="ln-3059"></a>     <span class="c">!if there&#39;s no flowin one, turn the entire &quot;heat pump off&quot;</span>
<a name="ln-3060"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideMassFlowRate</span>  <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3061"></a>       <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideMassFlowRate</span>  <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3062"></a>
<a name="ln-3063"></a><span class="k">      </span><span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3064"></a>      <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3065"></a>      <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3066"></a>
<a name="ln-3067"></a>      <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3068"></a>                                      <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3069"></a>                                      <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3070"></a>                                      <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3071"></a>                                      <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3072"></a>                                      <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3073"></a>                                      <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadCompNum</span><span class="p">)</span>
<a name="ln-3074"></a>      <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3075"></a>                                      <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3076"></a>                                      <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3077"></a>                                      <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3078"></a>                                      <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3079"></a>                                      <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3080"></a>                                      <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceCompNum</span><span class="p">)</span>
<a name="ln-3081"></a>
<a name="ln-3082"></a>      <span class="k">RETURN</span>
<a name="ln-3083"></a><span class="k">    END IF</span>
<a name="ln-3084"></a><span class="k">  END IF</span>
<a name="ln-3085"></a>
<a name="ln-3086"></a>
<a name="ln-3087"></a>    <span class="c">! Get inlet temps</span>
<a name="ln-3088"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletTemp</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3089"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceSideInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3090"></a>
<a name="ln-3091"></a>  <span class="c">! Outlet variables</span>
<a name="ln-3092"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Power</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3093"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Energy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3094"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3095"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoadEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3096"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3097"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSourceEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3098"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3099"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3100"></a>
<a name="ln-3101"></a><span class="k">RETURN</span>
<a name="ln-3102"></a><span class="k">END SUBROUTINE </span><span class="n">InitWatertoWaterHP</span>
<a name="ln-3103"></a>
<a name="ln-3104"></a><span class="k">SUBROUTINE </span><span class="n">CalcWatertoWaterHPCooling</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-3105"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3106"></a>          <span class="c">!       AUTHOR         Kenneth Tang</span>
<a name="ln-3107"></a>          <span class="c">!       DATE WRITTEN   March 2005</span>
<a name="ln-3108"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-3109"></a>          <span class="c">!</span>
<a name="ln-3110"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-3111"></a>
<a name="ln-3112"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3113"></a>          <span class="c">! This routine simulate the heat pump peformance in cooling mode</span>
<a name="ln-3114"></a>
<a name="ln-3115"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3116"></a>
<a name="ln-3117"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3118"></a>          <span class="c">! (1) Tang,C.C.. 2005. Modeling Packaged Heat Pumps in a Quasi-Steady</span>
<a name="ln-3119"></a>          <span class="c">! State Energy Simulation Program. M.S. Thesis, Department of Mechanical and Aerospace Engineering,</span>
<a name="ln-3120"></a>          <span class="c">! Oklahoma State University. (downloadable from http://www.hvac.okstate.edu/)</span>
<a name="ln-3121"></a>
<a name="ln-3122"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3123"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-3124"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-3125"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span> <span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-3126"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-3127"></a>
<a name="ln-3128"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3129"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">GSHPNum</span>   <span class="c">! GSHP Number</span>
<a name="ln-3130"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">MyLoad</span>    <span class="c">! Operating Load</span>
<a name="ln-3131"></a>
<a name="ln-3132"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3133"></a>
<a name="ln-3134"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">CelsiustoKelvin</span>  <span class="o">=</span> <span class="n">KelvinConv</span>  <span class="c">! Conversion from Celsius to Kelvin</span>
<a name="ln-3135"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">Tref</span>             <span class="o">=</span> <span class="mi">28</span><span class="mf">3.15d0</span>  <span class="c">! Reference Temperature for performance curves,10C [K]</span>
<a name="ln-3136"></a>
<a name="ln-3137"></a>
<a name="ln-3138"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3139"></a>          <span class="c">! na</span>
<a name="ln-3140"></a>
<a name="ln-3141"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3142"></a>          <span class="c">! na</span>
<a name="ln-3143"></a>
<a name="ln-3144"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3145"></a>
<a name="ln-3146"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolCapRated</span>                 <span class="c">! Rated Cooling Capacity [W]</span>
<a name="ln-3147"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolPowerRated</span>               <span class="c">! Rated Cooling Power Consumption[W]</span>
<a name="ln-3148"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideVolFlowRateRated</span>     <span class="c">! Rated Load Side Volumetric Flow Rate [m3/s]</span>
<a name="ln-3149"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideVolFlowRateRated</span>   <span class="c">! Rated Source Side Volumetric Flow Rate [m3/s]</span>
<a name="ln-3150"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolCapCoeff1</span>                <span class="c">! 1st coefficient of the cooling capacity performance curve</span>
<a name="ln-3151"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolCapCoeff2</span>                <span class="c">! 2nd coefficient of the cooling capacity performance curve</span>
<a name="ln-3152"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolCapCoeff3</span>                <span class="c">! 3rd coefficient of the cooling capacity performance curve</span>
<a name="ln-3153"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolCapCoeff4</span>                <span class="c">! 4th coefficient of the cooling capacity performance curve</span>
<a name="ln-3154"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolCapCoeff5</span>                <span class="c">! 5th coefficient of the cooling capacity performance curve</span>
<a name="ln-3155"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolPowerCoeff1</span>              <span class="c">! 1st coefficient of the cooling power consumption curve</span>
<a name="ln-3156"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolPowerCoeff2</span>              <span class="c">! 2nd coefficient of the cooling power consumption curve</span>
<a name="ln-3157"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolPowerCoeff3</span>              <span class="c">! 3rd coefficient of the cooling power consumption curve</span>
<a name="ln-3158"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolPowerCoeff4</span>              <span class="c">! 4th coefficient of the cooling power consumption curve</span>
<a name="ln-3159"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolPowerCoeff5</span>              <span class="c">! 5th coefficient of the cooling power consumption curve</span>
<a name="ln-3160"></a>
<a name="ln-3161"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideMassFlowRate</span>         <span class="c">! Load Side Mass Flow Rate [kg/s]</span>
<a name="ln-3162"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideInletTemp</span>            <span class="c">! Load Side Inlet Temperature [C]</span>
<a name="ln-3163"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideOutletTemp</span>           <span class="c">! Load side Outlet Temperature [C]</span>
<a name="ln-3164"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideMassFlowRate</span>       <span class="c">! Source Side Mass Flow Rate [kg/s]</span>
<a name="ln-3165"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideInletTemp</span>          <span class="c">! Source Side Inlet Temperature [C]</span>
<a name="ln-3166"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideOutletTemp</span>         <span class="c">! Source Side Outlet Temperature [C]</span>
<a name="ln-3167"></a>
<a name="ln-3168"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">func1</span>                        <span class="c">! Portion of the heat transfer and power equation</span>
<a name="ln-3169"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">func2</span>                        <span class="c">! Portion of the heat transfer and power equation</span>
<a name="ln-3170"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">func3</span>                        <span class="c">! Portion of the heat transfer and power equation</span>
<a name="ln-3171"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">func4</span>                        <span class="c">! Portion of the heat transfer and power equation</span>
<a name="ln-3172"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Power</span>                        <span class="c">! Power Consumption [W]</span>
<a name="ln-3173"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLoad</span>                        <span class="c">! Cooling Capacity [W]</span>
<a name="ln-3174"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QSource</span>                      <span class="c">! Source Side Heat Transfer Rate [W]</span>
<a name="ln-3175"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>                <span class="c">! Part-Load Ratio</span>
<a name="ln-3176"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReportingConstant</span>
<a name="ln-3177"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhoLoadSide</span>
<a name="ln-3178"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhoSourceSide</span>
<a name="ln-3179"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpLoadSide</span>
<a name="ln-3180"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpSourceSide</span>
<a name="ln-3181"></a>
<a name="ln-3182"></a>  <span class="c">!  LOAD LOCAL VARIABLES FROM DATA STRUCTURE</span>
<a name="ln-3183"></a>  <span class="n">LoadSideVolFlowRateRated</span>  <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedLoadVolFlowCool</span>
<a name="ln-3184"></a>  <span class="n">SourceSideVolFlowRateRated</span><span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedSourceVolFlowCool</span>
<a name="ln-3185"></a>  <span class="n">CoolCapRated</span>              <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedCapCool</span>
<a name="ln-3186"></a>  <span class="n">CoolPowerRated</span>            <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedPowerCool</span>
<a name="ln-3187"></a>  <span class="n">CoolCapCoeff1</span>             <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolCap1</span>
<a name="ln-3188"></a>  <span class="n">CoolCapCoeff2</span>             <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolCap2</span>
<a name="ln-3189"></a>  <span class="n">CoolCapCoeff3</span>             <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolCap3</span>
<a name="ln-3190"></a>  <span class="n">CoolCapCoeff4</span>             <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolCap4</span>
<a name="ln-3191"></a>  <span class="n">CoolCapCoeff5</span>             <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolCap5</span>
<a name="ln-3192"></a>  <span class="n">CoolPowerCoeff1</span>           <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolPower1</span>
<a name="ln-3193"></a>  <span class="n">CoolPowerCoeff2</span>           <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolPower2</span>
<a name="ln-3194"></a>  <span class="n">CoolPowerCoeff3</span>           <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolPower3</span>
<a name="ln-3195"></a>  <span class="n">CoolPowerCoeff4</span>           <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolPower4</span>
<a name="ln-3196"></a>  <span class="n">CoolPowerCoeff5</span>           <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolPower5</span>
<a name="ln-3197"></a>
<a name="ln-3198"></a>  <span class="n">LoadSideMassFlowRate</span>      <span class="o">=</span> <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideMassFlowRate</span>
<a name="ln-3199"></a>  <span class="n">LoadSideInletTemp</span>         <span class="o">=</span> <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletTemp</span>
<a name="ln-3200"></a>  <span class="n">SourceSideMassFlowRate</span>    <span class="o">=</span> <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideMassFlowRate</span>
<a name="ln-3201"></a>  <span class="n">SourceSideInletTemp</span>       <span class="o">=</span> <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletTemp</span>
<a name="ln-3202"></a>
<a name="ln-3203"></a>  <span class="c">! If heat pump is not operating, THEN return</span>
<a name="ln-3204"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3205"></a><span class="k">    RETURN</span>
<a name="ln-3206"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-3207"></a>
<a name="ln-3208"></a>  <span class="n">rhoLoadSide</span> <span class="o">=</span>  <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3209"></a>                           <span class="n">LoadSideInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3210"></a>                           <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3211"></a>                           <span class="s1">&#39;CalcWatertoWaterHPCooling&#39;</span><span class="p">)</span>
<a name="ln-3212"></a>
<a name="ln-3213"></a>  <span class="n">rhoSourceSide</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3214"></a>                           <span class="n">SourceSideInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3215"></a>                           <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3216"></a>                           <span class="s1">&#39;CalcWatertoWaterHPCooling&#39;</span><span class="p">)</span>
<a name="ln-3217"></a>
<a name="ln-3218"></a>  <span class="n">func1</span> <span class="o">=</span> <span class="p">((</span><span class="n">LoadSideInletTemp</span><span class="o">+</span><span class="n">CelsiustoKelvin</span><span class="p">)</span><span class="o">/</span><span class="n">Tref</span><span class="p">)</span>
<a name="ln-3219"></a>  <span class="n">func2</span> <span class="o">=</span> <span class="p">((</span><span class="n">SourceSideInletTemp</span><span class="o">+</span><span class="n">CelsiustoKelvin</span><span class="p">)</span><span class="o">/</span><span class="n">Tref</span><span class="p">)</span>
<a name="ln-3220"></a>  <span class="n">func3</span> <span class="o">=</span> <span class="p">(</span><span class="n">LoadSideMassFlowRate</span><span class="o">/</span><span class="p">(</span><span class="n">LoadSideVolFlowRateRated</span> <span class="o">*</span> <span class="n">rhoLoadSide</span><span class="p">))</span>
<a name="ln-3221"></a>  <span class="n">func4</span> <span class="o">=</span> <span class="p">(</span><span class="n">SourceSideMassFlowRate</span><span class="o">/</span><span class="p">(</span><span class="n">SourceSideVolFlowRateRated</span> <span class="o">*</span> <span class="n">rhoSourceSide</span><span class="p">))</span>
<a name="ln-3222"></a>
<a name="ln-3223"></a>  <span class="n">QLoad</span> <span class="o">=</span> <span class="n">CoolCapRated</span><span class="o">*</span><span class="p">(</span><span class="n">CoolCapCoeff1</span> <span class="o">+</span> <span class="p">(</span><span class="n">func1</span> <span class="o">*</span> <span class="n">CoolCapCoeff2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">func2</span> <span class="o">*</span> <span class="n">CoolCapCoeff3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">func3</span> <span class="o">*</span> <span class="n">CoolCapCoeff4</span><span class="p">)</span><span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-3224"></a>                                          <span class="p">(</span><span class="n">func4</span> <span class="o">*</span> <span class="n">CoolCapCoeff5</span><span class="p">))</span>
<a name="ln-3225"></a>  <span class="n">Power</span> <span class="o">=</span> <span class="n">CoolPowerRated</span><span class="o">*</span><span class="p">(</span><span class="n">CoolPowerCoeff1</span> <span class="o">+</span> <span class="p">(</span><span class="n">func1</span> <span class="o">*</span> <span class="n">CoolPowerCoeff2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">func2</span> <span class="o">*</span> <span class="n">CoolPowerCoeff3</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-3226"></a>                                          <span class="p">(</span><span class="n">func3</span> <span class="o">*</span> <span class="n">CoolPowerCoeff4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">func4</span> <span class="o">*</span> <span class="n">CoolPowerCoeff5</span><span class="p">))</span>
<a name="ln-3227"></a>
<a name="ln-3228"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">Qload</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Power</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3229"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Qload</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3230"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolCapNegativeCounter</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3231"></a><span class="k">        </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolCapNegativeCounter</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolCapNegativeCounter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3232"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPEqFitCooling</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-3233"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Cooling capacity curve output is &lt;= 0.0 (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">QLoad</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-3234"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Zero or negative value occurs with a load-side inlet temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-3235"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">LoadSideInletTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C,&#39;</span><span class="p">)</span>
<a name="ln-3236"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; a source-side inlet temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-3237"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SourceSideInletTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C,&#39;</span><span class="p">)</span>
<a name="ln-3238"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; a load-side mass flow rate of &#39;</span> <span class="p">&amp;</span>
<a name="ln-3239"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">LoadSideMassFlowRate</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s,&#39;</span><span class="p">)</span>
<a name="ln-3240"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; and a source-side mass flow rate of &#39;</span> <span class="p">&amp;</span>
<a name="ln-3241"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SourceSideMassFlowRate</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s.&#39;</span><span class="p">)</span>
<a name="ln-3242"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; The heat pump is turned off for this time step but simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-3243"></a>      <span class="k">ELSE</span>
<a name="ln-3244"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPEqFitCooling</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3245"></a>                     <span class="s1">&#39; Cooling capacity curve output is &lt;= 0.0 warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-3246"></a>                     <span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolCapNegativeIndex</span><span class="p">,</span> <span class="n">Qload</span><span class="p">,</span> <span class="n">Qload</span><span class="p">)</span>
<a name="ln-3247"></a>      <span class="k">END IF</span>
<a name="ln-3248"></a><span class="k">    END IF</span>
<a name="ln-3249"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Power</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3250"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolPowerNegativeCounter</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3251"></a><span class="k">        </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolPowerNegativeCounter</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolPowerNegativeCounter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3252"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPEqFitCooling</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-3253"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Cooling compressor power curve output is &lt;= 0.0 (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Power</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-3254"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Zero or negative value occurs with a load-side inlet temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-3255"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">LoadSideInletTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C,&#39;</span><span class="p">)</span>
<a name="ln-3256"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; a source-side inlet temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-3257"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SourceSideInletTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C,&#39;</span><span class="p">)</span>
<a name="ln-3258"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; a load-side mass flow rate of &#39;</span> <span class="p">&amp;</span>
<a name="ln-3259"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">LoadSideMassFlowRate</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s,&#39;</span><span class="p">)</span>
<a name="ln-3260"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; and a source-side mass flow rate of &#39;</span> <span class="p">&amp;</span>
<a name="ln-3261"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SourceSideMassFlowRate</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s.&#39;</span><span class="p">)</span>
<a name="ln-3262"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; The heat pump is turned off for this time step but simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-3263"></a>      <span class="k">ELSE</span>
<a name="ln-3264"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPEqFitCooling</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3265"></a>                     <span class="s1">&#39; Cooling compressor power curve output is &lt;= 0.0 warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-3266"></a>                     <span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">CoolPowerNegativeIndex</span><span class="p">,</span> <span class="n">Power</span><span class="p">,</span> <span class="n">Power</span><span class="p">)</span>
<a name="ln-3267"></a>      <span class="k">END IF</span>
<a name="ln-3268"></a><span class="k">    END IF</span>
<a name="ln-3269"></a>
<a name="ln-3270"></a><span class="k">    </span><span class="n">Qload</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3271"></a>    <span class="n">Power</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3272"></a>
<a name="ln-3273"></a>  <span class="k">END IF</span>
<a name="ln-3274"></a>
<a name="ln-3275"></a><span class="k">  </span><span class="n">QSource</span> <span class="o">=</span> <span class="n">QLoad</span><span class="o">+</span><span class="n">Power</span>   <span class="c">!assume no losses</span>
<a name="ln-3276"></a>
<a name="ln-3277"></a>  <span class="c">!Control Strategy</span>
<a name="ln-3278"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">QLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Qload</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3279"></a><span class="k">    </span><span class="n">PartLoadRatio</span>        <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span><span class="o">/</span><span class="n">QLoad</span>
<a name="ln-3280"></a>    <span class="n">QLoad</span>                <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-3281"></a>    <span class="n">Power</span>                <span class="o">=</span> <span class="n">Power</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-3282"></a>    <span class="n">QSource</span>              <span class="o">=</span> <span class="n">QSource</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-3283"></a>  <span class="k">END IF</span>
<a name="ln-3284"></a>
<a name="ln-3285"></a><span class="k">  </span><span class="n">CpLoadSide</span>   <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3286"></a>                           <span class="n">LoadSideInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3287"></a>                           <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3288"></a>                           <span class="s1">&#39;CalcWatertoWaterHPCooling&#39;</span><span class="p">)</span>
<a name="ln-3289"></a>
<a name="ln-3290"></a>  <span class="n">CpSourceSide</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3291"></a>                           <span class="n">SourceSideInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3292"></a>                           <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3293"></a>                           <span class="s1">&#39;CalcWatertoWaterHPCooling&#39;</span><span class="p">)</span>
<a name="ln-3294"></a>
<a name="ln-3295"></a>  <span class="n">LoadSideOutletTemp</span>   <span class="o">=</span> <span class="n">LoadSideInletTemp</span> <span class="o">-</span> <span class="n">QLoad</span><span class="o">/</span><span class="p">(</span><span class="n">LoadSideMassFlowRate</span> <span class="o">*</span> <span class="n">CpLoadSide</span><span class="p">)</span>
<a name="ln-3296"></a>  <span class="n">SourceSideOutletTemp</span> <span class="o">=</span> <span class="n">SourceSideInletTemp</span> <span class="o">+</span> <span class="n">QSource</span><span class="o">/</span><span class="p">(</span><span class="n">SourceSideMassFlowRate</span> <span class="o">*</span> <span class="n">CpSourceSide</span> <span class="p">)</span>
<a name="ln-3297"></a>
<a name="ln-3298"></a>  <span class="n">ReportingConstant</span> <span class="o">=</span> <span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3299"></a>
<a name="ln-3300"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Power</span>                 <span class="o">=</span> <span class="n">Power</span>
<a name="ln-3301"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Energy</span>                <span class="o">=</span> <span class="n">Power</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3302"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span>               <span class="o">=</span> <span class="n">QSource</span>
<a name="ln-3303"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoad</span>                 <span class="o">=</span> <span class="n">QLoad</span>
<a name="ln-3304"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSourceEnergy</span>         <span class="o">=</span> <span class="n">QSource</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3305"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoadEnergy</span>           <span class="o">=</span> <span class="n">QLoad</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3306"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletTemp</span>    <span class="o">=</span> <span class="n">LoadSideOutletTemp</span>
<a name="ln-3307"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletTemp</span>  <span class="o">=</span> <span class="n">SourceSideOutletTemp</span>
<a name="ln-3308"></a>  <span class="k">RETURN</span>
<a name="ln-3309"></a><span class="k">END SUBROUTINE </span><span class="n">CalcWatertoWaterHPCooling</span>
<a name="ln-3310"></a>
<a name="ln-3311"></a>
<a name="ln-3312"></a><span class="k">SUBROUTINE </span><span class="n">CalcWatertoWaterHPHeating</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-3313"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3314"></a>          <span class="c">!       AUTHOR         Kenneth Tang</span>
<a name="ln-3315"></a>          <span class="c">!       DATE WRITTEN   March 2005</span>
<a name="ln-3316"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-3317"></a>          <span class="c">!</span>
<a name="ln-3318"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-3319"></a>
<a name="ln-3320"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3321"></a>          <span class="c">! This routine simulate the heat pump peformance in heating mode</span>
<a name="ln-3322"></a>
<a name="ln-3323"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3324"></a>
<a name="ln-3325"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3326"></a>          <span class="c">! (1) Tang,C.C.. 2005. Modeling Packaged Heat Pumps in a Quasi-Steady</span>
<a name="ln-3327"></a>          <span class="c">! State Energy Simulation Program. M.S. Thesis, Department of Mechanical and Aerospace Engineering,</span>
<a name="ln-3328"></a>          <span class="c">! Oklahoma State University. (downloadable from http://www.hvac.okstate.edu/)</span>
<a name="ln-3329"></a>
<a name="ln-3330"></a>
<a name="ln-3331"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3332"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-3333"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-3334"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span> <span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-3335"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-3336"></a>
<a name="ln-3337"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3338"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">GSHPNum</span>   <span class="c">! GSHP Number</span>
<a name="ln-3339"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">MyLoad</span>    <span class="c">! Operating Load</span>
<a name="ln-3340"></a>
<a name="ln-3341"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3342"></a>
<a name="ln-3343"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">CelsiustoKelvin</span>  <span class="o">=</span> <span class="n">KelvinConv</span>  <span class="c">! Conversion from Celsius to Kelvin</span>
<a name="ln-3344"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">Tref</span>             <span class="o">=</span> <span class="mi">28</span><span class="mf">3.15d0</span>  <span class="c">! Reference Temperature for performance curves,10C [K]</span>
<a name="ln-3345"></a>
<a name="ln-3346"></a>
<a name="ln-3347"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3348"></a>          <span class="c">! na</span>
<a name="ln-3349"></a>
<a name="ln-3350"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3351"></a>          <span class="c">! na</span>
<a name="ln-3352"></a>
<a name="ln-3353"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3354"></a>
<a name="ln-3355"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapRated</span>                 <span class="c">! Rated Heating Capacity [W]</span>
<a name="ln-3356"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatPowerRated</span>               <span class="c">! Rated Heating Compressor Power[W]</span>
<a name="ln-3357"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideVolFlowRateRated</span>     <span class="c">! Rated Load Side Volumetric Flow Rate [m3/s]</span>
<a name="ln-3358"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideVolFlowRateRated</span>   <span class="c">! Rated Source Side Volumetric Flow Rate [m3/s]</span>
<a name="ln-3359"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapCoeff1</span>                <span class="c">! 1st coefficient of the heating capacity performance curve</span>
<a name="ln-3360"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapCoeff2</span>                <span class="c">! 2nd coefficient of the heating capacity performance curve</span>
<a name="ln-3361"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapCoeff3</span>                <span class="c">! 3rd coefficient of the heating capacity performance curve</span>
<a name="ln-3362"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapCoeff4</span>                <span class="c">! 4th coefficient of the heating capacity performance curve</span>
<a name="ln-3363"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCapCoeff5</span>                <span class="c">! 5th coefficient of the heating capacity performance curve</span>
<a name="ln-3364"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatPowerCoeff1</span>              <span class="c">! 1st coefficient of the heating power consumption curve</span>
<a name="ln-3365"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatPowerCoeff2</span>              <span class="c">! 2nd coefficient of the heating power consumption curve</span>
<a name="ln-3366"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatPowerCoeff3</span>              <span class="c">! 3rd coefficient of the heating power consumption curve</span>
<a name="ln-3367"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatPowerCoeff4</span>              <span class="c">! 4th coefficient of the heating power consumption curve</span>
<a name="ln-3368"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatPowerCoeff5</span>              <span class="c">! 5th coefficient of the heating power consumption curve</span>
<a name="ln-3369"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideMassFlowRate</span>         <span class="c">! Load Side Mass Flow Rate [kg/s]</span>
<a name="ln-3370"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideInletTemp</span>            <span class="c">! Load Side Inlet Temperature [C]</span>
<a name="ln-3371"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadSideOutletTemp</span>           <span class="c">! Load side Outlet Temperature [C]</span>
<a name="ln-3372"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideMassFlowRate</span>       <span class="c">! Source Side Mass Flow Rate [kg/s]</span>
<a name="ln-3373"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideInletTemp</span>          <span class="c">! Source Side Inlet Temperature [C]</span>
<a name="ln-3374"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceSideOutletTemp</span>         <span class="c">! Source Side Outlet Temperature [C]</span>
<a name="ln-3375"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">func1</span>                        <span class="c">! Portion of the heat transfer and power equation</span>
<a name="ln-3376"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">func2</span>                        <span class="c">! Portion of the heat transfer and power equation</span>
<a name="ln-3377"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">func3</span>                        <span class="c">! Portion of the heat transfer and power equation</span>
<a name="ln-3378"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">func4</span>                        <span class="c">! Portion of the heat transfer and power equation</span>
<a name="ln-3379"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Power</span>                        <span class="c">! Power Consumption [W]</span>
<a name="ln-3380"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLoad</span>                        <span class="c">! Cooling Capacity [W]</span>
<a name="ln-3381"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QSource</span>                      <span class="c">! Source Side Heat Transfer Rate [W]</span>
<a name="ln-3382"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>                <span class="c">! Part Load Ratio</span>
<a name="ln-3383"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReportingConstant</span>
<a name="ln-3384"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhoLoadSide</span>
<a name="ln-3385"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhoSourceSide</span>
<a name="ln-3386"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpLoadSide</span>
<a name="ln-3387"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpSourceSide</span>
<a name="ln-3388"></a>
<a name="ln-3389"></a>  <span class="c">!  LOAD LOCAL VARIABLES FROM DATA STRUCTURE</span>
<a name="ln-3390"></a>  <span class="n">LoadSideVolFlowRateRated</span>  <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedLoadVolFlowHeat</span>
<a name="ln-3391"></a>  <span class="n">SourceSideVolFlowRateRated</span><span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedSourceVolFlowHeat</span>
<a name="ln-3392"></a>  <span class="n">HeatCapRated</span>              <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedCapHeat</span>
<a name="ln-3393"></a>  <span class="n">HeatPowerRated</span>            <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">RatedPowerHeat</span>
<a name="ln-3394"></a>  <span class="n">HeatCapCoeff1</span>             <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatCap1</span>
<a name="ln-3395"></a>  <span class="n">HeatCapCoeff2</span>             <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatCap2</span>
<a name="ln-3396"></a>  <span class="n">HeatCapCoeff3</span>             <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatCap3</span>
<a name="ln-3397"></a>  <span class="n">HeatCapCoeff4</span>             <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatCap4</span>
<a name="ln-3398"></a>  <span class="n">HeatCapCoeff5</span>             <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatCap5</span>
<a name="ln-3399"></a>  <span class="n">HeatPowerCoeff1</span>           <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatPower1</span>
<a name="ln-3400"></a>  <span class="n">HeatPowerCoeff2</span>           <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatPower2</span>
<a name="ln-3401"></a>  <span class="n">HeatPowerCoeff3</span>           <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatPower3</span>
<a name="ln-3402"></a>  <span class="n">HeatPowerCoeff4</span>           <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatPower4</span>
<a name="ln-3403"></a>  <span class="n">HeatPowerCoeff5</span>           <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatPower5</span>
<a name="ln-3404"></a>
<a name="ln-3405"></a>  <span class="n">LoadSideMassFlowRate</span>      <span class="o">=</span> <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideMassFlowRate</span>
<a name="ln-3406"></a>  <span class="n">LoadSideInletTemp</span>         <span class="o">=</span> <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletTemp</span>
<a name="ln-3407"></a>  <span class="n">SourceSideMassFlowRate</span>    <span class="o">=</span> <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideMassFlowRate</span>
<a name="ln-3408"></a>  <span class="n">SourceSideInletTemp</span>       <span class="o">=</span> <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletTemp</span>
<a name="ln-3409"></a>
<a name="ln-3410"></a>
<a name="ln-3411"></a>  <span class="c">! If heat pump is not operating, THEN return</span>
<a name="ln-3412"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3413"></a><span class="k">    RETURN</span>
<a name="ln-3414"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-3415"></a>  <span class="n">rhoLoadSide</span> <span class="o">=</span>  <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3416"></a>                           <span class="n">LoadSideInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3417"></a>                           <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3418"></a>                           <span class="s1">&#39;CalcWatertoWaterHPHeating&#39;</span><span class="p">)</span>
<a name="ln-3419"></a>
<a name="ln-3420"></a>  <span class="n">rhoSourceSide</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3421"></a>                           <span class="n">SourceSideInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3422"></a>                           <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3423"></a>                           <span class="s1">&#39;CalcWatertoWaterHPHeating&#39;</span><span class="p">)</span>
<a name="ln-3424"></a>
<a name="ln-3425"></a>  <span class="n">func1</span> <span class="o">=</span> <span class="p">((</span><span class="n">LoadSideInletTemp</span><span class="o">+</span><span class="n">CelsiustoKelvin</span><span class="p">)</span><span class="o">/</span><span class="n">Tref</span><span class="p">)</span>
<a name="ln-3426"></a>  <span class="n">func2</span> <span class="o">=</span> <span class="p">((</span><span class="n">SourceSideInletTemp</span><span class="o">+</span><span class="n">CelsiustoKelvin</span><span class="p">)</span><span class="o">/</span><span class="n">Tref</span><span class="p">)</span>
<a name="ln-3427"></a>  <span class="n">func3</span> <span class="o">=</span> <span class="p">(</span><span class="n">LoadSideMassFlowRate</span><span class="o">/</span><span class="p">(</span><span class="n">LoadSideVolFlowRateRated</span> <span class="o">*</span> <span class="n">rhoLoadSide</span> <span class="p">))</span>
<a name="ln-3428"></a>  <span class="n">func4</span> <span class="o">=</span> <span class="p">(</span><span class="n">SourceSideMassFlowRate</span><span class="o">/</span><span class="p">(</span><span class="n">SourceSideVolFlowRateRated</span> <span class="o">*</span> <span class="n">rhoSourceSide</span> <span class="p">))</span>
<a name="ln-3429"></a>
<a name="ln-3430"></a>  <span class="n">QLoad</span> <span class="o">=</span> <span class="n">HeatCapRated</span><span class="o">*</span><span class="p">(</span><span class="n">HeatCapCoeff1</span> <span class="o">+</span> <span class="p">(</span><span class="n">func1</span> <span class="o">*</span> <span class="n">HeatCapCoeff2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">func2</span> <span class="o">*</span> <span class="n">HeatCapCoeff3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">func3</span> <span class="o">*</span> <span class="n">HeatCapCoeff4</span><span class="p">)</span><span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-3431"></a>                                        <span class="p">(</span><span class="n">func4</span> <span class="o">*</span> <span class="n">HeatCapCoeff5</span><span class="p">))</span>
<a name="ln-3432"></a>  <span class="n">Power</span> <span class="o">=</span> <span class="n">HeatPowerRated</span><span class="o">*</span><span class="p">(</span><span class="n">HeatPowerCoeff1</span> <span class="o">+</span> <span class="p">(</span><span class="n">func1</span> <span class="o">*</span> <span class="n">HeatPowerCoeff2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">func2</span> <span class="o">*</span> <span class="n">HeatPowerCoeff3</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-3433"></a>                                         <span class="p">(</span><span class="n">func3</span> <span class="o">*</span> <span class="n">HeatPowerCoeff4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">func4</span> <span class="o">*</span> <span class="n">HeatPowerCoeff5</span><span class="p">))</span>
<a name="ln-3434"></a>
<a name="ln-3435"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">Qload</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Power</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3436"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Qload</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3437"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatCapNegativeCounter</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3438"></a><span class="k">        </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatCapNegativeCounter</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatCapNegativeCounter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3439"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPEqFitHeating</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-3440"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Heating capacity curve output is &lt;= 0.0 (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">QLoad</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-3441"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Zero or negative value occurs with a load-side inlet temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-3442"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">LoadSideInletTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C,&#39;</span><span class="p">)</span>
<a name="ln-3443"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; a source-side inlet temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-3444"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SourceSideInletTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C,&#39;</span><span class="p">)</span>
<a name="ln-3445"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; a load-side mass flow rate of &#39;</span> <span class="p">&amp;</span>
<a name="ln-3446"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">LoadSideMassFlowRate</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s,&#39;</span><span class="p">)</span>
<a name="ln-3447"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; and a source-side mass flow rate of &#39;</span> <span class="p">&amp;</span>
<a name="ln-3448"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SourceSideMassFlowRate</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s.&#39;</span><span class="p">)</span>
<a name="ln-3449"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; The heat pump is turned off for this time step but simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-3450"></a>      <span class="k">ELSE</span>
<a name="ln-3451"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPEqFitHeating</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3452"></a>                     <span class="s1">&#39; Heating capacity curve output is &lt;= 0.0 warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-3453"></a>                     <span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatCapNegativeIndex</span><span class="p">,</span> <span class="n">Qload</span><span class="p">,</span> <span class="n">Qload</span><span class="p">)</span>
<a name="ln-3454"></a>      <span class="k">END IF</span>
<a name="ln-3455"></a><span class="k">    END IF</span>
<a name="ln-3456"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Power</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3457"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatPowerNegativeCounter</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3458"></a><span class="k">        </span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatPowerNegativeCounter</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatPowerNegativeCounter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3459"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPEqFitHeating</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-3460"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Heating compressor power curve output is &lt;= 0.0 (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Power</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-3461"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Zero or negative value occurs with a load-side inlet temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-3462"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">LoadSideInletTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C,&#39;</span><span class="p">)</span>
<a name="ln-3463"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; a source-side inlet temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-3464"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SourceSideInletTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C,&#39;</span><span class="p">)</span>
<a name="ln-3465"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; a load-side mass flow rate of &#39;</span> <span class="p">&amp;</span>
<a name="ln-3466"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">LoadSideMassFlowRate</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s,&#39;</span><span class="p">)</span>
<a name="ln-3467"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; and a source-side mass flow rate of &#39;</span> <span class="p">&amp;</span>
<a name="ln-3468"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SourceSideMassFlowRate</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s.&#39;</span><span class="p">)</span>
<a name="ln-3469"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; The heat pump is turned off for this time step but simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-3470"></a>      <span class="k">ELSE</span>
<a name="ln-3471"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPEqFitHeating</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3472"></a>                     <span class="s1">&#39; Heating compressor power curve output is &lt;= 0.0 warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-3473"></a>                     <span class="p">,</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">HeatPowerNegativeIndex</span><span class="p">,</span> <span class="n">Power</span><span class="p">,</span> <span class="n">Power</span><span class="p">)</span>
<a name="ln-3474"></a>      <span class="k">END IF</span>
<a name="ln-3475"></a><span class="k">    END IF</span>
<a name="ln-3476"></a>
<a name="ln-3477"></a><span class="k">    </span><span class="n">Qload</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3478"></a>    <span class="n">Power</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3479"></a>
<a name="ln-3480"></a>  <span class="k">END IF</span>
<a name="ln-3481"></a>
<a name="ln-3482"></a><span class="k">  </span><span class="n">QSource</span> <span class="o">=</span> <span class="n">QLoad</span><span class="o">-</span><span class="n">Power</span>   <span class="c">!assume no losses</span>
<a name="ln-3483"></a>
<a name="ln-3484"></a>  <span class="c">!Control Strategy</span>
<a name="ln-3485"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">QLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Qload</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3486"></a><span class="k">    </span><span class="n">PartLoadRatio</span>        <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span><span class="o">/</span><span class="n">QLoad</span>
<a name="ln-3487"></a>    <span class="n">QLoad</span>                <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-3488"></a>    <span class="n">Power</span>                <span class="o">=</span> <span class="n">Power</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-3489"></a>    <span class="n">QSource</span>              <span class="o">=</span> <span class="n">QSource</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-3490"></a>  <span class="k">END IF</span>
<a name="ln-3491"></a>
<a name="ln-3492"></a><span class="k">  </span><span class="n">CpLoadSide</span>   <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3493"></a>                           <span class="n">LoadSideInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3494"></a>                           <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3495"></a>                           <span class="s1">&#39;CalcWatertoWaterHPHeating&#39;</span><span class="p">)</span>
<a name="ln-3496"></a>
<a name="ln-3497"></a>  <span class="n">CpSourceSide</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3498"></a>                           <span class="n">SourceSideInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3499"></a>                           <span class="n">PlantLoop</span><span class="p">(</span><span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3500"></a>                           <span class="s1">&#39;CalcWatertoWaterHPHeating&#39;</span><span class="p">)</span>
<a name="ln-3501"></a>
<a name="ln-3502"></a>  <span class="n">LoadSideOutletTemp</span>   <span class="o">=</span> <span class="n">LoadSideInletTemp</span> <span class="o">+</span> <span class="n">QLoad</span><span class="o">/</span><span class="p">(</span><span class="n">LoadSideMassFlowRate</span> <span class="o">*</span> <span class="n">CpLoadSide</span><span class="p">)</span>
<a name="ln-3503"></a>  <span class="n">SourceSideOutletTemp</span> <span class="o">=</span> <span class="n">SourceSideInletTemp</span> <span class="o">-</span> <span class="n">QSource</span><span class="o">/</span><span class="p">(</span><span class="n">SourceSideMassFlowRate</span> <span class="o">*</span> <span class="n">CpSourceSide</span> <span class="p">)</span>
<a name="ln-3504"></a>
<a name="ln-3505"></a>  <span class="n">ReportingConstant</span> <span class="o">=</span> <span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3506"></a>
<a name="ln-3507"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Power</span>                 <span class="o">=</span> <span class="n">Power</span>
<a name="ln-3508"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Energy</span>                <span class="o">=</span> <span class="n">Power</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3509"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span>               <span class="o">=</span> <span class="n">QSource</span>
<a name="ln-3510"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoad</span>                 <span class="o">=</span> <span class="n">QLoad</span>
<a name="ln-3511"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSourceEnergy</span>         <span class="o">=</span> <span class="n">QSource</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3512"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoadEnergy</span>           <span class="o">=</span> <span class="n">QLoad</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3513"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletTemp</span>    <span class="o">=</span> <span class="n">LoadSideOutletTemp</span>
<a name="ln-3514"></a>  <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletTemp</span>  <span class="o">=</span> <span class="n">SourceSideOutletTemp</span>
<a name="ln-3515"></a>  <span class="k">RETURN</span>
<a name="ln-3516"></a><span class="k">END SUBROUTINE </span><span class="n">CalcWatertoWaterHPHeating</span>
<a name="ln-3517"></a>
<a name="ln-3518"></a>
<a name="ln-3519"></a><span class="k">SUBROUTINE </span><span class="n">UpdateGSHPRecords</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)</span>
<a name="ln-3520"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3521"></a>            <span class="c">!       AUTHOR:          Kenneth Tang</span>
<a name="ln-3522"></a>            <span class="c">!       DATE WRITTEN:    March 2005</span>
<a name="ln-3523"></a>
<a name="ln-3524"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3525"></a>            <span class="c">! reporting</span>
<a name="ln-3526"></a>
<a name="ln-3527"></a>
<a name="ln-3528"></a>            <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-3529"></a>
<a name="ln-3530"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-3531"></a>
<a name="ln-3532"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-3533"></a>
<a name="ln-3534"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-3535"></a>
<a name="ln-3536"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3537"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">GSHPNum</span>       <span class="c">! GSHP number</span>
<a name="ln-3538"></a>
<a name="ln-3539"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3540"></a>          <span class="c">! na</span>
<a name="ln-3541"></a>
<a name="ln-3542"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3543"></a>          <span class="c">! na</span>
<a name="ln-3544"></a>
<a name="ln-3545"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3546"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">SourceSideInletNode</span>      <span class="c">! Source Side inlet node number, water side</span>
<a name="ln-3547"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">SourceSideOutletNode</span>     <span class="c">! Source Side outlet node number, water side</span>
<a name="ln-3548"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">LoadSideInletNode</span>        <span class="c">! Load Side inlet node number, water side</span>
<a name="ln-3549"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">LoadSideOutletNode</span>       <span class="c">! Load Side outlet node number, water side</span>
<a name="ln-3550"></a>
<a name="ln-3551"></a>    <span class="n">LoadSideInletNode</span>    <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletNodeNum</span>
<a name="ln-3552"></a>    <span class="n">LoadSideOutletNode</span>   <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletNodeNum</span>
<a name="ln-3553"></a>    <span class="n">SourceSideInletNode</span>  <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletNodeNum</span>
<a name="ln-3554"></a>    <span class="n">SourceSideOutletNode</span> <span class="o">=</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletNodeNum</span>
<a name="ln-3555"></a>
<a name="ln-3556"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">GSHP</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">MustRun</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-3557"></a>  <span class="c">! Heatpump is off; just pass through conditions</span>
<a name="ln-3558"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Power</span>                <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3559"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">Energy</span>               <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3560"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSource</span>              <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3561"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QSourceEnergy</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3562"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoad</span>                <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3563"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">QLoadEnergy</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3564"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletTemp</span>   <span class="o">=</span> <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideInletTemp</span>
<a name="ln-3565"></a>    <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletTemp</span> <span class="o">=</span> <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideInletTemp</span>
<a name="ln-3566"></a>  <span class="k">END IF</span>
<a name="ln-3567"></a>
<a name="ln-3568"></a><span class="k">  </span><span class="n">Node</span><span class="p">(</span><span class="n">SourceSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>          <span class="o">=</span> <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">SourceSideOutletTemp</span>
<a name="ln-3569"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">LoadSideOutletNode</span><span class="p">)%</span><span class="n">Temp</span>            <span class="o">=</span> <span class="n">GSHPReport</span><span class="p">(</span><span class="n">GSHPNum</span><span class="p">)%</span><span class="n">LoadSideOutletTemp</span>
<a name="ln-3570"></a><span class="k">RETURN</span>
<a name="ln-3571"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateGSHPRecords</span>
<a name="ln-3572"></a>
<a name="ln-3573"></a><span class="k">END MODULE </span><span class="n">HeatPumpWaterToWaterSimple</span>
<a name="ln-3574"></a>
<a name="ln-3575"></a><span class="c">!     NOTICE</span>
<a name="ln-3576"></a><span class="c">!</span>
<a name="ln-3577"></a><span class="c">!     Copyright © 1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-3578"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-3579"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-3580"></a><span class="c">!</span>
<a name="ln-3581"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-3582"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-3583"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-3584"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-3585"></a><span class="c">!</span>
<a name="ln-3586"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-3587"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-3588"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-3589"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-3590"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-3591"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-3592"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-3593"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-3594"></a><span class="c">!     permit others to do so.</span>
<a name="ln-3595"></a><span class="c">!</span>
<a name="ln-3596"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-3597"></a><span class="c">!</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
