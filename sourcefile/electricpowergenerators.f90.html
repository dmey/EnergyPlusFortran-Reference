<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>ElectricPowerGenerators.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>ElectricPowerGenerators.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 1.8% of total for source files.">6817 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/ElectricPowerGenerators.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">ElectricPowerGenerators.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/generatorfuelsupply.html">GeneratorFuelSupply</a>

      <a class="list-group-item" href="../module/generatordynamicsmanager.html">GeneratorDynamicsManager</a>

      <a class="list-group-item" href="../module/microchpelectricgenerator.html">MicroCHPElectricGenerator</a>

      <a class="list-group-item" href="../module/fuelcellelectricgenerator.html">FuelCellElectricGenerator</a>

      <a class="list-group-item" href="../module/icengineelectricgenerator.html">ICEngineElectricGenerator</a>

      <a class="list-group-item" href="../module/ctelectricgenerator.html">CTElectricGenerator</a>

      <a class="list-group-item" href="../module/microturbineelectricgenerator.html">MicroturbineElectricGenerator</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html#src">ElectricPowerGenerators.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~electricpowergenerators.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileelectricpowergeneratorsf90EfferentGraph" width="641pt" height="826pt"
 viewBox="0.00 0.00 641.00 825.61" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph" class="graph" transform="scale(.2824 .2824) rotate(0) translate(4 2919.4714)">
<title>sourcefile~~electricpowergenerators.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2919.4714 2265.762,-2919.4714 2265.762,4 -4,4"/>
<!-- sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~electricpowergenerators.f90</title>
<polygon fill="none" stroke="#000000" points="2261.874,-256.1958 2115.4263,-256.1958 2115.4263,-234.185 2261.874,-234.185 2261.874,-256.1958"/>
<text text-anchor="middle" x="2188.6501" y="-242.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">ElectricPowerGenerators.f90</text>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="658.8752,-635.1958 543.4891,-635.1958 543.4891,-613.185 658.8752,-613.185 658.8752,-635.1958"/>
<text text-anchor="middle" x="601.1821" y="-621.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M602.2859,-613.1179C607.1576,-570.5066 630.7074,-415.8259 721.3989,-342.1904 826.2462,-257.0614 1784.3242,-115.3008 1918.4414,-131.1904"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="829.3535,-1400.1958 762.616,-1400.1958 762.616,-1378.185 829.3535,-1378.185 829.3535,-1400.1958"/>
<text text-anchor="middle" x="795.9847" y="-1386.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M659.073,-631.1512C669.248,-634.9638 678.7062,-640.6777 685.3989,-649.1904 783.7257,-774.2565 625.2662,-1237.4301 721.3989,-1364.1904 728.9422,-1374.1369 740.6075,-1380.1677 752.4897,-1383.811"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="751.8816,-1387.2678 762.436,-1386.3434 753.6088,-1380.4842 751.8816,-1387.2678"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1844.63,-617.1958 1717.6246,-617.1958 1717.6246,-595.185 1844.63,-595.185 1844.63,-617.1958"/>
<text text-anchor="middle" x="1781.1273" y="-603.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M603.1127,-613.173C610.3976,-575.3762 640.0637,-450.641 721.3989,-402.1904 945.5221,-268.6824 1048.3028,-405.1202 1307.4386,-435.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-435.1904C1451.1347,-443.172 1496.2158,-441.6334 1622.2083,-511.1904"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-1930.1958 344.7839,-1930.1958 344.7839,-1908.185 453.3838,-1908.185 453.3838,-1930.1958"/>
<text text-anchor="middle" x="399.0839" y="-1916.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M453.2447,-1926.7295C463.6673,-1930.472 473.6115,-1936.0114 480.9653,-1944.1904 537.5539,-2007.1284 476.5857,-2056.8067 516.9653,-2131.1904 758.7422,-2576.5696 966.9757,-2824.8971 1469.339,-2758.1904"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1029.0877,-1550.1958 930.3078,-1550.1958 930.3078,-1528.185 1029.0877,-1528.185 1029.0877,-1550.1958"/>
<text text-anchor="middle" x="979.6978" y="-1536.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#2cff00" stroke-dasharray="5,2" d="M601.1821,-1808.1904C636.2301,-1779.6527 660.4792,-1788.8967 685.3989,-1751.1904 731.5833,-1681.3084 678.7112,-1638.2616 721.3989,-1566.1904 743.3668,-1529.1014 754.9073,-1517.2604 795.9847,-1504.1904"/>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1203.0723,-1970.1958 1088.7424,-1970.1958 1088.7424,-1948.185 1203.0723,-1948.185 1203.0723,-1970.1958"/>
<text text-anchor="middle" x="1145.9073" y="-1956.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M979.6978,-1960.1904C1012.0097,-1964.9885 1048.2458,-1965.3477 1078.6171,-1964.2554"/>
<polygon fill="#0016ff" stroke="#0016ff" points="1078.8333,-1967.7495 1088.6779,-1963.8337 1078.5401,-1960.7556 1078.8333,-1967.7495"/>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M601.1821,-1808.1904C658.931,-1761.1686 835.5764,-1923.7001 906.5706,-1946.1904 938.1167,-1956.1839 946.9654,-1955.3299 979.6978,-1960.1904"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M601.1821,-1808.1904C636.2301,-1779.6527 662.1186,-1789.9304 685.3989,-1751.1904 762.9863,-1622.0797 627.0473,-1531.6091 721.3989,-1414.1904 729.1514,-1404.5426 740.7621,-1398.5926 752.5278,-1394.9313"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="753.5743,-1398.2754 762.3661,-1392.3632 751.8063,-1391.5024 753.5743,-1398.2754"/>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M444.7155,-1908.1157C456.8046,-1904.4191 469.6372,-1899.7839 480.9653,-1894.1904 539.8697,-1865.1053 550.2398,-1849.6699 601.1821,-1808.1904"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="650.7412,-1742.1958 551.623,-1742.1958 551.623,-1720.185 650.7412,-1720.185 650.7412,-1742.1958"/>
<text text-anchor="middle" x="601.1821" y="-1728.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M453.5891,-1910.2923C463.6198,-1906.6298 473.3219,-1901.4666 480.9653,-1894.1904 515.1786,-1861.6211 488.8679,-1832.162 516.9653,-1794.1904 531.301,-1774.8168 553.2419,-1758.6732 571.1346,-1747.5792"/>
<polygon fill="#ff0042" stroke="#ff0042" points="573.2703,-1750.3804 580.0606,-1742.2477 569.6807,-1744.3708 573.2703,-1750.3804"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1523.0647,-1929.1958 1415.6133,-1929.1958 1415.6133,-1907.185 1523.0647,-1907.185 1523.0647,-1929.1958"/>
<text text-anchor="middle" x="1469.339" y="-1915.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M453.4055,-1926.5314C546.1334,-1938.736 741.0073,-1962.966 906.5706,-1974.1904 987.4174,-1979.6714 1007.8001,-1978.0792 1088.825,-1979.1904 1139.5601,-1979.8862 1152.2551,-1979.9239 1202.9897,-1979.1904 1279.8573,-1978.0792 1302.0997,-1995.7592 1375.8875,-1974.1904 1402.7221,-1966.3464 1429.7235,-1948.8911 1447.753,-1935.5386"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1450.0108,-1938.2185 1455.8431,-1929.3734 1445.7679,-1932.6509 1450.0108,-1938.2185"/>
</g>
<!-- sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~plantutilities.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/plantutilities.f90.html" xlink:title="PlantUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2079.6809,-256.1958 1992.1116,-256.1958 1992.1116,-234.185 2079.6809,-234.185 2079.6809,-256.1958"/>
<text text-anchor="middle" x="2035.8962" y="-242.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2079.6694,-245.1904C2087.8043,-245.1904 2096.5467,-245.1904 2105.4135,-245.1904"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2105.4514,-248.6905 2115.4514,-245.1904 2105.4513,-241.6905 2105.4514,-248.6905"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-673.1958 358.7923,-673.1958 358.7923,-651.185 439.3754,-651.185 439.3754,-673.1958"/>
<text text-anchor="middle" x="399.0839" y="-659.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-131.1904C874.2324,-107.8653 898.0523,-130.3041 979.6978,-131.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-321.1904C629.3906,-294.3755 653.9592,-320.1317 685.3989,-297.1904 757.0109,-244.9359 711.029,-156.5151 795.9847,-131.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.4623,-657.3813C454.0432,-653.8529 469.674,-647.7475 480.9653,-637.1904 590.7275,-534.5666 492.2732,-424.7192 601.1821,-321.1904"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M1781.1273,-245.1904C1844.3824,-240.3212 1857.6828,-187.9337 1918.4414,-206.1904"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1956.0678,-256.1958 1880.815,-256.1958 1880.815,-234.185 1956.0678,-234.185 1956.0678,-256.1958"/>
<text text-anchor="middle" x="1918.4414" y="-242.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#6e00ff" stroke-dasharray="5,2" d="M1781.1273,-245.1904C1810.8328,-243.0917 1844.2433,-243.0412 1870.67,-243.5397"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="1870.7248,-247.0416 1880.7997,-243.7637 1870.8796,-240.0433 1870.7248,-247.0416"/>
<path fill="none" stroke="#6e00ff" stroke-dasharray="5,2" d="M795.9847,-131.1904C848.1137,-115.9476 854.6286,-167.3221 906.5706,-183.1904 1078.9861,-235.8635 1127.1567,-245.1904 1307.4386,-245.1904 1307.4386,-245.1904 1307.4386,-245.1904 1469.339,-245.1904 1607.9116,-245.1904 1642.8993,-254.9563 1781.1273,-245.1904"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M439.2848,-664.7642C454.7566,-667.9263 471.0698,-674.3626 480.9653,-687.1904 542.5687,-767.0477 487.6014,-1497.7025 516.9653,-1594.1904 531.0715,-1640.5423 564.7531,-1687.0072 584.988,-1712.1318"/>
<polygon fill="#ff0042" stroke="#ff0042" points="582.4775,-1714.5895 591.5305,-1720.0935 587.8858,-1710.1453 582.4775,-1714.5895"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1622.2083,-511.1904C1670.2576,-536.7323 1724.2533,-570.0366 1755.319,-589.6675"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1753.5015,-592.6594 1763.8207,-595.0606 1757.2513,-586.7484 1753.5015,-592.6594"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-321.1904C677.3905,-250.9368 1432.6091,-393.9105 1526.7905,-437.1904 1575.5547,-459.5994 1574.8208,-486.0004 1622.2083,-511.1904"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-1207.1958 350.2841,-1207.1958 350.2841,-1185.185 447.8836,-1185.185 447.8836,-1207.1958"/>
<text text-anchor="middle" x="399.0839" y="-1193.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.0511,-1187.9145C459.7221,-1184.2233 471.5182,-1178.8909 480.9653,-1171.1904 506.8646,-1150.0795 488.8149,-1123.1903 516.9653,-1105.1904 606.3061,-1048.0642 1363.9994,-1030.9939 1469.339,-1043.1904"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M601.1821,-1005.1904C632.5636,-970.9049 655.5571,-978.824 685.3989,-943.1904 708.6252,-915.4563 692.0288,-891.31 721.3989,-870.1904 781.3644,-827.0701 979.3625,-837.5428 1052.825,-845.1904 1267.7146,-867.5609 1326.0751,-873.2447 1526.7905,-953.1904 1571.6589,-971.0617 1573.9626,-1007.4059 1622.2083,-1005.1904"/>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M1622.2083,-1005.1904C1769.7356,-993.6324 1814.8361,-958.8494 1918.4414,-853.1904"/>
</g>
<!-- sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~outairnodemanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/outairnodemanager.f90.html" xlink:title="OutAirNodeManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1843.8666,-1775.1958 1718.3881,-1775.1958 1718.3881,-1753.185 1843.8666,-1753.185 1843.8666,-1775.1958"/>
<text text-anchor="middle" x="1781.1273" y="-1761.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutAirNodeManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M601.1821,-1233.1904C655.1488,-1254.547 664.5873,-1194.0627 721.3989,-1182.1904 865.5873,-1152.0586 911.6833,-1138.0329 1052.825,-1180.1904 1182.4952,-1218.9216 1172.8584,-1361.4264 1307.4386,-1347.1904"/>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M447.9404,-1199.69C489.8281,-1203.9535 551.1513,-1213.2419 601.1821,-1233.1904"/>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M1307.4386,-1347.1904C1359.1322,-1343.0826 1362.1634,-1309.9082 1411.8875,-1295.1904 1502.1011,-1268.4881 1548.0704,-1213.2672 1622.2083,-1271.1904"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#2cff00" stroke-dasharray="5,2" d="M601.1821,-1233.1904C644.4842,-1250.079 658.3539,-1257.3902 685.3989,-1295.1904 716.3157,-1338.4022 682.783,-1372.6949 721.3989,-1409.1904 746.2605,-1432.6869 764.7659,-1414.2061 795.9847,-1428.1904"/>
<path fill="none" stroke="#2cff00" stroke-dasharray="5,2" d="M795.9847,-1428.1904C827.7651,-1442.4263 843.4498,-1430.3475 870.5706,-1452.1904 895.3866,-1472.1772 881.9364,-1493.9799 906.5706,-1514.1904 911.1557,-1517.9522 916.3376,-1521.1602 921.7736,-1523.8936"/>
<polygon fill="#2cff00" stroke="#2cff00" points="920.5432,-1527.1772 931.1013,-1528.0595 923.3978,-1520.7857 920.5432,-1527.1772"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1034.8358,-1628.1958 924.5597,-1628.1958 924.5597,-1606.185 1034.8358,-1606.185 1034.8358,-1628.1958"/>
<text text-anchor="middle" x="979.6978" y="-1614.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff58" stroke-dasharray="5,2" d="M601.1821,-1233.1904C644.4842,-1250.079 659.6102,-1256.5222 685.3989,-1295.1904 722.7202,-1351.1508 681.0139,-1388.3992 721.3989,-1442.1904 767.3457,-1503.3895 808.1509,-1483.9161 870.5706,-1528.1904 887.7927,-1540.4061 890.2958,-1545.7383 906.5706,-1559.1904 923.3802,-1573.0845 942.7268,-1588.4002 957.2969,-1599.8025"/>
<polygon fill="#00ff58" stroke="#00ff58" points="955.2315,-1602.6303 965.2683,-1606.0235 959.5381,-1597.1119 955.2315,-1602.6303"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1201.7241,-2502.1958 1090.0905,-2502.1958 1090.0905,-2480.185 1201.7241,-2480.185 1201.7241,-2502.1958"/>
<text text-anchor="middle" x="1145.9073" y="-2488.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M423.8274,-1207.2873C443.0424,-1217.3452 468.4548,-1234.1299 480.9653,-1257.1904 540.9586,-1367.7753 468.0324,-1706.2863 516.9653,-1822.1904 569.6445,-1946.9679 628.8384,-1949.3114 721.3989,-2048.1904 786.5196,-2117.7565 821.7687,-2120.3459 870.5706,-2202.1904 897.7821,-2247.8264 876.832,-2272.1594 906.5706,-2316.1904 965.2879,-2403.1274 999.4271,-2411.2925 1088.825,-2466.1904 1094.5856,-2469.7279 1100.9348,-2473.028 1107.2421,-2475.9957"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="1105.823,-2479.1951 1116.3795,-2480.0949 1108.6882,-2472.8083 1105.823,-2479.1951"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1195.4562,-1359.1958 1096.3585,-1359.1958 1096.3585,-1337.185 1195.4562,-1337.185 1195.4562,-1359.1958"/>
<text text-anchor="middle" x="1145.9073" y="-1345.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ffdd" stroke-dasharray="5,2" d="M601.1821,-1233.1904C651.7641,-1253.2075 667.9515,-1220.3193 721.3989,-1210.1904 754.5373,-1203.9103 762.2571,-1196.012 795.9847,-1196.1904"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1052.9524,-1323.1958 906.4431,-1323.1958 906.4431,-1301.185 1052.9524,-1301.185 1052.9524,-1323.1958"/>
<text text-anchor="middle" x="979.6978" y="-1309.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0058ff" stroke-dasharray="5,2" d="M795.9847,-1312.1904C828.6164,-1316.781 864.8323,-1317.6662 896.4242,-1317.0892"/>
<polygon fill="#0058ff" stroke="#0058ff" points="896.593,-1320.5863 906.5084,-1316.8533 896.4293,-1313.5882 896.593,-1320.5863"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M979.6978,-1846.1904C1005.5668,-1866.8258 1026.4996,-1840.1403 1052.825,-1860.1904 1081.6037,-1882.1091 1062.855,-1908.007 1088.825,-1933.1904 1092.8315,-1937.0756 1097.5216,-1940.4473 1102.4611,-1943.3553"/>
<polygon fill="#0016ff" stroke="#0016ff" points="1101.0445,-1946.5642 1111.5275,-1948.0997 1104.2901,-1940.362 1101.0445,-1946.5642"/>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M424.862,-1207.2721C493.6549,-1236.9508 676.9483,-1316.761 685.3989,-1328.1904 756.3247,-1424.1176 644.8177,-1502.7147 721.3989,-1594.1904 766.1064,-1647.5931 820.7862,-1593.486 870.5706,-1642.1904 905.5345,-1676.3959 883.8827,-1702.8574 906.5706,-1746.1904 932.1097,-1794.9692 936.6545,-1811.8554 979.6978,-1846.1904"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M601.1821,-1233.1904C637.4418,-1247.3323 657.2402,-1230.3232 685.3989,-1257.1904 721.7007,-1291.8272 685.8997,-1328.7315 721.3989,-1364.1904 729.8437,-1372.6256 741.2157,-1378.2151 752.5319,-1381.9188"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="751.8116,-1385.3525 762.3871,-1384.7122 753.7206,-1378.6178 751.8116,-1385.3525"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#6e00ff" stroke-dasharray="5,2" d="M448.0398,-1190.7432C460.4174,-1187.0577 472.565,-1181.0214 480.9653,-1171.1904 555.6052,-1083.839 441.5116,-1001.8398 516.9653,-915.1904 568.0832,-856.4878 634.184,-925.8084 685.3989,-867.1904 759.2589,-782.6541 655.811,-708.2942 721.3989,-617.1904 764.7551,-556.9671 811.0119,-586.4551 870.5706,-542.1904 889.2428,-528.313 885.8352,-514.7393 906.5706,-504.1904 1002.1708,-455.555 1038.6469,-473.1904 1145.9073,-473.1904 1145.9073,-473.1904 1145.9073,-473.1904 1469.339,-473.1904 1538.6253,-473.1904 1720.2776,-506.325 1781.1273,-473.1904"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1681.5438,-1700.1958 1562.8727,-1700.1958 1562.8727,-1678.185 1681.5438,-1678.185 1681.5438,-1700.1958"/>
<text text-anchor="middle" x="1622.2083" y="-1686.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M601.1821,-1233.1904C656.7071,-1255.1636 665.4322,-1272.3681 721.3989,-1293.1904 753.4598,-1305.1186 762.1104,-1307.425 795.9847,-1312.1904"/>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1307.4386,-1499.1904C1344.3212,-1496.8696 1437.2475,-1442.8641 1469.339,-1461.1904"/>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M795.9847,-1312.1904C845.4443,-1319.1483 856.8237,-1296.6527 906.5706,-1292.1904 971.3126,-1286.3831 1000.7621,-1253.2711 1052.825,-1292.1904 1098.1051,-1326.0394 1058.1184,-1366.7229 1088.825,-1414.1904 1106.9854,-1442.2636 1120.3313,-1441.6551 1145.9073,-1463.1904"/>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1145.9073,-1463.1904C1174.323,-1486.5369 1270.7347,-1501.5 1307.4386,-1499.1904"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1029.825,-1131.1958 929.5705,-1131.1958 929.5705,-1109.185 1029.825,-1109.185 1029.825,-1131.1958"/>
<text text-anchor="middle" x="979.6978" y="-1117.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0085" stroke-dasharray="5,2" d="M438.531,-1185.1199C452.0902,-1181.058 467.2938,-1176.2164 480.9653,-1171.1904 535.604,-1151.1038 543.5265,-1127.2328 601.1821,-1119.1904"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M423.1799,-1207.2284C442.2857,-1217.3483 467.8765,-1234.2488 480.9653,-1257.1904 555.6101,-1388.0244 468.3261,-1451.6295 516.9653,-1594.1904 532.6104,-1640.0458 565.7445,-1686.6874 585.4671,-1711.9773"/>
<polygon fill="#ff0042" stroke="#ff0042" points="582.8741,-1714.3403 591.8332,-1719.9959 588.3564,-1709.9877 582.8741,-1714.3403"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="669.6908,-1359.1958 532.6734,-1359.1958 532.6734,-1337.185 669.6908,-1337.185 669.6908,-1359.1958"/>
<text text-anchor="middle" x="601.1821" y="-1345.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M418.5065,-1207.2831C436.3965,-1218.2245 462.8366,-1236.3081 480.9653,-1257.1904 502.8699,-1282.422 490.9843,-1302.1802 516.9653,-1323.1904 521.6756,-1326.9995 526.9516,-1330.2284 532.5043,-1332.9655"/>
<polygon fill="#ff0000" stroke="#ff0000" points="531.4932,-1336.3425 542.0593,-1337.1231 534.2862,-1329.9238 531.4932,-1336.3425"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1005.1904C633.1049,-971.4083 661.2345,-982.8939 685.3989,-943.1904 738.5066,-855.9314 666.183,-802.1309 721.3989,-716.1904 764.41,-649.2461 815.8094,-674.9201 870.5706,-617.1904 892.2356,-594.351 880.7993,-574.2695 906.5706,-556.1904 995.1774,-494.0309 1037.6716,-511.1904 1145.9073,-511.1904 1145.9073,-511.1904 1145.9073,-511.1904 1307.4386,-511.1904 1377.3874,-511.1904 1558.5245,-482.2557 1622.2083,-511.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.1287,-1189.2321C460.0694,-1185.5242 471.9755,-1179.8544 480.9653,-1171.1904 516.1846,-1137.2478 487.9623,-1106.5772 516.9653,-1067.1904 544.525,-1029.7637 569.8007,-1039.4759 601.1821,-1005.1904"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1463.1904C1266.9279,-1553.4526 1298.4632,-1583.5804 1375.8875,-1713.1904 1400.9716,-1755.1818 1391.71,-1772.633 1411.8875,-1817.1904 1425.1778,-1846.5392 1444.2455,-1878.578 1456.7096,-1898.5279"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1453.7857,-1900.4529 1462.0854,-1907.0381 1459.7038,-1896.7144 1453.7857,-1900.4529"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1375.8363,-2048.1958 1239.0409,-2048.1958 1239.0409,-2026.185 1375.8363,-2026.185 1375.8363,-2048.1958"/>
<text text-anchor="middle" x="1307.4386" y="-2034.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M601.1821,-1233.1904C636.4633,-1247.1524 659.0107,-1219.9258 685.3989,-1247.1904 769.8997,-1334.4973 643.5182,-1424.9303 721.3989,-1518.1904 766.0408,-1571.6479 817.5914,-1520.9819 870.5706,-1566.1904 897.4838,-1589.1562 887.1651,-1607.607 906.5706,-1637.1904 976.2126,-1743.3591 986.8666,-1781.5181 1088.825,-1857.1904 1110.9244,-1873.5924 1127.3448,-1860.8719 1145.9073,-1881.1904"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="846.1377,-939.1958 745.8318,-939.1958 745.8318,-917.185 846.1377,-917.185 846.1377,-939.1958"/>
<text text-anchor="middle" x="795.9847" y="-925.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-967.1904C1514.6711,-981.4801 1519.9055,-998.6948 1562.7905,-1019.1904 1588.4874,-1031.4714 1597.5776,-1028.8907 1622.2083,-1043.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1622.2083,-1043.1904C1921.8137,-1217.1312 1592.5031,-1646.7893 1918.4414,-1764.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1918.4414,-1764.1904C2070.4645,-1812.8755 2173.6614,-453.7932 2187.1467,-266.4791"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2190.6389,-266.7125 2187.8605,-256.4885 2183.6567,-266.2136 2190.6389,-266.7125"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M979.6978,-929.1904C1197.936,-933.0664 1268.118,-882.6145 1469.339,-967.1904"/>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M1469.339,-967.1904C1536.1098,-988.238 1552.3402,-1009.6396 1622.2083,-1005.1904"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M979.6978,-929.1904C1056.1249,-933.924 1273.6003,-1030.2219 1526.7905,-1194.1904 1572.5305,-1223.8121 1580.7879,-1235.7793 1622.2083,-1271.1904"/>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M1622.2083,-1271.1904C1700.6186,-1332.4516 1762.2216,-1656.206 1777.4813,-1742.8488"/>
<polygon fill="#6eff00" stroke="#6eff00" points="1774.0561,-1743.5813 1779.2183,-1752.8334 1780.9525,-1742.3814 1774.0561,-1743.5813"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#2cff00" stroke-dasharray="5,2" d="M798.9227,-939.3421C809.7276,-980.6621 847.812,-1129.0584 870.5706,-1253.1904 881.129,-1310.7796 869.3369,-1469.0057 906.5706,-1514.1904 910.6021,-1519.0829 915.6367,-1523.0211 921.1666,-1526.1905"/>
<polygon fill="#2cff00" stroke="#2cff00" points="919.666,-1529.3525 930.1912,-1530.5648 922.7192,-1523.0535 919.666,-1529.3525"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0058ff" stroke-dasharray="5,2" d="M801.2848,-939.2687C826.7422,-992.4802 936.6065,-1222.1203 970.0202,-1291.9622"/>
<polygon fill="#0058ff" stroke="#0058ff" points="966.9031,-1293.5569 974.3762,-1301.0672 973.2177,-1290.5359 966.9031,-1293.5569"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#6e00ff" stroke-dasharray="5,2" d="M807.5188,-917.08C845.4809,-880.8809 970.8522,-764.2397 1088.825,-687.1904 1151.452,-646.288 1168.9547,-637.463 1238.9897,-611.1904 1471.7823,-523.8617 1564.665,-595.5127 1781.1273,-473.1904"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M979.6978,-929.1904C1013.7731,-932.1841 1029.4838,-928.1848 1052.825,-953.1904 1097.2517,-1000.7853 1043.7822,-1048.178 1088.825,-1095.1904 1180.9653,-1191.36 1257.0848,-1120.9877 1375.8875,-1181.1904 1450.8651,-1219.185 1480.6766,-1224.9143 1526.7905,-1295.1904 1568.481,-1358.7253 1607.732,-1595.4284 1618.9936,-1667.9404"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="1615.579,-1668.7641 1620.5568,-1678.1168 1622.4979,-1667.7013 1615.579,-1668.7641"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-701.1904C1200.2286,-643.3615 1229.4289,-610.7172 1307.4386,-625.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M846.3297,-926.9373C883.2762,-926.3892 934.6525,-926.4005 979.6978,-929.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-929.1904C1057.4613,-934.0068 1123.5997,-724.9385 1145.9073,-701.1904"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1843.8539,-1755.3204C1867.8198,-1754.1983 1895.0035,-1755.7482 1918.4414,-1764.1904"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1015.7308,-1550.2335C1088.0099,-1573.3801 1254.1779,-1631.6631 1375.8875,-1713.1904 1423.7958,-1745.2819 1413.0584,-1790.6378 1469.339,-1803.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-1803.1904C1535.9425,-1816.6097 1555.0357,-1792.9948 1622.2083,-1803.1904"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1028.3901,-1528.1752C1037.1437,-1524.6908 1045.7276,-1520.1347 1052.825,-1514.1904 1078.1422,-1492.9865 1066.8084,-1473.8042 1088.825,-1449.1904 1130.3021,-1402.8203 1157.2815,-1410.3958 1202.9897,-1368.1904 1476.951,-1115.2238 1715.1217,-719.7506 1769.501,-626.4086"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1772.5891,-628.0602 1774.5773,-617.6536 1766.5334,-624.549 1772.5891,-628.0602"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataheatbalfansys.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataheatbalfansys.f90.html" xlink:title="DataHeatBalFanSys.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1369.5834,-27.1958 1245.2938,-27.1958 1245.2938,-5.185 1369.5834,-5.185 1369.5834,-27.1958"/>
<text text-anchor="middle" x="1307.4386" y="-13.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalFanSys.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2035.8962,-131.1904C2097.3615,-137.026 2150.3738,-194.9122 2174.6042,-225.8765"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2172.0807,-228.3404 2180.9189,-234.1832 2177.6534,-224.1041 2172.0807,-228.3404"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-55.1904C1636.175,-65.2015 1686.9933,-23.6423 1844.6287,-79.1904 1882.4765,-92.5274 1878.6775,-125.7898 1918.4414,-131.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1338.5744,-27.2902C1370.8056,-37.9213 1422.8575,-52.7063 1469.339,-55.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1918.4414,-131.1904C1970.281,-137.3321 1983.9278,-126.2565 2035.8962,-131.1904"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1035.0804,-1622.7043C1041.5867,-1625.1796 1047.7151,-1628.5717 1052.825,-1633.1904 1090.9866,-1667.6841 1053.9672,-1705.361 1088.825,-1743.1904 1107.4742,-1763.4295 1123.6418,-1751.0146 1145.9073,-1767.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1767.1904C1175.1611,-1788.443 1433.8925,-1796.0486 1469.339,-1803.1904"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M1145.9073,-1691.1904C1170.6005,-1699.711 1180.2298,-1692.371 1202.9897,-1705.1904 1222.705,-1716.2949 1218.3657,-1731.8819 1238.9897,-1741.1904 1316.7616,-1776.2924 1538.2848,-1780.6004 1622.2083,-1765.1904"/>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M1622.2083,-1765.1904C1649.9486,-1759.8102 1680.9282,-1758.5748 1708.1154,-1759.0289"/>
<polygon fill="#6eff00" stroke="#6eff00" points="1708.2516,-1762.5332 1718.3348,-1759.2806 1708.424,-1755.5354 1708.2516,-1762.5332"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M983.1701,-1628.4306C994.9404,-1666.9841 1033.6565,-1797.5817 1052.825,-1908.1904 1081.0371,-2070.9849 1059.3405,-2115.6215 1088.825,-2278.1904 1101.7587,-2349.5035 1126.7797,-2431.8261 1138.9378,-2469.8766"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="1135.737,-2471.355 1142.1383,-2479.7974 1142.3989,-2469.2058 1135.737,-2471.355"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ffdd" stroke-dasharray="5,2" d="M999.4557,-1606.0565C1015.913,-1595.8411 1038.8426,-1579.27 1052.825,-1559.1904 1082.2205,-1516.9764 1068.0681,-1496.2571 1088.825,-1449.1904 1101.8048,-1419.7582 1120.8058,-1387.7401 1133.2636,-1367.8175"/>
<polygon fill="#00ffdd" stroke="#00ffdd" points="1136.2507,-1369.6423 1138.6402,-1359.3204 1130.3354,-1365.8993 1136.2507,-1369.6423"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M983.475,-1628.3197C1002.3939,-1684.0389 1086.055,-1930.1443 1088.825,-1933.1904 1092.3073,-1937.0199 1096.4642,-1940.3236 1100.9253,-1943.1648"/>
<polygon fill="#0016ff" stroke="#0016ff" points="1099.3388,-1946.2871 1109.7816,-1948.0752 1102.7331,-1940.1651 1099.3388,-1946.2871"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1145.9073,-1691.1904C1282.4017,-1736.2836 1326.5428,-1672.6571 1469.339,-1689.1904"/>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1018.4724,-1628.2193C1029.8118,-1632.0333 1042.0491,-1636.741 1052.825,-1642.1904 1070.2082,-1650.9812 1071.7533,-1657.8087 1088.825,-1667.1904 1112.944,-1680.445 1119.8915,-1682.2134 1145.9073,-1691.1904"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1767.1904C1225.1702,-1824.7742 1211.783,-1896.0128 1307.4386,-1917.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1917.1904C1339.1071,-1924.2016 1375.1215,-1925.0953 1405.1293,-1923.9619"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1405.6484,-1927.4417 1415.4759,-1923.4832 1405.3248,-1920.4492 1405.6484,-1927.4417"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1145.9073,-1881.1904C1165.6293,-1902.778 1217.8856,-1953.9519 1238.9897,-1974.1904 1255.068,-1989.6092 1273.6909,-2006.7015 1287.449,-2019.188"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1285.1685,-2021.8447 1294.9314,-2025.9602 1289.8659,-2016.6547 1285.1685,-2021.8447"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M990.0286,-1628.4014C1005.8323,-1646.1381 1035.9491,-1682.3483 1052.825,-1718.1904 1080.0096,-1775.9268 1047.0773,-1808.9242 1088.825,-1857.1904 1106.8289,-1878.0055 1127.3448,-1860.8719 1145.9073,-1881.1904"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1151.6199,-2502.2542C1179.403,-2554.3628 1305.7463,-2772.2125 1469.339,-2758.1904"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1184.2809,-2480.1567C1219.6141,-2468.4431 1271.801,-2447.0348 1307.4386,-2414.1904"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1149.9003,-2479.9679C1171.1981,-2420.1081 1271.5163,-2138.1535 1299.925,-2058.3081"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1303.386,-2059.0218 1303.4406,-2048.4271 1296.791,-2056.6753 1303.386,-2059.0218"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1171.2008,-1337.1215C1181.1151,-1332.7805 1192.5872,-1327.7547 1202.9897,-1323.1904 1279.8559,-1289.4643 1315.7013,-1305.701 1375.8875,-1247.1904 1402.6864,-1221.1375 1382.9129,-1194.8 1411.8875,-1171.1904 1432.2613,-1154.589 1446.1458,-1169.5507 1469.339,-1157.1904"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M1195.5363,-1350.4189C1227.5622,-1351.2322 1270.0679,-1351.1435 1307.4386,-1347.1904"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1469.339,-1461.1904C1553.7936,-1506.2461 1599.8271,-1620.9533 1615.7405,-1668.2813"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="1612.4956,-1669.621 1618.9149,-1678.0498 1619.153,-1667.4576 1612.4956,-1669.621"/>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1191.1305,-1359.2486C1255.3762,-1375.9942 1375.6645,-1411.216 1469.339,-1461.1904"/>
</g>
<!-- sourcefile~datagenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~datagenerators.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/datagenerators.f90.html" xlink:title="DataGenerators.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="451.3026,-595.1958 346.8651,-595.1958 346.8651,-573.185 451.3026,-573.185 451.3026,-595.1958"/>
<text text-anchor="middle" x="399.0839" y="-581.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGenerators.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datagenerators.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~datagenerators.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-131.1904C1199.91,-128.9006 1249.4287,-43.4377 1469.339,-55.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.3006,-573.0109C410.1299,-530.4305 445.8158,-375.4464 516.9653,-269.1904 585.9807,-166.1216 605.9506,-124.5554 721.3989,-79.1904 783.1045,-54.9435 805.904,-64.5708 870.5706,-79.1904 922.9739,-91.0376 926.0016,-129.4054 979.6978,-131.1904"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1372.2591,-2540.1958 1242.6181,-2540.1958 1242.6181,-2518.185 1372.2591,-2518.185 1372.2591,-2540.1958"/>
<text text-anchor="middle" x="1307.4386" y="-2526.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1335.489,-2518.0849C1372.8604,-2505.3496 1437.9106,-2490.8053 1469.339,-2529.1904"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1317.3807,-2517.9877C1332.5374,-2500.262 1361.2068,-2464.0662 1375.8875,-2428.1904 1449.1831,-2249.0745 1465.2798,-2011.099 1468.5558,-1939.4636"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1472.0544,-1939.5677 1468.9782,-1929.4293 1465.0606,-1939.2732 1472.0544,-1939.5677"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M982.837,-1323.5386C992.7277,-1357.3202 1026.352,-1458.4014 1088.825,-1515.1904 1129.5544,-1552.2142 1152.3184,-1541.6948 1202.9897,-1563.1904 1279.9381,-1595.8332 1303.6451,-1595.1472 1375.8875,-1637.1904 1489.9872,-1703.5936 1496.0816,-1764.2006 1622.2083,-1803.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1622.2083,-1803.1904C1692.0392,-1813.7895 1724.438,-1845.3213 1781.1273,-1803.1904"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1145.9073,-1501.1904C1215.4111,-1519.1922 1235.7831,-1503.6993 1307.4386,-1499.1904"/>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M984.3273,-1323.4467C996.8877,-1352.7101 1034.3609,-1432.0342 1088.825,-1477.1904 1110.0113,-1494.756 1119.2653,-1494.29 1145.9073,-1501.1904"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M985.761,-1300.8943C999.945,-1273.9381 1035.404,-1203.3776 1052.825,-1140.1904 1105.8359,-947.9155 1009.3536,-846.562 1145.9073,-701.1904"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1960.1904C1536.5183,-2089.2365 1302.7728,-2325.7546 1469.339,-2529.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-2529.1904C1526.3907,-2598.8706 1549.6374,-2715.5168 1622.2083,-2662.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1622.2083,-2662.1904C1778.6433,-2547.2391 1625.317,-1918.9871 1781.1273,-1803.1904"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1163.9971,-1948.0708C1182.6782,-1936.6435 1212.7224,-1918.4208 1238.9897,-1903.1904 1369.9943,-1827.2313 1528.5365,-1740.2454 1592.9189,-1705.1256"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="1594.6152,-1708.1872 1601.7202,-1700.3278 1591.2648,-1702.041 1594.6152,-1708.1872"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1960.1904C1352.3026,-1985.4634 1412.6956,-1955.5715 1445.5776,-1934.8124"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1447.6295,-1937.6526 1454.0867,-1929.2529 1443.8007,-1931.7925 1447.6295,-1937.6526"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1191.7605,-1948.1567C1225.8665,-1942.5163 1272.3758,-1940.4387 1307.4386,-1960.1904"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1168.7082,-1970.2005C1196.5289,-1983.6345 1243.7438,-2006.4335 1275.256,-2021.6501"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1273.9657,-2024.9137 1284.4927,-2026.1103 1277.0096,-2018.6101 1273.9657,-2024.9137"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1727.1904C1374.8047,-1769.3849 1391.5973,-1786.6134 1469.339,-1803.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1500.1904C1012.9595,-1504.8031 1023.4449,-1502.9289 1052.825,-1519.1904 1072.0802,-1529.8479 1072.2004,-1538.7693 1088.825,-1553.1904 1182.6301,-1634.5625 1202.1974,-1661.273 1307.4386,-1727.1904"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M979.6978,-1500.1904C1069.2357,-1513.5717 1024.7264,-1392.1238 1088.825,-1328.1904 1186.9342,-1230.3339 1483.9195,-1013.9967 1622.2083,-1005.1904"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#2cff00" stroke-dasharray="5,2" d="M829.4758,-1393.7765C843.713,-1397.264 859.5381,-1403.3995 870.5706,-1414.1904 904.3397,-1447.22 872.9007,-1481.0597 906.5706,-1514.1904 910.798,-1518.3501 915.7457,-1521.8187 921.0391,-1524.7108"/>
<polygon fill="#2cff00" stroke="#2cff00" points="919.6717,-1527.9359 930.2074,-1529.0539 922.6685,-1521.6098 919.6717,-1527.9359"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff58" stroke-dasharray="5,2" d="M814.109,-1400.2942C830.9475,-1411.4728 855.6109,-1430.1817 870.5706,-1452.1904 898.7763,-1493.687 877.7282,-1518.1337 906.5706,-1559.1904 918.3282,-1575.9272 936.2698,-1590.2601 951.4386,-1600.4906"/>
<polygon fill="#00ff58" stroke="#00ff58" points="949.6863,-1603.5257 959.9816,-1606.0273 953.4934,-1597.6515 949.6863,-1603.5257"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M802.0113,-1400.3978C816.4565,-1427.8084 853.1469,-1500.7788 870.5706,-1566.1904 904.4547,-1693.3975 874.9991,-1732.3897 906.5706,-1860.1904 968.0182,-2108.9293 1099.1298,-2393.1512 1136.0496,-2470.7303"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="1132.9666,-2472.3962 1140.438,-2479.9081 1139.2818,-2469.3766 1132.9666,-2472.3962"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ffdd" stroke-dasharray="5,2" d="M979.6978,-1500.1904C1053.7829,-1507.2413 1028.9944,-1417.4467 1088.825,-1373.1904 1093.617,-1369.6458 1098.9902,-1366.4689 1104.4726,-1363.6658"/>
<polygon fill="#00ffdd" stroke="#00ffdd" points="1106.169,-1366.7354 1113.7186,-1359.302 1103.1813,-1360.405 1106.169,-1366.7354"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0058ff" stroke-dasharray="5,2" d="M829.716,-1378.8442C842.6232,-1374.6358 857.4019,-1369.512 870.5706,-1364.1904 897.69,-1353.2311 927.6262,-1338.7918 949.2736,-1327.9102"/>
<polygon fill="#0058ff" stroke="#0058ff" points="950.9643,-1330.9772 958.3033,-1323.3359 947.801,-1324.7328 950.9643,-1330.9772"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M979.6978,-1500.1904C1013.1268,-1503.3719 1031.1493,-1493.543 1052.825,-1519.1904 1112.4343,-1589.7222 1035.5395,-1857.7672 1088.825,-1933.1904 1091.4405,-1936.8925 1094.7146,-1940.0782 1098.3639,-1942.8173"/>
<polygon fill="#0016ff" stroke="#0016ff" points="1096.5098,-1945.7858 1106.8425,-1948.128 1100.2256,-1939.8535 1096.5098,-1945.7858"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#6e00ff" stroke-dasharray="5,2" d="M979.6978,-1500.1904C1082.2319,-1512.0368 1028.5966,-1379.0124 1088.825,-1295.1904 1210.8347,-1125.3852 1233.2449,-1061.8505 1411.8875,-953.1904 1582.8201,-849.2199 1714.4098,-981.0815 1844.6287,-829.1904 1882.0964,-785.4869 1910.7893,-366.3182 1917.1292,-266.4648"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="1920.6286,-266.5821 1917.7618,-256.3825 1913.6424,-266.1436 1920.6286,-266.5821"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M979.6978,-1500.1904C1053.2377,-1507.1894 1074.3948,-1482.6684 1145.9073,-1501.1904"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0085" stroke-dasharray="5,2" d="M812.4053,-1378.1656C828.673,-1366.6376 853.5539,-1347.3075 870.5706,-1326.1904 919.3162,-1265.6989 956.3153,-1180.1041 971.7773,-1141.0616"/>
<polygon fill="#ff0085" stroke="#ff0085" points="975.1942,-1141.9321 975.5592,-1131.3436 968.6707,-1139.3935 975.1942,-1141.9321"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M829.68,-1397.793C842.8581,-1401.8393 857.8347,-1407.3083 870.5706,-1414.1904 924.8979,-1443.5473 918.2237,-1494.3398 979.6978,-1500.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1500.1904C1060.765,-1507.9058 1030.8856,-1410.6129 1052.825,-1332.1904 1084.8474,-1217.7257 1038.0987,-1174.6821 1088.825,-1067.1904 1189.2314,-854.4238 1234.3927,-686.8892 1469.339,-699.1904"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-1727.1904C1379.0979,-1772.0739 1435.3309,-1859.0213 1458.2087,-1898.1972"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1455.2865,-1900.1374 1463.2956,-1907.0732 1461.3599,-1896.6567 1455.2865,-1900.1374"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M979.6978,-1500.1904C1013.1268,-1503.3719 1029.8401,-1494.7095 1052.825,-1519.1904 1110.4587,-1580.5755 1035.7501,-1639.8235 1088.825,-1705.1904 1123.5201,-1747.9209 1168.9331,-1709.9493 1202.9897,-1753.1904 1264.5645,-1831.3707 1191.7904,-1886.5786 1238.9897,-1974.1904 1248.9789,-1992.7324 1266.5528,-2008.7316 1281.392,-2019.9671"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1279.5844,-2022.9796 1289.7351,-2026.0152 1283.6929,-2017.3121 1279.5844,-2022.9796"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1923.0747,-234.0807C1936.2917,-204.3533 1977.0536,-125.6038 2035.8962,-131.1904"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M1956.2514,-245.1904C1964.4455,-245.1904 1973.2646,-245.1904 1981.9437,-245.1904"/>
<polygon fill="#ff8500" stroke="#ff8500" points="1982.0221,-248.6905 1992.0221,-245.1904 1982.022,-241.6905 1982.0221,-248.6905"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-2177.1958 -.2403,-2177.1958 -.2403,-2155.185 130.719,-2155.185 130.719,-2177.1958"/>
<text text-anchor="middle" x="65.2394" y="-2163.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-2796.1904C1337.861,-2789.5267 1345.5535,-2788.2458 1375.8875,-2781.1904 1417.5489,-2771.5004 1426.9745,-2764.0911 1469.339,-2758.1904"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-701.1904C431.9434,-683.4163 447.9147,-699.6066 480.9653,-682.1904 500.1675,-672.0717 498.0783,-659.8858 516.9653,-649.1904 524.3102,-645.0311 532.4154,-641.5018 540.6088,-638.5244"/>
<polygon fill="#ff0000" stroke="#ff0000" points="541.8718,-641.7922 550.2275,-635.2781 539.6333,-635.1598 541.8718,-641.7922"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-853.1904C280.0743,-805.0104 254.9656,-755.3168 317.2024,-715.1904 348.232,-695.1844 366.6103,-718.7558 399.0839,-701.1904"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff4200" stroke-dasharray="5,2" d="M223.8406,-1919.1904C259.4401,-1902.1694 303.9484,-1902.3951 339.2012,-1906.761"/>
<polygon fill="#ff4200" stroke="#ff4200" points="338.9681,-1910.2619 349.3528,-1908.1623 339.9253,-1903.3277 338.9681,-1910.2619"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M1307.4386,-169.1904C1577.5478,-136.7164 1657.8951,-127.9017 1918.4414,-206.1904"/>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M223.8406,-853.1904C302.0462,-786.8585 238.1856,-707.5539 317.2024,-642.1904 374.7748,-594.5659 431.0437,-659.7827 480.9653,-604.1904 569.8054,-505.2589 430.6065,-408.2951 516.9653,-307.1904 542.243,-277.5965 573.9058,-310.953 601.1821,-283.1904"/>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M601.1821,-283.1904C639.1221,-244.5741 654.9246,-239.9339 685.3989,-195.1904 706.8919,-163.6336 689.2378,-137.7681 721.3989,-117.1904 777.2445,-81.4586 807.8606,-95.6741 870.5706,-117.1904 889.7432,-123.7687 887.6031,-138.0419 906.5706,-145.1904 1073.5854,-208.1355 1129.0409,-174.6947 1307.4386,-169.1904"/>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M1918.4414,-206.1904C1947.2334,-210.6843 1978.4846,-221.3628 2001.5082,-230.4116"/>
<polygon fill="#ff8500" stroke="#ff8500" points="2000.2568,-233.6808 2010.8405,-234.1671 2002.8701,-227.1869 2000.2568,-233.6808"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ffc700" stroke-dasharray="5,2" d="M223.8406,-853.1904C288.12,-798.117 251.2458,-740.2437 317.2024,-687.1904 326.3392,-679.8411 337.6207,-674.6472 348.8573,-670.9783"/>
<polygon fill="#ffc700" stroke="#ffc700" points="350.0378,-674.2801 358.6654,-668.1307 348.0861,-667.5577 350.0378,-674.2801"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#f3ff00" stroke-dasharray="5,2" d="M223.8406,-853.1904C335.698,-757.3531 213.6086,-1066.4756 317.2024,-1171.1904 323.7275,-1177.7862 331.9389,-1182.6517 340.6261,-1186.2388"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="339.5876,-1189.5843 350.1823,-1189.6506 341.9414,-1182.9919 339.5876,-1189.5843"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#b1ff00" stroke-dasharray="5,2" d="M223.8406,-853.1904C288.6358,-798.3385 317.9189,-802.0782 399.0839,-777.1904"/>
<path fill="none" stroke="#b1ff00" stroke-dasharray="5,2" d="M399.0839,-777.1904C459.9866,-758.5157 629.198,-733.2012 685.3989,-763.1904 743.2724,-794.0721 776.1975,-870.1622 789.2964,-907.225"/>
<polygon fill="#b1ff00" stroke="#b1ff00" points="786.0771,-908.6306 792.6008,-916.9788 792.707,-906.3845 786.0771,-908.6306"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M1145.9073,-2796.1904C1207.6886,-2759.6238 1239.8718,-2820.4549 1307.4386,-2796.1904"/>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M1307.4386,-2796.1904C1480.0908,-2734.1877 1482.9842,-2648.6466 1622.2083,-2529.1904"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#2cff00" stroke-dasharray="5,2" d="M223.8406,-853.1904C412.4104,-693.5581 147.1754,-1221.9367 317.2024,-1401.1904 430.6574,-1520.8022 521.0746,-1459.4765 685.3989,-1446.1904 735.033,-1442.1774 750.5398,-1407.8335 795.9847,-1428.1904"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90</title>
<path fill="none" stroke="#00ff16" stroke-dasharray="5,2" d="M65.6983,-2154.9026C70.8107,-2031.9271 118.9126,-943.7846 223.8406,-853.1904"/>
<path fill="none" stroke="#00ff16" stroke-dasharray="5,2" d="M223.8406,-853.1904C326.0092,-764.9786 272.3585,-691.5041 317.2024,-564.1904 399.8677,-329.5004 318.2615,-190.956 516.9653,-41.1904 616.3612,33.7255 671.5182,-17.1904 795.9847,-17.1904 795.9847,-17.1904 795.9847,-17.1904 979.6978,-17.1904 1067.4645,-17.1904 1168.4512,-16.8274 1234.8637,-16.5388"/>
<polygon fill="#00ff16" stroke="#00ff16" points="1235.2339,-20.0373 1245.2184,-16.4932 1235.203,-13.0373 1235.2339,-20.0373"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff58" stroke-dasharray="5,2" d="M223.8406,-1919.1904C248.0698,-1907.6058 258.1447,-1924.4208 281.2024,-1938.1904 300.0974,-1949.4742 298.1143,-1961.2365 317.2024,-1972.1904 350.0941,-1991.0657 363.4033,-1983.3439 399.0839,-1996.1904"/>
<path fill="none" stroke="#00ff58" stroke-dasharray="5,2" d="M399.0839,-1996.1904C444.5941,-2012.576 667.9912,-2001.51 870.5706,-1822.1904 929.3235,-1770.1834 961.8131,-1678.779 974.0169,-1637.9309"/>
<polygon fill="#00ff58" stroke="#00ff58" points="977.3991,-1638.8338 976.8069,-1628.2555 970.6732,-1636.8943 977.3991,-1638.8338"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M223.8406,-2832.1904C293.904,-2866.2099 321.8843,-2842.5075 399.0839,-2832.1904"/>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M399.0839,-2832.1904C711.6891,-2790.4132 776.7378,-2708.6477 1052.825,-2556.1904 1078.329,-2542.1069 1105.4134,-2522.617 1123.7505,-2508.6591"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="1126.2194,-2511.1753 1132.0045,-2502.2993 1121.9469,-2505.6303 1126.2194,-2511.1753"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ffdd" stroke-dasharray="5,2" d="M223.8406,-853.1904C259.8279,-822.1937 272.8878,-888.0995 317.2024,-905.1904 386.9147,-932.0765 422.7834,-896.3125 480.9653,-943.1904 510.0695,-966.64 486.9692,-996.8932 516.9653,-1019.1904 613.6197,-1091.0371 960.7838,-1022.5216 1052.825,-1100.1904 1091.8159,-1133.0929 1071.1235,-1161.3415 1088.825,-1209.1904 1104.5666,-1251.7419 1125.2646,-1300.6297 1136.9197,-1327.6063"/>
<polygon fill="#00ffdd" stroke="#00ffdd" points="1133.8587,-1329.3446 1141.0503,-1337.1248 1140.2801,-1326.558 1133.8587,-1329.3446"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datagenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datagenerators.f90</title>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M223.8406,-853.1904C312.015,-777.6442 232.3113,-688.4082 317.2024,-609.1904 323.0094,-603.7715 329.9598,-599.5256 337.3233,-596.1991"/>
<polygon fill="#00ddff" stroke="#00ddff" points="338.796,-599.3808 346.8164,-592.4581 336.2295,-592.8682 338.796,-599.3808"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M223.8406,-2413.1904C285.5812,-2451.5044 807.3339,-2351.9813 870.5706,-2316.1904 1015.108,-2234.3848 1109.2012,-2042.9289 1137.1745,-1979.7925"/>
<polygon fill="#0016ff" stroke="#0016ff" points="1140.4452,-1981.048 1141.2288,-1970.4821 1134.0273,-1978.2531 1140.4452,-1981.048"/>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M68.5204,-2177.322C80.9795,-2217.3978 129.4964,-2355.0117 223.8406,-2413.1904"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M223.8406,-853.1904C350.3431,-744.8054 221.0187,-1080.1798 317.2024,-1216.1904 342.5148,-1251.9839 365.0239,-1243.5894 399.0839,-1271.1904"/>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M399.0839,-1271.1904C499.8886,-1352.8791 570.9761,-1267.0182 685.3989,-1328.1904 705.3537,-1338.8585 702.1608,-1352.2785 721.3989,-1364.1904 731,-1370.1353 742.1802,-1374.848 752.9178,-1378.5043"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="752.0062,-1381.8869 762.5963,-1381.5701 754.1202,-1375.2137 752.0062,-1381.8869"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#6e00ff" stroke-dasharray="5,2" d="M1307.4386,-169.1904C1517.5889,-144.8586 1767.9831,-203.57 1870.7989,-231.468"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="1870.0027,-234.8787 1880.5723,-234.1482 1871.854,-228.128 1870.0027,-234.8787"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-1852.1958 180.0456,-1852.1958 180.0456,-1830.185 267.6355,-1830.185 267.6355,-1852.1958"/>
<text text-anchor="middle" x="223.8406" y="-1838.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#f300ff" stroke-dasharray="5,2" d="M67.9925,-2155.1042C77.565,-2117.8114 111.8263,-1994.253 166.4788,-1905.1904 176.8494,-1888.2903 191.9104,-1871.69 203.9976,-1859.6323"/>
<polygon fill="#f300ff" stroke="#f300ff" points="206.7,-1861.8865 211.432,-1852.4071 201.8214,-1856.8666 206.7,-1861.8865"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1469.339,-1309.1904C1569.3932,-1420.4339 1608.2441,-1605.5095 1618.9094,-1667.9075"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="1615.5066,-1668.7851 1620.5813,-1678.0855 1622.414,-1667.6504 1615.5066,-1668.7851"/>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M399.0839,-777.1904C461.135,-762.6252 636.6591,-753.1183 685.3989,-794.1904 739.1491,-839.4846 673.9334,-896.3477 721.3989,-948.1904 826.11,-1062.5577 937.3259,-953.729 1052.825,-1057.1904 1081.5651,-1082.9352 1060.6733,-1109.8034 1088.825,-1136.1904 1188.3948,-1229.5189 1254.9448,-1181.9667 1375.8875,-1245.1904 1420.4999,-1268.5119 1435.6751,-1271.7618 1469.339,-1309.1904"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0085" stroke-dasharray="5,2" d="M795.9847,-1119.1904C835.5087,-1132.9062 882.7603,-1132.8292 919.4445,-1129.4929"/>
<polygon fill="#ff0085" stroke="#ff0085" points="919.8998,-1132.9648 929.4959,-1128.4742 919.1939,-1126.0004 919.8998,-1132.9648"/>
<path fill="none" stroke="#ff0085" stroke-dasharray="5,2" d="M223.8406,-853.1904C302.3494,-787.1121 604.4122,-776.1735 685.3989,-839.1904 736.7834,-879.1735 697.7399,-920.5335 721.3989,-981.1904 746.7334,-1046.1428 730.1196,-1096.3336 795.9847,-1119.1904"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M223.8406,-1919.1904C256.5494,-1903.5515 256.3217,-1887.5608 281.2024,-1861.1904 297.6162,-1843.7939 296.6025,-1833.3433 317.2024,-1821.1904 349.379,-1802.2079 364.3668,-1815.9887 399.0839,-1802.1904"/>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M66.9319,-2155.0769C73.0867,-2118.4893 97.649,-2000.5836 166.4788,-1938.1904 186.3766,-1920.1533 199.6113,-1930.775 223.8406,-1919.1904"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="868.5702,-747.1958 723.3993,-747.1958 723.3993,-725.185 868.5702,-725.185 868.5702,-747.1958"/>
<text text-anchor="middle" x="795.9847" y="-733.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-663.1904C665.1682,-662.8522 733.8903,-697.9455 770.1471,-719.5906"/>
<polygon fill="#ff0000" stroke="#ff0000" points="768.7043,-722.8106 779.0627,-725.0363 772.3531,-716.8368 768.7043,-722.8106"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="870.6565,-1284.1958 721.313,-1284.1958 721.313,-1262.185 870.6565,-1262.185 870.6565,-1284.1958"/>
<text text-anchor="middle" x="795.9847" y="-1270.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1195.1904C636.2743,-1212.0218 649.0559,-1205.264 685.3989,-1219.1904 713.9008,-1230.1122 745.03,-1245.6606 766.9783,-1257.2707"/>
<polygon fill="#ff0000" stroke="#ff0000" points="765.6119,-1260.5091 776.0807,-1262.1385 768.913,-1254.3363 765.6119,-1260.5091"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-853.1904C267.6079,-815.6913 275.5743,-903.3299 317.2024,-943.1904 439.0803,-1059.8932 449.0359,-1122.2158 601.1821,-1195.1904"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="647.8111,-2122.1958 554.5531,-2122.1958 554.5531,-2100.185 647.8111,-2100.185 647.8111,-2122.1958"/>
<text text-anchor="middle" x="601.1821" y="-2108.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1996.1904C434.2337,-2008.8458 447.9147,-1997.7742 480.9653,-2015.1904 500.1675,-2025.3091 500.2545,-2034.3391 516.9653,-2048.1904 536.5981,-2064.4636 559.8736,-2081.7309 576.9746,-2094.0646"/>
<polygon fill="#ff0000" stroke="#ff0000" points="575.1355,-2097.0526 585.3025,-2100.0332 579.2133,-2091.363 575.1355,-2097.0526"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-2483.1958 168.8556,-2483.1958 168.8556,-2461.185 278.8255,-2461.185 278.8255,-2483.1958"/>
<text text-anchor="middle" x="223.8406" y="-2469.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M67.3566,-2177.4025C75.006,-2215.6156 104.1149,-2343.0439 166.4788,-2427.1904 174.5453,-2438.0745 185.8936,-2447.7235 196.3695,-2455.2676"/>
<polygon fill="#ff0000" stroke="#ff0000" points="194.6444,-2458.3283 204.8728,-2461.0905 198.5994,-2452.5526 194.6444,-2458.3283"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-2463.1958 340.6161,-2463.1958 340.6161,-2441.185 457.5516,-2441.185 457.5516,-2463.1958"/>
<text text-anchor="middle" x="399.0839" y="-2449.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-2413.1904C255.6415,-2432.9249 296.1654,-2442.7267 330.2325,-2447.572"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.2122,-2451.099 340.581,-2448.9221 331.1179,-2444.1578 330.2122,-2451.099"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-2046.1958 334.3841,-2046.1958 334.3841,-2024.185 463.7837,-2024.185 463.7837,-2046.1958"/>
<text text-anchor="middle" x="399.0839" y="-2032.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1919.1904C248.0698,-1907.6058 260.8971,-1920.6133 281.2024,-1938.1904 308.2525,-1961.606 289.8787,-1987.0946 317.2024,-2010.1904 321.711,-2014.0014 326.7917,-2017.2317 332.1583,-2019.9696"/>
<polygon fill="#ff0000" stroke="#ff0000" points="330.8536,-2023.2204 341.4095,-2024.1282 333.7237,-2016.8358 330.8536,-2023.2204"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-2541.1958 323.0941,-2541.1958 323.0941,-2519.185 475.0737,-2519.185 475.0737,-2541.1958"/>
<text text-anchor="middle" x="399.0839" y="-2527.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2832.1904C328.2908,-2882.9065 246.0151,-2679.9201 317.2024,-2588.1904 330.6297,-2570.8885 350.6162,-2556.5923 367.4814,-2546.5225"/>
<polygon fill="#ff0000" stroke="#ff0000" points="369.5334,-2549.3805 376.4683,-2541.3707 366.052,-2543.3076 369.5334,-2549.3805"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M65.7176,-2177.4041C69.5203,-2259.8804 98.0749,-2771.1246 223.8406,-2832.1904"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-2619.1958 317.3208,-2619.1958 317.3208,-2597.185 480.847,-2597.185 480.847,-2619.1958"/>
<text text-anchor="middle" x="399.0839" y="-2605.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-2832.1904C247.1963,-2843.5308 350.4701,-2685.027 386.5729,-2628.115"/>
<polygon fill="#00ffff" stroke="#00ffff" points="389.7534,-2629.6337 392.1358,-2619.3102 383.8356,-2625.8948 389.7534,-2629.6337"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1271.1904C438.8665,-1303.4289 493.6171,-1323.1711 536.098,-1334.5821"/>
<polygon fill="#ff0000" stroke="#ff0000" points="535.2302,-1337.9728 545.7889,-1337.099 536.9899,-1331.1975 535.2302,-1337.9728"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-283.1904C753.7099,-142.7626 1335.3309,-320.6422 1526.7905,-400.1904 1601.78,-431.3473 1619.2716,-445.1701 1681.626,-497.1904 1715.1221,-525.1352 1748.0729,-564.1194 1766.3892,-587.1004"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1763.7268,-589.3768 1772.6631,-595.0682 1769.2264,-585.0462 1763.7268,-589.3768"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1526.7421,-749.1958 1411.9359,-749.1958 1411.9359,-727.185 1526.7421,-727.185 1526.7421,-749.1958"/>
<text text-anchor="middle" x="1469.339" y="-735.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-701.1904C409.1324,-695.755 589.7579,-663.2508 601.1821,-663.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-663.1904C900.5308,-661.608 1255.8004,-707.2811 1401.6947,-728.1025"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1401.4377,-731.6014 1411.8336,-729.5577 1402.4323,-724.6724 1401.4377,-731.6014"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2832.1904C267.996,-2853.6302 270.5352,-2875.9739 317.2024,-2891.1904 437.4661,-2930.4041 474.6867,-2910.1904 601.1821,-2910.1904 601.1821,-2910.1904 601.1821,-2910.1904 795.9847,-2910.1904 910.9644,-2910.1904 948.0342,-2926.5108 1052.825,-2879.1904 1103.3412,-2856.3788 1099.1355,-2825.9336 1145.9073,-2796.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-2796.1904C1241.2899,-2739.7362 1248.8306,-2700.2649 1307.4386,-2606.1904"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-2832.1904C695.2405,-2816.1184 809.482,-2867.7526 1052.825,-2698.1904 1111.1283,-2657.5645 1111.4832,-2630.3573 1145.9073,-2568.1904"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="470.9214,-2882.1958 327.2463,-2882.1958 327.2463,-2860.185 470.9214,-2860.185 470.9214,-2882.1958"/>
<text text-anchor="middle" x="399.0839" y="-2868.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M223.8406,-2832.1904C252.6837,-2846.1952 286.6436,-2855.2422 316.9507,-2861.0544"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="316.6099,-2864.55 327.076,-2862.904 317.8678,-2857.6639 316.6099,-2864.55"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.0438,-2766.1958 353.1239,-2766.1958 353.1239,-2744.185 445.0438,-2744.185 445.0438,-2766.1958"/>
<text text-anchor="middle" x="399.0839" y="-2752.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2832.1904C251.8302,-2845.7809 332.639,-2798.2887 374.0179,-2771.8039"/>
<polygon fill="#ff0000" stroke="#ff0000" points="375.959,-2774.7168 382.4532,-2766.3457 372.1561,-2768.8399 375.959,-2774.7168"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-1043.1904C1536.7832,-1051.3986 1564.2752,-1007.6959 1622.2083,-1043.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.1726,-1830.1249C226.7219,-1750.7162 245.071,-1267.2468 317.2024,-1143.1904 373.2794,-1046.7454 411.2506,-1026.8368 516.9653,-991.1904 717.8086,-923.4673 1258.9376,-1017.5839 1469.339,-1043.1904"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.0524,-1830.106C226.2211,-1721.5529 245.8024,-850.403 317.2024,-763.1904 365.2485,-704.5038 421.9082,-762.7804 480.9653,-715.1904 506.9825,-694.225 490.9843,-670.2006 516.9653,-649.1904 522.024,-645.0996 527.7351,-641.6779 533.7407,-638.816"/>
<polygon fill="#ff0000" stroke="#ff0000" points="535.5098,-641.8689 543.3691,-634.7638 532.7944,-635.417 535.5098,-641.8689"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff4200" stroke-dasharray="5,2" d="M248.577,-1852.2005C279.0195,-1865.7503 330.8668,-1888.8273 365.0497,-1904.042"/>
<polygon fill="#ff4200" stroke="#ff4200" points="363.631,-1907.2415 374.1902,-1908.1103 366.4775,-1900.8464 363.631,-1907.2415"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M399.0839,-891.1904C469.3278,-832.719 509.9147,-934.0266 601.1821,-929.1904"/>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M601.1821,-929.1904C640.0475,-927.131 655.3716,-929.9516 685.3989,-905.1904 712.6953,-882.6812 691.2507,-852.7062 721.3989,-834.1904 834.7497,-764.575 1824.3172,-947.1869 1918.4414,-853.1904"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ffc700" stroke-dasharray="5,2" d="M224.3913,-1829.8947C230.1144,-1713.4118 279.2805,-734.3163 317.2024,-687.1904 325.1432,-677.3223 336.8708,-671.2537 348.9841,-667.5487"/>
<polygon fill="#ffc700" stroke="#ffc700" points="349.8972,-670.9278 358.7164,-665.0565 348.1607,-664.1466 349.8972,-670.9278"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#b1ff00" stroke-dasharray="5,2" d="M601.1821,-929.1904C646.2908,-926.8002 697.3568,-926.6319 735.8848,-927.0176"/>
<polygon fill="#b1ff00" stroke="#b1ff00" points="735.8603,-930.5175 745.9,-927.1331 735.9411,-923.5179 735.8603,-930.5175"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M1622.2083,-2529.1904C1750.8225,-2424.5483 1615.7075,-1919.9735 1717.626,-1789.1904 1720.1352,-1785.9706 1723.1191,-1783.1646 1726.4046,-1780.7194"/>
<polygon fill="#6eff00" stroke="#6eff00" points="1728.424,-1783.5861 1735.0939,-1775.3543 1724.7464,-1777.6299 1728.424,-1783.5861"/>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M238.4187,-1852.3428C252.2352,-1863.8752 272.1772,-1883.25 281.2024,-1905.1904 311.8009,-1979.5757 262.8915,-2568.8628 317.2024,-2628.1904 417.565,-2737.8235 831.0638,-2720.1904 979.6978,-2720.1904 979.6978,-2720.1904 979.6978,-2720.1904 1145.9073,-2720.1904 1252.622,-2720.1904 1301.6729,-2727.873 1375.8875,-2651.1904 1419.3712,-2606.2605 1362.3397,-2553.329 1411.8875,-2515.1904 1452.3553,-2484.0408 1475.8579,-2511.4738 1526.7905,-2515.1904 1569.5388,-2518.3098 1588.9606,-2556.2411 1622.2083,-2529.1904"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#2cff00" stroke-dasharray="5,2" d="M601.1821,-1580.1904C691.638,-1558.8695 707.4248,-1532.3683 795.9847,-1504.1904"/>
<path fill="none" stroke="#2cff00" stroke-dasharray="5,2" d="M229.3227,-1829.9613C241.7978,-1805.4204 274.5593,-1746.3922 317.2024,-1711.1904 370.7978,-1666.9475 533.5383,-1596.1344 601.1821,-1580.1904"/>
<path fill="none" stroke="#2cff00" stroke-dasharray="5,2" d="M795.9847,-1504.1904C821.0624,-1496.2112 888.0445,-1512.3713 933.8057,-1525.299"/>
<polygon fill="#2cff00" stroke="#2cff00" points="932.9339,-1528.69 943.5112,-1528.0817 934.8632,-1521.9611 932.9339,-1528.69"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff58" stroke-dasharray="5,2" d="M601.1821,-1580.1904C685.4518,-1560.3276 710.3674,-1567.3222 795.9847,-1580.1904"/>
<path fill="none" stroke="#00ff58" stroke-dasharray="5,2" d="M795.9847,-1580.1904C838.3334,-1586.5554 885.7005,-1596.1564 921.7303,-1603.9832"/>
<polygon fill="#00ff58" stroke="#00ff58" points="921.061,-1607.4196 931.5783,-1606.1396 922.5583,-1600.5816 921.061,-1607.4196"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M795.9847,-2492.1904C877.1609,-2500.9761 899.4221,-2477.2714 979.6978,-2492.1904"/>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M399.0839,-2299.1904C473.9215,-2362.5786 698.479,-2481.6374 795.9847,-2492.1904"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ffdd" stroke-dasharray="5,2" d="M399.0839,-1157.1904C469.0972,-1102.8534 707.361,-1195.7217 795.9847,-1196.1904"/>
<path fill="none" stroke="#00ffdd" stroke-dasharray="5,2" d="M795.9847,-1196.1904C910.6753,-1196.3554 956.7474,-1158.5562 1052.825,-1221.1904 1080.1642,-1239.0132 1069.7491,-1258.7102 1088.825,-1285.1904 1100.2894,-1301.1049 1115.2333,-1317.4733 1126.955,-1329.536"/>
<polygon fill="#00ffdd" stroke="#00ffdd" points="1124.6059,-1332.1384 1134.1235,-1336.7931 1129.586,-1327.2191 1124.6059,-1332.1384"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datagenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datagenerators.f90</title>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M224.4449,-1829.8869C230.8234,-1711.2098 286.1627,-696.8959 317.2024,-642.1904 327.6477,-623.7813 346.6222,-609.7818 363.6771,-600.1528"/>
<polygon fill="#00ddff" stroke="#00ddff" points="365.7034,-603.0394 372.8881,-595.2528 362.4158,-596.8594 365.7034,-603.0394"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#009bff" stroke-dasharray="5,2" d="M238.3904,-1852.3545C252.1853,-1863.8958 272.1114,-1883.2772 281.2024,-1905.1904 308.7076,-1971.4895 265.0525,-2500.87 317.2024,-2550.1904 383.1121,-2612.524 1013.2263,-2557.8227 1232.5915,-2536.6788"/>
<polygon fill="#009bff" stroke="#009bff" points="1233.107,-2540.1453 1242.7231,-2535.6979 1232.4324,-2533.1779 1233.107,-2540.1453"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0058ff" stroke-dasharray="5,2" d="M399.0839,-1387.1904C425.376,-1369.1563 653.7224,-1371.8111 685.3989,-1368.1904 734.8729,-1362.5354 751.2082,-1371.9783 795.9847,-1350.1904"/>
<path fill="none" stroke="#0058ff" stroke-dasharray="5,2" d="M795.9847,-1350.1904C814.3912,-1341.4291 858.7228,-1332.1502 899.2249,-1324.9546"/>
<polygon fill="#0058ff" stroke="#0058ff" points="899.9012,-1328.3896 909.1486,-1323.2187 898.695,-1321.4943 899.9012,-1328.3896"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M233.8238,-1852.3708C255.7549,-1876.8271 306.9992,-1933.3644 317.2024,-1939.1904 349.6448,-1957.7149 365.8657,-1941.0959 399.0839,-1958.1904"/>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M399.0839,-1958.1904C513.8099,-2017.2299 851.354,-1946.9391 979.6978,-1960.1904"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M225.2159,-1830.1846C230.2669,-1794.5035 251.0841,-1680.9417 317.2024,-1622.1904 345.5506,-1597.0008 373.0232,-1625.74 399.0839,-1598.1904"/>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M399.0839,-1598.1904C498.0901,-1493.5273 567.0923,-1528.4105 685.3989,-1446.1904 702.9779,-1433.9735 702.875,-1424.9206 721.3989,-1414.1904 731.08,-1408.5825 742.203,-1404.0037 752.8537,-1400.3695"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="753.9924,-1403.68 762.4472,-1397.2952 751.8561,-1397.0139 753.9924,-1403.68"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#6e00ff" stroke-dasharray="5,2" d="M224.2795,-1830.1049C228.3839,-1728.4835 261.1493,-960.566 317.2024,-877.1904 363.0695,-808.9659 408.6677,-830.3239 480.9653,-791.1904 572.454,-741.6691 625.3967,-762.1743 685.3989,-677.1904 740.7742,-598.7598 653.4573,-532.0263 721.3989,-464.1904 733.6495,-451.9589 1108.2902,-397.1904 1145.9073,-397.1904 1145.9073,-397.1904 1145.9073,-397.1904 1469.339,-397.1904 1540.654,-397.1904 1718.8933,-508.0151 1781.1273,-473.1904"/>
<path fill="none" stroke="#6e00ff" stroke-dasharray="5,2" d="M1781.1273,-473.1904C1859.4471,-424.1604 1899.195,-312.6111 1912.8425,-266.1299"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="1916.2771,-266.8461 1915.628,-256.2712 1909.5408,-264.9428 1916.2771,-266.8461"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M237.9813,-1852.2011C251.6685,-1863.7649 271.6998,-1883.2898 281.2024,-1905.1904 317.4317,-1988.6882 268.9369,-2236.0225 317.2024,-2313.1904 372.124,-2401.0003 423.3458,-2388.8921 516.9653,-2433.1904 693.5389,-2516.7404 1223.5676,-2742.4912 1375.8875,-2620.1904 1383.4521,-2614.1166 1524.8254,-1947.6906 1526.7905,-1938.1904 1543.9347,-1855.3078 1523.9202,-1826.3739 1562.7905,-1751.1904 1571.6649,-1734.0256 1586.7836,-1718.3492 1599.5491,-1707.0538"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="1602.1534,-1709.4339 1607.5088,-1700.2922 1597.6214,-1704.099 1602.1534,-1709.4339"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0085" stroke-dasharray="5,2" d="M224.6493,-1830.0545C230.7728,-1747.0603 270.8627,-1226.8253 317.2024,-1176.1904 342.4242,-1148.6308 369.5707,-1180.0954 399.0839,-1157.1904"/>
<path fill="none" stroke="#ff0085" stroke-dasharray="5,2" d="M601.1821,-1119.1904C686.9309,-1107.2294 714.1909,-1090.806 795.9847,-1119.1904"/>
<path fill="none" stroke="#ff0085" stroke-dasharray="5,2" d="M399.0839,-1157.1904C471.2859,-1101.1548 510.6631,-1131.8169 601.1821,-1119.1904"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M399.0839,-1802.1904C451.3467,-1781.4185 463.7661,-1774.4308 516.9653,-1756.1904 528.1238,-1752.3645 540.227,-1748.5684 551.6856,-1745.1334"/>
<polygon fill="#ff0042" stroke="#ff0042" points="552.9527,-1748.4086 561.5493,-1742.216 550.9672,-1741.696 552.9527,-1748.4086"/>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M267.7998,-1831.7718C317.6699,-1821.0322 392.9289,-1804.6367 399.0839,-1802.1904"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-853.1904C659.6663,-819.9303 661.982,-792.7541 721.3989,-761.1904 728.9407,-757.184 737.2482,-753.6433 745.4975,-750.5797"/>
<polygon fill="#ff0000" stroke="#ff0000" points="746.8313,-753.8209 755.1052,-747.2032 744.5103,-747.2168 746.8313,-753.8209"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1157.1904C417.1344,-1143.1815 580.5804,-1185.3091 601.1821,-1195.1904"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1958.1904C432.8037,-1975.5431 451.4368,-1958.3954 480.9653,-1982.1904 506.9825,-2003.1558 495.0858,-2022.9371 516.9653,-2048.1904 533.0524,-2066.7581 555.4926,-2083.2107 573.1642,-2094.6427"/>
<polygon fill="#ff0000" stroke="#ff0000" points="571.584,-2097.7836 581.9117,-2100.1478 575.3124,-2091.8592 571.584,-2097.7836"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M238.3033,-1852.3911C252.0321,-1863.9602 271.9092,-1883.3622 281.2024,-1905.1904 323.4503,-2004.424 266.0053,-2294.2638 317.2024,-2389.1904 328.1505,-2409.4898 348.7586,-2425.2914 366.5603,-2435.9922"/>
<polygon fill="#00ffff" stroke="#00ffff" points="365.1274,-2439.2042 375.5477,-2441.1198 368.5964,-2433.1242 365.1274,-2439.2042"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M238.3543,-1852.3695C252.1219,-1863.9223 272.0276,-1883.3122 281.2024,-1905.1904 330.0283,-2021.6208 255.6839,-2361.9386 317.2024,-2472.1904 327.5157,-2490.6737 346.4836,-2504.6771 363.5678,-2514.2895"/>
<polygon fill="#ff0000" stroke="#ff0000" points="362.3231,-2517.5908 372.7983,-2519.1785 365.5996,-2511.4049 362.3231,-2517.5908"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M238.4032,-1852.3492C252.2078,-1863.8865 272.141,-1883.2649 281.2024,-1905.1904 310.0162,-1974.9104 270.7256,-2523.768 317.2024,-2583.1904 319.7063,-2586.3917 322.6094,-2589.1944 325.798,-2591.647"/>
<polygon fill="#00ffff" stroke="#00ffff" points="323.9367,-2594.6111 334.2469,-2597.0503 327.7081,-2588.714 323.9367,-2594.6111"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="685.6163,-1437.1958 516.748,-1437.1958 516.748,-1415.185 685.6163,-1415.185 685.6163,-1437.1958"/>
<text text-anchor="middle" x="601.1821" y="-1423.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1387.1904C411.4891,-1378.6815 495.0154,-1398.2403 550.7325,-1412.6241"/>
<polygon fill="#ff0000" stroke="#ff0000" points="549.8872,-1416.0206 560.4463,-1415.1517 551.6501,-1409.2462 549.8872,-1416.0206"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.4169,-1829.7934C241.3541,-1764.818 318.9601,-1442.1483 399.0839,-1387.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1387.1904C434.9427,-1362.5943 482.3752,-1352.5693 522.2762,-1348.8203"/>
<polygon fill="#ff0000" stroke="#ff0000" points="522.5684,-1352.3082 532.2466,-1347.9974 521.9925,-1345.3319 522.5684,-1352.3082"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-891.1904C440.1768,-856.9845 464.3895,-876.9092 516.9653,-867.1904 554.2766,-860.2933 568.1994,-871.9478 601.1821,-853.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-853.1904C651.6914,-824.4657 660.941,-805.8981 685.3989,-753.1904 725.4423,-666.8956 662.1102,-616.5888 721.3989,-542.1904 803.9032,-438.66 1175.8672,-420.5457 1307.4386,-435.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.4704,-1830.1351C230.0462,-1733.4699 271.8279,-1033.6036 317.2024,-953.1904 339.6348,-913.4354 364.0007,-920.3938 399.0839,-891.1904"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1580.1904C829.3383,-1585.2034 841.4639,-1577.1496 870.5706,-1594.1904 892.0799,-1606.7833 887.468,-1621.1802 906.5706,-1637.1904 964.0211,-1685.3409 999.3168,-1668.6936 1052.825,-1721.1904 1075.0236,-1742.9695 1070.1965,-1756.2888 1088.825,-1781.1904 1111.2617,-1811.1827 1114.1977,-1823.2545 1145.9073,-1843.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1843.1904C1169.5115,-1857.3417 1177.8857,-1855.9122 1202.9897,-1867.1904 1249.9362,-1888.2814 1257.1889,-1906.0654 1307.4386,-1917.1904"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-1852.1958 334.8633,-1852.1958 334.8633,-1830.185 463.3044,-1830.185 463.3044,-1852.1958"/>
<text text-anchor="middle" x="399.0839" y="-1838.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M267.6098,-1841.1904C284.8758,-1841.1904 305.2027,-1841.1904 324.6437,-1841.1904"/>
<polygon fill="#ff0000" stroke="#ff0000" points="324.7084,-1844.6905 334.7083,-1841.1904 324.7083,-1837.6905 324.7084,-1844.6905"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-1742.1958 354.6193,-1742.1958 354.6193,-1720.185 443.5485,-1720.185 443.5485,-1742.1958"/>
<text text-anchor="middle" x="399.0839" y="-1728.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M241.6082,-1830.0377C272.6524,-1810.5513 336.8938,-1770.227 372.9951,-1747.5663"/>
<polygon fill="#7fff00" stroke="#7fff00" points="374.9208,-1750.49 381.5297,-1742.2091 371.1993,-1744.5612 374.9208,-1750.49"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M237.3113,-1852.5217C250.4773,-1864.3349 270.1115,-1884.0497 281.2024,-1905.1904 313.0533,-1965.9026 298.278,-1989.2942 317.2024,-2055.1904 348.7765,-2165.1342 315.4172,-2221.1875 399.0839,-2299.1904"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-2299.1904C425.6566,-2323.9643 1017.6549,-2324.2967 1052.825,-2315.1904 1098.4916,-2303.3663 1104.4805,-2286.7529 1145.9073,-2264.1904"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M238.4732,-1852.3205C252.3311,-1863.8361 272.3036,-1883.1984 281.2024,-1905.1904 320.4491,-2002.183 253.3526,-2763.2985 317.2024,-2846.1904 319.6825,-2849.4102 322.567,-2852.2273 325.7411,-2854.6912"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="323.8603,-2857.6429 334.1625,-2860.1159 327.651,-2851.7581 323.8603,-2857.6429"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M238.429,-1852.3386C252.2533,-1863.8678 272.201,-1883.2403 281.2024,-1905.1904 345.0171,-2060.8043 254.4902,-2505.129 317.2024,-2661.1904 329.7005,-2692.2923 357.0451,-2720.1663 376.6982,-2737.3346"/>
<polygon fill="#ff0000" stroke="#ff0000" points="374.6918,-2740.222 384.5844,-2744.0152 379.2165,-2734.8808 374.6918,-2740.222"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1628.6227,-1700.3769C1650.2676,-1736.7302 1722.5342,-1846.7362 1781.1273,-1803.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1781.1273,-1803.1904C1782.7186,-1802.0078 1916.5761,-1763.5186 1918.4414,-1764.1904"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M1645.6573,-1700.2569C1672.7694,-1713.0521 1717.5824,-1734.2011 1748.1857,-1748.644"/>
<polygon fill="#6eff00" stroke="#6eff00" points="1747.0448,-1751.9757 1757.5821,-1753.0785 1750.0324,-1745.6453 1747.0448,-1751.9757"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.8329,-1678.1188C1639.1016,-1574.0658 1757.3053,-768.5325 1778.0306,-627.2936"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1781.507,-627.7098 1779.496,-617.3075 1774.5811,-626.6934 1781.507,-627.7098"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-1157.1904C1545.8607,-1120.7536 1548.9116,-1000.6368 1622.2083,-1043.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1081.1904C1219.2088,-1072.3607 1402.6789,-1188.9315 1469.339,-1157.1904"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M1029.8877,-1109.904C1063.0581,-1102.7412 1107.3641,-1092.4765 1145.9073,-1081.1904"/>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M1145.9073,-1081.1904C1351.6362,-1020.9497 1408.1714,-1017.0874 1622.2083,-1005.1904"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1028.3588,-1131.2432C1037.1151,-1134.7243 1045.708,-1139.2696 1052.825,-1145.1904 1077.9137,-1166.0625 1062.9971,-1189.2403 1088.825,-1209.1904 1227.2092,-1316.0818 1349.2306,-1182.1079 1469.339,-1309.1904"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M616.1543,-1742.2588C633.0434,-1754.7749 661.2997,-1775.8071 685.3989,-1794.1904 701.5151,-1806.4841 704.2915,-1811.3184 721.3989,-1822.1904 784.1976,-1862.0998 827.5158,-1837.505 870.5706,-1898.1904 939.602,-1995.4897 837.9305,-2066.6146 906.5706,-2164.1904 948.7179,-2224.1053 1006.2383,-2183.6583 1052.825,-2240.1904 1088.7779,-2283.8188 1059.3846,-2313.9274 1088.825,-2362.1904 1125.3575,-2422.0801 1162.2016,-2414.1139 1202.9897,-2471.1904 1225.1888,-2502.2545 1213.7056,-2520.5812 1238.9897,-2549.1904 1286.4164,-2602.8541 1323.015,-2585.8832 1375.8875,-2634.1904 1426.8345,-2680.7384 1400.7928,-2766.1734 1469.339,-2758.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-2758.1904C1548.869,-2747.63 1557.5577,-2709.6968 1622.2083,-2662.1904"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M795.9847,-1656.1904C933.9462,-1624.6883 950.4055,-1751.7658 1088.825,-1781.1904 1279.2344,-1821.6668 1333.2673,-1807.2344 1526.7905,-1786.1904 1569.9588,-1781.4962 1579.5798,-1773.4581 1622.2083,-1765.1904"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#2cff00" stroke-dasharray="5,2" d="M607.9243,-1720.0596C624.9638,-1692.3894 671.9311,-1618.9224 721.3989,-1566.1904 750.8913,-1534.7519 754.9073,-1517.2604 795.9847,-1504.1904"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M622.3692,-1742.1995C641.3529,-1753.0619 668.7047,-1771.3365 685.3989,-1794.1904 714.2509,-1833.688 701.6891,-1853.4242 721.3989,-1898.1904 721.9431,-1899.4263 905.7194,-2239.142 906.5706,-2240.1904 960.2824,-2306.3533 1004.4653,-2294.0204 1052.825,-2364.1904 1080.1053,-2403.7744 1056.1035,-2430.9708 1088.825,-2466.1904 1091.9753,-2469.5813 1095.6669,-2472.537 1099.6308,-2475.1083"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="1098.2024,-2478.3195 1108.6391,-2480.143 1101.6175,-2472.2091 1098.2024,-2478.3195"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#009bff" stroke-dasharray="5,2" d="M795.9847,-1808.1904C828.904,-1836.0203 849.1341,-1832.7918 870.5706,-1870.1904 919.405,-1955.3881 858.151,-2002.7562 906.5706,-2088.1904 948.5897,-2162.3314 999.0106,-2146.1109 1052.825,-2212.1904 1073.9245,-2238.0989 1069.7399,-2250.764 1088.825,-2278.1904 1154.1172,-2372.0194 1249.0345,-2470.7095 1288.8097,-2510.7255"/>
<polygon fill="#009bff" stroke="#009bff" points="1286.4608,-2513.3265 1296.0044,-2517.9276 1291.4131,-2508.3792 1286.4608,-2513.3265"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0058ff" stroke-dasharray="5,2" d="M610.2965,-1719.9124C627.9179,-1697.467 666.5766,-1644.9781 685.3989,-1594.1904 720.5919,-1499.2301 653.1119,-1443.976 721.3989,-1369.1904 744.4651,-1343.9291 765.2251,-1365.1578 795.9847,-1350.1904"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M795.9847,-1732.1904C857.5197,-1747.3265 850.9626,-1791.8028 906.5706,-1822.1904 936.5876,-1838.5936 952.9567,-1824.8595 979.6978,-1846.1904"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M610.1241,-1719.8466C627.4431,-1697.2858 665.5964,-1644.604 685.3989,-1594.1904 715.2267,-1518.2542 667.4572,-1475.3973 721.3989,-1414.1904 729.5115,-1404.9852 741.1164,-1399.1619 752.7631,-1395.4806"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="753.7339,-1398.844 762.4804,-1392.8649 751.9144,-1392.0846 753.7339,-1398.844"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#6e00ff" stroke-dasharray="5,2" d="M610.7757,-1720.0756C629.2367,-1697.9164 669.2993,-1645.9058 685.3989,-1594.1904 708.0865,-1521.3131 670.0646,-964.6759 721.3989,-908.1904 751.824,-874.7123 1483.5663,-801.5372 1526.7905,-788.1904 1599.8507,-765.6309 1613.4766,-747.8657 1681.626,-713.1904 1754.8153,-675.9507 1795.8552,-692.2558 1844.6287,-626.1904 1887.7415,-567.7925 1910.5711,-337.784 1916.7189,-266.4223"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="1920.2129,-266.64 1917.5629,-256.3819 1913.2375,-266.0536 1920.2129,-266.64"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1469.339,-1689.1904C1496.3761,-1691.9583 1526.2443,-1692.5118 1552.352,-1692.1795"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="1552.5968,-1695.6759 1562.5347,-1692.0035 1552.4757,-1688.6769 1552.5968,-1695.6759"/>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M624.2405,-1720.0489C660.0763,-1703.2591 731.7109,-1671.7815 795.9847,-1656.1904"/>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M795.9847,-1656.1904C850.1216,-1643.0583 852.528,-1610.7053 906.5706,-1597.1904 1152.4384,-1535.7042 1217.2173,-1663.3796 1469.339,-1689.1904"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0085" stroke-dasharray="5,2" d="M610.5366,-1719.9978C628.5788,-1697.702 667.9411,-1645.4632 685.3989,-1594.1904 709.9593,-1522.0582 678.3588,-1316.0698 721.3989,-1253.1904 767.6152,-1185.6708 858.9762,-1150.3171 919.7108,-1133.4757"/>
<polygon fill="#ff0085" stroke="#ff0085" points="920.8056,-1136.8058 929.5562,-1130.8328 918.9907,-1130.0451 920.8056,-1136.8058"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M610.7866,-1720.079C629.2668,-1697.9257 669.3615,-1645.9251 685.3989,-1594.1904 709.0832,-1517.7882 677.9691,-942.3625 721.3989,-875.1904 771.1968,-798.1689 1003.4689,-720.7537 1088.825,-687.1904 1182.8134,-650.2328 1208.1396,-606.7674 1307.4386,-625.1904"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M650.7994,-1725.1215C690.6423,-1721.7484 747.7079,-1720.3155 795.9847,-1732.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1919.1904C1216.2629,-1933.5056 1237.3389,-1901.6708 1307.4386,-1917.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1732.1904C829.7999,-1740.5081 839.7826,-1739.9193 870.5706,-1756.1904 888.4916,-1765.6615 888.6771,-1774.6674 906.5706,-1784.1904 966.9633,-1816.332 999.8178,-1788.9398 1052.825,-1832.1904 1077.8118,-1852.5781 1064.6829,-1873.8091 1088.825,-1895.1904 1109.4276,-1913.4371 1118.9388,-1913.7031 1145.9073,-1919.1904"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M795.9847,-1808.1904C828.904,-1836.0203 846.0438,-1834.7416 870.5706,-1870.1904 898.4011,-1910.4142 883.8827,-1930.8574 906.5706,-1974.1904 932.1097,-2022.9692 938.3407,-2037.8419 979.6978,-2074.1904"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M979.6978,-2074.1904C1011.7033,-2102.3199 1023.8378,-2104.9596 1052.825,-2136.1904 1100.6769,-2187.7463 1084.3372,-2298.2042 1145.9073,-2264.1904"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M651.029,-1741.4263C693.4107,-1752.1842 753.9106,-1772.6211 795.9847,-1808.1904"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1145.9073,-2264.1904C1230.9276,-2217.2219 1281.9575,-2104.262 1300.0081,-2057.7419"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1303.2832,-2058.976 1303.5381,-2048.3843 1296.7337,-2056.5053 1303.2832,-2058.976"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M1918.4414,-853.1904C2007.9268,-772.1403 2030.8028,-365.2862 2035.0676,-266.7207"/>
<polygon fill="#ff8500" stroke="#ff8500" points="2038.5739,-266.6381 2035.4897,-256.5021 2031.5799,-266.3492 2038.5739,-266.6381"/>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M868.964,-736.9186C979.0892,-738.6203 1194.1918,-744.2933 1375.8875,-763.1904 1585.8051,-785.0228 1636.7688,-802.634 1844.6287,-839.1904 1877.5145,-844.9741 1893.6931,-875.6058 1918.4414,-853.1904"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#2cff00" stroke-dasharray="5,2" d="M802.5036,-747.3846C817.6939,-774.1205 855.3099,-844.2394 870.5706,-908.1904 886.2271,-973.8002 865.7302,-1460.5076 906.5706,-1514.1904 910.5156,-1519.376 915.5954,-1523.4939 921.2375,-1526.7624"/>
<polygon fill="#2cff00" stroke="#2cff00" points="919.9575,-1530.0311 930.4842,-1531.2311 923.0034,-1523.7285 919.9575,-1530.0311"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1622.2083,-699.1904C1674.5885,-681.3558 1728.7891,-645.1215 1758.4014,-623.5229"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1760.8175,-626.0891 1766.7728,-617.3263 1756.6529,-620.4627 1760.8175,-626.0891"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1469.339,-699.1904C1537.188,-702.7428 1557.8922,-721.089 1622.2083,-699.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M849.1365,-725.0796C857.0213,-721.6303 864.5173,-717.1111 870.5706,-711.1904 904.3397,-678.1608 867.9241,-638.3522 906.5706,-611.1904 1052.4229,-508.6815 1133.2465,-587.2681 1307.4386,-625.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-625.1904C1339.1352,-631.0711 1346.3767,-636.2145 1375.8875,-649.1904 1419.0083,-668.1508 1422.2982,-696.7275 1469.339,-699.1904"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M821.914,-1262.0426C871.8918,-1242.4714 982.7949,-1208.5689 1052.825,-1259.1904 1094.172,-1289.0783 1054.2815,-1330.6456 1088.825,-1368.1904 1124.5707,-1407.042 1254.7384,-1464.3359 1307.4386,-1461.1904"/>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M1307.4386,-1461.1904C1389.1375,-1462.1122 1560.332,-1217.8342 1622.2083,-1271.1904"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1307.4386,-1461.1904C1379.2665,-1456.9032 1406.8541,-1425.5075 1469.339,-1461.1904"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M616.1543,-2122.2588C633.0434,-2134.7749 661.2997,-2155.8071 685.3989,-2174.1904 701.5151,-2186.4841 704.5786,-2190.8793 721.3989,-2202.1904 784.9029,-2244.8949 821.8266,-2229.195 870.5706,-2288.1904 901.7257,-2325.8978 883.8827,-2348.8574 906.5706,-2392.1904 932.1097,-2440.9692 925.1133,-2484.9685 979.6978,-2492.1904"/>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M979.6978,-2492.1904C1012.3944,-2497.0457 1049.1091,-2497.3556 1079.6993,-2496.2158"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="1079.9844,-2499.7068 1089.8239,-2495.7781 1079.682,-2492.7134 1079.9844,-2499.7068"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M605.2766,-2100.0902C619.1389,-2062.0031 664.5961,-1932.8739 685.3989,-1822.1904 702.2114,-1732.7377 665.0421,-1485.6632 721.3989,-1414.1904 729.0622,-1404.4716 740.6469,-1398.5009 752.4161,-1394.8424"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="753.4665,-1398.1858 762.2637,-1392.2817 751.7047,-1391.4111 753.4665,-1398.1858"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M605.3574,-2100.105C619.4791,-2062.0654 665.6714,-1933.0706 685.3989,-1822.1904 695.6216,-1764.7333 685.7106,-1344.3658 721.3989,-1298.1904 723.9109,-1294.9403 726.8623,-1292.1087 730.115,-1289.6423"/>
<polygon fill="#ff0000" stroke="#ff0000" points="732.1294,-1292.5104 738.7428,-1284.2331 728.4111,-1286.5796 732.1294,-1292.5104"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M647.9594,-2107.8017C701.7356,-2103.7655 792.6256,-2096.5138 870.5706,-2088.1904 919.1926,-2082.9983 942.416,-2042.5497 979.6978,-2074.1904"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M226.5456,-2483.6068C234.4023,-2513.8586 260.3655,-2595.9677 317.2024,-2628.1904 454.5405,-2706.0518 952.3949,-2554.196 1102.6673,-2505.5124"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="1104.0402,-2508.7464 1112.4666,-2502.324 1101.8743,-2502.0899 1104.0402,-2508.7464"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M256.3188,-2483.2087C308.9642,-2498.8635 413.7961,-2520.6181 480.9653,-2472.1904 538.6936,-2430.5695 584.4099,-2203.2648 597.4378,-2132.3387"/>
<polygon fill="#ff0000" stroke="#ff0000" points="600.9086,-2132.8139 599.2449,-2122.3506 594.0204,-2131.5677 600.9086,-2132.8139"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.8078,-2465.9172C295.254,-2464.0402 313.4912,-2461.9588 330.689,-2459.9961"/>
<polygon fill="#00ffff" stroke="#00ffff" points="331.1347,-2463.4681 340.6733,-2458.8566 330.3409,-2456.5132 331.1347,-2463.4681"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M457.5762,-2458.2374C534.9799,-2466.2045 675.6942,-2480.5675 795.9847,-2492.1904"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M405.808,-2440.8447C435.1238,-2391.3802 551.9674,-2194.2304 589.5056,-2130.8922"/>
<polygon fill="#ff0000" stroke="#ff0000" points="592.5495,-2132.621 594.6371,-2122.2338 586.5276,-2129.052 592.5495,-2132.621"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#2cff00" stroke-dasharray="5,2" d="M464.025,-2026.0339C568.2127,-2007.6396 771.0762,-1955.84 870.5706,-1822.1904 931.0444,-1740.9567 855.4219,-1684.5965 906.5706,-1597.1904 916.7642,-1579.7708 934.3495,-1565.572 949.7206,-1555.5835"/>
<polygon fill="#2cff00" stroke="#2cff00" points="951.7737,-1558.4292 958.4425,-1550.1964 948.0952,-1552.4737 951.7737,-1558.4292"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M407.9887,-2046.3362C425.9008,-2067.7483 468.7226,-2114.0316 516.9653,-2131.1904 587.4962,-2156.2766 611.732,-2144.4987 685.3989,-2131.1904 772.1031,-2115.5269 1018.5155,-2013.2405 1110.6082,-1974.2519"/>
<polygon fill="#0016ff" stroke="#0016ff" points="1112.2056,-1977.3762 1120.0451,-1970.2493 1109.4723,-1970.9319 1112.2056,-1977.3762"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M462.0933,-2024.1353C469.2196,-2020.6561 475.7721,-2016.1138 480.9653,-2010.1904 545.1253,-1937.0092 466.3576,-1877.322 516.9653,-1794.1904 529.255,-1774.0026 550.6467,-1758.1236 568.7944,-1747.3571"/>
<polygon fill="#ff0042" stroke="#ff0042" points="570.94,-1750.1648 577.9234,-1742.1972 567.4956,-1744.0709 570.94,-1750.1648"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-2414.1904C1381.1409,-2346.2648 1448.4035,-2025.1263 1465.284,-1939.3151"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1468.7331,-1939.9134 1467.2096,-1929.4287 1461.8623,-1938.575 1468.7331,-1939.9134"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-2302.1904C902.0364,-2350.0472 1221.8825,-2493.0408 1307.4386,-2414.1904"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M795.9847,-2302.1904C871.8334,-2321.2953 1077.4423,-2302.0132 1145.9073,-2264.1904"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M408.2769,-2046.2536C427.0352,-2068.3575 471.7803,-2118.7263 516.9653,-2152.1904 630.1079,-2235.9838 661.1229,-2261.7568 795.9847,-2302.1904"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-1969.1958 166.6166,-1969.1958 166.6166,-1947.185 281.0645,-1947.185 281.0645,-1969.1958"/>
<text text-anchor="middle" x="223.8406" y="-1955.0404" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M232.3339,-1969.3097C247.607,-1988.729 281.4624,-2029.2262 317.2024,-2055.1904 397.0524,-2113.1995 420.7787,-2130.0723 516.9653,-2152.1904 753.9951,-2206.6954 844.7746,-2167.1624 1052.825,-2041.1904 1082.0607,-2023.4885 1110.8195,-1996.2226 1128.458,-1978.0526"/>
<polygon fill="#0016ff" stroke="#0016ff" points="1131.3753,-1980.0648 1135.7414,-1970.4114 1126.3083,-1975.2351 1131.3753,-1980.0648"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M263.588,-1947.1368C270.3187,-1943.6558 276.605,-1939.1107 281.2024,-1933.1904 342.5086,-1854.2432 278.8393,-1803.4909 317.2024,-1711.1904 341.0062,-1653.919 355.109,-1641.9265 399.0839,-1598.1904"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M254.6288,-1947.0866C263.534,-1943.2706 273.0453,-1938.5805 281.2024,-1933.1904 299.5637,-1921.0575 297.8093,-1909.5949 317.2024,-1899.1904 383.0426,-1863.867 421.6144,-1906.5792 480.9653,-1861.1904 507.8173,-1840.6553 494.9104,-1819.8087 516.9653,-1794.1904 532.9939,-1775.5722 555.4371,-1759.1221 573.1246,-1747.704"/>
<polygon fill="#ff0042" stroke="#ff0042" points="575.2728,-1750.488 581.8815,-1742.2069 571.5511,-1744.5594 575.2728,-1750.488"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M241.1728,-1969.3152C259.5048,-1980.7257 289.5453,-1998.4236 317.2024,-2010.1904 326.7378,-2014.2473 337.1525,-2017.9487 347.2604,-2021.1873"/>
<polygon fill="#ff0000" stroke="#ff0000" points="346.2308,-2024.5324 356.8186,-2024.1471 348.3015,-2017.8457 346.2308,-2024.5324"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M225.4435,-1969.4179C232.5663,-2019.5182 261.8476,-2227.7206 281.2024,-2399.1904 285.9098,-2440.8944 286.1439,-2746.9636 317.2024,-2775.1904 371.0649,-2824.1422 408.1925,-2776.436 480.9653,-2775.1904 654.5131,-2772.2201 700.0451,-2780.5744 870.5706,-2748.1904 953.0906,-2732.5192 972.7635,-2723.5932 1052.825,-2698.1904 1167.5126,-2661.801 1241.4162,-2706.7811 1307.4386,-2606.1904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1307.4386,-2606.1904C1328.3721,-2572.5891 1356.5018,-2583.7079 1375.8875,-2549.1904 1436.7881,-2440.7529 1462.7609,-2036.8643 1468.2152,-1939.4379"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1471.7158,-1939.5204 1468.7674,-1929.3441 1464.7262,-1939.1379 1471.7158,-1939.5204"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M225.1769,-1969.2793C231.9851,-2023.9145 264.559,-2263.8203 317.2024,-2313.1904 498.4159,-2483.1364 623.4465,-2417.679 870.5706,-2392.1904 952.8778,-2383.7012 979.7031,-2392.917 1052.825,-2354.1904 1103.6786,-2327.2575 1096.3248,-2293.3973 1145.9073,-2264.1904"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M452.0063,-2519.1495C528.0511,-2504.6446 672.6611,-2482.1287 795.9847,-2492.1904"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M449.3861,-2597.1785C585.6061,-2567.4865 953.2296,-2488.2601 979.6978,-2492.1904"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0058ff" stroke-dasharray="5,2" d="M651.63,-1415.1257C663.1234,-1411.5527 675.0027,-1406.973 685.3989,-1401.1904 704.107,-1390.7846 702.4909,-1379.2282 721.3989,-1369.1904 751.6132,-1353.1505 765.2251,-1365.1578 795.9847,-1350.1904"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M653.6419,-1359.2316C684.5891,-1365.745 723.289,-1373.8902 752.5216,-1380.0428"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="751.932,-1383.4953 762.4385,-1382.13 753.3738,-1376.6453 751.932,-1383.4953"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#6e00ff" stroke-dasharray="5,2" d="M1788.0162,-595.0615C1800.5797,-574.4128 1827.4952,-528.5055 1844.6287,-487.1904 1877.4437,-408.0613 1903.0987,-309.049 1913.4584,-266.371"/>
<polygon fill="#6e00ff" stroke="#6e00ff" points="1916.8835,-267.097 1915.8108,-256.5566 1910.0763,-265.4654 1916.8835,-267.097"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1472.9389,-749.2435C1483.0567,-780.7422 1511.9716,-873.8125 1526.7905,-953.1904 1554.0283,-1099.0902 1543.9889,-1137.9656 1562.7905,-1285.1904 1581.5204,-1431.8536 1609.1684,-1607.6866 1618.7726,-1667.8198"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="1615.3601,-1668.6452 1620.3974,-1677.9659 1622.272,-1667.5382 1615.3601,-1668.6452"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1520.8826,-727.1654C1550.8029,-720.2404 1589.0202,-710.4904 1622.2083,-699.1904"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1482.4116,-1906.8457C1495.2723,-1895.0689 1514.6889,-1875.5492 1526.7905,-1855.1904 1551.7834,-1813.1446 1537.279,-1792.9235 1562.7905,-1751.1904 1572.9965,-1734.495 1588.3557,-1718.6218 1600.9013,-1707.1162"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="1603.5087,-1709.4814 1608.6569,-1700.2214 1598.8578,-1704.2498 1603.5087,-1709.4814"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M455.0973,-1830.1417C464.3275,-1826.6791 473.353,-1822.1394 480.9653,-1816.1904 505.4688,-1797.0412 492.3878,-1775.2444 516.9653,-1756.1904 524.3124,-1750.4946 532.9351,-1746.0938 541.8095,-1742.6943"/>
<polygon fill="#ff0042" stroke="#ff0042" points="543.1597,-1745.9316 551.4895,-1739.3845 540.8949,-1739.3081 543.1597,-1745.9316"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M442.7533,-1830.0782C455.327,-1826.288 468.8998,-1821.6139 480.9653,-1816.1904 498.0681,-1808.5027 498.9151,-1799.2691 516.9653,-1794.1904 668.2489,-1751.6244 721.9191,-1743.187 870.5706,-1794.1904 889.7432,-1800.7687 889.0108,-1812.0652 906.5706,-1822.1904 1006.0011,-1879.5238 1033.4358,-1896.3059 1145.9073,-1919.1904"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M443.4352,-1731.1904C472.1431,-1731.1904 509.878,-1731.1904 541.2427,-1731.1904"/>
<polygon fill="#ff0042" stroke="#ff0042" points="541.613,-1734.6905 551.613,-1731.1904 541.6129,-1727.6905 541.613,-1734.6905"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M443.3607,-1721.866C465.3765,-1717.6936 492.4539,-1713.255 516.9653,-1711.1904 591.5606,-1704.9073 610.5529,-1709.7762 685.3989,-1711.1904 767.7415,-1712.7462 789.7363,-1702.4252 870.5706,-1718.1904 955.1271,-1734.6815 979.8058,-1738.4743 1052.825,-1784.1904 1071.7391,-1796.0323 1070.2162,-1806.8742 1088.825,-1819.1904 1111.7748,-1834.3798 1122.3971,-1828.8837 1145.9073,-1843.1904"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1346.8499,-2026.1244C1356.7381,-2022.468 1367.0428,-2017.8503 1375.8875,-2012.1904 1408.0853,-1991.5865 1437.8454,-1958.1433 1454.7746,-1937.1983"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1457.5498,-1939.3315 1461.0141,-1929.319 1452.0621,-1934.9858 1457.5498,-1939.3315"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M470.9483,-2877.3687C620.1189,-2888.8144 957.4111,-2907.1244 1052.825,-2848.1904 1081.2526,-2830.6316 1067.3979,-2807.8288 1088.825,-2782.1904 1168.815,-2686.479 1240.2897,-2711.31 1307.4386,-2606.1904"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M445.0882,-2757.6952C555.9568,-2761.8195 844.1598,-2761.0367 1052.825,-2658.1904 1065.7291,-2651.8303 1139.4869,-2581.0646 1145.9073,-2568.1904"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1145.9073,-2568.1904C1163.2753,-2536.8254 1185.7537,-2542.6282 1202.9897,-2511.1904 1225.4507,-2470.2227 1287.3853,-2144.4928 1303.5424,-2058.14"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1307.0017,-2058.6811 1305.396,-2048.2086 1300.1206,-2057.3967 1307.0017,-2058.6811"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileelectricpowergeneratorsf90EfferentGraph = svgPanZoom('#sourcefileelectricpowergeneratorsf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~electricpowergenerators.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileelectricpowergeneratorsf90AfferentGraph" width="641pt" height="156pt"
 viewBox="0.00 0.00 641.00 156.43" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph" class="graph" transform="scale(.2301 .2301) rotate(0) translate(4 675.8056)">
<title>sourcefile~~electricpowergenerators.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-675.8056 2781.6323,-675.8056 2781.6323,4 -4,4"/>
<!-- sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~electricpowergenerators.f90</title>
<polygon fill="none" stroke="#000000" points="146.3356,-230.575 -.112,-230.575 -.112,-208.5641 146.3356,-208.5641 146.3356,-230.575"/>
<text text-anchor="middle" x="73.1118" y="-216.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">ElectricPowerGenerators.f90</text>
</g>
<!-- sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~plantloopequipment.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/plantloopequipment.f90.html" xlink:title="PlantLoopEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="515.994,-133.575 388.9886,-133.575 388.9886,-111.5641 515.994,-111.5641 515.994,-133.575"/>
<text text-anchor="middle" x="452.4913" y="-119.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge97" class="edge">
<title>sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M146.3591,-223.9858C182.9263,-225.0711 227.7548,-224.7097 267.6068,-219.5695"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M267.6068,-219.5695C306.1637,-214.5964 317.8482,-217.1955 352.99,-200.5695 384.7606,-185.5385 415.7154,-158.7946 434.4451,-140.871"/>
<polygon fill="#ff0000" stroke="#ff0000" points="436.9855,-143.2822 441.6904,-133.7893 432.0926,-138.2762 436.9855,-143.2822"/>
</g>
<!-- sourcefile~plantexhaustabsorptionchiller.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~plantexhaustabsorptionchiller.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/plantexhaustabsorptionchiller.f90.html" xlink:title="PlantExhaustAbsorptionChiller.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="352.8733,-191.575 182.3403,-191.575 182.3403,-169.5641 352.8733,-169.5641 352.8733,-191.575"/>
<text text-anchor="middle" x="267.6068" y="-177.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantExhaustAbsorptionChiller.f90</text>
</a>
</g>
</g>
<!-- sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~plantexhaustabsorptionchiller.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge98" class="edge">
<title>sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~plantexhaustabsorptionchiller.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M128.0664,-208.5501C151.2679,-203.8977 178.4584,-198.4455 202.6438,-193.5959"/>
<polygon fill="#ff0000" stroke="#ff0000" points="203.3343,-197.0272 212.4509,-191.6293 201.958,-190.1638 203.3343,-197.0272"/>
</g>
<!-- sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~electricpowermanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/electricpowermanager.f90.html" xlink:title="ElectricPowerManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="334.6725,-269.575 200.5412,-269.575 200.5412,-247.5641 334.6725,-247.5641 334.6725,-269.575"/>
<text text-anchor="middle" x="267.6068" y="-255.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ElectricPowerManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge99" class="edge">
<title>sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M128.0664,-230.589C151.2679,-235.2413 178.4584,-240.6935 202.6438,-245.5432"/>
<polygon fill="#ff0000" stroke="#ff0000" points="201.958,-248.9753 212.4509,-247.5097 203.3343,-242.1119 201.958,-248.9753"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~heatbalanceinternalheatgains.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/heatbalanceinternalheatgains.f90.html" xlink:title="HeatBalanceInternalHeatGains.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="726.395,-269.575 551.8584,-269.575 551.8584,-247.5641 726.395,-247.5641 726.395,-269.575"/>
<text text-anchor="middle" x="639.1267" y="-255.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceInternalHeatGains.f90</text>
</a>
</g>
</g>
<!-- sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge100" class="edge">
<title>sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M452.4913,-219.5695C501.1434,-222.0265 555.5354,-234.5467 592.9903,-244.7484"/>
<polygon fill="#ff0000" stroke="#ff0000" points="592.5145,-248.2487 603.0866,-247.554 594.3888,-241.5043 592.5145,-248.2487"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M267.6068,-219.5695C349.1026,-209.0581 370.425,-215.4251 452.4913,-219.5695"/>
</g>
<!-- sourcefile~plantmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~plantmanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/plantmanager.f90.html" xlink:title="PlantManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1542.9141,-73.575 1448.2866,-73.575 1448.2866,-51.5641 1542.9141,-51.5641 1542.9141,-73.575"/>
<text text-anchor="middle" x="1495.6003" y="-59.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M459.5142,-111.2477C473.7685,-89.4879 508.4673,-42.4048 551.9927,-24.5695 676.4899,26.4454 719.6489,-38.4848 854.0552,-44.5695"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M854.0552,-44.5695C1069.4927,-51.8284 1325.6958,-58.3958 1438.0168,-61.1713"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1438.0267,-64.6725 1448.11,-61.4201 1438.1993,-57.6746 1438.0267,-64.6725"/>
</g>
<!-- sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~plantloopsolver.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/plantloopsolver.f90.html" xlink:title="PlantLoopSolver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="692.1191,-55.575 586.1343,-55.575 586.1343,-33.5641 692.1191,-33.5641 692.1191,-55.575"/>
<text text-anchor="middle" x="639.1267" y="-41.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopSolver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M478.8358,-111.5595C511.3959,-97.9517 566.9474,-74.7352 603.3458,-59.5233"/>
<polygon fill="#ff0000" stroke="#ff0000" points="604.7378,-62.735 612.6148,-55.6496 602.0385,-56.2764 604.7378,-62.735"/>
</g>
<!-- sourcefile~plantexhaustabsorptionchiller.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~plantexhaustabsorptionchiller.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M302.8174,-169.5236C332.5362,-160.2006 375.2656,-146.796 407.4678,-136.6938"/>
<polygon fill="#7fff00" stroke="#7fff00" points="408.6036,-140.0058 417.0975,-133.6729 406.5083,-133.3267 408.6036,-140.0058"/>
</g>
<!-- sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M307.9652,-247.527C353.5247,-235.5126 424.8888,-218.1756 452.4913,-219.5695"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2645.2149,-402.575 2525.4045,-402.575 2525.4045,-380.5641 2645.2149,-380.5641 2645.2149,-402.575"/>
<text text-anchor="middle" x="2585.3097" y="-388.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1071.019,-661.5695C1259.4215,-650.9275 1306.8975,-661.5695 1495.6003,-661.5695 1495.6003,-661.5695 1495.6003,-661.5695 2094.8943,-661.5695 2210.6402,-661.5695 2250.9505,-694.0279 2354.6287,-642.5695 2406.1022,-617.0218 2390.5411,-574.627 2440.118,-545.5695"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1750.7614,-364.575 1652.2032,-364.575 1652.2032,-342.5641 1750.7614,-342.5641 1750.7614,-364.575"/>
<text text-anchor="middle" x="1701.4823" y="-350.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.3886,-269.8348C345.1656,-338.2735 711.2567,-694.2663 1071.019,-661.5695"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1071.019,-661.5695C1220.6258,-657.6095 1244.805,-584.4914 1360.5103,-489.5695 1379.0015,-474.3997 1375.6798,-461.323 1396.5103,-449.5695 1474.6189,-405.4972 1510.2448,-441.7733 1594.6904,-411.5695 1624.1088,-401.0474 1655.2268,-383.2908 1676.2342,-370.1903"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1678.2891,-373.0316 1684.8578,-364.7188 1674.5389,-367.1209 1678.2891,-373.0316"/>
</g>
<!-- sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~outputreporttabular.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node16"><a xlink:href="../sourcefile/outputreporttabular.f90.html" xlink:title="OutputReportTabular.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="515.9051,-269.575 389.0776,-269.575 389.0776,-247.5641 515.9051,-247.5641 515.9051,-269.575"/>
<text text-anchor="middle" x="452.4913" y="-255.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportTabular.f90</text>
</a>
</g>
</g>
<!-- sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M334.8774,-258.5695C349.3063,-258.5695 364.6209,-258.5695 379.2627,-258.5695"/>
<polygon fill="#00ffff" stroke="#00ffff" points="379.2727,-262.0696 389.2727,-258.5695 379.2726,-255.0696 379.2727,-262.0696"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge90" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1495.6003,-352.5695C1544.5884,-345.9969 1600.7246,-346.8166 1641.9932,-348.9603"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1641.9711,-352.4645 1652.1514,-349.5301 1642.3632,-345.4754 1641.9711,-352.4645"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M646.0671,-269.7088C662.5575,-295.0274 706.8838,-356.6298 762.2607,-381.5695 887.6196,-438.0266 935.9404,-426.1825 1071.019,-400.5695"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1278.3494,-393.5695C1375.4039,-378.2227 1398.2126,-365.6358 1495.6003,-352.5695"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1071.019,-400.5695C1161.5867,-383.3006 1187.2815,-407.9697 1278.3494,-393.5695"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node13"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2178.085,-282.575 2011.7036,-282.575 2011.7036,-260.5641 2178.085,-260.5641 2178.085,-282.575"/>
<text text-anchor="middle" x="2094.8943" y="-268.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge93" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1071.019,-246.5695C1116.7147,-258.7534 1231.1736,-201.8837 1278.3494,-198.5695"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M854.0552,-158.5695C957.0286,-143.583 970.4735,-219.7609 1071.019,-246.5695"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1278.3494,-198.5695C1374.668,-191.803 1399.0875,-195.6845 1495.6003,-198.5695"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node14"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2349.4394,-304.575 2219.4288,-304.575 2219.4288,-282.5641 2349.4394,-282.5641 2349.4394,-304.575"/>
<text text-anchor="middle" x="2284.4341" y="-290.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge88" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1278.3494,-198.5695C1376.1303,-191.7003 1397.9933,-227.5606 1495.6003,-236.5695"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1495.6003,-236.5695C1636.1028,-249.5376 1667.735,-279.0057 1808.2742,-291.5695 1949.3435,-304.1808 2114.8606,-300.8077 2208.9184,-297.1968"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2209.3361,-300.6831 2219.19,-296.7905 2209.0594,-293.6886 2209.3361,-300.6831"/>
</g>
<!-- sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~roomairmodelusertemppattern.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node18"><a xlink:href="../sourcefile/roomairmodelusertemppattern.f90.html" xlink:title="RoomAirModelUserTempPattern.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="944.2066,-372.575 763.9037,-372.575 763.9037,-350.5641 944.2066,-350.5641 944.2066,-372.575"/>
<text text-anchor="middle" x="854.0552" y="-358.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelUserTempPattern.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge89" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M652.2149,-269.6608C673.7448,-287.3326 718.6119,-321.7952 762.2607,-340.5695 768.4158,-343.2169 774.9527,-345.5549 781.5916,-347.6147"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="780.78,-351.0233 791.3586,-350.437 782.7234,-344.2984 780.78,-351.0233"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~zonetemppredictorcorrector.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node22"><a xlink:href="../sourcefile/zonetemppredictorcorrector.f90.html" xlink:title="ZoneTempPredictorCorrector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1360.6715,-362.575 1196.0273,-362.575 1196.0273,-340.5641 1360.6715,-340.5641 1360.6715,-362.575"/>
<text text-anchor="middle" x="1278.3494" y="-348.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZoneTempPredictorCorrector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge95" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1071.019,-246.5695C1110.1717,-257.0089 1123.1821,-249.0636 1160.1885,-265.5695 1170.5669,-270.1986 1224.2896,-310.468 1255.6065,-334.2263"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1253.7112,-337.1819 1263.7907,-340.4462 1257.9468,-331.6088 1253.7112,-337.1819"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~zonecontaminantpredictorcorrector.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node23"><a xlink:href="../sourcefile/zonecontaminantpredictorcorrector.f90.html" xlink:title="ZoneContaminantPredictorCorrector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1594.7806,-286.575 1396.4201,-286.575 1396.4201,-264.5641 1594.7806,-264.5641 1594.7806,-286.575"/>
<text text-anchor="middle" x="1495.6003" y="-272.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZoneContaminantPredictorCorrector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge87" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1071.019,-246.5695C1175.5703,-274.4462 1299.4521,-279.9186 1386.3308,-279.4973"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1386.4997,-282.9963 1396.4729,-279.4206 1386.4467,-275.9965 1386.4997,-282.9963"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~zoneequipmentmanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node24"><a xlink:href="../sourcefile/zoneequipmentmanager.f90.html" xlink:title="Zoneequipmentmanager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1567.4482,-402.575 1423.7525,-402.575 1423.7525,-380.5641 1567.4482,-380.5641 1567.4482,-402.575"/>
<text text-anchor="middle" x="1495.6003" y="-388.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Zoneequipmentmanager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge84" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M644.0305,-269.6885C664.1307,-315.0202 740.1923,-484.1141 762.2607,-497.5695 856.5593,-555.0644 1231.465,-514.3888 1360.5103,-452.5695 1380.9169,-442.7937 1376.8319,-427.7393 1396.5103,-416.5695 1404.1336,-412.2424 1412.5051,-408.6543 1421.0522,-405.6812"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1422.2886,-408.9605 1430.7461,-402.5792 1420.1551,-402.2935 1422.2886,-408.9605"/>
</g>
<!-- sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node29" class="node">
<title>sourcefile~daylightingmanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node29"><a xlink:href="../sourcefile/daylightingmanager.f90.html" xlink:title="DaylightingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1556.9277,-132.575 1434.273,-132.575 1434.273,-110.5641 1556.9277,-110.5641 1556.9277,-132.575"/>
<text text-anchor="middle" x="1495.6003" y="-118.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DaylightingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge85" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M647.124,-247.311C664.7659,-223.4904 709.6585,-168.2394 762.2607,-144.5695 991.8483,-41.2602 1304.052,-83.7632 1434.4506,-108.507"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1434.1571,-112.0149 1444.6394,-110.4749 1435.4847,-105.1419 1434.1571,-112.0149"/>
</g>
<!-- sourcefile~roomairmodelcrossvent.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node30" class="node">
<title>sourcefile~roomairmodelcrossvent.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node30"><a xlink:href="../sourcefile/roomairmodelcrossvent.f90.html" xlink:title="RoomAirModelCrossVent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="927.9534,-331.575 780.1569,-331.575 780.1569,-309.5641 927.9534,-309.5641 927.9534,-331.575"/>
<text text-anchor="middle" x="854.0552" y="-317.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelCrossVent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelcrossvent.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge86" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelcrossvent.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M669.4882,-269.5896C694.2572,-278.3587 730.2592,-290.6038 762.2607,-299.5695 771.8241,-302.2488 782.0178,-304.8391 792.0042,-307.2317"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="791.3551,-310.6744 801.8905,-309.5544 792.9561,-303.86 791.3551,-310.6744"/>
</g>
<!-- sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node31" class="node">
<title>sourcefile~delightmanagerf.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node31"><a xlink:href="../sourcefile/delightmanagerf.f90.html" xlink:title="DElightManagerF.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1333.4024,-132.575 1223.2964,-132.575 1223.2964,-110.5641 1333.4024,-110.5641 1333.4024,-132.575"/>
<text text-anchor="middle" x="1278.3494" y="-118.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DElightManagerF.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge91" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M854.0552,-158.5695C980.2277,-138.4529 1129.3775,-128.6359 1213.0039,-124.3794"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1213.306,-127.8688 1223.1195,-123.8755 1212.9577,-120.8775 1213.306,-127.8688"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M652.1963,-247.5171C673.7,-229.9255 718.5313,-195.6971 762.2607,-177.5695 800.7472,-161.6153 812.8272,-164.5698 854.0552,-158.5695"/>
</g>
<!-- sourcefile~roomairmodelufad.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node32" class="node">
<title>sourcefile~roomairmodelufad.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node32"><a xlink:href="../sourcefile/roomairmodelufad.f90.html" xlink:title="RoomAirModelUFAD.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="917.5169,-290.575 790.5935,-290.575 790.5935,-268.5641 917.5169,-268.5641 917.5169,-290.575"/>
<text text-anchor="middle" x="854.0552" y="-276.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelUFAD.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelufad.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge92" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelufad.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M726.5463,-267.111C744.4223,-268.8576 763.0654,-270.6792 780.4014,-272.373"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="780.1489,-275.865 790.4419,-273.3541 780.8297,-268.8981 780.1489,-275.865"/>
</g>
<!-- sourcefile~roomairmodeldisplacementvent.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node33" class="node">
<title>sourcefile~roomairmodeldisplacementvent.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node33"><a xlink:href="../sourcefile/roomairmodeldisplacementvent.f90.html" xlink:title="RoomAirModelDisplacementVent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="945.6445,-249.575 762.4658,-249.575 762.4658,-227.5641 945.6445,-227.5641 945.6445,-249.575"/>
<text text-anchor="middle" x="854.0552" y="-235.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelDisplacementVent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodeldisplacementvent.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge94" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodeldisplacementvent.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M726.5463,-250.4348C734.9831,-249.6497 743.5908,-248.8487 752.1513,-248.0521"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="752.5331,-251.5318 762.1658,-247.1202 751.8845,-244.5619 752.5331,-251.5318"/>
</g>
<!-- sourcefile~roomairmodelmundt.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node34" class="node">
<title>sourcefile~roomairmodelmundt.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node34"><a xlink:href="../sourcefile/roomairmodelmundt.f90.html" xlink:title="RoomAirModelMundt.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="918.191,-208.575 789.9194,-208.575 789.9194,-186.5641 918.191,-186.5641 918.191,-208.575"/>
<text text-anchor="middle" x="854.0552" y="-194.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelMundt.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelmundt.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge96" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelmundt.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M670.5265,-247.5125C695.2706,-239.0078 730.737,-227.277 762.2607,-218.5695 771.8338,-215.9253 782.0327,-213.3534 792.0213,-210.9685"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="792.9718,-214.3406 801.9088,-208.6502 791.3738,-207.5255 792.9718,-214.3406"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2284.4341,-194.5695C2364.7931,-228.1451 2358.9911,-281.8946 2440.118,-313.5695"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1891.9116,-4.5695C1949.347,-12.4808 1956.6175,-38.0241 2011.5491,-56.5695 2083.8334,-80.9735 2111.5161,-60.5754 2178.2395,-97.5695 2197.7559,-108.3902 2197.8721,-117.401 2214.2395,-132.5695 2244.7693,-160.8632 2246.0272,-178.5224 2284.4341,-194.5695"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2440.118,-313.5695C2483.7023,-330.5864 2530.8444,-357.6872 2559.2178,-375.0475"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2557.7423,-378.2502 2568.0883,-380.5329 2561.424,-372.2966 2557.7423,-378.2502"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2777.4432,-286.575 2681.201,-286.575 2681.201,-264.5641 2777.4432,-264.5641 2777.4432,-286.575"/>
<text text-anchor="middle" x="2729.3221" y="-272.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2284.4341,-118.5695C2448.5566,-136.1175 2629.9721,-223.3269 2699.7524,-259.6497"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2698.3637,-262.8736 2708.8443,-264.4247 2701.6185,-256.6763 2698.3637,-262.8736"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2094.8943,-42.5695C2131.2239,-52.1093 2142.9225,-43.7804 2178.2395,-56.5695 2229.6267,-75.1781 2231.0283,-106.9617 2284.4341,-118.5695"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1528.4451,-51.5164C1596.2822,-30.0676 1756.831,13.5647 1891.9116,-4.5695"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1891.9116,-4.5695C1983.1136,-14.8693 2006.1221,-19.2589 2094.8943,-42.5695"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1542.9473,-72.0187C1561.2382,-77.8109 1581.0115,-87.0247 1594.6904,-101.5695 1630.2213,-139.3496 1610.9985,-164.5903 1630.6904,-212.5695 1648.9379,-257.0294 1675.4257,-306.7779 1690.2873,-333.6819"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1687.2782,-335.4726 1695.1998,-342.5082 1693.3947,-332.0683 1687.2782,-335.4726"/>
</g>
<!-- sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M692.1527,-43.236C735.6718,-42.4622 798.887,-42.072 854.0552,-44.5695"/>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2599.1182,-380.447C2624.215,-360.2319 2677.4838,-317.3246 2707.5283,-293.1242"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2709.7516,-295.8276 2715.3438,-286.8289 2705.3605,-290.3761 2709.7516,-295.8276"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2771.0307,-402.575 2687.6136,-402.575 2687.6136,-380.5641 2771.0307,-380.5641 2771.0307,-402.575"/>
<text text-anchor="middle" x="2729.3221" y="-388.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2645.1328,-391.5695C2655.7974,-391.5695 2666.8293,-391.5695 2677.2556,-391.5695"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2677.4441,-395.0696 2687.4441,-391.5695 2677.444,-388.0696 2677.4441,-395.0696"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1751.0898,-349.6379C1789.6895,-347.5244 1844.4832,-346.5986 1891.9116,-353.5695"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node12"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1963.7492,-403.575 1820.0741,-403.575 1820.0741,-381.5641 1963.7492,-381.5641 1963.7492,-403.575"/>
<text text-anchor="middle" x="1891.9116" y="-389.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1751.0182,-363.7145C1774.5618,-368.5362 1802.9887,-374.3581 1828.1243,-379.5059"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1827.4421,-382.9387 1837.941,-381.5163 1828.8466,-376.0811 1827.4421,-382.9387"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1963.9704,-396.2493C2002.8525,-397.3092 2051.6144,-397.1483 2094.8943,-392.5695"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1910.6439,-381.403C1946.594,-359.9728 2025.4101,-312.9898 2067.357,-287.9848"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2069.4098,-290.8358 2076.2073,-282.709 2065.8255,-284.8231 2069.4098,-290.8358"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2106.3996,-260.4389C2135.9032,-233.3032 2216.6987,-167.8587 2284.4341,-194.5695"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2178.305,-281.2511C2188.5845,-282.4442 2199.0449,-283.6584 2209.193,-284.8362"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2208.8818,-288.3235 2219.2187,-285.9999 2209.689,-281.3702 2208.8818,-288.3235"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2349.8087,-294.8981C2378.3348,-297.2536 2411.6875,-302.4692 2440.118,-313.5695"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node15"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2489.5968,-478.575 2390.6393,-478.575 2390.6393,-456.5641 2489.5968,-456.5641 2489.5968,-478.575"/>
<text text-anchor="middle" x="2440.118" y="-464.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2294.4096,-304.7187C2320.4898,-333.8672 2390.9206,-412.584 2423.3531,-448.8322"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2420.7477,-451.1694 2430.0241,-456.288 2425.9645,-446.5018 2420.7477,-451.1694"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2461.2302,-456.5185C2485.9617,-443.5728 2527.1175,-422.03 2555.1944,-407.3333"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2556.9356,-410.3724 2564.1721,-402.6339 2553.6893,-404.1706 2556.9356,-410.3724"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M515.938,-258.5695C524.217,-258.5695 532.8467,-258.5695 541.5259,-258.5695"/>
<polygon fill="#ff0000" stroke="#ff0000" points="541.7192,-262.0696 551.7192,-258.5695 541.7192,-255.0696 541.7192,-262.0696"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2284.4341,-545.5695C2352.7763,-534.753 2380.423,-580.5574 2440.118,-545.5695"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M854.0552,-554.5695C901.9389,-558.2257 914.0484,-533.5542 945.8496,-497.5695 971.1332,-468.9598 952.0216,-443.4037 981.8496,-419.5695 1013.5054,-394.2748 1031.2156,-408.159 1071.019,-400.5695"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M639.1267,-458.5695C735.1249,-500.1578 749.7393,-546.6045 854.0552,-554.5695"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M474.2772,-247.4768C523.8275,-222.9448 649.4264,-164.6729 762.2607,-144.5695 842.5908,-130.2574 864.3489,-140.6477 945.8496,-144.5695 1130.7847,-153.4687 1176.2809,-166.1377 1360.5103,-184.5695 1420.572,-190.5786 1435.2657,-196.766 1495.6003,-198.5695"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M639.1267,-458.5695C703.6112,-486.5055 883.9743,-414.8879 945.8496,-381.5695 964.9602,-371.2789 962.6102,-358.6173 981.8496,-348.5695 1002.7766,-337.6404 1373.3958,-260.3764 1396.5103,-255.5695 1440.4133,-246.4395 1451.1512,-230.6442 1495.6003,-236.5695"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M854.0552,-554.5695C951.4467,-562.0059 973.4836,-584.3496 1071.019,-589.5695"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2284.4341,-545.5695C2316.5112,-541.6129 2325.3077,-540.1665 2354.6287,-526.5695 2378.3122,-515.5868 2402.5479,-498.1583 2419.1377,-485.0862"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2421.4736,-487.6991 2427.0727,-478.7046 2417.0867,-482.2442 2421.4736,-487.6991"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1891.9116,-584.5695C1945.7599,-581.9889 1958.0112,-570.8935 2011.5491,-564.5695 2132.2855,-550.3079 2163.7727,-560.4529 2284.4341,-545.5695"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1071.019,-589.5695C1253.1823,-599.3185 1709.5809,-590.4022 1891.9116,-584.5695"/>
</g>
<!-- sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~economiclifecyclecost.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node17"><a xlink:href="../sourcefile/economiclifecyclecost.f90.html" xlink:title="EconomicLifeCycleCost.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2354.8238,-633.575 2214.0444,-633.575 2214.0444,-611.5641 2354.8238,-611.5641 2354.8238,-633.575"/>
<text text-anchor="middle" x="2284.4341" y="-619.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EconomicLifeCycleCost.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economiclifecyclecost.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1071.019,-589.5695C1259.858,-602.8714 1306.2935,-623.5695 1495.6003,-623.5695 1495.6003,-623.5695 1495.6003,-623.5695 1891.9116,-623.5695 1999.8479,-623.5695 2124.479,-623.1867 2203.8288,-622.8948"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2204.2504,-626.3934 2214.2373,-622.8561 2204.2243,-619.3934 2204.2504,-626.3934"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M639.1267,-458.5695C675.652,-474.393 780.7092,-410.2028 829.1029,-378.4305"/>
<polygon fill="#ff0000" stroke="#ff0000" points="831.3167,-381.1623 837.7201,-372.7215 827.4506,-375.3268 831.3167,-381.1623"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M458.3831,-269.6906C478.1071,-305.5545 545.8684,-418.1682 639.1267,-458.5695"/>
</g>
<!-- sourcefile~economictariff.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~economictariff.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node19"><a xlink:href="../sourcefile/economictariff.f90.html" xlink:title="EconomicTariff.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2144.0785,-595.575 2045.71,-595.575 2045.71,-573.5641 2144.0785,-573.5641 2144.0785,-595.575"/>
<text text-anchor="middle" x="2094.8943" y="-581.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EconomicTariff.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economictariff.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economictariff.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1891.9116,-584.5695C1940.1592,-582.2573 1994.9317,-582.4212 2035.4104,-583.0724"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2035.5826,-586.5759 2045.6426,-583.2522 2035.7057,-579.577 2035.5826,-586.5759"/>
</g>
<!-- sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~thermalcomfort.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node20"><a xlink:href="../sourcefile/thermalcomfort.f90.html" xlink:title="ThermalComfort.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="906.9176,-488.575 801.1927,-488.575 801.1927,-466.5641 906.9176,-466.5641 906.9176,-488.575"/>
<text text-anchor="middle" x="854.0552" y="-474.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ThermalComfort.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M639.1267,-458.5695C687.1191,-479.3608 746.6951,-483.1246 790.943,-482.2499"/>
<polygon fill="#ff0000" stroke="#ff0000" points="791.0939,-485.7472 800.9913,-481.967 790.8967,-478.7499 791.0939,-485.7472"/>
</g>
<!-- sourcefile~economiclifecyclecost.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~economiclifecyclecost.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2319.9962,-611.4855C2331.2686,-607.5555 2343.6491,-602.7964 2354.6287,-597.5695 2394.7828,-578.4539 2401.7097,-567.9875 2440.118,-545.5695"/>
</g>
<!-- sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~roomairmanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node21"><a xlink:href="../sourcefile/roomairmanager.f90.html" xlink:title="RoomAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1126.7412,-296.575 1015.2969,-296.575 1015.2969,-274.5641 1126.7412,-274.5641 1126.7412,-296.575"/>
<text text-anchor="middle" x="1071.019" y="-282.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~roomairmodelusertemppattern.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~roomairmodelusertemppattern.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M920.0573,-350.4407C928.9596,-347.8049 937.792,-344.5599 945.8496,-340.5695 964.5137,-331.3266 963.4149,-320.2618 981.8496,-310.5695 989.8966,-306.3387 998.7394,-302.7572 1007.6336,-299.7445"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1008.792,-303.0491 1017.2699,-296.695 1006.6799,-296.3754 1008.792,-303.0491"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2144.1993,-590.8511C2214.8756,-597.3691 2346.7433,-600.0699 2440.118,-545.5695"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2102.093,-573.5173C2130.4746,-529.9431 2234.8592,-369.6818 2271.5651,-313.3273"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2274.7031,-314.9223 2277.2282,-304.6328 2268.8376,-311.1018 2274.7031,-314.9223"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~economiclifecyclecost.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2144.1988,-594.4544C2167.1432,-599.0544 2194.747,-604.5886 2219.3734,-609.5258"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2218.8698,-612.9944 2229.3627,-611.5285 2220.2458,-606.131 2218.8698,-612.9944"/>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M906.9868,-470.7879C920.6875,-467.0865 934.704,-461.3756 945.8496,-452.5695 972.0671,-431.8551 955.6013,-407.2449 981.8496,-386.5695 1014.0902,-361.1742 1032.0192,-375.3521 1071.019,-362.5695"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1071.019,-362.5695C1263.2479,-299.5646 1293.3097,-198.4531 1495.6003,-198.5695"/>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1071.019,-362.5695C1107.3375,-350.6658 1149.1381,-346.7357 1185.6493,-346.2162"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1185.819,-349.7154 1195.7981,-346.1564 1185.7776,-342.7155 1185.819,-349.7154"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~airflownetworkbalancemanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node25"><a xlink:href="../sourcefile/airflownetworkbalancemanager.f90.html" xlink:title="AirflowNetworkBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1160.3582,-450.575 981.6799,-450.575 981.6799,-428.5641 1160.3582,-428.5641 1160.3582,-450.575"/>
<text text-anchor="middle" x="1071.019" y="-436.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">AirflowNetworkBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M906.8531,-468.3223C934.2377,-463.526 968.1175,-457.5922 997.9741,-452.3629"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="998.6837,-455.792 1007.9299,-450.6192 997.476,-448.897 998.6837,-455.792"/>
</g>
<!-- sourcefile~weathermanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node26" class="node">
<title>sourcefile~weathermanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node26"><a xlink:href="../sourcefile/weathermanager.f90.html" xlink:title="WeatherManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2339.3128,-517.575 2229.5554,-517.575 2229.5554,-495.5641 2339.3128,-495.5641 2339.3128,-517.575"/>
<text text-anchor="middle" x="2284.4341" y="-503.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WeatherManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M906.747,-482.1017C1003.6217,-490.1817 1216.589,-506.7712 1396.5103,-512.5695 1704.2128,-522.4859 2072.1935,-513.2793 2219.1488,-508.7508"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2219.4577,-512.2429 2229.3438,-508.4331 2219.2396,-505.2463 2219.4577,-512.2429"/>
</g>
<!-- sourcefile~roomairmanager.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~roomairmanager.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1105.7215,-296.6164C1140.854,-307.8003 1195.3266,-325.1407 1233.667,-337.3457"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1232.9432,-340.7883 1243.5337,-340.4866 1235.0666,-334.1181 1232.9432,-340.7883"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1495.6003,-314.5695C1618.7711,-309.9942 1649.8626,-319.1689 1772.2742,-333.5695 1825.815,-339.8681 1838.5746,-345.7302 1891.9116,-353.5695"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1891.9116,-353.5695C1914.6792,-356.5832 2072.0556,-394.9857 2094.8943,-392.5695"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1321.2706,-340.4804C1364.8375,-330.1211 1434.4014,-316.0341 1495.6003,-314.5695"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2094.8943,-392.5695C2173.157,-384.2899 2366.8082,-284.9467 2440.118,-313.5695"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1495.6003,-314.5695C1552.6945,-312.4487 1617.2216,-327.608 1658.574,-339.6435"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1657.7299,-343.044 1668.313,-342.5455 1659.7289,-336.3355 1657.7299,-343.044"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1324.1546,-340.5453C1336.2849,-336.8486 1349.1567,-332.2007 1360.5103,-326.5695 1378.1914,-317.7999 1378.6227,-308.9102 1396.5103,-300.5695 1405.9541,-296.166 1416.2802,-292.4672 1426.5865,-289.3814"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1427.756,-292.6883 1436.4324,-286.6078 1425.8579,-285.9505 1427.756,-292.6883"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1338.2892,-362.6056C1365.2472,-367.5691 1397.2492,-373.4612 1425.3284,-378.6311"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1425.0108,-382.1314 1435.4793,-380.5001 1426.2784,-375.2471 1425.0108,-382.1314"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1503.2442,-264.3112C1521.7624,-237.9706 1571.8619,-172.1023 1630.6904,-139.5695 1701.4892,-100.4171 1727.8665,-108.5132 1808.2742,-99.5695 2022.749,-75.7136 2083.6818,-115.4047 2284.4341,-194.5695"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1548.1785,-286.6192C1563.3889,-290.408 1579.8785,-295.0971 1594.6904,-300.5695 1622.4269,-310.8171 1652.4635,-326.1324 1673.5955,-337.6682"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1671.9108,-340.736 1682.3556,-342.5124 1675.2983,-334.6102 1671.9108,-340.736"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1555.4265,-380.5273C1582.5876,-375.5141 1614.6365,-369.5988 1641.7824,-364.5884"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1642.7273,-367.9732 1651.9259,-362.7162 1641.4567,-361.0895 1642.7273,-367.9732"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1514.3444,-402.6259C1549.5535,-422.4752 1628.6065,-462.728 1701.4823,-469.5695"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1701.4823,-469.5695C1952.6431,-493.1484 2253.9621,-479.3086 2380.0434,-471.6346"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2380.4914,-475.1137 2390.2563,-471.003 2380.0593,-468.127 2380.4914,-475.1137"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1113.6101,-428.5074C1155.319,-418.0579 1220.8095,-402.6681 1278.3494,-393.5695"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node27" class="node">
<title>sourcefile~systemavailabilitymanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node27"><a xlink:href="../sourcefile/systemavailabilitymanager.f90.html" xlink:title="SystemAvailabilityManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1355.6556,-443.575 1201.0431,-443.575 1201.0431,-421.5641 1355.6556,-421.5641 1355.6556,-443.575"/>
<text text-anchor="middle" x="1278.3494" y="-429.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemAvailabilityManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1160.4501,-436.5501C1170.5604,-436.2088 1180.8549,-435.8612 1190.9389,-435.5207"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1191.062,-439.0187 1200.9382,-435.1831 1190.8258,-432.0226 1191.062,-439.0187"/>
</g>
<!-- sourcefile~weathermanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~weathermanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2318.167,-517.6576C2360.7045,-531.2335 2429.5898,-551.7146 2440.118,-545.5695"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2440.118,-545.5695C2499.584,-510.8608 2549.7856,-444.4544 2572.425,-411.3493"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2575.3965,-413.2025 2578.0644,-402.9491 2569.5847,-409.3008 2575.3965,-413.2025"/>
</g>
<!-- sourcefile~weathermanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~weathermanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2328.6304,-495.498C2346.5377,-491.0121 2367.3867,-485.7893 2386.1777,-481.082"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2387.2311,-484.4263 2396.0808,-478.6012 2385.53,-477.6361 2387.2311,-484.4263"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1302.3694,-421.4614C1321.4462,-411.2997 1347.0748,-394.3772 1360.5103,-371.5695 1421.9564,-267.2605 1321.8847,-196.8954 1396.5103,-101.5695 1406.9859,-88.1881 1422.7143,-79.3881 1438.5727,-73.6047"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1440.0043,-76.8188 1448.4178,-70.3795 1437.8251,-70.1666 1440.0043,-76.8188"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1328.6745,-421.5177C1339.6048,-417.9709 1350.7935,-413.3992 1360.5103,-407.5695 1379.9135,-395.9284 1376.518,-382.1671 1396.5103,-371.5695 1436.1304,-350.5677 1451.1563,-358.5325 1495.6003,-352.5695"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1295.0613,-443.6493C1317.173,-457.5793 1357.8763,-480.7381 1396.5103,-489.5695 1482.3755,-509.1977 1512.842,-522.1107 1594.6904,-489.5695 1615.1412,-481.4387 1611.3425,-466.0577 1630.6904,-455.5695 1686.3658,-425.3888 1756.4482,-409.5012 1810.0026,-401.2347"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1810.7653,-404.6599 1820.143,-399.7295 1809.7375,-397.7358 1810.7653,-404.6599"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1336.8544,-421.5283C1364.6226,-416.2879 1397.9875,-409.9912 1426.9474,-404.5258"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1427.8134,-407.9243 1436.9908,-402.6304 1426.5152,-401.0457 1427.8134,-407.9243"/>
</g>
<!-- sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node28" class="node">
<title>sourcefile~simairservingzones.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node28"><a xlink:href="../sourcefile/simairservingzones.f90.html" xlink:title="SimAirServingZones.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1558.3139,-480.575 1432.8868,-480.575 1432.8868,-458.5641 1558.3139,-458.5641 1558.3139,-480.575"/>
<text text-anchor="middle" x="1495.6003" y="-466.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimAirServingZones.f90</text>
</a>
</g>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1343.2375,-443.6206C1368.2938,-447.888 1397.0773,-452.7901 1422.8318,-457.1763"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1422.4664,-460.6644 1432.9121,-458.8931 1423.6417,-453.7638 1422.4664,-460.6644"/>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1557.7305,-458.5421C1570.3561,-455.0316 1583.2598,-450.4687 1594.6904,-444.5695 1604.4425,-439.5366 1653.3847,-396.495 1681.5088,-371.4511"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1684.0395,-373.8838 1689.1711,-364.6147 1679.3792,-368.6606 1684.0395,-373.8838"/>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1558.3619,-466.533C1599.2178,-465.3042 1653.6179,-465.076 1701.4823,-469.5695"/>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge76" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1523.8805,-110.4836C1579.2097,-88.8262 1696.8207,-42.9595 1701.4823,-42.5695"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1701.4823,-42.5695C1875.7236,-27.9949 1924.946,-1.4596 2094.8943,-42.5695"/>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge74" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1701.4823,-198.5695C1753.665,-214.0878 1757.4706,-239.0029 1808.2742,-258.5695 1843.8464,-272.2699 1854.7438,-269.1057 1891.9116,-277.5695"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1518.6287,-132.6609C1545.2021,-145.1751 1590.4201,-165.6012 1630.6904,-179.5695 1661.4681,-190.2452 1670.2572,-189.2837 1701.4823,-198.5695"/>
</g>
<!-- sourcefile~solarshading.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node35" class="node">
<title>sourcefile~solarshading.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node35"><a xlink:href="../sourcefile/solarshading.f90.html" xlink:title="SolarShading.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1937.9725,-130.575 1845.8508,-130.575 1845.8508,-108.5641 1937.9725,-108.5641 1937.9725,-130.575"/>
<text text-anchor="middle" x="1891.9116" y="-116.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SolarShading.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge75" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1701.4823,-42.5695C1765.7473,-37.194 1834.2439,-77.8368 1868.9249,-102.1651"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1867.2235,-105.2528 1877.385,-108.2518 1871.3117,-99.5706 1867.2235,-105.2528"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node36" class="node">
<title>sourcefile~windowequivalentlayer.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node36"><a xlink:href="../sourcefile/windowequivalentlayer.f90.html" xlink:title="WindowEquivalentLayer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1772.0667,-170.575 1630.8979,-170.575 1630.8979,-148.5641 1772.0667,-148.5641 1772.0667,-170.575"/>
<text text-anchor="middle" x="1701.4823" y="-156.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowEquivalentLayer.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge77" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1555.4265,-132.6117C1579.2179,-137.003 1606.7594,-142.0864 1631.4711,-146.6474"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1631.0377,-150.1265 1641.5069,-148.4998 1632.3083,-143.2428 1631.0377,-150.1265"/>
</g>
<!-- sourcefile~roomairmodelcrossvent.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge78" class="edge">
<title>sourcefile~roomairmodelcrossvent.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M922.4061,-309.5433C948.8331,-305.2802 978.9589,-300.4204 1005.1461,-296.196"/>
<polygon fill="#ffff00" stroke="#ffff00" points="1006.0336,-299.5981 1015.3486,-294.5501 1004.9187,-292.6875 1006.0336,-299.5981"/>
</g>
<!-- sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge79" class="edge">
<title>sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1316.575,-132.5772C1330.4785,-136.7447 1346.2708,-141.6697 1360.5103,-146.5695 1421.3439,-167.5027 1431.2658,-198.5325 1495.6003,-198.5695"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1495.6003,-198.5695C1587.1034,-198.6222 1613.7753,-172.4869 1701.4823,-198.5695"/>
</g>
<!-- sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge80" class="edge">
<title>sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1333.4518,-121.5695C1361.0021,-121.5695 1394.6764,-121.5695 1424.1839,-121.5695"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1424.4305,-125.0696 1434.4305,-121.5695 1424.4305,-118.0696 1424.4305,-125.0696"/>
</g>
<!-- sourcefile~roomairmodelufad.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge81" class="edge">
<title>sourcefile~roomairmodelufad.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M917.6855,-281.3292C945.1921,-282.0899 977.368,-282.9797 1005.123,-283.7472"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1005.0387,-287.2461 1015.1317,-284.024 1005.2323,-280.2488 1005.0387,-287.2461"/>
</g>
<!-- sourcefile~roomairmodeldisplacementvent.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge82" class="edge">
<title>sourcefile~roomairmodeldisplacementvent.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M904.9236,-249.5889C936.3652,-256.4 976.9031,-265.1816 1010.0593,-272.3641"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1009.5796,-275.8413 1020.0939,-274.5378 1011.0616,-268.9999 1009.5796,-275.8413"/>
</g>
<!-- sourcefile~roomairmodelmundt.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge83" class="edge">
<title>sourcefile~roomairmodelmundt.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M918.3224,-206.7287C927.9518,-209.6482 937.4543,-213.4967 945.8496,-218.5695 966.8919,-231.2843 961.1214,-247.3489 981.8496,-260.5695 989.0593,-265.168 997.1223,-268.9348 1005.3727,-272.017"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1004.5097,-275.4204 1015.1042,-275.3296 1006.7655,-268.7938 1004.5097,-275.4204"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge65" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1931.4193,-130.5999C1945.6329,-135.1363 1961.5949,-140.9012 1975.5491,-147.5695 1992.6802,-155.756 1994.2472,-162.7505 2011.5491,-170.5695 2046.6761,-186.4441 2058.1223,-183.0053 2094.8943,-194.5695"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2094.8943,-194.5695C2175.2541,-219.8415 2206.0673,-163.6663 2284.4341,-194.5695"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1937.9839,-116.4378C2011.4696,-112.1197 2159.6577,-106.1848 2284.4341,-118.5695"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1913.6739,-130.7372C1931.974,-140.9739 1957.9017,-157.557 1975.5491,-177.5695 1998.4265,-203.5131 1984.8865,-224.5342 2011.5491,-246.5695 2016.1741,-250.3919 2021.3703,-253.63 2026.849,-256.3731"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2025.7233,-259.702 2036.2852,-260.5379 2028.5499,-253.298 2025.7233,-259.702"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2094.8943,-194.5695C2131.6663,-206.1338 2143.49,-201.8846 2178.2395,-218.5695 2210.4292,-234.0254 2243.3894,-259.0209 2263.8746,-275.8629"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2261.6782,-278.5887 2271.5967,-282.3136 2266.166,-273.2164 2261.6782,-278.5887"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge73" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1749.2454,-170.6654C1757.5679,-174.1366 1765.6621,-178.6672 1772.2742,-184.5695 1799.5589,-208.9256 1779.6223,-235.8374 1808.2742,-258.5695 1838.1364,-282.262 1854.7438,-269.1057 1891.9116,-277.5695"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1891.9116,-277.5695C1930.4027,-286.3347 1974.0555,-286.2843 2010.9907,-283.4533"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2011.5518,-286.9184 2021.2204,-282.586 2010.9604,-279.9434 2011.5518,-286.9184"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge71" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2094.8943,-232.5695C2131.3347,-243.3184 2141.948,-240.3282 2178.2395,-251.5695 2202.7632,-259.1658 2229.6486,-269.8235 2250.2317,-278.5019"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2248.931,-281.7521 2259.5024,-282.4561 2251.6774,-275.3133 2248.931,-281.7521"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1772.0729,-152.1965C1829.1099,-149.0181 1910.3401,-150.8986 1975.5491,-177.5695 1995.0922,-185.5628 1992.9753,-198.5275 2011.5491,-208.5695 2045.4579,-226.9026 2057.9217,-221.6637 2094.8943,-232.5695"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge70" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1754.022,-148.5335C1779.3883,-143.2052 1809.8495,-136.8068 1835.6828,-131.3805"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1836.636,-134.7567 1845.7029,-129.2757 1835.197,-127.9062 1836.636,-134.7567"/>
</g>
<!-- sourcefile~windowmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node37" class="node">
<title>sourcefile~windowmanager.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node37"><a xlink:href="../sourcefile/windowmanager.f90.html" xlink:title="WindowManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1945.6373,-208.575 1838.1859,-208.575 1838.1859,-186.5641 1945.6373,-186.5641 1945.6373,-208.575"/>
<text text-anchor="middle" x="1891.9116" y="-194.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge69" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1756.8181,-170.6117C1779.1065,-175.0594 1804.9533,-180.2171 1828.0347,-184.823"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1827.5879,-188.3027 1838.0795,-186.8274 1828.9578,-181.4381 1827.5879,-188.3027"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_node38" class="node">
<title>sourcefile~heatbalanceintradexchange.f90</title>
<g id="a_sourcefile~~electricpowergenerators.f90~~AfferentGraph_node38"><a xlink:href="../sourcefile/heatbalanceintradexchange.f90.html" xlink:title="HeatBalanceIntRadExchange.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1975.6867,-249.575 1808.1365,-249.575 1808.1365,-227.5641 1975.6867,-227.5641 1975.6867,-249.575"/>
<text text-anchor="middle" x="1891.9116" y="-235.4195" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceIntRadExchange.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge72" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1741.6984,-170.6287C1752.0388,-174.3048 1762.8874,-178.9337 1772.2742,-184.5695 1790.8829,-195.7421 1789.1638,-207.2785 1808.2742,-217.5695 1812.8526,-220.035 1817.7284,-222.2181 1822.7365,-224.15"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1821.8923,-227.5627 1832.4871,-227.5637 1824.2054,-220.9559 1821.8923,-227.5627"/>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge67" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1945.7321,-207.5702C1955.9071,-210.4318 1966.2633,-214.0436 1975.5491,-218.5695 1993.7698,-227.4504 1993.5347,-237.2772 2011.5491,-246.5695 2019.6338,-250.7399 2028.5268,-254.3316 2037.4004,-257.3861"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2036.3904,-260.7379 2046.9823,-260.4917 2038.5486,-254.079 2036.3904,-260.7379"/>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge66" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1945.6814,-203.3845C1987.0493,-208.6834 2045.3322,-217.9501 2094.8943,-232.5695"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowergenerators.f90~~AfferentGraph_edge68" class="edge">
<title>sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1959.7841,-249.6039C1978.1504,-252.5898 1998.1727,-255.845 2017.0408,-258.9125"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2016.6537,-262.3954 2027.0858,-260.5455 2017.777,-255.4861 2016.6537,-262.3954"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileelectricpowergeneratorsf90AfferentGraph = svgPanZoom('#sourcefileelectricpowergeneratorsf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/generatorfuelsupply.html">GeneratorFuelSupply</a>

      <a class="list-group-item" href="../module/generatordynamicsmanager.html">GeneratorDynamicsManager</a>

      <a class="list-group-item" href="../module/microchpelectricgenerator.html">MicroCHPElectricGenerator</a>

      <a class="list-group-item" href="../module/fuelcellelectricgenerator.html">FuelCellElectricGenerator</a>

      <a class="list-group-item" href="../module/icengineelectricgenerator.html">ICEngineElectricGenerator</a>

      <a class="list-group-item" href="../module/ctelectricgenerator.html">CTElectricGenerator</a>

      <a class="list-group-item" href="../module/microturbineelectricgenerator.html">MicroturbineElectricGenerator</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html#src">ElectricPowerGenerators.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!Note: Multiple fortran Modules related to Generators are included in this file.</span>
<a name="ln-2"></a><span class="c">!      Find the Generator you are looking for by searching for &quot;Module &lt;name&gt;&quot;</span>
<a name="ln-3"></a><span class="c">! File Contents:</span>
<a name="ln-4"></a><span class="c">!</span>
<a name="ln-5"></a><span class="c">!_______________________________________________</span>
<a name="ln-6"></a><span class="c">!Utility modules used by other generators.</span>
<a name="ln-7"></a><span class="c">!</span>
<a name="ln-8"></a><span class="c">! GeneratorFuelSupply</span>
<a name="ln-9"></a><span class="c">!   reused among some generators to define gaseous fuel chemistry, optional compressor)</span>
<a name="ln-10"></a><span class="c">!</span>
<a name="ln-11"></a><span class="c">! GeneratorDynamicsManager</span>
<a name="ln-12"></a><span class="c">!   reused among some generators to track on/off state, transient limits, control implications etc.</span>
<a name="ln-13"></a><span class="c">!</span>
<a name="ln-14"></a><span class="c">!_______________________________________________________________________</span>
<a name="ln-15"></a><span class="c">! IEA Annex 42 generators:</span>
<a name="ln-16"></a><span class="c">! MicroCHPElectricGenerator</span>
<a name="ln-17"></a><span class="c">! (small-scale/residential internal combustion and Stirling Engine for CHP, )</span>
<a name="ln-18"></a><span class="c">!</span>
<a name="ln-19"></a><span class="c">! FuelCellElectricGenerator  (Solid Oxide Fuel Cell (SOFC))</span>
<a name="ln-20"></a><span class="c">!                            (Proton Exchange Membrane FC (PEMFC))</span>
<a name="ln-21"></a><span class="c">!                            IEA/ECBCS Annex 42 model)</span>
<a name="ln-22"></a>
<a name="ln-23"></a><span class="c">!__________________________________________________________________________</span>
<a name="ln-24"></a><span class="c">! BLAST inherited generators:</span>
<a name="ln-25"></a><span class="c">! ICENGINEElectricGenerator (Internal Combustion, curve fit from BLAST)</span>
<a name="ln-26"></a><span class="c">!</span>
<a name="ln-27"></a><span class="c">! CTElectricGenerator (COMBUSTION Turbine)</span>
<a name="ln-28"></a><span class="c">!__________________________________________________________________________</span>
<a name="ln-29"></a><span class="c">!</span>
<a name="ln-30"></a><span class="c">! New microturbine model added by FSEC:</span>
<a name="ln-31"></a><span class="c">!   MicroturbineElectricGenerator  ! Microturbine Electric Generator Module</span>
<a name="ln-32"></a><span class="c">!</span>
<a name="ln-33"></a><span class="c">!*******************************************************************************************************</span>
<a name="ln-34"></a><span class="c">! ****************************************************************************************************</span>
<a name="ln-35"></a><span class="k">MODULE </span><span class="n">GeneratorFuelSupply</span>
<a name="ln-36"></a>
<a name="ln-37"></a>          <span class="c">! Module containing the routines dealing with the fuel supply for some generators</span>
<a name="ln-38"></a>          <span class="c">! different generator modules can reuse the same fuel supply code, hence a seperate module</span>
<a name="ln-39"></a>
<a name="ln-40"></a>          <span class="c">! MODULE INFORMATION:</span>
<a name="ln-41"></a>          <span class="c">!       AUTHOR         B Griffith</span>
<a name="ln-42"></a>          <span class="c">!       DATE WRITTEN   July 2006</span>
<a name="ln-43"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-44"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-45"></a>
<a name="ln-46"></a>          <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-47"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-48"></a>
<a name="ln-49"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-50"></a>          <span class="c">! data defined in DataGenerators.f90</span>
<a name="ln-51"></a>          <span class="c">! this module only provides input and subroutines for other component simulations</span>
<a name="ln-52"></a>          <span class="c">!  no specific energyplus component is modeled here.  it is used by other generators</span>
<a name="ln-53"></a>
<a name="ln-54"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-55"></a>          <span class="c">! Annex 42 documentation</span>
<a name="ln-56"></a>
<a name="ln-57"></a>          <span class="c">! OTHER NOTES:</span>
<a name="ln-58"></a>          <span class="c">! na</span>
<a name="ln-59"></a>
<a name="ln-60"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-61"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-62"></a><span class="k">USE </span><span class="n">DataGenerators</span>
<a name="ln-63"></a><span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MaxNameLength</span><span class="p">,</span> <span class="n">OutputFileInits</span><span class="p">,</span> <span class="n">HoursInDay</span>
<a name="ln-64"></a><span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="n">ShowContinueError</span>
<a name="ln-65"></a>
<a name="ln-66"></a>          <span class="c">! &lt;use statements for access to subroutines in other modules&gt;</span>
<a name="ln-67"></a>
<a name="ln-68"></a><span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-69"></a>
<a name="ln-70"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-71"></a>
<a name="ln-72"></a>          <span class="c">! MODULE PARAMETER DEFINITIONS:</span>
<a name="ln-73"></a>          <span class="c">! na</span>
<a name="ln-74"></a>
<a name="ln-75"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-76"></a>          <span class="c">! na</span>
<a name="ln-77"></a>
<a name="ln-78"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-79"></a>          <span class="c">! na</span>
<a name="ln-80"></a>
<a name="ln-81"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE</span>
<a name="ln-82"></a>
<a name="ln-83"></a>          <span class="c">! &lt;name Public routines, optionally name Private routines within this module&gt;</span>
<a name="ln-84"></a>
<a name="ln-85"></a><span class="k">PUBLIC </span><span class="n">GetGeneratorFuelSupplyInput</span>
<a name="ln-86"></a><span class="k">PUBLIC </span><span class="n">SetupFuelConstituentData</span>
<a name="ln-87"></a>
<a name="ln-88"></a><span class="k">CONTAINS</span>
<a name="ln-89"></a>
<a name="ln-90"></a><span class="k">SUBROUTINE </span><span class="n">GetGeneratorFuelSupplyInput</span>
<a name="ln-91"></a>
<a name="ln-92"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-93"></a>          <span class="c">!       AUTHOR         B Griffith</span>
<a name="ln-94"></a>          <span class="c">!       DATE WRITTEN   July 2006,</span>
<a name="ln-95"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-96"></a>          <span class="c">!       RE-ENGINEERED  this module extracted from older SOFC module for</span>
<a name="ln-97"></a>          <span class="c">!                      reuse with both Annex 42 models,</span>
<a name="ln-98"></a>
<a name="ln-99"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-100"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-101"></a>
<a name="ln-102"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-103"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-104"></a>
<a name="ln-105"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-106"></a>          <span class="c">! na</span>
<a name="ln-107"></a>
<a name="ln-108"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-109"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">SameString</span> <span class="c">! might also use FindItemInList</span>
<a name="ln-110"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-111"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-112"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurveIndex</span>
<a name="ln-113"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span>
<a name="ln-114"></a>  <span class="k">USE </span><span class="n">DataLoopNode</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">NodeConnectionType_Sensor</span><span class="p">,</span> <span class="n">NodeType_Air</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span>
<a name="ln-115"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-116"></a>
<a name="ln-117"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-118"></a>
<a name="ln-119"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-120"></a>          <span class="c">! na</span>
<a name="ln-121"></a>
<a name="ln-122"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-123"></a>          <span class="c">! na</span>
<a name="ln-124"></a>
<a name="ln-125"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-126"></a>          <span class="c">! na</span>
<a name="ln-127"></a>
<a name="ln-128"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-129"></a>          <span class="c">! na</span>
<a name="ln-130"></a>
<a name="ln-131"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-132"></a><span class="c">!  INTEGER                     :: GeneratorNum !Generator counter</span>
<a name="ln-133"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumAlphas</span>  <span class="c">! Number of elements in the alpha array</span>
<a name="ln-134"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumNums</span>    <span class="c">! Number of elements in the numeric array</span>
<a name="ln-135"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">IOStat</span>     <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-136"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">AlphArray</span> <span class="c">!character string data</span>
<a name="ln-137"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>                        <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NumArray</span>  <span class="c">!numeric data TODO deal with allocatable for extensible</span>
<a name="ln-138"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! error flag</span>
<a name="ln-139"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsNotOK</span>              <span class="c">! Flag to verify name</span>
<a name="ln-140"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsBlank</span>              <span class="c">! Flag for blank name</span>
<a name="ln-141"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">FuelSupNum</span>    <span class="c">!</span>
<a name="ln-142"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">!</span>
<a name="ln-143"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObjMSGName</span>
<a name="ln-144"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">ConstitNum</span>
<a name="ln-145"></a>
<a name="ln-146"></a><span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-147"></a><span class="k">  </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Generator:FuelSupply&#39;</span>
<a name="ln-148"></a>  <span class="n">NumGeneratorFuelSups</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-149"></a>
<a name="ln-150"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumGeneratorFuelSups</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-151"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; equipment specified in input file&#39;</span><span class="p">)</span>
<a name="ln-152"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-153"></a>  <span class="n">ENDIF</span>
<a name="ln-154"></a>
<a name="ln-155"></a>  <span class="k">Allocate</span><span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">NumGeneratorFuelSups</span><span class="p">))</span>
<a name="ln-156"></a>
<a name="ln-157"></a>  <span class="k">DO </span><span class="n">FuelSupNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumGeneratorFuelSups</span>
<a name="ln-158"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">FuelSupNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-159"></a>                    <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-160"></a>                    <span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-161"></a>
<a name="ln-162"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-163"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-164"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelSupply</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">FuelSupNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-165"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-166"></a><span class="k">     </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-167"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-168"></a>    <span class="n">ENDIF</span>
<a name="ln-169"></a>
<a name="ln-170"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">Name</span>     <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-171"></a>    <span class="n">ObjMSGName</span> <span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Named &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-172"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;TemperatureFromAirNode&#39;</span><span class="p">,</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-173"></a><span class="k">        </span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">FuelTempMode</span> <span class="o">=</span> <span class="n">FuelInTempFromNode</span>
<a name="ln-174"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;Scheduled&#39;</span><span class="p">,</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-175"></a><span class="k">        </span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">FuelTempMode</span> <span class="o">=</span> <span class="n">FuelInTempSchedule</span>
<a name="ln-176"></a>    <span class="k">ELSE</span>
<a name="ln-177"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-178"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-179"></a>        <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-180"></a>    <span class="n">ENDIF</span>
<a name="ln-181"></a>
<a name="ln-182"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">NodeName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-183"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">NodeNum</span>  <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-184"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-185"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Sensor</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-186"></a>
<a name="ln-187"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">SchedNum</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-188"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">SchedNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-189"></a>       <span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">FuelTempMode</span> <span class="o">==</span> <span class="n">FuelInTempSchedule</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-190"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-191"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-192"></a>       <span class="k">CAll </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Schedule named was not found&#39;</span><span class="p">)</span>
<a name="ln-193"></a>       <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-194"></a>    <span class="n">ENDIF</span>
<a name="ln-195"></a>
<a name="ln-196"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">CompPowerCurveID</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-197"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">CompPowerCurveID</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-198"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-199"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-200"></a>       <span class="k">Call </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve named was not found &#39;</span> <span class="p">)</span>
<a name="ln-201"></a>       <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-202"></a>    <span class="n">ENDIF</span>
<a name="ln-203"></a>
<a name="ln-204"></a>    <span class="n">FuelSupply</span><span class="p">%</span><span class="n">CompPowerLossFactor</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-205"></a>
<a name="ln-206"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="s1">&#39;GaseousConstituents&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-207"></a><span class="k">      </span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">FuelTypeMode</span> <span class="o">=</span> <span class="n">fuelModeGaseousConstituents</span>
<a name="ln-208"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">samestring</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="s1">&#39;LiquidGeneric&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-209"></a><span class="k">      </span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">FuelTypeMode</span> <span class="o">=</span> <span class="n">fuelModeGenericLiquid</span>
<a name="ln-210"></a>    <span class="k">ELSE</span>
<a name="ln-211"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-212"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-213"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-214"></a>    <span class="n">ENDIF</span>
<a name="ln-215"></a>
<a name="ln-216"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">LHVliquid</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span> <span class="c">!generic liquid LHV  (kJ/kG input converted to J/kG )</span>
<a name="ln-217"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">HHV</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span> <span class="c">!generic liquid HHV (kJ/kG input converted to J/kG )</span>
<a name="ln-218"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">MW</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c">!</span>
<a name="ln-219"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">eCO2</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c">!</span>
<a name="ln-220"></a>
<a name="ln-221"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">FuelTypeMode</span> <span class="o">==</span> <span class="n">fuelModeGaseousConstituents</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-222"></a><span class="k">      </span><span class="n">NumFuelConstit</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-223"></a>      <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">NumConstituents</span> <span class="o">=</span> <span class="n">NumFuelConstit</span>
<a name="ln-224"></a>
<a name="ln-225"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NumFuelConstit</span> <span class="o">&gt;</span> <span class="mi">12</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-226"></a><span class="k">        CALL </span><span class="n">showSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; model not set up for more than 12 fuel constituents&#39;</span><span class="p">)</span>
<a name="ln-227"></a>        <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-228"></a>      <span class="n">ENDIF</span>
<a name="ln-229"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">NumFuelConstit</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-230"></a><span class="k">        CALL </span><span class="n">showSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; model needs at least one fuel constituent&#39;</span><span class="p">)</span>
<a name="ln-231"></a>        <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-232"></a>      <span class="n">ENDIF</span>
<a name="ln-233"></a>
<a name="ln-234"></a>      <span class="k">DO </span><span class="n">ConstitNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumFuelConstit</span>
<a name="ln-235"></a>        <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">ConstitName</span><span class="p">(</span><span class="n">ConstitNum</span><span class="p">)</span>       <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="n">ConstitNum</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span>
<a name="ln-236"></a>        <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">ConstitNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="n">ConstitNum</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span>
<a name="ln-237"></a>
<a name="ln-238"></a>      <span class="n">ENDDO</span>
<a name="ln-239"></a>
<a name="ln-240"></a>      <span class="c">! check for molar fractions summing to 1.0.</span>
<a name="ln-241"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="nb">SUM</span><span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">ConstitMolalFract</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">0001</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-242"></a><span class="k">        CALL </span><span class="n">showSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; molar fractions do not sum to 1.0&#39;</span><span class="p">)</span>
<a name="ln-243"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Sum was=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">SUM</span><span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">ConstitMolalFract</span><span class="p">),</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-244"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-245"></a>        <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-246"></a>      <span class="n">ENDIF</span>
<a name="ln-247"></a>    <span class="n">ENDIF</span>
<a name="ln-248"></a>
<a name="ln-249"></a>  <span class="n">ENDDO</span>
<a name="ln-250"></a>
<a name="ln-251"></a>  <span class="c">!now make calls to Setup</span>
<a name="ln-252"></a>
<a name="ln-253"></a>  <span class="k">DO </span><span class="n">FuelSupNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumGeneratorFuelSups</span>
<a name="ln-254"></a>    <span class="k">CAll </span><span class="n">SetupFuelConstituentData</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-255"></a>  <span class="n">ENDDO</span>
<a name="ln-256"></a>
<a name="ln-257"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-258"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Problem found processing input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-259"></a>  <span class="n">ENDIF</span>
<a name="ln-260"></a>
<a name="ln-261"></a>  <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-262"></a><span class="n">ENDIF</span> <span class="c">! MyOneTimeFlag</span>
<a name="ln-263"></a>
<a name="ln-264"></a><span class="k">RETURN</span>
<a name="ln-265"></a>
<a name="ln-266"></a><span class="k">END SUBROUTINE </span><span class="n">GetGeneratorFuelSupplyInput</span>
<a name="ln-267"></a><span class="c">!******************************************************************************</span>
<a name="ln-268"></a><span class="k">SUBROUTINE </span><span class="n">SetupFuelConstituentData</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-269"></a>
<a name="ln-270"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-271"></a>          <span class="c">!       AUTHOR         B Griffith</span>
<a name="ln-272"></a>          <span class="c">!       DATE WRITTEN   Aug 2005,</span>
<a name="ln-273"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-274"></a>          <span class="c">!       RE-ENGINEERED  July/Aug 2006, extracted to own module. added liquid fuel option</span>
<a name="ln-275"></a>
<a name="ln-276"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-277"></a>          <span class="c">! Fill data structure for gas phase thermochemistry</span>
<a name="ln-278"></a>
<a name="ln-279"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-280"></a>          <span class="c">! Hardcoded data from NIST is filled into data structure one time only</span>
<a name="ln-281"></a>
<a name="ln-282"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-283"></a>          <span class="c">! na</span>
<a name="ln-284"></a>
<a name="ln-285"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-286"></a>          <span class="c">! na</span>
<a name="ln-287"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">FindItem</span>
<a name="ln-288"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-289"></a>
<a name="ln-290"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-291"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FuelSupplyNum</span>
<a name="ln-292"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-293"></a>
<a name="ln-294"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-295"></a>          <span class="c">! na</span>
<a name="ln-296"></a>
<a name="ln-297"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-298"></a>          <span class="c">! na</span>
<a name="ln-299"></a>
<a name="ln-300"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-301"></a>          <span class="c">! na</span>
<a name="ln-302"></a>
<a name="ln-303"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-304"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NumHardCodedConstituents</span>  <span class="c">!number of gases included in data</span>
<a name="ln-305"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LHVfuel</span> <span class="c">! lower heating value of fuel, working var</span>
<a name="ln-306"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HHVfuel</span> <span class="c">! higher heating value of fuel, working var</span>
<a name="ln-307"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">O2Stoic</span> <span class="c">! stochiometric oxygen coef in chemical equation (15)</span>
<a name="ln-308"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CO2ProdStoic</span> <span class="c">! product gases carbon dioxide coeff</span>
<a name="ln-309"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H20ProdStoic</span> <span class="c">! product gases water coeff</span>
<a name="ln-310"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">i</span>  <span class="c">! loop index</span>
<a name="ln-311"></a>  <span class="kt">Character</span><span class="p">(</span><span class="nb">Len</span><span class="o">=</span><span class="n">maxnamelength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">thisName</span> <span class="c">! working string var</span>
<a name="ln-312"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">thisGasID</span>  <span class="c">! working index in Gas phase data structure</span>
<a name="ln-313"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CO2dataID</span>  <span class="c">! hard wired to CO2 index in gas data struct</span>
<a name="ln-314"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">WaterDataID</span> <span class="c">! hard wired to Water index in gas data struct</span>
<a name="ln-315"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LHVi</span>  <span class="c">!working var for lower heating value calc</span>
<a name="ln-316"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HHVi</span>  <span class="c">!working var for higher heating value calc</span>
<a name="ln-317"></a><span class="c">!  INTEGER   :: thisConstituent</span>
<a name="ln-318"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MWfuel</span>
<a name="ln-319"></a><span class="c">!unused  REAL(r64) :: DelfHfuel</span>
<a name="ln-320"></a><span class="c">!unused  REAL(r64) :: h_i</span>
<a name="ln-321"></a><span class="c">!unused  REAL(r64) :: LHV</span>
<a name="ln-322"></a>
<a name="ln-323"></a>  <span class="n">NumHardCodedConstituents</span> <span class="o">=</span> <span class="mi">14</span>
<a name="ln-324"></a>
<a name="ln-325"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-326"></a><span class="k">     ALLOCATE</span><span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">NumHardCodedConstituents</span><span class="p">))</span>
<a name="ln-327"></a>
<a name="ln-328"></a>  <span class="n">endif</span>
<a name="ln-329"></a>  <span class="c">! Carbon Dioxide (CO2) Temp K 298-1200 (Chase 1998)</span>
<a name="ln-330"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ConstituentName</span>                  <span class="o">=</span> <span class="s1">&#39;CarbonDioxide&#39;</span>
<a name="ln-331"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ConstituentFormula</span>               <span class="o">=</span> <span class="s1">&#39;CO2&#39;</span>
<a name="ln-332"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span> <span class="o">=</span> <span class="o">-</span><span class="mi">39</span><span class="mf">3.5224d0</span>  <span class="c">!KJ/mol</span>
<a name="ln-333"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">=</span> <span class="n">NISTShomate</span>
<a name="ln-334"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ShomateA</span> <span class="o">=</span>  <span class="mi">2</span><span class="mf">4.99735d0</span>
<a name="ln-335"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ShomateB</span> <span class="o">=</span>  <span class="mi">5</span><span class="mf">5.18696d0</span>
<a name="ln-336"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ShomateC</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="mf">3.69137d0</span>
<a name="ln-337"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ShomateD</span> <span class="o">=</span>  <span class="mf">7.948387d0</span>
<a name="ln-338"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ShomateE</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.136638d0</span>
<a name="ln-339"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ShomateF</span> <span class="o">=</span> <span class="o">-</span><span class="mi">40</span><span class="mf">3.6075d0</span>
<a name="ln-340"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ShomateG</span> <span class="o">=</span>  <span class="mi">22</span><span class="mf">8.2431d0</span>
<a name="ln-341"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">ShomateH</span> <span class="o">=</span> <span class="o">-</span><span class="mi">39</span><span class="mf">3.5224d0</span>
<a name="ln-342"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">NumCarbons</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-343"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-344"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">NumOxygens</span>   <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-345"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">MolecularWeight</span> <span class="o">=</span> <span class="mi">4</span><span class="mf">4.01d0</span>
<a name="ln-346"></a>
<a name="ln-347"></a>
<a name="ln-348"></a>  <span class="c">! Nitrogen (N2) Temp (K) 298-6000</span>
<a name="ln-349"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">ConstituentName</span>                  <span class="o">=</span> <span class="s1">&#39;Nitrogen&#39;</span>
<a name="ln-350"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">ConstituentFormula</span>               <span class="o">=</span> <span class="s1">&#39;N2&#39;</span>
<a name="ln-351"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-352"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">=</span> <span class="n">NISTShomate</span>
<a name="ln-353"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">ShomateA</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">6.092d0</span>
<a name="ln-354"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">ShomateB</span> <span class="o">=</span> <span class="mf">8.218801d0</span>
<a name="ln-355"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">ShomateC</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.976141d0</span>
<a name="ln-356"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">ShomateD</span> <span class="o">=</span> <span class="mf">0.159274d0</span>
<a name="ln-357"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">ShomateE</span> <span class="o">=</span> <span class="mf">0.044434d0</span>
<a name="ln-358"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">ShomateF</span> <span class="o">=</span> <span class="o">-</span><span class="mf">7.98923d0</span>
<a name="ln-359"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">ShomateG</span> <span class="o">=</span> <span class="mi">22</span><span class="mf">1.02d0</span>
<a name="ln-360"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">ShomateH</span> <span class="o">=</span> <span class="mf">0.000d0</span>
<a name="ln-361"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">NumCarbons</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-362"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-363"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">NumOxygens</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-364"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">MolecularWeight</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">8.01d0</span>
<a name="ln-365"></a>
<a name="ln-366"></a>  <span class="c">! Oxygen (O2) Temp (K) 298-6000</span>
<a name="ln-367"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">ConstituentName</span>                  <span class="o">=</span>  <span class="s1">&#39;Oxygen&#39;</span>
<a name="ln-368"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">ConstituentFormula</span>               <span class="o">=</span>  <span class="s1">&#39;O2&#39;</span>
<a name="ln-369"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span> <span class="o">=</span>  <span class="mf">0.0d0</span>
<a name="ln-370"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">=</span> <span class="n">NISTShomate</span>
<a name="ln-371"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">ShomateA</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">9.659d0</span>
<a name="ln-372"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">ShomateB</span> <span class="o">=</span> <span class="mf">6.137261d0</span>
<a name="ln-373"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">ShomateC</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.186521d0</span>
<a name="ln-374"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">ShomateD</span> <span class="o">=</span> <span class="mf">0.095780d0</span>
<a name="ln-375"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">ShomateE</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.219663d0</span>
<a name="ln-376"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">ShomateF</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.861391d0</span>
<a name="ln-377"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">ShomateG</span> <span class="o">=</span> <span class="mi">23</span><span class="mf">7.948d0</span>
<a name="ln-378"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">ShomateH</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-379"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">NumCarbons</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-380"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-381"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">NumOxygens</span>   <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-382"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">MolecularWeight</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">2.00d0</span>
<a name="ln-383"></a>
<a name="ln-384"></a>  <span class="c">! Water (H2O) Temp K 300-1700</span>
<a name="ln-385"></a>  <span class="c">! need lower temperature range for Shomate coef for Water Vapor..</span>
<a name="ln-386"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">ConstituentName</span>                  <span class="o">=</span>  <span class="s1">&#39;Water&#39;</span>
<a name="ln-387"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">ConstituentFormula</span>               <span class="o">=</span>  <span class="s1">&#39;H2O&#39;</span>
<a name="ln-388"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span> <span class="o">=</span>   <span class="o">-</span><span class="mi">24</span><span class="mf">1.8264d0</span> <span class="c">!KJ/mol</span>
<a name="ln-389"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">=</span> <span class="n">NISTShomate</span>
<a name="ln-390"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">ShomateA</span> <span class="o">=</span>   <span class="mi">2</span><span class="mf">9.0373d0</span>
<a name="ln-391"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">ShomateB</span> <span class="o">=</span>    <span class="mi">1</span><span class="mf">0.2573d0</span>
<a name="ln-392"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">ShomateC</span> <span class="o">=</span>    <span class="mf">2.81048d0</span>
<a name="ln-393"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">ShomateD</span> <span class="o">=</span>   <span class="o">-</span><span class="mf">0.95914d0</span>
<a name="ln-394"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">ShomateE</span> <span class="o">=</span>    <span class="mf">0.11725d0</span>
<a name="ln-395"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">ShomateF</span> <span class="o">=</span> <span class="o">-</span><span class="mi">25</span><span class="mf">0.569d0</span>
<a name="ln-396"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">ShomateG</span> <span class="o">=</span>  <span class="mi">22</span><span class="mf">3.3967d0</span>
<a name="ln-397"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">ShomateH</span> <span class="o">=</span> <span class="o">-</span><span class="mi">24</span><span class="mf">1.8264d0</span>
<a name="ln-398"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">NumCarbons</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-399"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-400"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">NumOxygens</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-401"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">MolecularWeight</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">8.02d0</span>
<a name="ln-402"></a>
<a name="ln-403"></a>  <span class="c">! Argon (Ar)  Temp K 298-600</span>
<a name="ln-404"></a>
<a name="ln-405"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">5</span><span class="p">)%</span><span class="n">ConstituentName</span>                  <span class="o">=</span>  <span class="s1">&#39;Argon&#39;</span>
<a name="ln-406"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">5</span><span class="p">)%</span><span class="n">ConstituentFormula</span>               <span class="o">=</span>  <span class="s1">&#39;Ar&#39;</span>
<a name="ln-407"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">5</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span> <span class="o">=</span>   <span class="mf">0.0d0</span>
<a name="ln-408"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">5</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">=</span> <span class="n">NISTShomate</span>
<a name="ln-409"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">5</span><span class="p">)%</span><span class="n">ShomateA</span> <span class="o">=</span>  <span class="mi">2</span><span class="mf">0.786d0</span>
<a name="ln-410"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">5</span><span class="p">)%</span><span class="n">ShomateB</span> <span class="o">=</span>   <span class="mf">2.825911d-07</span>
<a name="ln-411"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">5</span><span class="p">)%</span><span class="n">ShomateC</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">1.464191d-07</span>
<a name="ln-412"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">5</span><span class="p">)%</span><span class="n">ShomateD</span> <span class="o">=</span>   <span class="mf">1.092131d-08</span>
<a name="ln-413"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">5</span><span class="p">)%</span><span class="n">ShomateE</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">3.661371d-08</span>
<a name="ln-414"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">5</span><span class="p">)%</span><span class="n">ShomateF</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">6.19735d0</span>
<a name="ln-415"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">5</span><span class="p">)%</span><span class="n">ShomateG</span> <span class="o">=</span> <span class="mi">17</span><span class="mf">9.999d0</span>
<a name="ln-416"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">5</span><span class="p">)%</span><span class="n">ShomateH</span> <span class="o">=</span>   <span class="mf">0.0d0</span>
<a name="ln-417"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">5</span><span class="p">)%</span><span class="n">NumCarbons</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-418"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">5</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-419"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">5</span><span class="p">)%</span><span class="n">NumOxygens</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-420"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">5</span><span class="p">)%</span><span class="n">MolecularWeight</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">9.95d0</span>
<a name="ln-421"></a>
<a name="ln-422"></a>  <span class="c">! Hydrogen (H2) Temp K 298-1000</span>
<a name="ln-423"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">6</span><span class="p">)%</span><span class="n">ConstituentName</span>                  <span class="o">=</span> <span class="s1">&#39;Hydrogen&#39;</span>
<a name="ln-424"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">6</span><span class="p">)%</span><span class="n">ConstituentFormula</span>               <span class="o">=</span> <span class="s1">&#39;H2&#39;</span>
<a name="ln-425"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">6</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span> <span class="o">=</span>  <span class="mf">0.0d0</span>
<a name="ln-426"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">6</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">=</span> <span class="n">NISTShomate</span>
<a name="ln-427"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">6</span><span class="p">)%</span><span class="n">ShomateA</span> <span class="o">=</span>   <span class="mi">3</span><span class="mf">3.066178d0</span>
<a name="ln-428"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">6</span><span class="p">)%</span><span class="n">ShomateB</span> <span class="o">=</span>  <span class="o">-</span><span class="mi">1</span><span class="mf">1.363417d0</span>
<a name="ln-429"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">6</span><span class="p">)%</span><span class="n">ShomateC</span> <span class="o">=</span>   <span class="mi">1</span><span class="mf">1.432816d0</span>
<a name="ln-430"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">6</span><span class="p">)%</span><span class="n">ShomateD</span> <span class="o">=</span>   <span class="o">-</span><span class="mf">2.772874d0</span>
<a name="ln-431"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">6</span><span class="p">)%</span><span class="n">ShomateE</span> <span class="o">=</span>   <span class="o">-</span><span class="mf">0.158558d0</span>
<a name="ln-432"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">6</span><span class="p">)%</span><span class="n">ShomateF</span> <span class="o">=</span>   <span class="o">-</span><span class="mf">9.980797d0</span>
<a name="ln-433"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">6</span><span class="p">)%</span><span class="n">ShomateG</span> <span class="o">=</span>  <span class="mi">17</span><span class="mf">2.707974d0</span>
<a name="ln-434"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">6</span><span class="p">)%</span><span class="n">ShomateH</span> <span class="o">=</span>    <span class="mf">0.0d0</span>
<a name="ln-435"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">6</span><span class="p">)%</span><span class="n">NumCarbons</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-436"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">6</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-437"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">6</span><span class="p">)%</span><span class="n">NumOxygens</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-438"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">6</span><span class="p">)%</span><span class="n">MolecularWeight</span> <span class="o">=</span> <span class="mf">2.02d0</span>
<a name="ln-439"></a>
<a name="ln-440"></a>  <span class="c">! Methane (CH4) Temp K 298-1300</span>
<a name="ln-441"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">7</span><span class="p">)%</span><span class="n">ConstituentName</span>                  <span class="o">=</span>  <span class="s1">&#39;Methane&#39;</span>
<a name="ln-442"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">7</span><span class="p">)%</span><span class="n">ConstituentFormula</span>               <span class="o">=</span>  <span class="s1">&#39;CH4&#39;</span>
<a name="ln-443"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">7</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span> <span class="o">=</span>   <span class="o">-</span><span class="mi">7</span><span class="mf">4.8731d0</span>  <span class="c">!KJ/mol (Chase 1998)</span>
<a name="ln-444"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">7</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">=</span> <span class="n">NISTShomate</span>
<a name="ln-445"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">7</span><span class="p">)%</span><span class="n">ShomateA</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">0.703029d0</span>
<a name="ln-446"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">7</span><span class="p">)%</span><span class="n">ShomateB</span> <span class="o">=</span> <span class="mi">10</span><span class="mf">8.4773d0</span>
<a name="ln-447"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">7</span><span class="p">)%</span><span class="n">ShomateC</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="mf">2.52157d0</span>
<a name="ln-448"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">7</span><span class="p">)%</span><span class="n">ShomateD</span> <span class="o">=</span>   <span class="mf">5.862788d0</span>
<a name="ln-449"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">7</span><span class="p">)%</span><span class="n">ShomateE</span> <span class="o">=</span>   <span class="mf">0.678565d0</span>
<a name="ln-450"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">7</span><span class="p">)%</span><span class="n">ShomateF</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="mf">6.84376d0</span>
<a name="ln-451"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">7</span><span class="p">)%</span><span class="n">ShomateG</span> <span class="o">=</span> <span class="mi">15</span><span class="mf">8.7163d0</span>
<a name="ln-452"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">7</span><span class="p">)%</span><span class="n">ShomateH</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="mf">4.87310d0</span>
<a name="ln-453"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">7</span><span class="p">)%</span><span class="n">NumCarbons</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-454"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">7</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">=</span> <span class="mf">4.0d0</span>
<a name="ln-455"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">7</span><span class="p">)%</span><span class="n">NumOxygens</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-456"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">7</span><span class="p">)%</span><span class="n">MolecularWeight</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">6.04d0</span>
<a name="ln-457"></a>
<a name="ln-458"></a>
<a name="ln-459"></a>  <span class="c">! Ethane (C2H6)</span>
<a name="ln-460"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">ConstituentName</span>                  <span class="o">=</span>  <span class="s1">&#39;Ethane&#39;</span>
<a name="ln-461"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">ConstituentFormula</span>               <span class="o">=</span>  <span class="s1">&#39;C2H6&#39;</span>
<a name="ln-462"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span> <span class="o">=</span>  <span class="o">-</span><span class="mi">8</span><span class="mf">3.8605d0</span> <span class="c">! -83.8 !KJ/mol (Pittam and Pilcher 1972)</span>
<a name="ln-463"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">=</span> <span class="n">NISTShomate</span>
<a name="ln-464"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">ShomateA</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.03849d0</span>
<a name="ln-465"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">ShomateB</span> <span class="o">=</span> <span class="mi">19</span><span class="mf">9.202d0</span>
<a name="ln-466"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">ShomateC</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span><span class="mf">4.9812d0</span>
<a name="ln-467"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">ShomateD</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">1.0348d0</span>
<a name="ln-468"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">ShomateE</span> <span class="o">=</span> <span class="mf">0.30348d0</span>
<a name="ln-469"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">ShomateF</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9</span><span class="mf">0.0633d0</span>
<a name="ln-470"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">ShomateG</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-471"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">ShomateH</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span><span class="mf">3.8605d0</span>
<a name="ln-472"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">NumCarbons</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-473"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">=</span> <span class="mf">6.0d0</span>
<a name="ln-474"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">NumOxygens</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-475"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">MolecularWeight</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">0.07d0</span>
<a name="ln-476"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">NASA_A1</span> <span class="o">=</span> <span class="mf">0.14625388d+01</span>
<a name="ln-477"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">NASA_A2</span> <span class="o">=</span> <span class="mf">0.15494667d-01</span>
<a name="ln-478"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">NASA_A3</span> <span class="o">=</span> <span class="mf">0.05780507d-04</span>
<a name="ln-479"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">NASA_A4</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.12578319d-07</span>
<a name="ln-480"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">NASA_A5</span> <span class="o">=</span> <span class="mf">0.04586267d-10</span>
<a name="ln-481"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">NASA_A6</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.11239176d+05</span>
<a name="ln-482"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">8</span><span class="p">)%</span><span class="n">NASA_A7</span> <span class="o">=</span> <span class="mf">0.14432295d+02</span>
<a name="ln-483"></a>
<a name="ln-484"></a>  <span class="c">! Propane (C3H8)</span>
<a name="ln-485"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">ConstituentName</span>                  <span class="o">=</span>  <span class="s1">&#39;Propane&#39;</span>
<a name="ln-486"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">ConstituentFormula</span>               <span class="o">=</span>  <span class="s1">&#39;C3H8&#39;</span>
<a name="ln-487"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="mf">3.855d0</span> <span class="c">!  -104.7 !kJ/mol  (Pittam and Pilcher 1972)</span>
<a name="ln-488"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">=</span> <span class="n">NISTShomate</span>
<a name="ln-489"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">ShomateA</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="mf">3.1747d0</span>
<a name="ln-490"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">ShomateB</span> <span class="o">=</span> <span class="mi">36</span><span class="mf">3.742d0</span>
<a name="ln-491"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">ShomateC</span> <span class="o">=</span> <span class="o">-</span><span class="mi">22</span><span class="mf">2.981d0</span>
<a name="ln-492"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">ShomateD</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">6.253d0</span>
<a name="ln-493"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">ShomateE</span> <span class="o">=</span> <span class="mf">0.61164d0</span>
<a name="ln-494"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">ShomateF</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="mf">9.206d0</span>
<a name="ln-495"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">ShomateG</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-496"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">ShomateH</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="mf">3.855d0</span>
<a name="ln-497"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">NumCarbons</span> <span class="o">=</span> <span class="mf">3.0d0</span>
<a name="ln-498"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">=</span> <span class="mf">8.0d0</span>
<a name="ln-499"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">NumOxygens</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-500"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">MolecularWeight</span> <span class="o">=</span> <span class="mi">4</span><span class="mf">4.10d0</span>
<a name="ln-501"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">NASA_A1</span> <span class="o">=</span> <span class="mf">0.08969208d+01</span>
<a name="ln-502"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">NASA_A2</span> <span class="o">=</span> <span class="mf">0.02668986d+00</span>
<a name="ln-503"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">NASA_A3</span> <span class="o">=</span> <span class="mf">0.05431425d-04</span>
<a name="ln-504"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">NASA_A4</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.02126000d-06</span>
<a name="ln-505"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">NASA_A5</span> <span class="o">=</span> <span class="mf">0.09243330d-10</span>
<a name="ln-506"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">NASA_A6</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.13954918d+05</span>
<a name="ln-507"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">9</span><span class="p">)%</span><span class="n">NASA_A7</span> <span class="o">=</span> <span class="mf">0.01935533d+03</span>
<a name="ln-508"></a>
<a name="ln-509"></a>
<a name="ln-510"></a>  <span class="c">! Butane (C4H10)</span>
<a name="ln-511"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">ConstituentName</span>                  <span class="o">=</span>  <span class="s1">&#39;Butane&#39;</span>
<a name="ln-512"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">ConstituentFormula</span>               <span class="o">=</span>  <span class="s1">&#39;C4H10&#39;</span>
<a name="ln-513"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span> <span class="o">=</span>   <span class="o">-</span><span class="mi">13</span><span class="mf">3.218d0</span> <span class="c">! -125.6 !kJ/mol  (Pittam and Pilcher 1972)</span>
<a name="ln-514"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">=</span> <span class="n">NISTShomate</span>
<a name="ln-515"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">ShomateA</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.24343d0</span>
<a name="ln-516"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">ShomateB</span> <span class="o">=</span> <span class="mi">42</span><span class="mf">6.442d0</span>
<a name="ln-517"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">ShomateC</span> <span class="o">=</span> <span class="o">-</span><span class="mi">25</span><span class="mf">7.955d0</span>
<a name="ln-518"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">ShomateD</span> <span class="o">=</span> <span class="mi">6</span><span class="mf">6.535d0</span>
<a name="ln-519"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">ShomateE</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.26994d0</span>
<a name="ln-520"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">ShomateF</span> <span class="o">=</span> <span class="o">-</span><span class="mi">14</span><span class="mf">9.365d0</span>
<a name="ln-521"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">ShomateG</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-522"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">ShomateH</span> <span class="o">=</span> <span class="o">-</span><span class="mi">13</span><span class="mf">3.218d0</span>
<a name="ln-523"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">NumCarbons</span> <span class="o">=</span> <span class="mf">4.0d0</span>
<a name="ln-524"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span>
<a name="ln-525"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">NumOxygens</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-526"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">MolecularWeight</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">8.12d0</span>
<a name="ln-527"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">NASA_A1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.02256618d+02</span>
<a name="ln-528"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">NASA_A2</span> <span class="o">=</span>  <span class="mf">0.05881732d+00</span>
<a name="ln-529"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">NASA_A3</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.04525782d-03</span>
<a name="ln-530"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">NASA_A4</span> <span class="o">=</span>  <span class="mf">0.02037115d-06</span>
<a name="ln-531"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">NASA_A5</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.04079458d-10</span>
<a name="ln-532"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">NASA_A6</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.01760233d+06</span>
<a name="ln-533"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">10</span><span class="p">)%</span><span class="n">NASA_A7</span> <span class="o">=</span>  <span class="mf">0.03329595d+03</span>
<a name="ln-534"></a>
<a name="ln-535"></a>  <span class="c">! Pentane (C5H12)</span>
<a name="ln-536"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">ConstituentName</span>                  <span class="o">=</span>  <span class="s1">&#39;Pentane&#39;</span>
<a name="ln-537"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">ConstituentFormula</span>               <span class="o">=</span>  <span class="s1">&#39;C5H12&#39;</span>
<a name="ln-538"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span> <span class="o">=</span>  <span class="o">-</span><span class="mi">14</span><span class="mf">6.348d0</span> <span class="c">! -146.8 !kJ/mol (Good 1970)</span>
<a name="ln-539"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">=</span> <span class="n">NISTShomate</span>
<a name="ln-540"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">ShomateA</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="mf">4.9431d0</span>
<a name="ln-541"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">ShomateB</span> <span class="o">=</span> <span class="mi">57</span><span class="mf">6.777d0</span>
<a name="ln-542"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">ShomateC</span> <span class="o">=</span> <span class="o">-</span><span class="mi">33</span><span class="mf">8.353d0</span>
<a name="ln-543"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">ShomateD</span> <span class="o">=</span> <span class="mi">7</span><span class="mf">6.8232d0</span>
<a name="ln-544"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">ShomateE</span> <span class="o">=</span> <span class="mf">1.00948d0</span>
<a name="ln-545"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">ShomateF</span> <span class="o">=</span> <span class="o">-</span><span class="mi">15</span><span class="mf">5.348d0</span>
<a name="ln-546"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">ShomateG</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-547"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">ShomateH</span> <span class="o">=</span> <span class="o">-</span><span class="mi">14</span><span class="mf">6.348d0</span>
<a name="ln-548"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">NumCarbons</span> <span class="o">=</span> <span class="mf">5.0d0</span>
<a name="ln-549"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">2.0d0</span>
<a name="ln-550"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">NumOxygens</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-551"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">MolecularWeight</span> <span class="o">=</span> <span class="mi">7</span><span class="mf">2.15d0</span>
<a name="ln-552"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">NASA_A1</span> <span class="o">=</span>  <span class="mf">0.01877907d+02</span>
<a name="ln-553"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">NASA_A2</span> <span class="o">=</span>  <span class="mf">0.04121645d+00</span>
<a name="ln-554"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">NASA_A3</span> <span class="o">=</span>  <span class="mf">0.12532337d-04</span>
<a name="ln-555"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">NASA_A4</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.03701536d-06</span>
<a name="ln-556"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">NASA_A5</span> <span class="o">=</span>  <span class="mf">0.15255685d-10</span>
<a name="ln-557"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">NASA_A6</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.02003815d+06</span>
<a name="ln-558"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">11</span><span class="p">)%</span><span class="n">NASA_A7</span> <span class="o">=</span>  <span class="mf">0.01877256d+03</span>
<a name="ln-559"></a>
<a name="ln-560"></a>  <span class="c">! Hexane  (C6H14)</span>
<a name="ln-561"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">ConstituentName</span>                  <span class="o">=</span>  <span class="s1">&#39;Hexane&#39;</span>
<a name="ln-562"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">ConstituentFormula</span>               <span class="o">=</span>  <span class="s1">&#39;C6H14&#39;</span>
<a name="ln-563"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span> <span class="o">=</span>   <span class="o">-</span><span class="mi">16</span><span class="mf">6.966d0</span> <span class="c">! -167.2 !kJ/mol (Prosen and Rossini 1945)</span>
<a name="ln-564"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">=</span> <span class="n">NISTShomate</span>
<a name="ln-565"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">ShomateA</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="mf">6.7786d0</span>
<a name="ln-566"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">ShomateB</span> <span class="o">=</span> <span class="mi">71</span><span class="mf">1.187d0</span>
<a name="ln-567"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">ShomateC</span> <span class="o">=</span> <span class="o">-</span><span class="mi">43</span><span class="mf">8.39d0</span>
<a name="ln-568"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">ShomateD</span> <span class="o">=</span> <span class="mi">10</span><span class="mf">3.784d0</span>
<a name="ln-569"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">ShomateE</span> <span class="o">=</span> <span class="mf">1.23887d0</span>
<a name="ln-570"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">ShomateF</span> <span class="o">=</span> <span class="o">-</span><span class="mi">17</span><span class="mf">6.813d0</span>
<a name="ln-571"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">ShomateG</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-572"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">ShomateH</span> <span class="o">=</span> <span class="o">-</span><span class="mi">16</span><span class="mf">6.966d0</span>
<a name="ln-573"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">NumCarbons</span> <span class="o">=</span> <span class="mf">6.0d0</span>
<a name="ln-574"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">4.0d0</span>
<a name="ln-575"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">NumOxygens</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-576"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">MolecularWeight</span> <span class="o">=</span> <span class="mi">8</span><span class="mf">6.18d0</span>
<a name="ln-577"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">NASA_A1</span> <span class="o">=</span>  <span class="mf">0.01836174d+02</span>
<a name="ln-578"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">NASA_A2</span> <span class="o">=</span>  <span class="mf">0.05098461d+00</span>
<a name="ln-579"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">NASA_A3</span> <span class="o">=</span>  <span class="mf">0.12595857d-04</span>
<a name="ln-580"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">NASA_A4</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.04428362d-06</span>
<a name="ln-581"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">NASA_A5</span> <span class="o">=</span>  <span class="mf">0.01872237d-09</span>
<a name="ln-582"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">NASA_A6</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.02292749d+06</span>
<a name="ln-583"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">12</span><span class="p">)%</span><span class="n">NASA_A7</span> <span class="o">=</span>  <span class="mf">0.02088145d+03</span>
<a name="ln-584"></a>
<a name="ln-585"></a> <span class="c">! Methanol (CH3OH)</span>
<a name="ln-586"></a> <span class="c">! No Shomate coefficients???</span>
<a name="ln-587"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">ConstituentName</span>                  <span class="o">=</span>  <span class="s1">&#39;Methanol&#39;</span>
<a name="ln-588"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">ConstituentFormula</span>               <span class="o">=</span>  <span class="s1">&#39;CH3OH&#39;</span>
<a name="ln-589"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span> <span class="o">=</span>  <span class="o">-</span><span class="mi">20</span><span class="mf">1.102d0</span> <span class="c">! -201.0 !kJ/mol (Hine and Arata 1976)</span>
<a name="ln-590"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">=</span> <span class="n">NISTShomate</span>
<a name="ln-591"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">ShomateA</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">4.1952d0</span>
<a name="ln-592"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">ShomateB</span> <span class="o">=</span> <span class="mi">9</span><span class="mf">7.7218d0</span>
<a name="ln-593"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">ShomateC</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.73279d0</span>
<a name="ln-594"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">ShomateD</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="mf">2.8461d0</span>
<a name="ln-595"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">ShomateE</span> <span class="o">=</span> <span class="mf">0.15819d0</span>
<a name="ln-596"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">ShomateF</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span><span class="mf">9.037d0</span>
<a name="ln-597"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">ShomateG</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-598"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">ShomateH</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span><span class="mf">1.102d0</span>
<a name="ln-599"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">NumCarbons</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-600"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">=</span> <span class="mf">4.0d0</span>
<a name="ln-601"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">NumOxygens</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-602"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">MolecularWeight</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">2.04d0</span>
<a name="ln-603"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">NASA_A1</span> <span class="o">=</span>  <span class="mf">0.02660115d+02</span>
<a name="ln-604"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">NASA_A2</span> <span class="o">=</span>  <span class="mf">0.07341508d-01</span>
<a name="ln-605"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">NASA_A3</span> <span class="o">=</span>  <span class="mf">0.07170050d-04</span>
<a name="ln-606"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">NASA_A4</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.08793194d-07</span>
<a name="ln-607"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">NASA_A5</span> <span class="o">=</span>  <span class="mf">0.02390570d-10</span>
<a name="ln-608"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">NASA_A6</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.02535348d+06</span>
<a name="ln-609"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">13</span><span class="p">)%</span><span class="n">NASA_A7</span> <span class="o">=</span>  <span class="mf">0.11232631d+02</span>
<a name="ln-610"></a>
<a name="ln-611"></a>  <span class="c">! Ethanol (C2H5OH)</span>
<a name="ln-612"></a>  <span class="c">! No Shomate coefficients???</span>
<a name="ln-613"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">ConstituentName</span>                  <span class="o">=</span>  <span class="s1">&#39;Ethanol&#39;</span>
<a name="ln-614"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">ConstituentFormula</span>               <span class="o">=</span>  <span class="s1">&#39;C2H5OH&#39;</span>
<a name="ln-615"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span> <span class="o">=</span> <span class="o">-</span><span class="mi">23</span><span class="mf">4.441d0</span> <span class="c">!  -235.3 !kJ/mol (Green 1960)</span>
<a name="ln-616"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">=</span> <span class="n">NISTShomate</span>
<a name="ln-617"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">ShomateA</span> <span class="o">=</span> <span class="o">-</span><span class="mf">8.87256d0</span>
<a name="ln-618"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">ShomateB</span> <span class="o">=</span> <span class="mi">28</span><span class="mf">2.389d0</span>
<a name="ln-619"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">ShomateC</span> <span class="o">=</span> <span class="o">-</span><span class="mi">17</span><span class="mf">8.85d0</span>
<a name="ln-620"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">ShomateD</span> <span class="o">=</span> <span class="mi">4</span><span class="mf">6.3528d0</span>
<a name="ln-621"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">ShomateE</span> <span class="o">=</span> <span class="mf">0.48364d0</span>
<a name="ln-622"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">ShomateF</span> <span class="o">=</span> <span class="o">-</span><span class="mi">24</span><span class="mf">1.239d0</span>
<a name="ln-623"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">ShomateG</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.d0</span>
<a name="ln-624"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">ShomateH</span> <span class="o">=</span> <span class="o">-</span><span class="mi">23</span><span class="mf">4.441d0</span>
<a name="ln-625"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">NumCarbons</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-626"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">=</span> <span class="mf">6.0d0</span>
<a name="ln-627"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">NumOxygens</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-628"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">MolecularWeight</span> <span class="o">=</span> <span class="mi">4</span><span class="mf">6.07d0</span>
<a name="ln-629"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">NASA_A1</span> <span class="o">=</span>  <span class="mf">0.18461027d+01</span>
<a name="ln-630"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">NASA_A2</span> <span class="o">=</span>  <span class="mf">0.20475008d-01</span>
<a name="ln-631"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">NASA_A3</span> <span class="o">=</span>  <span class="mf">0.39904089d-05</span>
<a name="ln-632"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">NASA_A4</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.16585986d-07</span>
<a name="ln-633"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">NASA_A5</span> <span class="o">=</span>  <span class="mf">0.73090440d-11</span>
<a name="ln-634"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">NASA_A6</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.29663086d+05</span>
<a name="ln-635"></a>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">14</span><span class="p">)%</span><span class="n">NASA_A7</span> <span class="o">=</span>  <span class="mf">0.17289993d+02</span>
<a name="ln-636"></a>
<a name="ln-637"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">FuelTypeMode</span> <span class="o">==</span> <span class="n">fuelModeGaseousConstituents</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-638"></a>    <span class="c">! now calculate LHV of fuel for entire simulation</span>
<a name="ln-639"></a>
<a name="ln-640"></a>    <span class="c">! sum over each constituent</span>
<a name="ln-641"></a>    <span class="n">O2Stoic</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-642"></a>    <span class="n">CO2ProdStoic</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-643"></a>    <span class="n">H20ProdStoic</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-644"></a>    <span class="n">CO2dataID</span>   <span class="o">=</span> <span class="mi">1</span>  <span class="c">!hard-coded above</span>
<a name="ln-645"></a>    <span class="n">WaterDataID</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c">!hard-coded above</span>
<a name="ln-646"></a>    <span class="c">! Loop over fuel constituents and do one-time setup</span>
<a name="ln-647"></a>    <span class="k">DO </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">NumConstituents</span>
<a name="ln-648"></a>
<a name="ln-649"></a>       <span class="n">thisName</span> <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">ConstitName</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-650"></a>       <span class="n">thisGasID</span> <span class="o">=</span> <span class="n">FindItem</span><span class="p">(</span><span class="n">thisName</span><span class="p">,</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">%</span><span class="n">ConstituentName</span><span class="p">,</span> <span class="n">NumHardCodedConstituents</span><span class="p">)</span>
<a name="ln-651"></a>       <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">GasLibID</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">thisGasID</span>
<a name="ln-652"></a>
<a name="ln-653"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">thisGasID</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-654"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Fuel constituent not found in thermochemistry data: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">thisName</span> <span class="p">))</span>
<a name="ln-655"></a>         <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-656"></a>       <span class="n">ENDif</span>
<a name="ln-657"></a>
<a name="ln-658"></a>
<a name="ln-659"></a>      <span class="c">!for this fuel mixture, figure stoichiometric oxygen requirement</span>
<a name="ln-660"></a>      <span class="n">O2Stoic</span> <span class="o">=</span> <span class="n">O2Stoic</span> <span class="o">+</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span>                  <span class="p">&amp;</span>
<a name="ln-661"></a>              <span class="p">(</span>  <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">thisGasID</span><span class="p">)%</span><span class="n">NumCarbons</span>                         <span class="p">&amp;</span>
<a name="ln-662"></a>               <span class="o">+</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">thisGasID</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">/</span> <span class="mf">4.0d0</span>                 <span class="p">&amp;</span>
<a name="ln-663"></a>               <span class="o">-</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">thisGasID</span><span class="p">)%</span><span class="n">NumOxygens</span> <span class="o">/</span> <span class="mf">2.0d0</span> <span class="p">)</span>
<a name="ln-664"></a>     <span class="c">! for this fuel mixture, figure stoichiometric Carbon Dioxide in Product Gases</span>
<a name="ln-665"></a>
<a name="ln-666"></a>     <span class="n">CO2ProdStoic</span> <span class="o">=</span> <span class="n">CO2ProdStoic</span> <span class="o">+</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span>                  <span class="p">&amp;</span>
<a name="ln-667"></a>                           <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">thisGasID</span><span class="p">)%</span><span class="n">NumCarbons</span>
<a name="ln-668"></a>
<a name="ln-669"></a>     <span class="n">H20ProdStoic</span> <span class="o">=</span> <span class="n">H20ProdStoic</span> <span class="o">+</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span>                  <span class="p">&amp;</span>
<a name="ln-670"></a>                           <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">thisGasID</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">/</span> <span class="mf">2.0d0</span>
<a name="ln-671"></a>    <span class="n">ENDDO</span>
<a name="ln-672"></a>
<a name="ln-673"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">StoicOxygenRate</span> <span class="o">=</span> <span class="n">O2Stoic</span>
<a name="ln-674"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">CO2ProductGasCoef</span> <span class="o">=</span> <span class="n">CO2ProdStoic</span>
<a name="ln-675"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">H20ProductGasCoef</span> <span class="o">=</span> <span class="n">H20ProdStoic</span>
<a name="ln-676"></a>
<a name="ln-677"></a>    <span class="c">!Calculate LHV for an NdotFuel of 1.0</span>
<a name="ln-678"></a>    <span class="n">LHVfuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-679"></a>    <span class="k">DO </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">NumConstituents</span>
<a name="ln-680"></a>      <span class="n">thisGasID</span>  <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">GasLibID</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-681"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">thisGasID</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-682"></a><span class="k">        </span><span class="n">LHVi</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-683"></a>      <span class="k">ELSE</span>
<a name="ln-684"></a><span class="k">        </span><span class="n">LHVi</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">thisGasID</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span>            <span class="p">&amp;</span>
<a name="ln-685"></a>              <span class="o">-</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">thisGasID</span><span class="p">)%</span><span class="n">NumCarbons</span>                    <span class="p">&amp;</span>
<a name="ln-686"></a>                  <span class="o">*</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">CO2dataID</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span>       <span class="p">&amp;</span>
<a name="ln-687"></a>              <span class="o">-</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">thisGasID</span><span class="p">)%</span><span class="n">NumHydrogens</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span>                    <span class="p">&amp;</span>
<a name="ln-688"></a>                  <span class="o">*</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">WaterDataID</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span>
<a name="ln-689"></a>      <span class="n">ENDIF</span>
<a name="ln-690"></a>      <span class="n">LHVfuel</span> <span class="o">=</span> <span class="n">LHVfuel</span> <span class="o">+</span> <span class="n">LHVi</span> <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-691"></a>    <span class="n">ENDDO</span>
<a name="ln-692"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">LHV</span> <span class="o">=</span> <span class="n">LHVfuel</span>
<a name="ln-693"></a>
<a name="ln-694"></a>  <span class="c">!Calculate HHV for an NdotFuel of 1.0</span>
<a name="ln-695"></a>    <span class="n">HHVfuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-696"></a>    <span class="k">DO </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">NumConstituents</span>
<a name="ln-697"></a>      <span class="n">thisGasID</span>  <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">GasLibID</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-698"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">thisGasID</span><span class="p">)%</span><span class="n">NumHydrogens</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-699"></a><span class="k">        </span><span class="n">HHVi</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-700"></a>      <span class="k">ELSE</span>
<a name="ln-701"></a><span class="k">        </span><span class="n">HHVi</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">thisGasID</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span>            <span class="p">&amp;</span>
<a name="ln-702"></a>              <span class="o">-</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">thisGasID</span><span class="p">)%</span><span class="n">NumCarbons</span>                      <span class="p">&amp;</span>
<a name="ln-703"></a>                  <span class="o">*</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">CO2dataID</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span>       <span class="p">&amp;</span>
<a name="ln-704"></a>              <span class="o">-</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">thisGasID</span><span class="p">)%</span><span class="n">NumHydrogens</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span>              <span class="p">&amp;</span>
<a name="ln-705"></a>                  <span class="o">*</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">WaterDataID</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span>     <span class="p">&amp;</span>
<a name="ln-706"></a>              <span class="o">+</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">thisGasID</span><span class="p">)%</span><span class="n">NumHydrogens</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span>              <span class="p">&amp;</span>
<a name="ln-707"></a>                <span class="o">*</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">WaterDataID</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span> <span class="o">+</span> <span class="mi">28</span><span class="mf">5.8304d0</span><span class="p">)</span>
<a name="ln-708"></a>      <span class="n">ENDIF</span>
<a name="ln-709"></a>      <span class="n">HHVfuel</span> <span class="o">=</span> <span class="n">HHVfuel</span> <span class="o">+</span> <span class="n">HHVi</span> <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-710"></a>    <span class="n">ENDDO</span>
<a name="ln-711"></a>
<a name="ln-712"></a>    <span class="c">!Calculate Molecular Weight for this fuel</span>
<a name="ln-713"></a>    <span class="n">MWfuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-714"></a>    <span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelsupplyNum</span><span class="p">)%</span><span class="n">NumConstituents</span>
<a name="ln-715"></a>      <span class="n">thisGasID</span> <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">GasLibID</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-716"></a>      <span class="n">MWfuel</span> <span class="o">=</span> <span class="n">MWfuel</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-717"></a>             <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">thisGasID</span><span class="p">)%</span><span class="n">MolecularWeight</span>
<a name="ln-718"></a>    <span class="n">ENDDO</span>
<a name="ln-719"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">MW</span> <span class="o">=</span> <span class="n">MWfuel</span>
<a name="ln-720"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">KmolPerSecToKgPerSec</span> <span class="o">=</span>  <span class="n">MWfuel</span> <span class="c">!TODO check this, guessing on conversion...</span>
<a name="ln-721"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">HHV</span> <span class="o">=</span> <span class="mi">100000</span><span class="mf">0.0d0</span> <span class="o">*</span> <span class="n">HHVfuel</span>  <span class="o">/</span> <span class="n">MWfuel</span> <span class="c">! (1000/k) (1000/k) (kJ/mol)/(g/mol) = J/kg</span>
<a name="ln-722"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">LHVJperkg</span> <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">LHV</span> <span class="o">*</span> <span class="mi">100000</span><span class="mf">0.0d0</span> <span class="o">/</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">MW</span>
<a name="ln-723"></a>
<a name="ln-724"></a>  <span class="n">ELSEIF</span><span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">FuelTypeMode</span> <span class="o">==</span> <span class="n">fuelModeGenericLiquid</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-725"></a><span class="k">    </span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">LHV</span> <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">LHVliquid</span>  <span class="p">&amp;</span>
<a name="ln-726"></a>                                    <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">MW</span> <span class="o">/</span><span class="mi">100000</span><span class="mf">0.0d0</span> <span class="c">! J/kg * g/mol (k/1000) (k/10000)</span>
<a name="ln-727"></a>
<a name="ln-728"></a>  <span class="k">ELSE</span>
<a name="ln-729"></a>
<a name="ln-730"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-731"></a>
<a name="ln-732"></a> <span class="c">! report Heating Values in EIO.</span>
<a name="ln-733"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Fuel Supply&gt;, Fuel Supply Name, Lower Heating Value [J/kmol], Lower Heating Value [kJ/kg], &#39;</span>  <span class="p">&amp;</span>
<a name="ln-734"></a>                                <span class="o">//</span> <span class="s1">&#39;Higher Heating Value [KJ/kg],  Molecular Weight [g/mol] &#39;</span>
<a name="ln-735"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">501</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">,</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">LHV</span><span class="o">*</span><span class="mi">100000</span><span class="mf">0.0d0</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-736"></a>                               <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">LHVJperkg</span><span class="o">/</span> <span class="mi">100</span><span class="mf">0.0d0</span> <span class="p">,</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">HHV</span> <span class="o">/</span> <span class="mi">100</span><span class="mf">0.0d0</span> <span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-737"></a>                               <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelSupplyNum</span><span class="p">)%</span><span class="n">MW</span>
<a name="ln-738"></a>
<a name="ln-739"></a>  <span class="mi">501</span> <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39; Fuel Supply, &#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">G13</span><span class="p">.</span><span class="err">6</span><span class="n">E2</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span> <span class="p">,</span> <span class="n">G13</span><span class="p">.</span><span class="err">6</span><span class="n">E2</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span> <span class="p">,</span> <span class="n">G13</span><span class="p">.</span><span class="err">6</span><span class="n">E2</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">G13</span><span class="p">.</span><span class="err">6</span><span class="n">E2</span><span class="p">)</span>
<a name="ln-740"></a>
<a name="ln-741"></a>
<a name="ln-742"></a>  <span class="k">RETURN</span>
<a name="ln-743"></a>
<a name="ln-744"></a><span class="k">END SUBROUTINE </span><span class="n">SetupFuelConstituentData</span>
<a name="ln-745"></a>
<a name="ln-746"></a><span class="k">END MODULE </span><span class="n">GeneratorFuelSupply</span>
<a name="ln-747"></a><span class="c">!_____________________________________________________________________________________________________________________</span>
<a name="ln-748"></a><span class="k">MODULE </span><span class="n">GeneratorDynamicsManager</span>
<a name="ln-749"></a>
<a name="ln-750"></a>          <span class="c">! Module containing the routines dealing with the management of dynamic constraints on Generator response</span>
<a name="ln-751"></a>
<a name="ln-752"></a>          <span class="c">! MODULE INFORMATION:</span>
<a name="ln-753"></a>          <span class="c">!       AUTHOR        B. Griffith</span>
<a name="ln-754"></a>          <span class="c">!       DATE WRITTEN   July 2006</span>
<a name="ln-755"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-756"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-757"></a>
<a name="ln-758"></a>          <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-759"></a>          <span class="c">! collect routines for managing generator states</span>
<a name="ln-760"></a>          <span class="c">! reused by different generator models</span>
<a name="ln-761"></a>          <span class="c">!  determine response that generator is capable of providing</span>
<a name="ln-762"></a>          <span class="c">!  given load request data</span>
<a name="ln-763"></a>          <span class="c">!   models requiring calculations across timesteps</span>
<a name="ln-764"></a>
<a name="ln-765"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-766"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-767"></a>
<a name="ln-768"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-769"></a>          <span class="c">! na</span>
<a name="ln-770"></a>
<a name="ln-771"></a>          <span class="c">! OTHER NOTES:</span>
<a name="ln-772"></a>          <span class="c">! na</span>
<a name="ln-773"></a>
<a name="ln-774"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-775"></a><span class="k">USE </span><span class="n">DataGenerators</span>
<a name="ln-776"></a><span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurrentTime</span><span class="p">,</span> <span class="n">DayOfSim</span><span class="p">,</span> <span class="n">HoursInDay</span><span class="p">,</span> <span class="n">SecInHour</span>
<a name="ln-777"></a><span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="n">ShowContinueError</span>
<a name="ln-778"></a>          <span class="c">! &lt;use statements for access to subroutines in other modules&gt;</span>
<a name="ln-779"></a>
<a name="ln-780"></a><span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-781"></a>
<a name="ln-782"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-783"></a>
<a name="ln-784"></a>          <span class="c">! MODULE PARAMETER DEFINITIONS:</span>
<a name="ln-785"></a>          <span class="c">! na</span>
<a name="ln-786"></a>
<a name="ln-787"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-788"></a>          <span class="c">! na</span>
<a name="ln-789"></a>
<a name="ln-790"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-791"></a>          <span class="c">! na</span>
<a name="ln-792"></a>
<a name="ln-793"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE &lt;module_name&gt;:</span>
<a name="ln-794"></a><span class="k">Public </span><span class="n">ManageGeneratorControlState</span>
<a name="ln-795"></a><span class="k">Public </span><span class="n">SetupGeneratorControlStateManager</span>
<a name="ln-796"></a><span class="k">PUBLIC </span><span class="n">ManageGeneratorFuelFlow</span>
<a name="ln-797"></a><span class="k">PUBLIC </span><span class="n">FuncDetermineCWMdotForInternalFlowControl</span>
<a name="ln-798"></a>
<a name="ln-799"></a><span class="k">CONTAINS</span>
<a name="ln-800"></a>
<a name="ln-801"></a><span class="k">SUBROUTINE </span><span class="n">SetupGeneratorControlStateManager</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)</span>
<a name="ln-802"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-803"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-804"></a>          <span class="c">!       DATE WRITTEN   July 2006</span>
<a name="ln-805"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-806"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-807"></a>
<a name="ln-808"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-809"></a>          <span class="c">! sets up data structures</span>
<a name="ln-810"></a>
<a name="ln-811"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-812"></a>          <span class="c">! like a get input routine but feeds from</span>
<a name="ln-813"></a>          <span class="c">!  parent objects, could have its own input object someday</span>
<a name="ln-814"></a>          <span class="c">!</span>
<a name="ln-815"></a>
<a name="ln-816"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-817"></a>          <span class="c">! na</span>
<a name="ln-818"></a>
<a name="ln-819"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-820"></a>          <span class="c">! na</span>
<a name="ln-821"></a>
<a name="ln-822"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-823"></a>
<a name="ln-824"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-825"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">GenNum</span> <span class="c">! index of generator to setup</span>
<a name="ln-826"></a>
<a name="ln-827"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-828"></a>          <span class="c">! na</span>
<a name="ln-829"></a>
<a name="ln-830"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-831"></a>          <span class="c">! na</span>
<a name="ln-832"></a>
<a name="ln-833"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-834"></a>          <span class="c">! na</span>
<a name="ln-835"></a>
<a name="ln-836"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-837"></a>
<a name="ln-838"></a>
<a name="ln-839"></a><span class="c">! get the number of generators that might use this module</span>
<a name="ln-840"></a><span class="n">NumGensWDynamics</span> <span class="o">=</span> <span class="n">NumMicroCHPs</span> <span class="c">!TODO  + NumFuelCellCGenerators</span>
<a name="ln-841"></a>
<a name="ln-842"></a><span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-843"></a><span class="k">  ALLOCATE</span><span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">NumGensWDynamics</span><span class="p">))</span>
<a name="ln-844"></a><span class="k">ELSE</span>
<a name="ln-845"></a><span class="k">  DEALLOCATE</span><span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">)</span>
<a name="ln-846"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">NumGensWDynamics</span><span class="p">))</span>
<a name="ln-847"></a><span class="n">ENDIF</span>
<a name="ln-848"></a>
<a name="ln-849"></a><span class="c">!first populate with Micro CHP data</span>
<a name="ln-850"></a>
<a name="ln-851"></a><span class="c">! DO GenNum = 1, NumMicroCHPs</span>
<a name="ln-852"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">name</span>                  <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-853"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PelMin</span>                <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MinElecPower</span>
<a name="ln-854"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PelMax</span>                <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MaxElecPower</span>
<a name="ln-855"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">UpTranLimit</span>           <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">DeltaPelMax</span>
<a name="ln-856"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">DownTranLimit</span>         <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">DeltaPelMax</span>
<a name="ln-857"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">UpTranLimitFuel</span>       <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">DeltaFuelMdotMax</span>
<a name="ln-858"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">DownTranLimitFuel</span>     <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">DeltaFuelMdotMax</span>
<a name="ln-859"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">WarmUpByTimeDelay</span>     <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">WarmUpByTimeDelay</span>
<a name="ln-860"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">WarmUpByEngineTemp</span>    <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">WarmUpByEngineTemp</span>
<a name="ln-861"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MandatoryFullCoolDown</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MandatoryFullCoolDown</span>
<a name="ln-862"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">WarmRestartOkay</span>       <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">WarmRestartOkay</span>
<a name="ln-863"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">WarmUpDelay</span>           <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">WarmUpDelay</span>
<a name="ln-864"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">CoolDownDelay</span>         <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">CoolDownDelay</span> <span class="o">/</span> <span class="n">SecInHour</span> <span class="c">! seconds to hours</span>
<a name="ln-865"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PcoolDown</span>             <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">PcoolDown</span>
<a name="ln-866"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">Pstandby</span>              <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Pstandby</span>
<a name="ln-867"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MCeng</span>                 <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MCeng</span>
<a name="ln-868"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MCcw</span>                  <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MCcw</span>
<a name="ln-869"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">kf</span>                    <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">kf</span>
<a name="ln-870"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">TnomEngOp</span>             <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TnomEngOp</span>
<a name="ln-871"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">kp</span>                    <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">kp</span>
<a name="ln-872"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">AvailabilitySchedID</span>   <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">AvailabilitySchedID</span>
<a name="ln-873"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">StartUpTimeDelay</span>      <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">WarmUpDelay</span> <span class="o">/</span> <span class="n">SecInHour</span> <span class="c">! seconds to hours</span>
<a name="ln-874"></a>
<a name="ln-875"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectEffNom</span>           <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ElecEff</span>
<a name="ln-876"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermEffNom</span>           <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ThermEff</span>
<a name="ln-877"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">QdotHXMax</span>             <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ThermEff</span>          <span class="p">&amp;</span>
<a name="ln-878"></a>                                                        <span class="o">*</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MaxElecPower</span>  <span class="p">&amp;</span>
<a name="ln-879"></a>                                                        <span class="o">/</span>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ElecEff</span>
<a name="ln-880"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">QdotHXMin</span>             <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ThermEff</span>          <span class="p">&amp;</span>
<a name="ln-881"></a>                                                        <span class="o">*</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MinElecPower</span>  <span class="p">&amp;</span>
<a name="ln-882"></a>                                                        <span class="o">/</span>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ElecEff</span>
<a name="ln-883"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">QdotHXOpt</span>             <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">QdotHXMax</span>
<a name="ln-884"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">DynamicsControlID</span>              <span class="o">=</span> <span class="n">GenNum</span>
<a name="ln-885"></a><span class="c">! ENDDO</span>
<a name="ln-886"></a>
<a name="ln-887"></a>
<a name="ln-888"></a>  <span class="k">RETURN</span>
<a name="ln-889"></a>
<a name="ln-890"></a><span class="k">END SUBROUTINE </span><span class="n">SetupGeneratorControlStateManager</span>
<a name="ln-891"></a>
<a name="ln-892"></a>
<a name="ln-893"></a><span class="k">SUBROUTINE </span><span class="n">ManageGeneratorControlState</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span> <span class="n">GeneratorName</span><span class="p">,</span> <span class="n">GeneratorNum</span><span class="p">,</span><span class="n">RunFlagElectCenter</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-894"></a>                                      <span class="n">RunFlagPlant</span><span class="p">,</span><span class="n">ElecLoadRequest</span><span class="p">,</span> <span class="n">ThermalLoadRequest</span><span class="p">,</span>               <span class="p">&amp;</span>
<a name="ln-895"></a>                                      <span class="n">ElecLoadProvided</span><span class="p">,</span> <span class="n">OperatingMode</span><span class="p">,</span> <span class="n">PLRforSubtimestepStartUp</span><span class="p">,</span> <span class="n">PLRforSubtimestepShutDown</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-896"></a>                                      <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-897"></a>
<a name="ln-898"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-899"></a>          <span class="c">!       AUTHOR         B Griffith</span>
<a name="ln-900"></a>          <span class="c">!       DATE WRITTEN   February-March 2007  (replaced July 2006 attempt)</span>
<a name="ln-901"></a>          <span class="c">!       MODIFIED       Dec 2009, check and constrain with flow available from plant</span>
<a name="ln-902"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-903"></a>
<a name="ln-904"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-905"></a>          <span class="c">! provide a service to other generators to make decisions, mostly temporal, or cross-timestep issues</span>
<a name="ln-906"></a>          <span class="c">!  used to model internal controlling issues within an individual generator model</span>
<a name="ln-907"></a>          <span class="c">!  This subroutine determines the current operating mode and returns the allowed power and</span>
<a name="ln-908"></a>          <span class="c">! and part load ratio for certain sub-time step switching e.g. in and out of normal mode or cool down mode</span>
<a name="ln-909"></a>
<a name="ln-910"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-911"></a>          <span class="c">! model controls-related issues, rules based algorithm</span>
<a name="ln-912"></a>          <span class="c">! Control decision results include:</span>
<a name="ln-913"></a>          <span class="c">!     -- electrical load allowed/resulting/provided</span>
<a name="ln-914"></a>          <span class="c">!     -- new operating mode</span>
<a name="ln-915"></a>          <span class="c">!     -- part load this timestep for shift to normal mode occuring midway in timestep</span>
<a name="ln-916"></a>          <span class="c">!     -- part load this timestep for shift out of cool down mode</span>
<a name="ln-917"></a>
<a name="ln-918"></a>          <span class="c">! Input data used to make control decisions include:</span>
<a name="ln-919"></a>          <span class="c">!     -- Electrical load request</span>
<a name="ln-920"></a>          <span class="c">!     -- Thermal Load request</span>
<a name="ln-921"></a>          <span class="c">!     -- RunFlagElectricCenter</span>
<a name="ln-922"></a>          <span class="c">!     -- RunFlagPlant</span>
<a name="ln-923"></a>          <span class="c">!     -- previous timestep operating mode</span>
<a name="ln-924"></a>          <span class="c">!     -- previous timestep Power generated</span>
<a name="ln-925"></a>          <span class="c">!     -- availability schedule (off if not available)</span>
<a name="ln-926"></a>          <span class="c">!     -- Generator control parameter constants including</span>
<a name="ln-927"></a>          <span class="c">!           ** Start Up Time Delay  (in hours)</span>
<a name="ln-928"></a>          <span class="c">!           ** Cool-down time delay (in hours)</span>
<a name="ln-929"></a>          <span class="c">!     -- Expected Plant flow rate</span>
<a name="ln-930"></a>          <span class="c">!     -- minimum cooling water flow rate</span>
<a name="ln-931"></a>
<a name="ln-932"></a>          <span class="c">! Algorithm summary</span>
<a name="ln-933"></a>          <span class="c">!   1.  examine calling run flags and refine electric load request to account for</span>
<a name="ln-934"></a>          <span class="c">!       thermal load requests (not yet ready for prime time)</span>
<a name="ln-935"></a>          <span class="c">!   2.  Determine states of various control inputs that change during simulation</span>
<a name="ln-936"></a>          <span class="c">!</span>
<a name="ln-937"></a>          <span class="c">!   3.  enter case statement based on previous operating mode.</span>
<a name="ln-938"></a>          <span class="c">!       --  decide on current operating mode</span>
<a name="ln-939"></a>          <span class="c">!       --  calculate part loads</span>
<a name="ln-940"></a>
<a name="ln-941"></a>          <span class="c">!   4.  based on current operating mode determine allowed/provided electrical load</span>
<a name="ln-942"></a>          <span class="c">!        a. set allowed elec load by mode</span>
<a name="ln-943"></a>          <span class="c">!        b. set allowed elec load by constraints on rate of change</span>
<a name="ln-944"></a>          <span class="c">!        c. set allowed elec load by min and max</span>
<a name="ln-945"></a>
<a name="ln-946"></a>          <span class="c">!   5.  Calculated part load ratios for special cases.</span>
<a name="ln-947"></a>          <span class="c">!</span>
<a name="ln-948"></a>          <span class="c">!</span>
<a name="ln-949"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-950"></a>          <span class="c">! controls specifications in Annex 42 model specs.</span>
<a name="ln-951"></a>          <span class="c">!</span>
<a name="ln-952"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-953"></a>  <span class="k">USE </span><span class="n">DataGlobalConstants</span>
<a name="ln-954"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysTimeElapsed</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-955"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span><span class="p">,</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-956"></a>  <span class="k">USE </span><span class="n">DataLoopNode</span> <span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">Node</span>
<a name="ln-957"></a>
<a name="ln-958"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-959"></a>
<a name="ln-960"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-961"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">GeneratorType</span>     <span class="c">! type of Generator</span>
<a name="ln-962"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorName</span>     <span class="c">! user specified name of Generator</span>
<a name="ln-963"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">GeneratorNum</span>    <span class="c">! Generator number</span>
<a name="ln-964"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">RunFlagElectCenter</span>  <span class="c">! TRUE when Generator operating per electric load center request</span>
<a name="ln-965"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">RunFlagPlant</span>        <span class="c">! TRUE when generator operating per Plant request (always false)</span>
<a name="ln-966"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ElecLoadRequest</span>     <span class="c">! Generator Electrical power demand</span>
<a name="ln-967"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ThermalLoadRequest</span>  <span class="c">! cogenerator Thermal power demand</span>
<a name="ln-968"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ElecLoadProvided</span>  <span class="c">! power allowed</span>
<a name="ln-969"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OperatingMode</span>  <span class="c">! operating mode</span>
<a name="ln-970"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">PLRforSubtimestepStartUp</span> <span class="c">! part load ratio for switch to normal from start up</span>
<a name="ln-971"></a>                                                         <span class="c">! this is the part in normal mode</span>
<a name="ln-972"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">PLRforSubtimestepShutDown</span> <span class="c">! part load ratio for switch from cool down to other</span>
<a name="ln-973"></a>                                                      <span class="c">! this is the part in cool down mode.</span>
<a name="ln-974"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! True is this is first HVAC iteration</span>
<a name="ln-975"></a>
<a name="ln-976"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-977"></a>          <span class="c">! na</span>
<a name="ln-978"></a>
<a name="ln-979"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-980"></a>          <span class="c">! na</span>
<a name="ln-981"></a>
<a name="ln-982"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-983"></a>          <span class="c">! na</span>
<a name="ln-984"></a>
<a name="ln-985"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-986"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">RunFlag</span> <span class="c">! true if generator supposed to run</span>
<a name="ln-987"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DynaCntrlNum</span> <span class="c">!index in GeneratorDynamics structure for this generator          ! na</span>
<a name="ln-988"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CurrentFractionalDay</span> <span class="c">!working var, time in decimal days</span>
<a name="ln-989"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EndingFractionalDay</span>  <span class="c">!working var, time is decimal days</span>
<a name="ln-990"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LastSystemTimeStepFractionalDay</span> <span class="c">! working var, time is decimal days</span>
<a name="ln-991"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxPel</span> <span class="c">!working variable for max allowed by transient constraint</span>
<a name="ln-992"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MinPel</span> <span class="c">!working variabel for min allowed by transient constraint</span>
<a name="ln-993"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PelInput</span> <span class="c">!holds initial value of IN var</span>
<a name="ln-994"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Pel</span> <span class="c">!</span>
<a name="ln-995"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">newOpMode</span>
<a name="ln-996"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">schedVal</span>
<a name="ln-997"></a><span class="c">!  REAL(r64)    :: PelDiff</span>
<a name="ln-998"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ElectLoadForThermalRequest</span>
<a name="ln-999"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ConstrainedMaxP</span> <span class="c">! true if request was altered because of max power limit</span>
<a name="ln-1000"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ConstrainedMinP</span> <span class="c">! true if request was altered because of min power limit</span>
<a name="ln-1001"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ConstrainedIncreasingPdot</span> <span class="c">! true if request was altered because of power rate of change up</span>
<a name="ln-1002"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ConstrainedDecreasingPdot</span> <span class="c">! true if request was altered because of power rate of change down</span>
<a name="ln-1003"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ConstrainedByPlant</span> <span class="c">! true if request was altered because of cooling water problem</span>
<a name="ln-1004"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">PLRStartUp</span>  <span class="c">! true if subtimestep issue involving startup</span>
<a name="ln-1005"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">PLRShutDown</span>
<a name="ln-1006"></a><span class="c">!  INTEGER :: OutletCWnode        = 0 ! cooling water outlet node ID</span>
<a name="ln-1007"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">InletCWnode</span>         <span class="o">=</span> <span class="mi">0</span> <span class="c">! cooling water inlet node ID</span>
<a name="ln-1008"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">InternalFlowControl</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1009"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TcwIn</span>             <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! inlet cooling water temperature (C)</span>
<a name="ln-1010"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TrialMdotcw</span>       <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! test or estimate of what the plant flows are going to be (kg/s)</span>
<a name="ln-1011"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LimitMinMdotcw</span>    <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! lower limit for cooling water flow for generatior operation (kg/s)</span>
<a name="ln-1012"></a>
<a name="ln-1013"></a>  <span class="c">! inits</span>
<a name="ln-1014"></a>  <span class="n">PLRforSubtimestepStartUp</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1015"></a>  <span class="n">PLRforSubtimestepShutDown</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1016"></a>  <span class="n">ConstrainedMaxP</span>           <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1017"></a>  <span class="n">ConstrainedMinP</span>           <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1018"></a>  <span class="n">ConstrainedIncreasingPdot</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1019"></a>  <span class="n">ConstrainedDecreasingPdot</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1020"></a>  <span class="n">ConstrainedByPlant</span>        <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1021"></a>  <span class="n">PLRStartUp</span>                <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1022"></a>  <span class="n">PLRShutDown</span>               <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1023"></a>  <span class="n">InternalFlowControl</span>       <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1024"></a>
<a name="ln-1025"></a>  <span class="c">! get index for this generator in dynamics control structure</span>
<a name="ln-1026"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">GeneratorType</span><span class="p">)</span>
<a name="ln-1027"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">iGeneratorMicroCHP</span><span class="p">)</span>
<a name="ln-1028"></a>    <span class="n">DynaCntrlNum</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DynamicsControlID</span>
<a name="ln-1029"></a>   <span class="c">! OutletCWnode = MicroCHP(GeneratorNum)%PlantOutletNodeID</span>
<a name="ln-1030"></a>    <span class="n">InletCWnode</span>  <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span>
<a name="ln-1031"></a>    <span class="n">TcwIn</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1032"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">InternalFlowControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1033"></a><span class="k">      </span><span class="n">InternalFlowControl</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1034"></a>    <span class="n">ENDIF</span>
<a name="ln-1035"></a>    <span class="n">LimitMinMdotcw</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MinWaterMdot</span>
<a name="ln-1036"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">iGeneratorFuelCell</span><span class="p">)</span>
<a name="ln-1037"></a>     <span class="c">! not yet</span>
<a name="ln-1038"></a>  <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1039"></a>  <span class="k">END SELECT</span>
<a name="ln-1040"></a>
<a name="ln-1041"></a><span class="k">  </span><span class="n">PelInput</span> <span class="o">=</span> <span class="n">ElecLoadRequest</span>
<a name="ln-1042"></a>  <span class="n">ElectLoadForThermalRequest</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1043"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">ThermalLoadRequest</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RunFlagPlant</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! deal with possible thermal load following</span>
<a name="ln-1044"></a>  <span class="c">!Modify electric load request based on thermal load following signal using nominal efficiencies</span>
<a name="ln-1045"></a>    <span class="n">ElectLoadForThermalRequest</span> <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">ThermEffNom</span> <span class="p">&amp;</span>
<a name="ln-1046"></a>                               <span class="o">*</span> <span class="n">ThermalLoadRequest</span> <span class="o">/</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">ElectEffNom</span>
<a name="ln-1047"></a>    <span class="n">PelInput</span> <span class="o">=</span> <span class="nb">Max</span><span class="p">(</span><span class="n">PelInput</span><span class="p">,</span> <span class="n">ElectLoadForThermalRequest</span><span class="p">)</span>
<a name="ln-1048"></a>
<a name="ln-1049"></a>  <span class="n">ENDIF</span>
<a name="ln-1050"></a>
<a name="ln-1051"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">RunFlagElectCenter</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">RunFlagPlant</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1052"></a><span class="k">    </span><span class="n">RunFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1053"></a>  <span class="k">ELSE</span>
<a name="ln-1054"></a><span class="k">    </span><span class="n">RunFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1055"></a>  <span class="n">ENDIF</span>
<a name="ln-1056"></a>
<a name="ln-1057"></a>  <span class="c">! check availability schedule</span>
<a name="ln-1058"></a>  <span class="n">schedval</span>  <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">AvailabilitySchedID</span><span class="p">)</span>
<a name="ln-1059"></a>
<a name="ln-1060"></a>  <span class="n">Pel</span>      <span class="o">=</span> <span class="n">PelInput</span>
<a name="ln-1061"></a>
<a name="ln-1062"></a>  <span class="c">! get data to check if sufficient flow available from Plant</span>
<a name="ln-1063"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">InternalFlowControl</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">schedval</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1064"></a><span class="k">    </span><span class="n">TrialMdotcw</span> <span class="o">=</span> <span class="n">FuncDetermineCWMdotForInternalFlowControl</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">Pel</span><span class="p">,</span> <span class="n">TcwIn</span><span class="p">)</span>
<a name="ln-1065"></a>  <span class="k">ELSE</span>
<a name="ln-1066"></a><span class="k">    </span><span class="n">TrialMdotcw</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletCWnode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-1067"></a>  <span class="n">ENDIF</span>
<a name="ln-1068"></a>
<a name="ln-1069"></a>  <span class="c">!determine current operating mode.</span>
<a name="ln-1070"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">LastOpMode</span><span class="p">)</span>
<a name="ln-1071"></a>
<a name="ln-1072"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">OpModeOFF</span><span class="p">,</span> <span class="n">OpModeStandby</span><span class="p">)</span>
<a name="ln-1073"></a>    <span class="c">! possible future states {Off, Standby, WarmUp,Normal }</span>
<a name="ln-1074"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">schedval</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1075"></a><span class="k">       </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeOFF</span>
<a name="ln-1076"></a>
<a name="ln-1077"></a>     <span class="n">ELSEIF</span> <span class="p">(((</span><span class="n">schedval</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">RunFlag</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">TrialMdotcw</span> <span class="o">&lt;</span> <span class="n">LimitMinMdotcw</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1078"></a><span class="k">       </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeStandby</span>
<a name="ln-1079"></a>     <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">schedval</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Runflag</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1080"></a>
<a name="ln-1081"></a><span class="k">       IF</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">WarmUpByTimeDelay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1082"></a>
<a name="ln-1083"></a><span class="k">         If</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">StartUpTimeDelay</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1084"></a><span class="k">           </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeNormal</span>
<a name="ln-1085"></a>
<a name="ln-1086"></a>         <span class="c">! is startUp time delay longer than timestep?</span>
<a name="ln-1087"></a>         <span class="n">ELSEIf</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">StartUpTimeDelay</span> <span class="o">&gt;=</span> <span class="n">TimeStepSys</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!</span>
<a name="ln-1088"></a>           <span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeWarmUp</span>
<a name="ln-1089"></a>           <span class="c">! generator just started so set start time</span>
<a name="ln-1090"></a>           <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FractionalDayofLastStartUp</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1091"></a>                                  <span class="o">+</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SysTimeElapsed</span><span class="o">+</span><span class="p">(</span><span class="n">CurrentTime</span> <span class="o">-</span> <span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span> <span class="o">-</span> <span class="n">TimeStepSys</span> <span class="p">)))</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-1092"></a>
<a name="ln-1093"></a>         <span class="k">ELSE</span>  <span class="c">! warm up period is less than a single system time step</span>
<a name="ln-1094"></a>           <span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeNormal</span>
<a name="ln-1095"></a>           <span class="n">PLRStartUp</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1096"></a>           <span class="n">PLRforSubtimestepStartUp</span> <span class="o">=</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">-</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">StartUpTimeDelay</span><span class="p">)</span> <span class="o">/</span> <span class="n">TimeStepSys</span>
<a name="ln-1097"></a>         <span class="n">ENDIF</span>
<a name="ln-1098"></a>       <span class="n">ENDIF</span>
<a name="ln-1099"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">WarmUpByEngineTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1100"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Teng</span>  <span class="o">&gt;=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">TnomEngOp</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1101"></a><span class="k">           </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeNormal</span>
<a name="ln-1102"></a>           <span class="c">! assume linear interpolation for PLR</span>
<a name="ln-1103"></a>           <span class="n">PLRStartUp</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1104"></a>           <span class="k">IF</span>  <span class="p">(</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Teng</span> <span class="o">-</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TengLast</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1105"></a>               <span class="c">! protect divide by zero or neg</span>
<a name="ln-1106"></a>             <span class="n">PLRforSubtimestepStartUp</span> <span class="o">=</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Teng</span> <span class="o">-</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">TnomEngOp</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1107"></a>                                       <span class="o">/</span>  <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Teng</span> <span class="o">-</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TengLast</span><span class="p">)</span>
<a name="ln-1108"></a>           <span class="k">ELSE</span>
<a name="ln-1109"></a><span class="k">             </span><span class="n">PLRforSubtimestepStartUp</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1110"></a>           <span class="n">ENDIF</span>
<a name="ln-1111"></a>         <span class="k">ELSE</span>
<a name="ln-1112"></a><span class="k">           </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeWarmUp</span>
<a name="ln-1113"></a>         <span class="n">ENDIF</span>
<a name="ln-1114"></a>       <span class="n">ENDIF</span>
<a name="ln-1115"></a>
<a name="ln-1116"></a>     <span class="n">ENDIF</span>
<a name="ln-1117"></a>
<a name="ln-1118"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">OpModeWarmUp</span><span class="p">)</span>
<a name="ln-1119"></a>    <span class="c">! possible Future states {OFF, WarmUp, Normal, CoolDown }</span>
<a name="ln-1120"></a>        <span class="c">! check availability manager</span>
<a name="ln-1121"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">schedval</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1122"></a>       <span class="c">! to off unless cool down time period is needed</span>
<a name="ln-1123"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">CoolDownDelay</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1124"></a><span class="k">         </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeOFF</span>
<a name="ln-1125"></a>       <span class="k">ELSE</span>
<a name="ln-1126"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">CoolDownDelay</span> <span class="o">&gt;</span> <span class="n">TimeStepSys</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1127"></a><span class="k">           </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeCoolDown</span>
<a name="ln-1128"></a>                      <span class="c">! need to reset time of last shut down here</span>
<a name="ln-1129"></a>           <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FractionalDayofLastShutDown</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1130"></a>                                  <span class="o">+</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SysTimeElapsed</span><span class="o">+</span><span class="p">(</span><span class="n">CurrentTime</span> <span class="o">-</span> <span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">))))</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-1131"></a>         <span class="k">ELSE</span>
<a name="ln-1132"></a><span class="k">           </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeOFF</span>
<a name="ln-1133"></a>         <span class="n">ENDIF</span>
<a name="ln-1134"></a>       <span class="n">ENDIF</span>
<a name="ln-1135"></a>     <span class="n">ELSEIF</span> <span class="p">(((</span><span class="n">schedval</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">RunFlag</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">TrialMdotcw</span> <span class="o">&lt;</span> <span class="n">LimitMinMdotcw</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1136"></a>       <span class="c">! to standby unless cool down time period is needed</span>
<a name="ln-1137"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">CoolDownDelay</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1138"></a><span class="k">         </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeStandby</span>
<a name="ln-1139"></a>       <span class="k">ELSE</span>
<a name="ln-1140"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">CoolDownDelay</span> <span class="o">&gt;</span> <span class="n">TimeStepSys</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1141"></a><span class="k">           </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeCoolDown</span>
<a name="ln-1142"></a>           <span class="c">! need to reset time of last shut down here</span>
<a name="ln-1143"></a>           <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FractionalDayofLastShutDown</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1144"></a>                                  <span class="o">+</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SysTimeElapsed</span><span class="o">+</span><span class="p">(</span><span class="n">CurrentTime</span> <span class="o">-</span> <span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">))))</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-1145"></a>
<a name="ln-1146"></a>         <span class="k">ELSE</span>
<a name="ln-1147"></a><span class="k">           </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeStandby</span>
<a name="ln-1148"></a>           <span class="c">! assuming no PLR situation unless engine made to normal operation.</span>
<a name="ln-1149"></a>         <span class="n">ENDIF</span>
<a name="ln-1150"></a>       <span class="n">ENDIF</span>
<a name="ln-1151"></a>     <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">schedval</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">RunFlag</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1152"></a>       <span class="c">! either warm up or normal</span>
<a name="ln-1153"></a>       <span class="c">! check if warm up completed, depends on type of warm up control time delay or reach nominal temperature</span>
<a name="ln-1154"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">WarmUpByTimeDelay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1155"></a>         <span class="c">! compare current time to when warm up is over</span>
<a name="ln-1156"></a>          <span class="c">!calculate time for end of warmup period</span>
<a name="ln-1157"></a>         <span class="n">CurrentFractionalDay</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1158"></a>                            <span class="o">+</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SysTimeElapsed</span><span class="o">+</span><span class="p">(</span><span class="n">CurrentTime</span> <span class="o">-</span> <span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">))))</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-1159"></a>         <span class="n">EndingFractionalDay</span> <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FractionalDayofLastStartUp</span>  <span class="p">&amp;</span>
<a name="ln-1160"></a>                               <span class="o">+</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">StartUpTimeDelay</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-1161"></a>         <span class="k">IF</span> <span class="p">((</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="n">EndingFractionalDay</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.000001d0</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1162"></a>                <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">&gt;</span> <span class="n">EndingFractionalDay</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1163"></a><span class="k">           </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeNormal</span>
<a name="ln-1164"></a>           <span class="n">PLRStartUp</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1165"></a>           <span class="n">LastSystemTimeStepFractionalDay</span> <span class="o">=</span> <span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="p">(</span> <span class="n">TimeStepSys</span><span class="o">/</span><span class="n">HoursInDay</span> <span class="p">)</span>
<a name="ln-1166"></a>           <span class="n">PLRforSubtimestepStartUp</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="n">EndingFractionalDay</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1167"></a>                                      <span class="o">/</span> <span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="n">LastSystemTimeStepFractionalDay</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1168"></a>         <span class="k">ELSE</span>
<a name="ln-1169"></a><span class="k">           </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeWarmUp</span>
<a name="ln-1170"></a>         <span class="n">ENDIF</span>
<a name="ln-1171"></a>
<a name="ln-1172"></a>       <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">WarmUpByEngineTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1173"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">GeneratorType</span> <span class="o">==</span> <span class="n">iGeneratorMicroCHP</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1174"></a>           <span class="c">!only change to normal if this is result from completed timestep, not just an interation</span>
<a name="ln-1175"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TengLast</span>  <span class="o">&gt;=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">TnomEngOp</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1176"></a><span class="k">             </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeNormal</span>
<a name="ln-1177"></a>             <span class="c">! assume linear interpolation for PLR</span>
<a name="ln-1178"></a>             <span class="n">PLRStartUp</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1179"></a>             <span class="k">IF</span>  <span class="p">(</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Teng</span> <span class="o">-</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TengLast</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1180"></a>                 <span class="c">! protect divide by zero or neg</span>
<a name="ln-1181"></a>               <span class="n">PLRforSubtimestepStartUp</span> <span class="o">=</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Teng</span> <span class="o">-</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">TnomEngOp</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1182"></a>                                       <span class="o">/</span>  <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Teng</span> <span class="o">-</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TengLast</span><span class="p">)</span>
<a name="ln-1183"></a>             <span class="k">ELSE</span>
<a name="ln-1184"></a><span class="k">               </span><span class="n">PLRforSubtimestepStartUp</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1185"></a>             <span class="n">ENDIF</span>
<a name="ln-1186"></a>           <span class="k">ELSE</span>
<a name="ln-1187"></a><span class="k">             </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeWarmUp</span>
<a name="ln-1188"></a>           <span class="n">ENDIF</span>
<a name="ln-1189"></a>         <span class="n">ENDIF</span>
<a name="ln-1190"></a>       <span class="k">ELSE</span>
<a name="ln-1191"></a>         <span class="c">! shouldn&#39;t come here</span>
<a name="ln-1192"></a>        <span class="c">! Write(*,*) &#39;problem with warm up type of control logical flags&#39;</span>
<a name="ln-1193"></a>       <span class="n">ENDif</span>
<a name="ln-1194"></a>
<a name="ln-1195"></a>     <span class="n">ENDIF</span>
<a name="ln-1196"></a>
<a name="ln-1197"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">OpModeNormal</span><span class="p">)</span>
<a name="ln-1198"></a>   <span class="c">!possible Future states {CoolDown, standby, off}</span>
<a name="ln-1199"></a>     <span class="k">IF</span> <span class="p">(((</span><span class="n">schedval</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">RunFlag</span><span class="p">)).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">TrialMdotcw</span> <span class="o">&lt;</span> <span class="n">LimitMinMdotcw</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1200"></a>        <span class="c">! is cool down time delay longer than timestep?</span>
<a name="ln-1201"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">CoolDownDelay</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1202"></a><span class="k">         If</span> <span class="p">(</span><span class="n">schedval</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1203"></a><span class="k">           </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeStandBy</span>
<a name="ln-1204"></a>         <span class="k">else</span>
<a name="ln-1205"></a><span class="k">           </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeOff</span>
<a name="ln-1206"></a>         <span class="n">endif</span>
<a name="ln-1207"></a>       <span class="n">ElseIf</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">CoolDownDelay</span> <span class="o">&gt;=</span> <span class="n">TimeStepSys</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!</span>
<a name="ln-1208"></a>         <span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeCoolDown</span>
<a name="ln-1209"></a>         <span class="c">! also, generator just shut down so record shut down time</span>
<a name="ln-1210"></a>         <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FractionalDayofLastShutDown</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1211"></a>                                  <span class="o">+</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SysTimeElapsed</span><span class="o">+</span><span class="p">(</span><span class="n">CurrentTime</span> <span class="o">-</span> <span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">))))</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-1212"></a>       <span class="k">ELSE</span>  <span class="c">! cool down period is less than a single system time step</span>
<a name="ln-1213"></a>         <span class="k">If</span> <span class="p">(</span><span class="n">schedval</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1214"></a><span class="k">           </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeStandBy</span>
<a name="ln-1215"></a>         <span class="k">else</span>
<a name="ln-1216"></a><span class="k">           </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeOff</span>
<a name="ln-1217"></a>         <span class="n">endif</span>
<a name="ln-1218"></a>         <span class="n">PLRShutDown</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1219"></a>         <span class="n">PLRforSubtimestepShutdown</span> <span class="o">=</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">CoolDownDelay</span><span class="p">)</span> <span class="o">/</span> <span class="n">TimeStepSys</span>
<a name="ln-1220"></a>
<a name="ln-1221"></a>                  <span class="c">! also, generator just shut down so record shut down time</span>
<a name="ln-1222"></a>         <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FractionalDayofLastShutDown</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1223"></a>                                  <span class="o">+</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SysTimeElapsed</span><span class="o">+</span><span class="p">(</span><span class="n">CurrentTime</span> <span class="o">-</span> <span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">))))</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-1224"></a>       <span class="n">ENDIF</span>
<a name="ln-1225"></a>     <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">schedval</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="n">RunFlag</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1226"></a>
<a name="ln-1227"></a>
<a name="ln-1228"></a><span class="k">       </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeNormal</span>
<a name="ln-1229"></a>     <span class="n">ENDIF</span>
<a name="ln-1230"></a>
<a name="ln-1231"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">opModeCoolDown</span><span class="p">)</span>
<a name="ln-1232"></a>   <span class="c">!possible Future States {Standby, OFF, WarmUp, Normal}</span>
<a name="ln-1233"></a>
<a name="ln-1234"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">schedval</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span>  <span class="k">THEN</span> <span class="c">! no longer available.</span>
<a name="ln-1235"></a>       <span class="c">! probably goes to off but could be stuck in cool down for awhile</span>
<a name="ln-1236"></a>       <span class="k">If</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">CoolDownDelay</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1237"></a>         <span class="c">! calculate time for end of cool down period</span>
<a name="ln-1238"></a>         <span class="n">CurrentFractionalDay</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1239"></a>                            <span class="o">+</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SysTimeElapsed</span><span class="o">+</span><span class="p">(</span><span class="n">CurrentTime</span> <span class="o">-</span> <span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">))))</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-1240"></a>         <span class="n">EndingFractionalDay</span> <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FractionalDayofLastShutDown</span>  <span class="p">&amp;</span>
<a name="ln-1241"></a>                               <span class="o">+</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">CoolDownDelay</span><span class="o">/</span><span class="n">HoursInDay</span> <span class="o">-</span> <span class="p">(</span> <span class="n">TimeStepSys</span><span class="o">/</span><span class="n">HoursInDay</span> <span class="p">)</span>
<a name="ln-1242"></a>         <span class="k">IF</span> <span class="p">((</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="n">EndingFractionalDay</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.000001d0</span><span class="p">)</span>  <span class="p">&amp;</span> <span class="c">! CurrentFractionalDay == EndingFractionalDay</span>
<a name="ln-1243"></a>                <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">&gt;</span> <span class="n">EndingFractionalDay</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1244"></a><span class="k">           </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">opModeOFF</span>
<a name="ln-1245"></a>           <span class="n">PLRShutDown</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1246"></a>           <span class="n">LastSystemTimeStepFractionalDay</span> <span class="o">=</span> <span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="p">(</span> <span class="n">TimeStepSys</span><span class="o">/</span><span class="n">HoursInDay</span> <span class="p">)</span>
<a name="ln-1247"></a>           <span class="n">PLRforSubtimestepShutDown</span>  <span class="o">=</span> <span class="p">(</span><span class="n">EndingFractionalDay</span> <span class="o">-</span> <span class="n">LastSystemTimeStepFractionalDay</span><span class="p">)</span><span class="o">*</span><span class="n">HoursInDay</span>  <span class="p">&amp;</span>
<a name="ln-1248"></a>                                        <span class="o">/</span> <span class="n">TimeStepSys</span>
<a name="ln-1249"></a>         <span class="k">ELSE</span> <span class="c">! CurrentFractionalDay &gt; EndingFractionalDay</span>
<a name="ln-1250"></a>           <span class="n">newOpMode</span> <span class="o">=</span> <span class="n">opModeCoolDown</span>
<a name="ln-1251"></a>         <span class="n">ENDIF</span>
<a name="ln-1252"></a>       <span class="k">ELSE</span> <span class="c">!</span>
<a name="ln-1253"></a>         <span class="n">newOpMode</span> <span class="o">=</span> <span class="n">opModeOFF</span>
<a name="ln-1254"></a>       <span class="n">ENDIF</span>
<a name="ln-1255"></a>     <span class="n">ELSEIF</span> <span class="p">(((</span><span class="n">schedval</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">RunFlag</span><span class="p">)</span> <span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">TrialMdotcw</span> <span class="o">&lt;</span> <span class="n">LimitMinMdotcw</span><span class="p">))</span><span class="k">Then</span>
<a name="ln-1256"></a>       <span class="c">! probably goes to standby but could be stuck in cool down for awhile</span>
<a name="ln-1257"></a>       <span class="k">If</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">CoolDownDelay</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1258"></a>         <span class="c">! calculate time for end of cool down period</span>
<a name="ln-1259"></a>         <span class="n">CurrentFractionalDay</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1260"></a>                            <span class="o">+</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SysTimeElapsed</span><span class="o">+</span><span class="p">(</span><span class="n">CurrentTime</span> <span class="o">-</span> <span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">))))</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-1261"></a>         <span class="n">EndingFractionalDay</span> <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FractionalDayofLastShutDown</span>  <span class="p">&amp;</span>
<a name="ln-1262"></a>                               <span class="o">+</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">CoolDownDelay</span><span class="o">/</span><span class="n">HoursInDay</span> <span class="o">-</span> <span class="p">(</span> <span class="n">TimeStepSys</span> <span class="o">/</span><span class="n">HoursInDay</span> <span class="p">)</span>
<a name="ln-1263"></a>         <span class="k">IF</span> <span class="p">((</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="n">EndingFractionalDay</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.000001d0</span><span class="p">)</span>  <span class="p">&amp;</span> <span class="c">! CurrentFractionalDay == EndingFractionalDay</span>
<a name="ln-1264"></a>                <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">&gt;</span> <span class="n">EndingFractionalDay</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1265"></a><span class="k">           </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeStandby</span>
<a name="ln-1266"></a>           <span class="n">PLRShutDown</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1267"></a>           <span class="n">LastSystemTimeStepFractionalDay</span> <span class="o">=</span> <span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="p">(</span> <span class="n">TimeStepSys</span><span class="o">/</span><span class="n">HoursInDay</span> <span class="p">)</span>
<a name="ln-1268"></a>           <span class="n">PLRforSubtimestepShutDown</span>  <span class="o">=</span> <span class="p">(</span><span class="n">EndingFractionalDay</span> <span class="o">-</span> <span class="n">LastSystemTimeStepFractionalDay</span><span class="p">)</span><span class="o">*</span><span class="n">HoursInDay</span>  <span class="p">&amp;</span>
<a name="ln-1269"></a>                                        <span class="o">/</span> <span class="n">TimeStepSys</span>
<a name="ln-1270"></a>         <span class="k">ELSE</span> <span class="c">! CurrentFractionalDay &lt; EndingFractionalDay</span>
<a name="ln-1271"></a>           <span class="n">newOpMode</span> <span class="o">=</span> <span class="n">opModeCoolDown</span>
<a name="ln-1272"></a>         <span class="n">ENDIF</span>
<a name="ln-1273"></a>       <span class="k">ELSE</span> <span class="c">!</span>
<a name="ln-1274"></a>         <span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeStandby</span>
<a name="ln-1275"></a>       <span class="n">ENDIF</span>
<a name="ln-1276"></a>     <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">schedval</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="n">RunFlag</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1277"></a>       <span class="c">! was in cool down mode but is now being asked to restart</span>
<a name="ln-1278"></a>       <span class="c">! probably goes to warm up but could be stuck in cool down or jump to normal</span>
<a name="ln-1279"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">MandatoryFullCoolDown</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1280"></a>         <span class="c">! is cool down done or not?</span>
<a name="ln-1281"></a>         <span class="k">If</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">CoolDownDelay</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1282"></a>           <span class="c">! calculate time for end of cool down period</span>
<a name="ln-1283"></a>           <span class="n">CurrentFractionalDay</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1284"></a>                            <span class="o">+</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SysTimeElapsed</span><span class="o">+</span><span class="p">(</span><span class="n">CurrentTime</span> <span class="o">-</span> <span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">))))</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-1285"></a>           <span class="n">EndingFractionalDay</span> <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FractionalDayofLastShutDown</span>  <span class="p">&amp;</span>
<a name="ln-1286"></a>                               <span class="o">+</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">CoolDownDelay</span><span class="o">/</span><span class="n">HoursInDay</span> <span class="o">-</span> <span class="p">(</span> <span class="n">TimeStepSys</span><span class="o">/</span><span class="n">HoursInDay</span> <span class="p">)</span>
<a name="ln-1287"></a>           <span class="k">IF</span> <span class="p">((</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="n">EndingFractionalDay</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.000001d0</span><span class="p">)</span>  <span class="p">&amp;</span> <span class="c">! CurrentFractionalDay == EndingFractionalDay</span>
<a name="ln-1288"></a>                <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">&lt;</span> <span class="n">EndingFractionalDay</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1289"></a>
<a name="ln-1290"></a><span class="k">             </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">opModeCoolDown</span>
<a name="ln-1291"></a>           <span class="k">ELSE</span> <span class="c">! CurrentFractionalDay &gt; EndingFractionalDay</span>
<a name="ln-1292"></a>             <span class="c">! could go to warm up or normal now</span>
<a name="ln-1293"></a>             <span class="n">PLRShutDown</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1294"></a>             <span class="n">LastSystemTimeStepFractionalDay</span> <span class="o">=</span> <span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="p">(</span> <span class="n">TimeStepSys</span><span class="o">/</span><span class="n">HoursInDay</span> <span class="p">)</span>
<a name="ln-1295"></a>             <span class="n">PLRforSubtimestepShutDown</span>  <span class="o">=</span> <span class="p">(</span><span class="n">EndingFractionalDay</span> <span class="o">-</span> <span class="n">LastSystemTimeStepFractionalDay</span><span class="p">)</span><span class="o">*</span><span class="n">HoursInDay</span>  <span class="p">&amp;</span>
<a name="ln-1296"></a>                                        <span class="o">/</span> <span class="n">TimeStepSys</span>
<a name="ln-1297"></a>             <span class="k">If</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">StartUpTimeDelay</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1298"></a><span class="k">               </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">opModeNormal</span>
<a name="ln-1299"></a>               <span class="c">! possible PLR on start up.</span>
<a name="ln-1300"></a>               <span class="n">PLRStartUp</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1301"></a>               <span class="n">PLRforSubtimestepStartUp</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="n">EndingFractionalDay</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1302"></a>                                      <span class="o">/</span> <span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="n">LastSystemTimeStepFractionalDay</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1303"></a>
<a name="ln-1304"></a>             <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">StartUpTimeDelay</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1305"></a>               <span class="c">! is remaining time enough?</span>
<a name="ln-1306"></a>               <span class="k">IF</span> <span class="p">((</span> <span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="n">EndingFractionalDay</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">StartUpTimeDelay</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1307"></a><span class="k">                 </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">opModeNormal</span>
<a name="ln-1308"></a>                 <span class="c">! possible PLR on start up.</span>
<a name="ln-1309"></a>                 <span class="n">PLRStartUp</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1310"></a>                 <span class="n">PLRforSubtimestepStartUp</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="n">EndingFractionalDay</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1311"></a>                                      <span class="o">/</span> <span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="n">LastSystemTimeStepFractionalDay</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1312"></a>               <span class="k">ELSE</span>
<a name="ln-1313"></a><span class="k">                 </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeWarmUp</span>
<a name="ln-1314"></a>                 <span class="c">! generator just started so set start time</span>
<a name="ln-1315"></a>                 <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FractionalDayofLastStartUp</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1316"></a>                                  <span class="o">+</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SysTimeElapsed</span><span class="o">+</span><span class="p">(</span><span class="n">CurrentTime</span> <span class="o">-</span> <span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span> <span class="o">-</span> <span class="n">TimeStepSys</span> <span class="p">)))</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-1317"></a>
<a name="ln-1318"></a>               <span class="n">ENDIF</span>
<a name="ln-1319"></a>             <span class="n">ENDIF</span>
<a name="ln-1320"></a>           <span class="n">ENDIF</span>
<a name="ln-1321"></a>         <span class="k">ELSE</span> <span class="c">!</span>
<a name="ln-1322"></a>
<a name="ln-1323"></a>           <span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeStandby</span>
<a name="ln-1324"></a>         <span class="n">ENDIF</span>
<a name="ln-1325"></a>       <span class="k">ELSE</span> <span class="c">!not mandetory cool donw</span>
<a name="ln-1326"></a>         <span class="c">! likely to go into warm up but if no warm up then back to normal</span>
<a name="ln-1327"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">WarmUpByTimeDelay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1328"></a><span class="k">           If</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">StartUpTimeDelay</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1329"></a><span class="k">             </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">opModeNormal</span>
<a name="ln-1330"></a>
<a name="ln-1331"></a>           <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">StartUpTimeDelay</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1332"></a><span class="k">             </span><span class="n">CurrentFractionalDay</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1333"></a>                            <span class="o">+</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SysTimeElapsed</span><span class="o">+</span><span class="p">(</span><span class="n">CurrentTime</span> <span class="o">-</span> <span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">))))</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-1334"></a>             <span class="n">EndingFractionalDay</span> <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FractionalDayofLastShutDown</span>  <span class="p">&amp;</span>
<a name="ln-1335"></a>                               <span class="o">+</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">CoolDownDelay</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-1336"></a>             <span class="k">IF</span> <span class="p">((</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="n">EndingFractionalDay</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.000001d0</span><span class="p">)</span>  <span class="p">&amp;</span> <span class="c">! CurrentFractionalDay == EndingFractionalDay</span>
<a name="ln-1337"></a>                <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">&gt;</span> <span class="n">EndingFractionalDay</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1338"></a><span class="k">               </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">opModeNormal</span>
<a name="ln-1339"></a>                 <span class="c">! possible PLR on start up.</span>
<a name="ln-1340"></a>               <span class="n">PLRStartUp</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1341"></a>               <span class="n">LastSystemTimeStepFractionalDay</span> <span class="o">=</span> <span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="p">(</span> <span class="n">TimeStepSys</span><span class="o">/</span><span class="n">HoursInDay</span> <span class="p">)</span>
<a name="ln-1342"></a>               <span class="n">PLRforSubtimestepStartUp</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="n">EndingFractionalDay</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1343"></a>                                      <span class="o">/</span> <span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">-</span> <span class="n">LastSystemTimeStepFractionalDay</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1344"></a>             <span class="k">ELSE</span>
<a name="ln-1345"></a><span class="k">               </span><span class="n">newOpMode</span> <span class="o">=</span> <span class="n">OpModeWarmUp</span>
<a name="ln-1346"></a>               <span class="c">! set start up time</span>
<a name="ln-1347"></a>               <span class="c">! generator just started so set start time</span>
<a name="ln-1348"></a>               <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FractionalDayofLastStartUp</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1349"></a>                                  <span class="o">+</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SysTimeElapsed</span><span class="o">+</span><span class="p">(</span><span class="n">CurrentTime</span> <span class="o">-</span> <span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span> <span class="o">-</span> <span class="n">TimeStepSys</span> <span class="p">)))</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-1350"></a>
<a name="ln-1351"></a>             <span class="n">ENDIF</span>
<a name="ln-1352"></a>
<a name="ln-1353"></a>            <span class="n">ENDIF</span>
<a name="ln-1354"></a>          <span class="n">ENDIF</span>
<a name="ln-1355"></a>       <span class="n">ENDIF</span>
<a name="ln-1356"></a>
<a name="ln-1357"></a>     <span class="n">ENDIF</span>
<a name="ln-1358"></a>  <span class="k">END SELECT</span> <span class="c">!previous case</span>
<a name="ln-1359"></a>
<a name="ln-1360"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">PLRforSubtimestepStartUp</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">PLRforSubtimestepStartUp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1361"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">PLRforSubtimestepStartUp</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="n">PLRforSubtimestepStartUp</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1362"></a>
<a name="ln-1363"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">PLRforSubtimestepShutDown</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1364"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="n">PLRforSubtimestepShutDown</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1365"></a>
<a name="ln-1366"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">newOpmode</span> <span class="o">==</span> <span class="n">OpModeWarmUp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1367"></a><span class="k">    SELECT CASE</span> <span class="p">(</span><span class="n">GeneratorType</span><span class="p">)</span>
<a name="ln-1368"></a>
<a name="ln-1369"></a>    <span class="k">CASE</span><span class="p">(</span> <span class="n">iGeneratorFuelCell</span>  <span class="p">)</span>
<a name="ln-1370"></a>        <span class="c">!constant power level during start up (modeling artifact)</span>
<a name="ln-1371"></a>          <span class="c">!? hours or seconds here?</span>
<a name="ln-1372"></a>      <span class="n">Pel</span> <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">StartUpElectProd</span><span class="o">/</span><span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">StartUpTimeDelay</span>
<a name="ln-1373"></a>
<a name="ln-1374"></a>    <span class="k">CASE</span> <span class="p">(</span> <span class="n">iGeneratorMicroCHP</span><span class="p">)</span>
<a name="ln-1375"></a>
<a name="ln-1376"></a>
<a name="ln-1377"></a>      <span class="n">Pel</span> <span class="o">=</span>    <span class="n">PelInput</span> <span class="o">*</span> <span class="n">PLRforSubtimestepStartUp</span>
<a name="ln-1378"></a>
<a name="ln-1379"></a>    <span class="k">END SELECT</span>
<a name="ln-1380"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-1381"></a>
<a name="ln-1382"></a>
<a name="ln-1383"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">newOpmode</span> <span class="o">==</span> <span class="n">OpModeNormal</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1384"></a>    <span class="c">! correct if switched to normal at sub timestep</span>
<a name="ln-1385"></a>    <span class="n">Pel</span> <span class="o">=</span> <span class="n">Pel</span> <span class="o">*</span> <span class="n">PLRforSubtimestepStartUp</span>
<a name="ln-1386"></a>    <span class="c">!unit may have constraints from transient limits or operating ranges.</span>
<a name="ln-1387"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Pel</span> <span class="o">&gt;</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">PelLastTimeStep</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! powering up</span>
<a name="ln-1388"></a>      <span class="n">MaxPel</span> <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">PelLastTimeStep</span>  <span class="p">&amp;</span>
<a name="ln-1389"></a>               <span class="o">+</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">UpTranLimit</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span>
<a name="ln-1390"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MaxPel</span> <span class="o">&lt;</span> <span class="n">Pel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1391"></a><span class="k">        </span><span class="n">Pel</span> <span class="o">=</span> <span class="n">MaxPel</span>
<a name="ln-1392"></a>      <span class="n">ENDIF</span>
<a name="ln-1393"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Pel</span><span class="o">&lt;</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">PelLastTimeStep</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!powering down</span>
<a name="ln-1394"></a>      <span class="n">MinPel</span> <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">PelLastTimeStep</span> <span class="p">&amp;</span>
<a name="ln-1395"></a>                <span class="o">-</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">DownTranLimit</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span>
<a name="ln-1396"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Pel</span> <span class="o">&lt;</span> <span class="n">MinPel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1397"></a><span class="k">        </span><span class="n">Pel</span> <span class="o">=</span> <span class="n">MinPel</span>
<a name="ln-1398"></a>      <span class="n">ENDIF</span>
<a name="ln-1399"></a>    <span class="n">ENDIF</span>
<a name="ln-1400"></a>
<a name="ln-1401"></a>  <span class="n">ENDIF</span> <span class="c">!</span>
<a name="ln-1402"></a>
<a name="ln-1403"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">newOpmode</span> <span class="o">==</span> <span class="n">opModeCoolDown</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1404"></a><span class="k">    </span><span class="n">Pel</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! assumes no power generated during shut down</span>
<a name="ln-1405"></a>  <span class="n">ENDIF</span>
<a name="ln-1406"></a>
<a name="ln-1407"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">newOpmode</span> <span class="o">==</span> <span class="n">OpModeOFF</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1408"></a><span class="k">    </span><span class="n">Pel</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! assumes no power generated during OFF mode</span>
<a name="ln-1409"></a>  <span class="n">ENDIF</span>
<a name="ln-1410"></a>
<a name="ln-1411"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">newOpmode</span> <span class="o">==</span> <span class="n">OpModeStandby</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1412"></a><span class="k">    </span><span class="n">Pel</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! assumes no power generated during standby mode</span>
<a name="ln-1413"></a>  <span class="n">ENDIF</span>
<a name="ln-1414"></a>
<a name="ln-1415"></a>  <span class="c">! Control step 3: adjust for max and min limits on Pel</span>
<a name="ln-1416"></a>
<a name="ln-1417"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">Pel</span> <span class="o">&lt;</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">PelMin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1418"></a><span class="k">   </span><span class="n">Pel</span> <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">PelMin</span>
<a name="ln-1419"></a>  <span class="n">ENDIF</span>
<a name="ln-1420"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">Pel</span> <span class="o">&gt;</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">PelMax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1421"></a><span class="k">   </span><span class="n">Pel</span> <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">PelMax</span>
<a name="ln-1422"></a>
<a name="ln-1423"></a>  <span class="n">ENDIF</span>
<a name="ln-1424"></a>
<a name="ln-1425"></a>  <span class="c">!now do record keeping for amount of time spent in various operating modes</span>
<a name="ln-1426"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">GeneratorType</span><span class="p">)</span>
<a name="ln-1427"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">iGeneratorMicroCHP</span><span class="p">)</span>
<a name="ln-1428"></a>    <span class="c">! first clear out values</span>
<a name="ln-1429"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">OffModeTime</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1430"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">StandyByModeTime</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1431"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">WarmUpModeTime</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1432"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">NormalModeTime</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1433"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">CoolDownModeTime</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1434"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">newOpMode</span><span class="p">)</span>
<a name="ln-1435"></a>
<a name="ln-1436"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">OpModeOFF</span><span class="p">)</span>
<a name="ln-1437"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1438"></a><span class="k">        </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">OffModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span>
<a name="ln-1439"></a>      <span class="n">ELSEIF</span> <span class="p">(</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1440"></a><span class="k">        </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">CoolDownModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span> <span class="o">*</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="p">)</span>
<a name="ln-1441"></a>        <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">OffModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">PLRforSubtimestepShutDown</span> <span class="p">)</span>
<a name="ln-1442"></a>      <span class="k">ELSE</span>
<a name="ln-1443"></a><span class="k">        </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">OffModeTime</span> <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span>
<a name="ln-1444"></a>      <span class="n">ENDIF</span>
<a name="ln-1445"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">OpModeStandby</span><span class="p">)</span>
<a name="ln-1446"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1447"></a><span class="k">        </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">StandyByModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span>
<a name="ln-1448"></a>      <span class="n">ELSEIF</span> <span class="p">(</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1449"></a><span class="k">        </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">CoolDownModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span> <span class="o">*</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="p">)</span>
<a name="ln-1450"></a>        <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">StandyByModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">PLRforSubtimestepShutDown</span> <span class="p">)</span>
<a name="ln-1451"></a>      <span class="k">ELSE</span>
<a name="ln-1452"></a><span class="k">        </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">StandyByModeTime</span> <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span>
<a name="ln-1453"></a>      <span class="n">ENDIF</span>
<a name="ln-1454"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">OpModeWarmUp</span><span class="p">)</span>
<a name="ln-1455"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1456"></a><span class="k">        </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">WarmUpModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span>
<a name="ln-1457"></a>      <span class="n">ELSEIF</span> <span class="p">(</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1458"></a><span class="k">        </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">CoolDownModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span> <span class="o">*</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="p">)</span>
<a name="ln-1459"></a>        <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">WarmUpModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">PLRforSubtimestepShutDown</span> <span class="p">)</span>
<a name="ln-1460"></a>      <span class="k">ELSE</span>
<a name="ln-1461"></a><span class="k">        </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">WarmUpModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span>
<a name="ln-1462"></a>      <span class="n">ENDIF</span>
<a name="ln-1463"></a>
<a name="ln-1464"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">OpModeNormal</span><span class="p">)</span>
<a name="ln-1465"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PLRforSubtimestepStartUp</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1466"></a><span class="k">        </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">WarmUpModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span>
<a name="ln-1467"></a>
<a name="ln-1468"></a>      <span class="n">ELSEIF</span> <span class="p">(</span> <span class="p">(</span><span class="n">PLRforSubtimestepStartUp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">PLRforSubtimestepStartUp</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1469"></a><span class="k">        </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">WarmUpModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.0d0</span> <span class="o">-</span><span class="n">PLRforSubtimestepStartUp</span> <span class="p">)</span>
<a name="ln-1470"></a>        <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">NormalModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span> <span class="o">*</span> <span class="p">(</span> <span class="n">PLRforSubtimestepStartUp</span> <span class="p">)</span>
<a name="ln-1471"></a>
<a name="ln-1472"></a>      <span class="k">ELSE</span>
<a name="ln-1473"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1474"></a><span class="k">          </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">NormalModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span>
<a name="ln-1475"></a>        <span class="n">ELSEIF</span> <span class="p">(</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1476"></a><span class="k">          </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">CoolDownModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span> <span class="o">*</span> <span class="p">(</span><span class="n">PLRforSubtimestepShutDown</span> <span class="p">)</span>
<a name="ln-1477"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">NormalModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">PLRforSubtimestepShutDown</span> <span class="p">)</span>
<a name="ln-1478"></a>        <span class="k">ELSE</span>
<a name="ln-1479"></a><span class="k">          </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">NormalModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span>
<a name="ln-1480"></a>        <span class="n">ENDIF</span>
<a name="ln-1481"></a>      <span class="n">ENDIF</span>
<a name="ln-1482"></a>
<a name="ln-1483"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">opModeCoolDown</span><span class="p">)</span>
<a name="ln-1484"></a>
<a name="ln-1485"></a>      <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42model</span><span class="p">%</span><span class="n">CoolDownModeTime</span>  <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span>
<a name="ln-1486"></a>    <span class="k">END SELECT</span>
<a name="ln-1487"></a>
<a name="ln-1488"></a><span class="k">  CASE</span> <span class="p">(</span><span class="n">iGeneratorFuelCell</span><span class="p">)</span>
<a name="ln-1489"></a>     <span class="c">! not yet using this control manager</span>
<a name="ln-1490"></a>  <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1491"></a>  <span class="k">END SELECT</span>
<a name="ln-1492"></a>
<a name="ln-1493"></a>
<a name="ln-1494"></a>
<a name="ln-1495"></a><span class="k">  </span><span class="n">ElecLoadProvided</span> <span class="o">=</span> <span class="n">Pel</span>
<a name="ln-1496"></a>
<a name="ln-1497"></a>  <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">CurrentOpMode</span> <span class="o">=</span> <span class="n">newOpMode</span>
<a name="ln-1498"></a>  <span class="n">OperatingMode</span> <span class="o">=</span> <span class="n">newOpMode</span>
<a name="ln-1499"></a>
<a name="ln-1500"></a>  <span class="k">RETURN</span>
<a name="ln-1501"></a>
<a name="ln-1502"></a><span class="k">END SUBROUTINE </span><span class="n">ManageGeneratorControlState</span>
<a name="ln-1503"></a>
<a name="ln-1504"></a>
<a name="ln-1505"></a><span class="k">SUBROUTINE </span><span class="n">ManageGeneratorFuelFlow</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span> <span class="n">GeneratorName</span><span class="p">,</span> <span class="n">GeneratorNum</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">FuelFlowRequest</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1506"></a>                                      <span class="n">FuelFlowProvided</span><span class="p">,</span> <span class="n">ConstrainedIncreasingMdot</span><span class="p">,</span> <span class="n">ConstrainedDecreasingMdot</span><span class="p">)</span>
<a name="ln-1507"></a>
<a name="ln-1508"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1509"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-1510"></a>          <span class="c">!       DATE WRITTEN   July 2006</span>
<a name="ln-1511"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1512"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1513"></a>
<a name="ln-1514"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1515"></a>          <span class="c">! check if change in fuel flow rate is okay</span>
<a name="ln-1516"></a>
<a name="ln-1517"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1518"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1519"></a>
<a name="ln-1520"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1521"></a>          <span class="c">! na</span>
<a name="ln-1522"></a>
<a name="ln-1523"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1524"></a>          <span class="c">! na</span>
<a name="ln-1525"></a>  <span class="k">USE </span><span class="n">DataGlobalConstants</span>
<a name="ln-1526"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span><span class="n">TimeStepSys</span>
<a name="ln-1527"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1528"></a>
<a name="ln-1529"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1530"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorType</span>     <span class="c">! type of Generator</span>
<a name="ln-1531"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorName</span>     <span class="c">! user specified name of Generator</span>
<a name="ln-1532"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">GeneratorNum</span>    <span class="c">! Generator number</span>
<a name="ln-1533"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RunFlag</span>         <span class="c">! TRUE when Generator operating</span>
<a name="ln-1534"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">FuelFlowRequest</span>    <span class="c">! Generator demand mdot kg/ s</span>
<a name="ln-1535"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FuelFlowProvided</span>   <span class="c">! allowed after constraints kg/s</span>
<a name="ln-1536"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ConstrainedIncreasingMdot</span> <span class="c">! true if request was altered because of fuel rate of change up</span>
<a name="ln-1537"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ConstrainedDecreasingMdot</span> <span class="c">! true if request was altered because of fuel rate of change down</span>
<a name="ln-1538"></a>
<a name="ln-1539"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1540"></a>          <span class="c">! na</span>
<a name="ln-1541"></a>
<a name="ln-1542"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1543"></a>          <span class="c">! na</span>
<a name="ln-1544"></a>
<a name="ln-1545"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1546"></a>          <span class="c">! na</span>
<a name="ln-1547"></a>
<a name="ln-1548"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1549"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MdotFuel</span>
<a name="ln-1550"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxMdot</span>
<a name="ln-1551"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MinMdot</span>
<a name="ln-1552"></a> <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DynaCntrlNum</span>
<a name="ln-1553"></a>
<a name="ln-1554"></a> <span class="n">ConstrainedIncreasingMdot</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1555"></a> <span class="n">ConstrainedDecreasingMdot</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1556"></a> <span class="n">MdotFuel</span> <span class="o">=</span> <span class="n">FuelFlowRequest</span>
<a name="ln-1557"></a>
<a name="ln-1558"></a> <span class="c">! get index from GeneratorNum</span>
<a name="ln-1559"></a><span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">GeneratorType</span><span class="p">)</span>
<a name="ln-1560"></a><span class="k">CASE</span> <span class="p">(</span><span class="n">iGeneratorMicroCHP</span><span class="p">)</span>
<a name="ln-1561"></a>     <span class="n">DynaCntrlNum</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DynamicsControlID</span>
<a name="ln-1562"></a>
<a name="ln-1563"></a><span class="k">END SELECT</span>
<a name="ln-1564"></a>
<a name="ln-1565"></a><span class="k">IF</span> <span class="p">(</span><span class="n">FuelFlowRequest</span> <span class="o">&gt;</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FuelMdotLastTimestep</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! fuel flow is up</span>
<a name="ln-1566"></a>  <span class="n">MaxMdot</span> <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FuelMdotLastTimestep</span>  <span class="p">&amp;</span>
<a name="ln-1567"></a>            <span class="o">+</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">UpTranLimitFuel</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span>
<a name="ln-1568"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MaxMdot</span> <span class="o">&lt;</span> <span class="n">FuelFlowRequest</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1569"></a><span class="k">     </span><span class="n">MdotFuel</span> <span class="o">=</span> <span class="n">MaxMdot</span>
<a name="ln-1570"></a>     <span class="n">ConstrainedIncreasingMdot</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1571"></a>  <span class="n">ENDIF</span>
<a name="ln-1572"></a>
<a name="ln-1573"></a><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">FuelFlowRequest</span> <span class="o">&lt;</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FuelMdotLastTimestep</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! fuel flow is down</span>
<a name="ln-1574"></a>  <span class="n">MinMdot</span> <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FuelMdotLastTimestep</span>  <span class="p">&amp;</span>
<a name="ln-1575"></a>            <span class="o">-</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">DownTranLimitFuel</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span>
<a name="ln-1576"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FuelFlowRequest</span> <span class="o">&lt;</span> <span class="n">MinMdot</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1577"></a><span class="k">     </span><span class="n">MdotFuel</span> <span class="o">=</span> <span class="n">MinMdot</span>
<a name="ln-1578"></a>     <span class="n">ConstrainedDecreasingMdot</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1579"></a>  <span class="n">ENDIF</span>
<a name="ln-1580"></a><span class="k">ELSE</span>
<a name="ln-1581"></a> <span class="c">! do nothing</span>
<a name="ln-1582"></a><span class="n">ENDIF</span>
<a name="ln-1583"></a>
<a name="ln-1584"></a><span class="n">FuelFlowProvided</span> <span class="o">=</span> <span class="n">MdotFuel</span>
<a name="ln-1585"></a>
<a name="ln-1586"></a><span class="k">RETURN</span>
<a name="ln-1587"></a>
<a name="ln-1588"></a><span class="k">END SUBROUTINE </span><span class="n">ManageGeneratorFuelFlow</span>
<a name="ln-1589"></a>
<a name="ln-1590"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">FuncDetermineCWMdotForInternalFlowControl</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">Pnetss</span><span class="p">,</span> <span class="n">TcwIn</span><span class="p">)</span>
<a name="ln-1591"></a>
<a name="ln-1592"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1593"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-1594"></a>          <span class="c">!       DATE WRITTEN   Dec 2009</span>
<a name="ln-1595"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1596"></a>          <span class="c">!       RE-ENGINEERED  B. Griffith, Sept 2010, plant upgrade</span>
<a name="ln-1597"></a>
<a name="ln-1598"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1599"></a>          <span class="c">! common place to figure flow rates with internal flow control</span>
<a name="ln-1600"></a>
<a name="ln-1601"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1602"></a>          <span class="c">! apply contraints imposed by plant according to flow lock, first HVAC iteration etc.</span>
<a name="ln-1603"></a>
<a name="ln-1604"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1605"></a>          <span class="c">! na</span>
<a name="ln-1606"></a>
<a name="ln-1607"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1608"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-1609"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-1610"></a>  <span class="k">USE </span><span class="n">DataLoopNode</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">Node</span>
<a name="ln-1611"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-1612"></a>
<a name="ln-1613"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1614"></a>
<a name="ln-1615"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1616"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorNum</span> <span class="c">! ID of generator</span>
<a name="ln-1617"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Pnetss</span> <span class="c">! power net steady state</span>
<a name="ln-1618"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TcwIn</span> <span class="c">! temperature of cooling water at inlet</span>
<a name="ln-1619"></a>
<a name="ln-1620"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-1621"></a>          <span class="c">! na</span>
<a name="ln-1622"></a>
<a name="ln-1623"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1624"></a>          <span class="c">! na</span>
<a name="ln-1625"></a>
<a name="ln-1626"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1627"></a>          <span class="c">! na</span>
<a name="ln-1628"></a>
<a name="ln-1629"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1630"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MdotCW</span>
<a name="ln-1631"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">InletNode</span>
<a name="ln-1632"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">OutletNode</span>
<a name="ln-1633"></a>
<a name="ln-1634"></a>  <span class="n">InletNode</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span>
<a name="ln-1635"></a>  <span class="n">OutletNode</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantOutletNodeID</span>
<a name="ln-1636"></a>
<a name="ln-1637"></a>  <span class="c">! first evaluate curve</span>
<a name="ln-1638"></a>  <span class="n">Mdotcw</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">WaterFlowCurveID</span><span class="p">,</span> <span class="n">Pnetss</span><span class="p">,</span> <span class="n">TcwIn</span><span class="p">)</span>
<a name="ln-1639"></a>
<a name="ln-1640"></a>  <span class="c">! now apply constraints</span>
<a name="ln-1641"></a>  <span class="n">Mdotcw</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span> <span class="n">Mdotcw</span><span class="p">)</span>
<a name="ln-1642"></a>
<a name="ln-1643"></a>  <span class="c">!make sure plant can provide, utility call may change flow</span>
<a name="ln-1644"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! protect early calls</span>
<a name="ln-1645"></a>    <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">Mdotcw</span><span class="p">,</span><span class="n">InletNode</span><span class="p">,</span><span class="n">OutletNode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1646"></a>                       <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-1647"></a>                       <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1648"></a>                       <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWBranchNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1649"></a>                       <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWCompNum</span><span class="p">)</span>
<a name="ln-1650"></a>  <span class="n">ENDIF</span>
<a name="ln-1651"></a>
<a name="ln-1652"></a>  <span class="n">FuncDetermineCWMdotForInternalFlowControl</span> <span class="o">=</span> <span class="n">Mdotcw</span>
<a name="ln-1653"></a>  <span class="k">RETURN</span>
<a name="ln-1654"></a>
<a name="ln-1655"></a><span class="k">END FUNCTION </span><span class="n">FuncDetermineCWMdotForInternalFlowControl</span>
<a name="ln-1656"></a>
<a name="ln-1657"></a><span class="k">END MODULE </span><span class="n">GeneratorDynamicsManager</span>
<a name="ln-1658"></a>
<a name="ln-1659"></a><span class="c">!************************************************************************************</span>
<a name="ln-1660"></a><span class="k">MODULE </span><span class="n">MicroCHPElectricGenerator</span>
<a name="ln-1661"></a>
<a name="ln-1662"></a>          <span class="c">! MODULE INFORMATION:</span>
<a name="ln-1663"></a>          <span class="c">!       AUTHOR         Brent Griffth</span>
<a name="ln-1664"></a>          <span class="c">!       DATE WRITTEN   June 2006</span>
<a name="ln-1665"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1666"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1667"></a>
<a name="ln-1668"></a>          <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-1669"></a>          <span class="c">! This module simulates the operation of Internal Combustion and Stirling Engine</span>
<a name="ln-1670"></a>          <span class="c">!  residential-scale generators for combined heat and power.</span>
<a name="ln-1671"></a>
<a name="ln-1672"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1673"></a>          <span class="c">! Once the ElectricPowerManager determines that the Combustion Generator</span>
<a name="ln-1674"></a>          <span class="c">! is available to meet an electric load demand, it calls SimCombustionGenerator</span>
<a name="ln-1675"></a>          <span class="c">! which in turn calls the Combustion model.</span>
<a name="ln-1676"></a>          <span class="c">! See DataFuelCells.f90 for structures and variables</span>
<a name="ln-1677"></a>
<a name="ln-1678"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1679"></a>          <span class="c">! IEA/ECBCS Annex 42 model specification titled: &quot; A Generic Model Specification for</span>
<a name="ln-1680"></a>          <span class="c">! Combustion-based Residential CHP Devices&quot;  Alex Ferguson, Nick Kelly, IEA Annex 42.</span>
<a name="ln-1681"></a>          <span class="c">!</span>
<a name="ln-1682"></a>          <span class="c">! Module developed from</span>
<a name="ln-1683"></a>
<a name="ln-1684"></a>          <span class="c">! OTHER NOTES:</span>
<a name="ln-1685"></a>          <span class="c">! N/A</span>
<a name="ln-1686"></a>
<a name="ln-1687"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1688"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-1689"></a><span class="k">USE </span><span class="n">DataGenerators</span>
<a name="ln-1690"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-1691"></a><span class="k">USE </span><span class="n">DataGlobals</span> <span class="p">,</span>   <span class="n">ONLY</span> <span class="p">:</span> <span class="n">MaxNameLength</span><span class="p">,</span> <span class="n">NumOfTimeStepInHour</span><span class="p">,</span> <span class="n">NumOfZones</span><span class="p">,</span> <span class="n">KelvinConv</span><span class="p">,</span> <span class="n">HoursInDay</span><span class="p">,</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-1692"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-1693"></a><span class="k">USE </span><span class="n">DataGlobalConstants</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">iGeneratorFuelCell</span>
<a name="ln-1694"></a><span class="k">USE </span><span class="n">GeneratorDynamicsManager</span>
<a name="ln-1695"></a><span class="k">USE </span><span class="n">GeneratorFuelSupply</span>
<a name="ln-1696"></a>
<a name="ln-1697"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-1698"></a>
<a name="ln-1699"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-1700"></a>
<a name="ln-1701"></a>  <span class="c">!MODULE PARAMETER DEFINITIONS</span>
<a name="ln-1702"></a>
<a name="ln-1703"></a>
<a name="ln-1704"></a>  <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1705"></a><span class="kt">LOGICAL</span>     <span class="kd">::</span> <span class="n">GetMicroCHPInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="c">! When TRUE, calls subroutine to read input file.</span>
<a name="ln-1706"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckEquipName</span>
<a name="ln-1707"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySizeFlag</span>
<a name="ln-1708"></a>
<a name="ln-1709"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE Combustion ElectricGenerator</span>
<a name="ln-1710"></a><span class="k">PUBLIC     </span><span class="n">SimMicroCHPGenerator</span>  <span class="c">! call handler, gets input first time</span>
<a name="ln-1711"></a><span class="k">PUBLIC     </span><span class="n">GetMicroCHPGeneratorResults</span>
<a name="ln-1712"></a>
<a name="ln-1713"></a><span class="k">PRIVATE    </span><span class="n">GetMicroCHPGeneratorInput</span> <span class="c">! gathers user data from input processor</span>
<a name="ln-1714"></a>
<a name="ln-1715"></a><span class="k">PRIVATE    </span><span class="n">InitMicroCHPNoNormalizeGenerators</span>
<a name="ln-1716"></a>
<a name="ln-1717"></a><span class="k">PRIVATE    </span><span class="n">CalcMicroCHPNoNormalizeGeneratorModel</span> <span class="c">! main calculations for Combustion poer module</span>
<a name="ln-1718"></a><span class="k">PUBLIC     </span><span class="n">FigureMicroCHPZoneGains</span>
<a name="ln-1719"></a><span class="k">PRIVATE    </span><span class="n">CalcUpdateHeatRecovery</span> <span class="c">!</span>
<a name="ln-1720"></a><span class="k">PUBLIC     </span><span class="n">SimMicroCHPPlantHeatRecovery</span>
<a name="ln-1721"></a><span class="k">PRIVATE    </span><span class="n">UpdateMicroCHPGeneratorRecords</span> <span class="c">! Sets variables used in reporting</span>
<a name="ln-1722"></a>
<a name="ln-1723"></a>
<a name="ln-1724"></a><span class="k">CONTAINS</span>
<a name="ln-1725"></a>          <span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-1726"></a>
<a name="ln-1727"></a><span class="c">! Beginning of Combustion Generator Module Driver Subroutines</span>
<a name="ln-1728"></a><span class="c">!*************************************************************************</span>
<a name="ln-1729"></a>
<a name="ln-1730"></a><span class="k">SUBROUTINE </span><span class="n">SimMicroCHPGenerator</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span><span class="n">GeneratorName</span><span class="p">,</span><span class="n">GeneratorIndex</span><span class="p">,</span><span class="n">RunFlagElectCenter</span><span class="p">,</span> <span class="n">RunFlagPlant</span><span class="p">,&amp;</span>
<a name="ln-1731"></a>                                <span class="n">MyElectricLoad</span><span class="p">,</span><span class="n">MyThermalLoad</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-1732"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1733"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-1734"></a>          <span class="c">!       DATE WRITTEN   July 2006</span>
<a name="ln-1735"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1736"></a>
<a name="ln-1737"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE: This is the main driver for the model for</span>
<a name="ln-1738"></a>          <span class="c">! internal combustion engine and</span>
<a name="ln-1739"></a>          <span class="c">! Stirling cycle engine model from IEA/ECBCS Annex 42 r.  It</span>
<a name="ln-1740"></a>          <span class="c">! gets the input for the models, initializes simulation variables, call</span>
<a name="ln-1741"></a>          <span class="c">! the appropriate model and sets up reporting variables.</span>
<a name="ln-1742"></a>
<a name="ln-1743"></a>          <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-1744"></a>
<a name="ln-1745"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-1746"></a>
<a name="ln-1747"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1748"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-1749"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-1750"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantSizeNotComplete</span>
<a name="ln-1751"></a>
<a name="ln-1752"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-1753"></a>
<a name="ln-1754"></a>
<a name="ln-1755"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1756"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorType</span>     <span class="c">! type of Generator</span>
<a name="ln-1757"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorName</span>     <span class="c">! user specified name of Generator</span>
<a name="ln-1758"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorIndex</span>
<a name="ln-1759"></a>  <span class="kt">LOGICAL</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">RunFlagElectCenter</span>  <span class="c">! simulate Generator when TRUE</span>
<a name="ln-1760"></a>  <span class="kt">LOGICAL</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">RunFlagPlant</span>  <span class="c">! simulate generator when true.</span>
<a name="ln-1761"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MyElectricLoad</span>      <span class="c">! demand on electric generator</span>
<a name="ln-1762"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">MyThermalLoad</span>           <span class="c">! thermal demand on cogenerator</span>
<a name="ln-1763"></a>  <span class="kt">LOGICAL</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-1764"></a>
<a name="ln-1765"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1766"></a>          <span class="c">! na</span>
<a name="ln-1767"></a>
<a name="ln-1768"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1769"></a>          <span class="c">! na</span>
<a name="ln-1770"></a>
<a name="ln-1771"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1772"></a>          <span class="c">! na</span>
<a name="ln-1773"></a>
<a name="ln-1774"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1775"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">GenNum</span>           <span class="c">! Generator number counter</span>
<a name="ln-1776"></a>
<a name="ln-1777"></a>        <span class="c">!Get Generator data from input file</span>
<a name="ln-1778"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetMicroCHPInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1779"></a><span class="k">    CALL </span><span class="n">GetMicroCHPGeneratorInput</span>
<a name="ln-1780"></a>    <span class="n">GetMicroCHPInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1781"></a>  <span class="k">END IF</span>
<a name="ln-1782"></a>
<a name="ln-1783"></a><span class="c">!  Call InitMicroCHPNoNormalizeGenerators</span>
<a name="ln-1784"></a>
<a name="ln-1785"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GeneratorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1786"></a><span class="k">    </span><span class="n">GenNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">,</span><span class="n">MicroCHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumMicroCHPs</span><span class="p">)</span>
<a name="ln-1787"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GenNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimMicroCHPGenerator: Specified Generator not one of Valid Micro CHP Generators &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1788"></a>                                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">))</span>
<a name="ln-1789"></a>    <span class="n">GeneratorIndex</span><span class="o">=</span><span class="n">GenNum</span>
<a name="ln-1790"></a>  <span class="k">ELSE</span>
<a name="ln-1791"></a><span class="k">    </span><span class="n">GenNum</span><span class="o">=</span><span class="n">GeneratorIndex</span>
<a name="ln-1792"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GenNum</span> <span class="o">&gt;</span> <span class="n">NumMicroCHPs</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">GenNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1793"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimMicroCHPGenerator: Invalid GeneratorIndex passed=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">GenNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1794"></a>                          <span class="s1">&#39;, Number of Micro CHP Generators=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumMicroCHPs</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1795"></a>                          <span class="s1">&#39;, Generator name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">))</span>
<a name="ln-1796"></a>    <span class="n">ENDIF</span>
<a name="ln-1797"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">GenNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1798"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GeneratorName</span> <span class="o">/=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1799"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimMicroCHPNoNormalizeGenerator: Invalid GeneratorIndex passed=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">GenNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1800"></a>                            <span class="s1">&#39;, Generator name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Generator Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1801"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1802"></a>      <span class="n">ENDIF</span>
<a name="ln-1803"></a>      <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1804"></a>    <span class="n">ENDIF</span>
<a name="ln-1805"></a>  <span class="n">ENDIF</span>
<a name="ln-1806"></a>
<a name="ln-1807"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ModelTypeAnnex42</span><span class="p">)</span> <span class="k">Then</span> <span class="c">! call the non normalize calc routines (set for future extension to normalize ones)</span>
<a name="ln-1808"></a>
<a name="ln-1809"></a>    <span class="k">CALL </span><span class="n">InitMicroCHPNoNormalizeGenerators</span><span class="p">(</span><span class="n">GenNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-1810"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizeNotComplete</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-1811"></a><span class="k">    CALL </span><span class="n">CalcMicroCHPNoNormalizeGeneratorModel</span><span class="p">(</span><span class="n">GenNum</span><span class="p">,</span><span class="n">RunFlagElectCenter</span><span class="p">,</span> <span class="n">RunFlagPlant</span><span class="p">,</span><span class="n">MyElectricLoad</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1812"></a>                                                  <span class="n">MyThermalLoad</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-1813"></a>
<a name="ln-1814"></a>    <span class="k">CALL </span><span class="n">CalcUpdateHeatRecovery</span><span class="p">(</span><span class="n">GenNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-1815"></a>
<a name="ln-1816"></a>    <span class="k">CALL </span><span class="n">UpdateMicroCHPGeneratorRecords</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)</span>
<a name="ln-1817"></a>
<a name="ln-1818"></a>  <span class="n">ENDIF</span>
<a name="ln-1819"></a>
<a name="ln-1820"></a><span class="k">RETURN</span>
<a name="ln-1821"></a><span class="k">END SUBROUTINE </span><span class="n">SimMicroCHPGenerator</span>
<a name="ln-1822"></a>
<a name="ln-1823"></a><span class="c">! End MicroCHPNoNormalize Generator Module Driver Subroutines</span>
<a name="ln-1824"></a><span class="c">!******************************************************************************</span>
<a name="ln-1825"></a>
<a name="ln-1826"></a>
<a name="ln-1827"></a><span class="c">! Beginning of Combustion Generator Module Get Input subroutines</span>
<a name="ln-1828"></a><span class="c">!******************************************************************************</span>
<a name="ln-1829"></a>
<a name="ln-1830"></a>
<a name="ln-1831"></a><span class="k">SUBROUTINE </span><span class="n">GetMicroCHPGeneratorInput</span>
<a name="ln-1832"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1833"></a>            <span class="c">!       AUTHOR:          Brent Griffith</span>
<a name="ln-1834"></a>            <span class="c">!       DATE WRITTEN:    July 2005</span>
<a name="ln-1835"></a>
<a name="ln-1836"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1837"></a>            <span class="c">! This routine will get the input</span>
<a name="ln-1838"></a>            <span class="c">! required by the Micro CHP Generator models.</span>
<a name="ln-1839"></a>
<a name="ln-1840"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1841"></a>            <span class="c">! EnergyPlus input processor</span>
<a name="ln-1842"></a>
<a name="ln-1843"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-1844"></a>
<a name="ln-1845"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-1846"></a>  <span class="k">USE </span><span class="n">DataGenerators</span>
<a name="ln-1847"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-1848"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>  <span class="c">! Data for field names, blank numerics</span>
<a name="ln-1849"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>   <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetCurveCheck</span><span class="p">,</span> <span class="n">CurveValue</span>
<a name="ln-1850"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-1851"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-1852"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">Zone</span><span class="p">,</span> <span class="n">IntGainTypeOf_GeneratorMicroCHP</span>
<a name="ln-1853"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span>
<a name="ln-1854"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-1855"></a>  <span class="k">USE </span><span class="n">GeneratorFuelSupply</span>
<a name="ln-1856"></a>  <span class="k">USE </span><span class="n">GeneratorDynamicsManager</span>
<a name="ln-1857"></a>
<a name="ln-1858"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">!</span>
<a name="ln-1859"></a>
<a name="ln-1860"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">GeneratorNum</span> <span class="c">!Generator counter</span>
<a name="ln-1861"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumAlphas</span>    <span class="c">! Number of elements in the alpha array</span>
<a name="ln-1862"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumNums</span>      <span class="c">! Number of elements in the numeric array</span>
<a name="ln-1863"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">IOStat</span>       <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-1864"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">AlphArray</span> <span class="c">!character string data</span>
<a name="ln-1865"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>                        <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NumArray</span>  <span class="c">!numeric data TODO deal with allocatable for extensible</span>
<a name="ln-1866"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! error flag</span>
<a name="ln-1867"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsNotOK</span>              <span class="c">! Flag to verify name</span>
<a name="ln-1868"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsBlank</span>              <span class="c">! Flag for blank name</span>
<a name="ln-1869"></a><span class="c">!  INTEGER       :: thisMicroCHP  !temporary index</span>
<a name="ln-1870"></a><span class="c">!  INTEGER       :: otherMicroCHP !loop counter and temporary indexer</span>
<a name="ln-1871"></a><span class="c">!  INTEGER       :: I   ! loop counter</span>
<a name="ln-1872"></a>  <span class="kt">Logical</span><span class="p">,</span> <span class="k">SAve</span> <span class="kd">::</span> <span class="n">myonetimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1873"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">CHPParamNum</span> <span class="c">! loop count and temporary index</span>
<a name="ln-1874"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObjMSGName</span> <span class="c">! string for error messages</span>
<a name="ln-1875"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">thisParamID</span>
<a name="ln-1876"></a>
<a name="ln-1877"></a>  <span class="c">! execution</span>
<a name="ln-1878"></a><span class="k">If</span> <span class="p">(</span><span class="n">myonetimeflag</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1879"></a>
<a name="ln-1880"></a> <span class="c">! call to Fuel supply module to set up data there.</span>
<a name="ln-1881"></a>  <span class="k">CALL </span><span class="n">GetGeneratorFuelSupplyInput</span>
<a name="ln-1882"></a>
<a name="ln-1883"></a> <span class="c">! First get the Micro CHP Parameters so they can be nested in structure later</span>
<a name="ln-1884"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Generator:MicroCHP:NonNormalizedParameters&#39;</span>
<a name="ln-1885"></a>  <span class="n">NumMicroCHPParams</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-1886"></a>
<a name="ln-1887"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumMicroCHPParams</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1888"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; equipment specified in input file&#39;</span><span class="p">)</span>
<a name="ln-1889"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1890"></a>  <span class="n">ENDIF</span>
<a name="ln-1891"></a>
<a name="ln-1892"></a>  <span class="k">Allocate</span><span class="p">(</span><span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">NumMicroCHPParams</span><span class="p">))</span>
<a name="ln-1893"></a>  <span class="k">Allocate</span><span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">NumMicroCHPParams</span><span class="p">))</span>
<a name="ln-1894"></a>  <span class="n">CheckEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1895"></a>
<a name="ln-1896"></a>
<a name="ln-1897"></a>  <span class="k">DO </span><span class="n">CHPParamNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumMicroCHPParams</span>
<a name="ln-1898"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">CHPParamNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1899"></a>                    <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1900"></a>                    <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1901"></a><span class="c">!  Can&#39;t validate this name.</span>
<a name="ln-1902"></a><span class="c">!    IsNotOK=.false.</span>
<a name="ln-1903"></a><span class="c">!    IsBlank=.false.</span>
<a name="ln-1904"></a>
<a name="ln-1905"></a><span class="c">!    CALL VerifyName(AlphArray(1),MicroCHP%Name,CHPParamNum-1,IsNotOK,IsBlank,TRIM(cCurrentModuleObject))</span>
<a name="ln-1906"></a><span class="c">!    IF (IsNotOK) THEN</span>
<a name="ln-1907"></a><span class="c">!      ErrorsFound=.true.</span>
<a name="ln-1908"></a><span class="c">!      IF (IsBlank) AlphArray(1)=&#39;xxxxx&#39;</span>
<a name="ln-1909"></a><span class="c">!    ENDIF</span>
<a name="ln-1910"></a>
<a name="ln-1911"></a>    <span class="n">ObjMSGName</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Named &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1912"></a>
<a name="ln-1913"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">Name</span>         <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c">!A1 name</span>
<a name="ln-1914"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">MaxElecPower</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>   <span class="c">!N1 Maximum Electric Power [W]</span>
<a name="ln-1915"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">MinElecPower</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>   <span class="c">!N2 Minimum Electric Power [W]</span>
<a name="ln-1916"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">MinWaterMdot</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="c">!N3 Minimum Cooling Water Flow Rate [kg/s]</span>
<a name="ln-1917"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">MaxWaterTemp</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>   <span class="c">!N3 Maximum Cooling Water Inlet Temp [C]</span>
<a name="ln-1918"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">ElecEffCurveID</span>  <span class="o">=</span> <span class="n">GetCurveCheck</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">ErrorsFound</span><span class="p">,</span><span class="n">ObjMSGName</span> <span class="p">)</span> <span class="c">!Electrical Eff. ID</span>
<a name="ln-1919"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">ThermalEffCurveID</span><span class="o">=</span> <span class="n">GetCurveCheck</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">ErrorsFound</span><span class="p">,</span><span class="n">ObjMSGName</span><span class="p">)</span> <span class="c">!Thermal Efficiency</span>
<a name="ln-1920"></a>
<a name="ln-1921"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;InternalControl&#39;</span><span class="p">))</span>  <span class="k">THEN</span>
<a name="ln-1922"></a><span class="k">      </span><span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">InternalFlowControl</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">!  A4, \field Cooling Water Flow Rate Mode</span>
<a name="ln-1923"></a>      <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">PlantFlowControl</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1924"></a>    <span class="n">ENDIF</span>
<a name="ln-1925"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;InternalControl&#39;</span><span class="p">)))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="n">SameSTring</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;PlantControl&#39;</span><span class="p">)))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1926"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1927"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1928"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1929"></a>    <span class="n">ENDIF</span>
<a name="ln-1930"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">InternalFlowControl</span><span class="p">)</span> <span class="k">Then</span> <span class="c">! get the curve</span>
<a name="ln-1931"></a>      <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">WaterFlowCurveID</span> <span class="o">=</span> <span class="n">GetCurveCheck</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="n">ObjMSGName</span> <span class="p">)</span>
<a name="ln-1932"></a>                                                           <span class="c">!  Curve for Cooling Water Flow Rate</span>
<a name="ln-1933"></a>    <span class="n">ENDIF</span>
<a name="ln-1934"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">AirFlowCurveID</span>    <span class="o">=</span> <span class="n">GetCurveCheck</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">Errorsfound</span><span class="p">,</span> <span class="n">ObjMSGName</span><span class="p">)</span>
<a name="ln-1935"></a>                                                                          <span class="c">!  Name of Curve for Air Flow Rate</span>
<a name="ln-1936"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">DeltaPelMax</span>       <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c">! N5 Maximum rate of change in net electrical power [W/s]</span>
<a name="ln-1937"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">DeltaFuelMdotMax</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="c">!N6 Maximum Rate of change in fuel flow rate [kg/s2]</span>
<a name="ln-1938"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">UAhx</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="c">! N7 Heat Exchanger UA_hx</span>
<a name="ln-1939"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">UAskin</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="c">!N8 Skin Loss UA_loss</span>
<a name="ln-1940"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">RadiativeFraction</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="c">!N9 radiative fraction for skin losses</span>
<a name="ln-1941"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">MCeng</span>             <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c">! N10 Aggregated Thermal Mass of Generator MC_eng</span>
<a name="ln-1942"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">MCeng</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1943"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="mi">5</span><span class="p">)))</span>
<a name="ln-1944"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1945"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Thermal mass must be greater than zero&#39;</span><span class="p">)</span>
<a name="ln-1946"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1947"></a>    <span class="n">ENDIF</span>
<a name="ln-1948"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">MCcw</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="c">! Aggregated Thermal Mass of Heat Recovery MC_cw</span>
<a name="ln-1949"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">MCcw</span>  <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1950"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="mi">5</span><span class="p">)))</span>
<a name="ln-1951"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1952"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Thermal mass must be greater than zero&#39;</span><span class="p">)</span>
<a name="ln-1953"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1954"></a>    <span class="n">ENDIF</span>
<a name="ln-1955"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">Pstandby</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>  <span class="c">! N12 Standby Power [W]</span>
<a name="ln-1956"></a>
<a name="ln-1957"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="s1">&#39;TimeDelay&#39;</span><span class="p">))</span>  <span class="k">THEN</span>
<a name="ln-1958"></a><span class="k">      </span><span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">WarmUpByTimeDelay</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">!</span>
<a name="ln-1959"></a>      <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">WarmUpByEngineTemp</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1960"></a>    <span class="n">ENDIF</span>
<a name="ln-1961"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="s1">&#39;NominalEngineTemperature&#39;</span><span class="p">)))</span>  <span class="p">&amp;</span>
<a name="ln-1962"></a>           <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="n">SameSTring</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="s1">&#39;TimeDelay&#39;</span><span class="p">)))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1963"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-1964"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1965"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1966"></a>    <span class="n">ENDIF</span>
<a name="ln-1967"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">kf</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="c">! N13 Warmup Fuel Flow Rate Coefficient k_f</span>
<a name="ln-1968"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">TnomEngOp</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="c">! N14 Nominal Engine Operating Temperature [C]</span>
<a name="ln-1969"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">kp</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="c">! N15 Warmup Power Coefficient k_p</span>
<a name="ln-1970"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">Rfuelwarmup</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="c">! N16 Warm Up Fuel Flow Rate Limit Ratio</span>
<a name="ln-1971"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">WarmUpDelay</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="c">! N17 Warm Up Delay Time</span>
<a name="ln-1972"></a>
<a name="ln-1973"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">PcoolDown</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>  <span class="c">! N18 Cool Down Power</span>
<a name="ln-1974"></a>
<a name="ln-1975"></a>    <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">CoolDownDelay</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="c">! N19 Cool Down Delay Time in seconds</span>
<a name="ln-1976"></a>
<a name="ln-1977"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="s1">&#39;MandatoryCoolDown&#39;</span><span class="p">))</span>  <span class="k">THEN</span>
<a name="ln-1978"></a><span class="k">      </span><span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">MandatoryFullCoolDown</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1979"></a>      <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">CHPParamNum</span><span class="p">)%</span><span class="n">WarmRestartOkay</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1980"></a>    <span class="n">ENDIF</span>
<a name="ln-1981"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="s1">&#39;MandatoryCoolDown&#39;</span><span class="p">)))</span>  <span class="p">&amp;</span>
<a name="ln-1982"></a>          <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="n">SameSTring</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="s1">&#39;OptionalCoolDown&#39;</span><span class="p">)))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1983"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-1984"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1985"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1986"></a>    <span class="n">ENDIF</span>
<a name="ln-1987"></a>  <span class="n">ENDDO</span>
<a name="ln-1988"></a>
<a name="ln-1989"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Generator:MicroCHP&#39;</span>
<a name="ln-1990"></a>  <span class="n">NumMicroCHPs</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-1991"></a>
<a name="ln-1992"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumMicroCHPs</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1993"></a>    <span class="c">! shouldn&#39;t ever come here?</span>
<a name="ln-1994"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; equipment specified in input file&#39;</span><span class="p">)</span>
<a name="ln-1995"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1996"></a>  <span class="n">ENDIF</span>
<a name="ln-1997"></a>
<a name="ln-1998"></a>         <span class="c">!ALLOCATE ARRAYS</span>
<a name="ln-1999"></a>
<a name="ln-2000"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">)))</span> <span class="k">Then</span>
<a name="ln-2001"></a><span class="k">    ALLOCATE</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span> <span class="n">NumMicroCHPs</span> <span class="p">))</span>  <span class="c">! inits handeled in derived type definitions</span>
<a name="ln-2002"></a>  <span class="n">ENDIF</span>
<a name="ln-2003"></a>
<a name="ln-2004"></a>  <span class="c">! load in Micro CHPs</span>
<a name="ln-2005"></a>  <span class="k">DO </span><span class="n">GeneratorNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumMicroCHPs</span>
<a name="ln-2006"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">GeneratorNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2007"></a>                    <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2008"></a>                    <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-2009"></a>
<a name="ln-2010"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2011"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2012"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">MicroCHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">GeneratorNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-2013"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2014"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2015"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-2016"></a>    <span class="n">ENDIF</span>
<a name="ln-2017"></a>  <span class="c">!GENERATOR:MICRO CHP,</span>
<a name="ln-2018"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c">!  A1 Generator name</span>
<a name="ln-2019"></a>    <span class="n">ObjMSGName</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Named &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">alphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-2020"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ParamObjName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c">!  A2 Micro CHP Parameter Object Name</span>
<a name="ln-2021"></a>    <span class="c">!find input structure</span>
<a name="ln-2022"></a>    <span class="n">thisParamID</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">MicroCHPParamInput</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">NumMicroCHPParams</span><span class="p">)</span>
<a name="ln-2023"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">thisParamID</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2024"></a><span class="k">      </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span> <span class="o">=</span>  <span class="n">MicroCHPParamInput</span><span class="p">(</span><span class="n">thisParamID</span><span class="p">)</span> <span class="c">! entire structure of input data assigned here!</span>
<a name="ln-2025"></a>    <span class="k">ELSE</span>
<a name="ln-2026"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-2027"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2028"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2029"></a>    <span class="n">ENDIF</span>
<a name="ln-2030"></a>
<a name="ln-2031"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2032"></a><span class="k">      </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ZoneName</span>     <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c">!  A3 Zone Name</span>
<a name="ln-2033"></a>      <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ZoneID</span>   <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">,</span> <span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-2034"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ZoneID</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2035"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2036"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2037"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2038"></a>      <span class="n">ENDIF</span>
<a name="ln-2039"></a>    <span class="k">ELSE</span>
<a name="ln-2040"></a><span class="k">      </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ZoneID</span>  <span class="o">=</span>  <span class="mi">0</span>
<a name="ln-2041"></a>    <span class="n">ENDIF</span>
<a name="ln-2042"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeName</span>  <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="c">!  A4 Cooling Water Inlet Node Name</span>
<a name="ln-2043"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantOutletNodeName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c">!  A5 Cooling Water Outlet Node Name</span>
<a name="ln-2044"></a>    <span class="c">!find node ids for water path</span>
<a name="ln-2045"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-2046"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2047"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span> <span class="p">)</span>
<a name="ln-2048"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantOutletNodeID</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-2049"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2050"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span> <span class="p">)</span>
<a name="ln-2051"></a>    <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-2052"></a>                            <span class="s1">&#39;Heat Recovery Nodes&#39;</span><span class="p">)</span>
<a name="ln-2053"></a>
<a name="ln-2054"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirInletNodeName</span>    <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="c">!  A6 Air Inlet Node Name</span>
<a name="ln-2055"></a>         <span class="c">! check the node connections</span>
<a name="ln-2056"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirInletNodeId</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2057"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2058"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2059"></a>
<a name="ln-2060"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirOutletNodeName</span>   <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="c">!  A7 Air Outlet Node Name</span>
<a name="ln-2061"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirOutletNodeId</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2062"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2063"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2064"></a>
<a name="ln-2065"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span>  <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">FuelSupply</span><span class="p">%</span><span class="n">name</span><span class="p">,</span><span class="n">NumGeneratorFuelSups</span><span class="p">)</span> <span class="c">! Fuel Supply ID</span>
<a name="ln-2066"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2067"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-2068"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2069"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2070"></a>    <span class="n">ENDIF</span>
<a name="ln-2071"></a>
<a name="ln-2072"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2073"></a><span class="k">      </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AvailabilitySchedID</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-2074"></a>    <span class="k">ELSE</span>
<a name="ln-2075"></a><span class="k">      </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AvailabilitySchedID</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<a name="ln-2076"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AvailabilitySchedID</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2077"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-2078"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2079"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2080"></a>      <span class="n">ENDIF</span>
<a name="ln-2081"></a>    <span class="n">ENDIF</span>
<a name="ln-2082"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TengLast</span>      <span class="o">=</span> <span class="mi">2</span><span class="mf">0.0D0</span>  <span class="c">! inits</span>
<a name="ln-2083"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TempCWOutLast</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">0.0D0</span>  <span class="c">! inits</span>
<a name="ln-2084"></a>
<a name="ln-2085"></a>  <span class="n">ENDDO</span>
<a name="ln-2086"></a>
<a name="ln-2087"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2088"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in processing input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">))</span>
<a name="ln-2089"></a>  <span class="n">ENDIF</span>
<a name="ln-2090"></a>
<a name="ln-2091"></a><span class="c">!setup report variables</span>
<a name="ln-2092"></a>  <span class="k">DO </span><span class="n">GeneratorNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumMicroCHPs</span>
<a name="ln-2093"></a>
<a name="ln-2094"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Off Mode Time [s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2095"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">OffModeTime</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2096"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Standby Mode Time [s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2097"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">StandyByModeTime</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2098"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Warm Up Mode Time [s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2099"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">WarmUpModeTime</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2100"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Normal Operating Mode Time [s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2101"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NormalModeTime</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2102"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Cool Down Mode Time [s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2103"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">CoolDownModeTime</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2104"></a>
<a name="ln-2105"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2106"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ACPowerGen</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2107"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2108"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ACEnergyGen</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2109"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ElectricityProduced&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2110"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Thermal Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-2111"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">report</span><span class="p">%</span><span class="n">QdotHR</span><span class="p">,</span> <span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2112"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Thermal Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-2113"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">report</span><span class="p">%</span><span class="n">TotalHeatEnergyRec</span><span class="p">,</span> <span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2114"></a>          <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span> <span class="p">,</span> <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2115"></a>
<a name="ln-2116"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Electric Efficiency []&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2117"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ElectEfficiency</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2118"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Thermal Efficiency []&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2119"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ThermalEfficiency</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2120"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Gross Input Heat Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-2121"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">report</span><span class="p">%</span><span class="n">QdotGross</span><span class="p">,</span> <span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2122"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Steady State Engine Heat Generation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-2123"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">report</span><span class="p">%</span><span class="n">Qgenss</span><span class="p">,</span> <span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2124"></a>
<a name="ln-2125"></a>
<a name="ln-2126"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Engine Heat Exchange Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-2127"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">report</span><span class="p">%</span><span class="n">QdotHX</span><span class="p">,</span> <span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2128"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Air Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2129"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">MdotAir</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2130"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel Molar Flow Rate [kmol/s]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2131"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotFuel</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2132"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel Mass Flow Rate [kg/s]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2133"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">MdotFuel</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2134"></a>
<a name="ln-2135"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Engine Temperature [C]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2136"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">Tengine</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2137"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Coolant Inlet Temperature [C]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2138"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HeatRecInletTemp</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2139"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Coolant Outlet Temperature [C]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2140"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HeatRecOutletTemp</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2141"></a>
<a name="ln-2142"></a>    <span class="c">! this next one needs to be reconciled with non-gas fuel constituents.</span>
<a name="ln-2143"></a>    <span class="c">!   need custom resourceTypeKey or something for user defined fuel compositions.</span>
<a name="ln-2144"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel HHV Basis Energy [J]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2145"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelEnergyHHV</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2146"></a>          <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Gas&#39;</span> <span class="p">,</span> <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2147"></a>
<a name="ln-2148"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel HHV Basis Rate [W]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2149"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelEnergyUseRateHHV</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2150"></a>
<a name="ln-2151"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel LHV Basis Energy [J]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2152"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelEnergyLHV</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2153"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel LHV Basis Rate [W]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2154"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelEnergyUseRateLHV</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2155"></a>
<a name="ln-2156"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel Compressor Electric Power [W]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2157"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelCompressPower</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2158"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel Compressor Electric Energy [J]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2159"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelCompressEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2160"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel Compressor Skin Heat Loss Rate [W]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2161"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelCompressSkinLoss</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2162"></a>
<a name="ln-2163"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Zone Sensible Heat Transfer Rate [W]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2164"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossPower</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2165"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Zone Sensible Heat Transfer Energy [J]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2166"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2167"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Zone Convection Heat Transfer Rate [W]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2168"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossConvect</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2169"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Zone Radiation Heat Transfer Rate [W]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2170"></a>          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossRadiat</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2171"></a>
<a name="ln-2172"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ZoneID</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2173"></a><span class="k">       CALL </span><span class="n">SetupZoneInternalGain</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ZoneID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2174"></a>                   <span class="s1">&#39;Generator:MicroCHP&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2175"></a>                   <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2176"></a>                   <span class="n">IntGainTypeOf_GeneratorMicroCHP</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2177"></a>                   <span class="n">ConvectionGainRate</span>    <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossConvect</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2178"></a>                   <span class="n">ThermalRadiationGainRate</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossRadiat</span><span class="p">)</span>
<a name="ln-2179"></a>     <span class="n">ENDIF</span>
<a name="ln-2180"></a>
<a name="ln-2181"></a>  <span class="k">END DO</span>
<a name="ln-2182"></a>
<a name="ln-2183"></a><span class="n">myonetimeflag</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2184"></a><span class="n">ENDIF</span>
<a name="ln-2185"></a><span class="k">RETURN</span>
<a name="ln-2186"></a>
<a name="ln-2187"></a><span class="k">END SUBROUTINE </span><span class="n">GetMicroCHPGeneratorInput</span>
<a name="ln-2188"></a>
<a name="ln-2189"></a>            <span class="c">! PARAMETERS</span>
<a name="ln-2190"></a>
<a name="ln-2191"></a><span class="k">SUBROUTINE </span><span class="n">InitMicroCHPNoNormalizeGenerators</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-2192"></a>
<a name="ln-2193"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2194"></a>          <span class="c">!       AUTHOR         BGriffith</span>
<a name="ln-2195"></a>          <span class="c">!       DATE WRITTEN   March 2007</span>
<a name="ln-2196"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2197"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2198"></a>
<a name="ln-2199"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2200"></a>          <span class="c">! inits</span>
<a name="ln-2201"></a>
<a name="ln-2202"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2203"></a>          <span class="c">!</span>
<a name="ln-2204"></a>
<a name="ln-2205"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2206"></a>          <span class="c">! na</span>
<a name="ln-2207"></a>
<a name="ln-2208"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2209"></a>  <span class="k">Use </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysTimeElapsed</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-2210"></a>  <span class="k">USE </span><span class="n">DataGlobals</span>    <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStep</span><span class="p">,</span> <span class="n">TimeStepZone</span><span class="p">,</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="n">BeginEnvrnFlag</span><span class="p">,</span> <span class="n">HourOfDay</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2211"></a>                             <span class="n">SysSizingCalc</span><span class="p">,</span> <span class="n">HoursInDay</span>
<a name="ln-2212"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">ScanPlantLoopsForObject</span><span class="p">,</span> <span class="n">TypeOf_Generator_MicroCHP</span><span class="p">,</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2213"></a>                             <span class="n">PlantSizeNotComplete</span><span class="p">,</span> <span class="n">SupplySide</span><span class="p">,</span> <span class="n">LoopFlowStatus_TakesWhatGets</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2214"></a>                             <span class="n">PlantSizesOkayToFinalize</span><span class="p">,</span> <span class="n">DemandSide</span>
<a name="ln-2215"></a>  <span class="k">USE </span><span class="n">DataSizing</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantSizData</span>
<a name="ln-2216"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span><span class="p">,</span> <span class="n">InitComponentNodes</span><span class="p">,</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-2217"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurveCheck</span><span class="p">,</span> <span class="n">CurveValue</span>
<a name="ln-2218"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span>
<a name="ln-2219"></a>  <span class="k">USE </span><span class="n">GeneratorDynamicsManager</span>
<a name="ln-2220"></a>
<a name="ln-2221"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2222"></a>
<a name="ln-2223"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2224"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">GeneratorNum</span>    <span class="c">! Generator number</span>
<a name="ln-2225"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-2226"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2227"></a>          <span class="c">! na</span>
<a name="ln-2228"></a>
<a name="ln-2229"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2230"></a>          <span class="c">! na</span>
<a name="ln-2231"></a>
<a name="ln-2232"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2233"></a>          <span class="c">! na</span>
<a name="ln-2234"></a>
<a name="ln-2235"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2236"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DynaCntrlNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2237"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TimeElapsed</span>         <span class="c">! Fraction of the current hour that has elapsed (h)</span>
<a name="ln-2238"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>           <span class="c">! Initialization flag</span>
<a name="ln-2239"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span> <span class="c">! Used for initializations each begin environment flag</span>
<a name="ln-2240"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyPlantScanFlag</span>
<a name="ln-2241"></a>
<a name="ln-2242"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-2243"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">mdot</span> <span class="c">! local temporary for mass flow rate</span>
<a name="ln-2244"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">rho</span>  <span class="c">! local temporary for fluid density</span>
<a name="ln-2245"></a>
<a name="ln-2246"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2247"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumMicroCHPs</span><span class="p">))</span>
<a name="ln-2248"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">NumMicroCHPs</span><span class="p">))</span>
<a name="ln-2249"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MySizeFlag</span><span class="p">(</span><span class="n">NumMicroCHPs</span><span class="p">))</span>
<a name="ln-2250"></a>    <span class="n">MyEnvrnFlag</span>     <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2251"></a>    <span class="n">MyPlantScanFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2252"></a>    <span class="n">MySizeFlag</span>      <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2253"></a>    <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2254"></a>  <span class="k">END IF</span>
<a name="ln-2255"></a>
<a name="ln-2256"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2257"></a><span class="k">    </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2258"></a>    <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2259"></a>                                 <span class="n">TypeOf_Generator_MicroCHP</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2260"></a>                                 <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2261"></a>                                 <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2262"></a>                                 <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2263"></a>                                 <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWCompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2264"></a>                                 <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-2265"></a>
<a name="ln-2266"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2267"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitMicroCHPNoNormalizeGenerators: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-2268"></a>    <span class="n">ENDIF</span>
<a name="ln-2269"></a>
<a name="ln-2270"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">InternalFlowControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2271"></a>      <span class="c">!IF this is on the supply side and not internal flow control then reset flow priority to lower</span>
<a name="ln-2272"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopSideNum</span> <span class="o">==</span> <span class="n">SupplySide</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2273"></a><span class="k">        </span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopSideNum</span><span class="p">)&amp;</span>
<a name="ln-2274"></a>          <span class="p">%</span><span class="n">Branch</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWBranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWCompNum</span><span class="p">)%</span><span class="n">FlowPriority</span> <span class="p">&amp;</span>
<a name="ln-2275"></a>            <span class="o">=</span> <span class="n">LoopFlowStatus_TakesWhatGets</span>
<a name="ln-2276"></a>
<a name="ln-2277"></a>      <span class="n">ENDIF</span>
<a name="ln-2278"></a>
<a name="ln-2279"></a>    <span class="n">ENDIF</span>
<a name="ln-2280"></a>
<a name="ln-2281"></a>    <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2282"></a>  <span class="n">ENDIF</span>
<a name="ln-2283"></a>
<a name="ln-2284"></a>
<a name="ln-2285"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SysSizingCalc</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2286"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2287"></a><span class="k">    </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2288"></a>                           <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2289"></a>                           <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2290"></a>                          <span class="s1">&#39;InitMicroCHPNoNormalizeGenerators&#39;</span><span class="p">)</span>
<a name="ln-2291"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">InternalFlowControl</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! got a curve</span>
<a name="ln-2292"></a>      <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantMassFlowRateMax</span> <span class="o">=</span> <span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">WaterFlowCurveID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2293"></a>                                                               <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MaxElecPower</span> <span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2294"></a>                                                               <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">)</span>
<a name="ln-2295"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopSideNum</span> <span class="o">==</span> <span class="n">SupplySide</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2296"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">)%</span><span class="n">MaxMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2297"></a><span class="k">        </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantMassFlowRateMax</span> <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">)%</span><span class="n">MaxMassFlowRate</span>
<a name="ln-2298"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">)%</span><span class="n">PlantSizNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2299"></a><span class="k">        </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantMassFlowRateMax</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-2300"></a>      <span class="k">ELSE</span>
<a name="ln-2301"></a><span class="k">        </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantMassFlowRateMax</span> <span class="o">=</span>  <span class="mf">2.d0</span> <span class="c">!</span>
<a name="ln-2302"></a>      <span class="n">ENDIF</span>
<a name="ln-2303"></a>
<a name="ln-2304"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopSideNum</span> <span class="o">==</span> <span class="n">DemandSide</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2305"></a><span class="k">      </span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantMassFlowRateMax</span> <span class="o">=</span>  <span class="mf">2.d0</span> <span class="c">! would like to use plant loop max but not ready yet</span>
<a name="ln-2306"></a>    <span class="n">ENDIF</span>
<a name="ln-2307"></a>
<a name="ln-2308"></a>    <span class="k">CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">,</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantMassFlowRateMax</span> <span class="o">/</span> <span class="n">rho</span> <span class="p">)</span>
<a name="ln-2309"></a>
<a name="ln-2310"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ElecEff</span>                                                   <span class="p">&amp;</span>
<a name="ln-2311"></a>                        <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ElecEffCurveID</span> <span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-2312"></a>                           <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MaxElecPower</span> <span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-2313"></a>                           <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantMassFlowRateMax</span> <span class="p">,&amp;</span>
<a name="ln-2314"></a>                           <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">)</span>
<a name="ln-2315"></a>
<a name="ln-2316"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ThermEff</span>                                                  <span class="p">&amp;</span>
<a name="ln-2317"></a>                        <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ThermalEffCurveID</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-2318"></a>                           <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MaxElecPower</span> <span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-2319"></a>                           <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantMassFlowRateMax</span> <span class="p">,&amp;</span>
<a name="ln-2320"></a>                           <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">)</span>
<a name="ln-2321"></a>
<a name="ln-2322"></a>    <span class="k">CALL </span><span class="n">SetupGeneratorControlStateManager</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span>
<a name="ln-2323"></a>    <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2324"></a>  <span class="n">ENDIF</span>
<a name="ln-2325"></a>
<a name="ln-2326"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">MySizeFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">))</span> <span class="k">RETURN</span>
<a name="ln-2327"></a>
<a name="ln-2328"></a><span class="k">  </span><span class="n">DynaCntrlNum</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DynamicsControlID</span>
<a name="ln-2329"></a>
<a name="ln-2330"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2331"></a>    <span class="c">!reset to starting condition for different environment runperiods, design days</span>
<a name="ln-2332"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TengLast</span>      <span class="o">=</span> <span class="mi">2</span><span class="mf">0.d0</span>
<a name="ln-2333"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TempCWOutLast</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">0.d0</span>
<a name="ln-2334"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TimeElapsed</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2335"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">opMode</span>        <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2336"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">OffModeTime</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2337"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">StandyByModeTime</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2338"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">WarmUpModeTime</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2339"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">NormalModeTime</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2340"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">CoolDownModeTime</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2341"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Pnet</span>          <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2342"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ElecEff</span>       <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2343"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Qgross</span>        <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2344"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ThermEff</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2345"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Qgenss</span>        <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2346"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">NdotFuel</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2347"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MdotFuel</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2348"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Teng</span>          <span class="o">=</span> <span class="mi">2</span><span class="mf">0.d0</span>
<a name="ln-2349"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Tcwin</span>         <span class="o">=</span> <span class="mi">2</span><span class="mf">0.d0</span>
<a name="ln-2350"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Tcwout</span>        <span class="o">=</span> <span class="mi">2</span><span class="mf">0.d0</span>
<a name="ln-2351"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MdotAir</span>       <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2352"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">QdotSkin</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2353"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">QdotConvZone</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2354"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">QdotRadZone</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2355"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">LastOpMode</span>    <span class="o">=</span> <span class="n">OpModeOFF</span>
<a name="ln-2356"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">CurrentOpMode</span> <span class="o">=</span> <span class="n">OpModeOFF</span>
<a name="ln-2357"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FractionalDayofLastShutDown</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2358"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FractionalDayofLastStartUp</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2359"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">HasBeenOn</span>      <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2360"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">DuringStartUp</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2361"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">DuringShutDown</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2362"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FuelMdotLastTimestep</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2363"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">PelLastTimeStep</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2364"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">NumCycles</span>       <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2365"></a>
<a name="ln-2366"></a>    <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">QskinLoss</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2367"></a>
<a name="ln-2368"></a>    <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantMassFlowRateMax</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2369"></a>                                 <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2370"></a>                                 <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantOutletNodeID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2371"></a>                                 <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2372"></a>                                 <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2373"></a>                                 <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2374"></a>                                 <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWCompNum</span> <span class="p">)</span>
<a name="ln-2375"></a>
<a name="ln-2376"></a>
<a name="ln-2377"></a>  <span class="n">ENDIF</span>
<a name="ln-2378"></a>
<a name="ln-2379"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2380"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2381"></a>  <span class="k">END IF</span>
<a name="ln-2382"></a>
<a name="ln-2383"></a><span class="k">  </span><span class="n">TimeElapsed</span> <span class="o">=</span> <span class="n">HourOfDay</span> <span class="o">+</span> <span class="n">TimeStep</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-2384"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TimeElapsed</span> <span class="o">/=</span> <span class="n">TimeElapsed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2385"></a>    <span class="c">! The simulation has advanced to the next system timestep.  Save conditions from the end of the previous system</span>
<a name="ln-2386"></a>    <span class="c">! timestep for use as the initial conditions of each iteration that does not advance the system timestep.</span>
<a name="ln-2387"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TengLast</span>      <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Teng</span>
<a name="ln-2388"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TempCWOutLast</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Tcwout</span>
<a name="ln-2389"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TimeElapsed</span>   <span class="o">=</span> <span class="n">TimeElapsed</span>
<a name="ln-2390"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">LastOpMode</span>    <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">CurrentOpMode</span>
<a name="ln-2391"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">FuelMdotLastTimestep</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MdotFuel</span>
<a name="ln-2392"></a>    <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">DynaCntrlNum</span><span class="p">)%</span><span class="n">PelLastTimeStep</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Pnet</span>
<a name="ln-2393"></a>  <span class="n">ENDIF</span>
<a name="ln-2394"></a>
<a name="ln-2395"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">InternalFlowControl</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2396"></a>
<a name="ln-2397"></a><span class="k">    </span><span class="n">mdot</span>     <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantMassFlowRateMax</span>
<a name="ln-2398"></a>    <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdot</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2399"></a>                      <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2400"></a>                      <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantOutletNodeID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2401"></a>                      <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-2402"></a>                      <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2403"></a>                      <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWBranchNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2404"></a>                      <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWCompNum</span><span class="p">)</span>
<a name="ln-2405"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantMassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-2406"></a>
<a name="ln-2407"></a>  <span class="n">ENDIF</span>
<a name="ln-2408"></a>
<a name="ln-2409"></a>  <span class="k">RETURN</span>
<a name="ln-2410"></a>
<a name="ln-2411"></a><span class="k">END SUBROUTINE </span><span class="n">InitMicroCHPNoNormalizeGenerators</span>
<a name="ln-2412"></a>
<a name="ln-2413"></a>
<a name="ln-2414"></a><span class="k">SUBROUTINE </span><span class="n">CalcMicroCHPNoNormalizeGeneratorModel</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span><span class="n">RunFlagElectCenter</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2415"></a>                                           <span class="n">RunFlagPlant</span><span class="p">,</span> <span class="n">MyElectricLoad</span><span class="p">,</span><span class="n">MyThermalLoad</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-2416"></a>
<a name="ln-2417"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2418"></a>          <span class="c">!       AUTHOR        B Griffith</span>
<a name="ln-2419"></a>          <span class="c">!       DATE WRITTEN   July 2006</span>
<a name="ln-2420"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2421"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2422"></a>
<a name="ln-2423"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2424"></a>          <span class="c">! Main calculation subroutine for the IEA Annex 42 model</span>
<a name="ln-2425"></a>
<a name="ln-2426"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2427"></a>          <span class="c">! curve fit, dynamic control limits,</span>
<a name="ln-2428"></a>
<a name="ln-2429"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2430"></a>          <span class="c">! IEA Annex 42 FC-COGEN-SIM &quot;A Generic Model Specification for Combustion-based Residential CHP Devices&quot;</span>
<a name="ln-2431"></a>          <span class="c">! Alex Ferguson, Nick Kelly, Version 3, June 26, 2006</span>
<a name="ln-2432"></a>
<a name="ln-2433"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2434"></a>  <span class="k">USE </span><span class="n">DataLoopNode</span> <span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">Node</span>
<a name="ln-2435"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MAT</span>
<a name="ln-2436"></a>  <span class="k">Use </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysTimeElapsed</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-2437"></a>  <span class="k">USE </span><span class="n">DataGlobals</span>    <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStep</span><span class="p">,</span> <span class="n">TimeStepZone</span><span class="p">,</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="n">HoursInDay</span>
<a name="ln-2438"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-2439"></a>  <span class="k">USE </span><span class="n">DataGlobalConstants</span>
<a name="ln-2440"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-2441"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-2442"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-2443"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-2444"></a>
<a name="ln-2445"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2446"></a>
<a name="ln-2447"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2448"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">GeneratorNum</span>    <span class="c">! Generator number</span>
<a name="ln-2449"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">RunFlagElectCenter</span> <span class="c">! TRUE when Generator operating</span>
<a name="ln-2450"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RunFlagPlant</span>       <span class="c">!</span>
<a name="ln-2451"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MyElectricload</span>          <span class="c">! Generator demand</span>
<a name="ln-2452"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MyThermalLoad</span>
<a name="ln-2453"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-2454"></a>
<a name="ln-2455"></a>
<a name="ln-2456"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2457"></a>          <span class="c">! na</span>
<a name="ln-2458"></a>
<a name="ln-2459"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2460"></a>          <span class="c">! na</span>
<a name="ln-2461"></a>
<a name="ln-2462"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2463"></a>          <span class="c">! na</span>
<a name="ln-2464"></a>
<a name="ln-2465"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2466"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AllowedLoad</span>               <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2467"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurrentOpMode</span>             <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2468"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PLRforSubtimestepStartUp</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2469"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PLRforSubtimestepShutDown</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2470"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">RunFlag</span>                   <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2471"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DynaCntrlNum</span>              <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2472"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Pnetss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2473"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Pstandby</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! power draw during standby, positive here means negative production</span>
<a name="ln-2474"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Pcooler</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! power draw during cool down, positive here means negative production</span>
<a name="ln-2475"></a><span class="c">!  REAL(r64)    :: Pnet   = 0.0d0</span>
<a name="ln-2476"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NdotFuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2477"></a>
<a name="ln-2478"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ConstrainedIncreasingNdot</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2479"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ConstrainedDecreasingNdot</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2480"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">I</span>       <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2481"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">dt</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2482"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ElecEff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2483"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MdotAir</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2484"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Qgenss</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2485"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Mdotcw</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2486"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TcwIn</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2487"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span>  <span class="n">Tcwout</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2488"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MdotFuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2489"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MdotFuelAllowed</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2490"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MdotFuelMax</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2491"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MdotFuelWarmup</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2492"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Pmax</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2493"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Qgross</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2494"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Teng</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2495"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ThermEff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2496"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Cp</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! local fluid specific heat</span>
<a name="ln-2497"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">thisAmbientTemp</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2498"></a>
<a name="ln-2499"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">EnergyBalOK</span> <span class="c">! check for balance to exit loop</span>
<a name="ln-2500"></a>
<a name="ln-2501"></a>  <span class="n">DynaCntrlNum</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DynamicsControlID</span>
<a name="ln-2502"></a>
<a name="ln-2503"></a>  <span class="k">CALL </span><span class="n">ManageGeneratorControlState</span><span class="p">(</span><span class="n">iGeneratorMicroCHP</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2504"></a>                                   <span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">RunFlagElectCenter</span><span class="p">,</span> <span class="n">RunFlagPlant</span><span class="p">,</span> <span class="n">MyElectricLoad</span><span class="p">,</span>  <span class="n">MyThermalLoad</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2505"></a>                                   <span class="n">AllowedLoad</span><span class="p">,</span> <span class="n">CurrentOpMode</span><span class="p">,&amp;</span>
<a name="ln-2506"></a>                                   <span class="n">PLRforSubtimestepStartUp</span><span class="p">,</span> <span class="n">PLRforSubtimestepShutDown</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-2507"></a>
<a name="ln-2508"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">RunFlagElectCenter</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">RunFlagPlant</span> <span class="p">)</span> <span class="n">RunFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2509"></a>
<a name="ln-2510"></a>  <span class="n">Teng</span>   <span class="o">=</span>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Teng</span>
<a name="ln-2511"></a>  <span class="n">Tcwout</span> <span class="o">=</span>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Tcwout</span>
<a name="ln-2512"></a>  <span class="n">dt</span> <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span>
<a name="ln-2513"></a>
<a name="ln-2514"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ZoneID</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2515"></a><span class="k">    </span><span class="n">thisAmbientTemp</span> <span class="o">=</span> <span class="n">MAT</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ZoneID</span><span class="p">)</span>
<a name="ln-2516"></a>  <span class="k">ELSE</span> <span class="c">! outdoor location, no zone</span>
<a name="ln-2517"></a>    <span class="n">thisAmbientTemp</span> <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-2518"></a>  <span class="n">ENDIF</span>
<a name="ln-2519"></a>
<a name="ln-2520"></a>  <span class="k">Select CASE</span> <span class="p">(</span><span class="n">CurrentOpMode</span><span class="p">)</span>
<a name="ln-2521"></a>
<a name="ln-2522"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">OpModeOFF</span><span class="p">)</span>  <span class="c">! same as standby in model spec but no Pnet standby electicity losses.</span>
<a name="ln-2523"></a>
<a name="ln-2524"></a>    <span class="n">Qgenss</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2525"></a>    <span class="n">Mdotcw</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="c">!kg/s</span>
<a name="ln-2526"></a>    <span class="n">TcwIn</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">Temp</span>  <span class="c">!C</span>
<a name="ln-2527"></a>    <span class="n">Pnetss</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2528"></a>    <span class="n">Pstandby</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2529"></a>    <span class="n">Pcooler</span>  <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">PcoolDown</span> <span class="o">*</span> <span class="n">PLRforSubtimestepShutDown</span>
<a name="ln-2530"></a>    <span class="n">ElecEff</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2531"></a>    <span class="n">ThermEff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2532"></a>    <span class="n">Qgross</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2533"></a>    <span class="n">NdotFuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2534"></a>    <span class="n">MdotFuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2535"></a>    <span class="n">MdotAir</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2536"></a>
<a name="ln-2537"></a>    <span class="n">Mdotcw</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2538"></a>    <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">Mdotcw</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2539"></a>                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2540"></a>                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantOutletNodeID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2541"></a>                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-2542"></a>                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2543"></a>                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWBranchNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2544"></a>                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWCompNum</span><span class="p">)</span>
<a name="ln-2545"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantMassFlowRate</span> <span class="o">=</span> <span class="n">Mdotcw</span>
<a name="ln-2546"></a>
<a name="ln-2547"></a>
<a name="ln-2548"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">OpModeStandby</span><span class="p">)</span>
<a name="ln-2549"></a>    <span class="n">Qgenss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2550"></a>    <span class="n">Mdotcw</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="c">!kg/s</span>
<a name="ln-2551"></a>    <span class="n">TcwIn</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">Temp</span>  <span class="c">!C</span>
<a name="ln-2552"></a>    <span class="n">Pnetss</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2553"></a>    <span class="n">Pstandby</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Pstandby</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">PLRforSubtimestepShutDown</span><span class="p">)</span>
<a name="ln-2554"></a>    <span class="n">Pcooler</span>  <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">PcoolDown</span> <span class="o">*</span> <span class="n">PLRforSubtimestepShutDown</span>
<a name="ln-2555"></a>    <span class="n">ElecEff</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2556"></a>    <span class="n">ThermEff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2557"></a>    <span class="n">Qgross</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2558"></a>    <span class="n">NdotFuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2559"></a>    <span class="n">MdotFuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2560"></a>    <span class="n">MdotAir</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2561"></a>
<a name="ln-2562"></a>    <span class="n">Mdotcw</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2563"></a>    <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">Mdotcw</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2564"></a>                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2565"></a>                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantOutletNodeID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2566"></a>                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-2567"></a>                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2568"></a>                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWBranchNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2569"></a>                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWCompNum</span><span class="p">)</span>
<a name="ln-2570"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantMassFlowRate</span> <span class="o">=</span> <span class="n">Mdotcw</span>
<a name="ln-2571"></a>
<a name="ln-2572"></a>
<a name="ln-2573"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">OpModeWarmUp</span><span class="p">)</span>
<a name="ln-2574"></a>
<a name="ln-2575"></a>   <span class="k">IF</span> <span class="p">(</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">WarmUpByTimeDelay</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-2576"></a>     <span class="c">! Internal combustion engine.  This is just like normal  operation but no net power yet.</span>
<a name="ln-2577"></a>      <span class="n">Pnetss</span>   <span class="o">=</span>  <span class="n">MyElectricLoad</span> <span class="c">! W</span>
<a name="ln-2578"></a>      <span class="n">Pstandby</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2579"></a>      <span class="n">Pcooler</span>  <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">PcoolDown</span> <span class="o">*</span> <span class="n">PLRforSubtimestepShutDown</span>
<a name="ln-2580"></a>      <span class="n">TcwIn</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">Temp</span>  <span class="c">!C</span>
<a name="ln-2581"></a>      <span class="n">Mdotcw</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="c">!kg/s</span>
<a name="ln-2582"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">InternalFlowControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2583"></a><span class="k">        </span><span class="n">Mdotcw</span> <span class="o">=</span> <span class="n">FuncDetermineCWMdotForInternalFlowControl</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">Pnetss</span><span class="p">,</span> <span class="n">TcwIn</span><span class="p">)</span>
<a name="ln-2584"></a>      <span class="n">ENDIF</span>
<a name="ln-2585"></a>      <span class="n">ElecEff</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ElecEffCurveID</span><span class="p">,</span> <span class="n">Pnetss</span><span class="p">,</span> <span class="n">Mdotcw</span> <span class="p">,</span> <span class="n">TcwIn</span> <span class="p">)</span>
<a name="ln-2586"></a>      <span class="n">ElecEff</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span> <span class="n">ElecEff</span><span class="p">)</span> <span class="c">!protect against bad curve result</span>
<a name="ln-2587"></a>
<a name="ln-2588"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="n">ElecEff</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! trap divide by bad thing</span>
<a name="ln-2589"></a>        <span class="n">Qgross</span>   <span class="o">=</span> <span class="n">Pnetss</span><span class="o">/</span><span class="n">ElecEff</span>     <span class="c">!W</span>
<a name="ln-2590"></a>      <span class="k">ELSE</span>
<a name="ln-2591"></a><span class="k">        </span><span class="n">Qgross</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2592"></a>      <span class="n">ENDIF</span>
<a name="ln-2593"></a>      <span class="n">ThermEff</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ThermalEffCurveID</span><span class="p">,</span> <span class="n">Pnetss</span><span class="p">,</span> <span class="n">Mdotcw</span> <span class="p">,</span> <span class="n">TcwIN</span> <span class="p">)</span>
<a name="ln-2594"></a>      <span class="n">ThermEff</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span> <span class="n">ThermEff</span><span class="p">)</span> <span class="c">!protect against bad curve result</span>
<a name="ln-2595"></a>
<a name="ln-2596"></a>      <span class="n">Qgenss</span>   <span class="o">=</span> <span class="n">ThermEff</span> <span class="o">*</span> <span class="n">Qgross</span> <span class="c">!W</span>
<a name="ln-2597"></a>
<a name="ln-2598"></a>      <span class="n">MdotFuel</span> <span class="o">=</span> <span class="n">Qgross</span> <span class="o">/</span> <span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">LHV</span>  <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span> <span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span><span class="p">)&amp;</span>
<a name="ln-2599"></a>       <span class="o">*</span>  <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">KmolPerSecToKgPerSec</span>
<a name="ln-2600"></a>       <span class="c">!  kMol/s = (J/s) /(KJ/mol * 1000 J/KJ * 1000 mol/kmol)</span>
<a name="ln-2601"></a>
<a name="ln-2602"></a>      <span class="k">CALL </span><span class="n">ManageGeneratorFuelFlow</span><span class="p">(</span><span class="n">iGeneratorMicroCHP</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="n">GeneratorNum</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">MdotFuel</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2603"></a>                                      <span class="n">MdotFuelAllowed</span><span class="p">,</span> <span class="n">ConstrainedIncreasingNdot</span><span class="p">,</span> <span class="n">ConstrainedDecreasingNdot</span><span class="p">)</span>
<a name="ln-2604"></a>
<a name="ln-2605"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ConstrainedIncreasingNdot</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ConstrainedDecreasingNdot</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! recalculate Pnetss with new NdotFuel with iteration</span>
<a name="ln-2606"></a>        <span class="n">MdotFuel</span> <span class="o">=</span> <span class="n">MdotFuelAllowed</span>
<a name="ln-2607"></a>        <span class="n">NdotFuel</span> <span class="o">=</span> <span class="n">MdotFuel</span> <span class="o">/</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">KmolPerSecToKgPerSec</span>
<a name="ln-2608"></a>        <span class="n">Qgross</span> <span class="o">=</span> <span class="n">NdotFuel</span> <span class="o">*</span> <span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">LHV</span>  <span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span><span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-2609"></a>
<a name="ln-2610"></a>        <span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span> <span class="c">! iterating here  could add use of seach method .</span>
<a name="ln-2611"></a>          <span class="n">Pnetss</span> <span class="o">=</span> <span class="n">Qgross</span> <span class="o">*</span> <span class="n">ElecEff</span>
<a name="ln-2612"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">InternalFlowControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2613"></a><span class="k">            </span><span class="n">Mdotcw</span> <span class="o">=</span> <span class="n">FuncDetermineCWMdotForInternalFlowControl</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">Pnetss</span><span class="p">,</span> <span class="n">TcwIn</span><span class="p">)</span>
<a name="ln-2614"></a>          <span class="n">ENDIF</span>
<a name="ln-2615"></a>          <span class="n">ElecEff</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ElecEffCurveID</span><span class="p">,</span> <span class="n">Pnetss</span><span class="p">,</span>  <span class="n">Mdotcw</span><span class="p">,</span> <span class="n">TcwIN</span><span class="p">)</span>
<a name="ln-2616"></a>          <span class="n">ElecEff</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span> <span class="n">ElecEff</span><span class="p">)</span> <span class="c">!protect against bad curve result</span>
<a name="ln-2617"></a>        <span class="n">ENDDO</span>
<a name="ln-2618"></a>
<a name="ln-2619"></a>        <span class="n">ThermEff</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ThermalEffCurveID</span><span class="p">,</span> <span class="n">Pnetss</span><span class="p">,</span> <span class="n">Mdotcw</span><span class="p">,</span> <span class="n">TcwIN</span> <span class="p">)</span>
<a name="ln-2620"></a>        <span class="n">ThermEff</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span> <span class="n">ThermEff</span><span class="p">)</span> <span class="c">!protect against bad curve result</span>
<a name="ln-2621"></a>        <span class="n">Qgenss</span>   <span class="o">=</span> <span class="n">ThermEff</span> <span class="o">*</span> <span class="n">Qgross</span> <span class="c">!W</span>
<a name="ln-2622"></a>
<a name="ln-2623"></a>      <span class="n">ENDIf</span>
<a name="ln-2624"></a>      <span class="n">Pnetss</span>   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! no actually power produced here.</span>
<a name="ln-2625"></a>      <span class="n">NdotFuel</span> <span class="o">=</span> <span class="n">MdotFuel</span> <span class="o">/</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">KmolPerSecToKgPerSec</span>
<a name="ln-2626"></a>      <span class="n">MdotAir</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">AirFlowCurveID</span><span class="p">,</span> <span class="n">MdotFuel</span><span class="p">)</span>
<a name="ln-2627"></a>      <span class="n">MdotAir</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span> <span class="n">MdotAir</span><span class="p">)</span> <span class="c">!protect against bad curve result</span>
<a name="ln-2628"></a>
<a name="ln-2629"></a>    <span class="n">ELSEIF</span> <span class="p">(</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">WarmUpByEngineTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2630"></a>    <span class="c">! Stirling engine mode warm up</span>
<a name="ln-2631"></a>    <span class="c">!   find MdotFuelMax</span>
<a name="ln-2632"></a>      <span class="n">Pmax</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MaxElecPower</span>
<a name="ln-2633"></a>      <span class="n">Pnetss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2634"></a>      <span class="n">Pstandby</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2635"></a>      <span class="n">Pcooler</span>  <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">PcoolDown</span> <span class="o">*</span> <span class="n">PLRforSubtimestepShutDown</span> <span class="c">! could be here with part load in cool down</span>
<a name="ln-2636"></a>      <span class="n">TcwIn</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">Temp</span>  <span class="c">!C</span>
<a name="ln-2637"></a>      <span class="n">Mdotcw</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="c">!kg/s</span>
<a name="ln-2638"></a>      <span class="n">ElecEff</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ElecEffCurveID</span><span class="p">,</span> <span class="n">Pmax</span><span class="p">,</span> <span class="n">Mdotcw</span><span class="p">,</span> <span class="n">TcwIN</span><span class="p">)</span>
<a name="ln-2639"></a>      <span class="n">ElecEff</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span> <span class="n">ElecEff</span><span class="p">)</span> <span class="c">!protect against bad curve result</span>
<a name="ln-2640"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="n">ElecEff</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! trap divide by bad thing</span>
<a name="ln-2641"></a>         <span class="n">Qgross</span>   <span class="o">=</span> <span class="n">Pmax</span><span class="o">/</span><span class="n">ElecEff</span>     <span class="c">!W</span>
<a name="ln-2642"></a>      <span class="k">ELSE</span>
<a name="ln-2643"></a><span class="k">         </span><span class="n">Qgross</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2644"></a>      <span class="n">ENDIF</span>
<a name="ln-2645"></a>      <span class="n">NdotFuel</span> <span class="o">=</span> <span class="n">Qgross</span> <span class="o">/</span> <span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">LHV</span>  <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span> <span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-2646"></a>       <span class="c">!  kMol/s = (J/s) /(KJ/mol * 1000 J/KJ * 1000 mol/kmol)</span>
<a name="ln-2647"></a>      <span class="n">MdotFuelMax</span> <span class="o">=</span> <span class="n">NdotFuel</span> <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">KmolPerSecToKgPerSec</span>
<a name="ln-2648"></a>
<a name="ln-2649"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">Teng</span> <span class="o">&gt;</span> <span class="n">thisAmbientTemp</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-2650"></a><span class="k">        </span><span class="n">MdotFuelWarmup</span> <span class="o">=</span> <span class="n">MdotFuelMax</span> <span class="o">+</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">kf</span> <span class="o">*</span>  <span class="n">MdotFuelMax</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-2651"></a>                            <span class="p">(</span>  <span class="p">(</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TnomEngOp</span> <span class="o">-</span>  <span class="n">thisAmbientTemp</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2652"></a>                            <span class="o">/</span> <span class="p">(</span><span class="n">Teng</span> <span class="o">-</span>  <span class="n">thisAmbientTemp</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-2653"></a>          <span class="c">! check that numerical answer didn&#39;t blow up beyond limit, and reset if it did</span>
<a name="ln-2654"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">MdotFuelWarmup</span> <span class="o">&gt;</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Rfuelwarmup</span> <span class="o">*</span> <span class="n">MdotFuelMax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2655"></a><span class="k">              </span><span class="n">MdotFuelWarmup</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Rfuelwarmup</span> <span class="o">*</span> <span class="n">MdotFuelMax</span>
<a name="ln-2656"></a>        <span class="n">ENDIF</span>
<a name="ln-2657"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Teng</span> <span class="o">&lt;</span> <span class="n">thisAmbientTemp</span><span class="p">)</span>  <span class="k">Then</span>
<a name="ln-2658"></a><span class="k">        </span><span class="n">MdotFuelWarmup</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Rfuelwarmup</span> <span class="o">*</span> <span class="n">MdotFuelMax</span>
<a name="ln-2659"></a>      <span class="k">ELSE</span> <span class="c">! equal would divide by zero</span>
<a name="ln-2660"></a>        <span class="n">MdotFuelWarmup</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Rfuelwarmup</span> <span class="o">*</span> <span class="n">MdotFuelMax</span>
<a name="ln-2661"></a>      <span class="n">ENDIF</span>
<a name="ln-2662"></a>
<a name="ln-2663"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TnomEngOp</span> <span class="o">&gt;</span> <span class="n">thisAmbientTemp</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-2664"></a><span class="k">        </span><span class="n">Pnetss</span> <span class="o">=</span> <span class="n">Pmax</span> <span class="o">*</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">kp</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-2665"></a>                          <span class="p">(</span> <span class="p">(</span><span class="n">Teng</span> <span class="o">-</span>  <span class="n">thisAmbientTemp</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2666"></a>                            <span class="o">/</span>  <span class="p">(</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TnomEngOp</span> <span class="o">-</span>  <span class="n">thisAmbientTemp</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-2667"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TnomEngOp</span> <span class="o">&lt;</span> <span class="n">thisAmbientTemp</span><span class="p">)</span>  <span class="k">Then</span>
<a name="ln-2668"></a><span class="k">        </span><span class="n">Pnetss</span> <span class="o">=</span> <span class="n">Pmax</span>
<a name="ln-2669"></a>      <span class="k">ELSE</span> <span class="c">! equal would divide by zero</span>
<a name="ln-2670"></a>        <span class="n">Pnetss</span> <span class="o">=</span> <span class="n">Pmax</span>
<a name="ln-2671"></a>      <span class="n">ENDIF</span>
<a name="ln-2672"></a>
<a name="ln-2673"></a>      <span class="c">!If ( MicroCHP(GeneratorNum)%A42Model%TnomEngOp &lt; thisAmbientTemp) then</span>
<a name="ln-2674"></a>      <span class="c">!    !this case where zone is super hot and more than engine op. temp.</span>
<a name="ln-2675"></a>      <span class="c">!    !  never going to get here because E+ zones don&#39;t like to be over 50C. (and no cogen devices should operate below 50C)</span>
<a name="ln-2676"></a>      <span class="c">!ENDIF</span>
<a name="ln-2677"></a>
<a name="ln-2678"></a>
<a name="ln-2679"></a>      <span class="n">MdotFuel</span> <span class="o">=</span> <span class="n">MdotFuelWarmup</span>
<a name="ln-2680"></a>      <span class="n">NdotFuel</span> <span class="o">=</span> <span class="n">MdotFuel</span> <span class="o">/</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">KmolPerSecToKgPerSec</span>
<a name="ln-2681"></a>      <span class="n">MdotAir</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">AirFlowCurveID</span><span class="p">,</span> <span class="n">MdotFuelWarmup</span><span class="p">)</span>
<a name="ln-2682"></a>      <span class="n">MdotAir</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span> <span class="n">MdotAir</span><span class="p">)</span> <span class="c">!protect against bad curve result</span>
<a name="ln-2683"></a>      <span class="n">Qgross</span>   <span class="o">=</span> <span class="n">NdotFuel</span> <span class="o">*</span> <span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">LHV</span>  <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span> <span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-2684"></a>      <span class="n">ThermEff</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ThermalEffCurveID</span><span class="p">,</span> <span class="n">Pmax</span><span class="p">,</span> <span class="n">Mdotcw</span><span class="p">,</span> <span class="n">TcwIN</span><span class="p">)</span>
<a name="ln-2685"></a>      <span class="n">Qgenss</span>   <span class="o">=</span> <span class="n">ThermEff</span> <span class="o">*</span> <span class="n">Qgross</span> <span class="c">!W</span>
<a name="ln-2686"></a>
<a name="ln-2687"></a>   <span class="n">ENDIF</span>
<a name="ln-2688"></a>   <span class="n">NdotFuel</span> <span class="o">=</span> <span class="n">MdotFuel</span> <span class="o">/</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">KmolPerSecToKgPerSec</span>
<a name="ln-2689"></a>
<a name="ln-2690"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">OpModeNormal</span><span class="p">)</span>
<a name="ln-2691"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">PLRforSubtimestepStartUp</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2692"></a><span class="k">      If</span> <span class="p">(</span><span class="n">RunFlagElectCenter</span><span class="p">)</span>  <span class="n">Pnetss</span>   <span class="o">=</span> <span class="n">MyElectricLoad</span>  <span class="c">! W</span>
<a name="ln-2693"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">RunFlagPlant</span><span class="p">)</span> <span class="n">Pnetss</span>   <span class="o">=</span> <span class="n">AllowedLoad</span>
<a name="ln-2694"></a>    <span class="k">else</span>
<a name="ln-2695"></a><span class="k">      </span><span class="n">Pnetss</span>   <span class="o">=</span> <span class="n">AllowedLoad</span>
<a name="ln-2696"></a>    <span class="n">endif</span>
<a name="ln-2697"></a>    <span class="n">Pstandby</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2698"></a>    <span class="n">Pcooler</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2699"></a>    <span class="n">TcwIn</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">Temp</span>  <span class="c">!C</span>
<a name="ln-2700"></a>    <span class="n">Mdotcw</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="c">!kg/s</span>
<a name="ln-2701"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">InternalFlowControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2702"></a><span class="k">      </span><span class="n">Mdotcw</span> <span class="o">=</span> <span class="n">FuncDetermineCWMdotForInternalFlowControl</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">Pnetss</span><span class="p">,</span> <span class="n">TcwIn</span><span class="p">)</span>
<a name="ln-2703"></a>    <span class="n">ENDIF</span>
<a name="ln-2704"></a>
<a name="ln-2705"></a>    <span class="n">ElecEff</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ElecEffCurveID</span><span class="p">,</span> <span class="n">Pnetss</span><span class="p">,</span> <span class="n">Mdotcw</span><span class="p">,</span> <span class="n">TcwIN</span> <span class="p">)</span>
<a name="ln-2706"></a>    <span class="n">ElecEff</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span> <span class="n">ElecEff</span><span class="p">)</span> <span class="c">!protect against bad curve result</span>
<a name="ln-2707"></a>
<a name="ln-2708"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">ElecEff</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! trap divide by bad thing</span>
<a name="ln-2709"></a>      <span class="n">Qgross</span>   <span class="o">=</span> <span class="n">Pnetss</span><span class="o">/</span><span class="n">ElecEff</span>     <span class="c">!W</span>
<a name="ln-2710"></a>    <span class="k">ELSE</span>
<a name="ln-2711"></a><span class="k">      </span><span class="n">Qgross</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2712"></a>    <span class="n">ENDIF</span>
<a name="ln-2713"></a>
<a name="ln-2714"></a>    <span class="n">ThermEff</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ThermalEffCurveID</span><span class="p">,</span> <span class="n">Pnetss</span><span class="p">,</span> <span class="n">Mdotcw</span><span class="p">,</span> <span class="n">TcwIN</span><span class="p">)</span>
<a name="ln-2715"></a>    <span class="n">ThermEff</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span> <span class="n">ThermEff</span><span class="p">)</span> <span class="c">!protect against bad curve result</span>
<a name="ln-2716"></a>    <span class="n">Qgenss</span>   <span class="o">=</span> <span class="n">ThermEff</span> <span class="o">*</span> <span class="n">Qgross</span> <span class="c">!W</span>
<a name="ln-2717"></a>    <span class="n">MdotFuel</span> <span class="o">=</span> <span class="n">Qgross</span> <span class="o">/</span> <span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">LHV</span>  <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span> <span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2718"></a>       <span class="o">*</span>  <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">KmolPerSecToKgPerSec</span>
<a name="ln-2719"></a>       <span class="c">!  kMol/s = (J/s) /(KJ/mol * 1000 J/KJ * 1000 mol/kmol)</span>
<a name="ln-2720"></a>    <span class="k">CALL </span><span class="n">ManageGeneratorFuelFlow</span><span class="p">(</span><span class="n">iGeneratorMicroCHP</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="n">GeneratorNum</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">MdotFuel</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2721"></a>                                      <span class="n">MdotFuelAllowed</span><span class="p">,</span> <span class="n">ConstrainedIncreasingNdot</span><span class="p">,</span> <span class="n">ConstrainedDecreasingNdot</span><span class="p">)</span>
<a name="ln-2722"></a>
<a name="ln-2723"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ConstrainedIncreasingNdot</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ConstrainedDecreasingNdot</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! recalculate Pnetss with new NdotFuel with iteration</span>
<a name="ln-2724"></a>      <span class="n">MdotFuel</span> <span class="o">=</span> <span class="n">MdotFuelAllowed</span>
<a name="ln-2725"></a>      <span class="n">NdotFuel</span> <span class="o">=</span> <span class="n">MdotFuel</span> <span class="o">/</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">KmolPerSecToKgPerSec</span>
<a name="ln-2726"></a>      <span class="n">Qgross</span> <span class="o">=</span> <span class="n">NdotFuel</span> <span class="o">*</span> <span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">LHV</span>  <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-2727"></a>
<a name="ln-2728"></a>      <span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span> <span class="c">! iterating here,  could add use of seach method error signal</span>
<a name="ln-2729"></a>        <span class="n">Pnetss</span> <span class="o">=</span> <span class="n">Qgross</span> <span class="o">*</span> <span class="n">ElecEff</span>
<a name="ln-2730"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">InternalFlowControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2731"></a><span class="k">          </span><span class="n">Mdotcw</span> <span class="o">=</span> <span class="n">FuncDetermineCWMdotForInternalFlowControl</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">Pnetss</span><span class="p">,</span> <span class="n">TcwIn</span><span class="p">)</span>
<a name="ln-2732"></a>        <span class="n">ENDIF</span>
<a name="ln-2733"></a>        <span class="n">ElecEff</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ElecEffCurveID</span><span class="p">,</span> <span class="n">Pnetss</span><span class="p">,</span> <span class="n">Mdotcw</span><span class="p">,</span> <span class="n">TcwIN</span> <span class="p">)</span>
<a name="ln-2734"></a>        <span class="n">ElecEff</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span> <span class="n">ElecEff</span><span class="p">)</span> <span class="c">!protect against bad curve result</span>
<a name="ln-2735"></a>      <span class="n">ENDDO</span>
<a name="ln-2736"></a>
<a name="ln-2737"></a>      <span class="n">ThermEff</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ThermalEffCurveID</span><span class="p">,</span> <span class="n">Pnetss</span><span class="p">,</span><span class="n">Mdotcw</span> <span class="p">,</span> <span class="n">TcwIN</span> <span class="p">)</span>
<a name="ln-2738"></a>      <span class="n">ThermEff</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span> <span class="n">ThermEff</span><span class="p">)</span> <span class="c">!protect against bad curve result</span>
<a name="ln-2739"></a>      <span class="n">Qgenss</span>   <span class="o">=</span> <span class="n">ThermEff</span> <span class="o">*</span> <span class="n">Qgross</span> <span class="c">!W</span>
<a name="ln-2740"></a>
<a name="ln-2741"></a>    <span class="n">ENDIF</span>
<a name="ln-2742"></a>
<a name="ln-2743"></a>    <span class="n">NdotFuel</span> <span class="o">=</span> <span class="n">MdotFuel</span> <span class="o">/</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">KmolPerSecToKgPerSec</span>
<a name="ln-2744"></a>    <span class="n">MdotAir</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">AirFlowCurveID</span><span class="p">,</span> <span class="n">MdotFuel</span><span class="p">)</span>
<a name="ln-2745"></a>    <span class="n">MdotAir</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span> <span class="n">MdotAir</span><span class="p">)</span> <span class="c">!protect against bad curve result</span>
<a name="ln-2746"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PLRforSubtimestepStartUp</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2747"></a><span class="k">      </span><span class="n">Pnetss</span> <span class="o">=</span> <span class="n">AllowedLoad</span>
<a name="ln-2748"></a>    <span class="n">ENDIF</span>
<a name="ln-2749"></a>
<a name="ln-2750"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">opModeCoolDown</span><span class="p">)</span>
<a name="ln-2751"></a>
<a name="ln-2752"></a>      <span class="n">Pnetss</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2753"></a>      <span class="n">Pstandby</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2754"></a>      <span class="n">Pcooler</span>  <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">PcoolDown</span>
<a name="ln-2755"></a>      <span class="n">TcwIn</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">Temp</span>  <span class="c">!C</span>
<a name="ln-2756"></a>      <span class="n">Mdotcw</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="c">!kg/s</span>
<a name="ln-2757"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">InternalFlowControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2758"></a><span class="k">        </span><span class="n">Mdotcw</span> <span class="o">=</span> <span class="n">FuncDetermineCWMdotForInternalFlowControl</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">Pnetss</span><span class="p">,</span> <span class="n">TcwIn</span> <span class="p">)</span>
<a name="ln-2759"></a>      <span class="n">ENDIF</span>
<a name="ln-2760"></a>      <span class="n">NdotFuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2761"></a>      <span class="n">MdotFuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2762"></a>      <span class="n">MdotAir</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2763"></a>      <span class="n">ElecEff</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2764"></a>      <span class="n">ThermEff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2765"></a>      <span class="n">Qgross</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2766"></a>      <span class="n">Qgenss</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2767"></a>  <span class="k">END SELECT</span>
<a name="ln-2768"></a>
<a name="ln-2769"></a><span class="k">  </span><span class="n">EnergyBalOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2770"></a>  <span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span> <span class="c">! sequential search with exit criteria</span>
<a name="ln-2771"></a>    <span class="c">! calculate new value for engine temperature</span>
<a name="ln-2772"></a>    <span class="c">! for Stirling in warmup, need to include dependency of Qgness on Teng</span>
<a name="ln-2773"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">WarmUpByEngineTemp</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="n">CurrentOpMode</span> <span class="o">==</span> <span class="n">OpModeWarmUp</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2774"></a>
<a name="ln-2775"></a><span class="k">      </span><span class="n">Pmax</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MaxElecPower</span>
<a name="ln-2776"></a>      <span class="n">TcwIn</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">Temp</span>  <span class="c">!C</span>
<a name="ln-2777"></a>      <span class="n">Mdotcw</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="c">!kg/s</span>
<a name="ln-2778"></a>      <span class="n">ElecEff</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ElecEffCurveID</span><span class="p">,</span> <span class="n">Pmax</span><span class="p">,</span> <span class="n">Mdotcw</span><span class="p">,</span> <span class="n">TcwIN</span><span class="p">)</span>
<a name="ln-2779"></a>      <span class="n">ElecEff</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span> <span class="n">ElecEff</span><span class="p">)</span> <span class="c">!protect against bad curve result</span>
<a name="ln-2780"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="n">ElecEff</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! trap divide by bad thing</span>
<a name="ln-2781"></a>         <span class="n">Qgross</span>   <span class="o">=</span> <span class="n">Pmax</span><span class="o">/</span><span class="n">ElecEff</span>     <span class="c">!W</span>
<a name="ln-2782"></a>      <span class="k">ELSE</span>
<a name="ln-2783"></a><span class="k">         </span><span class="n">Qgross</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2784"></a>      <span class="n">ENDIF</span>
<a name="ln-2785"></a>      <span class="n">NdotFuel</span> <span class="o">=</span> <span class="n">Qgross</span> <span class="o">/</span> <span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">LHV</span>  <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span> <span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-2786"></a>       <span class="c">!  kMol/s = (J/s) /(KJ/mol * 1000 J/KJ * 1000 mol/kmol)</span>
<a name="ln-2787"></a>      <span class="n">MdotFuelMax</span> <span class="o">=</span> <span class="n">NdotFuel</span> <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">KmolPerSecToKgPerSec</span>
<a name="ln-2788"></a>
<a name="ln-2789"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Teng</span> <span class="o">&gt;</span> <span class="n">thisAmbientTemp</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-2790"></a><span class="k">        </span><span class="n">MdotFuelWarmup</span> <span class="o">=</span> <span class="n">MdotFuelMax</span> <span class="o">+</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">kf</span> <span class="o">*</span>  <span class="n">MdotFuelMax</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-2791"></a>                           <span class="p">(</span>  <span class="p">(</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TnomEngOp</span> <span class="o">-</span>  <span class="n">thisAmbientTemp</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2792"></a>                            <span class="o">/</span> <span class="p">(</span><span class="n">Teng</span> <span class="o">-</span> <span class="n">thisAmbientTemp</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-2793"></a>
<a name="ln-2794"></a>         <span class="c">! check that numerical answer didn&#39;t blow up beyond limit, and reset if it did</span>
<a name="ln-2795"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">MdotFuelWarmup</span> <span class="o">&gt;</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Rfuelwarmup</span> <span class="o">*</span> <span class="n">MdotFuelMax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2796"></a><span class="k">             </span><span class="n">MdotFuelWarmup</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Rfuelwarmup</span> <span class="o">*</span> <span class="n">MdotFuelMax</span>
<a name="ln-2797"></a>        <span class="n">ENDIF</span>
<a name="ln-2798"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TnomEngOp</span> <span class="o">&gt;</span> <span class="n">thisAmbientTemp</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-2799"></a><span class="k">          </span><span class="n">Pnetss</span> <span class="o">=</span> <span class="n">Pmax</span> <span class="o">*</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">kp</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-2800"></a>                          <span class="p">(</span> <span class="p">(</span><span class="n">Teng</span> <span class="o">-</span>  <span class="n">thisAmbientTemp</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2801"></a>                           <span class="o">/</span>  <span class="p">(</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TnomEngOp</span> <span class="o">-</span>  <span class="n">thisAmbientTemp</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-2802"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TnomEngOp</span> <span class="o">&lt;</span> <span class="n">thisAmbientTemp</span><span class="p">)</span>  <span class="k">Then</span>
<a name="ln-2803"></a><span class="k">          </span><span class="n">Pnetss</span> <span class="o">=</span> <span class="n">Pmax</span>
<a name="ln-2804"></a>        <span class="k">ELSE</span> <span class="c">! equal would divide by zero</span>
<a name="ln-2805"></a>          <span class="n">Pnetss</span> <span class="o">=</span> <span class="n">Pmax</span>
<a name="ln-2806"></a>        <span class="n">ENDIF</span>
<a name="ln-2807"></a>
<a name="ln-2808"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Teng</span> <span class="o">&lt;</span> <span class="n">thisAmbientTemp</span><span class="p">)</span>  <span class="k">Then</span>
<a name="ln-2809"></a><span class="k">        </span><span class="n">MdotFuelWarmup</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Rfuelwarmup</span> <span class="o">*</span> <span class="n">MdotFuelMax</span>
<a name="ln-2810"></a>      <span class="k">ELSE</span> <span class="c">! equal would divide by zero</span>
<a name="ln-2811"></a>        <span class="n">MdotFuelWarmup</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Rfuelwarmup</span> <span class="o">*</span> <span class="n">MdotFuelMax</span>
<a name="ln-2812"></a>      <span class="n">ENDIF</span>
<a name="ln-2813"></a>      <span class="n">MdotFuel</span> <span class="o">=</span> <span class="n">MdotFuelWarmup</span>
<a name="ln-2814"></a>      <span class="n">NdotFuel</span> <span class="o">=</span> <span class="n">MdotFuel</span> <span class="o">/</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">KmolPerSecToKgPerSec</span>
<a name="ln-2815"></a>      <span class="n">MdotAir</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">AirFlowCurveID</span><span class="p">,</span> <span class="n">MdotFuelWarmup</span><span class="p">)</span>
<a name="ln-2816"></a>      <span class="n">MdotAir</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span> <span class="n">MdotAir</span><span class="p">)</span> <span class="c">!protect against bad curve result</span>
<a name="ln-2817"></a>      <span class="n">Qgross</span>   <span class="o">=</span> <span class="n">NdotFuel</span> <span class="o">*</span> <span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">LHV</span>  <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span> <span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-2818"></a>      <span class="n">ThermEff</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ThermalEffCurveID</span><span class="p">,</span> <span class="n">Pmax</span><span class="p">,</span> <span class="n">Mdotcw</span><span class="p">,</span> <span class="n">TcwIN</span><span class="p">)</span>
<a name="ln-2819"></a>      <span class="n">ThermEff</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span> <span class="n">ThermEff</span><span class="p">)</span> <span class="c">!protect against bad curve result</span>
<a name="ln-2820"></a>      <span class="n">Qgenss</span>   <span class="o">=</span> <span class="n">ThermEff</span> <span class="o">*</span> <span class="n">Qgross</span> <span class="c">!W</span>
<a name="ln-2821"></a>    <span class="n">ENDIF</span>
<a name="ln-2822"></a>
<a name="ln-2823"></a>    <span class="n">Teng</span> <span class="o">=</span> <span class="n">FuncDetermineEngineTemp</span><span class="p">(</span><span class="n">Tcwout</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MCeng</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">UAhx</span><span class="p">,&amp;</span>
<a name="ln-2824"></a>                              <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">UAskin</span><span class="p">,</span> <span class="n">thisAmbientTemp</span><span class="p">,</span> <span class="n">Qgenss</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2825"></a>                              <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TengLast</span><span class="p">,</span> <span class="n">dt</span> <span class="p">)</span>
<a name="ln-2826"></a>
<a name="ln-2827"></a>    <span class="n">Cp</span>     <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2828"></a>                              <span class="n">TcwIn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2829"></a>                              <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2830"></a>                              <span class="s1">&#39;CalcMicroCHPNoNormalizeGeneratorModel&#39;</span><span class="p">)</span>
<a name="ln-2831"></a>
<a name="ln-2832"></a>    <span class="n">Tcwout</span> <span class="o">=</span> <span class="n">FuncDetermineCoolantWaterExitTemp</span><span class="p">(</span><span class="n">TcwIn</span><span class="p">,</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MCcw</span><span class="p">,</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">UAhx</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2833"></a>                              <span class="n">Mdotcw</span> <span class="o">*</span> <span class="n">Cp</span> <span class="p">,</span> <span class="n">Teng</span><span class="p">,</span>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">TempCWOutLast</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<a name="ln-2834"></a>
<a name="ln-2835"></a>     <span class="c">! form balance and exit once met.</span>
<a name="ln-2836"></a>    <span class="n">EnergyBalOK</span> <span class="o">=</span> <span class="n">CheckMicroCHPThermalBalance</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MaxElecPower</span><span class="p">,</span> <span class="n">Tcwin</span><span class="p">,</span> <span class="n">Tcwout</span><span class="p">,</span> <span class="n">Teng</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2837"></a>                              <span class="n">thisAmbientTemp</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">UAhx</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2838"></a>                              <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">UAskin</span><span class="p">,</span> <span class="n">Qgenss</span><span class="p">,</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MCeng</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2839"></a>                              <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MCcw</span> <span class="p">,</span> <span class="n">Mdotcw</span> <span class="o">*</span> <span class="n">Cp</span>  <span class="p">)</span>
<a name="ln-2840"></a>
<a name="ln-2841"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">EnergyBalOK</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">I</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">))</span> <span class="k">Exit</span>
<a name="ln-2842"></a>
<a name="ln-2843"></a><span class="k">  </span><span class="n">ENDDO</span>
<a name="ln-2844"></a>
<a name="ln-2845"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantMassFlowRate</span>  <span class="o">=</span> <span class="n">Mdotcw</span>
<a name="ln-2846"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Pnet</span>      <span class="o">=</span> <span class="n">Pnetss</span> <span class="o">-</span> <span class="n">Pcooler</span> <span class="o">-</span> <span class="n">Pstandby</span>
<a name="ln-2847"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ElecEff</span>   <span class="o">=</span> <span class="n">ElecEff</span>
<a name="ln-2848"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Qgross</span>    <span class="o">=</span> <span class="n">Qgross</span>
<a name="ln-2849"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ThermEff</span>  <span class="o">=</span> <span class="n">ThermEff</span>
<a name="ln-2850"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Qgenss</span>    <span class="o">=</span> <span class="n">Qgenss</span>
<a name="ln-2851"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">NdotFuel</span>  <span class="o">=</span> <span class="n">NdotFuel</span>
<a name="ln-2852"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MdotFuel</span>  <span class="o">=</span> <span class="n">MdotFuel</span>
<a name="ln-2853"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Teng</span>      <span class="o">=</span> <span class="n">Teng</span>
<a name="ln-2854"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Tcwout</span>    <span class="o">=</span> <span class="n">Tcwout</span>
<a name="ln-2855"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Tcwin</span>     <span class="o">=</span> <span class="n">Tcwin</span>
<a name="ln-2856"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MdotAir</span>   <span class="o">=</span> <span class="n">MdotAir</span>
<a name="ln-2857"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">QdotSkin</span>  <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">UAskin</span><span class="o">*</span><span class="p">(</span><span class="n">Teng</span> <span class="o">-</span> <span class="n">thisAmbientTemp</span><span class="p">)</span>
<a name="ln-2858"></a>
<a name="ln-2859"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">OpMode</span> <span class="o">=</span> <span class="n">CurrentOpMode</span>
<a name="ln-2860"></a>
<a name="ln-2861"></a>  <span class="k">RETURN</span>
<a name="ln-2862"></a>
<a name="ln-2863"></a><span class="k">END SUBROUTINE </span><span class="n">CalcMicroCHPNoNormalizeGeneratorModel</span>
<a name="ln-2864"></a>
<a name="ln-2865"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">FuncDetermineEngineTemp</span><span class="p">(</span><span class="n">Tcwout</span><span class="p">,</span> <span class="n">MCeng</span><span class="p">,</span> <span class="n">UAHX</span><span class="p">,</span> <span class="n">UAskin</span><span class="p">,</span> <span class="n">Troom</span><span class="p">,</span> <span class="n">Qgenss</span><span class="p">,</span> <span class="n">TengLast</span><span class="p">,</span> <span class="nb">time</span><span class="p">)</span>
<a name="ln-2866"></a>
<a name="ln-2867"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2868"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-2869"></a>          <span class="c">!       DATE WRITTEN   Feb. 2007</span>
<a name="ln-2870"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2871"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2872"></a>
<a name="ln-2873"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2874"></a>          <span class="c">! Calculate engine temperaure,</span>
<a name="ln-2875"></a>
<a name="ln-2876"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2877"></a>          <span class="c">! model is dynamic in that previous condition affects current timestep</span>
<a name="ln-2878"></a>          <span class="c">!  solve ode for engine temp using analytical solution</span>
<a name="ln-2879"></a>
<a name="ln-2880"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2881"></a>          <span class="c">! na</span>
<a name="ln-2882"></a>
<a name="ln-2883"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2884"></a>          <span class="c">! na</span>
<a name="ln-2885"></a>
<a name="ln-2886"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2887"></a>
<a name="ln-2888"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2889"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tcwout</span> <span class="c">! hot water leaving temp</span>
<a name="ln-2890"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MCeng</span>  <span class="c">! Fictitious mass and heat capacity of engine</span>
<a name="ln-2891"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UAHX</span>   <span class="c">! Heat exchanger UA</span>
<a name="ln-2892"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UAskin</span> <span class="c">! Skin losses UA</span>
<a name="ln-2893"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Troom</span>  <span class="c">! surrounding zone temperature C</span>
<a name="ln-2894"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Qgenss</span> <span class="c">! steady state generator heat generation</span>
<a name="ln-2895"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TengLast</span> <span class="c">! engine temp at previous time step</span>
<a name="ln-2896"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">time</span> <span class="c">! elapsed time since previous evaluation</span>
<a name="ln-2897"></a>
<a name="ln-2898"></a>
<a name="ln-2899"></a>
<a name="ln-2900"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-2901"></a>          <span class="c">! na</span>
<a name="ln-2902"></a>
<a name="ln-2903"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2904"></a>          <span class="c">! na</span>
<a name="ln-2905"></a>
<a name="ln-2906"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2907"></a>          <span class="c">! na</span>
<a name="ln-2908"></a>
<a name="ln-2909"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2910"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span>
<a name="ln-2911"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">b</span>
<a name="ln-2912"></a>
<a name="ln-2913"></a>  <span class="n">a</span> <span class="o">=</span> <span class="p">(</span>  <span class="p">(</span> <span class="n">UAHX</span> <span class="o">*</span> <span class="n">Tcwout</span> <span class="o">/</span> <span class="n">MCeng</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span> <span class="n">UAskin</span> <span class="o">*</span> <span class="n">Troom</span> <span class="o">/</span>  <span class="n">MCeng</span> <span class="p">)</span>  <span class="o">+</span> <span class="p">(</span>  <span class="n">Qgenss</span> <span class="o">/</span> <span class="n">MCeng</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-2914"></a>  <span class="n">b</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span> <span class="o">-</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="n">UAHX</span> <span class="o">/</span> <span class="n">MCeng</span> <span class="p">)</span>  <span class="o">+</span> <span class="p">(</span> <span class="o">-</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="n">UAskin</span> <span class="o">/</span> <span class="n">MCeng</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-2915"></a>
<a name="ln-2916"></a>  <span class="n">FuncDetermineEngineTemp</span> <span class="o">=</span> <span class="p">(</span><span class="n">TengLast</span> <span class="o">+</span> <span class="n">a</span><span class="o">/</span><span class="n">b</span> <span class="p">)</span><span class="o">*</span> <span class="nb">exp</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="nb">time</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
<a name="ln-2917"></a>
<a name="ln-2918"></a>  <span class="k">RETURN</span>
<a name="ln-2919"></a>
<a name="ln-2920"></a><span class="k">END FUNCTION </span><span class="n">FuncDetermineEngineTemp</span>
<a name="ln-2921"></a>
<a name="ln-2922"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">FuncDetermineCoolantWaterExitTemp</span><span class="p">(</span><span class="n">Tcwin</span><span class="p">,</span> <span class="n">MCcw</span><span class="p">,</span> <span class="n">UAHX</span><span class="p">,</span> <span class="n">MdotCpcw</span><span class="p">,</span> <span class="n">Teng</span><span class="p">,</span> <span class="n">TcwoutLast</span><span class="p">,</span> <span class="nb">time</span><span class="p">)</span>
<a name="ln-2923"></a>
<a name="ln-2924"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2925"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-2926"></a>          <span class="c">!       DATE WRITTEN   Feb. 2007</span>
<a name="ln-2927"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2928"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2929"></a>
<a name="ln-2930"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2931"></a>          <span class="c">! Calculate coolan water leaving temperaure,</span>
<a name="ln-2932"></a>
<a name="ln-2933"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2934"></a>          <span class="c">! model is dynamic in that previous condition affects current timestep</span>
<a name="ln-2935"></a>          <span class="c">!  solve ode for coolant water outlet temp using analytical solution</span>
<a name="ln-2936"></a>
<a name="ln-2937"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2938"></a>          <span class="c">! na</span>
<a name="ln-2939"></a>
<a name="ln-2940"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2941"></a>  <span class="k">USE </span><span class="n">DataGlobals</span> <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MaxEXPArg</span>
<a name="ln-2942"></a>
<a name="ln-2943"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2944"></a>
<a name="ln-2945"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2946"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tcwin</span> <span class="c">! hot water inlet temp</span>
<a name="ln-2947"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MCcw</span>  <span class="c">! Fictitious mass and heat capacity of coolant hx</span>
<a name="ln-2948"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UAHX</span>   <span class="c">! Heat exchanger UA</span>
<a name="ln-2949"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MdotCpcw</span> <span class="c">! mass flow and specific heat of coolant water</span>
<a name="ln-2950"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Teng</span>  <span class="c">! engine mass temperature C</span>
<a name="ln-2951"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TcwoutLast</span> <span class="c">! coolant water leaving temp at previous time step</span>
<a name="ln-2952"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">time</span> <span class="c">! elapsed time since previous evaluation</span>
<a name="ln-2953"></a>
<a name="ln-2954"></a>
<a name="ln-2955"></a>
<a name="ln-2956"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-2957"></a>          <span class="c">! na</span>
<a name="ln-2958"></a>
<a name="ln-2959"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2960"></a>          <span class="c">! na</span>
<a name="ln-2961"></a>
<a name="ln-2962"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2963"></a>          <span class="c">! na</span>
<a name="ln-2964"></a>
<a name="ln-2965"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2966"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span>
<a name="ln-2967"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">b</span>
<a name="ln-2968"></a>
<a name="ln-2969"></a>  <span class="n">a</span> <span class="o">=</span>  <span class="p">(</span> <span class="n">MdotCpcw</span> <span class="o">*</span> <span class="n">Tcwin</span> <span class="o">/</span> <span class="n">MCcw</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span> <span class="n">UAHX</span> <span class="o">*</span> <span class="n">Teng</span> <span class="o">/</span>  <span class="n">MCcw</span> <span class="p">)</span>
<a name="ln-2970"></a>  <span class="n">b</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span> <span class="o">-</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="n">MdotCpcw</span> <span class="o">/</span> <span class="n">MCcw</span> <span class="p">)</span>  <span class="o">+</span> <span class="p">(</span> <span class="o">-</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="n">UAHX</span> <span class="o">/</span> <span class="n">MCcw</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-2971"></a>
<a name="ln-2972"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="nb">time</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span> <span class="o">*</span> <span class="n">MaxEXPArg</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2973"></a>
<a name="ln-2974"></a><span class="k">    </span><span class="n">FuncDetermineCoolantWaterExitTemp</span> <span class="o">=</span> <span class="o">-</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
<a name="ln-2975"></a>  <span class="k">ELSE</span>
<a name="ln-2976"></a>
<a name="ln-2977"></a><span class="k">    </span><span class="n">FuncDetermineCoolantWaterExitTemp</span> <span class="o">=</span> <span class="p">(</span><span class="n">TcwoutLast</span> <span class="o">+</span> <span class="n">a</span><span class="o">/</span><span class="n">b</span> <span class="p">)</span><span class="o">*</span> <span class="nb">exp</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="nb">time</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
<a name="ln-2978"></a>  <span class="n">ENDIF</span>
<a name="ln-2979"></a>  <span class="k">RETURN</span>
<a name="ln-2980"></a>
<a name="ln-2981"></a><span class="k">END FUNCTION </span><span class="n">FuncDetermineCoolantWaterExitTemp</span>
<a name="ln-2982"></a>
<a name="ln-2983"></a><span class="kt">Logical </span><span class="k">FUNCTION </span><span class="n">CheckMicroCHPThermalBalance</span><span class="p">(</span><span class="n">NomHeatGen</span><span class="p">,</span> <span class="n">Tcwin</span><span class="p">,</span> <span class="n">Tcwout</span><span class="p">,</span> <span class="n">Teng</span><span class="p">,</span> <span class="n">Troom</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2984"></a>                                             <span class="n">UAHX</span><span class="p">,</span> <span class="n">UAskin</span><span class="p">,</span> <span class="n">Qgenss</span><span class="p">,</span> <span class="n">MCeng</span><span class="p">,</span> <span class="n">MCcw</span> <span class="p">,</span> <span class="n">MdotCpcw</span>  <span class="p">)</span>
<a name="ln-2985"></a>
<a name="ln-2986"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2987"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-2988"></a>          <span class="c">!       DATE WRITTEN   Feb. 2007</span>
<a name="ln-2989"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2990"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2991"></a>
<a name="ln-2992"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2993"></a>          <span class="c">! Check for energy balance to test if can exit iteration loop</span>
<a name="ln-2994"></a>
<a name="ln-2995"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2996"></a>          <span class="c">! put all terms of dynamic energy balances on RHS and compute magnitude of imbalance</span>
<a name="ln-2997"></a>          <span class="c">!  compare imbalance to scalable thresholds and make a boolean conclusion.</span>
<a name="ln-2998"></a>
<a name="ln-2999"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3000"></a>          <span class="c">! na</span>
<a name="ln-3001"></a>
<a name="ln-3002"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3003"></a>          <span class="c">! na</span>
<a name="ln-3004"></a>
<a name="ln-3005"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3006"></a>
<a name="ln-3007"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-3008"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NomHeatGen</span> <span class="c">! nominal heat generation rate for scaling</span>
<a name="ln-3009"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tcwin</span> <span class="c">! hot water inlet temp</span>
<a name="ln-3010"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tcwout</span> <span class="c">! hot water leaving temp</span>
<a name="ln-3011"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Teng</span>  <span class="c">! engine mass temperature C</span>
<a name="ln-3012"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Troom</span>  <span class="c">! surrounding zone temperature C</span>
<a name="ln-3013"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UAHX</span>   <span class="c">! Heat exchanger UA</span>
<a name="ln-3014"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UAskin</span> <span class="c">! Skin losses UA</span>
<a name="ln-3015"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Qgenss</span> <span class="c">! steady state generator heat generation</span>
<a name="ln-3016"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MCeng</span>  <span class="c">! Fictitious mass and heat capacity of engine</span>
<a name="ln-3017"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MCcw</span>  <span class="c">! Fictitious mass and heat capacity of coolant hx</span>
<a name="ln-3018"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MdotCpcw</span> <span class="c">! mass flow and specific heat of coolant water</span>
<a name="ln-3019"></a>
<a name="ln-3020"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-3021"></a>          <span class="c">! na</span>
<a name="ln-3022"></a>
<a name="ln-3023"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3024"></a>          <span class="c">! na</span>
<a name="ln-3025"></a>
<a name="ln-3026"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3027"></a>          <span class="c">! na</span>
<a name="ln-3028"></a>
<a name="ln-3029"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3030"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">a</span> <span class="c">! working variable, &quot;a&quot; term in generic ODE</span>
<a name="ln-3031"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">b</span> <span class="c">! working variable &quot;b&quot; term in generic ODE</span>
<a name="ln-3032"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DTengDTime</span> <span class="c">! derivative of engine temp wrt time</span>
<a name="ln-3033"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DCoolOutTDtime</span> <span class="c">! derivative of coolant exit temp wrt time</span>
<a name="ln-3034"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">magImbalEng</span> <span class="c">! energy imbalance for engine control volume</span>
<a name="ln-3035"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">magImbalCooling</span> <span class="c">! energy imbalance for coolant control volume</span>
<a name="ln-3036"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">threshold</span> <span class="c">! criteria for when to call energy balance okay</span>
<a name="ln-3037"></a>  <span class="c">!first compute derivatives using a + bT</span>
<a name="ln-3038"></a>
<a name="ln-3039"></a>  <span class="n">a</span> <span class="o">=</span> <span class="p">(</span>  <span class="p">(</span> <span class="n">UAHX</span> <span class="o">*</span> <span class="n">Tcwout</span> <span class="o">/</span> <span class="n">MCeng</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span> <span class="n">UAskin</span> <span class="o">*</span> <span class="n">Troom</span> <span class="o">/</span>  <span class="n">MCeng</span> <span class="p">)</span>  <span class="o">+</span> <span class="p">(</span>  <span class="n">Qgenss</span> <span class="o">/</span> <span class="n">MCeng</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-3040"></a>  <span class="n">b</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span> <span class="o">-</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="n">UAHX</span> <span class="o">/</span> <span class="n">MCeng</span> <span class="p">)</span>  <span class="o">+</span> <span class="p">(</span> <span class="o">-</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="n">UAskin</span> <span class="o">/</span> <span class="n">MCeng</span> <span class="p">)</span>  <span class="p">)</span>
<a name="ln-3041"></a>  <span class="n">DTengDtime</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">Teng</span>
<a name="ln-3042"></a>
<a name="ln-3043"></a>  <span class="n">a</span> <span class="o">=</span>  <span class="p">(</span> <span class="n">MdotCpcw</span> <span class="o">*</span> <span class="n">Tcwin</span> <span class="o">/</span> <span class="n">MCcw</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span> <span class="n">UAHX</span> <span class="o">*</span> <span class="n">Teng</span> <span class="o">/</span>  <span class="n">MCcw</span> <span class="p">)</span>
<a name="ln-3044"></a>  <span class="n">b</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span> <span class="o">-</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="n">MdotCpcw</span> <span class="o">/</span> <span class="n">MCcw</span> <span class="p">)</span>  <span class="o">+</span> <span class="p">(</span> <span class="o">-</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="n">UAHX</span> <span class="o">/</span> <span class="n">MCcw</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-3045"></a>  <span class="n">DCoolOutTDtime</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">Tcwout</span>
<a name="ln-3046"></a>
<a name="ln-3047"></a>  <span class="n">magImbalEng</span>     <span class="o">=</span> <span class="n">UAHX</span> <span class="o">*</span> <span class="p">(</span><span class="n">Tcwout</span> <span class="o">-</span> <span class="n">Teng</span><span class="p">)</span> <span class="o">+</span> <span class="n">UAskin</span><span class="o">*</span><span class="p">(</span><span class="n">Troom</span> <span class="o">-</span> <span class="n">Teng</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qgenss</span> <span class="o">-</span> <span class="n">MCeng</span> <span class="o">*</span> <span class="n">DTengDtime</span>
<a name="ln-3048"></a>
<a name="ln-3049"></a>  <span class="n">magImbalCooling</span> <span class="o">=</span> <span class="n">MdotCpcw</span> <span class="o">*</span> <span class="p">(</span><span class="n">Tcwin</span> <span class="o">-</span> <span class="n">Tcwout</span><span class="p">)</span> <span class="o">+</span>  <span class="n">UAHX</span> <span class="o">*</span> <span class="p">(</span><span class="n">Teng</span> <span class="o">-</span> <span class="n">Tcwout</span><span class="p">)</span><span class="o">-</span> <span class="n">MCcw</span> <span class="o">*</span> <span class="n">DCoolOutTDtime</span>
<a name="ln-3050"></a>
<a name="ln-3051"></a>  <span class="n">threshold</span> <span class="o">=</span> <span class="n">NomHeatGen</span> <span class="o">/</span> <span class="mi">1000000</span><span class="mf">0.0d0</span>
<a name="ln-3052"></a>
<a name="ln-3053"></a>  <span class="n">CheckMicroCHPThermalBalance</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3054"></a>
<a name="ln-3055"></a>  <span class="k">If</span> <span class="p">((</span><span class="n">threshold</span> <span class="o">&gt;</span> <span class="n">magImbalEng</span> <span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">threshold</span> <span class="o">&gt;</span> <span class="n">magImbalCooling</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-3056"></a><span class="k">    </span><span class="n">CheckMicroCHPThermalBalance</span> <span class="o">=</span>  <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3057"></a>  <span class="n">endif</span>
<a name="ln-3058"></a>
<a name="ln-3059"></a>  <span class="k">RETURN</span>
<a name="ln-3060"></a>
<a name="ln-3061"></a><span class="k">END FUNCTION </span><span class="n">CheckMicroCHPThermalBalance</span>
<a name="ln-3062"></a>
<a name="ln-3063"></a><span class="k">SUBROUTINE </span><span class="n">FigureMicroCHPZoneGains</span>
<a name="ln-3064"></a>
<a name="ln-3065"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3066"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-3067"></a>          <span class="c">!       DATE WRITTEN   July 2006</span>
<a name="ln-3068"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3069"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3070"></a>
<a name="ln-3071"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3072"></a>          <span class="c">! Couple equiment skin losses to the Zone Heat Balance</span>
<a name="ln-3073"></a>          <span class="c">!</span>
<a name="ln-3074"></a>
<a name="ln-3075"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3076"></a>          <span class="c">! This routine adds up the various skin losses and then</span>
<a name="ln-3077"></a>          <span class="c">!  sets the values in the ZoneIntGain structure</span>
<a name="ln-3078"></a>
<a name="ln-3079"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3080"></a>          <span class="c">! na</span>
<a name="ln-3081"></a>
<a name="ln-3082"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3083"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span> <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneIntGain</span>
<a name="ln-3084"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">BeginEnvrnFlag</span>
<a name="ln-3085"></a>
<a name="ln-3086"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3087"></a>
<a name="ln-3088"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3089"></a>
<a name="ln-3090"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3091"></a>          <span class="c">! na</span>
<a name="ln-3092"></a>
<a name="ln-3093"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3094"></a>          <span class="c">! na</span>
<a name="ln-3095"></a>
<a name="ln-3096"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3097"></a>          <span class="c">! na</span>
<a name="ln-3098"></a>
<a name="ln-3099"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3100"></a><span class="c">!  INTEGER :: thisZone ! index in Zone structure array</span>
<a name="ln-3101"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotalZoneHeatGain</span>
<a name="ln-3102"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CHPnum</span>
<a name="ln-3103"></a><span class="c">!  INTEGER :: ZoneNum</span>
<a name="ln-3104"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3105"></a>
<a name="ln-3106"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumMicroCHPs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-3107"></a>
<a name="ln-3108"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3109"></a><span class="k">    </span><span class="n">FuelSupply</span><span class="p">%</span><span class="n">QskinLoss</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3110"></a>    <span class="n">MicroCHP</span><span class="p">%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">QdotSkin</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3111"></a>    <span class="n">MicroCHP</span><span class="p">%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossConvect</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3112"></a>    <span class="n">MicroCHP</span><span class="p">%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossRadiat</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3113"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3114"></a>  <span class="k">END IF</span>
<a name="ln-3115"></a>
<a name="ln-3116"></a><span class="k">  IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3117"></a>
<a name="ln-3118"></a>  <span class="k">DO </span><span class="n">CHPnum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumMicroCHPs</span>
<a name="ln-3119"></a>    <span class="n">TotalZoneHeatGain</span> <span class="o">=</span>   <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">CHPnum</span><span class="p">)%</span><span class="n">FuelSupplyID</span> <span class="p">)%</span><span class="n">QskinLoss</span> <span class="p">&amp;</span>
<a name="ln-3120"></a>                       <span class="o">+</span> <span class="n">MicroCHP</span><span class="p">(</span> <span class="n">CHPnum</span> <span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">QdotSkin</span>
<a name="ln-3121"></a>
<a name="ln-3122"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">CHPnum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">QdotConvZone</span> <span class="o">=</span> <span class="n">TotalZoneHeatGain</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">CHPnum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">RadiativeFraction</span><span class="p">)</span>
<a name="ln-3123"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">CHPnum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossConvect</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">CHPnum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">QdotConvZone</span>
<a name="ln-3124"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">CHPnum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">QdotRadZone</span>  <span class="o">=</span> <span class="n">TotalZoneHeatGain</span> <span class="o">*</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">CHPnum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">RadiativeFraction</span>
<a name="ln-3125"></a>    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">CHPnum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossRadiat</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">CHPnum</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">QdotRadZone</span>
<a name="ln-3126"></a>  <span class="n">ENDDO</span>
<a name="ln-3127"></a>
<a name="ln-3128"></a>
<a name="ln-3129"></a>
<a name="ln-3130"></a>  <span class="c">! this routine needs to do something for zone gains during sizing</span>
<a name="ln-3131"></a><span class="c">!  IF(DoingSizing)THEN</span>
<a name="ln-3132"></a>
<a name="ln-3133"></a><span class="c">!  ENDIF</span>
<a name="ln-3134"></a>
<a name="ln-3135"></a>  <span class="k">RETURN</span>
<a name="ln-3136"></a>
<a name="ln-3137"></a><span class="k">END SUBROUTINE </span><span class="n">FigureMicroCHPZoneGains</span>
<a name="ln-3138"></a>
<a name="ln-3139"></a><span class="k">SUBROUTINE </span><span class="n">CalcUpdateHeatRecovery</span><span class="p">(</span><span class="n">Num</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-3140"></a>
<a name="ln-3141"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3142"></a>          <span class="c">!       AUTHOR         B Griffith</span>
<a name="ln-3143"></a>          <span class="c">!       DATE WRITTEN   Aug 2006</span>
<a name="ln-3144"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3145"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3146"></a>
<a name="ln-3147"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3148"></a>          <span class="c">! update plant loop interactions, do any calcs needed</span>
<a name="ln-3149"></a>
<a name="ln-3150"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3151"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3152"></a>
<a name="ln-3153"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3154"></a>          <span class="c">! na</span>
<a name="ln-3155"></a>
<a name="ln-3156"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3157"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-3158"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-3159"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SafeCopyPlantNode</span>
<a name="ln-3160"></a>
<a name="ln-3161"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3162"></a>
<a name="ln-3163"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3164"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">Num</span>       <span class="c">! Generator number</span>
<a name="ln-3165"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-3166"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3167"></a>          <span class="c">! na</span>
<a name="ln-3168"></a>
<a name="ln-3169"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3170"></a>          <span class="c">! na</span>
<a name="ln-3171"></a>
<a name="ln-3172"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3173"></a>          <span class="c">! na</span>
<a name="ln-3174"></a>
<a name="ln-3175"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3176"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">InNodeNum</span>
<a name="ln-3177"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OutNodeNum</span>
<a name="ln-3178"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cp</span> <span class="c">! local Specific heat of fluid</span>
<a name="ln-3179"></a><span class="c">!  REAL(r64) :: mdot !local mass flow rate</span>
<a name="ln-3180"></a>
<a name="ln-3181"></a>  <span class="c">! now update water outlet node Changing to Kg/s!</span>
<a name="ln-3182"></a>  <span class="n">OutNodeNum</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">PlantOutletNodeID</span>
<a name="ln-3183"></a>  <span class="n">InNodeNum</span>  <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">PlantInletNodeID</span>
<a name="ln-3184"></a>
<a name="ln-3185"></a>  <span class="k">CAll </span><span class="n">SafeCopyPlantNode</span> <span class="p">(</span><span class="n">InNodeNum</span><span class="p">,</span> <span class="n">OutNodeNum</span><span class="p">)</span>
<a name="ln-3186"></a>
<a name="ln-3187"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">OutNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Tcwout</span>
<a name="ln-3188"></a>
<a name="ln-3189"></a>  <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3190"></a>                             <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Tcwin</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3191"></a>                             <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3192"></a>                             <span class="s1">&#39;CalcUpdateHeatRecovery&#39;</span><span class="p">)</span>
<a name="ln-3193"></a>
<a name="ln-3194"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">OutNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Tcwout</span> <span class="o">*</span> <span class="n">Cp</span>
<a name="ln-3195"></a>
<a name="ln-3196"></a>
<a name="ln-3197"></a>  <span class="k">RETURN</span>
<a name="ln-3198"></a>
<a name="ln-3199"></a><span class="k">END SUBROUTINE </span><span class="n">CalcUpdateHeatRecovery</span>
<a name="ln-3200"></a>
<a name="ln-3201"></a><span class="k">SUBROUTINE </span><span class="n">SimMicroCHPPlantHeatRecovery</span><span class="p">(</span><span class="n">CompType</span><span class="p">,</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompNum</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">InitLoopEquip</span><span class="p">,</span>  <span class="p">&amp;</span> <span class="c">!DSU</span>
<a name="ln-3202"></a>                          <span class="n">MyThermalLoad</span><span class="p">,</span><span class="n">MaxCap</span><span class="p">,</span><span class="n">MinCap</span><span class="p">,</span><span class="n">OptCap</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-3203"></a>
<a name="ln-3204"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3205"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-3206"></a>          <span class="c">!       DATE WRITTEN   Jan 2006</span>
<a name="ln-3207"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3208"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3209"></a>
<a name="ln-3210"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3211"></a>          <span class="c">! makes sure input are gotten and setup from Plant loop perspective.</span>
<a name="ln-3212"></a>          <span class="c">! does not (re)simulate entire MicroCHP model</span>
<a name="ln-3213"></a>
<a name="ln-3214"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3215"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3216"></a>
<a name="ln-3217"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3218"></a>          <span class="c">! na</span>
<a name="ln-3219"></a>
<a name="ln-3220"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3221"></a>          <span class="c">! na</span>
<a name="ln-3222"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-3223"></a>  <span class="k">Use </span><span class="n">DataGlobalConstants</span>
<a name="ln-3224"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">UpdateComponentHeatRecoverySide</span>
<a name="ln-3225"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>      <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TypeOf_Generator_MicroCHP</span>
<a name="ln-3226"></a>
<a name="ln-3227"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3228"></a>
<a name="ln-3229"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3230"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompType</span>
<a name="ln-3231"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompName</span>
<a name="ln-3232"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">CompNum</span>
<a name="ln-3233"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">RunFlag</span>
<a name="ln-3234"></a>  <span class="c">!INTEGER, INTENT(IN)          :: FlowLock !DSU</span>
<a name="ln-3235"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">InitLoopEquip</span>
<a name="ln-3236"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MyThermalLoad</span>
<a name="ln-3237"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">MinCap</span>
<a name="ln-3238"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">MaxCap</span>
<a name="ln-3239"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">OptCap</span>
<a name="ln-3240"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! TRUE if First iteration of simulation</span>
<a name="ln-3241"></a>
<a name="ln-3242"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3243"></a>          <span class="c">! na</span>
<a name="ln-3244"></a>
<a name="ln-3245"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3246"></a>          <span class="c">! na</span>
<a name="ln-3247"></a>
<a name="ln-3248"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3249"></a>          <span class="c">! na</span>
<a name="ln-3250"></a>
<a name="ln-3251"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3252"></a>          <span class="c">! na</span>
<a name="ln-3253"></a>
<a name="ln-3254"></a>
<a name="ln-3255"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetMicroCHPInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3256"></a>
<a name="ln-3257"></a>     <span class="c">! Read input data.</span>
<a name="ln-3258"></a>     <span class="k">CALL  </span><span class="n">GetMicroCHPGeneratorInput</span>
<a name="ln-3259"></a>     <span class="n">GetMicroCHPInput</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3260"></a>  <span class="n">ENDIF</span>
<a name="ln-3261"></a>
<a name="ln-3262"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3263"></a><span class="k">    </span><span class="n">CompNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">MicroCHP</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumMicroCHPs</span><span class="p">)</span>
<a name="ln-3264"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CompNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3265"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimMicroCHPPlantHeatRecovery: MicroCHP Generator Unit not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-3266"></a>      <span class="k">RETURN</span>
<a name="ln-3267"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-3268"></a>    <span class="k">CALL </span><span class="n">InitMicroCHPNoNormalizeGenerators</span><span class="p">(</span><span class="n">CompNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-3269"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MySizeFlag</span><span class="p">(</span><span class="n">CompNum</span><span class="p">))</span> <span class="k">RETURN</span>
<a name="ln-3270"></a><span class="k">    </span><span class="n">MinCap</span>  <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">DynamicsControlID</span><span class="p">)%</span><span class="n">QdotHXMin</span>
<a name="ln-3271"></a>    <span class="n">MaxCap</span>  <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">DynamicsControlID</span><span class="p">)%</span><span class="n">QdotHXMax</span>
<a name="ln-3272"></a>    <span class="n">OptCap</span>  <span class="o">=</span> <span class="n">GeneratorDynamics</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">DynamicsControlID</span><span class="p">)%</span><span class="n">QdotHXOpt</span>
<a name="ln-3273"></a>    <span class="k">RETURN</span>
<a name="ln-3274"></a><span class="k">  END IF</span>  <span class="c">! End Of InitLoopEquip</span>
<a name="ln-3275"></a>
<a name="ln-3276"></a>  <span class="k">CALL </span><span class="n">UpdateComponentHeatRecoverySide</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">,</span>               <span class="p">&amp;</span>
<a name="ln-3277"></a>                                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">CWLoopSideNum</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-3278"></a>                                    <span class="n">TypeOf_Generator_MicroCHP</span><span class="p">,</span>                           <span class="p">&amp;</span>
<a name="ln-3279"></a>                                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">PlantInletNodeID</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-3280"></a>                                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">PlantOutletNodeID</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-3281"></a>                                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">QdotHR</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-3282"></a>                                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HeatRecInletTemp</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3283"></a>                                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HeatRecOutletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3284"></a>                                    <span class="n">MicroCHP</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HeatRecMdot</span> <span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3285"></a>                                    <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-3286"></a>
<a name="ln-3287"></a>  <span class="k">RETURN</span>
<a name="ln-3288"></a>
<a name="ln-3289"></a><span class="k">END SUBROUTINE </span><span class="n">SimMicroCHPPlantHeatRecovery</span>
<a name="ln-3290"></a>
<a name="ln-3291"></a><span class="k">SUBROUTINE </span><span class="n">UpdateMicroCHPGeneratorRecords</span><span class="p">(</span><span class="n">Num</span><span class="p">)</span>
<a name="ln-3292"></a>
<a name="ln-3293"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3294"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-3295"></a>          <span class="c">!       DATE WRITTEN   July 2006</span>
<a name="ln-3296"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3297"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3298"></a>
<a name="ln-3299"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3300"></a>          <span class="c">! update variables in structures linked to output reports</span>
<a name="ln-3301"></a>
<a name="ln-3302"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3303"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3304"></a>
<a name="ln-3305"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3306"></a>          <span class="c">! na</span>
<a name="ln-3307"></a>
<a name="ln-3308"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3309"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">SecInHour</span>
<a name="ln-3310"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-3311"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-3312"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-3313"></a>
<a name="ln-3314"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3315"></a>
<a name="ln-3316"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3317"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">Num</span>       <span class="c">! Generator number</span>
<a name="ln-3318"></a>
<a name="ln-3319"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3320"></a>          <span class="c">! na</span>
<a name="ln-3321"></a>
<a name="ln-3322"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3323"></a>          <span class="c">! na</span>
<a name="ln-3324"></a>
<a name="ln-3325"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3326"></a>          <span class="c">! na</span>
<a name="ln-3327"></a>
<a name="ln-3328"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3329"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Cp</span> <span class="c">! local fluid specific heat</span>
<a name="ln-3330"></a>
<a name="ln-3331"></a>          <span class="c">! na</span>
<a name="ln-3332"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">Mode</span>              <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">OpMode</span>
<a name="ln-3333"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">OffModeTime</span>       <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">OffModeTime</span>
<a name="ln-3334"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">StandyByModeTime</span>  <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">StandyByModeTime</span>
<a name="ln-3335"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">WarmUpModeTime</span>    <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">WarmUpModeTime</span>
<a name="ln-3336"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NormalModeTime</span>    <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">NormalModeTime</span>
<a name="ln-3337"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">CoolDownModeTime</span>  <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">CoolDownModeTime</span>
<a name="ln-3338"></a>
<a name="ln-3339"></a>
<a name="ln-3340"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ACPowerGen</span>     <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Pnet</span>  <span class="c">!electrical power produced [W]</span>
<a name="ln-3341"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ACEnergyGen</span>    <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Pnet</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span> <span class="c">! energy produced (J)</span>
<a name="ln-3342"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">QdotGross</span>      <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Qgross</span>
<a name="ln-3343"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">Qgenss</span>         <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Qgenss</span>
<a name="ln-3344"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">QdotHX</span>         <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">UAhx</span> <span class="p">&amp;</span>
<a name="ln-3345"></a>                     <span class="o">*</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Teng</span>  <span class="o">-</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Tcwout</span><span class="p">)</span> <span class="c">!  heat recovered rate (W)</span>
<a name="ln-3346"></a>
<a name="ln-3347"></a>  <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3348"></a>                             <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Tcwin</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3349"></a>                             <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3350"></a>                             <span class="s1">&#39;UpdateMicroCHPGeneratorRecords&#39;</span><span class="p">)</span>
<a name="ln-3351"></a>
<a name="ln-3352"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">QdotHR</span>         <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">PlantMassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="p">&amp;</span>
<a name="ln-3353"></a>                                        <span class="o">*</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Tcwout</span> <span class="o">-</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Tcwin</span><span class="p">)</span>
<a name="ln-3354"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TotalHeatEnergyRec</span>  <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">QdotHR</span> <span class="p">&amp;</span> <span class="c">! heat recovered energy (J)</span>
<a name="ln-3355"></a>                                        <span class="o">*</span> <span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3356"></a>
<a name="ln-3357"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HeatRecInletTemp</span>           <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Tcwin</span> <span class="c">! Heat Recovery Loop Inlet Temperature (C)</span>
<a name="ln-3358"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HeatRecOutletTemp</span>          <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Tcwout</span> <span class="c">! Heat Recovery Loop Outlet Temperature (C)</span>
<a name="ln-3359"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HeatRecMdot</span>                <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">PlantMassFlowRate</span> <span class="c">! Heat Recovery Loop Mass flow rate (kg/s)</span>
<a name="ln-3360"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">Tengine</span>           <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Teng</span>
<a name="ln-3361"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ElectEfficiency</span>   <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ElecEff</span>
<a name="ln-3362"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ThermalEfficiency</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ThermEff</span>
<a name="ln-3363"></a>
<a name="ln-3364"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">OverallEfficiency</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ElecEff</span> <span class="o">+</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">ThermEff</span>
<a name="ln-3365"></a>
<a name="ln-3366"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">MdotAir</span>           <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MdotAir</span>        <span class="c">! air flow in kg/sec</span>
<a name="ln-3367"></a>
<a name="ln-3368"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotFuel</span>          <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">NdotFuel</span>       <span class="c">! fuel flow in kmol/sec</span>
<a name="ln-3369"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">MdotFuel</span>          <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">MdotFuel</span>       <span class="c">! fuel flow in kg/sec</span>
<a name="ln-3370"></a>
<a name="ln-3371"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelCompressPower</span> <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">PfuelCompEl</span>
<a name="ln-3372"></a>                                                       <span class="c">! electrical power used by fuel supply compressor [W]</span>
<a name="ln-3373"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelCompressEnergy</span> <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">PfuelCompEl</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span> <span class="c">! elect energy</span>
<a name="ln-3374"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelCompressSkinLoss</span> <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">QskinLoss</span>
<a name="ln-3375"></a>                                                              <span class="c">!heat rate of losses.by fuel supply compressor [W]</span>
<a name="ln-3376"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelEnergyHHV</span>        <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">NdotFuel</span> <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">HHV</span> <span class="p">&amp;</span>
<a name="ln-3377"></a>                                          <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">KmolPerSecToKgPerSec</span> <span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3378"></a>              <span class="c">! reporting: Fuel Energy used (W)</span>
<a name="ln-3379"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelEnergyUseRateHHV</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">NdotFuel</span> <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">HHV</span> <span class="p">&amp;</span>
<a name="ln-3380"></a>                                          <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">KmolPerSecToKgPerSec</span>
<a name="ln-3381"></a>              <span class="c">! reporting: Fuel Energy used (J)</span>
<a name="ln-3382"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelEnergyLHV</span>        <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">NdotFuel</span> <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">LHV</span> <span class="p">&amp;</span>
<a name="ln-3383"></a>                                          <span class="o">*</span> <span class="mi">100000</span><span class="mf">0.0d0</span> <span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3384"></a>              <span class="c">! reporting: Fuel Energy used (W)</span>
<a name="ln-3385"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelEnergyUseRateLHV</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">NdotFuel</span> <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupplyID</span><span class="p">)%</span><span class="n">LHV</span> <span class="p">&amp;</span>
<a name="ln-3386"></a>                                          <span class="o">*</span> <span class="mi">100000</span><span class="mf">0.0d0</span>
<a name="ln-3387"></a>
<a name="ln-3388"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossPower</span>   <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">QdotconvZone</span> <span class="o">+</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">QdotRadZone</span>
<a name="ln-3389"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossEnergy</span>  <span class="o">=</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">QdotConvZone</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-3390"></a>                                          <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">QdotRadZone</span><span class="p">)</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3391"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossConvect</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">QdotConvZone</span>
<a name="ln-3392"></a>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossRadiat</span>  <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">QdotRadZone</span>
<a name="ln-3393"></a>
<a name="ln-3394"></a><span class="c">! update node data for air inlet (and outlet)</span>
<a name="ln-3395"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AirInletNodeId</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3396"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AirInletNodeId</span><span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">MdotAir</span>
<a name="ln-3397"></a>  <span class="n">ENDIF</span>
<a name="ln-3398"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AirOutletNodeID</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3399"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AirOutletNodeID</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">MdotAir</span>
<a name="ln-3400"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AirOutletNodeID</span><span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">MicroCHP</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">A42Model</span><span class="p">%</span><span class="n">Teng</span>
<a name="ln-3401"></a>  <span class="n">ENDIF</span>
<a name="ln-3402"></a>
<a name="ln-3403"></a>  <span class="k">RETURN</span>
<a name="ln-3404"></a>
<a name="ln-3405"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateMicroCHPGeneratorRecords</span>
<a name="ln-3406"></a>
<a name="ln-3407"></a><span class="k">SUBROUTINE </span><span class="n">GetMicroCHPGeneratorResults</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span> <span class="n">GeneratorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3408"></a>                                 <span class="n">GeneratorPower</span><span class="p">,</span>  <span class="n">GeneratorEnergy</span><span class="p">,</span> <span class="n">ThermalPower</span><span class="p">,</span> <span class="n">ThermalEnergy</span><span class="p">)</span>
<a name="ln-3409"></a>
<a name="ln-3410"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3411"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-3412"></a>          <span class="c">!       DATE WRITTEN   March 2008</span>
<a name="ln-3413"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3414"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3415"></a>
<a name="ln-3416"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3417"></a>          <span class="c">! provide a get method to collect results at the load center level</span>
<a name="ln-3418"></a>
<a name="ln-3419"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3420"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3421"></a>
<a name="ln-3422"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3423"></a>          <span class="c">! na</span>
<a name="ln-3424"></a>
<a name="ln-3425"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3426"></a>          <span class="c">! na</span>
<a name="ln-3427"></a>
<a name="ln-3428"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3429"></a>
<a name="ln-3430"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3431"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">GeneratorType</span>   <span class="c">! type of Generator</span>
<a name="ln-3432"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">GeneratorIndex</span>
<a name="ln-3433"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">GeneratorPower</span>  <span class="c">! electrical power</span>
<a name="ln-3434"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">GeneratorEnergy</span> <span class="c">! electrical energy</span>
<a name="ln-3435"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">ThermalPower</span>  <span class="c">! heat power</span>
<a name="ln-3436"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">ThermalEnergy</span> <span class="c">! heat energy</span>
<a name="ln-3437"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3438"></a>          <span class="c">! na</span>
<a name="ln-3439"></a>
<a name="ln-3440"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3441"></a>          <span class="c">! na</span>
<a name="ln-3442"></a>
<a name="ln-3443"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3444"></a>          <span class="c">! na</span>
<a name="ln-3445"></a>
<a name="ln-3446"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3447"></a>  <span class="n">GeneratorPower</span>  <span class="o">=</span>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ACPowerGen</span>
<a name="ln-3448"></a>  <span class="n">GeneratorEnergy</span> <span class="o">=</span>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ACEnergyGen</span>
<a name="ln-3449"></a>  <span class="n">ThermalPower</span>    <span class="o">=</span>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">report</span><span class="p">%</span><span class="n">QdotHR</span>
<a name="ln-3450"></a>  <span class="n">ThermalEnergy</span>   <span class="o">=</span>  <span class="n">MicroCHP</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">report</span><span class="p">%</span><span class="n">TotalHeatEnergyRec</span>
<a name="ln-3451"></a>
<a name="ln-3452"></a>  <span class="k">RETURN</span>
<a name="ln-3453"></a>
<a name="ln-3454"></a><span class="k">END SUBROUTINE </span><span class="n">GetMicroCHPGeneratorResults</span>
<a name="ln-3455"></a>
<a name="ln-3456"></a>
<a name="ln-3457"></a>
<a name="ln-3458"></a><span class="k">End Module </span><span class="n">MicroCHPElectricGenerator</span>
<a name="ln-3459"></a><span class="c">!</span>
<a name="ln-3460"></a>
<a name="ln-3461"></a>
<a name="ln-3462"></a>
<a name="ln-3463"></a>
<a name="ln-3464"></a><span class="c">!*******************************************************************************************************</span>
<a name="ln-3465"></a><span class="k">MODULE </span><span class="n">FuelCellElectricGenerator</span>
<a name="ln-3466"></a>
<a name="ln-3467"></a>          <span class="c">! MODULE INFORMATION:</span>
<a name="ln-3468"></a>          <span class="c">!       AUTHOR         Brent Griffth</span>
<a name="ln-3469"></a>          <span class="c">!       DATE WRITTEN   August. 2005</span>
<a name="ln-3470"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3471"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3472"></a>
<a name="ln-3473"></a>          <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-3474"></a>          <span class="c">! This module simulates the operation of Solid oxide fuel cell Generators.</span>
<a name="ln-3475"></a>
<a name="ln-3476"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3477"></a>          <span class="c">! Once the ElectricPowerManager determines that the FuelCell Generator</span>
<a name="ln-3478"></a>          <span class="c">! is available to meet an electric load demand, it calls SimFuelCellGenerator</span>
<a name="ln-3479"></a>          <span class="c">! which in turn calls the FuelCell model.</span>
<a name="ln-3480"></a>          <span class="c">! See DataGenerators.f90 for structures and variables</span>
<a name="ln-3481"></a>
<a name="ln-3482"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3483"></a>          <span class="c">! IEA/ECBCS Annex 42 model specification for Solid oxide and proton exchange membrane fuel cells</span>
<a name="ln-3484"></a>
<a name="ln-3485"></a>          <span class="c">! OTHER NOTES:</span>
<a name="ln-3486"></a>          <span class="c">! N/A</span>
<a name="ln-3487"></a>
<a name="ln-3488"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3489"></a><span class="k">USE </span><span class="n">DataGenerators</span>
<a name="ln-3490"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-3491"></a><span class="k">USE </span><span class="n">DataGlobals</span> <span class="p">,</span>   <span class="n">ONLY</span> <span class="p">:</span> <span class="n">MaxNameLength</span><span class="p">,</span> <span class="n">NumOfTimeStepInHour</span><span class="p">,</span> <span class="n">NumOfZones</span><span class="p">,</span> <span class="n">CurrentTime</span><span class="p">,</span> <span class="n">DayOfSim</span><span class="p">,</span> <span class="n">SecInHour</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-3492"></a>                           <span class="n">BeginEnvrnFlag</span><span class="p">,</span> <span class="n">InitConvTemp</span><span class="p">,</span> <span class="n">WarmUpFlag</span><span class="p">,</span> <span class="n">KelvinConv</span><span class="p">,</span> <span class="n">HoursInDay</span>
<a name="ln-3493"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-3494"></a><span class="k">USE </span><span class="n">DataGlobalConstants</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">iGeneratorFuelCell</span>
<a name="ln-3495"></a><span class="k">USE </span><span class="n">GeneratorFuelSupply</span>
<a name="ln-3496"></a><span class="k">USE </span><span class="n">GeneratorDynamicsManager</span>
<a name="ln-3497"></a>
<a name="ln-3498"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-3499"></a>
<a name="ln-3500"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-3501"></a>
<a name="ln-3502"></a>  <span class="c">!MODULE PARAMETER DEFINITIONS</span>
<a name="ln-3503"></a>
<a name="ln-3504"></a>
<a name="ln-3505"></a>  <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3506"></a>
<a name="ln-3507"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-3508"></a><span class="kt">LOGICAL</span>  <span class="kd">::</span> <span class="n">GetFuelCellInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="c">! When TRUE, calls subroutine to read input file.</span>
<a name="ln-3509"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckEquipName</span>
<a name="ln-3510"></a>
<a name="ln-3511"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE FuelCell ElectricGenerator</span>
<a name="ln-3512"></a><span class="k">PUBLIC     </span><span class="n">SimFuelCellGenerator</span>  <span class="c">! call handler, gets input first time</span>
<a name="ln-3513"></a><span class="k">PUBLIC     </span><span class="n">GetFuelCellGeneratorResults</span>
<a name="ln-3514"></a>
<a name="ln-3515"></a><span class="k">PRIVATE    </span><span class="n">GetFuelCellGeneratorInput</span> <span class="c">! gathers user data from input processor</span>
<a name="ln-3516"></a><span class="c">!PRIVATE    SetupFuelAndAirConstituentData ! hardwired data for gas phase thermochemistry calcs</span>
<a name="ln-3517"></a><span class="k">PRIVATE    </span><span class="n">InitFuelCellGenerators</span>
<a name="ln-3518"></a>
<a name="ln-3519"></a><span class="k">PRIVATE    </span><span class="n">CalcFuelCellGeneratorModel</span> <span class="c">! main calculations for FuelCell poer module</span>
<a name="ln-3520"></a>
<a name="ln-3521"></a><span class="k">PRIVATE    </span><span class="n">FigureAirHeatCap</span>  <span class="c">! molar heat capacity for &quot;air&quot; constituents</span>
<a name="ln-3522"></a><span class="k">PRIVATE    </span><span class="n">FigureAirEnthalpy</span> <span class="c">! molar enthalpy for &quot;air&quot; constituents</span>
<a name="ln-3523"></a><span class="k">PRIVATE    </span><span class="n">FigureFuelHeatCap</span> <span class="c">! molar heat capacity for fuel constituents</span>
<a name="ln-3524"></a><span class="k">PRIVATE    </span><span class="n">FigureFuelEnthalpy</span>  <span class="c">! molar enthalpy for fuel constituents</span>
<a name="ln-3525"></a><span class="k">PRIVATE    </span><span class="n">FigureProductGasHeatCap</span>  <span class="c">! molar heat capacity for product gas constituents</span>
<a name="ln-3526"></a><span class="k">PRIVATE    </span><span class="n">FigureProductGasesEnthalpy</span> <span class="c">! molar enthalpy for product gas constituents</span>
<a name="ln-3527"></a><span class="k">PRIVATE    </span><span class="n">FigureLiquidWaterHeatCap</span> <span class="c">! calculate shomate eq. for pure liquid water</span>
<a name="ln-3528"></a><span class="k">PRIVATE    </span><span class="n">FuelCellProductGasEnthResidual</span> <span class="c">! function in call to numerical solver, uses FigureProductGasesEnthalpy</span>
<a name="ln-3529"></a><span class="k">PRIVATE    </span><span class="n">FigureLHVofFuel</span> <span class="c">! Not used, for Eq. 6 in Annex 42 spec, see SetupFuelAndAirConstituentData</span>
<a name="ln-3530"></a>
<a name="ln-3531"></a><span class="k">PRIVATE    </span><span class="n">FigureACAncillaries</span>
<a name="ln-3532"></a><span class="k">PRIVATE    </span><span class="n">FigurePowerConditioningLosses</span>
<a name="ln-3533"></a><span class="k">PRIVATE    </span><span class="n">FigureTransientConstraints</span>
<a name="ln-3534"></a>
<a name="ln-3535"></a><span class="k">PRIVATE    </span><span class="n">CalcFuelCellAuxHeater</span>
<a name="ln-3536"></a><span class="k">PRIVATE    </span><span class="n">CalcFuelCellGenHeatRecovery</span>
<a name="ln-3537"></a>
<a name="ln-3538"></a><span class="k">PUBLIC     </span><span class="n">SimFuelCellPlantHeatRecovery</span>
<a name="ln-3539"></a>
<a name="ln-3540"></a><span class="k">PUBLIC     </span><span class="n">FigureFuelCellZoneGains</span>
<a name="ln-3541"></a><span class="k">PRIVATE    </span><span class="n">UpdateExhaustAirFlows</span>
<a name="ln-3542"></a><span class="k">PRIVATE    </span><span class="n">ManageElectStorInteractions</span> <span class="c">! electrical storage (battery) inside the unit</span>
<a name="ln-3543"></a><span class="k">PRIVATE    </span><span class="n">CalcUpdateHeatRecovery</span>
<a name="ln-3544"></a><span class="k">PRIVATE    </span><span class="n">UpdateFuelCellGeneratorRecords</span> <span class="c">! Sets variables used in reporting</span>
<a name="ln-3545"></a>
<a name="ln-3546"></a><span class="k">CONTAINS</span>
<a name="ln-3547"></a>          <span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-3548"></a>
<a name="ln-3549"></a><span class="c">! Beginning of FuelCell Generator Module Driver Subroutines</span>
<a name="ln-3550"></a><span class="c">!*************************************************************************</span>
<a name="ln-3551"></a>
<a name="ln-3552"></a><span class="k">SUBROUTINE </span><span class="n">SimFuelCellGenerator</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span><span class="n">GeneratorName</span><span class="p">,</span><span class="n">GeneratorIndex</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-3553"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3554"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-3555"></a>          <span class="c">!       DATE WRITTEN   MArch 2005</span>
<a name="ln-3556"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3557"></a>
<a name="ln-3558"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE: This is the Solid oxide fuel cell Generator model driver.  It</span>
<a name="ln-3559"></a>          <span class="c">! gets the input for the models, initializes simulation variables, call</span>
<a name="ln-3560"></a>          <span class="c">! the appropriate model and sets up reporting variables.</span>
<a name="ln-3561"></a>
<a name="ln-3562"></a>          <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-3563"></a>
<a name="ln-3564"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-3565"></a>
<a name="ln-3566"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3567"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-3568"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-3569"></a>
<a name="ln-3570"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-3571"></a>
<a name="ln-3572"></a>
<a name="ln-3573"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3574"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorType</span>     <span class="c">! type of Generator</span>
<a name="ln-3575"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorName</span>     <span class="c">! user specified name of Generator</span>
<a name="ln-3576"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorIndex</span>
<a name="ln-3577"></a>  <span class="kt">LOGICAL</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">RunFlag</span>                 <span class="c">! simulate Generator when TRUE</span>
<a name="ln-3578"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">MyLoad</span>                  <span class="c">! demand on electric generator</span>
<a name="ln-3579"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-3580"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3581"></a>          <span class="c">! na</span>
<a name="ln-3582"></a>
<a name="ln-3583"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3584"></a>          <span class="c">! na</span>
<a name="ln-3585"></a>
<a name="ln-3586"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3587"></a>          <span class="c">! na</span>
<a name="ln-3588"></a>
<a name="ln-3589"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3590"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">GenNum</span>           <span class="c">! Generator number counter</span>
<a name="ln-3591"></a>
<a name="ln-3592"></a>        <span class="c">!Get Generator data from input file</span>
<a name="ln-3593"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetFuelCellInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3594"></a><span class="k">    CALL </span><span class="n">GetFuelCellGeneratorInput</span>
<a name="ln-3595"></a>    <span class="n">GetFuelCellInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3596"></a>  <span class="k">END IF</span>
<a name="ln-3597"></a>
<a name="ln-3598"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">GeneratorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3599"></a><span class="k">    </span><span class="n">GenNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">,</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumFuelCellGenerators</span><span class="p">)</span>
<a name="ln-3600"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GenNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimFuelCellGenerator: Specified Generator not one of Valid FuelCell Generators &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3601"></a>                                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">))</span>
<a name="ln-3602"></a>    <span class="n">GeneratorIndex</span><span class="o">=</span><span class="n">GenNum</span>
<a name="ln-3603"></a>  <span class="k">ELSE</span>
<a name="ln-3604"></a><span class="k">    </span><span class="n">GenNum</span><span class="o">=</span><span class="n">GeneratorIndex</span>
<a name="ln-3605"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GenNum</span> <span class="o">&gt;</span> <span class="n">NumFuelCellGenerators</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">GenNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3606"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimFuelCellGenerator: Invalid GeneratorIndex passed=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">GenNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3607"></a>                          <span class="s1">&#39;, Number of FuelCell Generators=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumFuelCellGenerators</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3608"></a>                          <span class="s1">&#39;, Generator name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">))</span>
<a name="ln-3609"></a>    <span class="n">ENDIF</span>
<a name="ln-3610"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">GenNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3611"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GeneratorName</span> <span class="o">/=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3612"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimFuelCellGenerator: Invalid GeneratorIndex passed=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">GenNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3613"></a>                            <span class="s1">&#39;, Generator name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Generator Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3614"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3615"></a>      <span class="n">ENDIF</span>
<a name="ln-3616"></a>      <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3617"></a>    <span class="n">ENDIF</span>
<a name="ln-3618"></a>  <span class="n">ENDIF</span>
<a name="ln-3619"></a>
<a name="ln-3620"></a>  <span class="k">Call </span><span class="n">InitFuelCellGenerators</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)</span>
<a name="ln-3621"></a>
<a name="ln-3622"></a>  <span class="k">CALL </span><span class="n">CalcFuelCellGeneratorModel</span><span class="p">(</span><span class="n">GenNum</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-3623"></a>
<a name="ln-3624"></a>  <span class="k">CALL </span><span class="n">CalcUpdateHeatRecovery</span><span class="p">(</span><span class="n">GenNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-3625"></a>
<a name="ln-3626"></a>  <span class="k">CALL </span><span class="n">UpdateFuelCellGeneratorRecords</span><span class="p">(</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">GenNum</span><span class="p">)</span>
<a name="ln-3627"></a>
<a name="ln-3628"></a><span class="k">RETURN</span>
<a name="ln-3629"></a><span class="k">END SUBROUTINE </span><span class="n">SimFuelCellGenerator</span>
<a name="ln-3630"></a>
<a name="ln-3631"></a><span class="c">! End FuelCell Generator Module Driver Subroutines</span>
<a name="ln-3632"></a><span class="c">!******************************************************************************</span>
<a name="ln-3633"></a>
<a name="ln-3634"></a>
<a name="ln-3635"></a><span class="c">! Beginning of FuelCell Generator Module Get Input subroutines</span>
<a name="ln-3636"></a><span class="c">!******************************************************************************</span>
<a name="ln-3637"></a>
<a name="ln-3638"></a>
<a name="ln-3639"></a><span class="k">SUBROUTINE </span><span class="n">GetFuelCellGeneratorInput</span>
<a name="ln-3640"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3641"></a>            <span class="c">!       AUTHOR:          Brent Griffith</span>
<a name="ln-3642"></a>            <span class="c">!       DATE WRITTEN:    April 2005</span>
<a name="ln-3643"></a>
<a name="ln-3644"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3645"></a>            <span class="c">! This routine will get the input</span>
<a name="ln-3646"></a>            <span class="c">! required by the FuelCell Generator models.</span>
<a name="ln-3647"></a>
<a name="ln-3648"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3649"></a>            <span class="c">! EnergyPlus input processor</span>
<a name="ln-3650"></a>
<a name="ln-3651"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-3652"></a>
<a name="ln-3653"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-3654"></a>  <span class="k">USE </span><span class="n">DataGenerators</span>
<a name="ln-3655"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">SameString</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3656"></a>                             <span class="n">FindItem</span>
<a name="ln-3657"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>  <span class="c">! Data for field names, blank numerics</span>
<a name="ln-3658"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>   <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetCurveIndex</span>
<a name="ln-3659"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-3660"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-3661"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">Zone</span><span class="p">,</span> <span class="n">IntGainTypeOf_GeneratorFuelCell</span>
<a name="ln-3662"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span>
<a name="ln-3663"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-3664"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DisplayAdvancedReportVariables</span>
<a name="ln-3665"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-3666"></a>
<a name="ln-3667"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">!</span>
<a name="ln-3668"></a>
<a name="ln-3669"></a>            <span class="c">! PARAMETERS</span>
<a name="ln-3670"></a>
<a name="ln-3671"></a>            <span class="c">!LOCAL VARIABLES</span>
<a name="ln-3672"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">GeneratorNum</span> <span class="c">!Generator counter</span>
<a name="ln-3673"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumAlphas</span>  <span class="c">! Number of elements in the alpha array</span>
<a name="ln-3674"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumNums</span>    <span class="c">! Number of elements in the numeric array</span>
<a name="ln-3675"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">IOStat</span>     <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-3676"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">AlphArray</span> <span class="c">!character string data</span>
<a name="ln-3677"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>                        <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NumArray</span>  <span class="c">!numeric data TODO deal with allocatable for extensible</span>
<a name="ln-3678"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! error flag</span>
<a name="ln-3679"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsNotOK</span>              <span class="c">! Flag to verify name</span>
<a name="ln-3680"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsBlank</span>              <span class="c">! Flag for blank name</span>
<a name="ln-3681"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">NumFuelCellPMs</span>           <span class="c">! number of power subsystems in input file</span>
<a name="ln-3682"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">NumFuelCellAirSups</span>       <span class="c">! number of air supply subsystems in input file</span>
<a name="ln-3683"></a><span class="c">!  INTEGER       :: NumFuelCellFuelSups      ! number of fuel supply subsystems in input file</span>
<a name="ln-3684"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">NumFCWaterSups</span>       <span class="c">! number of water supply subsystems in input file</span>
<a name="ln-3685"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">NumFuelCellAuxilHeaters</span>
<a name="ln-3686"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">NumFCExhaustGasHXs</span>
<a name="ln-3687"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">NumFCElecStorageUnits</span> <span class="c">!number of electrical storage objects in input file</span>
<a name="ln-3688"></a><span class="c">!  INTEGER       :: NumBatteries  !number of Manwell and McGowan battery data objects</span>
<a name="ln-3689"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">NumFCPowerCondUnits</span>  <span class="c">! number of power conditioning units (inverter)</span>
<a name="ln-3690"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">NumFCStackCoolers</span>    <span class="c">! number of stack coolers.</span>
<a name="ln-3691"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">NumAirConstit</span>        <span class="c">! number of gas constituents in air</span>
<a name="ln-3692"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">FCPMNum</span>   <span class="c">!loop counter over power subsystems</span>
<a name="ln-3693"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">FCAirSupNum</span> <span class="c">!loop counter over air supply subsystems</span>
<a name="ln-3694"></a><span class="c">!  INTEGER       :: FCFuelSupNum !loop counter over fuel supply subsystems</span>
<a name="ln-3695"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">ConstitNum</span> <span class="c">! loop counter for consituents</span>
<a name="ln-3696"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">FCWaterSupNum</span> <span class="c">!loop counter over water supply subsystems</span>
<a name="ln-3697"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">FCHXNum</span> <span class="c">!loop counter for heat exchangers</span>
<a name="ln-3698"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">FCAuxHeatNum</span>  <span class="c">!loop counter over auxiliar heater</span>
<a name="ln-3699"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">FCPCUNum</span>      <span class="c">!loop counter over inverters</span>
<a name="ln-3700"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">StorageNum</span>    <span class="c">!loop counter over electrical storage subsystems</span>
<a name="ln-3701"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">FCScoolNum</span>    <span class="c">! loop counter over stack coolers</span>
<a name="ln-3702"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">thisFuelCell</span>  <span class="c">!temporary index</span>
<a name="ln-3703"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">otherFuelCell</span> <span class="c">!loop counter and temporary indexer</span>
<a name="ln-3704"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">I</span>   <span class="c">! loop counter</span>
<a name="ln-3705"></a>  <span class="kt">Logical</span><span class="p">,</span> <span class="k">SAve</span> <span class="kd">::</span> <span class="n">myonetimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3706"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">thisname</span>
<a name="ln-3707"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">NumHardCodedConstituents</span>
<a name="ln-3708"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">thisConstituent</span>
<a name="ln-3709"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">thisGasID</span>
<a name="ln-3710"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">FuelSupNum</span>
<a name="ln-3711"></a>
<a name="ln-3712"></a>  <span class="c">! execution</span>
<a name="ln-3713"></a><span class="k">If</span> <span class="p">(</span><span class="n">myonetimeflag</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3714"></a>
<a name="ln-3715"></a><span class="k">  </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Generator:FuelCell&#39;</span>
<a name="ln-3716"></a>  <span class="n">NumFuelCellGenerators</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-3717"></a>
<a name="ln-3718"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumFuelCellGenerators</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3719"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; equipment specified in input file&#39;</span><span class="p">)</span>
<a name="ln-3720"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3721"></a>  <span class="n">ENDIF</span>
<a name="ln-3722"></a>
<a name="ln-3723"></a>         <span class="c">!ALLOCATE ARRAYS</span>
<a name="ln-3724"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">NumFuelCellGenerators</span><span class="p">))</span>  <span class="c">! inits handeled in derived type definitions</span>
<a name="ln-3725"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">NumFuelCellGenerators</span><span class="p">))</span>
<a name="ln-3726"></a>  <span class="n">CheckEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3727"></a>
<a name="ln-3728"></a>  <span class="c">! first load in FuelCell names</span>
<a name="ln-3729"></a>  <span class="k">DO </span><span class="n">GeneratorNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumFuelCellGenerators</span>
<a name="ln-3730"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">GeneratorNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3731"></a>                    <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3732"></a>                    <span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-3733"></a>
<a name="ln-3734"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3735"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3736"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">GeneratorNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-3737"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3738"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3739"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-3740"></a>    <span class="n">ENDIF</span>
<a name="ln-3741"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span>                <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3742"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">NameFCPM</span>            <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3743"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">NameFCAirSup</span>        <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3744"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">NameFCFuelSup</span>       <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-3745"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">NameFCWaterSup</span>      <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-3746"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">NameFCAuxilHeat</span>     <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-3747"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">NameExhaustHX</span>       <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-3748"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">NameElecStorage</span>     <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-3749"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">NameInverter</span>        <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-3750"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">numAlphas</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3751"></a><span class="k">      </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">NameStackCooler</span>     <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-3752"></a>    <span class="n">ENDIF</span>
<a name="ln-3753"></a>  <span class="n">ENDDO</span>
<a name="ln-3754"></a>
<a name="ln-3755"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Generator:FuelCell:PowerModule&#39;</span>
<a name="ln-3756"></a>  <span class="n">NumFuelCellPMs</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-3757"></a>
<a name="ln-3758"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumFuelCellPMs</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3759"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; equipment specified in input file&#39;</span><span class="p">)</span>
<a name="ln-3760"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3761"></a>  <span class="n">ENDIF</span>
<a name="ln-3762"></a>
<a name="ln-3763"></a>
<a name="ln-3764"></a>  <span class="k">DO </span><span class="n">FCPMNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumFuelCellPMs</span>
<a name="ln-3765"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">FCPMNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3766"></a>                    <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3767"></a>                    <span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-3768"></a>
<a name="ln-3769"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3770"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3771"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">FCPMNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-3772"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3773"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3774"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-3775"></a>    <span class="n">ENDIF</span>
<a name="ln-3776"></a>
<a name="ln-3777"></a>    <span class="n">thisFuelCell</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">NameFCPM</span><span class="p">,</span><span class="n">NumFuelCellGenerators</span><span class="p">)</span>
<a name="ln-3778"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">thisFuelCell</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!cr9323</span>
<a name="ln-3779"></a>
<a name="ln-3780"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3781"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;ANNEX42&#39;</span><span class="p">))</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">EffMode</span> <span class="o">=</span> <span class="n">DirectCurveMode</span>
<a name="ln-3782"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameSTring</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;NORMALIZED&#39;</span><span class="p">))</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">EffMode</span> <span class="o">=</span> <span class="n">NormalizedCurveMode</span>
<a name="ln-3783"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">EffMode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3784"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3785"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3786"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3787"></a>      <span class="n">ENDIF</span>
<a name="ln-3788"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">EffCurveID</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-3789"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">EffCurveID</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3790"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3791"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3792"></a>         <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3793"></a>      <span class="n">ENDIF</span>
<a name="ln-3794"></a>
<a name="ln-3795"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NomEff</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3796"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NomPel</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3797"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NumCycles</span>        <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3798"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">CyclingDegradRat</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-3799"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NumRunHours</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-3800"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">OperateDegradRat</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-3801"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ThreshRunHours</span>   <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-3802"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">UpTranLimit</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-3803"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DownTranLimit</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-3804"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">StartUpTime</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="n">SecInHour</span> <span class="c">!convert to hours from seconds</span>
<a name="ln-3805"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">StartUpFuel</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-3806"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">StartUpElectConsum</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-3807"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">StartUpElectProd</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-3808"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ShutDownTime</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span><span class="o">/</span><span class="n">SecInHour</span> <span class="c">!convert to hours from seconds</span>
<a name="ln-3809"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ShutDownFuel</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-3810"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ShutDownElectConsum</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-3811"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ANC0</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-3812"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ANC1</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-3813"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;ConstantRate&#39;</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-3814"></a>                   <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">SkinLossMode</span> <span class="o">=</span> <span class="n">ConstantRateSkinLoss</span>
<a name="ln-3815"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;UAForProcessGasTemperature&#39;</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-3816"></a>                   <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">SkinLossMode</span> <span class="o">=</span> <span class="n">UADTSkinLoss</span>
<a name="ln-3817"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;QUADRATIC FUNCTION OF FUEL RATE&#39;</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-3818"></a>                   <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">SkinLossMode</span> <span class="o">=</span> <span class="n">QuadraticFuelNdotSkin</span>
<a name="ln-3819"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">SkinLossMode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3820"></a>         <span class="c">!throw error</span>
<a name="ln-3821"></a>         <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-3822"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3823"></a>         <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3824"></a>
<a name="ln-3825"></a>      <span class="n">ENDIF</span>
<a name="ln-3826"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ZoneName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-3827"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ZoneID</span>   <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ZoneName</span><span class="p">,</span> <span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-3828"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ZoneID</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3829"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-3830"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3831"></a>         <span class="k">Call </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Zone Name was not found &#39;</span><span class="p">)</span>
<a name="ln-3832"></a>         <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3833"></a>      <span class="n">ENDIF</span>
<a name="ln-3834"></a>
<a name="ln-3835"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">RadiativeFract</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="ln-3836"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">QdotSkin</span>       <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-3837"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">UAskin</span>         <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<a name="ln-3838"></a>
<a name="ln-3839"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">SkinLossCurveID</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-3840"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">SkinLossCurveID</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3841"></a><span class="k">         If</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">SkinLossMode</span> <span class="o">==</span> <span class="n">QuadraticFuelNdotSkin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3842"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-3843"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3844"></a>           <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3845"></a>         <span class="n">ENDIF</span>
<a name="ln-3846"></a>      <span class="n">ENDIF</span>
<a name="ln-3847"></a>
<a name="ln-3848"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotDilutionAir</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
<a name="ln-3849"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">StackHeatLossToDilution</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<a name="ln-3850"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DilutionInletNodeName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-3851"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DilutionInletNode</span> <span class="o">=</span>     <span class="p">&amp;</span>
<a name="ln-3852"></a>                 <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3853"></a>                 <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3854"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DilutionExhaustNodeName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-3855"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DilutionExhaustNode</span> <span class="o">=</span>     <span class="p">&amp;</span>
<a name="ln-3856"></a>                 <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3857"></a>                 <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3858"></a>
<a name="ln-3859"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelMin</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-3860"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelMax</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<a name="ln-3861"></a>
<a name="ln-3862"></a>      <span class="c">!check for other FuelCell using the same power module and fill</span>
<a name="ln-3863"></a>      <span class="k">DO </span><span class="n">otherFuelCell</span> <span class="o">=</span> <span class="n">thisFuelCell</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumFuelCellGenerators</span>
<a name="ln-3864"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">otherFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Name</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3865"></a><span class="k">           </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">otherFuelCell</span><span class="p">)%</span><span class="n">FCPM</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">FCPM</span>
<a name="ln-3866"></a>        <span class="n">ENDIF</span>
<a name="ln-3867"></a>
<a name="ln-3868"></a>      <span class="n">ENDDO</span>
<a name="ln-3869"></a>    <span class="k">ELSE</span> <span class="c">! throw warning, did not find power module input</span>
<a name="ln-3870"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3871"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3872"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3873"></a>    <span class="n">ENDIF</span>
<a name="ln-3874"></a>  <span class="n">ENDDO</span> <span class="c">! loop over NumFuelCellPMs</span>
<a name="ln-3875"></a>
<a name="ln-3876"></a>  <span class="k">Call </span><span class="n">GetGeneratorFuelSupplyInput</span>
<a name="ln-3877"></a>
<a name="ln-3878"></a>  <span class="k">DO </span><span class="n">FuelSupNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumGeneratorFuelSups</span>
<a name="ln-3879"></a>    <span class="k">CAll </span><span class="n">SetupFuelConstituentData</span><span class="p">(</span><span class="n">FuelSupNum</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-3880"></a>  <span class="n">ENDDO</span>
<a name="ln-3881"></a>
<a name="ln-3882"></a> <span class="c">!set fuel supply ID in Fuel cell structure</span>
<a name="ln-3883"></a>  <span class="k">DO </span><span class="n">GeneratorNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumFuelCellGenerators</span>
<a name="ln-3884"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span>  <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3885"></a>       <span class="n">FindItemInList</span><span class="p">(</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">NameFCFuelSup</span> <span class="p">,</span> <span class="n">FuelSupply</span><span class="p">%</span><span class="n">name</span><span class="p">,</span><span class="n">NumGeneratorFuelSups</span><span class="p">)</span> <span class="c">! Fuel Supply ID</span>
<a name="ln-3886"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3887"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Fuel Supply Name: &#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">NameFCFuelSup</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3888"></a>            <span class="o">//</span><span class="s1">&#39; not found in &#39;</span> <span class="o">//</span>   <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-3889"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3890"></a>    <span class="n">ENDIF</span>
<a name="ln-3891"></a>  <span class="n">ENDDO</span>
<a name="ln-3892"></a>
<a name="ln-3893"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Generator:FuelCell:AirSupply&#39;</span>
<a name="ln-3894"></a>  <span class="n">NumFuelCellAirSups</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-3895"></a>
<a name="ln-3896"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumFuelCellAirSups</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3897"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; equipment specified in input file&#39;</span><span class="p">)</span>
<a name="ln-3898"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3899"></a>  <span class="n">ENDIF</span>
<a name="ln-3900"></a>
<a name="ln-3901"></a>  <span class="k">DO </span><span class="n">FCAirSupNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumFuelCellAirSups</span>
<a name="ln-3902"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">FCAirSupNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3903"></a>                    <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3904"></a>                    <span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-3905"></a>
<a name="ln-3906"></a>
<a name="ln-3907"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3908"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3909"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">FCAirSupNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-3910"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3911"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3912"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-3913"></a>    <span class="n">ENDIF</span>
<a name="ln-3914"></a>
<a name="ln-3915"></a>    <span class="n">thisFuelCell</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">NameFCAirSup</span><span class="p">,</span><span class="n">NumFuelCellGenerators</span><span class="p">)</span>
<a name="ln-3916"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">thisFuelCell</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3917"></a>
<a name="ln-3918"></a><span class="k">      </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">Name</span>     <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3919"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">NodeName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3920"></a>
<a name="ln-3921"></a>       <span class="c">! check the node connections</span>
<a name="ln-3922"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">SupNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3923"></a>                 <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3924"></a>                 <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3925"></a>
<a name="ln-3926"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">BlowerPowerCurveID</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-3927"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">BlowerPowerCurveID</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3928"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3929"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3930"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve name was not found &#39;</span><span class="p">)</span>
<a name="ln-3931"></a>        <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3932"></a>      <span class="n">ENDIF</span>
<a name="ln-3933"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">BlowerHeatLossFactor</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3934"></a>
<a name="ln-3935"></a>      <span class="k">IF</span>      <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;AirRatiobyStoics&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3936"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">AirSupRateMode</span> <span class="o">=</span> <span class="n">ConstantStoicsAirRat</span>
<a name="ln-3937"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;QuadraticFunctionofElectricPower&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3938"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">AirSupRateMode</span> <span class="o">=</span> <span class="n">QuadraticFuncofPel</span>
<a name="ln-3939"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;QUADRATIC FUNCTION OF FUEL RATE&#39;</span><span class="p">))</span>   <span class="k">THEN</span>
<a name="ln-3940"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">AirSupRateMode</span> <span class="o">=</span> <span class="n">QuadraticFuncofNdot</span>
<a name="ln-3941"></a>      <span class="k">ELSE</span>
<a name="ln-3942"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-3943"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3944"></a>        <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3945"></a>      <span class="n">ENDIF</span>
<a name="ln-3946"></a>
<a name="ln-3947"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">Stoics</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0d0</span>  <span class="c">!</span>
<a name="ln-3948"></a>
<a name="ln-3949"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">AirFuncPelCurveID</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-3950"></a>      <span class="k">If</span> <span class="p">((</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">AirFuncPelCurveID</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3951"></a>          <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">AirSupRateMode</span> <span class="o">==</span> <span class="n">QuadraticFuncofPel</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-3952"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-3953"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3954"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Curve name was not found&#39;</span><span class="p">)</span>
<a name="ln-3955"></a>        <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3956"></a>      <span class="n">ENDIF</span>
<a name="ln-3957"></a>
<a name="ln-3958"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">AirTempCoeff</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3959"></a>
<a name="ln-3960"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">AirFuncNdotCurveID</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-3961"></a>      <span class="k">If</span> <span class="p">((</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">AirFuncNdotCurveID</span> <span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3962"></a>          <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">AirSupRateMode</span> <span class="o">==</span> <span class="n">QuadraticFuncofNdot</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-3963"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-3964"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3965"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Curve name was not found&#39;</span><span class="p">)</span>
<a name="ln-3966"></a>        <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3967"></a>      <span class="n">ENDIF</span>
<a name="ln-3968"></a>
<a name="ln-3969"></a>      <span class="k">If</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;RecoverBurnerInverterStorage&#39;</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-3970"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">IntakeRecoveryMode</span> <span class="o">=</span> <span class="n">RecoverBurnInvertBatt</span>
<a name="ln-3971"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;RecoverAuxiliaryBurner&#39;</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-3972"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">IntakeRecoveryMode</span> <span class="o">=</span> <span class="n">RecoverAuxiliaryBurner</span>
<a name="ln-3973"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;RecoverInverterandStorage&#39;</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-3974"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">IntakeRecoveryMode</span> <span class="o">=</span> <span class="n">RecoverInverterBatt</span>
<a name="ln-3975"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;RecoverInverter&#39;</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-3976"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">IntakeRecoveryMode</span> <span class="o">=</span> <span class="n">RecoverInverter</span>
<a name="ln-3977"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;RecoverElectricalStorage&#39;</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-3978"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">IntakeRecoveryMode</span> <span class="o">=</span> <span class="n">RecoverBattery</span>
<a name="ln-3979"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;NoRecovery&#39;</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-3980"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">IntakeRecoveryMode</span> <span class="o">=</span> <span class="n">NoRecoveryOnAirIntake</span>
<a name="ln-3981"></a>      <span class="k">ELSE</span>
<a name="ln-3982"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-3983"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3984"></a>        <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3985"></a>      <span class="n">ENDIF</span>
<a name="ln-3986"></a>
<a name="ln-3987"></a>
<a name="ln-3988"></a>      <span class="k">If</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;AmbientAir&#39;</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-3989"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstituentMode</span> <span class="o">=</span> <span class="n">RegularAir</span>
<a name="ln-3990"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;UserDefinedConstituents&#39;</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-3991"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstituentMode</span> <span class="o">=</span> <span class="n">UserDefinedConstituents</span>
<a name="ln-3992"></a>      <span class="k">ELSE</span>
<a name="ln-3993"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-3994"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3995"></a>        <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3996"></a>      <span class="n">ENDIF</span>
<a name="ln-3997"></a>
<a name="ln-3998"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstituentMode</span> <span class="o">==</span> <span class="n">UserDefinedConstituents</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3999"></a><span class="k">        </span><span class="n">NumAirConstit</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-4000"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">NumConstituents</span> <span class="o">=</span><span class="n">NumAirConstit</span>
<a name="ln-4001"></a>
<a name="ln-4002"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NumAirConstit</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4003"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-4004"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4005"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Fuel Cell model not set up for more than 5 air constituents&#39;</span><span class="p">)</span>
<a name="ln-4006"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4007"></a>        <span class="n">ENDIF</span>
<a name="ln-4008"></a>
<a name="ln-4009"></a>        <span class="k">DO </span><span class="n">ConstitNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumAirConstit</span>
<a name="ln-4010"></a>          <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitName</span><span class="p">(</span><span class="n">ConstitNum</span><span class="p">)</span>       <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="n">ConstitNum</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span>
<a name="ln-4011"></a>          <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">ConstitNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="n">ConstitNum</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
<a name="ln-4012"></a>
<a name="ln-4013"></a>        <span class="n">ENDDO</span>
<a name="ln-4014"></a>
<a name="ln-4015"></a>      <span class="k">ELSE</span>  <span class="c">!regular air</span>
<a name="ln-4016"></a>        <span class="n">NumAirConstit</span>  <span class="o">=</span> <span class="mi">5</span>
<a name="ln-4017"></a>
<a name="ln-4018"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">NumConstituents</span> <span class="o">=</span> <span class="n">NumAirConstit</span>
<a name="ln-4019"></a>
<a name="ln-4020"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitName</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>       <span class="o">=</span> <span class="s1">&#39;Nitrogen&#39;</span>
<a name="ln-4021"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.7728d0</span>
<a name="ln-4022"></a>
<a name="ln-4023"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitName</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>       <span class="o">=</span> <span class="s1">&#39;Oxygen&#39;</span>
<a name="ln-4024"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.2073d0</span>
<a name="ln-4025"></a>
<a name="ln-4026"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitName</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>       <span class="o">=</span> <span class="s1">&#39;Water&#39;</span>
<a name="ln-4027"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0104d0</span>
<a name="ln-4028"></a>
<a name="ln-4029"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitName</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>       <span class="o">=</span> <span class="s1">&#39;Argon&#39;</span>
<a name="ln-4030"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0092d0</span>
<a name="ln-4031"></a>
<a name="ln-4032"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitName</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>       <span class="o">=</span> <span class="s1">&#39;CarbonDioxide&#39;</span>
<a name="ln-4033"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0003d0</span>
<a name="ln-4034"></a>
<a name="ln-4035"></a>      <span class="n">ENDIF</span>
<a name="ln-4036"></a>
<a name="ln-4037"></a>      <span class="c">! check for molar fractions summing to 1.0.</span>
<a name="ln-4038"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="nb">SUM</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">0001</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4039"></a>
<a name="ln-4040"></a><span class="k">        CALL </span><span class="n">showSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; molar fractions do not sum to 1.0&#39;</span> <span class="p">)</span>
<a name="ln-4041"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Sum was=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">SUM</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">),</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4042"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4043"></a>        <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4044"></a>      <span class="n">ENDIF</span>
<a name="ln-4045"></a>
<a name="ln-4046"></a>      <span class="c">!check for other FuelCell using the same Air Supply module and fill</span>
<a name="ln-4047"></a>      <span class="k">DO </span><span class="n">otherFuelCell</span> <span class="o">=</span> <span class="n">thisFuelCell</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumFuelCellGenerators</span>
<a name="ln-4048"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">otherFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">Name</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4049"></a><span class="k">           </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">otherFuelCell</span><span class="p">)%</span><span class="n">AirSup</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AirSup</span>
<a name="ln-4050"></a>        <span class="n">ENDIF</span>
<a name="ln-4051"></a>      <span class="n">ENDDO</span>
<a name="ln-4052"></a>    <span class="k">ELSE</span>
<a name="ln-4053"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4054"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4055"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4056"></a>    <span class="n">ENDIF</span>
<a name="ln-4057"></a>
<a name="ln-4058"></a>  <span class="n">ENDDO</span>
<a name="ln-4059"></a>
<a name="ln-4060"></a>  <span class="k">DO </span><span class="n">GeneratorNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumFuelCellGenerators</span>
<a name="ln-4061"></a>    <span class="c">! find molal fraction of oxygen in air supply</span>
<a name="ln-4062"></a>    <span class="n">thisConstituent</span> <span class="o">=</span> <span class="n">FindItem</span><span class="p">(</span><span class="s1">&#39;Oxygen&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4063"></a>                                               <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">NumConstituents</span><span class="p">)</span>
<a name="ln-4064"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">thisConstituent</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">O2fraction</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4065"></a>       <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisConstituent</span><span class="p">)</span>
<a name="ln-4066"></a>
<a name="ln-4067"></a>    <span class="n">NumHardCodedConstituents</span> <span class="o">=</span> <span class="mi">14</span>
<a name="ln-4068"></a>
<a name="ln-4069"></a>    <span class="c">! Loop over air constituents and do one-time setup</span>
<a name="ln-4070"></a>    <span class="k">DO </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">NumConstituents</span>
<a name="ln-4071"></a>
<a name="ln-4072"></a>      <span class="n">thisName</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitName</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-4073"></a>
<a name="ln-4074"></a>      <span class="n">thisGasID</span> <span class="o">=</span> <span class="n">FindItem</span><span class="p">(</span><span class="n">thisName</span><span class="p">,</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">%</span><span class="n">ConstituentName</span><span class="p">,</span> <span class="n">NumHardCodedConstituents</span><span class="p">)</span>
<a name="ln-4075"></a>
<a name="ln-4076"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">thisGasID</span>
<a name="ln-4077"></a>
<a name="ln-4078"></a>    <span class="n">ENDDO</span>
<a name="ln-4079"></a>
<a name="ln-4080"></a>    <span class="c">!set up gas constiuents for product gases</span>
<a name="ln-4081"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">!Carbon Dioxide</span>
<a name="ln-4082"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">!Nitrogen</span>
<a name="ln-4083"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">3</span> <span class="c">!Oxygen</span>
<a name="ln-4084"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mi">4</span> <span class="c">!Water</span>
<a name="ln-4085"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mi">5</span> <span class="c">!Argon</span>
<a name="ln-4086"></a>  <span class="n">ENDDO</span>
<a name="ln-4087"></a>
<a name="ln-4088"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Generator:FuelCell:WaterSupply&#39;</span>
<a name="ln-4089"></a>  <span class="n">NumFCWaterSups</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-4090"></a>
<a name="ln-4091"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumFCWaterSups</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4092"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; equipment specified in input file&#39;</span><span class="p">)</span>
<a name="ln-4093"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4094"></a>  <span class="n">ENDIF</span>
<a name="ln-4095"></a>
<a name="ln-4096"></a>  <span class="k">DO </span><span class="n">FCWaterSupNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumFCWaterSups</span>
<a name="ln-4097"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">FCWaterSupNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4098"></a>                    <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4099"></a>                    <span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-4100"></a>
<a name="ln-4101"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4102"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4103"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">FCWaterSupNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-4104"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4105"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4106"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-4107"></a>    <span class="n">ENDIF</span>
<a name="ln-4108"></a>
<a name="ln-4109"></a>    <span class="n">thisFuelCell</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">NameFCWaterSup</span><span class="p">,</span><span class="n">NumFuelCellGenerators</span><span class="p">)</span>
<a name="ln-4110"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">thisFuelCell</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4111"></a>     <span class="c">!  this is only the first instance of a FuelCell generator using this type of Water supply module</span>
<a name="ln-4112"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4113"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">WaterSupRateCurveID</span> <span class="o">=</span>  <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4114"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">WaterSupRateCurveID</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4115"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-4116"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4117"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve name was not found &#39;</span><span class="p">)</span>
<a name="ln-4118"></a>        <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4119"></a>      <span class="n">ENDIF</span>
<a name="ln-4120"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">PmpPowerCurveID</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-4121"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">PmpPowerCurveID</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4122"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4123"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4124"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve name was not found &#39;</span><span class="p">)</span>
<a name="ln-4125"></a>        <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4126"></a>      <span class="n">ENDIF</span>
<a name="ln-4127"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">PmpPowerLossFactor</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4128"></a>
<a name="ln-4129"></a>  <span class="c">!!CR9240?</span>
<a name="ln-4130"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;TemperatureFromAirNode&#39;</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-4131"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">WaterTempMode</span> <span class="o">=</span> <span class="n">WaterInReformAirNode</span>
<a name="ln-4132"></a>
<a name="ln-4133"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">NodeName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4134"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">NodeNum</span>  <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4135"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4136"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Sensor</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-4137"></a>
<a name="ln-4138"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;TemperatureFromWaterNode&#39;</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-4139"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">WaterTempMode</span> <span class="o">=</span> <span class="n">WaterInReformWaterNode</span>
<a name="ln-4140"></a>
<a name="ln-4141"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">NodeName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4142"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">NodeNum</span>  <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4143"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4144"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Sensor</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-4145"></a>
<a name="ln-4146"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;MainsWaterTemperature&#39;</span> <span class="p">,</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span> <span class="k">Then</span>
<a name="ln-4147"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">WaterTempMode</span> <span class="o">=</span> <span class="n">WaterInReformMains</span>
<a name="ln-4148"></a>
<a name="ln-4149"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;TemperatureFromSchedule&#39;</span><span class="p">,</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-4150"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">WaterTempMode</span> <span class="o">=</span> <span class="n">WaterInReformSchedule</span>
<a name="ln-4151"></a>      <span class="k">ELSE</span>
<a name="ln-4152"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-4153"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4154"></a>        <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4155"></a>      <span class="n">ENDIF</span>
<a name="ln-4156"></a>
<a name="ln-4157"></a>
<a name="ln-4158"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">SchedNum</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-4159"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">SchedNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4160"></a>         <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">WaterTempMode</span> <span class="o">==</span> <span class="n">WaterInReformSchedule</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4161"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-4162"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4163"></a>        <span class="k">CAll </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Schedule was not found&#39;</span><span class="p">)</span>
<a name="ln-4164"></a>        <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4165"></a>      <span class="n">ENDIF</span>
<a name="ln-4166"></a>
<a name="ln-4167"></a>
<a name="ln-4168"></a>      <span class="c">!check for other FuelCell using the same Water Supply module and fill</span>
<a name="ln-4169"></a>      <span class="k">DO </span><span class="n">otherFuelCell</span> <span class="o">=</span> <span class="n">thisFuelCell</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumFuelCellGenerators</span>
<a name="ln-4170"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">otherFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">Name</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4171"></a><span class="k">           </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">otherFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">WaterSup</span>
<a name="ln-4172"></a>        <span class="n">ENDIF</span>
<a name="ln-4173"></a>      <span class="n">ENDDO</span>
<a name="ln-4174"></a>    <span class="k">ELSE</span>
<a name="ln-4175"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4176"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4177"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4178"></a>    <span class="n">ENDIF</span>
<a name="ln-4179"></a>
<a name="ln-4180"></a>  <span class="n">ENDDO</span>
<a name="ln-4181"></a>
<a name="ln-4182"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Generator:FuelCell:AuxiliaryHeater&#39;</span>
<a name="ln-4183"></a>  <span class="n">NumFuelCellAuxilHeaters</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-4184"></a>
<a name="ln-4185"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumFuelCellAuxilHeaters</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4186"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; equipment specified in input file&#39;</span><span class="p">)</span>
<a name="ln-4187"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4188"></a>  <span class="n">ENDIF</span>
<a name="ln-4189"></a>
<a name="ln-4190"></a>  <span class="k">DO </span><span class="n">FCAuxHeatNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumFuelCellAuxilHeaters</span>
<a name="ln-4191"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">FCAuxHeatNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4192"></a>                    <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4193"></a>                    <span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-4194"></a>
<a name="ln-4195"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4196"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4197"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">FCAuxHeatNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-4198"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4199"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4200"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-4201"></a>    <span class="n">ENDIF</span>
<a name="ln-4202"></a>
<a name="ln-4203"></a>    <span class="n">thisFuelCell</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">NameFCAuxilHeat</span><span class="p">,</span><span class="n">NumFuelCellGenerators</span><span class="p">)</span>
<a name="ln-4204"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">thisFuelCell</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4205"></a><span class="k">      </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4206"></a>
<a name="ln-4207"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">ExcessAirRAT</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4208"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">ANC0</span>         <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4209"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">ANC1</span>         <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4210"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">UASkin</span>       <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-4211"></a>
<a name="ln-4212"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;SurroundingZone&#39;</span><span class="p">,</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span> <span class="k">Then</span>
<a name="ln-4213"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">SkinLossDestination</span>  <span class="o">=</span> <span class="n">SurroundingZone</span>
<a name="ln-4214"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;AirInletForFuelCell&#39;</span><span class="p">,</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span> <span class="k">Then</span>
<a name="ln-4215"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">SkinLossDestination</span>  <span class="o">=</span>  <span class="n">AirInletForFC</span>
<a name="ln-4216"></a>      <span class="k">ELSE</span>
<a name="ln-4217"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-4218"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4219"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4220"></a>      <span class="n">ENDIF</span>
<a name="ln-4221"></a>
<a name="ln-4222"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">ZoneName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4223"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">ZoneID</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">Zone</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-4224"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">ZoneID</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span>    <span class="p">&amp;</span>
<a name="ln-4225"></a>         <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">SkinLossDestination</span> <span class="o">==</span> <span class="n">SurroundingZone</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4226"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4227"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4228"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Zone name was not found &#39;</span><span class="p">)</span>
<a name="ln-4229"></a>        <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4230"></a>      <span class="n">ENDIF</span>
<a name="ln-4231"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">MaxPowerW</span>   <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4232"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">MinPowerW</span>   <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4233"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">MaxPowerkmolperSec</span>   <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-4234"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">MinPowerkmolperSec</span>   <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-4235"></a>
<a name="ln-4236"></a>      <span class="c">! TODO finish Auxiliary heater</span>
<a name="ln-4237"></a>
<a name="ln-4238"></a>      <span class="c">!check for other FuelCell using the same Auxiliary Heating module and fill</span>
<a name="ln-4239"></a>      <span class="k">DO </span><span class="n">otherFuelCell</span> <span class="o">=</span> <span class="n">thisFuelCell</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumFuelCellGenerators</span>
<a name="ln-4240"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">otherFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">Name</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4241"></a><span class="k">           </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">otherFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">AuxilHeat</span>
<a name="ln-4242"></a>        <span class="n">ENDIF</span>
<a name="ln-4243"></a>      <span class="n">ENDDO</span>
<a name="ln-4244"></a>    <span class="k">ELSE</span>
<a name="ln-4245"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4246"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4247"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4248"></a>    <span class="n">ENDIF</span>
<a name="ln-4249"></a>
<a name="ln-4250"></a>  <span class="n">ENDDO</span>
<a name="ln-4251"></a>
<a name="ln-4252"></a>  <span class="c">! exhaust gas heat exchanger</span>
<a name="ln-4253"></a>  <span class="n">cCurrentModuleObject</span>  <span class="o">=</span> <span class="s1">&#39;Generator:FuelCell:ExhaustGasToWaterHeatExchanger&#39;</span>
<a name="ln-4254"></a>  <span class="n">NumFCExhaustGasHXs</span>    <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-4255"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumFCExhaustGasHXs</span>  <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4256"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;No &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; equipment specified in input file&#39;</span><span class="p">)</span>
<a name="ln-4257"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Fuel Cell model requires an &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; object&#39;</span><span class="p">)</span>
<a name="ln-4258"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4259"></a>  <span class="n">ENDIF</span>
<a name="ln-4260"></a>
<a name="ln-4261"></a>  <span class="k">DO </span><span class="n">FCHXNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumFCExhaustGasHXs</span>
<a name="ln-4262"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">FCHXNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4263"></a>                    <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4264"></a>                    <span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-4265"></a>
<a name="ln-4266"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4267"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4268"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">FCHXNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4269"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-4270"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4271"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4272"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-4273"></a>    <span class="n">ENDIF</span>
<a name="ln-4274"></a>
<a name="ln-4275"></a>    <span class="n">thisFuelCell</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">NameExhaustHX</span><span class="p">,</span><span class="n">NumFuelCellGenerators</span><span class="p">)</span>
<a name="ln-4276"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">thisFuelCell</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4277"></a><span class="k">      </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">Name</span>            <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4278"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInNodeName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4279"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterOutNodeName</span><span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4280"></a>      <span class="c">!find node ids for water path</span>
<a name="ln-4281"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInNode</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-4282"></a>                 <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4283"></a>                 <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span> <span class="p">)</span>
<a name="ln-4284"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterOutNode</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-4285"></a>                 <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4286"></a>                 <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span> <span class="p">)</span>
<a name="ln-4287"></a>      <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-4288"></a>                              <span class="s1">&#39;Heat Recovery Nodes&#39;</span><span class="p">)</span>
<a name="ln-4289"></a>
<a name="ln-4290"></a>  <span class="c">!CR9240</span>
<a name="ln-4291"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">ExhaustOutNodeName</span> <span class="o">=</span>  <span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-4292"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">ExhaustOutNode</span>     <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4293"></a>                 <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4294"></a>                 <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span> <span class="p">)</span>
<a name="ln-4295"></a>
<a name="ln-4296"></a>      <span class="k">IF</span>     <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;FixedEffectiveness&#39;</span><span class="p">,</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-4297"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">HXmodelMode</span> <span class="o">=</span> <span class="n">FixedEffectiveness</span>
<a name="ln-4298"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;EmpiricalUAeff&#39;</span><span class="p">,</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-4299"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">HXmodelMode</span> <span class="o">=</span> <span class="n">LMTDempiricalUAeff</span>
<a name="ln-4300"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;FundementalUAeff&#39;</span><span class="p">,</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-4301"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">HXmodelMode</span> <span class="o">=</span> <span class="n">LMTDfundementalUAeff</span>
<a name="ln-4302"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="s1">&#39;CONDENSING&#39;</span><span class="p">,</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-4303"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">HXmodelMode</span> <span class="o">=</span> <span class="n">Condensing</span>
<a name="ln-4304"></a>      <span class="k">ELSE</span>
<a name="ln-4305"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-4306"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4307"></a>        <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4308"></a>
<a name="ln-4309"></a>      <span class="n">ENDIF</span>
<a name="ln-4310"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterVolumeFlowMax</span><span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4311"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">HXEffect</span>          <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4312"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">hxs0</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4313"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">hxs1</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-4314"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">hxs2</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4315"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">hxs3</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4316"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">hxs4</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-4317"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">h0gas</span>             <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-4318"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">NdotGasRef</span>        <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-4319"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">nCoeff</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-4320"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">AreaGas</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-4321"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">h0Water</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-4322"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">NdotWaterRef</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-4323"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">mCoeff</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-4324"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">AreaWater</span>         <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-4325"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">Fadjust</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-4326"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">l1Coeff</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-4327"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">l2Coeff</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-4328"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">CondensationThresholdTemp</span> <span class="o">=</span>  <span class="n">NumArray</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="ln-4329"></a>
<a name="ln-4330"></a>      <span class="c">! store cooling water volume flow rate for autosizing system</span>
<a name="ln-4331"></a>      <span class="k">CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4332"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterVolumeFlowMax</span> <span class="p">)</span>
<a name="ln-4333"></a>    <span class="k">ELSE</span>
<a name="ln-4334"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4335"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4336"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4337"></a>    <span class="n">ENDIF</span>
<a name="ln-4338"></a>  <span class="n">ENDDO</span>
<a name="ln-4339"></a>
<a name="ln-4340"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Generator:FuelCell:ElectricalStorage&#39;</span>
<a name="ln-4341"></a>  <span class="n">NumFCElecStorageUnits</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-4342"></a>
<a name="ln-4343"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">NumFCElecStorageUnits</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4344"></a><span class="k">    Call </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;No &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; equipment specified in input file&#39;</span><span class="p">)</span>
<a name="ln-4345"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Fuel Cell model requires an &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; object&#39;</span><span class="p">)</span>
<a name="ln-4346"></a>    <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4347"></a>  <span class="n">ENDIF</span>
<a name="ln-4348"></a>
<a name="ln-4349"></a>  <span class="k">DO </span><span class="n">StorageNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumFCElecStorageUnits</span>
<a name="ln-4350"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">StorageNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4351"></a>                    <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4352"></a>                    <span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-4353"></a>
<a name="ln-4354"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4355"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4356"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">StorageNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4357"></a>       <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-4358"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4359"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4360"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-4361"></a>    <span class="n">ENDIF</span>
<a name="ln-4362"></a>
<a name="ln-4363"></a>    <span class="n">thisFuelCell</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">NameElecStorage</span><span class="p">,</span><span class="n">NumFuelCellGenerators</span><span class="p">)</span>
<a name="ln-4364"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">thisFuelCell</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4365"></a><span class="k">      </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4366"></a>
<a name="ln-4367"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;SimpleEfficiencyWithConstraints&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4368"></a><span class="k">         </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">StorageModelMode</span>  <span class="o">=</span> <span class="n">SimpleEffConstraints</span>
<a name="ln-4369"></a>      <span class="k">ELSE</span>
<a name="ln-4370"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-4371"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4372"></a>        <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4373"></a>
<a name="ln-4374"></a>      <span class="n">ENDIF</span>
<a name="ln-4375"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">EnergeticEfficCharge</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4376"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">EnergeticEfficDischarge</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4377"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">NominalEnergyCapacity</span>   <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4378"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">MaxPowerDraw</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-4379"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">MaxPowerStore</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4380"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">StartingEnergyStored</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4381"></a>
<a name="ln-4382"></a>          <span class="c">!check for other FuelCell using the same Electrical Storage and fill</span>
<a name="ln-4383"></a>      <span class="k">DO </span><span class="n">otherFuelCell</span> <span class="o">=</span> <span class="n">thisFuelCell</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumFuelCellGenerators</span>
<a name="ln-4384"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">otherFuelCell</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">Name</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4385"></a><span class="k">           </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">otherFuelCell</span><span class="p">)%</span><span class="n">ElecStorage</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">ElecStorage</span>
<a name="ln-4386"></a>        <span class="n">ENDIF</span>
<a name="ln-4387"></a>      <span class="n">ENDDO</span>
<a name="ln-4388"></a>    <span class="k">ELSE</span>
<a name="ln-4389"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4390"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4391"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4392"></a>    <span class="n">ENDIF</span>
<a name="ln-4393"></a>
<a name="ln-4394"></a>  <span class="n">ENDDO</span>
<a name="ln-4395"></a>
<a name="ln-4396"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Generator:FuelCell:Inverter&#39;</span>
<a name="ln-4397"></a>  <span class="n">NumFCPowerCondUnits</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-4398"></a>
<a name="ln-4399"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumFCPowerCondUnits</span>  <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4400"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;No &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; equipment specified in input file&#39;</span><span class="p">)</span>
<a name="ln-4401"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Fuel Cell model requires a &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; object&#39;</span><span class="p">)</span>
<a name="ln-4402"></a>
<a name="ln-4403"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4404"></a>  <span class="n">ENDIF</span>
<a name="ln-4405"></a>
<a name="ln-4406"></a>  <span class="k">DO </span><span class="n">FCPCUNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumFCPowerCondUnits</span>
<a name="ln-4407"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">FCPCUNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4408"></a>                    <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4409"></a>                    <span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-4410"></a>
<a name="ln-4411"></a>
<a name="ln-4412"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4413"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4414"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">FCPCUNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-4415"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4416"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4417"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-4418"></a>    <span class="n">ENDIF</span>
<a name="ln-4419"></a>
<a name="ln-4420"></a>    <span class="n">thisFuelCell</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">NameInverter</span><span class="p">,</span><span class="n">NumFuelCellGenerators</span><span class="p">)</span>
<a name="ln-4421"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">thisFuelCell</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4422"></a><span class="k">      </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4423"></a>
<a name="ln-4424"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;QUADRATIC&#39;</span><span class="p">))</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">EffMode</span> <span class="o">=</span> <span class="n">InverterEffQuadratic</span>
<a name="ln-4425"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameSTring</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;Constant&#39;</span><span class="p">))</span>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">EffMode</span> <span class="o">=</span> <span class="n">InverterEffConstant</span>
<a name="ln-4426"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">EffMode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4427"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-4428"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4429"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4430"></a>      <span class="n">ENDIF</span>
<a name="ln-4431"></a>
<a name="ln-4432"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">ConstEff</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4433"></a>
<a name="ln-4434"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">EffQuadraticCurveID</span>  <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-4435"></a>      <span class="k">If</span> <span class="p">((</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">EffQuadraticCurveID</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-4436"></a>           <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">EffMode</span> <span class="o">==</span> <span class="n">InverterEffQuadratic</span><span class="p">))</span>  <span class="k">Then</span>
<a name="ln-4437"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4438"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4439"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve was not found &#39;</span><span class="p">)</span>
<a name="ln-4440"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4441"></a>      <span class="n">ENDIF</span>
<a name="ln-4442"></a>
<a name="ln-4443"></a>          <span class="c">!check for other FuelCell using the same Inverter and fill</span>
<a name="ln-4444"></a>      <span class="k">DO </span><span class="n">otherFuelCell</span> <span class="o">=</span> <span class="n">thisFuelCell</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumFuelCellGenerators</span>
<a name="ln-4445"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">otherFuelCell</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">Name</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4446"></a><span class="k">           </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">otherFuelCell</span><span class="p">)%</span><span class="n">Inverter</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">Inverter</span>
<a name="ln-4447"></a>        <span class="n">ENDIF</span>
<a name="ln-4448"></a>      <span class="n">ENDDO</span>
<a name="ln-4449"></a>    <span class="k">ELSE</span>
<a name="ln-4450"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4451"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4452"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4453"></a>    <span class="n">ENDIF</span>
<a name="ln-4454"></a>
<a name="ln-4455"></a>  <span class="n">ENDDO</span>
<a name="ln-4456"></a>
<a name="ln-4457"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Generator:FuelCell:StackCooler&#39;</span>
<a name="ln-4458"></a>  <span class="n">NumFCStackCoolers</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-4459"></a>
<a name="ln-4460"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">NumFCStackCoolers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>  <span class="c">! get stack cooler input data</span>
<a name="ln-4461"></a>    <span class="k">Do </span><span class="n">FCScoolNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumFCStackCoolers</span>
<a name="ln-4462"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">FCScoolNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4463"></a>                    <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4464"></a>                    <span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-4465"></a>
<a name="ln-4466"></a>      <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4467"></a>      <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4468"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumFCStackCoolers</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4469"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-4470"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4471"></a><span class="k">        </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4472"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-4473"></a>      <span class="n">ENDIF</span>
<a name="ln-4474"></a>      <span class="n">thisFuelCell</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">NameStackCooler</span><span class="p">,</span><span class="n">NumFuelCellGenerators</span><span class="p">)</span>
<a name="ln-4475"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">thisFuelCell</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4476"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4477"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">WaterInNodeName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4478"></a>
<a name="ln-4479"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">WaterOutNodeName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4480"></a>
<a name="ln-4481"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">WaterInNode</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-4482"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4483"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span> <span class="p">)</span>
<a name="ln-4484"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">WaterOutNode</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-4485"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4486"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span> <span class="p">)</span>
<a name="ln-4487"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-4488"></a>                            <span class="s1">&#39;Heat Recovery Nodes&#39;</span><span class="p">)</span>
<a name="ln-4489"></a>
<a name="ln-4490"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">TstackNom</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4491"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">TstackActual</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4492"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">r0</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4493"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">r1</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-4494"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">r2</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4495"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">r3</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4496"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">MdotStackCoolant</span> <span class="o">=</span>  <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-4497"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">UAs_cool</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-4498"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">Fs_cogen</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-4499"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">As_cogen</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-4500"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">MdotCogenNom</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-4501"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">hCogenNom</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-4502"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">ns</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-4503"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">PstackPumpEl</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-4504"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">PmpPowerLossFactor</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-4505"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">f0</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-4506"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">f1</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-4507"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">f1</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-4508"></a>
<a name="ln-4509"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">thisFuelCell</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">StackCoolerPresent</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4510"></a>
<a name="ln-4511"></a>      <span class="k">ELSE</span>
<a name="ln-4512"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4513"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4514"></a>        <span class="n">errorsfound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4515"></a>      <span class="n">ENDIF</span>
<a name="ln-4516"></a>    <span class="n">ENDDO</span>
<a name="ln-4517"></a>  <span class="n">ENDIF</span>
<a name="ln-4518"></a>
<a name="ln-4519"></a>
<a name="ln-4520"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4521"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in getting input for fuel cell model &#39;</span><span class="p">)</span>
<a name="ln-4522"></a>  <span class="n">ENDIF</span>
<a name="ln-4523"></a>
<a name="ln-4524"></a>  <span class="k">DO </span><span class="n">GeneratorNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumFuelCellGenerators</span>
<a name="ln-4525"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4526"></a>          <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ACPowerGen</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4527"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4528"></a>          <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ACEnergyGen</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4529"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ElectricityProduced&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-4530"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Thermal Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4531"></a>          <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">qHX</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4532"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Thermal Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4533"></a>          <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HXenergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4534"></a>          <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span> <span class="p">,</span> <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-4535"></a>
<a name="ln-4536"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel HHV Basis Energy [J]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4537"></a>          <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelEnergyHHV</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4538"></a>          <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Gas&#39;</span> <span class="p">,</span> <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-4539"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel HHV Basis Rate [W]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4540"></a>          <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelEnergyUseRateHHV</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4541"></a>
<a name="ln-4542"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Zone Sensible Heat Transfer Rate [W]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4543"></a>          <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossPower</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4544"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Zone Sensible Heat Transfer Energy [J]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4545"></a>          <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4546"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Zone Convection Heat Transfer Rate [W]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4547"></a>          <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossConvect</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4548"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Zone Radiation Heat Transfer Rate [W]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4549"></a>          <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossRadiat</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4550"></a>
<a name="ln-4551"></a>     <span class="k">CALL </span><span class="n">SetupZoneInternalGain</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">zoneID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4552"></a>                     <span class="s1">&#39;Generator:FuelCell&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4553"></a>                     <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4554"></a>                     <span class="n">IntGainTypeOf_GeneratorFuelCell</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-4555"></a>                     <span class="n">ConvectionGainRate</span>    <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossConvect</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4556"></a>                     <span class="n">ThermalRadiationGainRate</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossRadiat</span><span class="p">)</span>
<a name="ln-4557"></a>
<a name="ln-4558"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayAdvancedReportVariables</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! show extra data originally needed for detailed comparative testing</span>
<a name="ln-4559"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Air Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4560"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TairInlet</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4561"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Power Module Entering Air Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4562"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TairIntoFCPM</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4563"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Air Molar Flow Rate [kmol/s]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4564"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotAir</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4565"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Power Module Entering Air Enthalpy [W]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4566"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TotAirInEnthalphy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4567"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Blower Electric Power [W]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4568"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">BlowerPower</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4569"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Blower Electric Energy [J]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4570"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">BlowerEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4571"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Blower Skin Heat Loss Rate [W]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4572"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">BlowerSkinLoss</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4573"></a>
<a name="ln-4574"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel Inlet Temperature [C]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4575"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TfuelInlet</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4576"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Power Module Entering Fuel Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4577"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TfuelIntoFCPM</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4578"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel Molar Flow Rate [kmol/s]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4579"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotFuel</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4580"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel Consumption LHV Basis Energy [J]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4581"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelEnergyLHV</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4582"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel Consumption Rate LHV Basis [W]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4583"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelEnergyUseRateLHV</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4584"></a>
<a name="ln-4585"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Power Module Entering Fuel Enthalpy [W]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4586"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TotFuelInEnthalpy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4587"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel Compressor Electric Power [W]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4588"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelCompressPower</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4589"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel Compressor Electric Energy [J]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4590"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelCompressEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4591"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel Compressor Skin Heat Loss Rate [W]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4592"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelCompressSkinLoss</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4593"></a>
<a name="ln-4594"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel Reformer Water Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4595"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TwaterInlet</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4596"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Power Module Entering Reforming Water Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4597"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TwaterIntoFCPM</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4598"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel Reformer Water Molar Flow Rate [kmol/s]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4599"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotWater</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4600"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel Reformer Water Pump Electric Power [W]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4601"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">WaterPumpPower</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4602"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel Reformer Water Pump Electric Energy [J]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4603"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">WaterPumpEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4604"></a>
<a name="ln-4605"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Power Module Entering Reforming Water Enthalpy [W]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4606"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">WaterIntoFCPMEnthalpy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4607"></a>
<a name="ln-4608"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Product Gas Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4609"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TprodGas</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4610"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Product Gas Enthalpy [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4611"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">EnthalProdGas</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4612"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Product Gas Molar Flow Rate [kmol/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4613"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotProdGas</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4614"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Product Gas Ar Molar Flow Rate [kmol/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4615"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotProdAr</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4616"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Product Gas CO2 Molar Flow Rate [kmol/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4617"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotProdCO2</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4618"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Product Gas H2O Vapor Molar Flow Rate [kmol/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4619"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotProdH2O</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4620"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Product Gas N2 Molar Flow Rate [kmol/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4621"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotProdN2</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4622"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Product Gas O2 Molar Flow Rate [kmol/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4623"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotProdO2</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4624"></a>
<a name="ln-4625"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Heat Recovery Exit Gas Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4626"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">THXexh</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4627"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Heat Recovery Exit Gas H2O Vapor Fraction [ ]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4628"></a>              <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">WaterVaporFractExh</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4629"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Heat Recovery Water Condensate Molar Flow Rate [kmol/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4630"></a>              <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">CondensateRate</span> <span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4631"></a>
<a name="ln-4632"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Inverter Loss Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4633"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">PCUlosses</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4634"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced DC Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4635"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">DCPowerGen</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4636"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator DC Power Efficiency [ ]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4637"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">DCPowerEff</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4638"></a>
<a name="ln-4639"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Electric Storage Charge State [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4640"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ElectEnergyinStorage</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span> <span class="c">!? &#39;Sum&#39;</span>
<a name="ln-4641"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator DC Storage Charging Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4642"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">StoredPower</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4643"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator DC Storage Charging Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4644"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">StoredEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4645"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator DC Storage Discharging Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4646"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">DrawnPower</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4647"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator DC Storage Discharging Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4648"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">DrawnEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4649"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Ancillary AC Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4650"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ACancillariesPower</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4651"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Ancillary AC Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4652"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ACancillariesEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4653"></a>
<a name="ln-4654"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel Cell Model Iteration Count [ ]&#39;</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4655"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SeqSubstIterations</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4656"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Regula Falsi Iteration Count [ ]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4657"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">RegulaFalsiIterations</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-4658"></a>     <span class="n">ENDIF</span>
<a name="ln-4659"></a>  <span class="k">END DO</span>
<a name="ln-4660"></a>
<a name="ln-4661"></a><span class="n">myonetimeflag</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4662"></a><span class="n">ENDIF</span>
<a name="ln-4663"></a>
<a name="ln-4664"></a><span class="k">RETURN</span>
<a name="ln-4665"></a><span class="k">END SUBROUTINE </span><span class="n">GetFuelCellGeneratorInput</span>
<a name="ln-4666"></a>
<a name="ln-4667"></a><span class="c">! End of Get Input subroutines for the FuelCell Generator Module</span>
<a name="ln-4668"></a>
<a name="ln-4669"></a>
<a name="ln-4670"></a><span class="c">! Beginning of Generator model Subroutines</span>
<a name="ln-4671"></a><span class="c">! *****************************************************************************</span>
<a name="ln-4672"></a>
<a name="ln-4673"></a><span class="k">SUBROUTINE </span><span class="n">CalcFuelCellGeneratorModel</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-4674"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4675"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-4676"></a>          <span class="c">!       DATE WRITTEN   Aug 2005</span>
<a name="ln-4677"></a>          <span class="c">!       MODIFIED     na</span>
<a name="ln-4678"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4679"></a>
<a name="ln-4680"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4681"></a>          <span class="c">! simulate a FuelCell generator using the Annex 42 model</span>
<a name="ln-4682"></a>
<a name="ln-4683"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4684"></a>          <span class="c">! curve fit of performance data:</span>
<a name="ln-4685"></a>          <span class="c">! many subdomains such as fuel and air compressors, wa</span>
<a name="ln-4686"></a>
<a name="ln-4687"></a>
<a name="ln-4688"></a>
<a name="ln-4689"></a>          <span class="c">! REFERENCES: IEA/ECBCS Annex 42....</span>
<a name="ln-4690"></a>
<a name="ln-4691"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4692"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>   <span class="n">ONLY</span> <span class="p">:</span> <span class="n">FirstTimeStepSysFlag</span><span class="p">,</span><span class="n">TimeStepSys</span><span class="p">,</span> <span class="n">SysTimeElapsed</span>
<a name="ln-4693"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>      <span class="n">ONLY</span> <span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-4694"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span>   <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-4695"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">ZT</span>
<a name="ln-4696"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span>  <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">WaterMainsTemp</span>
<a name="ln-4697"></a>  <span class="k">USE </span><span class="n">General</span>          <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-4698"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-4699"></a>
<a name="ln-4700"></a>
<a name="ln-4701"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4702"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">GeneratorNum</span>    <span class="c">! Generator number</span>
<a name="ln-4703"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RunFlag</span>         <span class="c">! TRUE when Generator operating</span>
<a name="ln-4704"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">myload</span>          <span class="c">! Generator demand</span>
<a name="ln-4705"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-4706"></a>
<a name="ln-4707"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4708"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">KJtoJ</span> <span class="o">=</span> <span class="mi">100</span><span class="mf">0.d0</span>        <span class="c">!convert Kjoules to joules</span>
<a name="ln-4709"></a>
<a name="ln-4710"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-4711"></a>          <span class="c">! na</span>
<a name="ln-4712"></a>
<a name="ln-4713"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4714"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">save</span>     <span class="kd">::</span> <span class="n">PpcuLosses</span> <span class="c">! losses in inverter [W]</span>
<a name="ln-4715"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Pel</span>     <span class="c">! DC power generated in Fuel Cell Power Module</span>
<a name="ln-4716"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Pdemand</span>
<a name="ln-4717"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Eel</span>
<a name="ln-4718"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tavg</span>  <span class="c">! working average temperature</span>
<a name="ln-4719"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">constrainedFCPM</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! true if power prod is constrained for some reason</span>
<a name="ln-4720"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">ConstrainedFCPMTrans</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4721"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PelDiff</span> <span class="c">!</span>
<a name="ln-4722"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">iter</span> <span class="c">! loop index over repeating set of inter dependent calculaitons</span>
<a name="ln-4723"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NdotO2</span> <span class="c">! molar rate coeff working varible</span>
<a name="ln-4724"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpWater</span> <span class="c">! heat capacity of water in molar units</span>
<a name="ln-4725"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterEnthOfForm</span>  <span class="c">! Standard molar enthalpy of formation</span>
<a name="ln-4726"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NdotFuel</span> <span class="c">!fuel flow rate</span>
<a name="ln-4727"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NdotStoicAir</span> <span class="c">! Air to match fuel molar rate coeff, working variable</span>
<a name="ln-4728"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NdotExcessAir</span> <span class="c">! Air in excess of match for fuel</span>
<a name="ln-4729"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NdotCO2ProdGas</span> <span class="c">! CO2 from reaction</span>
<a name="ln-4730"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NdotH20ProdGas</span> <span class="c">! Water from reaction</span>
<a name="ln-4731"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NdotCO2</span> <span class="c">!temp CO2 molar rate coef product gas stream</span>
<a name="ln-4732"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NdotN2</span>  <span class="c">!temp Nitrogen rate coef product gas stream</span>
<a name="ln-4733"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ndot02</span>  <span class="c">!temp Oxygen rate coef product gas stream</span>
<a name="ln-4734"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NdotH20</span> <span class="c">!temp Water rate coef product gas stream</span>
<a name="ln-4735"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NdotAr</span>  <span class="c">!tmep Argon rate coef product gas stream</span>
<a name="ln-4736"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cp</span>      <span class="c">!temp Heat Capacity, used in thermochemistry units of (J/mol K)</span>
<a name="ln-4737"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Hmolfuel</span>   <span class="c">!temp enthalpy of fuel mixture in KJ/mol</span>
<a name="ln-4738"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Hmolair</span>    <span class="c">!temp enthalpy of air mixture in KJ/mol</span>
<a name="ln-4739"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HmolProdGases</span> <span class="c">!  enthalpy of product gas mixture in KJ/mol</span>
<a name="ln-4740"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HLiqWater</span> <span class="c">! temp enthalpy of liquid water in KJ/mol   No Formation</span>
<a name="ln-4741"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HGasWater</span> <span class="c">! temp enthalpy of gaseous water in KJ/mol  No Formation</span>
<a name="ln-4742"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">thisGas</span> <span class="c">!loop index</span>
<a name="ln-4743"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MagofImbalance</span> <span class="c">! error signal to control exiting loop and targeting product enthalpy</span>
<a name="ln-4744"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpTotProdGasEnthalphy</span> <span class="c">!</span>
<a name="ln-4745"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Acc</span>  <span class="c">! accuracy control for SolveRegulaFalsi</span>
<a name="ln-4746"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">MaxIter</span> <span class="c">!iteration control for SolveRegulaFalsi</span>
<a name="ln-4747"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SolverFlag</span> <span class="c">!feed back flag from SolveRegulaFalsi</span>
<a name="ln-4748"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Par</span>  <span class="c">! parameters passed in to SolveRegulaFalsi</span>
<a name="ln-4749"></a>                             <span class="c">! Par(1) = generator number index in structure</span>
<a name="ln-4750"></a>                             <span class="c">! Par(2) = targeted enthalpy (W)</span>
<a name="ln-4751"></a>                             <span class="c">! Par(3) = molar flow rate of product gases (kmol/s)</span>
<a name="ln-4752"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpTprodGas</span>
<a name="ln-4753"></a><span class="c">!unused  REAL(r64) :: LHV  !Lower Heating Value</span>
<a name="ln-4754"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">ConstrainedStorage</span> <span class="c">! contrained overall elect because of storage</span>
<a name="ln-4755"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PgridExtra</span> <span class="c">!extra electric power that should go into storage but can&#39;t</span>
<a name="ln-4756"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Pstorage</span> <span class="c">! power into storage (+),  power from storage (-)</span>
<a name="ln-4757"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PintoInverter</span> <span class="c">! power into inverter after storage interactions</span>
<a name="ln-4758"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PoutofInverter</span> <span class="c">! power out of inverter after losses and including storage</span>
<a name="ln-4759"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PacAncillariesTotal</span> <span class="c">! total AC ancillaries</span>
<a name="ln-4760"></a>
<a name="ln-4761"></a><span class="c">!! begin controls block to be moved out to GeneratorDynamics module</span>
<a name="ln-4762"></a>          <span class="c">!If no loop demand or Generator OFF, return</span>
<a name="ln-4763"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Runflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4764"></a>
<a name="ln-4765"></a><span class="c">! TODO zero out terms as appropriate</span>
<a name="ln-4766"></a>
<a name="ln-4767"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">HasBeenOn</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-4768"></a>       <span class="c">!FuelCell just now beginning to shut down,</span>
<a name="ln-4769"></a>
<a name="ln-4770"></a>       <span class="c">! set Day and Time of Last Shut Down</span>
<a name="ln-4771"></a>       <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">FractionalDayofLastShutDown</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-4772"></a>                                  <span class="o">+</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SysTimeElapsed</span><span class="o">+</span><span class="p">(</span><span class="n">CurrentTime</span> <span class="o">-</span> <span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">))))</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-4773"></a>       <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">HasBeenOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4774"></a>
<a name="ln-4775"></a>       <span class="k">If</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ShutDownTime</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DuringShutDown</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4776"></a>
<a name="ln-4777"></a>    <span class="n">endif</span>
<a name="ln-4778"></a>
<a name="ln-4779"></a>    <span class="c">!TODO  check to see if still in shut down mode and using fuel.</span>
<a name="ln-4780"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DuringShutDown</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-4781"></a>
<a name="ln-4782"></a>
<a name="ln-4783"></a><span class="k">    </span><span class="n">endif</span>
<a name="ln-4784"></a>
<a name="ln-4785"></a>
<a name="ln-4786"></a>    <span class="k">RETURN</span>
<a name="ln-4787"></a><span class="k">  END IF</span>
<a name="ln-4788"></a>
<a name="ln-4789"></a><span class="k">  IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">HasBeenOn</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-4790"></a>    <span class="c">!fuel cell just turned on</span>
<a name="ln-4791"></a>    <span class="c">! set Day and Time of Last STart Up</span>
<a name="ln-4792"></a>
<a name="ln-4793"></a>       <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">FractionalDayofLastStartUp</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-4794"></a>                                  <span class="o">+</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SysTimeElapsed</span><span class="o">+</span><span class="p">(</span><span class="n">CurrentTime</span> <span class="o">-</span> <span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">))))</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-4795"></a>
<a name="ln-4796"></a>       <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">HasBeenOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4797"></a>       <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NumCycles</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NumCycles</span> <span class="o">+</span> <span class="mi">1</span> <span class="c">! increment cycling counter</span>
<a name="ln-4798"></a>
<a name="ln-4799"></a>       <span class="k">If</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">StartUpTime</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DuringStartUp</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4800"></a>
<a name="ln-4801"></a>  <span class="n">ENDIF</span>
<a name="ln-4802"></a>
<a name="ln-4803"></a> <span class="c">!TODO deal with things when jump out if not running?</span>
<a name="ln-4804"></a> <span class="k">If</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">RunFlag</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-4805"></a><span class="k">  Return</span>
<a name="ln-4806"></a><span class="k"> </span><span class="n">ENDIF</span>
<a name="ln-4807"></a>
<a name="ln-4808"></a>  <span class="c">! Note: Myload (input) is Pdemand (electical Power requested)</span>
<a name="ln-4809"></a>  <span class="n">Pdemand</span> <span class="o">=</span> <span class="n">myLoad</span>
<a name="ln-4810"></a>  <span class="n">PacAncillariesTotal</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4811"></a>  <span class="n">PpcuLosses</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4812"></a>  <span class="n">Pstorage</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4813"></a>  <span class="n">PgridExtra</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4814"></a>  <span class="n">PoutofInverter</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4815"></a>  <span class="n">ConstrainedFCPM</span>     <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4816"></a>
<a name="ln-4817"></a> <span class="c">!!BEGIN SEQUENTIAL SUBSTITUTION to handle a lot of inter-related calcs</span>
<a name="ln-4818"></a><span class="k">DO </span><span class="n">iter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span>
<a name="ln-4819"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">iter</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4820"></a><span class="k">          Call </span><span class="n">FigurePowerConditioningLosses</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">PoutofInverter</span> <span class="p">,</span> <span class="n">PpcuLosses</span><span class="p">)</span>
<a name="ln-4821"></a>          <span class="k">CALL </span><span class="n">FigureACAncillaries</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">PacAncillariesTotal</span><span class="p">)</span>
<a name="ln-4822"></a>          <span class="n">Pdemand</span> <span class="o">=</span> <span class="n">myLoad</span> <span class="o">+</span> <span class="n">PacAncillariesTotal</span> <span class="o">+</span> <span class="n">PpcuLosses</span>
<a name="ln-4823"></a>     <span class="k">ELSE</span>
<a name="ln-4824"></a>         <span class="c">! control Step 1a: Figure ancillary AC power draws</span>
<a name="ln-4825"></a>          <span class="k">CALL </span><span class="n">FigureACAncillaries</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">PacAncillariesTotal</span><span class="p">)</span>
<a name="ln-4826"></a>          <span class="n">Pdemand</span> <span class="o">=</span> <span class="n">myLoad</span> <span class="o">+</span> <span class="n">PacAncillariesTotal</span>
<a name="ln-4827"></a>          <span class="c">! Control Step 1b: Calculate losses associated with Power conditioning</span>
<a name="ln-4828"></a>          <span class="k">Call </span><span class="n">FigurePowerConditioningLosses</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">Pdemand</span><span class="p">,</span> <span class="n">PpcuLosses</span><span class="p">)</span>
<a name="ln-4829"></a>          <span class="n">Pdemand</span> <span class="o">=</span> <span class="n">Pdemand</span> <span class="o">+</span> <span class="n">PpcuLosses</span>
<a name="ln-4830"></a>          <span class="n">Pel</span> <span class="o">=</span> <span class="n">Pdemand</span>
<a name="ln-4831"></a>     <span class="n">ENDIF</span>
<a name="ln-4832"></a>
<a name="ln-4833"></a>     <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">PCUlosses</span> <span class="o">=</span> <span class="n">PpcuLosses</span>
<a name="ln-4834"></a>
<a name="ln-4835"></a>   <span class="c">! Control step 2: adjust for transient and startup/shut down constraints</span>
<a name="ln-4836"></a>
<a name="ln-4837"></a>  <span class="k">Call </span><span class="n">FigureTransientConstraints</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">Pel</span><span class="p">,</span> <span class="n">ConstrainedFCPMTrans</span><span class="p">,</span> <span class="n">PelDiff</span><span class="p">)</span>
<a name="ln-4838"></a>
<a name="ln-4839"></a>    <span class="c">! Control step 3: adjust for max and min limits on Pel</span>
<a name="ln-4840"></a>
<a name="ln-4841"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">Pel</span> <span class="o">&lt;</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelMin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4842"></a><span class="k">   </span><span class="n">PelDiff</span> <span class="o">=</span> <span class="n">PelDiff</span> <span class="o">+</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelMin</span> <span class="o">-</span> <span class="n">Pel</span><span class="p">)</span>
<a name="ln-4843"></a>   <span class="n">Pel</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelMin</span>
<a name="ln-4844"></a>
<a name="ln-4845"></a>   <span class="n">ConstrainedFCPM</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4846"></a>  <span class="n">ENDIF</span>
<a name="ln-4847"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">Pel</span> <span class="o">&gt;</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelMax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4848"></a><span class="k">   </span><span class="n">PelDiff</span> <span class="o">=</span> <span class="n">PelDiff</span> <span class="o">+</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelMax</span> <span class="o">-</span> <span class="n">Pel</span><span class="p">)</span>
<a name="ln-4849"></a>   <span class="n">Pel</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelMax</span>
<a name="ln-4850"></a>   <span class="n">ConstrainedFCPM</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4851"></a>
<a name="ln-4852"></a>  <span class="n">ENDIF</span>
<a name="ln-4853"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">ConstrainedFCPM</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4854"></a>
<a name="ln-4855"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-4856"></a>
<a name="ln-4857"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Pel</span> <span class="o">=</span>  <span class="n">Pel</span>
<a name="ln-4858"></a>  <span class="c">!Now calculate FC models.  return to controls and batter after</span>
<a name="ln-4859"></a>
<a name="ln-4860"></a>
<a name="ln-4861"></a>  <span class="c">!Calculation Step 1. Determine electrical Efficiency Eel</span>
<a name="ln-4862"></a>
<a name="ln-4863"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">EffMode</span> <span class="o">==</span> <span class="n">NormalizedCurveMode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4864"></a>        <span class="c">!Equation (8) in FuelCell Spec modified for normalized curve</span>
<a name="ln-4865"></a>
<a name="ln-4866"></a>    <span class="n">Eel</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">EffCurveID</span><span class="p">,</span> <span class="n">Pel</span><span class="o">/</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NomPel</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-4867"></a>               <span class="o">*</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NomEff</span> <span class="p">&amp;</span>
<a name="ln-4868"></a>         <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NumCycles</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">CyclingDegradRat</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4869"></a>         <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">MAX</span><span class="p">((</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NumRunHours</span><span class="o">-</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ThreshRunHours</span><span class="p">),</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4870"></a>                   <span class="o">*</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">OperateDegradRat</span><span class="p">)</span>
<a name="ln-4871"></a>
<a name="ln-4872"></a>  <span class="n">ELSEIF</span>  <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">EffMode</span> <span class="o">==</span> <span class="n">DirectCurveMode</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4873"></a>   <span class="c">!Equation (8) in FuelCell Spec</span>
<a name="ln-4874"></a>    <span class="n">Eel</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">EffCurveID</span><span class="p">,</span> <span class="n">Pel</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4875"></a>         <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NumCycles</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">CyclingDegradRat</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4876"></a>         <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">MAX</span><span class="p">((</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NumRunHours</span><span class="o">-</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ThreshRunHours</span><span class="p">),</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4877"></a>                   <span class="o">*</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">OperateDegradRat</span> <span class="p">)</span>
<a name="ln-4878"></a>  <span class="n">ENDIF</span>
<a name="ln-4879"></a>
<a name="ln-4880"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Eel</span> <span class="o">=</span> <span class="n">Eel</span>
<a name="ln-4881"></a>  <span class="c">! Calculation Step 2. Determine fuel rate</span>
<a name="ln-4882"></a>
<a name="ln-4883"></a>  <span class="n">NdotFuel</span> <span class="o">=</span> <span class="n">Pel</span> <span class="o">/</span> <span class="p">(</span><span class="n">Eel</span> <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">LHV</span> <span class="o">*</span> <span class="mi">100000</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="c">!Eq. 10 solved for Ndot</span>
<a name="ln-4884"></a>
<a name="ln-4885"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span> <span class="o">=</span> <span class="n">NdotFuel</span>
<a name="ln-4886"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">Pel</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-4887"></a>    <span class="c">!TODO zero stuff before leaving</span>
<a name="ln-4888"></a>    <span class="n">Pel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4889"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Pel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4890"></a>    <span class="k">RETURN</span>
<a name="ln-4891"></a><span class="k">  Else</span>
<a name="ln-4892"></a>
<a name="ln-4893"></a><span class="k">  </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Pel</span> <span class="o">=</span>  <span class="n">Pel</span>
<a name="ln-4894"></a>  <span class="n">endif</span>
<a name="ln-4895"></a>
<a name="ln-4896"></a>
<a name="ln-4897"></a>
<a name="ln-4898"></a>
<a name="ln-4899"></a>  <span class="c">! Calculation Step 3. Determine Air rate</span>
<a name="ln-4900"></a>
<a name="ln-4901"></a>  <span class="k">IF</span>     <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">AirSupRateMode</span> <span class="o">==</span> <span class="n">ConstantStoicsAirRat</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!MEthod 1</span>
<a name="ln-4902"></a>     <span class="n">NdotO2</span> <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">StoicOxygenRate</span>    <span class="p">&amp;</span>
<a name="ln-4903"></a>              <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span>            <span class="p">&amp;</span>
<a name="ln-4904"></a>              <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">Stoics</span>
<a name="ln-4905"></a>
<a name="ln-4906"></a>     <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotAir</span> <span class="o">=</span> <span class="n">NdotO2</span> <span class="o">/</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">O2fraction</span>
<a name="ln-4907"></a>
<a name="ln-4908"></a>
<a name="ln-4909"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">AirSupRateMode</span> <span class="o">==</span> <span class="n">QuadraticFuncofPel</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!MEthod 2</span>
<a name="ln-4910"></a>
<a name="ln-4911"></a>     <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotAir</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">AirFuncPelCurveID</span><span class="p">,</span> <span class="n">Pel</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4912"></a>                                       <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">AirTempCoeff</span> <span class="p">&amp;</span>
<a name="ln-4913"></a>                                              <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">TairIntoFCPM</span><span class="p">)</span>
<a name="ln-4914"></a>
<a name="ln-4915"></a>
<a name="ln-4916"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">AirSupRateMode</span> <span class="o">==</span> <span class="n">QuadraticFuncofNdot</span><span class="p">)</span>  <span class="k">THEN</span> <span class="c">! method 3</span>
<a name="ln-4917"></a>     <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotAir</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">AirFuncNdotCurveID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4918"></a>                                                              <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4919"></a>                                       <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">AirTempCoeff</span> <span class="p">&amp;</span>
<a name="ln-4920"></a>                                              <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">TairIntoFCPM</span><span class="p">)</span>
<a name="ln-4921"></a>
<a name="ln-4922"></a>  <span class="n">ENDIF</span>
<a name="ln-4923"></a>
<a name="ln-4924"></a>
<a name="ln-4925"></a>  <span class="c">! Calculation Step 4. fuel compressor power</span>
<a name="ln-4926"></a>
<a name="ln-4927"></a>  <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">PfuelCompEl</span>    <span class="p">&amp;</span>
<a name="ln-4928"></a>     <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">CompPowerCurveID</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span><span class="p">)</span>
<a name="ln-4929"></a>
<a name="ln-4930"></a>  <span class="c">! calculation Step 5, Fuel Compressor (need outlet temperature)</span>
<a name="ln-4931"></a>
<a name="ln-4932"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">FuelTempMode</span> <span class="o">==</span> <span class="n">FuelInTempFromNode</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4933"></a>
<a name="ln-4934"></a><span class="k">     </span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">TfuelIntoCompress</span>  <span class="p">&amp;</span>
<a name="ln-4935"></a>            <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4936"></a>
<a name="ln-4937"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">FuelTempMode</span> <span class="o">==</span> <span class="n">FuelInTempSchedule</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4938"></a>
<a name="ln-4939"></a><span class="k">     </span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">TfuelIntoCompress</span>   <span class="p">&amp;</span>
<a name="ln-4940"></a>           <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">SchedNum</span><span class="p">)</span>
<a name="ln-4941"></a>
<a name="ln-4942"></a>  <span class="n">ENDIF</span>
<a name="ln-4943"></a>
<a name="ln-4944"></a>       <span class="c">!  evaluate  heat capacity at average temperature usign shomate</span>
<a name="ln-4945"></a>  <span class="n">Tavg</span>  <span class="o">=</span> <span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">TfuelIntoCompress</span>   <span class="p">&amp;</span>
<a name="ln-4946"></a>     <span class="o">+</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">TfuelIntoFCPM</span><span class="p">)</span><span class="o">/</span> <span class="mf">2.0d0</span>
<a name="ln-4947"></a>  <span class="k">Call </span><span class="n">FigureFuelHeatCap</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">Tavg</span><span class="p">,</span> <span class="n">Cp</span><span class="p">)</span>  <span class="c">! Cp in (J/mol K)</span>
<a name="ln-4948"></a>
<a name="ln-4949"></a>    <span class="c">! calculate a Temp of fuel out of compressor and into power module</span>
<a name="ln-4950"></a>
<a name="ln-4951"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!just pass through, domain probably collapased in modeling</span>
<a name="ln-4952"></a>     <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">TfuelIntoFCPM</span> <span class="o">=</span>  <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">TfuelIntoCompress</span>
<a name="ln-4953"></a>  <span class="k">ELSE</span>
<a name="ln-4954"></a><span class="k">     </span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">TfuelIntoFCPM</span> <span class="o">=</span> <span class="p">(</span>  <span class="p">&amp;</span>
<a name="ln-4955"></a>                                             <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">CompPowerLossFactor</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-4956"></a>                                                 <span class="o">*</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">PfuelCompEl</span>              <span class="p">&amp;</span>
<a name="ln-4957"></a>                                           <span class="o">/</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span><span class="p">))</span> <span class="p">&amp;</span> <span class="c">!1000 Cp units mol-&gt; kmol</span>
<a name="ln-4958"></a>                                                <span class="o">+</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">TfuelIntoCompress</span>
<a name="ln-4959"></a>  <span class="n">ENDIF</span>
<a name="ln-4960"></a>    <span class="c">! calc skin losses from fuel compressor</span>
<a name="ln-4961"></a>  <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">QskinLoss</span>     <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">CompPowerLossFactor</span> <span class="p">&amp;</span>
<a name="ln-4962"></a>                                               <span class="o">*</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">PfuelCompEl</span>
<a name="ln-4963"></a>
<a name="ln-4964"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">QskinLoss</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4965"></a><span class="c">!   write(*,*) &#39;problem in FuelSupply%QskinLoss &#39;, FuelSupply(FuelCell(GeneratorNum)%FuelSupNum)%QskinLoss</span>
<a name="ln-4966"></a>   <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;problem in FuelSupply%QskinLoss &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4967"></a>                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">QskinLoss</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-4968"></a>   <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">QskinLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4969"></a>  <span class="n">endif</span>
<a name="ln-4970"></a>
<a name="ln-4971"></a>    <span class="c">! calculate tatal fuel enthalpy coming into power module</span>
<a name="ln-4972"></a>
<a name="ln-4973"></a>  <span class="c">! (Hmolfuel in KJ/mol)</span>
<a name="ln-4974"></a>  <span class="k">CAll </span><span class="n">FigureFuelEnthalpy</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">TfuelIntoFCPM</span><span class="p">,</span> <span class="n">Hmolfuel</span><span class="p">)</span>
<a name="ln-4975"></a>
<a name="ln-4976"></a>  <span class="c">! units, NdotFuel in kmol/sec. Hmolfule in KJ/mol ,</span>
<a name="ln-4977"></a>  <span class="c">!        factor of 1000&#39;s to get to J/s or watts</span>
<a name="ln-4978"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TotFuelInEnthalphy</span>  <span class="o">=</span> <span class="n">Hmolfuel</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-4979"></a>
<a name="ln-4980"></a>  <span class="c">!Calculation Step 6, water compressor calculations</span>
<a name="ln-4981"></a>
<a name="ln-4982"></a>   <span class="c">! calculate water consumption</span>
<a name="ln-4983"></a>
<a name="ln-4984"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotLiqwater</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">WaterSupRateCurveID</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4985"></a>                                                    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span> <span class="p">)</span>
<a name="ln-4986"></a>
<a name="ln-4987"></a>   <span class="c">! set inlet temp.  (could move to init)</span>
<a name="ln-4988"></a>
<a name="ln-4989"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">WaterTempMode</span><span class="p">)</span>
<a name="ln-4990"></a>
<a name="ln-4991"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">WaterInReformMains</span><span class="p">)</span>
<a name="ln-4992"></a>
<a name="ln-4993"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">TwaterIntoCompress</span> <span class="o">=</span> <span class="n">WaterMainsTemp</span>
<a name="ln-4994"></a>
<a name="ln-4995"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">WaterInReformAirNode</span><span class="p">,</span><span class="n">WaterInReformWaterNode</span><span class="p">)</span>
<a name="ln-4996"></a>
<a name="ln-4997"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">TwaterIntoCompress</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4998"></a>
<a name="ln-4999"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">WaterInReformSchedule</span><span class="p">)</span>
<a name="ln-5000"></a>
<a name="ln-5001"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">TwaterIntoCompress</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">SchedNum</span><span class="p">)</span>
<a name="ln-5002"></a>
<a name="ln-5003"></a>  <span class="k">END SELECT</span>
<a name="ln-5004"></a>
<a name="ln-5005"></a>
<a name="ln-5006"></a><span class="k">  </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">PwaterCompEl</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">PmpPowerCurveID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5007"></a>                                                          <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotLiqwater</span> <span class="p">)</span>
<a name="ln-5008"></a>
<a name="ln-5009"></a>     <span class="c">! 75.325  J/mol K Water at 0.1 MPa and 298 K, reference NIST WEBBOOK</span>
<a name="ln-5010"></a>  <span class="k">call </span><span class="n">FigureLiquidWaterHeatCap</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">TwaterIntoCompress</span><span class="p">,</span> <span class="n">CpWater</span><span class="p">)</span>
<a name="ln-5011"></a>
<a name="ln-5012"></a>  <span class="n">WaterEnthOfForm</span> <span class="o">=</span>   <span class="o">-</span><span class="mi">24</span><span class="mf">1.8264d0</span> <span class="c">!KJ/mol</span>
<a name="ln-5013"></a>
<a name="ln-5014"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotLiqwater</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!just pass through, domain probably collapased in modeling</span>
<a name="ln-5015"></a>   <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">TwaterIntoFCPM</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">TwaterIntoCompress</span> <span class="c">!</span>
<a name="ln-5016"></a>  <span class="k">ELSE</span>
<a name="ln-5017"></a>
<a name="ln-5018"></a><span class="k">    </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">TwaterIntoFCPM</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">PmpPowerLossFactor</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5019"></a>                                               <span class="o">*</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">PwaterCompEl</span>              <span class="p">&amp;</span>
<a name="ln-5020"></a>                                               <span class="o">/</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotLiqwater</span> <span class="o">*</span> <span class="n">CpWater</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-5021"></a>                                               <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">TwaterIntoCompress</span>
<a name="ln-5022"></a>  <span class="n">ENDIF</span>
<a name="ln-5023"></a>
<a name="ln-5024"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">QskinLoss</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">PmpPowerLossFactor</span>   <span class="p">&amp;</span>
<a name="ln-5025"></a>                                          <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">PwaterCompEl</span>
<a name="ln-5026"></a>
<a name="ln-5027"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">QskinLoss</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5028"></a>  <span class="c">! write(*,*) &#39;problem in WaterSup%QskinLoss &#39;,FuelCell(GeneratorNum)%WaterSup%QskinLoss</span>
<a name="ln-5029"></a>   <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">QskinLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5030"></a>  <span class="n">endif</span>
<a name="ln-5031"></a>
<a name="ln-5032"></a>  <span class="k">Call </span><span class="n">FigureLiquidWaterEnthalpy</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">TwaterIntoFCPM</span><span class="p">,</span> <span class="n">HLiqWater</span><span class="p">)</span>   <span class="c">! HLiqWater in KJ/mol</span>
<a name="ln-5033"></a>
<a name="ln-5034"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">WaterInEnthalpy</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotLiqwater</span><span class="o">*</span><span class="n">HLiqWater</span><span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span><span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5035"></a>
<a name="ln-5036"></a>  <span class="c">!Calculation Step 7, Air compressor</span>
<a name="ln-5037"></a>
<a name="ln-5038"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">TairIntoBlower</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">SupNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-5039"></a>
<a name="ln-5040"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">PairCompEl</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">BlowerPowerCurveID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5041"></a>                                                       <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotAir</span><span class="p">)</span>
<a name="ln-5042"></a>
<a name="ln-5043"></a>  <span class="n">Tavg</span> <span class="o">=</span> <span class="p">(</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">TairIntoBlower</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">TairIntoFCPM</span> <span class="p">)</span> <span class="o">/</span> <span class="mf">2.0d0</span>
<a name="ln-5044"></a>
<a name="ln-5045"></a>  <span class="k">CALL </span><span class="n">FigureAirHeatCap</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">Tavg</span><span class="p">,</span> <span class="n">Cp</span><span class="p">)</span>  <span class="c">! Cp in (J/mol K)</span>
<a name="ln-5046"></a>
<a name="ln-5047"></a>  <span class="c">! if PEMFC with stack cooler, then calculate stack cooler impacts</span>
<a name="ln-5048"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">StackCoolerPresent</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5049"></a>
<a name="ln-5050"></a><span class="k">    </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">qs_cool</span> <span class="o">=</span>    <span class="p">(</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">r0</span>                       <span class="p">&amp;</span>
<a name="ln-5051"></a>                                                  <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">r1</span>                         <span class="p">&amp;</span>
<a name="ln-5052"></a>                                                  <span class="o">*</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">TstackActual</span>               <span class="p">&amp;</span>
<a name="ln-5053"></a>                                                      <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">TstackNom</span><span class="p">)</span> <span class="p">)</span>           <span class="p">&amp;</span>
<a name="ln-5054"></a>                                                  <span class="o">*</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">r2</span><span class="o">*</span><span class="n">Pel</span>                <span class="p">&amp;</span>
<a name="ln-5055"></a>                                                       <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">r3</span><span class="o">*</span><span class="n">Pel</span><span class="o">*</span><span class="n">Pel</span><span class="p">)</span> <span class="o">*</span> <span class="n">Pel</span>
<a name="ln-5056"></a>
<a name="ln-5057"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">QdotStackCool</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">qs_cool</span>
<a name="ln-5058"></a>
<a name="ln-5059"></a>  <span class="n">ENDIF</span>
<a name="ln-5060"></a>
<a name="ln-5061"></a>
<a name="ln-5062"></a>  <span class="c">!Figure heat recovery from Electrical Storage, power conditioning, and auxiliary burner</span>
<a name="ln-5063"></a>
<a name="ln-5064"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">IntakeRecoveryMode</span><span class="p">)</span>
<a name="ln-5065"></a>
<a name="ln-5066"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">RecoverBurnInvertBatt</span><span class="p">)</span>
<a name="ln-5067"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">QintakeRecovery</span> <span class="o">=</span>   <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">QairIntake</span>    <span class="p">&amp;</span>
<a name="ln-5068"></a>                                               <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">QairIntake</span>   <span class="p">&amp;</span>
<a name="ln-5069"></a>                                               <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">QairIntake</span>
<a name="ln-5070"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">RecoverAuxiliaryBurner</span><span class="p">)</span>
<a name="ln-5071"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">QintakeRecovery</span> <span class="o">=</span>   <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">QairIntake</span>
<a name="ln-5072"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">RecoverInverterBatt</span><span class="p">)</span>
<a name="ln-5073"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">QintakeRecovery</span> <span class="o">=</span>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">QairIntake</span>   <span class="p">&amp;</span>
<a name="ln-5074"></a>                                               <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">QairIntake</span>
<a name="ln-5075"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">RecoverInverter</span><span class="p">)</span>
<a name="ln-5076"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">QintakeRecovery</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">QairIntake</span>
<a name="ln-5077"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">RecoverBattery</span><span class="p">)</span>
<a name="ln-5078"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">QintakeRecovery</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">QairIntake</span>
<a name="ln-5079"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">NoRecoveryOnAirIntake</span><span class="p">)</span>
<a name="ln-5080"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">QintakeRecovery</span> <span class="o">=</span>  <span class="mf">0.0d0</span>
<a name="ln-5081"></a>
<a name="ln-5082"></a>  <span class="k">END SELECT</span>
<a name="ln-5083"></a>
<a name="ln-5084"></a><span class="k">  IF</span> <span class="p">(</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotAir</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">!just pass through, domain probably collapased in modeling</span>
<a name="ln-5085"></a>     <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">TairIntoFCPM</span>  <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">TairIntoBlower</span>
<a name="ln-5086"></a>
<a name="ln-5087"></a>  <span class="k">ELSE</span>
<a name="ln-5088"></a><span class="k">     </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">TairIntoFCPM</span> <span class="o">=</span> <span class="p">(((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">BlowerHeatLossFactor</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5089"></a>                                               <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">PairCompEl</span>                <span class="p">&amp;</span>
<a name="ln-5090"></a>                                               <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">QintakeRecovery</span><span class="p">)</span>          <span class="p">&amp;</span>
<a name="ln-5091"></a>                                             <span class="o">/</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotAir</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span><span class="p">))</span>   <span class="p">&amp;</span> <span class="c">!1000 Cp units mol-&gt; kmol</span>
<a name="ln-5092"></a>                                               <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">TairIntoBlower</span>
<a name="ln-5093"></a>  <span class="n">ENDIF</span>
<a name="ln-5094"></a>
<a name="ln-5095"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">QskinLoss</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">BlowerHeatLossFactor</span> <span class="p">&amp;</span>
<a name="ln-5096"></a>                                         <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">PairCompEl</span>
<a name="ln-5097"></a>
<a name="ln-5098"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">QskinLoss</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5099"></a><span class="c">!   write(*,*) &#39;problem in AirSup%QskinLoss &#39;, FuelCell(GeneratorNum)%AirSup%QskinLoss</span>
<a name="ln-5100"></a>   <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;problem in AirSup%QskinLoss &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">QskinLoss</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-5101"></a>   <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">QskinLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5102"></a>  <span class="n">endif</span>
<a name="ln-5103"></a>
<a name="ln-5104"></a>  <span class="k">CAll </span><span class="n">FigureAirEnthalpy</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">TairIntoFCPM</span><span class="p">,</span> <span class="n">Hmolair</span><span class="p">)</span> <span class="c">! (Hmolair in KJ/mol)</span>
<a name="ln-5105"></a>
<a name="ln-5106"></a>  <span class="c">! units, NdotAir in kmol/sec.; Hmolfuel in KJ/mol ,</span>
<a name="ln-5107"></a>  <span class="c">!        factor of 1000&#39;s to get to J/s or watts</span>
<a name="ln-5108"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TotAirInEnthalphy</span>  <span class="o">=</span> <span class="n">Hmolair</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotAir</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5109"></a>
<a name="ln-5110"></a>  <span class="c">! calculation Step 8, Figure Product Gases</span>
<a name="ln-5111"></a>
<a name="ln-5112"></a>     <span class="c">! figure stoic N dot for air</span>
<a name="ln-5113"></a>  <span class="n">NdotO2</span> <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">StoicOxygenRate</span>    <span class="p">&amp;</span>
<a name="ln-5114"></a>              <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span>
<a name="ln-5115"></a>
<a name="ln-5116"></a>  <span class="n">NdotStoicAir</span> <span class="o">=</span> <span class="n">NdotO2</span> <span class="o">/</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">O2fraction</span>
<a name="ln-5117"></a>
<a name="ln-5118"></a>     <span class="c">! figure excess air rate</span>
<a name="ln-5119"></a>
<a name="ln-5120"></a>  <span class="n">NdotExcessAir</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotAir</span> <span class="o">-</span> <span class="n">NdotStoicAir</span>
<a name="ln-5121"></a>
<a name="ln-5122"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NdotExcessAir</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!can&#39;t meet stoichiometric fuel reaction</span>
<a name="ln-5123"></a>
<a name="ln-5124"></a>      <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Air flow rate into fuel cell is too low for stoichiometric fuel reaction&#39;</span><span class="p">)</span>
<a name="ln-5125"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Increase air flow in GENERATOR:FC:AIR SUPPLY object:&#39;</span> <span class="p">&amp;</span>
<a name="ln-5126"></a>                               <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5127"></a>  <span class="n">ENDIF</span>
<a name="ln-5128"></a>
<a name="ln-5129"></a>     <span class="c">! figure CO2 and Water rate from products (coefs setup during one-time processing in gas phase library )</span>
<a name="ln-5130"></a>
<a name="ln-5131"></a>  <span class="n">NdotCO2ProdGas</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span> <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">CO2ProductGasCoef</span>
<a name="ln-5132"></a>
<a name="ln-5133"></a>  <span class="n">NdotH20ProdGas</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span> <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">H20ProductGasCoef</span>
<a name="ln-5134"></a>
<a name="ln-5135"></a>     <span class="c">!  set product gas constituent fractions  (assume five usual components)</span>
<a name="ln-5136"></a>  <span class="n">NdotCO2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5137"></a>  <span class="n">NdotN2</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5138"></a>  <span class="n">Ndot02</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5139"></a>  <span class="n">NdotH20</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5140"></a>  <span class="n">NdotAr</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5141"></a>
<a name="ln-5142"></a><span class="c">! Product gas constiuents are fixed (not a user defined thing)</span>
<a name="ln-5143"></a><span class="c">!</span>
<a name="ln-5144"></a>
<a name="ln-5145"></a>  <span class="k">Do </span><span class="n">thisGas</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">NumConstituents</span>
<a name="ln-5146"></a>
<a name="ln-5147"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">(</span><span class="n">thisGas</span><span class="p">))</span>
<a name="ln-5148"></a>
<a name="ln-5149"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5150"></a>        <span class="c">! all the CO2 coming in plus the new CO2 from reactions</span>
<a name="ln-5151"></a>        <span class="n">NdotCO2</span> <span class="o">=</span> <span class="n">NdotCO2ProdGas</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisGas</span><span class="p">)</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotAir</span>
<a name="ln-5152"></a>
<a name="ln-5153"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5154"></a>        <span class="c">! all the nitrogen comming in</span>
<a name="ln-5155"></a>        <span class="n">NdotN2</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotAir</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisGas</span><span class="p">)</span>
<a name="ln-5156"></a>
<a name="ln-5157"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-5158"></a>        <span class="c">! all the oxygen in the excess air stream</span>
<a name="ln-5159"></a>        <span class="n">Ndot02</span> <span class="o">=</span> <span class="n">NdotExcessAir</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisGas</span><span class="p">)</span>
<a name="ln-5160"></a>
<a name="ln-5161"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-5162"></a>        <span class="c">! all the H20 comming in plus the new H20 from reactions and the H20 from water used in reforming</span>
<a name="ln-5163"></a>        <span class="n">NdotH20</span> <span class="o">=</span> <span class="n">NdotH20ProdGas</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisGas</span><span class="p">)</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotAir</span>
<a name="ln-5164"></a>                   <span class="c">!+ FuelCell(GeneratorNum)%FCPM%NdotLiqwater</span>
<a name="ln-5165"></a>
<a name="ln-5166"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-5167"></a>        <span class="c">! all the argon coming in.</span>
<a name="ln-5168"></a>        <span class="n">NdotAr</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotAir</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisGas</span><span class="p">)</span>
<a name="ln-5169"></a>
<a name="ln-5170"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-5171"></a>
<a name="ln-5172"></a>      <span class="k">END SELECT</span>
<a name="ln-5173"></a><span class="k">  </span><span class="n">ENDDO</span>
<a name="ln-5174"></a>
<a name="ln-5175"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotProdGas</span> <span class="o">=</span> <span class="n">NdotCO2</span> <span class="o">+</span> <span class="n">NdotN2</span> <span class="o">+</span> <span class="n">Ndot02</span> <span class="o">+</span> <span class="n">NdotH20</span> <span class="o">+</span> <span class="n">NdotAr</span>
<a name="ln-5176"></a>
<a name="ln-5177"></a>    <span class="c">! now that we have the total, figure molar fractions</span>
<a name="ln-5178"></a>
<a name="ln-5179"></a>
<a name="ln-5180"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span>  <span class="n">NdotCO2</span> <span class="o">/</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotProdGas</span>
<a name="ln-5181"></a>
<a name="ln-5182"></a>     <span class="c">! all the nitrogen comming in</span>
<a name="ln-5183"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span>  <span class="n">NdotN2</span> <span class="o">/</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotProdGas</span>
<a name="ln-5184"></a>
<a name="ln-5185"></a>
<a name="ln-5186"></a>        <span class="c">! all the oxygen in the excess air stream</span>
<a name="ln-5187"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span>  <span class="n">Ndot02</span> <span class="o">/</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotProdGas</span>
<a name="ln-5188"></a>
<a name="ln-5189"></a>       <span class="c">! all the H20 comming in plus the new H20 from reactions and the H20 from water used in reforming</span>
<a name="ln-5190"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">NdotH20</span> <span class="o">/</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotProdGas</span>
<a name="ln-5191"></a>
<a name="ln-5192"></a>        <span class="c">! all the argon coming in.</span>
<a name="ln-5193"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">NdotAr</span> <span class="o">/</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotProdGas</span>
<a name="ln-5194"></a>
<a name="ln-5195"></a>  <span class="c">!HmolProdGases KJ/mol)</span>
<a name="ln-5196"></a>  <span class="k">CALL </span><span class="n">FigureProductGasesEnthalpy</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TprodGasLeavingFCPM</span><span class="p">,</span> <span class="n">HmolProdGases</span><span class="p">)</span>
<a name="ln-5197"></a>
<a name="ln-5198"></a>  <span class="c">! units, NdotProdGas in kmol/sec.; HmolProdGases in KJ/mol ,</span>
<a name="ln-5199"></a>  <span class="c">!        factor of 1000&#39;s to get to J/s or watts</span>
<a name="ln-5200"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TotProdGasEnthalphy</span>  <span class="o">=</span> <span class="n">HmolProdGases</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotProdGas</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5201"></a>
<a name="ln-5202"></a>
<a name="ln-5203"></a>  <span class="c">! calculation Step 9, Figure Skin lossess</span>
<a name="ln-5204"></a>
<a name="ln-5205"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">SkinLossMode</span> <span class="o">==</span> <span class="n">ConstantRateSkinLoss</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5206"></a>   <span class="c">! do nothing just use QdotSkin</span>
<a name="ln-5207"></a>
<a name="ln-5208"></a>  <span class="n">ELSEIF</span> <span class="p">(</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">SkinLossMode</span> <span class="o">==</span> <span class="n">UADTSkinLoss</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-5209"></a>
<a name="ln-5210"></a>    <span class="c">! get zone air temp</span>
<a name="ln-5211"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">QdotSkin</span> <span class="o">=</span>   <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">UAskin</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5212"></a>                                       <span class="p">(</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TprodGasLeavingFCPM</span>  <span class="p">&amp;</span>
<a name="ln-5213"></a>                                          <span class="o">-</span> <span class="n">ZT</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ZoneID</span> <span class="p">))</span>
<a name="ln-5214"></a>
<a name="ln-5215"></a>  <span class="n">ELSEIF</span> <span class="p">(</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">SkinLossMode</span> <span class="o">==</span> <span class="n">QuadraticFuelNdotSkin</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5216"></a>
<a name="ln-5217"></a><span class="k">    </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">QdotSkin</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">SkinLossCurveID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5218"></a>                                                   <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span> <span class="p">)</span>
<a name="ln-5219"></a>
<a name="ln-5220"></a>  <span class="n">ENDIF</span>
<a name="ln-5221"></a>
<a name="ln-5222"></a>  <span class="c">! calculation Step 10, AC FCPM power ancillaries</span>
<a name="ln-5223"></a>
<a name="ln-5224"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelancillariesAC</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ANC0</span>   <span class="p">&amp;</span>
<a name="ln-5225"></a>                                             <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ANC1</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span>
<a name="ln-5226"></a>
<a name="ln-5227"></a>  <span class="c">! calculation Step 11, Dilution air</span>
<a name="ln-5228"></a>  <span class="k">CAll </span><span class="n">FigureAirEnthalpy</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">TairIntoBlower</span><span class="p">,</span> <span class="n">Hmolair</span><span class="p">)</span> <span class="c">! (Hmolair in KJ/mol)</span>
<a name="ln-5229"></a>
<a name="ln-5230"></a>  <span class="c">! units, NdotDilutionAir in kmol/sec.; Hmolair in KJ/mol ,</span>
<a name="ln-5231"></a>  <span class="c">!        factor of 1000&#39;s to get to J/s or watts</span>
<a name="ln-5232"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DilutionAirInEnthalpy</span>  <span class="o">=</span> <span class="n">Hmolair</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotDilutionAir</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5233"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DilutionAirOutEnthalpy</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DilutionAirInEnthalpy</span>   <span class="p">&amp;</span>
<a name="ln-5234"></a>                                                   <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">StackHeatLossToDilution</span>
<a name="ln-5235"></a>
<a name="ln-5236"></a>  <span class="c">! calculation Step 12, Calculate Reforming water out enthalpy</span>
<a name="ln-5237"></a>  <span class="k">Call </span><span class="n">FigureGaseousWaterEnthalpy</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TprodGasLeavingFCPM</span><span class="p">,</span> <span class="n">HGasWater</span><span class="p">)</span>
<a name="ln-5238"></a>
<a name="ln-5239"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">WaterOutEnthalpy</span> <span class="o">=</span> <span class="n">HGasWater</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotLiqwater</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5240"></a>
<a name="ln-5241"></a>  <span class="c">! calculation Step 13, Calculate Heat balance</span>
<a name="ln-5242"></a>  <span class="c">!    move all terms in Equation 7 to RHS and calculate imbalance</span>
<a name="ln-5243"></a>
<a name="ln-5244"></a>   <span class="n">MagofImbalance</span> <span class="o">=</span> <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TotFuelInEnthalphy</span>  <span class="p">&amp;</span>
<a name="ln-5245"></a>                    <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TotAirInEnthalphy</span>   <span class="p">&amp;</span>
<a name="ln-5246"></a>                    <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">WaterInEnthalpy</span>     <span class="p">&amp;</span>
<a name="ln-5247"></a>                    <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DilutionAirInEnthalpy</span> <span class="p">&amp;</span>
<a name="ln-5248"></a>                    <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span> <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">LHV</span> <span class="o">*</span> <span class="mi">100000</span><span class="mf">0.0d0</span> <span class="p">&amp;</span>
<a name="ln-5249"></a>                    <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelancillariesAC</span>    <span class="p">&amp;</span>
<a name="ln-5250"></a>                    <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Pel</span>                 <span class="p">&amp;</span>
<a name="ln-5251"></a>                    <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TotProdGasEnthalphy</span> <span class="p">&amp;</span>
<a name="ln-5252"></a>                    <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">WaterOutEnthalpy</span>    <span class="p">&amp;</span>
<a name="ln-5253"></a>                    <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">QdotStackCool</span>       <span class="p">&amp;</span>
<a name="ln-5254"></a>                    <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">QdotSkin</span>            <span class="p">&amp;</span>
<a name="ln-5255"></a>                    <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DilutionAirOutEnthalpy</span>
<a name="ln-5256"></a>
<a name="ln-5257"></a>
<a name="ln-5258"></a>
<a name="ln-5259"></a>  <span class="c">! Now find a new total prod Gas Enthalphy that would result in an energy balance</span>
<a name="ln-5260"></a>  <span class="c">! TODO check signs...</span>
<a name="ln-5261"></a>  <span class="n">tmpTotProdGasEnthalphy</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TotProdGasEnthalphy</span> <span class="o">-</span> <span class="n">MagofImbalance</span>
<a name="ln-5262"></a>
<a name="ln-5263"></a>  <span class="c">! solve for a new TprodGasLeavingFCPM using regula falsi method</span>
<a name="ln-5264"></a>
<a name="ln-5265"></a>  <span class="n">Acc</span> <span class="o">=</span> <span class="mf">0.01d0</span>  <span class="c">! guessing need to refine</span>
<a name="ln-5266"></a>  <span class="n">MaxIter</span> <span class="o">=</span> <span class="mi">150</span> <span class="c">! guessing need to refine</span>
<a name="ln-5267"></a>  <span class="n">SolverFlag</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!init</span>
<a name="ln-5268"></a>  <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-5269"></a>  <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpTotProdGasEnthalphy</span>
<a name="ln-5270"></a>  <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotProdGas</span>
<a name="ln-5271"></a>  <span class="n">tmpTprodGas</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TprodGasLeavingFCPM</span>
<a name="ln-5272"></a>  <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIter</span><span class="p">,</span> <span class="n">SolverFlag</span><span class="p">,</span> <span class="n">tmpTprodGas</span><span class="p">,</span> <span class="n">FuelCellProductGasEnthResidual</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5273"></a>     <span class="n">MinProductGasTemp</span><span class="p">,</span><span class="n">MaxProductGasTemp</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-5274"></a>
<a name="ln-5275"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SolverFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5276"></a>
<a name="ln-5277"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;CalcFuelCellGeneratorModel: Regula falsi problem, flag = -2, check signs, all positive&#39;</span><span class="p">)</span>
<a name="ln-5278"></a>
<a name="ln-5279"></a>  <span class="n">ENDIF</span>
<a name="ln-5280"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SolverFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5281"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;CalcFuelCellGeneratorModel: &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5282"></a>       <span class="s1">&#39;Regula falsi problem, flag = -1, check accuracy and iterations, did not converge&#39;</span><span class="p">)</span>
<a name="ln-5283"></a>
<a name="ln-5284"></a>  <span class="n">ENDIF</span>
<a name="ln-5285"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">solverFlag</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5286"></a><span class="k">    </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TprodGasLeavingFCPM</span>  <span class="o">=</span>  <span class="n">tmpTprodGas</span>
<a name="ln-5287"></a>  <span class="c">!  write(*,*) &#39;Number of regula falsi iterations: &#39;, solverFlag</span>
<a name="ln-5288"></a>  <span class="n">ENDIF</span>
<a name="ln-5289"></a>
<a name="ln-5290"></a>
<a name="ln-5291"></a>  <span class="c">!  moved call to HeatBalanceInternalGains.   Call FigureFuelCellZoneGains(GeneratorNum)</span>
<a name="ln-5292"></a>
<a name="ln-5293"></a>  <span class="c">! Control Step 3 determine interaction with electrical storage</span>
<a name="ln-5294"></a>  <span class="c">! How much power is really going into inverter?</span>
<a name="ln-5295"></a>  <span class="n">PintoInverter</span> <span class="o">=</span> <span class="n">Pel</span> <span class="o">+</span> <span class="n">Pstorage</span>    <span class="c">! Back out so we can reapply</span>
<a name="ln-5296"></a>  <span class="k">CALL </span><span class="n">ManageElectStorInteractions</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">Pdemand</span><span class="p">,</span> <span class="n">PpcuLosses</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5297"></a>                                     <span class="n">ConstrainedStorage</span><span class="p">,</span> <span class="n">Pstorage</span><span class="p">,</span> <span class="n">PgridExtra</span><span class="p">)</span>
<a name="ln-5298"></a>  <span class="n">PintoInverter</span> <span class="o">=</span> <span class="n">Pel</span> <span class="o">-</span> <span class="n">Pstorage</span>    <span class="c">!</span>
<a name="ln-5299"></a>  <span class="c">! refine power conditioning losses with more current power production</span>
<a name="ln-5300"></a>
<a name="ln-5301"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">EffMode</span> <span class="o">==</span>  <span class="n">InverterEffConstant</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5302"></a>
<a name="ln-5303"></a><span class="k">     </span><span class="n">PpcuLosses</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">ConstEff</span> <span class="p">)</span><span class="o">*</span> <span class="n">PintoInverter</span>
<a name="ln-5304"></a>
<a name="ln-5305"></a>   <span class="n">ENDIF</span>
<a name="ln-5306"></a>
<a name="ln-5307"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">EffMode</span> <span class="o">==</span>  <span class="n">InverterEffQuadratic</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5308"></a>
<a name="ln-5309"></a><span class="k">     </span><span class="n">PpcuLosses</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">EffQuadraticCurveID</span><span class="p">,</span> <span class="n">PintoInverter</span><span class="p">))</span><span class="o">*</span> <span class="n">PintoInverter</span>
<a name="ln-5310"></a>
<a name="ln-5311"></a>   <span class="n">ENDIF</span>
<a name="ln-5312"></a>
<a name="ln-5313"></a>   <span class="n">PoutofInverter</span> <span class="o">=</span> <span class="n">PintoInverter</span> <span class="o">-</span> <span class="n">PpcuLosses</span>
<a name="ln-5314"></a>
<a name="ln-5315"></a>   <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ACPowerGen</span> <span class="o">=</span> <span class="n">PoutofInverter</span> <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelancillariesAC</span> <span class="p">&amp;</span>
<a name="ln-5316"></a>                                                  <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">PairCompEl</span>     <span class="p">&amp;</span>
<a name="ln-5317"></a>                                                  <span class="o">-</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">PfuelCompEl</span>   <span class="p">&amp;</span>
<a name="ln-5318"></a>                                                  <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">PwaterCompEl</span>
<a name="ln-5319"></a>   <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">PCUlosses</span> <span class="o">=</span> <span class="n">PpcuLosses</span>
<a name="ln-5320"></a>   <span class="c">! model assumes air intake is drawn over power conditioner to recovery heat</span>
<a name="ln-5321"></a>   <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">QairIntake</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">PCUlosses</span>
<a name="ln-5322"></a>
<a name="ln-5323"></a>   <span class="k">Call </span><span class="n">CalcFuelCellAuxHeater</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span>
<a name="ln-5324"></a>
<a name="ln-5325"></a>   <span class="k">Call </span><span class="n">CalcFuelCellGenHeatRecovery</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span>
<a name="ln-5326"></a> <span class="c">! calculation Step 11, If imbalance below threshold, then exit out of do loop.</span>
<a name="ln-5327"></a>
<a name="ln-5328"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MagofImbalance</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">ImBalanceTol</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Pel</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-5329"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Iter</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span>   <span class="k">THEN</span>
<a name="ln-5330"></a><span class="k">    EXIT</span>
<a name="ln-5331"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-5332"></a>
<a name="ln-5333"></a>
<a name="ln-5334"></a><span class="n">ENDDO</span> <span class="c">!sequential substitution loop</span>
<a name="ln-5335"></a>
<a name="ln-5336"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">SeqSubstitIter</span>  <span class="o">=</span> <span class="n">iter</span>
<a name="ln-5337"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">RegulaFalsiIter</span> <span class="o">=</span> <span class="n">solverFlag</span>
<a name="ln-5338"></a>
<a name="ln-5339"></a><span class="k">RETURN</span>
<a name="ln-5340"></a><span class="k">END SUBROUTINE </span><span class="n">CalcFuelCellGeneratorModel</span>
<a name="ln-5341"></a>
<a name="ln-5342"></a><span class="k">SUBROUTINE </span><span class="n">ManageElectStorInteractions</span><span class="p">(</span><span class="n">Num</span><span class="p">,</span><span class="n">Pdemand</span><span class="p">,</span> <span class="n">PpcuLosses</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5343"></a>                             <span class="n">Constrained</span><span class="p">,</span> <span class="n">Pstorage</span><span class="p">,</span> <span class="n">PgridOverage</span><span class="p">)</span>
<a name="ln-5344"></a>
<a name="ln-5345"></a>
<a name="ln-5346"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5347"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-5348"></a>          <span class="c">!       DATE WRITTEN   Aug 2005</span>
<a name="ln-5349"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5350"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5351"></a>
<a name="ln-5352"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5353"></a>          <span class="c">! manage controls and calculations related to electrical storage in FuelCell model</span>
<a name="ln-5354"></a>
<a name="ln-5355"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5356"></a>          <span class="c">!</span>
<a name="ln-5357"></a>
<a name="ln-5358"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5359"></a>          <span class="c">! na</span>
<a name="ln-5360"></a>
<a name="ln-5361"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5362"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-5363"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5364"></a>
<a name="ln-5365"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5366"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Num</span> <span class="c">! Generator number, index for structure</span>
<a name="ln-5367"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Pdemand</span> <span class="c">!</span>
<a name="ln-5368"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PpcuLosses</span>
<a name="ln-5369"></a>  <span class="kt">Logical</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Constrained</span>
<a name="ln-5370"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Pstorage</span>
<a name="ln-5371"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PgridOverage</span>  <span class="c">!electricity that can&#39;t be stored and needs to go out</span>
<a name="ln-5372"></a>
<a name="ln-5373"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5374"></a>          <span class="c">! na</span>
<a name="ln-5375"></a>
<a name="ln-5376"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5377"></a>          <span class="c">! na</span>
<a name="ln-5378"></a>
<a name="ln-5379"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5380"></a>          <span class="c">! na</span>
<a name="ln-5381"></a>
<a name="ln-5382"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5383"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">tmpPdraw</span> <span class="c">! power draw from storage, working var</span>
<a name="ln-5384"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">tmpPcharge</span> <span class="c">! power charge to storage, working var</span>
<a name="ln-5385"></a>  <span class="kt">Logical</span> <span class="kd">::</span> <span class="n">drawing</span> <span class="c">! true if drawing power</span>
<a name="ln-5386"></a>  <span class="kt">Logical</span> <span class="kd">::</span> <span class="n">charging</span> <span class="c">! true if charging</span>
<a name="ln-5387"></a>
<a name="ln-5388"></a>
<a name="ln-5389"></a>   <span class="c">!initialize locals</span>
<a name="ln-5390"></a>  <span class="n">tmpPdraw</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5391"></a>  <span class="n">tmpPcharge</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5392"></a>  <span class="n">drawing</span>  <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5393"></a>  <span class="n">charging</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5394"></a>  <span class="n">Constrained</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5395"></a>  <span class="n">Pstorage</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5396"></a>  <span class="n">PgridOverage</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5397"></a>
<a name="ln-5398"></a>  <span class="c">! step 1 figure out what is desired of electrical storage system</span>
<a name="ln-5399"></a>
<a name="ln-5400"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Pel</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">Pdemand</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5401"></a>    <span class="c">!draw from storage</span>
<a name="ln-5402"></a>    <span class="n">tmpPdraw</span> <span class="o">=</span> <span class="p">(</span><span class="n">Pdemand</span> <span class="p">)</span> <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Pel</span>
<a name="ln-5403"></a>    <span class="n">drawing</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5404"></a>  <span class="n">ENDIF</span>
<a name="ln-5405"></a>
<a name="ln-5406"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Pel</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">Pdemand</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5407"></a>    <span class="c">!add to storage</span>
<a name="ln-5408"></a>    <span class="n">tmpPcharge</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Pel</span> <span class="o">-</span> <span class="p">(</span><span class="n">Pdemand</span> <span class="p">)</span>
<a name="ln-5409"></a>    <span class="n">charging</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5410"></a>
<a name="ln-5411"></a>  <span class="n">ENDIF</span>
<a name="ln-5412"></a>
<a name="ln-5413"></a>  <span class="c">!  step 2, figure out what is possible for electrical storage draws/charges</span>
<a name="ln-5414"></a>
<a name="ln-5415"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">charging</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5416"></a>
<a name="ln-5417"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">SimpleEffConstraints</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5418"></a>
<a name="ln-5419"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="o">&gt;=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">NominalEnergyCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5420"></a>          <span class="c">! storage full!  no more allowed!</span>
<a name="ln-5421"></a>          <span class="n">PgridOverage</span> <span class="o">=</span> <span class="n">tmpPcharge</span>
<a name="ln-5422"></a>          <span class="n">tmpPcharge</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5423"></a>          <span class="n">Constrained</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5424"></a>      <span class="n">ENDIF</span>
<a name="ln-5425"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">tmpPcharge</span> <span class="o">&gt;</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">MaxPowerStore</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5426"></a><span class="k">          </span><span class="n">PgridOverage</span> <span class="o">=</span> <span class="n">tmpPcharge</span> <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">MaxPowerStore</span>
<a name="ln-5427"></a>          <span class="n">tmpPcharge</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">MaxPowerStore</span>
<a name="ln-5428"></a>          <span class="n">Constrained</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5429"></a>      <span class="n">ENDIF</span>
<a name="ln-5430"></a>
<a name="ln-5431"></a>
<a name="ln-5432"></a>      <span class="c">!now add energy to storage from charging</span>
<a name="ln-5433"></a>     <span class="k">IF</span> <span class="p">((</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="p">&amp;</span>
<a name="ln-5434"></a>         <span class="o">+</span> <span class="n">tmpPcharge</span> <span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="o">*</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">EnergeticEfficCharge</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5435"></a>          <span class="o">&lt;</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">NominalEnergyCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5436"></a>
<a name="ln-5437"></a><span class="k">         </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">ThisTimeStepStateOfCharge</span> <span class="o">=</span>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="p">&amp;</span>
<a name="ln-5438"></a>                               <span class="o">+</span> <span class="n">tmpPcharge</span> <span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="o">*</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">EnergeticEfficCharge</span>
<a name="ln-5439"></a>     <span class="k">ELSE</span> <span class="c">! would over charge this time step</span>
<a name="ln-5440"></a>
<a name="ln-5441"></a>        <span class="n">tmpPcharge</span> <span class="o">=</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">NominalEnergyCapacity</span> <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">LastTimeStepStateOfCharge</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5442"></a>                     <span class="o">/</span><span class="p">(</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="o">*</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">EnergeticEfficCharge</span><span class="p">)</span>
<a name="ln-5443"></a>        <span class="n">Constrained</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5444"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">ThisTimeStepStateOfCharge</span> <span class="o">=</span>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="p">&amp;</span>
<a name="ln-5445"></a>                               <span class="o">+</span> <span class="n">tmpPcharge</span> <span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="o">*</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">EnergeticEfficCharge</span>
<a name="ln-5446"></a>     <span class="n">ENDIF</span>
<a name="ln-5447"></a>
<a name="ln-5448"></a>        <span class="c">!losses go into QairIntake</span>
<a name="ln-5449"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">QairIntake</span>  <span class="o">=</span> <span class="n">tmpPcharge</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">EnergeticEfficCharge</span><span class="p">)</span>
<a name="ln-5450"></a>
<a name="ln-5451"></a>
<a name="ln-5452"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">LeadAcidBatterManwellMcGowan</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5453"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;ManageElectStorInteractions: Not yet implemented: Lead Acid Battery By Manwell and McGowan 1993 &#39;</span><span class="p">)</span>
<a name="ln-5454"></a>
<a name="ln-5455"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">LeadAcidBatterySaupe</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5456"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;ManageElectStorInteractions: Not yet implemented: Lead Acid Battery By Saupe 1993 &#39;</span><span class="p">)</span>
<a name="ln-5457"></a>
<a name="ln-5458"></a>    <span class="k">ELSE</span>
<a name="ln-5459"></a>
<a name="ln-5460"></a>      <span class="c">!should not come here</span>
<a name="ln-5461"></a>    <span class="n">ENDIF</span>
<a name="ln-5462"></a>
<a name="ln-5463"></a>    <span class="n">Pstorage</span> <span class="o">=</span> <span class="n">tmpPcharge</span>
<a name="ln-5464"></a>
<a name="ln-5465"></a>  <span class="n">ENDIF</span>  <span class="c">!charging</span>
<a name="ln-5466"></a>
<a name="ln-5467"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">drawing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5468"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">SimpleEffConstraints</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5469"></a>
<a name="ln-5470"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5471"></a>          <span class="c">! storage empty  no more allowed!</span>
<a name="ln-5472"></a>          <span class="n">tmpPdraw</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5473"></a>          <span class="n">Constrained</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5474"></a>          <span class="n">drawing</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5475"></a>      <span class="n">ENDIF</span>
<a name="ln-5476"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">tmpPdraw</span> <span class="o">&gt;</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">MaxPowerDraw</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5477"></a><span class="k">          </span><span class="n">tmpPdraw</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">MaxPowerDraw</span>
<a name="ln-5478"></a>          <span class="n">Constrained</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5479"></a>      <span class="n">ENDIF</span>
<a name="ln-5480"></a>
<a name="ln-5481"></a>            <span class="c">!now take energy from storage by drawing  (amplified by energetic effic)</span>
<a name="ln-5482"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">LastTimeStepStateOfCharge</span>  <span class="p">&amp;</span>
<a name="ln-5483"></a>          <span class="o">-</span> <span class="n">tmpPdraw</span> <span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="o">/</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">EnergeticEfficDischarge</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-5484"></a>
<a name="ln-5485"></a><span class="k">        </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">ThisTimeStepStateOfCharge</span> <span class="o">=</span>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="p">&amp;</span>
<a name="ln-5486"></a>                                <span class="o">-</span> <span class="n">tmpPdraw</span> <span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="o">/</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">EnergeticEfficDischarge</span>
<a name="ln-5487"></a>      <span class="k">ELSE</span> <span class="c">!would over drain storage this timestep so reduce tmpPdraw</span>
<a name="ln-5488"></a>        <span class="n">tmpPdraw</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">EnergeticEfficDischarge</span> <span class="p">&amp;</span>
<a name="ln-5489"></a>                   <span class="o">/</span><span class="p">(</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-5490"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">ThisTimeStepStateOfCharge</span> <span class="o">=</span>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="p">&amp;</span>
<a name="ln-5491"></a>                                <span class="o">-</span> <span class="n">tmpPdraw</span> <span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="o">/</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">EnergeticEfficDischarge</span>
<a name="ln-5492"></a>
<a name="ln-5493"></a>        <span class="n">Constrained</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5494"></a>      <span class="n">ENDIF</span>
<a name="ln-5495"></a>        <span class="c">!losses go into QairIntake</span>
<a name="ln-5496"></a>      <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">QairIntake</span>  <span class="o">=</span> <span class="n">tmpPdraw</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">EnergeticEfficDischarge</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-5497"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">LeadAcidBatterManwellMcGowan</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5498"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;ManageElectStorInteractions: Not yet implemented: Lead Acid Battery By Manwell and McGowan 1993 &#39;</span><span class="p">)</span>
<a name="ln-5499"></a>
<a name="ln-5500"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">LeadAcidBatterySaupe</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5501"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;ManageElectStorInteractions: Not yet implemented: Lead Acid Battery By Saupe 1993 &#39;</span><span class="p">)</span>
<a name="ln-5502"></a>
<a name="ln-5503"></a>    <span class="k">ELSE</span>
<a name="ln-5504"></a>
<a name="ln-5505"></a>      <span class="c">!should not come here</span>
<a name="ln-5506"></a>    <span class="n">ENDIF</span>
<a name="ln-5507"></a>
<a name="ln-5508"></a>    <span class="n">Pstorage</span> <span class="o">=</span> <span class="o">-</span> <span class="n">tmpPdraw</span>
<a name="ln-5509"></a>
<a name="ln-5510"></a>  <span class="n">ENDIF</span> <span class="c">!drawing</span>
<a name="ln-5511"></a>
<a name="ln-5512"></a>  <span class="k">IF</span> <span class="p">((.</span><span class="nb">not</span><span class="p">.</span> <span class="n">charging</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">drawing</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5513"></a>
<a name="ln-5514"></a><span class="k">     </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">ThisTimeStepStateOfCharge</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">LastTimeStepStateOfCharge</span>
<a name="ln-5515"></a>     <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">PelNeedFromStorage</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5516"></a>     <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">PelFromStorage</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5517"></a>     <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">QairIntake</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5518"></a>  <span class="n">ENDIF</span>
<a name="ln-5519"></a>
<a name="ln-5520"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Pstorage</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5521"></a>
<a name="ln-5522"></a><span class="k">    </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">PelIntoStorage</span> <span class="o">=</span> <span class="n">Pstorage</span>
<a name="ln-5523"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">PelFromStorage</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5524"></a>  <span class="n">ENDIF</span>
<a name="ln-5525"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Pstorage</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5526"></a>
<a name="ln-5527"></a><span class="k">    </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">PelIntoStorage</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5528"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">PelFromStorage</span> <span class="o">=</span> <span class="o">-</span> <span class="n">Pstorage</span>
<a name="ln-5529"></a>
<a name="ln-5530"></a>  <span class="n">ENDIF</span>
<a name="ln-5531"></a>
<a name="ln-5532"></a>
<a name="ln-5533"></a>  <span class="k">RETURN</span>
<a name="ln-5534"></a>
<a name="ln-5535"></a><span class="k">END SUBROUTINE </span><span class="n">ManageElectStorInteractions</span>
<a name="ln-5536"></a>
<a name="ln-5537"></a>
<a name="ln-5538"></a><span class="k">FUNCTION </span><span class="n">FuelCellProductGasEnthResidual</span><span class="p">(</span><span class="n">TprodGas</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-5539"></a>
<a name="ln-5540"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5541"></a>          <span class="c">!       AUTHOR         Brent Griffith NREL</span>
<a name="ln-5542"></a>          <span class="c">!       DATE WRITTEN   Aug 2005</span>
<a name="ln-5543"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5544"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5545"></a>
<a name="ln-5546"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5547"></a>          <span class="c">! Provide function for call to regula falsi search</span>
<a name="ln-5548"></a>          <span class="c">! Search for an product gas stream temperature that provides a</span>
<a name="ln-5549"></a>          <span class="c">! certain enthaply. (enthalpy is based on Shomate and can&#39;t be inverted)</span>
<a name="ln-5550"></a>
<a name="ln-5551"></a>
<a name="ln-5552"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5553"></a>          <span class="c">! Calculates residual function for product gas enthalpy</span>
<a name="ln-5554"></a>          <span class="c">! calls procedure FigureProductGasesEnthalpy</span>
<a name="ln-5555"></a>
<a name="ln-5556"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5557"></a>          <span class="c">! na</span>
<a name="ln-5558"></a>
<a name="ln-5559"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5560"></a>          <span class="c">! na</span>
<a name="ln-5561"></a>
<a name="ln-5562"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5563"></a>
<a name="ln-5564"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5565"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TprodGas</span> <span class="c">! temperature, this is &quot;x&quot; being searched</span>
<a name="ln-5566"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">Dimension</span><span class="p">(:),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = Generator Number</span>
<a name="ln-5567"></a>                                        <span class="c">! par(2) = Desired Enthalpy</span>
<a name="ln-5568"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! F(x)</span>
<a name="ln-5569"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5570"></a>          <span class="c">! na</span>
<a name="ln-5571"></a>
<a name="ln-5572"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5573"></a>          <span class="c">! na</span>
<a name="ln-5574"></a>
<a name="ln-5575"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5576"></a>          <span class="c">! na</span>
<a name="ln-5577"></a>
<a name="ln-5578"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5579"></a>  <span class="kt">Integer</span>  <span class="kd">::</span> <span class="n">GeneratorNum</span>
<a name="ln-5580"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">thisHmolalProdGases</span>
<a name="ln-5581"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">desiredHprodGases</span>
<a name="ln-5582"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">NdotProdGases</span>
<a name="ln-5583"></a>
<a name="ln-5584"></a>  <span class="n">GeneratorNum</span>      <span class="o">=</span> <span class="nb">floor</span><span class="p">(</span><span class="n">PAR</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-5585"></a>  <span class="n">desiredHprodGases</span> <span class="o">=</span> <span class="n">PAR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5586"></a>  <span class="n">NdotProdGases</span>     <span class="o">=</span> <span class="n">PAR</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-5587"></a>
<a name="ln-5588"></a>  <span class="k">Call </span><span class="n">FigureProductGasesEnthalpy</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">TprodGas</span><span class="p">,</span> <span class="n">thisHmolalProdGases</span><span class="p">)</span>
<a name="ln-5589"></a>
<a name="ln-5590"></a>  <span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">thisHmolalProdGases</span> <span class="o">*</span> <span class="n">NdotProdGases</span> <span class="o">*</span> <span class="mi">100000</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="o">-</span> <span class="n">desiredHprodGases</span>
<a name="ln-5591"></a>
<a name="ln-5592"></a>  <span class="k">RETURN</span>
<a name="ln-5593"></a>
<a name="ln-5594"></a><span class="k">END FUNCTION </span><span class="n">FuelCellProductGasEnthResidual</span>
<a name="ln-5595"></a>
<a name="ln-5596"></a><span class="k">SUBROUTINE </span><span class="n">FigureAirHeatCap</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">FluidTemp</span><span class="p">,</span> <span class="n">Cp</span><span class="p">)</span>
<a name="ln-5597"></a>
<a name="ln-5598"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5599"></a>          <span class="c">!       AUTHOR         B griffith</span>
<a name="ln-5600"></a>          <span class="c">!       DATE WRITTEN   August 2005</span>
<a name="ln-5601"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5602"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5603"></a>
<a name="ln-5604"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5605"></a>          <span class="c">! calculate Cp from Shomate equations for fuel</span>
<a name="ln-5606"></a>
<a name="ln-5607"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5608"></a>          <span class="c">! sum by weighting molar fractions of all Air constituents.</span>
<a name="ln-5609"></a>          <span class="c">! assumes mixture is sum of parts.</span>
<a name="ln-5610"></a>
<a name="ln-5611"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5612"></a>          <span class="c">! NIST Webbook on gas phase thermochemistry</span>
<a name="ln-5613"></a>
<a name="ln-5614"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5615"></a>          <span class="c">! na</span>
<a name="ln-5616"></a>
<a name="ln-5617"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5618"></a>
<a name="ln-5619"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5620"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">GeneratorNum</span> <span class="c">! ID of generator FuelCell data structure</span>
<a name="ln-5621"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">FluidTemp</span>    <span class="c">! degree C</span>
<a name="ln-5622"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span>   <span class="n">Cp</span>           <span class="c">!  (J/mol*K)</span>
<a name="ln-5623"></a>
<a name="ln-5624"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5625"></a>          <span class="c">! na</span>
<a name="ln-5626"></a>
<a name="ln-5627"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5628"></a>          <span class="c">! na</span>
<a name="ln-5629"></a>
<a name="ln-5630"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5631"></a>          <span class="c">! na</span>
<a name="ln-5632"></a>
<a name="ln-5633"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5634"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tsho</span> <span class="c">! temp for Shomate eq  in (Kelvin/1000)</span>
<a name="ln-5635"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tkel</span> <span class="c">! temp for NASA eq. in Kelvin</span>
<a name="ln-5636"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">tempCp</span>
<a name="ln-5637"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">thisConstit</span> <span class="c">!loop index</span>
<a name="ln-5638"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">gasID</span> <span class="c">!</span>
<a name="ln-5639"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span> <span class="c">! shomate coeff</span>
<a name="ln-5640"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B</span> <span class="c">! shomate coeff</span>
<a name="ln-5641"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">C</span> <span class="c">! shomate coeff</span>
<a name="ln-5642"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">D</span> <span class="c">! shomate coeff</span>
<a name="ln-5643"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">E</span> <span class="c">! shomate coeff</span>
<a name="ln-5644"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A1</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5645"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A2</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5646"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A3</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5647"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A4</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5648"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A5</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5649"></a>
<a name="ln-5650"></a>
<a name="ln-5651"></a>  <span class="c">! loop through fuel constituents and sum up Cp</span>
<a name="ln-5652"></a>
<a name="ln-5653"></a>  <span class="c">! two different themodynamic curve fits might be used</span>
<a name="ln-5654"></a>
<a name="ln-5655"></a>  <span class="n">tempCp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5656"></a>  <span class="n">Tkel</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span>
<a name="ln-5657"></a>  <span class="n">Tsho</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5658"></a>
<a name="ln-5659"></a>  <span class="k">DO </span><span class="n">thisConstit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">NumConstituents</span>
<a name="ln-5660"></a>    <span class="n">gasID</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-5661"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gasID</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5662"></a><span class="k">     IF</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">==</span> <span class="n">NISTShomate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5663"></a>
<a name="ln-5664"></a><span class="k">       </span><span class="n">A</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateA</span>
<a name="ln-5665"></a>       <span class="n">B</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateB</span>
<a name="ln-5666"></a>       <span class="n">C</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateC</span>
<a name="ln-5667"></a>       <span class="n">D</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateD</span>
<a name="ln-5668"></a>       <span class="n">E</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateE</span>
<a name="ln-5669"></a>
<a name="ln-5670"></a>       <span class="n">tempCp</span> <span class="o">=</span> <span class="n">tempCp</span> <span class="o">+</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">Tsho</span> <span class="o">+</span> <span class="n">C</span><span class="o">*</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-5671"></a>                      <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">))</span>
<a name="ln-5672"></a>     <span class="n">ENDIF</span>
<a name="ln-5673"></a>
<a name="ln-5674"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">==</span> <span class="n">NASAPolynomial</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5675"></a>
<a name="ln-5676"></a><span class="k">       </span><span class="n">A1</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A1</span>
<a name="ln-5677"></a>       <span class="n">A2</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A2</span>
<a name="ln-5678"></a>       <span class="n">A3</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A3</span>
<a name="ln-5679"></a>       <span class="n">A4</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A4</span>
<a name="ln-5680"></a>       <span class="n">A5</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A5</span>
<a name="ln-5681"></a>
<a name="ln-5682"></a>       <span class="n">tempCp</span> <span class="o">=</span> <span class="n">tempCp</span> <span class="o">+</span> <span class="p">(</span><span class="n">A1</span> <span class="o">+</span> <span class="n">A2</span><span class="o">*</span><span class="n">Tkel</span> <span class="o">+</span> <span class="n">A3</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">A4</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">A5</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">RinKJperMolpK</span> <span class="p">&amp;</span>
<a name="ln-5683"></a>                      <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-5684"></a>
<a name="ln-5685"></a>     <span class="n">ENDIF</span>
<a name="ln-5686"></a>    <span class="n">ENDIF</span>
<a name="ln-5687"></a>  <span class="n">ENDDO</span>
<a name="ln-5688"></a>
<a name="ln-5689"></a>  <span class="n">Cp</span> <span class="o">=</span> <span class="n">tempCp</span>
<a name="ln-5690"></a>
<a name="ln-5691"></a>  <span class="k">RETURN</span>
<a name="ln-5692"></a>
<a name="ln-5693"></a><span class="k">END SUBROUTINE </span><span class="n">FigureAirHeatCap</span>
<a name="ln-5694"></a>
<a name="ln-5695"></a><span class="k">SUBROUTINE </span><span class="n">FigureAirEnthalpy</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">FluidTemp</span><span class="p">,</span> <span class="n">Hair</span><span class="p">)</span>
<a name="ln-5696"></a>
<a name="ln-5697"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5698"></a>          <span class="c">!       AUTHOR         B griffith</span>
<a name="ln-5699"></a>          <span class="c">!       DATE WRITTEN   August 2005</span>
<a name="ln-5700"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5701"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5702"></a>
<a name="ln-5703"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5704"></a>          <span class="c">! calculate Enthalpy from Shomate equations for fuel</span>
<a name="ln-5705"></a>
<a name="ln-5706"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5707"></a>          <span class="c">! sum by weighting molar fractions of all fuel constituents.</span>
<a name="ln-5708"></a>          <span class="c">! assumes mixture is sum of parts.</span>
<a name="ln-5709"></a>
<a name="ln-5710"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5711"></a>          <span class="c">! NIST Webbook on gas phase thermochemistry</span>
<a name="ln-5712"></a>
<a name="ln-5713"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5714"></a>          <span class="c">! na</span>
<a name="ln-5715"></a>
<a name="ln-5716"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5717"></a>
<a name="ln-5718"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5719"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">GeneratorNum</span> <span class="c">! ID of generator FuelCell data structure</span>
<a name="ln-5720"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">FluidTemp</span>    <span class="c">! degree C</span>
<a name="ln-5721"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span>   <span class="n">Hair</span>         <span class="c">! (kJ/mol)</span>
<a name="ln-5722"></a>
<a name="ln-5723"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5724"></a>          <span class="c">! na</span>
<a name="ln-5725"></a>
<a name="ln-5726"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5727"></a>          <span class="c">! na</span>
<a name="ln-5728"></a>
<a name="ln-5729"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5730"></a>          <span class="c">! na</span>
<a name="ln-5731"></a>
<a name="ln-5732"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5733"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tsho</span> <span class="c">! temp for Shomate eq  in (Kelvin/1000)</span>
<a name="ln-5734"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tkel</span> <span class="c">! temp for NASA eq. in Kelvin</span>
<a name="ln-5735"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">tempHair</span>
<a name="ln-5736"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HairI</span>
<a name="ln-5737"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">thisConstit</span> <span class="c">!loop index</span>
<a name="ln-5738"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">gasID</span> <span class="c">!look up into Gas structure</span>
<a name="ln-5739"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span> <span class="c">! shomate coeff</span>
<a name="ln-5740"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B</span> <span class="c">! shomate coeff</span>
<a name="ln-5741"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">C</span> <span class="c">! shomate coeff</span>
<a name="ln-5742"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">D</span> <span class="c">! shomate coeff</span>
<a name="ln-5743"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">E</span> <span class="c">! shomate coeff</span>
<a name="ln-5744"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">F</span> <span class="c">! shomate coeff</span>
<a name="ln-5745"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H</span> <span class="c">! shomate coeff</span>
<a name="ln-5746"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A1</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5747"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A2</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5748"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A3</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5749"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A4</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5750"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A5</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5751"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A6</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5752"></a>
<a name="ln-5753"></a>  <span class="n">Tsho</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5754"></a>  <span class="n">Tkel</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span>
<a name="ln-5755"></a>  <span class="c">! loop through fuel constituents and sum up Cp</span>
<a name="ln-5756"></a>
<a name="ln-5757"></a>  <span class="n">tempHair</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5758"></a>
<a name="ln-5759"></a>  <span class="k">DO </span><span class="n">thisConstit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">NumConstituents</span>
<a name="ln-5760"></a>    <span class="n">gasID</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-5761"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">gasID</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5762"></a><span class="k">     If</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">==</span> <span class="n">NISTShomate</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5763"></a>
<a name="ln-5764"></a><span class="k">       </span><span class="n">A</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateA</span>
<a name="ln-5765"></a>       <span class="n">B</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateB</span>
<a name="ln-5766"></a>       <span class="n">C</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateC</span>
<a name="ln-5767"></a>       <span class="n">D</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateD</span>
<a name="ln-5768"></a>       <span class="n">E</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateE</span>
<a name="ln-5769"></a>       <span class="n">F</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateF</span>
<a name="ln-5770"></a>       <span class="n">H</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateH</span>
<a name="ln-5771"></a>
<a name="ln-5772"></a>       <span class="n">HairI</span> <span class="o">=</span>  <span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">Tsho</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span> <span class="o">+</span> <span class="n">C</span><span class="o">*</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">3.0d0</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="mf">4.0d0</span> <span class="o">-</span> <span class="n">E</span><span class="o">/</span><span class="n">Tsho</span> <span class="o">+</span> <span class="n">F</span> <span class="o">-</span> <span class="n">H</span> <span class="p">)</span>
<a name="ln-5773"></a>
<a name="ln-5774"></a>       <span class="n">tempHair</span> <span class="o">=</span> <span class="n">tempHair</span> <span class="o">+</span> <span class="n">HairI</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-5775"></a>
<a name="ln-5776"></a>     <span class="n">ENDIF</span>
<a name="ln-5777"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">==</span> <span class="n">NASAPolynomial</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5778"></a><span class="k">       </span><span class="n">A1</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A1</span>
<a name="ln-5779"></a>       <span class="n">A2</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A2</span>
<a name="ln-5780"></a>       <span class="n">A3</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A3</span>
<a name="ln-5781"></a>       <span class="n">A4</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A4</span>
<a name="ln-5782"></a>       <span class="n">A5</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A5</span>
<a name="ln-5783"></a>       <span class="n">A6</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A6</span>
<a name="ln-5784"></a>
<a name="ln-5785"></a>       <span class="n">tempHair</span> <span class="o">=</span> <span class="n">tempHair</span> <span class="o">+</span> <span class="p">(</span> <span class="p">(</span> <span class="p">(</span><span class="n">A1</span> <span class="o">+</span> <span class="n">A2</span><span class="o">*</span><span class="n">Tkel</span><span class="o">/</span><span class="mf">2.0d0</span> <span class="o">+</span> <span class="n">A3</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">3.0d0</span> <span class="o">+</span> <span class="n">A4</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mf">4.0d0</span> <span class="o">+</span> <span class="n">A5</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="mf">5.0d0</span> <span class="o">+</span> <span class="n">A6</span><span class="o">/</span><span class="n">Tkel</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5786"></a>                               <span class="o">*</span> <span class="n">RinKJperMolpK</span> <span class="o">*</span> <span class="n">Tkel</span><span class="p">)</span> <span class="o">-</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5787"></a>                               <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-5788"></a>     <span class="n">ENDIF</span>
<a name="ln-5789"></a>    <span class="n">ENDIF</span>
<a name="ln-5790"></a>  <span class="n">ENDDO</span>
<a name="ln-5791"></a>
<a name="ln-5792"></a>  <span class="n">Hair</span> <span class="o">=</span> <span class="n">tempHair</span>
<a name="ln-5793"></a>
<a name="ln-5794"></a>  <span class="k">RETURN</span>
<a name="ln-5795"></a>
<a name="ln-5796"></a><span class="k">END SUBROUTINE </span><span class="n">FigureAirEnthalpy</span>
<a name="ln-5797"></a>
<a name="ln-5798"></a><span class="k">SUBROUTINE </span><span class="n">FigureFuelHeatCap</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">FluidTemp</span><span class="p">,</span> <span class="n">Cp</span><span class="p">)</span>
<a name="ln-5799"></a>
<a name="ln-5800"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5801"></a>          <span class="c">!       AUTHOR         B griffith</span>
<a name="ln-5802"></a>          <span class="c">!       DATE WRITTEN   August 2005</span>
<a name="ln-5803"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5804"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5805"></a>
<a name="ln-5806"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5807"></a>          <span class="c">! calculate Cp from Shomate equations for fuel</span>
<a name="ln-5808"></a>
<a name="ln-5809"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5810"></a>          <span class="c">! sum by weighting molar fractions of all fuel constituents.</span>
<a name="ln-5811"></a>          <span class="c">! assumes mixture is sum of parts.</span>
<a name="ln-5812"></a>
<a name="ln-5813"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5814"></a>          <span class="c">! NIST Webbook on gas phase thermochemistry</span>
<a name="ln-5815"></a>
<a name="ln-5816"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5817"></a>          <span class="c">! na</span>
<a name="ln-5818"></a>
<a name="ln-5819"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5820"></a>
<a name="ln-5821"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5822"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">GeneratorNum</span> <span class="c">! ID of generator FuelCell data structure</span>
<a name="ln-5823"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">FluidTemp</span>    <span class="c">! degree C</span>
<a name="ln-5824"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span>   <span class="n">Cp</span>           <span class="c">!  (J/mol*K)</span>
<a name="ln-5825"></a>
<a name="ln-5826"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5827"></a>          <span class="c">! na</span>
<a name="ln-5828"></a>
<a name="ln-5829"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5830"></a>          <span class="c">! na</span>
<a name="ln-5831"></a>
<a name="ln-5832"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5833"></a>          <span class="c">! na</span>
<a name="ln-5834"></a>
<a name="ln-5835"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5836"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tsho</span> <span class="c">! temp for Shomate eq  in (Kelvin/1000)</span>
<a name="ln-5837"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tkel</span> <span class="c">! temp for NASA eq. in Kelvin</span>
<a name="ln-5838"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">tempCp</span>
<a name="ln-5839"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">thisConstit</span> <span class="c">!loop index</span>
<a name="ln-5840"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">gasID</span> <span class="c">!look up into Gas structure</span>
<a name="ln-5841"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span> <span class="c">! shomate coeff</span>
<a name="ln-5842"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B</span> <span class="c">! shomate coeff</span>
<a name="ln-5843"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">C</span> <span class="c">! shomate coeff</span>
<a name="ln-5844"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">D</span> <span class="c">! shomate coeff</span>
<a name="ln-5845"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">E</span> <span class="c">! shomate coeff</span>
<a name="ln-5846"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A1</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5847"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A2</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5848"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A3</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5849"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A4</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5850"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A5</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5851"></a>
<a name="ln-5852"></a>  <span class="n">Tsho</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5853"></a>  <span class="n">Tkel</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span>
<a name="ln-5854"></a>  <span class="c">! loop through fuel constituents and sum up Cp</span>
<a name="ln-5855"></a>
<a name="ln-5856"></a>  <span class="n">tempCp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5857"></a>
<a name="ln-5858"></a>  <span class="k">DO </span><span class="n">thisConstit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">NumConstituents</span>
<a name="ln-5859"></a>    <span class="n">gasID</span> <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">GasLibID</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-5860"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GasID</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5861"></a><span class="k">     IF</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">==</span> <span class="n">NISTShomate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5862"></a>
<a name="ln-5863"></a><span class="k">       </span><span class="n">A</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateA</span>
<a name="ln-5864"></a>       <span class="n">B</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateB</span>
<a name="ln-5865"></a>       <span class="n">C</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateC</span>
<a name="ln-5866"></a>       <span class="n">D</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateD</span>
<a name="ln-5867"></a>       <span class="n">E</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateE</span>
<a name="ln-5868"></a>
<a name="ln-5869"></a>       <span class="n">tempCp</span> <span class="o">=</span> <span class="n">tempCp</span> <span class="o">+</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">Tsho</span> <span class="o">+</span> <span class="n">C</span><span class="o">*</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-5870"></a>                       <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">))</span>
<a name="ln-5871"></a>     <span class="n">ENDIF</span>
<a name="ln-5872"></a>
<a name="ln-5873"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">==</span> <span class="n">NASAPolynomial</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5874"></a><span class="k">       </span><span class="n">A1</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A1</span>
<a name="ln-5875"></a>       <span class="n">A2</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A2</span>
<a name="ln-5876"></a>       <span class="n">A3</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A3</span>
<a name="ln-5877"></a>       <span class="n">A4</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A4</span>
<a name="ln-5878"></a>       <span class="n">A5</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A5</span>
<a name="ln-5879"></a>
<a name="ln-5880"></a>       <span class="n">tempCp</span> <span class="o">=</span> <span class="n">tempCp</span> <span class="o">+</span> <span class="p">(</span><span class="n">A1</span> <span class="o">+</span> <span class="n">A2</span><span class="o">*</span><span class="n">Tkel</span> <span class="o">+</span> <span class="n">A3</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">A4</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">A5</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">RinKJperMolpK</span> <span class="p">&amp;</span>
<a name="ln-5881"></a>                      <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-5882"></a>
<a name="ln-5883"></a>     <span class="n">ENDIF</span>
<a name="ln-5884"></a>    <span class="n">ENDIF</span>
<a name="ln-5885"></a>  <span class="n">ENDDO</span>
<a name="ln-5886"></a>
<a name="ln-5887"></a>  <span class="n">Cp</span> <span class="o">=</span> <span class="n">tempCp</span>
<a name="ln-5888"></a>
<a name="ln-5889"></a>  <span class="k">RETURN</span>
<a name="ln-5890"></a>
<a name="ln-5891"></a><span class="k">END SUBROUTINE </span><span class="n">FigureFuelHeatCap</span>
<a name="ln-5892"></a>
<a name="ln-5893"></a><span class="k">SUBROUTINE </span><span class="n">FigureFuelEnthalpy</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">FluidTemp</span><span class="p">,</span> <span class="n">Hfuel</span><span class="p">)</span>
<a name="ln-5894"></a>
<a name="ln-5895"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5896"></a>          <span class="c">!       AUTHOR         B griffith</span>
<a name="ln-5897"></a>          <span class="c">!       DATE WRITTEN   August 2005</span>
<a name="ln-5898"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5899"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5900"></a>
<a name="ln-5901"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5902"></a>          <span class="c">! calculate Enthalpy from Shomate equations for fuel</span>
<a name="ln-5903"></a>
<a name="ln-5904"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5905"></a>          <span class="c">! sum by weighting molar fractions of all fuel constituents.</span>
<a name="ln-5906"></a>          <span class="c">! assumes mixture is sum of parts.</span>
<a name="ln-5907"></a>
<a name="ln-5908"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5909"></a>          <span class="c">! NIST Webbook on gas phase thermochemistry</span>
<a name="ln-5910"></a>
<a name="ln-5911"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5912"></a>          <span class="c">! na</span>
<a name="ln-5913"></a>
<a name="ln-5914"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5915"></a>
<a name="ln-5916"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5917"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">GeneratorNum</span> <span class="c">! ID of generator FuelCell data structure</span>
<a name="ln-5918"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">FluidTemp</span>    <span class="c">! degree C</span>
<a name="ln-5919"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span>   <span class="n">Hfuel</span>        <span class="c">! kJ/mol</span>
<a name="ln-5920"></a>
<a name="ln-5921"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5922"></a>          <span class="c">! na</span>
<a name="ln-5923"></a>
<a name="ln-5924"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-5925"></a>          <span class="c">! na</span>
<a name="ln-5926"></a>
<a name="ln-5927"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-5928"></a>          <span class="c">! na</span>
<a name="ln-5929"></a>
<a name="ln-5930"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5931"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tsho</span> <span class="c">! temp for Shomate eq  in (Kelvin/1000)</span>
<a name="ln-5932"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tkel</span> <span class="c">! temp for NASA eq. in Kelvin</span>
<a name="ln-5933"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">tempHfuel</span>
<a name="ln-5934"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HfuelI</span>
<a name="ln-5935"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">thisConstit</span> <span class="c">!loop index</span>
<a name="ln-5936"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">gasID</span> <span class="c">!look up into Gas structure</span>
<a name="ln-5937"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span> <span class="c">! shomate coeff</span>
<a name="ln-5938"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B</span> <span class="c">! shomate coeff</span>
<a name="ln-5939"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">C</span> <span class="c">! shomate coeff</span>
<a name="ln-5940"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">D</span> <span class="c">! shomate coeff</span>
<a name="ln-5941"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">E</span> <span class="c">! shomate coeff</span>
<a name="ln-5942"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">F</span> <span class="c">! shomate coeff</span>
<a name="ln-5943"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H</span> <span class="c">! shomate coeff</span>
<a name="ln-5944"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A1</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5945"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A2</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5946"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A3</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5947"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A4</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5948"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A5</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5949"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A6</span> <span class="c">! NASA poly coeff</span>
<a name="ln-5950"></a>
<a name="ln-5951"></a>  <span class="n">Tsho</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5952"></a>  <span class="n">Tkel</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span>
<a name="ln-5953"></a>  <span class="c">! loop through fuel constituents and sum up Cp</span>
<a name="ln-5954"></a>
<a name="ln-5955"></a>  <span class="n">tempHfuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5956"></a>
<a name="ln-5957"></a>  <span class="k">DO </span><span class="n">thisConstit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">NumConstituents</span>
<a name="ln-5958"></a>    <span class="n">gasID</span> <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">GasLibID</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-5959"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gasID</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5960"></a><span class="k">     IF</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">==</span> <span class="n">NISTShomate</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5961"></a><span class="k">       </span><span class="n">A</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateA</span>
<a name="ln-5962"></a>       <span class="n">B</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateB</span>
<a name="ln-5963"></a>       <span class="n">C</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateC</span>
<a name="ln-5964"></a>       <span class="n">D</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateD</span>
<a name="ln-5965"></a>       <span class="n">E</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateE</span>
<a name="ln-5966"></a>       <span class="n">F</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateF</span>
<a name="ln-5967"></a>       <span class="n">H</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateH</span>
<a name="ln-5968"></a>
<a name="ln-5969"></a>       <span class="n">HfuelI</span>  <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">Tsho</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span> <span class="o">+</span> <span class="n">C</span><span class="o">*</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">3.0d0</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="mf">4.0d0</span> <span class="o">-</span> <span class="n">E</span><span class="o">/</span><span class="n">Tsho</span> <span class="o">+</span> <span class="n">F</span> <span class="o">-</span> <span class="n">H</span> <span class="p">)</span>
<a name="ln-5970"></a>
<a name="ln-5971"></a>       <span class="n">tempHfuel</span> <span class="o">=</span> <span class="n">tempHfuel</span> <span class="o">+</span> <span class="n">HfuelI</span><span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-5972"></a>
<a name="ln-5973"></a>     <span class="n">ENDIF</span>
<a name="ln-5974"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">==</span> <span class="n">NASAPolynomial</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5975"></a>
<a name="ln-5976"></a><span class="k">       </span><span class="n">A1</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A1</span>
<a name="ln-5977"></a>       <span class="n">A2</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A2</span>
<a name="ln-5978"></a>       <span class="n">A3</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A3</span>
<a name="ln-5979"></a>       <span class="n">A4</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A4</span>
<a name="ln-5980"></a>       <span class="n">A5</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A5</span>
<a name="ln-5981"></a>       <span class="n">A6</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A6</span>
<a name="ln-5982"></a>
<a name="ln-5983"></a>       <span class="n">tempHfuel</span> <span class="o">=</span> <span class="n">tempHfuel</span> <span class="o">+</span> <span class="p">(((</span><span class="n">A1</span> <span class="o">+</span> <span class="n">A2</span><span class="o">*</span><span class="n">Tkel</span><span class="o">/</span><span class="mf">2.0d0</span> <span class="o">+</span> <span class="n">A3</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">3.0d0</span> <span class="o">+</span> <span class="n">A4</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mf">4.0d0</span> <span class="o">+</span> <span class="n">A5</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="mf">5.0d0</span> <span class="o">+</span> <span class="n">A6</span><span class="o">/</span><span class="n">Tkel</span><span class="p">)</span>      <span class="p">&amp;</span>
<a name="ln-5984"></a>                               <span class="o">*</span> <span class="n">RinKJperMolpK</span> <span class="o">*</span> <span class="n">Tkel</span><span class="p">)</span> <span class="o">-</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5985"></a>                               <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-5986"></a>     <span class="n">ENDIF</span>
<a name="ln-5987"></a>    <span class="n">ENDIF</span>
<a name="ln-5988"></a>  <span class="n">ENDDO</span>
<a name="ln-5989"></a>
<a name="ln-5990"></a>  <span class="n">Hfuel</span> <span class="o">=</span> <span class="n">tempHfuel</span>
<a name="ln-5991"></a>
<a name="ln-5992"></a>  <span class="k">RETURN</span>
<a name="ln-5993"></a>
<a name="ln-5994"></a><span class="k">END SUBROUTINE </span><span class="n">FigureFuelEnthalpy</span>
<a name="ln-5995"></a>
<a name="ln-5996"></a><span class="k">SUBROUTINE </span><span class="n">FigureProductGasesEnthalpy</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">FluidTemp</span><span class="p">,</span> <span class="n">HProdGases</span><span class="p">)</span>
<a name="ln-5997"></a>
<a name="ln-5998"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5999"></a>          <span class="c">!       AUTHOR         B griffith</span>
<a name="ln-6000"></a>          <span class="c">!       DATE WRITTEN   August 2005</span>
<a name="ln-6001"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6002"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6003"></a>
<a name="ln-6004"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6005"></a>          <span class="c">! calculate Enthalpy from Shomate equations for gases</span>
<a name="ln-6006"></a>
<a name="ln-6007"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6008"></a>          <span class="c">! sum by weighting molar fractions of all product gas constituents.</span>
<a name="ln-6009"></a>          <span class="c">! assumes mixture is sum of parts.</span>
<a name="ln-6010"></a>
<a name="ln-6011"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6012"></a>          <span class="c">! NIST Webbook on gas phase thermochemistry</span>
<a name="ln-6013"></a>
<a name="ln-6014"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6015"></a>          <span class="c">! na</span>
<a name="ln-6016"></a>
<a name="ln-6017"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6018"></a>
<a name="ln-6019"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6020"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">GeneratorNum</span> <span class="c">! ID of generator FuelCell data structure</span>
<a name="ln-6021"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">FluidTemp</span>    <span class="c">! degree C</span>
<a name="ln-6022"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span>   <span class="n">HProdGases</span>   <span class="c">! kJ/mol</span>
<a name="ln-6023"></a>
<a name="ln-6024"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6025"></a>          <span class="c">! na</span>
<a name="ln-6026"></a>
<a name="ln-6027"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6028"></a>          <span class="c">! na</span>
<a name="ln-6029"></a>
<a name="ln-6030"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6031"></a>          <span class="c">! na</span>
<a name="ln-6032"></a>
<a name="ln-6033"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6034"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tsho</span> <span class="c">! temp for Shomate eq  in (Kelvin/1000)</span>
<a name="ln-6035"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tkel</span> <span class="c">! temp for NASA eq. in Kelvin</span>
<a name="ln-6036"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">tempHprodGases</span>
<a name="ln-6037"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">thisConstit</span> <span class="c">!loop index</span>
<a name="ln-6038"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">gasID</span> <span class="c">!look up into Gas structure</span>
<a name="ln-6039"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span> <span class="c">! shomate coeff</span>
<a name="ln-6040"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B</span> <span class="c">! shomate coeff</span>
<a name="ln-6041"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">C</span> <span class="c">! shomate coeff</span>
<a name="ln-6042"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">D</span> <span class="c">! shomate coeff</span>
<a name="ln-6043"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">E</span> <span class="c">! shomate coeff</span>
<a name="ln-6044"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">F</span> <span class="c">! shomate coeff</span>
<a name="ln-6045"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H</span> <span class="c">! shomate coeff</span>
<a name="ln-6046"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A1</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6047"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A2</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6048"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A3</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6049"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A4</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6050"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A5</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6051"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A6</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6052"></a>
<a name="ln-6053"></a>  <span class="n">Tsho</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-6054"></a>  <span class="n">Tkel</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span>
<a name="ln-6055"></a>  <span class="c">! loop through fuel constituents and sum up Cp</span>
<a name="ln-6056"></a>
<a name="ln-6057"></a>  <span class="n">tempHprodGases</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6058"></a>
<a name="ln-6059"></a>  <span class="k">DO </span><span class="n">thisConstit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span>
<a name="ln-6060"></a>    <span class="n">gasID</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-6061"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gasID</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6062"></a><span class="k">     If</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">==</span> <span class="n">NISTShomate</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-6063"></a><span class="k">       </span><span class="n">A</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateA</span>
<a name="ln-6064"></a>       <span class="n">B</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateB</span>
<a name="ln-6065"></a>       <span class="n">C</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateC</span>
<a name="ln-6066"></a>       <span class="n">D</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateD</span>
<a name="ln-6067"></a>       <span class="n">E</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateE</span>
<a name="ln-6068"></a>       <span class="n">F</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateF</span>
<a name="ln-6069"></a>       <span class="n">H</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateH</span>
<a name="ln-6070"></a>
<a name="ln-6071"></a>       <span class="n">tempHprodGases</span> <span class="o">=</span> <span class="n">tempHprodGases</span> <span class="o">+</span> <span class="p">(</span> <span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">Tsho</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span> <span class="o">+</span> <span class="n">C</span><span class="o">*</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">3.0d0</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="mf">4.0d0</span> <span class="o">-</span> <span class="n">E</span><span class="o">/</span><span class="n">Tsho</span> <span class="o">+</span> <span class="n">F</span> <span class="o">-</span> <span class="n">H</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6072"></a>                               <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-6073"></a>     <span class="n">ENDIF</span>
<a name="ln-6074"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">==</span> <span class="n">NASAPolynomial</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6075"></a><span class="k">       </span><span class="n">A1</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A1</span>
<a name="ln-6076"></a>       <span class="n">A2</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A2</span>
<a name="ln-6077"></a>       <span class="n">A3</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A3</span>
<a name="ln-6078"></a>       <span class="n">A4</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A4</span>
<a name="ln-6079"></a>       <span class="n">A5</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A5</span>
<a name="ln-6080"></a>       <span class="n">A6</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A6</span>
<a name="ln-6081"></a>
<a name="ln-6082"></a>       <span class="n">tempHprodGases</span> <span class="o">=</span> <span class="n">tempHprodGases</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-6083"></a>                 <span class="p">(((</span><span class="n">A1</span> <span class="o">+</span> <span class="n">A2</span><span class="o">*</span><span class="n">Tkel</span><span class="o">/</span><span class="mf">2.0d0</span> <span class="o">+</span> <span class="n">A3</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">3.0d0</span> <span class="o">+</span> <span class="n">A4</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mf">4.0d0</span> <span class="o">+</span> <span class="n">A5</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="mf">5.0d0</span> <span class="o">+</span> <span class="n">A6</span><span class="o">/</span><span class="n">Tkel</span><span class="p">)</span>     <span class="p">&amp;</span>
<a name="ln-6084"></a>                   <span class="o">*</span> <span class="n">RinKJperMolpK</span> <span class="o">*</span> <span class="n">Tkel</span><span class="p">)</span> <span class="o">-</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6085"></a>                   <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-6086"></a>     <span class="n">ENDIF</span>
<a name="ln-6087"></a>    <span class="n">ENDIF</span> <span class="c">! gasid &gt; 0</span>
<a name="ln-6088"></a>  <span class="n">ENDDO</span>
<a name="ln-6089"></a>
<a name="ln-6090"></a>  <span class="n">HProdGases</span> <span class="o">=</span> <span class="n">tempHprodGases</span>
<a name="ln-6091"></a>
<a name="ln-6092"></a>  <span class="k">RETURN</span>
<a name="ln-6093"></a>
<a name="ln-6094"></a><span class="k">END SUBROUTINE </span><span class="n">FigureProductGasesEnthalpy</span>
<a name="ln-6095"></a>
<a name="ln-6096"></a>
<a name="ln-6097"></a>
<a name="ln-6098"></a><span class="k">SUBROUTINE </span><span class="n">FigureProductGasHeatCap</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">FluidTemp</span><span class="p">,</span> <span class="n">Cp</span><span class="p">)</span>
<a name="ln-6099"></a>
<a name="ln-6100"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6101"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-6102"></a>          <span class="c">!       DATE WRITTEN   Aug. 2005</span>
<a name="ln-6103"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6104"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6105"></a>
<a name="ln-6106"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6107"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6108"></a>
<a name="ln-6109"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6110"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6111"></a>
<a name="ln-6112"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6113"></a>          <span class="c">! na</span>
<a name="ln-6114"></a>
<a name="ln-6115"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6116"></a>          <span class="c">! na</span>
<a name="ln-6117"></a>
<a name="ln-6118"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6119"></a>
<a name="ln-6120"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6121"></a>          <span class="c">! na</span>
<a name="ln-6122"></a>
<a name="ln-6123"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6124"></a>          <span class="c">! na</span>
<a name="ln-6125"></a>
<a name="ln-6126"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6127"></a>          <span class="c">! na</span>
<a name="ln-6128"></a>
<a name="ln-6129"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6130"></a>          <span class="c">! na</span>
<a name="ln-6131"></a>
<a name="ln-6132"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6133"></a>          <span class="c">! na</span>
<a name="ln-6134"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">GeneratorNum</span> <span class="c">! ID of generator FuelCell data structure</span>
<a name="ln-6135"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">FluidTemp</span>    <span class="c">! degree C</span>
<a name="ln-6136"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span>   <span class="n">Cp</span>           <span class="c">!  (J/mol*K)</span>
<a name="ln-6137"></a>
<a name="ln-6138"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6139"></a>          <span class="c">! na</span>
<a name="ln-6140"></a>
<a name="ln-6141"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6142"></a>          <span class="c">! na</span>
<a name="ln-6143"></a>
<a name="ln-6144"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6145"></a>          <span class="c">! na</span>
<a name="ln-6146"></a>
<a name="ln-6147"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6148"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tsho</span> <span class="c">! temp for Shomate eq  in (Kelvin/1000)</span>
<a name="ln-6149"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tkel</span> <span class="c">! temp for NASA eq. in Kelvin</span>
<a name="ln-6150"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">tempCp</span>
<a name="ln-6151"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">thisConstit</span> <span class="c">!loop index</span>
<a name="ln-6152"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">gasID</span> <span class="c">!look up into Gas structure</span>
<a name="ln-6153"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span> <span class="c">! shomate coeff</span>
<a name="ln-6154"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B</span> <span class="c">! shomate coeff</span>
<a name="ln-6155"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">C</span> <span class="c">! shomate coeff</span>
<a name="ln-6156"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">D</span> <span class="c">! shomate coeff</span>
<a name="ln-6157"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">E</span> <span class="c">! shomate coeff</span>
<a name="ln-6158"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A1</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6159"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A2</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6160"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A3</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6161"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A4</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6162"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A5</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6163"></a>
<a name="ln-6164"></a>  <span class="n">Tsho</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-6165"></a>  <span class="n">Tkel</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span>
<a name="ln-6166"></a>  <span class="c">! loop through fuel constituents and sum up Cp</span>
<a name="ln-6167"></a>
<a name="ln-6168"></a>  <span class="n">tempCp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6169"></a>
<a name="ln-6170"></a>  <span class="k">DO </span><span class="n">thisConstit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Size</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">)</span>
<a name="ln-6171"></a>    <span class="n">gasID</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-6172"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gasID</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6173"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">==</span> <span class="n">NISTShomate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6174"></a>
<a name="ln-6175"></a><span class="k">        </span><span class="n">A</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateA</span>
<a name="ln-6176"></a>        <span class="n">B</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateB</span>
<a name="ln-6177"></a>        <span class="n">C</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateC</span>
<a name="ln-6178"></a>        <span class="n">D</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateD</span>
<a name="ln-6179"></a>        <span class="n">E</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateE</span>
<a name="ln-6180"></a>
<a name="ln-6181"></a>        <span class="n">tempCp</span> <span class="o">=</span> <span class="n">tempCp</span> <span class="o">+</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">Tsho</span> <span class="o">+</span> <span class="n">C</span><span class="o">*</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6182"></a>                       <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">))</span>
<a name="ln-6183"></a>      <span class="n">ENDIF</span>
<a name="ln-6184"></a>
<a name="ln-6185"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">==</span> <span class="n">NASAPolynomial</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6186"></a><span class="k">        </span><span class="n">A1</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A1</span>
<a name="ln-6187"></a>        <span class="n">A2</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A2</span>
<a name="ln-6188"></a>        <span class="n">A3</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A3</span>
<a name="ln-6189"></a>        <span class="n">A4</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A4</span>
<a name="ln-6190"></a>        <span class="n">A5</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A5</span>
<a name="ln-6191"></a>
<a name="ln-6192"></a>        <span class="n">tempCp</span> <span class="o">=</span> <span class="n">tempCp</span> <span class="o">+</span> <span class="p">(</span><span class="n">A1</span> <span class="o">+</span> <span class="n">A2</span><span class="o">*</span><span class="n">Tkel</span> <span class="o">+</span> <span class="n">A3</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">A4</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">A5</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">RinKJperMolpK</span> <span class="p">&amp;</span>
<a name="ln-6193"></a>                      <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-6194"></a>
<a name="ln-6195"></a>      <span class="n">ENDIF</span>
<a name="ln-6196"></a>
<a name="ln-6197"></a>    <span class="n">ENDIF</span>
<a name="ln-6198"></a>
<a name="ln-6199"></a>  <span class="n">ENDDO</span>
<a name="ln-6200"></a>
<a name="ln-6201"></a>  <span class="n">Cp</span> <span class="o">=</span> <span class="n">tempCp</span>
<a name="ln-6202"></a>
<a name="ln-6203"></a>  <span class="k">RETURN</span>
<a name="ln-6204"></a>
<a name="ln-6205"></a><span class="k">END SUBROUTINE </span><span class="n">FigureProductGasHeatCap</span>
<a name="ln-6206"></a>
<a name="ln-6207"></a><span class="k">SUBROUTINE </span><span class="n">FigureAuxilHeatGasHeatCap</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">FluidTemp</span><span class="p">,</span> <span class="n">Cp</span><span class="p">)</span>
<a name="ln-6208"></a>
<a name="ln-6209"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6210"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-6211"></a>          <span class="c">!       DATE WRITTEN   Aug. 2005</span>
<a name="ln-6212"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6213"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6214"></a>
<a name="ln-6215"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6216"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6217"></a>
<a name="ln-6218"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6219"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6220"></a>
<a name="ln-6221"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6222"></a>          <span class="c">! na</span>
<a name="ln-6223"></a>
<a name="ln-6224"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6225"></a>          <span class="c">! na</span>
<a name="ln-6226"></a>
<a name="ln-6227"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6228"></a>
<a name="ln-6229"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6230"></a>          <span class="c">! na</span>
<a name="ln-6231"></a>
<a name="ln-6232"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6233"></a>          <span class="c">! na</span>
<a name="ln-6234"></a>
<a name="ln-6235"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6236"></a>          <span class="c">! na</span>
<a name="ln-6237"></a>
<a name="ln-6238"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6239"></a>          <span class="c">! na</span>
<a name="ln-6240"></a>
<a name="ln-6241"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6242"></a>          <span class="c">! na</span>
<a name="ln-6243"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">GeneratorNum</span> <span class="c">! ID of generator FuelCell data structure</span>
<a name="ln-6244"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">FluidTemp</span>    <span class="c">! degree C</span>
<a name="ln-6245"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span>   <span class="n">Cp</span>           <span class="c">!  (J/mol*K)</span>
<a name="ln-6246"></a>
<a name="ln-6247"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6248"></a>          <span class="c">! na</span>
<a name="ln-6249"></a>
<a name="ln-6250"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6251"></a>          <span class="c">! na</span>
<a name="ln-6252"></a>
<a name="ln-6253"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6254"></a>          <span class="c">! na</span>
<a name="ln-6255"></a>
<a name="ln-6256"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6257"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tsho</span> <span class="c">! temp for Shomate eq  in (Kelvin/1000)</span>
<a name="ln-6258"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tkel</span> <span class="c">! temp for NASA eq. in Kelvin</span>
<a name="ln-6259"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">tempCp</span>
<a name="ln-6260"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">thisConstit</span> <span class="c">!loop index</span>
<a name="ln-6261"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">gasID</span> <span class="c">!look up into Gas structure</span>
<a name="ln-6262"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span> <span class="c">! shomate coeff</span>
<a name="ln-6263"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B</span> <span class="c">! shomate coeff</span>
<a name="ln-6264"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">C</span> <span class="c">! shomate coeff</span>
<a name="ln-6265"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">D</span> <span class="c">! shomate coeff</span>
<a name="ln-6266"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">E</span> <span class="c">! shomate coeff</span>
<a name="ln-6267"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A1</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6268"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A2</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6269"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A3</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6270"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A4</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6271"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A5</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6272"></a>
<a name="ln-6273"></a>  <span class="n">Tsho</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-6274"></a>  <span class="n">Tkel</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span>
<a name="ln-6275"></a>  <span class="c">! loop through fuel constituents and sum up Cp</span>
<a name="ln-6276"></a>
<a name="ln-6277"></a>  <span class="n">tempCp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6278"></a>
<a name="ln-6279"></a>  <span class="k">DO </span><span class="n">thisConstit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Size</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">)</span>
<a name="ln-6280"></a>    <span class="n">gasID</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-6281"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gasID</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6282"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">==</span> <span class="n">NISTShomate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6283"></a>
<a name="ln-6284"></a><span class="k">        </span><span class="n">A</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateA</span>
<a name="ln-6285"></a>        <span class="n">B</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateB</span>
<a name="ln-6286"></a>        <span class="n">C</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateC</span>
<a name="ln-6287"></a>        <span class="n">D</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateD</span>
<a name="ln-6288"></a>        <span class="n">E</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateE</span>
<a name="ln-6289"></a>
<a name="ln-6290"></a>        <span class="n">tempCp</span> <span class="o">=</span> <span class="n">tempCp</span> <span class="o">+</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">Tsho</span> <span class="o">+</span> <span class="n">C</span><span class="o">*</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6291"></a>                       <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">))</span>
<a name="ln-6292"></a>      <span class="n">ENDIF</span>
<a name="ln-6293"></a>
<a name="ln-6294"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">==</span> <span class="n">NASAPolynomial</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6295"></a><span class="k">        </span><span class="n">A1</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A1</span>
<a name="ln-6296"></a>        <span class="n">A2</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A2</span>
<a name="ln-6297"></a>        <span class="n">A3</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A3</span>
<a name="ln-6298"></a>        <span class="n">A4</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A4</span>
<a name="ln-6299"></a>        <span class="n">A5</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A5</span>
<a name="ln-6300"></a>
<a name="ln-6301"></a>        <span class="n">tempCp</span> <span class="o">=</span> <span class="n">tempCp</span> <span class="o">+</span> <span class="p">(</span><span class="n">A1</span> <span class="o">+</span> <span class="n">A2</span><span class="o">*</span><span class="n">Tkel</span> <span class="o">+</span> <span class="n">A3</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">A4</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">A5</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">RinKJperMolpK</span> <span class="p">&amp;</span>
<a name="ln-6302"></a>                      <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-6303"></a>
<a name="ln-6304"></a>      <span class="n">ENDIF</span>
<a name="ln-6305"></a>
<a name="ln-6306"></a>    <span class="n">ENDIF</span>
<a name="ln-6307"></a>
<a name="ln-6308"></a>  <span class="n">ENDDO</span>
<a name="ln-6309"></a>
<a name="ln-6310"></a>  <span class="n">Cp</span> <span class="o">=</span> <span class="n">tempCp</span>
<a name="ln-6311"></a>
<a name="ln-6312"></a>  <span class="k">RETURN</span>
<a name="ln-6313"></a>
<a name="ln-6314"></a><span class="k">END SUBROUTINE </span><span class="n">FigureAuxilHeatGasHeatCap</span>
<a name="ln-6315"></a>
<a name="ln-6316"></a><span class="k">SUBROUTINE </span><span class="n">FigureHXleavingGasHeatCap</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">FluidTemp</span><span class="p">,</span> <span class="n">Cp</span><span class="p">)</span>
<a name="ln-6317"></a>
<a name="ln-6318"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6319"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-6320"></a>          <span class="c">!       DATE WRITTEN   Aug. 2005</span>
<a name="ln-6321"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6322"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6323"></a>
<a name="ln-6324"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6325"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6326"></a>
<a name="ln-6327"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6328"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6329"></a>
<a name="ln-6330"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6331"></a>          <span class="c">! na</span>
<a name="ln-6332"></a>
<a name="ln-6333"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6334"></a>          <span class="c">! na</span>
<a name="ln-6335"></a>
<a name="ln-6336"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6337"></a>
<a name="ln-6338"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6339"></a>          <span class="c">! na</span>
<a name="ln-6340"></a>
<a name="ln-6341"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6342"></a>          <span class="c">! na</span>
<a name="ln-6343"></a>
<a name="ln-6344"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6345"></a>          <span class="c">! na</span>
<a name="ln-6346"></a>
<a name="ln-6347"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6348"></a>          <span class="c">! na</span>
<a name="ln-6349"></a>
<a name="ln-6350"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6351"></a>          <span class="c">! na</span>
<a name="ln-6352"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">GeneratorNum</span> <span class="c">! ID of generator FuelCell data structure</span>
<a name="ln-6353"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">FluidTemp</span>    <span class="c">! degree C</span>
<a name="ln-6354"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span>   <span class="n">Cp</span>           <span class="c">!  (J/mol*K)</span>
<a name="ln-6355"></a>
<a name="ln-6356"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6357"></a>          <span class="c">! na</span>
<a name="ln-6358"></a>
<a name="ln-6359"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6360"></a>          <span class="c">! na</span>
<a name="ln-6361"></a>
<a name="ln-6362"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6363"></a>          <span class="c">! na</span>
<a name="ln-6364"></a>
<a name="ln-6365"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6366"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tsho</span> <span class="c">! temp for Shomate eq  in (Kelvin/1000)</span>
<a name="ln-6367"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tkel</span> <span class="c">! temp for NASA eq. in Kelvin</span>
<a name="ln-6368"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">tempCp</span>
<a name="ln-6369"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">thisConstit</span> <span class="c">!loop index</span>
<a name="ln-6370"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">gasID</span> <span class="c">!look up into Gas structure</span>
<a name="ln-6371"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span> <span class="c">! shomate coeff</span>
<a name="ln-6372"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B</span> <span class="c">! shomate coeff</span>
<a name="ln-6373"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">C</span> <span class="c">! shomate coeff</span>
<a name="ln-6374"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">D</span> <span class="c">! shomate coeff</span>
<a name="ln-6375"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">E</span> <span class="c">! shomate coeff</span>
<a name="ln-6376"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A1</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6377"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A2</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6378"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A3</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6379"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A4</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6380"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A5</span> <span class="c">! NASA poly coeff</span>
<a name="ln-6381"></a>
<a name="ln-6382"></a>  <span class="n">Tsho</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-6383"></a>  <span class="n">Tkel</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span>
<a name="ln-6384"></a>  <span class="c">! loop through fuel constituents and sum up Cp</span>
<a name="ln-6385"></a>
<a name="ln-6386"></a>  <span class="n">tempCp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6387"></a>
<a name="ln-6388"></a>  <span class="k">DO </span><span class="n">thisConstit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Size</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">)</span>
<a name="ln-6389"></a>    <span class="n">gasID</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-6390"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">gasID</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6391"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">==</span> <span class="n">NISTShomate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6392"></a>
<a name="ln-6393"></a><span class="k">        </span><span class="n">A</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateA</span>
<a name="ln-6394"></a>        <span class="n">B</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateB</span>
<a name="ln-6395"></a>        <span class="n">C</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateC</span>
<a name="ln-6396"></a>        <span class="n">D</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateD</span>
<a name="ln-6397"></a>        <span class="n">E</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ShomateE</span>
<a name="ln-6398"></a>
<a name="ln-6399"></a>        <span class="n">tempCp</span> <span class="o">=</span> <span class="n">tempCp</span> <span class="o">+</span> <span class="p">((</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">Tsho</span> <span class="o">+</span> <span class="n">C</span><span class="o">*</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6400"></a>                       <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">))</span>
<a name="ln-6401"></a>      <span class="n">ENDIF</span>
<a name="ln-6402"></a>
<a name="ln-6403"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">ThermoMode</span> <span class="o">==</span> <span class="n">NASAPolynomial</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6404"></a><span class="k">        </span><span class="n">A1</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A1</span>
<a name="ln-6405"></a>        <span class="n">A2</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A2</span>
<a name="ln-6406"></a>        <span class="n">A3</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A3</span>
<a name="ln-6407"></a>        <span class="n">A4</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A4</span>
<a name="ln-6408"></a>        <span class="n">A5</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">gasID</span><span class="p">)%</span><span class="n">NASA_A5</span>
<a name="ln-6409"></a>
<a name="ln-6410"></a>        <span class="n">tempCp</span> <span class="o">=</span> <span class="n">tempCp</span> <span class="o">+</span> <span class="p">(</span><span class="n">A1</span> <span class="o">+</span> <span class="n">A2</span><span class="o">*</span><span class="n">Tkel</span> <span class="o">+</span> <span class="n">A3</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">A4</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">A5</span><span class="o">*</span><span class="n">Tkel</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">RinKJperMolpK</span> <span class="p">&amp;</span>
<a name="ln-6411"></a>                      <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">thisConstit</span><span class="p">)</span>
<a name="ln-6412"></a>
<a name="ln-6413"></a>      <span class="n">ENDIF</span>
<a name="ln-6414"></a>
<a name="ln-6415"></a>    <span class="n">ENDIF</span>
<a name="ln-6416"></a>
<a name="ln-6417"></a>  <span class="n">ENDDO</span>
<a name="ln-6418"></a>
<a name="ln-6419"></a>  <span class="n">Cp</span> <span class="o">=</span> <span class="n">tempCp</span>
<a name="ln-6420"></a>
<a name="ln-6421"></a>  <span class="k">RETURN</span>
<a name="ln-6422"></a>
<a name="ln-6423"></a><span class="k">END SUBROUTINE </span><span class="n">FigureHXleavingGasHeatCap</span>
<a name="ln-6424"></a>
<a name="ln-6425"></a>
<a name="ln-6426"></a><span class="k">SUBROUTINE </span><span class="n">FigureGaseousWaterEnthalpy</span><span class="p">(</span><span class="n">FluidTemp</span><span class="p">,</span> <span class="n">HGasWater</span><span class="p">)</span>
<a name="ln-6427"></a>
<a name="ln-6428"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6429"></a>          <span class="c">!       AUTHOR         B griffith</span>
<a name="ln-6430"></a>          <span class="c">!       DATE WRITTEN   December 2005</span>
<a name="ln-6431"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6432"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6433"></a>
<a name="ln-6434"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6435"></a>          <span class="c">! calculate Enthalpy from Shomate equations for gaseous water</span>
<a name="ln-6436"></a>          <span class="c">! No ethalphy of formation in this one.</span>
<a name="ln-6437"></a>
<a name="ln-6438"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6439"></a>
<a name="ln-6440"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6441"></a>          <span class="c">! NIST Webbook on gas phase thermochemistry</span>
<a name="ln-6442"></a>
<a name="ln-6443"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6444"></a>          <span class="c">! na</span>
<a name="ln-6445"></a>
<a name="ln-6446"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6447"></a>
<a name="ln-6448"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6449"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">FluidTemp</span>    <span class="c">! degree C</span>
<a name="ln-6450"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span>   <span class="n">HGasWater</span>    <span class="c">! kJ/mol</span>
<a name="ln-6451"></a>
<a name="ln-6452"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6453"></a>          <span class="c">! na</span>
<a name="ln-6454"></a>
<a name="ln-6455"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6456"></a>          <span class="c">! na</span>
<a name="ln-6457"></a>
<a name="ln-6458"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6459"></a>          <span class="c">! na</span>
<a name="ln-6460"></a>
<a name="ln-6461"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6462"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tsho</span> <span class="c">! temp for Shomate eq  in (Kelvin/1000)</span>
<a name="ln-6463"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span> <span class="c">! shomate coeff</span>
<a name="ln-6464"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B</span> <span class="c">! shomate coeff</span>
<a name="ln-6465"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">C</span> <span class="c">! shomate coeff</span>
<a name="ln-6466"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">D</span> <span class="c">! shomate coeff</span>
<a name="ln-6467"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">E</span> <span class="c">! shomate coeff</span>
<a name="ln-6468"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">F</span> <span class="c">! shomate coeff</span>
<a name="ln-6469"></a><span class="c">!  REAL(r64) :: H ! shomate coeff</span>
<a name="ln-6470"></a>
<a name="ln-6471"></a>
<a name="ln-6472"></a>  <span class="n">Tsho</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-6473"></a>
<a name="ln-6474"></a>  <span class="n">A</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">9.0373d0</span>
<a name="ln-6475"></a>  <span class="n">B</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.2573d0</span>
<a name="ln-6476"></a>  <span class="n">C</span> <span class="o">=</span> <span class="mf">2.81048d0</span>
<a name="ln-6477"></a>  <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.95914d0</span>
<a name="ln-6478"></a>  <span class="n">E</span> <span class="o">=</span> <span class="mf">0.11725d0</span>
<a name="ln-6479"></a>  <span class="n">F</span> <span class="o">=</span> <span class="o">-</span><span class="mi">25</span><span class="mf">0.569d0</span>
<a name="ln-6480"></a>
<a name="ln-6481"></a>
<a name="ln-6482"></a>  <span class="n">HGasWater</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">Tsho</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span> <span class="o">+</span> <span class="n">C</span><span class="o">*</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">3.0d0</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="mf">4.0d0</span> <span class="o">-</span> <span class="n">E</span><span class="o">/</span><span class="n">Tsho</span> <span class="o">+</span> <span class="n">F</span> <span class="c">!- H</span>
<a name="ln-6483"></a>
<a name="ln-6484"></a>  <span class="k">RETURN</span>
<a name="ln-6485"></a><span class="k">END SUBROUTINE </span><span class="n">FigureGaseousWaterEnthalpy</span>
<a name="ln-6486"></a>
<a name="ln-6487"></a><span class="k">SUBROUTINE </span><span class="n">FigureLiquidWaterEnthalpy</span><span class="p">(</span><span class="n">FluidTemp</span><span class="p">,</span> <span class="n">HLiqWater</span><span class="p">)</span>
<a name="ln-6488"></a>
<a name="ln-6489"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6490"></a>          <span class="c">!       AUTHOR         B griffith</span>
<a name="ln-6491"></a>          <span class="c">!       DATE WRITTEN   December 2005</span>
<a name="ln-6492"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6493"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6494"></a>
<a name="ln-6495"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6496"></a>          <span class="c">! calculate Enthalpy from Shomate equations for liquid water</span>
<a name="ln-6497"></a>          <span class="c">! No enthalpy of formation in this one</span>
<a name="ln-6498"></a>
<a name="ln-6499"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6500"></a>
<a name="ln-6501"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6502"></a>          <span class="c">! NIST Webbook on gas phase thermochemistry</span>
<a name="ln-6503"></a>
<a name="ln-6504"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6505"></a>          <span class="c">! na</span>
<a name="ln-6506"></a>
<a name="ln-6507"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6508"></a>
<a name="ln-6509"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6510"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">FluidTemp</span>    <span class="c">! degree C</span>
<a name="ln-6511"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span>   <span class="n">HLiqWater</span>    <span class="c">! kJ/mol</span>
<a name="ln-6512"></a>
<a name="ln-6513"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6514"></a>          <span class="c">! na</span>
<a name="ln-6515"></a>
<a name="ln-6516"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6517"></a>          <span class="c">! na</span>
<a name="ln-6518"></a>
<a name="ln-6519"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6520"></a>          <span class="c">! na</span>
<a name="ln-6521"></a>
<a name="ln-6522"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6523"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tsho</span> <span class="c">! temp for Shomate eq  in (Kelvin/1000)</span>
<a name="ln-6524"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span> <span class="c">! shomate coeff</span>
<a name="ln-6525"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B</span> <span class="c">! shomate coeff</span>
<a name="ln-6526"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">C</span> <span class="c">! shomate coeff</span>
<a name="ln-6527"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">D</span> <span class="c">! shomate coeff</span>
<a name="ln-6528"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">E</span> <span class="c">! shomate coeff</span>
<a name="ln-6529"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">F</span> <span class="c">! shomate coeff</span>
<a name="ln-6530"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H</span> <span class="c">! shomate coeff</span>
<a name="ln-6531"></a>
<a name="ln-6532"></a>
<a name="ln-6533"></a>  <span class="n">Tsho</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-6534"></a>
<a name="ln-6535"></a>  <span class="n">A</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span><span class="mf">3.606d0</span>
<a name="ln-6536"></a>  <span class="n">B</span> <span class="o">=</span> <span class="mi">152</span><span class="mf">3.29d0</span>
<a name="ln-6537"></a>  <span class="n">C</span> <span class="o">=</span> <span class="o">-</span><span class="mi">319</span><span class="mf">6.413d0</span>
<a name="ln-6538"></a>  <span class="n">D</span> <span class="o">=</span> <span class="mi">247</span><span class="mf">4.455d0</span>
<a name="ln-6539"></a>  <span class="n">E</span> <span class="o">=</span> <span class="mf">3.85533d0</span>
<a name="ln-6540"></a>  <span class="n">F</span> <span class="o">=</span> <span class="o">-</span><span class="mi">25</span><span class="mf">6.5478d0</span>
<a name="ln-6541"></a>  <span class="n">H</span> <span class="o">=</span> <span class="o">-</span><span class="mi">28</span><span class="mf">5.8304d0</span>
<a name="ln-6542"></a>
<a name="ln-6543"></a>  <span class="n">HLiqWater</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">Tsho</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span> <span class="o">+</span> <span class="n">C</span><span class="o">*</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">3.0d0</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="mf">4.0d0</span> <span class="o">-</span> <span class="n">E</span><span class="o">/</span><span class="n">Tsho</span> <span class="o">+</span> <span class="n">F</span> <span class="c">!- H</span>
<a name="ln-6544"></a>
<a name="ln-6545"></a>  <span class="k">RETURN</span>
<a name="ln-6546"></a><span class="k">END SUBROUTINE </span><span class="n">FigureLiquidWaterEnthalpy</span>
<a name="ln-6547"></a>
<a name="ln-6548"></a><span class="k">SUBROUTINE </span><span class="n">FigureLiquidWaterHeatCap</span><span class="p">(</span><span class="n">FluidTemp</span><span class="p">,</span> <span class="n">Cp</span><span class="p">)</span>
<a name="ln-6549"></a>
<a name="ln-6550"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6551"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-6552"></a>          <span class="c">!       DATE WRITTEN   December 2005</span>
<a name="ln-6553"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6554"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6555"></a>
<a name="ln-6556"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6557"></a>          <span class="c">! calculate shomate eq. for pure liquid water</span>
<a name="ln-6558"></a>
<a name="ln-6559"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6560"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6561"></a>
<a name="ln-6562"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6563"></a>          <span class="c">! na</span>
<a name="ln-6564"></a>
<a name="ln-6565"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6566"></a>          <span class="c">! na</span>
<a name="ln-6567"></a>
<a name="ln-6568"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6569"></a>
<a name="ln-6570"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6571"></a>          <span class="c">! na</span>
<a name="ln-6572"></a>
<a name="ln-6573"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6574"></a>          <span class="c">! na</span>
<a name="ln-6575"></a>
<a name="ln-6576"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6577"></a>          <span class="c">! na</span>
<a name="ln-6578"></a>
<a name="ln-6579"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6580"></a>          <span class="c">! na</span>
<a name="ln-6581"></a>
<a name="ln-6582"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6583"></a>          <span class="c">! na</span>
<a name="ln-6584"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span>   <span class="n">FluidTemp</span>    <span class="c">! degree C</span>
<a name="ln-6585"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span>   <span class="n">Cp</span>           <span class="c">!  (J/mol*K)</span>
<a name="ln-6586"></a>
<a name="ln-6587"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6588"></a>          <span class="c">! na</span>
<a name="ln-6589"></a>
<a name="ln-6590"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6591"></a>          <span class="c">! na</span>
<a name="ln-6592"></a>
<a name="ln-6593"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6594"></a>          <span class="c">! na</span>
<a name="ln-6595"></a>
<a name="ln-6596"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6597"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tsho</span> <span class="c">! temp for Shomate eq  in (Kelvin/1000)</span>
<a name="ln-6598"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span> <span class="c">! shomate coeff</span>
<a name="ln-6599"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B</span> <span class="c">! shomate coeff</span>
<a name="ln-6600"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">C</span> <span class="c">! shomate coeff</span>
<a name="ln-6601"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">D</span> <span class="c">! shomate coeff</span>
<a name="ln-6602"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">E</span> <span class="c">! shomate coeff</span>
<a name="ln-6603"></a>
<a name="ln-6604"></a>  <span class="n">Tsho</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidTemp</span> <span class="o">+</span><span class="n">KelvinConv</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-6605"></a>
<a name="ln-6606"></a>  <span class="n">A</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span><span class="mf">3.606d0</span>
<a name="ln-6607"></a>  <span class="n">B</span> <span class="o">=</span> <span class="mi">152</span><span class="mf">3.29d0</span>
<a name="ln-6608"></a>  <span class="n">C</span> <span class="o">=</span> <span class="o">-</span><span class="mi">319</span><span class="mf">6.413d0</span>
<a name="ln-6609"></a>  <span class="n">D</span> <span class="o">=</span> <span class="mi">247</span><span class="mf">4.455d0</span>
<a name="ln-6610"></a>  <span class="n">E</span> <span class="o">=</span> <span class="mf">3.85533d0</span>
<a name="ln-6611"></a>
<a name="ln-6612"></a>  <span class="n">Cp</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">Tsho</span> <span class="o">+</span> <span class="n">C</span><span class="o">*</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="n">Tsho</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6613"></a>
<a name="ln-6614"></a>  <span class="k">RETURN</span>
<a name="ln-6615"></a><span class="k">END SUBROUTINE </span><span class="n">FigureLiquidWaterHeatCap</span>
<a name="ln-6616"></a>
<a name="ln-6617"></a>
<a name="ln-6618"></a><span class="k">SUBROUTINE </span><span class="n">FigureLHVofFuel</span><span class="p">(</span><span class="n">Num</span><span class="p">,</span><span class="n">NdotFuel</span><span class="p">,</span> <span class="n">NdotCO2</span><span class="p">,</span>  <span class="n">NdotH20</span><span class="p">,</span> <span class="n">LHV</span><span class="p">)</span>
<a name="ln-6619"></a>
<a name="ln-6620"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6621"></a>          <span class="c">!       AUTHOR         B Griffith</span>
<a name="ln-6622"></a>          <span class="c">!       DATE WRITTEN   Aug 2005</span>
<a name="ln-6623"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6624"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6625"></a>
<a name="ln-6626"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6627"></a>          <span class="c">! Calculate LHV</span>
<a name="ln-6628"></a>
<a name="ln-6629"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6630"></a>          <span class="c">! ANNEX 42 eq. 6 method from molar enthalpies</span>
<a name="ln-6631"></a>
<a name="ln-6632"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6633"></a>          <span class="c">! na</span>
<a name="ln-6634"></a>
<a name="ln-6635"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6636"></a>          <span class="c">! na</span>
<a name="ln-6637"></a>
<a name="ln-6638"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6639"></a>
<a name="ln-6640"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6641"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Num</span>
<a name="ln-6642"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NdotFuel</span>
<a name="ln-6643"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NdotCO2</span>
<a name="ln-6644"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NdotH20</span>
<a name="ln-6645"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span><span class="kd">::</span> <span class="n">LHV</span>
<a name="ln-6646"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6647"></a>          <span class="c">! na</span>
<a name="ln-6648"></a>
<a name="ln-6649"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6650"></a>          <span class="c">! na</span>
<a name="ln-6651"></a>
<a name="ln-6652"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6653"></a>          <span class="c">! na</span>
<a name="ln-6654"></a>
<a name="ln-6655"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6656"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DelfHfuel</span>
<a name="ln-6657"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DelfHCO2</span>
<a name="ln-6658"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DelfHH20</span>
<a name="ln-6659"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span><span class="n">I</span>
<a name="ln-6660"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">h_i</span>
<a name="ln-6661"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CO2dataID</span>
<a name="ln-6662"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WaterDataID</span>
<a name="ln-6663"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">thisGasID</span>
<a name="ln-6664"></a>
<a name="ln-6665"></a>  <span class="n">CO2dataID</span>   <span class="o">=</span> <span class="mi">1</span>  <span class="c">!hard-coded in SetupFuelAndAirConstituentData</span>
<a name="ln-6666"></a>  <span class="n">WaterDataID</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c">!hard-coded in SetupFuelAndAirConstituentData</span>
<a name="ln-6667"></a>  <span class="n">DelfHfuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6668"></a>
<a name="ln-6669"></a>  <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">NumConstituents</span>
<a name="ln-6670"></a>     <span class="n">thisGasID</span> <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">GasLibID</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-6671"></a>
<a name="ln-6672"></a>     <span class="n">h_i</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">thisGasID</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span>
<a name="ln-6673"></a>
<a name="ln-6674"></a>     <span class="n">DelfHfuel</span> <span class="o">=</span> <span class="n">DelfHfuel</span> <span class="o">+</span> <span class="n">NdotFuel</span> <span class="o">*</span> <span class="n">h_i</span> <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-6675"></a>
<a name="ln-6676"></a>  <span class="n">ENDDO</span>
<a name="ln-6677"></a>
<a name="ln-6678"></a>  <span class="n">DelfHCO2</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">CO2dataID</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span> <span class="o">*</span> <span class="n">NdotCO2</span>
<a name="ln-6679"></a>
<a name="ln-6680"></a>  <span class="n">DelfHH20</span> <span class="o">=</span> <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="n">WaterDataID</span><span class="p">)%</span><span class="n">StdRefMolarEnthOfForm</span> <span class="o">*</span> <span class="n">NdotH20</span>
<a name="ln-6681"></a>
<a name="ln-6682"></a>
<a name="ln-6683"></a>  <span class="n">LHV</span> <span class="o">=</span> <span class="p">(</span><span class="n">DelfHfuel</span> <span class="o">-</span> <span class="n">DelfHCO2</span> <span class="o">-</span> <span class="n">DelfHH20</span><span class="p">)</span> <span class="o">/</span> <span class="n">NdotFuel</span>  <span class="c">!Equation 6</span>
<a name="ln-6684"></a>
<a name="ln-6685"></a>
<a name="ln-6686"></a>  <span class="k">RETURN</span>
<a name="ln-6687"></a>
<a name="ln-6688"></a><span class="k">END SUBROUTINE </span><span class="n">FigureLHVofFuel</span>
<a name="ln-6689"></a>
<a name="ln-6690"></a><span class="k">SUBROUTINE </span><span class="n">FigureACAncillaries</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">PacAncill</span><span class="p">)</span>
<a name="ln-6691"></a>
<a name="ln-6692"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6693"></a>          <span class="c">!       AUTHOR         B Griffith</span>
<a name="ln-6694"></a>          <span class="c">!       DATE WRITTEN   March 2006</span>
<a name="ln-6695"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6696"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6697"></a>
<a name="ln-6698"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6699"></a>          <span class="c">! Calculate the AC ancillaries to determine Pel</span>
<a name="ln-6700"></a>
<a name="ln-6701"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6702"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6703"></a>
<a name="ln-6704"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6705"></a>          <span class="c">! na</span>
<a name="ln-6706"></a>
<a name="ln-6707"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6708"></a>          <span class="c">! na</span>
<a name="ln-6709"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>    <span class="n">ONLY</span> <span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-6710"></a>
<a name="ln-6711"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6712"></a>
<a name="ln-6713"></a>
<a name="ln-6714"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6715"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">GeneratorNum</span>
<a name="ln-6716"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PacAncill</span>
<a name="ln-6717"></a>
<a name="ln-6718"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6719"></a>          <span class="c">! na</span>
<a name="ln-6720"></a>
<a name="ln-6721"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6722"></a>          <span class="c">! na</span>
<a name="ln-6723"></a>
<a name="ln-6724"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6725"></a>          <span class="c">! na</span>
<a name="ln-6726"></a>
<a name="ln-6727"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6728"></a>
<a name="ln-6729"></a> <span class="c">!  Using lagged values inside a sequential substitution loop</span>
<a name="ln-6730"></a>  <span class="n">PacAncill</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6731"></a>  <span class="c">! sect. 5.9</span>
<a name="ln-6732"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelancillariesAC</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ANC0</span>   <span class="p">&amp;</span>
<a name="ln-6733"></a>                                             <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ANC1</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span>
<a name="ln-6734"></a>
<a name="ln-6735"></a>  <span class="c">! sect 6.0</span>
<a name="ln-6736"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">PairCompEl</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">BlowerPowerCurveID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6737"></a>                                                       <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotAir</span><span class="p">)</span>
<a name="ln-6738"></a>  <span class="c">! sect 7.0</span>
<a name="ln-6739"></a>  <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">PfuelCompEl</span>  <span class="p">&amp;</span>
<a name="ln-6740"></a>          <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">CompPowerCurveID</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span><span class="p">)</span>
<a name="ln-6741"></a>
<a name="ln-6742"></a>  <span class="c">! sect. 8.0</span>
<a name="ln-6743"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">PwaterCompEl</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">PmpPowerCurveID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6744"></a>                                                          <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotLiqwater</span> <span class="p">)</span>
<a name="ln-6745"></a>
<a name="ln-6746"></a>  <span class="n">PacAncill</span> <span class="o">=</span>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelancillariesAC</span> <span class="p">&amp;</span>
<a name="ln-6747"></a>             <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">PairCompEl</span>     <span class="p">&amp;</span>
<a name="ln-6748"></a>             <span class="o">+</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">PfuelCompEl</span>   <span class="p">&amp;</span>
<a name="ln-6749"></a>             <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">PwaterCompEl</span>
<a name="ln-6750"></a>
<a name="ln-6751"></a>  <span class="k">RETURN</span>
<a name="ln-6752"></a>
<a name="ln-6753"></a><span class="k">END SUBROUTINE </span><span class="n">FigureACAncillaries</span>
<a name="ln-6754"></a>
<a name="ln-6755"></a>
<a name="ln-6756"></a><span class="k">SUBROUTINE </span><span class="n">FigurePowerConditioningLosses</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">Pdemand</span><span class="p">,</span> <span class="n">PpcuLosses</span><span class="p">)</span>
<a name="ln-6757"></a>
<a name="ln-6758"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6759"></a>          <span class="c">!       AUTHOR         B Griffith</span>
<a name="ln-6760"></a>          <span class="c">!       DATE WRITTEN   Aug 2005</span>
<a name="ln-6761"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6762"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6763"></a>
<a name="ln-6764"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6765"></a>          <span class="c">! Calculate inverter losses</span>
<a name="ln-6766"></a>
<a name="ln-6767"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6768"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6769"></a>
<a name="ln-6770"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6771"></a>          <span class="c">! na</span>
<a name="ln-6772"></a>
<a name="ln-6773"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6774"></a>          <span class="c">! na</span>
<a name="ln-6775"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>    <span class="n">ONLY</span> <span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-6776"></a>
<a name="ln-6777"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6778"></a>
<a name="ln-6779"></a>
<a name="ln-6780"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6781"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">GeneratorNum</span>
<a name="ln-6782"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Pdemand</span>
<a name="ln-6783"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PpcuLosses</span>
<a name="ln-6784"></a>
<a name="ln-6785"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6786"></a>          <span class="c">! na</span>
<a name="ln-6787"></a>
<a name="ln-6788"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6789"></a>          <span class="c">! na</span>
<a name="ln-6790"></a>
<a name="ln-6791"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6792"></a>          <span class="c">! na</span>
<a name="ln-6793"></a>
<a name="ln-6794"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6795"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">lastPpcuLosses</span> <span class="c">!used in iterative solution</span>
<a name="ln-6796"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iter</span>
<a name="ln-6797"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Pel</span>
<a name="ln-6798"></a>
<a name="ln-6799"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">EffMode</span> <span class="o">==</span>  <span class="n">InverterEffConstant</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6800"></a>
<a name="ln-6801"></a><span class="k">    </span><span class="n">PpcuLosses</span> <span class="o">=</span> <span class="n">Pdemand</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">ConstEff</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6802"></a>                 <span class="o">/</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">ConstEff</span>
<a name="ln-6803"></a>
<a name="ln-6804"></a>  <span class="n">ENDIF</span>
<a name="ln-6805"></a>
<a name="ln-6806"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">EffMode</span> <span class="o">==</span>  <span class="n">InverterEffQuadratic</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6807"></a>
<a name="ln-6808"></a>    <span class="c">! first use Pdemand instead of Pel to get initial estimate</span>
<a name="ln-6809"></a>    <span class="n">lastPpcuLosses</span> <span class="o">=</span> <span class="n">Pdemand</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">EffQuadraticCurveID</span><span class="p">,</span> <span class="n">Pdemand</span><span class="p">)</span> <span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-6810"></a>                     <span class="o">/</span><span class="n">CurveValue</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">EffQuadraticCurveID</span><span class="p">,</span> <span class="n">Pdemand</span><span class="p">)</span>
<a name="ln-6811"></a>
<a name="ln-6812"></a>    <span class="k">Do </span><span class="n">iter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span>  <span class="c">! seems like need to iterate (??) Need to investigate number and convergence success here</span>
<a name="ln-6813"></a>
<a name="ln-6814"></a>      <span class="n">Pel</span> <span class="o">=</span> <span class="n">Pdemand</span> <span class="o">+</span> <span class="n">lastPpcuLosses</span>
<a name="ln-6815"></a>
<a name="ln-6816"></a>      <span class="n">lastPpcuLosses</span>  <span class="o">=</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">EffQuadraticCurveID</span><span class="p">,</span> <span class="n">Pel</span><span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="n">Pel</span>
<a name="ln-6817"></a>
<a name="ln-6818"></a>    <span class="n">ENDDO</span>
<a name="ln-6819"></a>
<a name="ln-6820"></a>    <span class="n">PpcuLosses</span> <span class="o">=</span> <span class="n">lastPpcuLosses</span>
<a name="ln-6821"></a>
<a name="ln-6822"></a>  <span class="n">ENDIF</span>
<a name="ln-6823"></a>
<a name="ln-6824"></a>  <span class="k">RETURN</span>
<a name="ln-6825"></a>
<a name="ln-6826"></a><span class="k">END SUBROUTINE </span><span class="n">FigurePowerConditioningLosses</span>
<a name="ln-6827"></a>
<a name="ln-6828"></a><span class="k">SUBROUTINE </span><span class="n">FigureTransientConstraints</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">Pel</span><span class="p">,</span> <span class="n">Constrained</span><span class="p">,</span> <span class="n">PelDiff</span><span class="p">)</span>
<a name="ln-6829"></a>
<a name="ln-6830"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6831"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-6832"></a>          <span class="c">!       DATE WRITTEN   Aug 2005</span>
<a name="ln-6833"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6834"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6835"></a>
<a name="ln-6836"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6837"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6838"></a>
<a name="ln-6839"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6840"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6841"></a>
<a name="ln-6842"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6843"></a>          <span class="c">! na</span>
<a name="ln-6844"></a>
<a name="ln-6845"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6846"></a>          <span class="c">! na</span>
<a name="ln-6847"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysTimeElapsed</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-6848"></a>
<a name="ln-6849"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6850"></a>
<a name="ln-6851"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6852"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">GeneratorNum</span> <span class="c">!index number for accessing correct generator</span>
<a name="ln-6853"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Pel</span>         <span class="c">! DC power control setting for power module</span>
<a name="ln-6854"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">Constrained</span> <span class="c">! true if transient constraints kick in</span>
<a name="ln-6855"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">PelDiff</span>     <span class="c">! if constrained then this is the difference, positive</span>
<a name="ln-6856"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6857"></a>          <span class="c">! na</span>
<a name="ln-6858"></a>
<a name="ln-6859"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6860"></a>          <span class="c">! na</span>
<a name="ln-6861"></a>
<a name="ln-6862"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6863"></a>          <span class="c">! na</span>
<a name="ln-6864"></a>
<a name="ln-6865"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6866"></a><span class="c">!unused  REAL(r64)  :: CurrentHours</span>
<a name="ln-6867"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CurrentFractionalDay</span> <span class="c">!working var, time in decimal days</span>
<a name="ln-6868"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">EndingFractionalDay</span>  <span class="c">!working var, time is decimal days</span>
<a name="ln-6869"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MaxPel</span> <span class="c">!working variable for max allowed by transient constraint</span>
<a name="ln-6870"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MinPel</span> <span class="c">!working variabel for min allowed by transient constraint</span>
<a name="ln-6871"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PelInput</span> <span class="c">!hold initial value of inout var</span>
<a name="ln-6872"></a>
<a name="ln-6873"></a>  <span class="n">PelInput</span> <span class="o">=</span> <span class="n">Pel</span>
<a name="ln-6874"></a>
<a name="ln-6875"></a> <span class="c">! Check if in start up and if it still should be</span>
<a name="ln-6876"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DuringStartUp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6877"></a>
<a name="ln-6878"></a>     <span class="c">!calculate time for end of start up period</span>
<a name="ln-6879"></a>     <span class="n">CurrentFractionalDay</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-6880"></a>                            <span class="o">+</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SysTimeElapsed</span><span class="o">+</span><span class="p">(</span><span class="n">CurrentTime</span> <span class="o">-</span> <span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">))))</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-6881"></a>
<a name="ln-6882"></a>     <span class="n">EndingFractionalDay</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">FractionalDayofLastStartUp</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-6883"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">StartUpTime</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-6884"></a>
<a name="ln-6885"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">&gt;</span> <span class="n">EndingFractionalDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6886"></a>      <span class="c">!start up period is now over</span>
<a name="ln-6887"></a>         <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DuringStartUp</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6888"></a>     <span class="n">ENDIF</span>
<a name="ln-6889"></a>   <span class="n">ENDIF</span>
<a name="ln-6890"></a>
<a name="ln-6891"></a> <span class="c">! Check if in shut down up and if it still should be</span>
<a name="ln-6892"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DuringShutDown</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6893"></a>
<a name="ln-6894"></a>     <span class="c">!calculate time for end of shut down period</span>
<a name="ln-6895"></a>     <span class="n">CurrentFractionalDay</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">DayOfSim</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-6896"></a>                            <span class="o">+</span> <span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">SysTimeElapsed</span><span class="o">+</span><span class="p">(</span><span class="n">CurrentTime</span> <span class="o">-</span> <span class="nb">INT</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">))))</span><span class="o">/</span><span class="n">HoursInDay</span> <span class="c">!</span>
<a name="ln-6897"></a>
<a name="ln-6898"></a>     <span class="n">EndingFractionalDay</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">FractionalDayofLastShutDown</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-6899"></a>        <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ShutDownTime</span><span class="o">/</span><span class="n">HoursInDay</span>
<a name="ln-6900"></a>
<a name="ln-6901"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">CurrentFractionalDay</span> <span class="o">&gt;</span> <span class="n">EndingFractionalDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6902"></a>      <span class="c">!start up period is now over</span>
<a name="ln-6903"></a>         <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DuringShutDown</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6904"></a>     <span class="n">ENDIF</span>
<a name="ln-6905"></a>   <span class="n">ENDIF</span>
<a name="ln-6906"></a> <span class="c">!compare</span>
<a name="ln-6907"></a>
<a name="ln-6908"></a>  <span class="k">If</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DuringShutDown</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DuringStartUp</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-6909"></a>    <span class="c">!unit is neither starting or stopping and the only constraints would come from transient limits</span>
<a name="ln-6910"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Pel</span> <span class="o">&gt;</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelLastTimeStep</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! powering up</span>
<a name="ln-6911"></a>      <span class="n">MaxPel</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelLastTimeStep</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">UpTranLimit</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span>
<a name="ln-6912"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MaxPel</span> <span class="o">&lt;</span> <span class="n">Pel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6913"></a><span class="k">        </span><span class="n">Pel</span> <span class="o">=</span> <span class="n">MaxPel</span>
<a name="ln-6914"></a>        <span class="n">Constrained</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6915"></a>      <span class="k">Else</span>
<a name="ln-6916"></a><span class="k">        </span><span class="n">Constrained</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6917"></a>      <span class="n">ENDIF</span>
<a name="ln-6918"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Pel</span><span class="o">&lt;</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelLastTimeStep</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!powering down</span>
<a name="ln-6919"></a>      <span class="n">MinPel</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelLastTimeStep</span> <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DownTranLimit</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span>  <span class="n">SecInHour</span>
<a name="ln-6920"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Pel</span> <span class="o">&lt;</span> <span class="n">MinPel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6921"></a><span class="k">        </span><span class="n">Pel</span> <span class="o">=</span> <span class="n">MinPel</span>
<a name="ln-6922"></a>        <span class="n">Constrained</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6923"></a>      <span class="k">ELSE</span>
<a name="ln-6924"></a><span class="k">        </span><span class="n">Constrained</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6925"></a>      <span class="n">ENDIF</span>
<a name="ln-6926"></a>    <span class="k">ELSE</span> <span class="c">!the same</span>
<a name="ln-6927"></a>    <span class="c">!do nothing</span>
<a name="ln-6928"></a>      <span class="n">Constrained</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6929"></a>    <span class="n">ENDIF</span>
<a name="ln-6930"></a>
<a name="ln-6931"></a>  <span class="n">ENDIF</span> <span class="c">!not in start up or shut down</span>
<a name="ln-6932"></a>
<a name="ln-6933"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DuringStartUp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6934"></a>   <span class="c">!constant during start up modeling artifact</span>
<a name="ln-6935"></a>    <span class="n">Pel</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">StartUpElectProd</span><span class="o">/</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">StartUpTime</span>
<a name="ln-6936"></a>    <span class="n">Constrained</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6937"></a>  <span class="n">ENDIF</span>
<a name="ln-6938"></a>
<a name="ln-6939"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DuringShutDown</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6940"></a>
<a name="ln-6941"></a><span class="k">    </span><span class="n">Pel</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! assumes no power generated during shut down</span>
<a name="ln-6942"></a>    <span class="n">Constrained</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6943"></a>  <span class="n">ENDIF</span>
<a name="ln-6944"></a>
<a name="ln-6945"></a>  <span class="n">PelDiff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6946"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">constrained</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6947"></a><span class="k">   </span><span class="n">PelDiff</span> <span class="o">=</span> <span class="n">PelInput</span> <span class="o">-</span> <span class="n">Pel</span>
<a name="ln-6948"></a>  <span class="n">endif</span>
<a name="ln-6949"></a>
<a name="ln-6950"></a>
<a name="ln-6951"></a>  <span class="k">RETURN</span>
<a name="ln-6952"></a>
<a name="ln-6953"></a><span class="k">END SUBROUTINE </span><span class="n">FigureTransientConstraints</span>
<a name="ln-6954"></a>
<a name="ln-6955"></a><span class="k">SUBROUTINE </span><span class="n">CalcFuelCellAuxHeater</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<a name="ln-6956"></a>
<a name="ln-6957"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6958"></a>          <span class="c">!       AUTHOR         &lt;author&gt;</span>
<a name="ln-6959"></a>          <span class="c">!       DATE WRITTEN   &lt;date_written&gt;</span>
<a name="ln-6960"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6961"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6962"></a>
<a name="ln-6963"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6964"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6965"></a>
<a name="ln-6966"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6967"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6968"></a>
<a name="ln-6969"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6970"></a>          <span class="c">! na</span>
<a name="ln-6971"></a>
<a name="ln-6972"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6973"></a>          <span class="c">! na</span>
<a name="ln-6974"></a>
<a name="ln-6975"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6976"></a>
<a name="ln-6977"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6978"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">Num</span>     <span class="c">! Generator number</span>
<a name="ln-6979"></a>
<a name="ln-6980"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6981"></a>          <span class="c">! na</span>
<a name="ln-6982"></a>
<a name="ln-6983"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6984"></a>          <span class="c">! na</span>
<a name="ln-6985"></a>
<a name="ln-6986"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6987"></a>          <span class="c">! na</span>
<a name="ln-6988"></a>
<a name="ln-6989"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6990"></a>          <span class="c">! na</span>
<a name="ln-6991"></a>
<a name="ln-6992"></a>  <span class="c">!not yet implemented, just pass product gases thru nul domain</span>
<a name="ln-6993"></a>
<a name="ln-6994"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">TauxMix</span>           <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TprodGasLeavingFCPM</span>
<a name="ln-6995"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">NdotAuxMix</span>        <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotProdGas</span>
<a name="ln-6996"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">ConstitMolalFract</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ConstitMolalFract</span>
<a name="ln-6997"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">GasLibID</span>          <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">GasLibID</span>
<a name="ln-6998"></a>
<a name="ln-6999"></a>  <span class="k">RETURN</span>
<a name="ln-7000"></a>
<a name="ln-7001"></a><span class="k">END SUBROUTINE </span><span class="n">CalcFuelCellAuxHeater</span>
<a name="ln-7002"></a>
<a name="ln-7003"></a>
<a name="ln-7004"></a><span class="k">SUBROUTINE </span><span class="n">CalcFuelCellGenHeatRecovery</span><span class="p">(</span><span class="n">Num</span><span class="p">)</span>
<a name="ln-7005"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7006"></a>            <span class="c">!       AUTHOR:          Brent Griffith</span>
<a name="ln-7007"></a>            <span class="c">!       DATE WRITTEN:    Aug. 2005</span>
<a name="ln-7008"></a>
<a name="ln-7009"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7010"></a>            <span class="c">! To perform heat recovery calculations and node updates</span>
<a name="ln-7011"></a>
<a name="ln-7012"></a>
<a name="ln-7013"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7014"></a>            <span class="c">! model exhaust gas to water heat exchanger</span>
<a name="ln-7015"></a>
<a name="ln-7016"></a>
<a name="ln-7017"></a>            <span class="c">! REFERENCES: Annex 42 model documentation</span>
<a name="ln-7018"></a>
<a name="ln-7019"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-7020"></a>  <span class="k">USE </span><span class="n">FluidProperties</span> <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-7021"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-7022"></a>
<a name="ln-7023"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-7024"></a>
<a name="ln-7025"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7026"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">Num</span>     <span class="c">! Generator number</span>
<a name="ln-7027"></a>
<a name="ln-7028"></a>
<a name="ln-7029"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7030"></a>          <span class="c">! na</span>
<a name="ln-7031"></a>
<a name="ln-7032"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7033"></a>          <span class="c">! na</span>
<a name="ln-7034"></a>
<a name="ln-7035"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7036"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">eHX</span> <span class="c">! fixed effectiveness</span>
<a name="ln-7037"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MdotWater</span>
<a name="ln-7038"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">inNodeNum</span>
<a name="ln-7039"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MWwater</span>
<a name="ln-7040"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NdotWater</span>
<a name="ln-7041"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TwaterIn</span>
<a name="ln-7042"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CpWaterMol</span>
<a name="ln-7043"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NdotGas</span>
<a name="ln-7044"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TprodGasIn</span>
<a name="ln-7045"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CpProdGasMol</span>
<a name="ln-7046"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NdotCp</span>
<a name="ln-7047"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">qHX</span>
<a name="ln-7048"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">UAeff</span>
<a name="ln-7049"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TauxMix</span>
<a name="ln-7050"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NdotCpWater</span>
<a name="ln-7051"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NdotCpAuxMix</span>
<a name="ln-7052"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">THXexh</span>
<a name="ln-7053"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TwaterOut</span>
<a name="ln-7054"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">hgas</span>
<a name="ln-7055"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">hwater</span>
<a name="ln-7056"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">waterFract</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-7057"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NdotWaterVapor</span>
<a name="ln-7058"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TcondThresh</span>
<a name="ln-7059"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">hxl1</span>
<a name="ln-7060"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">hxl2</span>
<a name="ln-7061"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NdotWaterCond</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-7062"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">hfpwater</span>
<a name="ln-7063"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">I</span>
<a name="ln-7064"></a>
<a name="ln-7065"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">qSens</span>
<a name="ln-7066"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">qLatent</span>
<a name="ln-7067"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">loop</span>
<a name="ln-7068"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Cp</span>
<a name="ln-7069"></a>
<a name="ln-7070"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">HXmodelMode</span><span class="p">)</span>
<a name="ln-7071"></a>
<a name="ln-7072"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">FixedEffectiveness</span><span class="p">)</span> <span class="c">!Method 1</span>
<a name="ln-7073"></a>
<a name="ln-7074"></a>    <span class="n">eHX</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">HXEffect</span>
<a name="ln-7075"></a>
<a name="ln-7076"></a>    <span class="n">inNodeNum</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInNode</span>
<a name="ln-7077"></a>
<a name="ln-7078"></a>    <span class="n">MdotWater</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterMassFlowRate</span>
<a name="ln-7079"></a>    <span class="n">MWwater</span>   <span class="o">=</span>   <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">MolecularWeight</span>
<a name="ln-7080"></a>    <span class="n">NdotWater</span> <span class="o">=</span> <span class="n">MdotWater</span><span class="o">/</span><span class="n">MWwater</span>
<a name="ln-7081"></a>    <span class="n">TwaterIn</span>  <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInletTemp</span>
<a name="ln-7082"></a>
<a name="ln-7083"></a>    <span class="k">CALL </span><span class="n">FigureLiquidWaterHeatCap</span><span class="p">(</span><span class="n">TwaterIn</span><span class="p">,</span> <span class="n">CpWaterMol</span><span class="p">)</span>
<a name="ln-7084"></a>
<a name="ln-7085"></a>    <span class="n">NdotGas</span>   <span class="o">=</span>   <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">NdotAuxMix</span>
<a name="ln-7086"></a>    <span class="n">TprodGasIn</span> <span class="o">=</span>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">TauxMix</span>
<a name="ln-7087"></a>    <span class="k">CALL </span><span class="n">FigureAuxilHeatGasHeatCap</span><span class="p">(</span><span class="n">Num</span><span class="p">,</span> <span class="n">TprodGasIn</span> <span class="p">,</span> <span class="n">CpProdGasMol</span><span class="p">)</span> <span class="c">! Cp in (J/mol*K)</span>
<a name="ln-7088"></a>    <span class="c">!factor of 1000.0 for kmol -&gt; mol</span>
<a name="ln-7089"></a>    <span class="n">NdotCp</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">NdotGas</span><span class="o">*</span><span class="n">CpProdGasMol</span><span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">NdotWater</span><span class="o">*</span><span class="n">CpWaterMol</span><span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7090"></a>
<a name="ln-7091"></a>    <span class="n">qHX</span>   <span class="o">=</span> <span class="n">eHX</span> <span class="o">*</span> <span class="n">NdotCp</span><span class="o">*</span><span class="p">(</span><span class="n">TprodGasIn</span> <span class="o">-</span> <span class="n">TwaterIn</span><span class="p">)</span>
<a name="ln-7092"></a>
<a name="ln-7093"></a>    <span class="n">THXexh</span> <span class="o">=</span> <span class="n">TprodGasIn</span> <span class="o">-</span> <span class="n">qHX</span> <span class="o">/</span> <span class="p">(</span><span class="n">NdotGas</span><span class="o">*</span><span class="n">CpProdGasMol</span><span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7094"></a>
<a name="ln-7095"></a>    <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7096"></a>                               <span class="n">TwaterIn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7097"></a>                               <span class="n">PlantLoop</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7098"></a>                               <span class="s1">&#39;CalcFuelCellGenHeatRecovery&#39;</span><span class="p">)</span>
<a name="ln-7099"></a>
<a name="ln-7100"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MdotWater</span> <span class="o">*</span> <span class="n">Cp</span>  <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7101"></a><span class="k">      </span><span class="n">TwaterOut</span> <span class="o">=</span>  <span class="n">TwaterIn</span>
<a name="ln-7102"></a>    <span class="k">ELSE</span>
<a name="ln-7103"></a><span class="k">      </span><span class="n">TwaterOut</span>  <span class="o">=</span>  <span class="n">TwaterIn</span> <span class="o">+</span> <span class="n">qHX</span> <span class="o">/</span> <span class="p">(</span><span class="n">MdotWater</span> <span class="o">*</span> <span class="n">Cp</span><span class="p">)</span>
<a name="ln-7104"></a>    <span class="n">ENDIF</span>
<a name="ln-7105"></a>
<a name="ln-7106"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">LMTDempiricalUAeff</span><span class="p">)</span> <span class="c">!method 2</span>
<a name="ln-7107"></a>    <span class="n">inNodeNum</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInNode</span>
<a name="ln-7108"></a>    <span class="n">MdotWater</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterMassFlowRate</span>
<a name="ln-7109"></a>    <span class="n">MWwater</span>   <span class="o">=</span>   <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">MolecularWeight</span>
<a name="ln-7110"></a>    <span class="n">NdotWater</span> <span class="o">=</span> <span class="n">MdotWater</span><span class="o">/</span><span class="n">MWwater</span>
<a name="ln-7111"></a>    <span class="n">NdotGas</span>   <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">NdotAuxMix</span>
<a name="ln-7112"></a>
<a name="ln-7113"></a>    <span class="n">UAeff</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">hxs0</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">hxs1</span><span class="o">*</span><span class="n">NdotWater</span>   <span class="p">&amp;</span>
<a name="ln-7114"></a>            <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">hxs2</span> <span class="o">*</span> <span class="p">(</span><span class="n">NdotWater</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>                     <span class="p">&amp;</span>
<a name="ln-7115"></a>            <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">hxs3</span> <span class="o">*</span> <span class="n">NdotGas</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">hxs4</span><span class="o">*</span><span class="p">(</span><span class="n">NdotGas</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7116"></a>
<a name="ln-7117"></a>    <span class="n">TauxMix</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">TauxMix</span>
<a name="ln-7118"></a>    <span class="n">TwaterIn</span>  <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInletTemp</span>
<a name="ln-7119"></a>    <span class="k">CALL </span><span class="n">FigureLiquidWaterHeatCap</span><span class="p">(</span><span class="n">TwaterIn</span><span class="p">,</span> <span class="n">CpWaterMol</span><span class="p">)</span>
<a name="ln-7120"></a>        <span class="c">!factor of 1000.0 for kmol -&gt; mol</span>
<a name="ln-7121"></a>    <span class="n">NdotCpWater</span> <span class="o">=</span> <span class="n">NdotWater</span><span class="o">*</span><span class="n">CpWaterMol</span><span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-7122"></a>    <span class="k">CALL </span><span class="n">FigureAuxilHeatGasHeatCap</span><span class="p">(</span><span class="n">Num</span><span class="p">,</span> <span class="n">TauxMix</span> <span class="p">,</span> <span class="n">CpProdGasMol</span><span class="p">)</span> <span class="c">! Cp in (J/mol*K)</span>
<a name="ln-7123"></a>    <span class="n">NdotCpAuxMix</span> <span class="o">=</span> <span class="n">NdotGas</span><span class="o">*</span><span class="n">CpProdGasMol</span><span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-7124"></a>
<a name="ln-7125"></a>    <span class="c">! commented out protection for taking exponent of too large a number</span>
<a name="ln-7126"></a>    <span class="c">!   because it hasn&#39;t been a problem in testing</span>
<a name="ln-7127"></a>    <span class="c">!testVal = log(huge(NdotCpAuxMix))</span>
<a name="ln-7128"></a>    <span class="c">!ExpTestVal = 700.0</span>
<a name="ln-7129"></a>    <span class="c">!IF (UAeff*(1/NdotCpAuxMix) &gt; ExpTestVal) THEN</span>
<a name="ln-7130"></a>      <span class="c">! write(*,*) &#39;Houston, we have a problem, EXP [] func will fail for UAeff*(1/NdotCpAuxMix):&#39;, UAeff*(1/NdotCpAuxMix)</span>
<a name="ln-7131"></a>   <span class="c">! ELSEIF (UAeff*(1/NdotCpWater) &gt; ExpTestVal) THEN</span>
<a name="ln-7132"></a>    <span class="c">!   write(*,*) &#39;Houston, we have a problem, EXP [] func will fail for UAeff*(1/NdotCpWater:&#39;, UAeff*(1/NdotCpWater)</span>
<a name="ln-7133"></a>  <span class="c">!  ELSE</span>
<a name="ln-7134"></a>
<a name="ln-7135"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">NdotCpWater</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">NdotCpAuxMix</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">then</span> <span class="c">! trap divide by zero</span>
<a name="ln-7136"></a>      <span class="c">! now evaluate Eq. 44</span>
<a name="ln-7137"></a>      <span class="n">THXexh</span> <span class="o">=</span> <span class="p">((</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">NdotCpAuxMix</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-7138"></a>                  <span class="p">(</span><span class="nb">EXP</span><span class="p">(</span><span class="n">UAeff</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpAuxMix</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">))</span> <span class="o">-</span> <span class="n">NdotCpAuxMix</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span> <span class="p">)</span><span class="o">*</span> <span class="n">TauxMix</span>  <span class="p">&amp;</span>
<a name="ln-7139"></a>            <span class="o">+</span><span class="p">(</span>    <span class="p">(</span><span class="nb">EXP</span><span class="p">(</span><span class="n">UAeff</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpAuxMix</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">))</span> <span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span>               <span class="p">&amp;</span>
<a name="ln-7140"></a>                 <span class="o">/</span><span class="p">(</span><span class="nb">EXP</span><span class="p">(</span><span class="n">UAeff</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpAuxMix</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">))</span> <span class="o">-</span> <span class="n">NdotCpAuxMix</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span> <span class="p">)</span><span class="o">*</span> <span class="n">TwaterIn</span>
<a name="ln-7141"></a>
<a name="ln-7142"></a>      <span class="n">TwaterOut</span> <span class="o">=</span> <span class="n">TwaterIn</span> <span class="o">+</span> <span class="p">(</span><span class="n">NdotCpAuxMix</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">TauxMix</span> <span class="o">-</span> <span class="n">THXexh</span><span class="p">)</span>  <span class="c">! Eq. 42</span>
<a name="ln-7143"></a>
<a name="ln-7144"></a>    <span class="k">ELSE</span>
<a name="ln-7145"></a><span class="k">      </span><span class="n">THXexh</span> <span class="o">=</span> <span class="n">TauxMix</span>
<a name="ln-7146"></a>      <span class="n">TwaterOut</span> <span class="o">=</span> <span class="n">TwaterIn</span>
<a name="ln-7147"></a>    <span class="n">ENDIF</span>
<a name="ln-7148"></a>   <span class="c">! ENDIF</span>
<a name="ln-7149"></a>
<a name="ln-7150"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">THXexh</span> <span class="o">-</span> <span class="n">TwaterIn</span><span class="p">)</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! trap divide by zero</span>
<a name="ln-7151"></a>      <span class="n">qHX</span> <span class="o">=</span> <span class="n">UAeff</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">TauxMix</span> <span class="o">-</span> <span class="n">TwaterOut</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">THXexh</span> <span class="o">-</span> <span class="n">TwaterIn</span><span class="p">)</span> <span class="p">)</span><span class="o">/</span><span class="nb">LOG</span><span class="p">(</span> <span class="p">(</span><span class="n">TauxMix</span> <span class="o">-</span> <span class="n">TwaterOut</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">THXexh</span> <span class="o">-</span> <span class="n">TwaterIn</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-7152"></a>    <span class="k">ELSE</span>
<a name="ln-7153"></a><span class="k">      </span><span class="n">qHX</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7154"></a>    <span class="n">ENDIF</span>
<a name="ln-7155"></a>
<a name="ln-7156"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">LMTDfundementalUAeff</span><span class="p">)</span> <span class="c">!method 3</span>
<a name="ln-7157"></a>    <span class="n">NdotGas</span>   <span class="o">=</span>   <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">NdotAuxMix</span>
<a name="ln-7158"></a>    <span class="n">inNodeNum</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInNode</span>
<a name="ln-7159"></a>    <span class="n">MdotWater</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterMassFlowRate</span>
<a name="ln-7160"></a>    <span class="n">MWwater</span>   <span class="o">=</span>   <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">MolecularWeight</span>
<a name="ln-7161"></a>    <span class="n">NdotWater</span> <span class="o">=</span> <span class="n">MdotWater</span><span class="o">/</span><span class="n">MWwater</span>
<a name="ln-7162"></a>
<a name="ln-7163"></a>    <span class="n">hgas</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">h0gas</span> <span class="o">*</span> <span class="p">(</span><span class="n">NdotGas</span><span class="o">/</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">NdotGasRef</span><span class="p">)</span><span class="o">**</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">nCoeff</span> <span class="c">!Eq. 48</span>
<a name="ln-7164"></a>
<a name="ln-7165"></a>    <span class="n">hwater</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">h0Water</span>   <span class="p">&amp;</span>
<a name="ln-7166"></a>       <span class="o">*</span> <span class="p">(</span><span class="n">NdotWater</span><span class="o">/</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">NdotWaterRef</span><span class="p">)</span><span class="o">**</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">mCoeff</span> <span class="c">!Eq. 48</span>
<a name="ln-7167"></a>
<a name="ln-7168"></a>    <span class="c">! now equation 47</span>
<a name="ln-7169"></a>    <span class="n">UAeff</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="n">hgas</span><span class="o">*</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">AreaGas</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="n">hwater</span><span class="o">*</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">AreaWater</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-7170"></a>       <span class="o">+</span>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">Fadjust</span><span class="p">)</span>
<a name="ln-7171"></a>
<a name="ln-7172"></a>    <span class="n">TauxMix</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">TauxMix</span>
<a name="ln-7173"></a>    <span class="n">TwaterIn</span>  <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInletTemp</span>
<a name="ln-7174"></a>    <span class="k">CALL </span><span class="n">FigureLiquidWaterHeatCap</span><span class="p">(</span><span class="n">TwaterIn</span><span class="p">,</span> <span class="n">CpWaterMol</span><span class="p">)</span>
<a name="ln-7175"></a>    <span class="n">NdotCpWater</span> <span class="o">=</span> <span class="n">NdotWater</span><span class="o">*</span><span class="n">CpWaterMol</span><span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-7176"></a>    <span class="k">CALL </span><span class="n">FigureAuxilHeatGasHeatCap</span><span class="p">(</span><span class="n">Num</span><span class="p">,</span> <span class="n">TauxMix</span> <span class="p">,</span> <span class="n">CpProdGasMol</span><span class="p">)</span> <span class="c">! Cp in (J/mol*K)</span>
<a name="ln-7177"></a>    <span class="n">NdotCpAuxMix</span> <span class="o">=</span> <span class="n">NdotGas</span><span class="o">*</span><span class="n">CpProdGasMol</span><span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-7178"></a>
<a name="ln-7179"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">NdotCpWater</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">NdotCpAuxMix</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">then</span> <span class="c">! trap divide by zero</span>
<a name="ln-7180"></a>    <span class="c">! now evaluate Eq. 44</span>
<a name="ln-7181"></a>      <span class="n">THXexh</span> <span class="o">=</span> <span class="p">((</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">NdotCpAuxMix</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-7182"></a>                  <span class="p">(</span><span class="nb">EXP</span><span class="p">(</span><span class="n">UAeff</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpAuxMix</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">))</span> <span class="o">-</span> <span class="n">NdotCpAuxMix</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span> <span class="p">)</span><span class="o">*</span> <span class="n">TauxMix</span>  <span class="p">&amp;</span>
<a name="ln-7183"></a>            <span class="o">+</span><span class="p">(</span>    <span class="p">(</span><span class="nb">EXP</span><span class="p">(</span><span class="n">UAeff</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpAuxMix</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">))</span> <span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span>               <span class="p">&amp;</span>
<a name="ln-7184"></a>                 <span class="o">/</span><span class="p">(</span><span class="nb">EXP</span><span class="p">(</span><span class="n">UAeff</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpAuxMix</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">))</span> <span class="o">-</span> <span class="n">NdotCpAuxMix</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span> <span class="p">)</span><span class="o">*</span> <span class="n">TwaterIn</span>
<a name="ln-7185"></a>
<a name="ln-7186"></a>      <span class="n">TwaterOut</span> <span class="o">=</span> <span class="n">TwaterIn</span> <span class="o">+</span> <span class="p">(</span><span class="n">NdotCpAuxMix</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">TauxMix</span> <span class="o">-</span> <span class="n">THXexh</span><span class="p">)</span>  <span class="c">! Eq. 42</span>
<a name="ln-7187"></a>
<a name="ln-7188"></a>    <span class="k">ELSE</span>
<a name="ln-7189"></a><span class="k">      </span><span class="n">THXexh</span>    <span class="o">=</span> <span class="n">TauxMix</span>
<a name="ln-7190"></a>      <span class="n">TwaterOut</span> <span class="o">=</span> <span class="n">TwaterIn</span>
<a name="ln-7191"></a>    <span class="n">ENDIF</span>
<a name="ln-7192"></a>
<a name="ln-7193"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">THXexh</span> <span class="o">-</span> <span class="n">TwaterIn</span><span class="p">)</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! trap divide by zero</span>
<a name="ln-7194"></a>      <span class="n">qHX</span> <span class="o">=</span> <span class="n">UAeff</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">TauxMix</span> <span class="o">-</span> <span class="n">TwaterOut</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">THXexh</span> <span class="o">-</span> <span class="n">TwaterIn</span><span class="p">)</span> <span class="p">)</span><span class="o">/</span><span class="nb">LOG</span><span class="p">(</span> <span class="p">(</span><span class="n">TauxMix</span> <span class="o">-</span> <span class="n">TwaterOut</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">THXexh</span> <span class="o">-</span> <span class="n">TwaterIn</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-7195"></a>    <span class="k">ELSE</span>
<a name="ln-7196"></a><span class="k">      </span><span class="n">qHX</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7197"></a>    <span class="n">ENDIF</span>
<a name="ln-7198"></a>
<a name="ln-7199"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">Condensing</span><span class="p">)</span> <span class="c">!method 4</span>
<a name="ln-7200"></a>    <span class="n">inNodeNum</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInNode</span>
<a name="ln-7201"></a>    <span class="n">MdotWater</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterMassFlowRate</span>
<a name="ln-7202"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">MdotWater</span> <span class="o">/=</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">Then</span> <span class="c">!</span>
<a name="ln-7203"></a>
<a name="ln-7204"></a>
<a name="ln-7205"></a>      <span class="n">MWwater</span>   <span class="o">=</span>   <span class="n">GasPhaseThermoChemistryData</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">MolecularWeight</span>
<a name="ln-7206"></a>      <span class="n">NdotWater</span> <span class="o">=</span> <span class="n">MdotWater</span><span class="o">/</span><span class="n">MWwater</span>
<a name="ln-7207"></a>      <span class="n">NdotGas</span>   <span class="o">=</span>   <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">NdotAuxMix</span>
<a name="ln-7208"></a>
<a name="ln-7209"></a>      <span class="n">UAeff</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">hxs0</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">hxs1</span><span class="o">*</span><span class="n">NdotWater</span>   <span class="p">&amp;</span>
<a name="ln-7210"></a>              <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">hxs2</span> <span class="o">*</span> <span class="n">NdotWater</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>                     <span class="p">&amp;</span>
<a name="ln-7211"></a>              <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">hxs3</span> <span class="o">*</span> <span class="n">NdotGas</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">hxs4</span><span class="o">*</span><span class="n">NdotGas</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-7212"></a>
<a name="ln-7213"></a>      <span class="n">TauxMix</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">TauxMix</span>
<a name="ln-7214"></a>      <span class="n">TwaterIn</span>  <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInletTemp</span>
<a name="ln-7215"></a>      <span class="k">CALL </span><span class="n">FigureLiquidWaterHeatCap</span><span class="p">(</span><span class="n">TwaterIn</span><span class="p">,</span> <span class="n">CpWaterMol</span><span class="p">)</span>
<a name="ln-7216"></a>      <span class="n">NdotCpWater</span> <span class="o">=</span> <span class="n">NdotWater</span><span class="o">*</span><span class="n">CpWaterMol</span><span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-7217"></a>      <span class="k">CALL </span><span class="n">FigureAuxilHeatGasHeatCap</span><span class="p">(</span><span class="n">Num</span><span class="p">,</span> <span class="n">TauxMix</span> <span class="p">,</span> <span class="n">CpProdGasMol</span><span class="p">)</span> <span class="c">! Cp in (J/mol*K)</span>
<a name="ln-7218"></a>      <span class="n">NdotCpAuxMix</span> <span class="o">=</span> <span class="n">NdotGas</span><span class="o">*</span><span class="n">CpProdGasMol</span><span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-7219"></a>
<a name="ln-7220"></a>     <span class="c">!find water fraction in incoming gas stream</span>
<a name="ln-7221"></a>      <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Size</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">)</span>
<a name="ln-7222"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">GasLibID</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="n">waterFract</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-7223"></a>      <span class="n">ENDDO</span>
<a name="ln-7224"></a>      <span class="n">NdotWaterVapor</span> <span class="o">=</span><span class="n">waterFract</span> <span class="o">*</span> <span class="n">NdotGas</span>
<a name="ln-7225"></a>
<a name="ln-7226"></a>      <span class="n">TcondThresh</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">CondensationThresholdTemp</span>
<a name="ln-7227"></a>      <span class="n">hxl1</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">l1Coeff</span>
<a name="ln-7228"></a>      <span class="n">hxl2</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">l2Coeff</span>
<a name="ln-7229"></a>
<a name="ln-7230"></a>      <span class="n">NdotWaterCond</span> <span class="o">=</span> <span class="p">(</span><span class="n">TcondThresh</span> <span class="o">-</span> <span class="n">TwaterIn</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="n">hxl1</span> <span class="o">*</span> <span class="p">(</span><span class="n">NdotWaterVapor</span><span class="o">/</span><span class="n">NdotGas</span><span class="p">)</span> <span class="o">+</span> <span class="n">hxl2</span><span class="o">*</span><span class="p">(</span><span class="n">NdotWaterVapor</span><span class="o">/</span><span class="n">NdotGas</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7231"></a>
<a name="ln-7232"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">NdotWaterCond</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">NdotWaterCond</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7233"></a>
<a name="ln-7234"></a>      <span class="n">hfpwater</span> <span class="o">=</span>  <span class="mf">4.4004d+07</span>  <span class="c">! molal heat of vaporization of water J/kmol)</span>
<a name="ln-7235"></a>
<a name="ln-7236"></a>      <span class="k">If</span> <span class="p">((</span><span class="n">NdotCpWater</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">NdotCpAuxMix</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">then</span> <span class="c">! trap divide by zero</span>
<a name="ln-7237"></a>
<a name="ln-7238"></a>      <span class="c">! now evaluate Eq. 44</span>
<a name="ln-7239"></a>        <span class="n">THXexh</span> <span class="o">=</span> <span class="p">((</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">NdotCpAuxMix</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span><span class="o">/</span>    <span class="p">&amp;</span>
<a name="ln-7240"></a>                    <span class="p">(</span><span class="nb">EXP</span><span class="p">(</span><span class="n">UAeff</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpAuxMix</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">))</span> <span class="o">-</span> <span class="n">NdotCpAuxMix</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span> <span class="p">)</span><span class="o">*</span> <span class="n">TauxMix</span>  <span class="p">&amp;</span>
<a name="ln-7241"></a>              <span class="o">+</span><span class="p">(</span>    <span class="p">(</span><span class="nb">EXP</span><span class="p">(</span><span class="n">UAeff</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpAuxMix</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">))</span> <span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span>               <span class="p">&amp;</span>
<a name="ln-7242"></a>                   <span class="o">/</span><span class="p">(</span><span class="nb">EXP</span><span class="p">(</span><span class="n">UAeff</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpAuxMix</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">))</span> <span class="o">-</span> <span class="n">NdotCpAuxMix</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span> <span class="p">)</span><span class="o">*</span> <span class="n">TwaterIn</span>
<a name="ln-7243"></a>
<a name="ln-7244"></a>        <span class="n">TwaterOut</span> <span class="o">=</span> <span class="n">TwaterIn</span> <span class="o">+</span> <span class="p">(</span><span class="n">NdotCpAuxMix</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">TauxMix</span> <span class="o">-</span> <span class="n">THXexh</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">NdotWaterCond</span> <span class="o">*</span> <span class="n">hfpwater</span><span class="p">)</span><span class="o">/</span><span class="n">NdotCpWater</span>
<a name="ln-7245"></a>
<a name="ln-7246"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NdotWaterCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span> <span class="c">! Eq. 44 is not correct. use its result as first guess for revised way...</span>
<a name="ln-7247"></a>
<a name="ln-7248"></a>               <span class="k">do </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span> <span class="c">! iterative soluion because in condensing case THXexh is function of qSens and qLatent</span>
<a name="ln-7249"></a>
<a name="ln-7250"></a>                  <span class="k">IF</span> <span class="p">((</span><span class="n">THXexh</span> <span class="o">-</span> <span class="n">TwaterIn</span><span class="p">)</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! trap divide by zero</span>
<a name="ln-7251"></a>                    <span class="n">qSens</span> <span class="o">=</span> <span class="n">UAeff</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">TauxMix</span> <span class="o">-</span> <span class="n">TwaterOut</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">THXexh</span> <span class="o">-</span> <span class="n">TwaterIn</span><span class="p">)</span> <span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-7252"></a>                                           <span class="nb">LOG</span><span class="p">(</span> <span class="p">(</span><span class="n">TauxMix</span> <span class="o">-</span> <span class="n">TwaterOut</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">THXexh</span> <span class="o">-</span> <span class="n">TwaterIn</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-7253"></a>                  <span class="k">else</span>
<a name="ln-7254"></a><span class="k">                    </span><span class="n">qSens</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7255"></a>                  <span class="n">endif</span>
<a name="ln-7256"></a>                  <span class="n">qLatent</span><span class="o">=</span>  <span class="n">NdotWaterCond</span> <span class="o">*</span> <span class="n">hfpwater</span>
<a name="ln-7257"></a>                  <span class="k">If</span> <span class="p">(</span><span class="n">qSens</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-7258"></a><span class="k">                    </span><span class="n">THXexh</span> <span class="o">=</span> <span class="n">TauxMix</span> <span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">NdotCpAuxMix</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span>                                                     <span class="p">&amp;</span>
<a name="ln-7259"></a>                                        <span class="o">/</span><span class="p">(</span>  <span class="p">(</span> <span class="nb">EXP</span><span class="p">(</span><span class="n">UAeff</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpAuxMix</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span> <span class="p">)</span>                           <span class="p">&amp;</span>
<a name="ln-7260"></a>                                           <span class="o">/</span><span class="p">(</span> <span class="nb">EXP</span><span class="p">((</span><span class="n">UAeff</span> <span class="o">*</span> <span class="n">qLatent</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">NdotCpWater</span> <span class="o">*</span> <span class="n">qSens</span><span class="p">))</span> <span class="p">)</span> <span class="p">)</span> <span class="o">-</span> <span class="n">NdotCpAuxMix</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7261"></a>                           <span class="o">+</span> <span class="n">TwaterIn</span> <span class="o">*</span><span class="p">(</span> <span class="p">(</span> <span class="nb">EXP</span><span class="p">(</span><span class="n">UAeff</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpAuxMix</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">))</span>                               <span class="p">&amp;</span>
<a name="ln-7262"></a>                                          <span class="o">/</span><span class="p">(</span> <span class="nb">EXP</span><span class="p">((</span><span class="n">UAeff</span> <span class="o">*</span> <span class="n">qLatent</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">NdotCpWater</span> <span class="o">*</span> <span class="n">qSens</span><span class="p">))</span> <span class="p">)</span>      <span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span>                     <span class="p">&amp;</span>
<a name="ln-7263"></a>                                          <span class="o">/</span><span class="p">(</span><span class="nb">EXP</span><span class="p">(</span><span class="n">UAeff</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpAuxMix</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">))</span>                              <span class="p">&amp;</span>
<a name="ln-7264"></a>                                           <span class="o">/</span><span class="p">(</span> <span class="nb">EXP</span><span class="p">((</span><span class="n">UAeff</span> <span class="o">*</span> <span class="n">qLatent</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">NdotCpWater</span> <span class="o">*</span> <span class="n">qSens</span><span class="p">))</span> <span class="p">)</span> <span class="o">-</span> <span class="n">NdotCpAuxMix</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span> <span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-7265"></a>                           <span class="o">-</span><span class="p">(</span> <span class="p">(</span><span class="n">qLatent</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="nb">EXP</span><span class="p">(</span><span class="n">UAeff</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpAuxMix</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">))</span>                    <span class="p">&amp;</span>
<a name="ln-7266"></a>                                           <span class="o">/</span><span class="p">(</span> <span class="nb">EXP</span><span class="p">((</span><span class="n">UAeff</span> <span class="o">*</span> <span class="n">qLatent</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">NdotCpWater</span> <span class="o">*</span> <span class="n">qSens</span><span class="p">))</span> <span class="p">)</span> <span class="o">-</span> <span class="n">NdotCpAuxMix</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-7267"></a>                  <span class="k">else</span>
<a name="ln-7268"></a><span class="k">                    </span><span class="n">THXexh</span> <span class="o">=</span> <span class="n">TauxMix</span>
<a name="ln-7269"></a>                  <span class="n">endif</span>
<a name="ln-7270"></a>
<a name="ln-7271"></a>                  <span class="n">TwaterOut</span> <span class="o">=</span> <span class="n">TwaterIn</span> <span class="o">+</span> <span class="p">(</span><span class="n">NdotCpAuxMix</span><span class="o">/</span><span class="n">NdotCpWater</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">TauxMix</span> <span class="o">-</span> <span class="n">THXexh</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">NdotWaterCond</span> <span class="o">*</span> <span class="n">hfpwater</span><span class="p">)</span><span class="o">/</span><span class="n">NdotCpWater</span>
<a name="ln-7272"></a>
<a name="ln-7273"></a>
<a name="ln-7274"></a>               <span class="n">enddo</span>
<a name="ln-7275"></a>
<a name="ln-7276"></a>        <span class="n">endif</span>
<a name="ln-7277"></a>
<a name="ln-7278"></a>      <span class="k">ELSE</span>
<a name="ln-7279"></a><span class="k">        </span><span class="n">THXexh</span>    <span class="o">=</span> <span class="n">TauxMix</span>
<a name="ln-7280"></a>        <span class="n">TwaterOut</span> <span class="o">=</span> <span class="n">TwaterIn</span>
<a name="ln-7281"></a>
<a name="ln-7282"></a>      <span class="n">ENDIF</span>
<a name="ln-7283"></a>
<a name="ln-7284"></a>
<a name="ln-7285"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">THXexh</span> <span class="o">-</span> <span class="n">TwaterIn</span><span class="p">)</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! trap divide by zero</span>
<a name="ln-7286"></a>
<a name="ln-7287"></a>        <span class="n">qHX</span> <span class="o">=</span> <span class="n">UAeff</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">TauxMix</span> <span class="o">-</span> <span class="n">TwaterOut</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">THXexh</span> <span class="o">-</span> <span class="n">TwaterIn</span><span class="p">)</span> <span class="p">)</span><span class="o">/</span><span class="nb">LOG</span><span class="p">(</span> <span class="p">(</span><span class="n">TauxMix</span> <span class="o">-</span> <span class="n">TwaterOut</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">THXexh</span> <span class="o">-</span> <span class="n">TwaterIn</span><span class="p">)</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7288"></a>               <span class="o">+</span> <span class="n">NdotWaterCond</span> <span class="o">*</span> <span class="n">hfpwater</span>
<a name="ln-7289"></a>      <span class="k">ELSE</span>
<a name="ln-7290"></a><span class="k">        </span><span class="n">qHX</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7291"></a>      <span class="n">ENDIF</span>
<a name="ln-7292"></a>    <span class="k">ELSE</span> <span class="c">!no cooling water flow, model will blow up.</span>
<a name="ln-7293"></a>      <span class="n">qHX</span>       <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-7294"></a>      <span class="n">THXexh</span>    <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">TauxMix</span>
<a name="ln-7295"></a>      <span class="n">TwaterOut</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInletTemp</span>
<a name="ln-7296"></a>      <span class="n">NdotWaterCond</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-7297"></a>      <span class="n">waterFract</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span><span class="mf">9.0D0</span> <span class="c">! not defined</span>
<a name="ln-7298"></a>
<a name="ln-7299"></a>    <span class="n">ENDIF</span>
<a name="ln-7300"></a>    <span class="c">!init input from Auxiliary heater</span>
<a name="ln-7301"></a>   <span class="c">! FuelCell(Num)%ExhaustHX%NdotHXleaving      = FuelCell(Num)%AuxilHeat%NdotAuxMix</span>
<a name="ln-7302"></a>   <span class="c">! FuelCell(Num)%ExhaustHX%ConstitMolalFract  = FuelCell(Num)%AuxilHeat%ConstitMolalFract</span>
<a name="ln-7303"></a>   <span class="c">! FuelCell(Num)%ExhaustHX%GasLibID           = FuelCell(Num)%AuxilHeat%GasLibID</span>
<a name="ln-7304"></a>
<a name="ln-7305"></a>    <span class="c">! now modify leaving gas constituents for condensed water.</span>
<a name="ln-7306"></a>   <span class="c">! FuelCell(Num)%ExhaustHX%NdotHXleaving = FuelCell(Num)%AuxilHeat%NdotAuxMix - NdotWaterCond</span>
<a name="ln-7307"></a>   <span class="c">! If ( FuelCell(Num)%ExhaustHX%NdotHXleaving &gt; 0) then</span>
<a name="ln-7308"></a>   <span class="c">!   DO I = 1, Size(FuelCell(Num)%AuxilHeat%GasLibID)</span>
<a name="ln-7309"></a>   <span class="c">!     If (FuelCell(Num)%AuxilHeat%GasLibID(I) == 4) then ! water constituent</span>
<a name="ln-7310"></a>   <span class="c">!       FuelCell(Num)%ExhaustHX%ConstitMolalFract(I) = &amp;</span>
<a name="ln-7311"></a>   <span class="c">!            (FuelCell(Num)%AuxilHeat%ConstitMolalFract(I)* FuelCell(Num)%AuxilHeat%NdotAuxMix - NdotWaterCond) &amp;</span>
<a name="ln-7312"></a>   <span class="c">!            /     FuelCell(Num)%ExhaustHX%NdotHXleaving</span>
<a name="ln-7313"></a>   <span class="c">!       cycle</span>
<a name="ln-7314"></a>   <span class="c">!     ENDIF</span>
<a name="ln-7315"></a>
<a name="ln-7316"></a>   <span class="c">!     FuelCell(Num)%ExhaustHX%ConstitMolalFract(I) = FuelCell(Num)%AuxilHeat%ConstitMolalFract(I) &amp;</span>
<a name="ln-7317"></a>   <span class="c">!                                       * FuelCell(Num)%AuxilHeat%NdotAuxMix / FuelCell(Num)%ExhaustHX%NdotHXleaving</span>
<a name="ln-7318"></a>   <span class="c">!   ENDDO</span>
<a name="ln-7319"></a>   <span class="c">! ENDIF</span>
<a name="ln-7320"></a>
<a name="ln-7321"></a>
<a name="ln-7322"></a>    <span class="c">! get new average heat capacity</span>
<a name="ln-7323"></a>    <span class="c">!CALL FigureHXleavingGasHeatCap(Num, (THXexh + TauxMix)/2 , CpHXleavingGasMol)</span>
<a name="ln-7324"></a>
<a name="ln-7325"></a>   <span class="c">! NdotCpHXleaving = FuelCell(Num)%ExhaustHX%NdotHXleaving*CpHXleavingGasMol* 1000.0</span>
<a name="ln-7326"></a>
<a name="ln-7327"></a>    <span class="c">! update gas leaving temperature with modified heat transfer rate</span>
<a name="ln-7328"></a>  <span class="c">!  IF ((NdotCpHXleaving &gt; 0) .AND. (qHX &gt; 0)) THEN</span>
<a name="ln-7329"></a>  <span class="c">!     THXexh = TauxMix - (qHX / NdotCpHXleaving)</span>
<a name="ln-7330"></a>  <span class="c">!  ELSE</span>
<a name="ln-7331"></a>  <span class="c">!     THXexh = TauxMix</span>
<a name="ln-7332"></a>  <span class="c">!  ENDIF</span>
<a name="ln-7333"></a>    <span class="c">! update water leaving temperature with modified heat transfer rate</span>
<a name="ln-7334"></a>  <span class="c">!  IF (MdotWater * CPCW( (TwaterIn + TwaterOut)/2 )  &lt;= 0.0) THEN</span>
<a name="ln-7335"></a>  <span class="c">!    TwaterOut =  TwaterIn</span>
<a name="ln-7336"></a>  <span class="c">!  ELSE</span>
<a name="ln-7337"></a>  <span class="c">!    TwaterOut  =  TwaterIn + qHX / (MdotWater * CPCW( (TwaterIn + TwaterOut)/2 ))</span>
<a name="ln-7338"></a>  <span class="c">!  ENDIF</span>
<a name="ln-7339"></a>
<a name="ln-7340"></a>  <span class="k">END SELECT</span>
<a name="ln-7341"></a>
<a name="ln-7342"></a> <span class="c">! update results in data structure.</span>
<a name="ln-7343"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">qHX</span>      <span class="o">=</span> <span class="n">qHX</span>
<a name="ln-7344"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">THXexh</span>   <span class="o">=</span> <span class="n">THXexh</span>
<a name="ln-7345"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="n">MdotWater</span>
<a name="ln-7346"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterVaporFractExh</span> <span class="o">=</span> <span class="n">waterFract</span>
<a name="ln-7347"></a>
<a name="ln-7348"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">CondensateRate</span>  <span class="o">=</span>  <span class="n">NdotWaterCond</span>
<a name="ln-7349"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterOutletTemp</span> <span class="o">=</span>  <span class="n">Twaterout</span>
<a name="ln-7350"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterOutletEnthalpy</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">inNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">+</span> <span class="n">qHX</span>
<a name="ln-7351"></a>
<a name="ln-7352"></a>  <span class="c">! now update water outlet node Changing to Kg/s!</span>
<a name="ln-7353"></a><span class="c">!  OutNodeNum = FuelCell(Num)%ExhaustHX%WaterOutNode</span>
<a name="ln-7354"></a><span class="c">!  inNodeNum  = FuelCell(Num)%ExhaustHX%WaterInNode</span>
<a name="ln-7355"></a><span class="c">!  Node(OutNodeNum)%Temp = Twaterout</span>
<a name="ln-7356"></a><span class="c">!  Node(OutNodeNum)%Enthalpy =</span>
<a name="ln-7357"></a><span class="c">!  Node(OutNodeNum)%MassFlowRate = MdotWater</span>
<a name="ln-7358"></a>
<a name="ln-7359"></a>
<a name="ln-7360"></a><span class="k">RETURN</span>
<a name="ln-7361"></a><span class="k">END SUBROUTINE </span><span class="n">CalcFuelCellGenHeatRecovery</span>
<a name="ln-7362"></a>
<a name="ln-7363"></a>
<a name="ln-7364"></a><span class="k">SUBROUTINE </span><span class="n">SimFuelCellPlantHeatRecovery</span><span class="p">(</span><span class="n">CompType</span><span class="p">,</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompTypeNum</span><span class="p">,</span><span class="n">CompNum</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">InitLoopEquip</span><span class="p">,</span>  <span class="p">&amp;</span> <span class="c">!DSU</span>
<a name="ln-7365"></a>                          <span class="n">MyLoad</span><span class="p">,</span><span class="n">MaxCap</span><span class="p">,</span><span class="n">MinCap</span><span class="p">,</span><span class="n">OptCap</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-7366"></a>
<a name="ln-7367"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7368"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-7369"></a>          <span class="c">!       DATE WRITTEN   Jan 2006</span>
<a name="ln-7370"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7371"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7372"></a>
<a name="ln-7373"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7374"></a>          <span class="c">! makes sure input are gotten and setup from Plant loop perspective.</span>
<a name="ln-7375"></a>          <span class="c">! does not (re)simulate entire FuelCell model</span>
<a name="ln-7376"></a>
<a name="ln-7377"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7378"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-7379"></a>
<a name="ln-7380"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7381"></a>          <span class="c">! na</span>
<a name="ln-7382"></a>
<a name="ln-7383"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7384"></a>          <span class="c">! na</span>
<a name="ln-7385"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-7386"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">TypeOf_Generator_FCExhaust</span><span class="p">,</span> <span class="n">TypeOf_Generator_FCStackCooler</span>
<a name="ln-7387"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">UpdateComponentHeatRecoverySide</span>
<a name="ln-7388"></a>
<a name="ln-7389"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7390"></a>
<a name="ln-7391"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7392"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompType</span>
<a name="ln-7393"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompName</span>
<a name="ln-7394"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CompTypeNum</span>
<a name="ln-7395"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">CompNum</span>
<a name="ln-7396"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">RunFlag</span>
<a name="ln-7397"></a> <span class="c">! INTEGER, INTENT(IN)          :: FlowLock !DSU</span>
<a name="ln-7398"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">InitLoopEquip</span>
<a name="ln-7399"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">MyLoad</span> <span class="c">!unused1208</span>
<a name="ln-7400"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">MinCap</span>
<a name="ln-7401"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">MaxCap</span>
<a name="ln-7402"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">OptCap</span>
<a name="ln-7403"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! TRUE if First iteration of simulation</span>
<a name="ln-7404"></a>
<a name="ln-7405"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7406"></a>          <span class="c">! na</span>
<a name="ln-7407"></a>
<a name="ln-7408"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7409"></a>          <span class="c">! na</span>
<a name="ln-7410"></a>
<a name="ln-7411"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7412"></a>          <span class="c">! na</span>
<a name="ln-7413"></a>
<a name="ln-7414"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7415"></a>          <span class="c">! na</span>
<a name="ln-7416"></a>
<a name="ln-7417"></a>
<a name="ln-7418"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetFuelCellInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7419"></a>
<a name="ln-7420"></a>    <span class="c">! Read input data.</span>
<a name="ln-7421"></a>    <span class="k">CALL  </span><span class="n">GetFuelCellGeneratorInput</span>
<a name="ln-7422"></a>    <span class="n">GetFuelCellInput</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7423"></a>  <span class="n">ENDIF</span>
<a name="ln-7424"></a>
<a name="ln-7425"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-7426"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CompTypeNum</span> <span class="o">==</span> <span class="n">TypeOf_Generator_FCExhaust</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7427"></a><span class="k">      </span><span class="n">CompNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">NameExhaustHX</span><span class="p">,</span><span class="n">NumFuelCellGenerators</span><span class="p">)</span>
<a name="ln-7428"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">CompTypeNum</span> <span class="o">==</span> <span class="n">TypeOf_Generator_FCStackCooler</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7429"></a><span class="k">      </span><span class="n">CompNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FuelCell</span><span class="p">%</span><span class="n">NameStackCooler</span><span class="p">,</span><span class="n">NumFuelCellGenerators</span><span class="p">)</span>
<a name="ln-7430"></a>    <span class="n">ENDIF</span>
<a name="ln-7431"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CompNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7432"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimFuelCellPlantHeatRecovery: Fuel Cell Generator Unit not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-7433"></a>    <span class="n">ENDIF</span>
<a name="ln-7434"></a>    <span class="n">MinCap</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7435"></a>    <span class="n">MaxCap</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7436"></a>    <span class="n">OptCap</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7437"></a>    <span class="k">RETURN</span>
<a name="ln-7438"></a><span class="k">  END IF</span>  <span class="c">! End Of InitLoopEquip</span>
<a name="ln-7439"></a>
<a name="ln-7440"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompTypeNum</span> <span class="o">==</span> <span class="n">TypeOf_Generator_FCStackCooler</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7441"></a><span class="k">    CALL </span><span class="n">UpdateComponentHeatRecoverySide</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">,</span>               <span class="p">&amp;</span>
<a name="ln-7442"></a>                                    <span class="n">FuelCell</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">CWLoopSideNum</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-7443"></a>                                    <span class="n">TypeOf_Generator_FCStackCooler</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-7444"></a>                                    <span class="n">FuelCell</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">WaterInNode</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-7445"></a>                                    <span class="n">FuelCell</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">StackCooler</span><span class="p">%</span><span class="n">WaterOutNode</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-7446"></a>                                    <span class="n">FuelCell</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">qHX</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-7447"></a>                                    <span class="n">FuelCell</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HeatRecInletTemp</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7448"></a>                                    <span class="n">FuelCell</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HeatRecOutletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7449"></a>                                    <span class="n">FuelCell</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HeatRecMdot</span> <span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7450"></a>                                    <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-7451"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">CompTypeNum</span> <span class="o">==</span> <span class="n">TypeOf_Generator_FCExhaust</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7452"></a><span class="k">    CALL </span><span class="n">UpdateComponentHeatRecoverySide</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">,</span>               <span class="p">&amp;</span>
<a name="ln-7453"></a>                                    <span class="n">FuelCell</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">CWLoopSideNum</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-7454"></a>                                    <span class="n">TypeOf_Generator_FCExhaust</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-7455"></a>                                    <span class="n">FuelCell</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInNode</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-7456"></a>                                    <span class="n">FuelCell</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterOutNode</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-7457"></a>                                    <span class="n">FuelCell</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">qHX</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-7458"></a>                                    <span class="n">FuelCell</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HeatRecInletTemp</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7459"></a>                                    <span class="n">FuelCell</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HeatRecOutletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7460"></a>                                    <span class="n">FuelCell</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HeatRecMdot</span> <span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7461"></a>                                    <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-7462"></a>
<a name="ln-7463"></a>  <span class="n">ENDIF</span>
<a name="ln-7464"></a>
<a name="ln-7465"></a>
<a name="ln-7466"></a>  <span class="k">RETURN</span>
<a name="ln-7467"></a>
<a name="ln-7468"></a><span class="k">END SUBROUTINE </span><span class="n">SimFuelCellPlantHeatRecovery</span>
<a name="ln-7469"></a>
<a name="ln-7470"></a>
<a name="ln-7471"></a><span class="c">! End FuelCell Generator Module Model Subroutines</span>
<a name="ln-7472"></a><span class="c">! *****************************************************************************</span>
<a name="ln-7473"></a>
<a name="ln-7474"></a><span class="c">! Begin FuelCell Generator Module Utility Subroutines</span>
<a name="ln-7475"></a><span class="c">! *****************************************************************************</span>
<a name="ln-7476"></a><span class="k">SUBROUTINE </span><span class="n">InitFuelCellGenerators</span><span class="p">(</span><span class="n">FCnum</span> <span class="p">)</span>
<a name="ln-7477"></a>
<a name="ln-7478"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7479"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-7480"></a>          <span class="c">!       DATE WRITTEN   Aug 2005</span>
<a name="ln-7481"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7482"></a>          <span class="c">!       RE-ENGINEERED  B. Griffith Sept 2010, plant upgrades</span>
<a name="ln-7483"></a>
<a name="ln-7484"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7485"></a>          <span class="c">! This subroutine is for initializations of the FuelCell generators.</span>
<a name="ln-7486"></a>
<a name="ln-7487"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7488"></a>          <span class="c">! Uses the status flags to trigger initializations.</span>
<a name="ln-7489"></a>
<a name="ln-7490"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7491"></a>          <span class="c">! na</span>
<a name="ln-7492"></a>
<a name="ln-7493"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7494"></a>
<a name="ln-7495"></a>  <span class="k">USE </span><span class="n">DataLoopNode</span> <span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">Node</span>
<a name="ln-7496"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysTimeElapsed</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-7497"></a>  <span class="k">USE </span><span class="n">DataGlobals</span>    <span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStep</span><span class="p">,</span> <span class="n">TimeStepZone</span><span class="p">,</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="n">BeginEnvrnFlag</span><span class="p">,</span> <span class="n">HourOfDay</span>
<a name="ln-7498"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">InitComponentNodes</span><span class="p">,</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-7499"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">ScanPlantLoopsForObject</span><span class="p">,</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">TypeOf_Generator_FCExhaust</span>
<a name="ln-7500"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span>
<a name="ln-7501"></a>
<a name="ln-7502"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7503"></a>
<a name="ln-7504"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7505"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FCnum</span> <span class="c">! index to specific fuel cell generator</span>
<a name="ln-7506"></a>
<a name="ln-7507"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7508"></a>          <span class="c">! na</span>
<a name="ln-7509"></a>
<a name="ln-7510"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-7511"></a>          <span class="c">! na</span>
<a name="ln-7512"></a>
<a name="ln-7513"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7514"></a>          <span class="c">! na</span>
<a name="ln-7515"></a>
<a name="ln-7516"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7517"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">InitGeneratorOnce</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! flag for 1 time initialization</span>
<a name="ln-7518"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span> <span class="c">! flag for init once at start of environment</span>
<a name="ln-7519"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyWarmupFlag</span> <span class="c">! flag for init after warmup complete</span>
<a name="ln-7520"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">inNode</span>  <span class="c">! inlet index in Node array</span>
<a name="ln-7521"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">outNode</span> <span class="c">! outlet, index in Node array</span>
<a name="ln-7522"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TimeElapsed</span>         <span class="c">! Fraction of the current hour that has elapsed (h)</span>
<a name="ln-7523"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyPlantScanFlag</span>
<a name="ln-7524"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">mdot</span> <span class="c">! local temporary mass flow rate</span>
<a name="ln-7525"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">rho</span>  <span class="c">! local temporary fluid density</span>
<a name="ln-7526"></a>  <span class="kt">LOGICAL</span>     <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-7527"></a>
<a name="ln-7528"></a>          <span class="c">! FLOW:</span>
<a name="ln-7529"></a><span class="c">! Do the one time initializations</span>
<a name="ln-7530"></a><span class="k">IF</span> <span class="p">(</span><span class="n">InitGeneratorOnce</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7531"></a><span class="k">  ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumFuelCellGenerators</span><span class="p">))</span>
<a name="ln-7532"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyWarmupFlag</span><span class="p">(</span><span class="n">NumFuelCellGenerators</span><span class="p">))</span>
<a name="ln-7533"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">NumFuelCellGenerators</span><span class="p">))</span>
<a name="ln-7534"></a>  <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7535"></a>  <span class="n">MyWarmupFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7536"></a>  <span class="n">InitGeneratorOnce</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7537"></a>  <span class="n">MyPlantScanFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7538"></a><span class="k">END IF</span> <span class="c">! end one time setups and inits</span>
<a name="ln-7539"></a>
<a name="ln-7540"></a><span class="k">IF</span> <span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7541"></a><span class="k">  </span><span class="n">errFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7542"></a>  <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">NameExhaustHX</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7543"></a>                                 <span class="n">TypeOf_Generator_FCExhaust</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7544"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7545"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7546"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7547"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWCompNum</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7548"></a>                                 <span class="n">errFlag</span> <span class="o">=</span> <span class="n">errFlag</span><span class="p">)</span>
<a name="ln-7549"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7550"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitFuelCellGenerators: Program terminated due to previous condition(s).&#39;</span><span class="p">)</span>
<a name="ln-7551"></a>  <span class="n">ENDIF</span>
<a name="ln-7552"></a>  <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7553"></a><span class="n">ENDIF</span>
<a name="ln-7554"></a>
<a name="ln-7555"></a><span class="c">! Do the Begin Environment initializations</span>
<a name="ln-7556"></a><span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">FCnum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7557"></a>
<a name="ln-7558"></a><span class="k">  </span><span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">PfuelCompEl</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7559"></a>  <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">TfuelIntoFCPM</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7560"></a>  <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">TfuelIntoCompress</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7561"></a>  <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">QskinLoss</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7562"></a>
<a name="ln-7563"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">TairIntoFCPM</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7564"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">PairCompEl</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7565"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">TairIntoBlower</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7566"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">QskinLoss</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7567"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">QintakeRecovery</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7568"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NumCycles</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7569"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Pel</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7570"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelLastTimeStep</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7571"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Eel</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7572"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelancillariesAC</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7573"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7574"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TotFuelInEnthalphy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7575"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotProdGas</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7576"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TprodGasLeavingFCPM</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7577"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TotProdGasEnthalphy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7578"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotAir</span>       <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7579"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TotAirInEnthalphy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7580"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotLiqwater</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7581"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TwaterInlet</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7582"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">WaterInEnthalpy</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7583"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TprodGasLeavingFCPM</span> <span class="o">=</span> <span class="mi">20</span><span class="mf">0.0d0</span>
<a name="ln-7584"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">FractionalDayofLastStartUp</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7585"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">FractionalDayofLastShutDown</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7586"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">HasBeenOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7587"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DuringShutDown</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7588"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">DuringStartUp</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7589"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">TwaterIntoCompress</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7590"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">TwaterIntoFCPM</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7591"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">PwaterCompEl</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7592"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">QskinLoss</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7593"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">TauxMix</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7594"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">NdotAuxMix</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7595"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">QskinLoss</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7596"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">QairIntake</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7597"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">NdotHXleaving</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7598"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterOutletTemp</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7599"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterOutletEnthalpy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7600"></a>
<a name="ln-7601"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">StartingEnergyStored</span>
<a name="ln-7602"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">ThisTimeStepStateOfCharge</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">StartingEnergyStored</span>
<a name="ln-7603"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">PelNeedFromStorage</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7604"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">IdesiredDischargeCurrent</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7605"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">PelFromStorage</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7606"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">IfromStorage</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7607"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">PelIntoStorage</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7608"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">QairIntake</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7609"></a>
<a name="ln-7610"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">PCUlosses</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7611"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">QairIntake</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7612"></a>
<a name="ln-7613"></a>  <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7614"></a>                         <span class="n">InitHRTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7615"></a>                         <span class="n">PlantLoop</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7616"></a>                         <span class="s1">&#39;InitFuelCellGenerators&#39;</span><span class="p">)</span>
<a name="ln-7617"></a>
<a name="ln-7618"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterMassFlowRateDesign</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterVolumeFlowMax</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-7619"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterMassFlowRate</span>       <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterMassFlowRateDesign</span>
<a name="ln-7620"></a>  <span class="n">inNode</span>  <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInNode</span>
<a name="ln-7621"></a>  <span class="n">outNode</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterOutNode</span>
<a name="ln-7622"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">inNode</span><span class="p">)%</span><span class="n">Temp</span>  <span class="o">=</span> <span class="n">InitHRTemp</span>
<a name="ln-7623"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">outNode</span><span class="p">)%</span><span class="n">Temp</span>  <span class="o">=</span> <span class="n">InitHRTemp</span>
<a name="ln-7624"></a>
<a name="ln-7625"></a>  <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span> <span class="mf">0.d0</span><span class="p">,</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterMassFlowRateDesign</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7626"></a>                                 <span class="n">inNode</span><span class="p">,</span> <span class="n">outNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7627"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7628"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7629"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7630"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWCompNum</span> <span class="p">)</span>
<a name="ln-7631"></a>
<a name="ln-7632"></a>  <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7633"></a>  <span class="n">MyWarmupFlag</span><span class="p">(</span><span class="n">FCNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7634"></a><span class="k">END IF</span> <span class="c">! end environmental inits</span>
<a name="ln-7635"></a>
<a name="ln-7636"></a><span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7637"></a><span class="k">  </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7638"></a><span class="n">ENDIF</span>
<a name="ln-7639"></a>
<a name="ln-7640"></a><span class="k">IF</span> <span class="p">(</span><span class="n">MyWarmupFlag</span><span class="p">(</span><span class="n">FCNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7641"></a>  <span class="c">! need to reset initial state of charge at beginning of environment but after warm up is complete</span>
<a name="ln-7642"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCNum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCNum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">StartingEnergyStored</span>
<a name="ln-7643"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCNum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">ThisTimeStepStateOfCharge</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCNum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">StartingEnergyStored</span>
<a name="ln-7644"></a>  <span class="n">MyWarmupFlag</span><span class="p">(</span><span class="n">FCNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7645"></a><span class="n">ENDIF</span>
<a name="ln-7646"></a>
<a name="ln-7647"></a><span class="c">!using and elapsed time method rather than FirstHVACIteration here</span>
<a name="ln-7648"></a><span class="n">TimeElapsed</span> <span class="o">=</span> <span class="n">HourOfDay</span> <span class="o">+</span> <span class="n">TimeStep</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-7649"></a><span class="k">If</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">TimeElapsed</span> <span class="o">/=</span> <span class="n">TimeElapsed</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-7650"></a>
<a name="ln-7651"></a><span class="k">  </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">ThisTimeStepStateOfCharge</span>
<a name="ln-7652"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelLastTimeStep</span>                  <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Pel</span>
<a name="ln-7653"></a>
<a name="ln-7654"></a>
<a name="ln-7655"></a>  <span class="n">inNode</span>  <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInNode</span>
<a name="ln-7656"></a>  <span class="n">outNode</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterOutNode</span>
<a name="ln-7657"></a> <span class="c">! intialize flow rate in water loop, this is &quot;requesting&quot; flow</span>
<a name="ln-7658"></a>  <span class="n">mdot</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterMassFlowRateDesign</span>
<a name="ln-7659"></a>
<a name="ln-7660"></a>  <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span> <span class="n">mdot</span><span class="p">,</span> <span class="n">inNode</span><span class="p">,</span>  <span class="n">outNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7661"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7662"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7663"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7664"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWCompNum</span> <span class="p">)</span>
<a name="ln-7665"></a>
<a name="ln-7666"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="n">mdot</span>
<a name="ln-7667"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInletTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">inNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-7668"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">TimeElapsed</span> <span class="o">=</span> <span class="n">TimeElapsed</span>
<a name="ln-7669"></a><span class="k">ELSE</span>
<a name="ln-7670"></a><span class="k">  </span><span class="n">inNode</span>  <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInNode</span>
<a name="ln-7671"></a>
<a name="ln-7672"></a>  <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterMassFlowRate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7673"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7674"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterOutNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7675"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7676"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7677"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7678"></a>                                 <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">CWCompNum</span> <span class="p">)</span>
<a name="ln-7679"></a>
<a name="ln-7680"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInletTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">inNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-7681"></a><span class="n">ENDIF</span>
<a name="ln-7682"></a>
<a name="ln-7683"></a><span class="k">RETURN</span>
<a name="ln-7684"></a><span class="k">END SUBROUTINE </span><span class="n">InitFuelCellGenerators</span>
<a name="ln-7685"></a><span class="c">! End FuelCell Generator Module Utility Subroutines</span>
<a name="ln-7686"></a><span class="c">! *****************************************************************************</span>
<a name="ln-7687"></a>
<a name="ln-7688"></a>
<a name="ln-7689"></a><span class="c">! Beginning of Record Keeping subroutines for the FuelCell Generator Module</span>
<a name="ln-7690"></a><span class="c">! *****************************************************************************</span>
<a name="ln-7691"></a><span class="k">SUBROUTINE </span><span class="n">FigureFuelCellZoneGains</span>
<a name="ln-7692"></a>
<a name="ln-7693"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7694"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-7695"></a>          <span class="c">!       DATE WRITTEN   Aug 2005</span>
<a name="ln-7696"></a>          <span class="c">!       MODIFIED       BG March 2007</span>
<a name="ln-7697"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7698"></a>
<a name="ln-7699"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7700"></a>          <span class="c">! Couple equpment skin losses to the Zone Heat Balance</span>
<a name="ln-7701"></a>          <span class="c">! calculate skin losses from different subsystems and set the value</span>
<a name="ln-7702"></a>
<a name="ln-7703"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7704"></a>          <span class="c">! This routine adds up the various skin losses and then</span>
<a name="ln-7705"></a>          <span class="c">!  sets the values in the ZoneIntGain structure</span>
<a name="ln-7706"></a>
<a name="ln-7707"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7708"></a>          <span class="c">! na</span>
<a name="ln-7709"></a>
<a name="ln-7710"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7711"></a>          <span class="c">! na</span>
<a name="ln-7712"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span> <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneIntGain</span>
<a name="ln-7713"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7714"></a>
<a name="ln-7715"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7716"></a>
<a name="ln-7717"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7718"></a>          <span class="c">! na</span>
<a name="ln-7719"></a>
<a name="ln-7720"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7721"></a>          <span class="c">! na</span>
<a name="ln-7722"></a>
<a name="ln-7723"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7724"></a>          <span class="c">! na</span>
<a name="ln-7725"></a>
<a name="ln-7726"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7727"></a><span class="c">!unused  INTEGER :: thisZone ! index in Zone structure array</span>
<a name="ln-7728"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotalZoneHeatGain</span> <span class="c">! working variable for zone gain [w]</span>
<a name="ln-7729"></a><span class="c">!  INTEGER :: ZoneNum</span>
<a name="ln-7730"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FCnum</span> <span class="c">! number of fuel cell</span>
<a name="ln-7731"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7732"></a>
<a name="ln-7733"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumFuelCellGenerators</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-7734"></a>
<a name="ln-7735"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7736"></a><span class="k">    </span><span class="n">FuelCell</span><span class="p">%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">HasBeenOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7737"></a>    <span class="n">FuelCell</span><span class="p">%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">PairCompEl</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7738"></a>    <span class="n">FuelCell</span><span class="p">%</span><span class="n">QconvZone</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7739"></a>    <span class="n">FuelCell</span><span class="p">%</span><span class="n">QradZone</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7740"></a>    <span class="n">FuelCell</span><span class="p">%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">QskinLoss</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7741"></a>    <span class="n">FuelSupply</span><span class="p">%</span><span class="n">QskinLoss</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7742"></a>    <span class="n">FuelCell</span><span class="p">%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">QskinLoss</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7743"></a>    <span class="n">FuelCell</span><span class="p">%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">QskinLoss</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7744"></a>    <span class="n">FuelCell</span><span class="p">%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">QdotSkin</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7745"></a>    <span class="n">FuelCell</span><span class="p">%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossConvect</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7746"></a>    <span class="n">FuelCell</span><span class="p">%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossRadiat</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7747"></a>    <span class="n">FuelCell</span><span class="p">%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">QairIntake</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7748"></a>    <span class="n">FuelCell</span><span class="p">%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">QairIntake</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7749"></a>    <span class="n">FuelCell</span><span class="p">%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">QairIntake</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7750"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7751"></a>  <span class="k">END IF</span>
<a name="ln-7752"></a>
<a name="ln-7753"></a><span class="k">  IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7754"></a>
<a name="ln-7755"></a>  <span class="c">! this routine needs to do something for zone gains during sizing</span>
<a name="ln-7756"></a>
<a name="ln-7757"></a>   <span class="c">!first collect skin losses from different subsystems</span>
<a name="ln-7758"></a>  <span class="k">Do </span><span class="n">FCnum</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumFuelCellGenerators</span>
<a name="ln-7759"></a>    <span class="n">TotalZoneHeatGain</span> <span class="o">=</span>   <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">QskinLoss</span>      <span class="p">&amp;</span> <span class="c">! intake Blower losses to zone</span>
<a name="ln-7760"></a>                       <span class="o">+</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">QskinLoss</span>     <span class="p">&amp;</span> <span class="c">! fuel compressor losses to zone</span>
<a name="ln-7761"></a>                       <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">QskinLoss</span>    <span class="p">&amp;</span> <span class="c">! water pump losses to zone</span>
<a name="ln-7762"></a>                       <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">QskinLoss</span>   <span class="p">&amp;</span> <span class="c">! auxil burner losses to zone</span>
<a name="ln-7763"></a>                       <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">QdotSkin</span>           <span class="c">! power module (stack and reformer) losses to zone</span>
<a name="ln-7764"></a>
<a name="ln-7765"></a>    <span class="c">! now account for other subsystems that may or may not have air intake recovery</span>
<a name="ln-7766"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">IntakeRecoveryMode</span><span class="p">)</span>
<a name="ln-7767"></a>
<a name="ln-7768"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">NoRecoveryOnAirIntake</span><span class="p">)</span> <span class="c">! then the heat has to go into zone</span>
<a name="ln-7769"></a>      <span class="n">TotalZoneHeatGain</span> <span class="o">=</span> <span class="n">TotalZoneHeatGain</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">QairIntake</span>    <span class="p">&amp;</span>
<a name="ln-7770"></a>                                          <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">QairIntake</span>  <span class="p">&amp;</span>
<a name="ln-7771"></a>                                          <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">QairIntake</span>
<a name="ln-7772"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">RecoverAuxiliaryBurner</span><span class="p">)</span>
<a name="ln-7773"></a>      <span class="n">TotalZoneHeatGain</span> <span class="o">=</span> <span class="n">TotalZoneHeatGain</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">QairIntake</span>  <span class="p">&amp;</span>
<a name="ln-7774"></a>                                          <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">QairIntake</span>
<a name="ln-7775"></a>
<a name="ln-7776"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">RecoverInverterBatt</span><span class="p">)</span>
<a name="ln-7777"></a>      <span class="n">TotalZoneHeatGain</span> <span class="o">=</span> <span class="n">TotalZoneHeatGain</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">QairIntake</span>
<a name="ln-7778"></a>
<a name="ln-7779"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">RecoverInverter</span><span class="p">)</span>
<a name="ln-7780"></a>      <span class="n">TotalZoneHeatGain</span> <span class="o">=</span> <span class="n">TotalZoneHeatGain</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">QairIntake</span>    <span class="p">&amp;</span>
<a name="ln-7781"></a>                                          <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">QairIntake</span>
<a name="ln-7782"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">RecoverBattery</span><span class="p">)</span>
<a name="ln-7783"></a>      <span class="n">TotalZoneHeatGain</span> <span class="o">=</span> <span class="n">TotalZoneHeatGain</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">AuxilHeat</span><span class="p">%</span><span class="n">QairIntake</span>    <span class="p">&amp;</span>
<a name="ln-7784"></a>                                          <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">QairIntake</span>
<a name="ln-7785"></a>
<a name="ln-7786"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">RecoverBurnInvertBatt</span><span class="p">)</span>
<a name="ln-7787"></a>      <span class="c">! do nothing</span>
<a name="ln-7788"></a>
<a name="ln-7789"></a>    <span class="k">END SELECT</span>
<a name="ln-7790"></a>
<a name="ln-7791"></a><span class="k">    </span><span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">QconvZone</span> <span class="o">=</span> <span class="n">TotalZoneHeatGain</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">RadiativeFract</span><span class="p">)</span>
<a name="ln-7792"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossConvect</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">QconvZone</span>
<a name="ln-7793"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">QradZone</span>  <span class="o">=</span> <span class="n">TotalZoneHeatGain</span> <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">RadiativeFract</span>
<a name="ln-7794"></a>    <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossRadiat</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">FCnum</span><span class="p">)%</span><span class="n">QradZone</span>
<a name="ln-7795"></a>
<a name="ln-7796"></a>  <span class="n">ENDDO</span> <span class="c">! over number of Fuel cells</span>
<a name="ln-7797"></a>
<a name="ln-7798"></a>
<a name="ln-7799"></a>
<a name="ln-7800"></a><span class="c">!  IF(DoingSizing)THEN</span>
<a name="ln-7801"></a>
<a name="ln-7802"></a><span class="c">!  ENDIF</span>
<a name="ln-7803"></a>
<a name="ln-7804"></a>  <span class="k">RETURN</span>
<a name="ln-7805"></a>
<a name="ln-7806"></a><span class="k">END SUBROUTINE </span><span class="n">FigureFuelCellZoneGains</span>
<a name="ln-7807"></a>
<a name="ln-7808"></a><span class="k">SUBROUTINE </span><span class="n">UpdateExhaustAirFlows</span><span class="p">(</span><span class="n">Num</span><span class="p">)</span>
<a name="ln-7809"></a>
<a name="ln-7810"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7811"></a>          <span class="c">!       AUTHOR         &lt;author&gt;</span>
<a name="ln-7812"></a>          <span class="c">!       DATE WRITTEN   &lt;date_written&gt;</span>
<a name="ln-7813"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7814"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7815"></a>
<a name="ln-7816"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7817"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-7818"></a>
<a name="ln-7819"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7820"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-7821"></a>
<a name="ln-7822"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7823"></a>          <span class="c">! na</span>
<a name="ln-7824"></a>
<a name="ln-7825"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7826"></a>          <span class="c">! na</span>
<a name="ln-7827"></a>
<a name="ln-7828"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7829"></a>
<a name="ln-7830"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7831"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Num</span> <span class="c">! generator number</span>
<a name="ln-7832"></a>
<a name="ln-7833"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7834"></a>          <span class="c">! na</span>
<a name="ln-7835"></a>
<a name="ln-7836"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7837"></a>          <span class="c">! na</span>
<a name="ln-7838"></a>
<a name="ln-7839"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7840"></a>          <span class="c">! na</span>
<a name="ln-7841"></a>
<a name="ln-7842"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7843"></a>          <span class="c">! na</span>
<a name="ln-7844"></a>
<a name="ln-7845"></a>
<a name="ln-7846"></a>
<a name="ln-7847"></a>  <span class="k">RETURN</span>
<a name="ln-7848"></a>
<a name="ln-7849"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateExhaustAirFlows</span>
<a name="ln-7850"></a>
<a name="ln-7851"></a><span class="k">SUBROUTINE </span><span class="n">CalcUpdateHeatRecovery</span><span class="p">(</span><span class="n">Num</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-7852"></a>
<a name="ln-7853"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7854"></a>          <span class="c">!       AUTHOR         B Griffith</span>
<a name="ln-7855"></a>          <span class="c">!       DATE WRITTEN   March 2008</span>
<a name="ln-7856"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7857"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7858"></a>
<a name="ln-7859"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7860"></a>          <span class="c">! update plant loop interactions, do any calcs needed</span>
<a name="ln-7861"></a>
<a name="ln-7862"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7863"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-7864"></a>
<a name="ln-7865"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7866"></a>          <span class="c">! na</span>
<a name="ln-7867"></a>
<a name="ln-7868"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7869"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SafeCopyPlantNode</span>
<a name="ln-7870"></a>
<a name="ln-7871"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7872"></a>
<a name="ln-7873"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7874"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">Num</span>       <span class="c">! Generator number</span>
<a name="ln-7875"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-7876"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7877"></a>          <span class="c">! na</span>
<a name="ln-7878"></a>
<a name="ln-7879"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7880"></a>          <span class="c">! na</span>
<a name="ln-7881"></a>
<a name="ln-7882"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7883"></a>          <span class="c">! na</span>
<a name="ln-7884"></a>
<a name="ln-7885"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7886"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">InNodeNum</span>
<a name="ln-7887"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">outnodenum</span>
<a name="ln-7888"></a>
<a name="ln-7889"></a>  <span class="c">! now update water outlet node Changing to Kg/s!</span>
<a name="ln-7890"></a>  <span class="n">OutNodeNum</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterOutNode</span>
<a name="ln-7891"></a>  <span class="n">inNodeNum</span>  <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterInNode</span>
<a name="ln-7892"></a>
<a name="ln-7893"></a>  <span class="k">CALL </span><span class="n">SafeCopyPlantNode</span><span class="p">(</span><span class="n">InNodeNum</span><span class="p">,</span> <span class="n">OutNodeNum</span><span class="p">)</span>
<a name="ln-7894"></a>
<a name="ln-7895"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">OutNodeNum</span><span class="p">)%</span><span class="n">Temp</span>     <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterOutletTemp</span>
<a name="ln-7896"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">OutNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterOutletEnthalpy</span>
<a name="ln-7897"></a>
<a name="ln-7898"></a><span class="c">!  IF (FirstHVACIteration) Then</span>
<a name="ln-7899"></a><span class="c">!    Node(InNodeNum)%MassFlowRateMaxAvail     = FuelCell(Num)%ExhaustHX%WaterMassFlowRateDesign</span>
<a name="ln-7900"></a><span class="c">!    Node(InNodeNum)%MassFlowRateMinAvail     = 0.0D0</span>
<a name="ln-7901"></a><span class="c">!    Node(InNodeNum)%MassFlowRate             = Max(FuelCell(Num)%ExhaustHX%WaterMassFlowRateDesign,   &amp;</span>
<a name="ln-7902"></a><span class="c">!                                                   Node(InNodeNum)%MassFlowRateMin)</span>
<a name="ln-7903"></a><span class="c">!    Node(InNodeNum)%MassFlowRate             = Min(FuelCell(Num)%ExhaustHX%WaterMassFlowRateDesign,   &amp;</span>
<a name="ln-7904"></a><span class="c">!                                                   Node(InNodeNum)%MassFlowRateMax)</span>
<a name="ln-7905"></a><span class="c">!</span>
<a name="ln-7906"></a><span class="c">!  ELSE</span>
<a name="ln-7907"></a><span class="c">!    Node(InNodeNum)%MassFlowRate             = Max(FuelCell(Num)%ExhaustHX%WaterMassFlowRateDesign,   &amp;</span>
<a name="ln-7908"></a><span class="c">!                                                   Node(InNodeNum)%MassFlowRateMin)</span>
<a name="ln-7909"></a><span class="c">!    Node(InNodeNum)%MassFlowRate             = Max(FuelCell(Num)%ExhaustHX%WaterMassFlowRateDesign,   &amp;</span>
<a name="ln-7910"></a><span class="c">!                                                   Node(InNodeNum)%MassFlowRateMinAvail)</span>
<a name="ln-7911"></a><span class="c">!    Node(InNodeNum)%MassFlowRate             = Min(FuelCell(Num)%ExhaustHX%WaterMassFlowRateDesign,   &amp;</span>
<a name="ln-7912"></a><span class="c">!                                                   Node(InNodeNum)%MassFlowRateMax)</span>
<a name="ln-7913"></a><span class="c">!    Node(InNodeNum)%MassFlowRate             = Min(FuelCell(Num)%ExhaustHX%WaterMassFlowRateDesign,   &amp;</span>
<a name="ln-7914"></a><span class="c">!                                                   Node(InNodeNum)%MassFlowRateMaxAvail)</span>
<a name="ln-7915"></a><span class="c">!  ENDIF</span>
<a name="ln-7916"></a><span class="c">!</span>
<a name="ln-7917"></a><span class="c">!  Node(OutNodeNum)%MassFlowRate             = Node(InNodeNum)%MassFlowRate</span>
<a name="ln-7918"></a><span class="c">!  Node(OutNodeNum)%MassFlowRateMaxAvail     = Node(InNodeNum)%MassFlowRateMaxAvail</span>
<a name="ln-7919"></a><span class="c">!  Node(OutNodeNum)%MassFlowRateMinAvail     = Node(InNodeNum)%MassFlowRateMinAvail</span>
<a name="ln-7920"></a><span class="c">!  Node(OutNodeNum)%MassFlowRateMax          = Node(InNodeNum)%MassFlowRateMax</span>
<a name="ln-7921"></a><span class="c">!  Node(OutNodeNum)%MassFlowRateMin          = Node(InNodeNum)%MassFlowRateMin</span>
<a name="ln-7922"></a>
<a name="ln-7923"></a>  <span class="k">RETURN</span>
<a name="ln-7924"></a>
<a name="ln-7925"></a><span class="k">END SUBROUTINE </span><span class="n">CalcUpdateHeatRecovery</span>
<a name="ln-7926"></a>
<a name="ln-7927"></a><span class="k">SUBROUTINE </span><span class="n">UpdateFuelCellGeneratorRecords</span><span class="p">(</span><span class="n">RunFlag</span><span class="p">,</span> <span class="n">Num</span><span class="p">)</span>
<a name="ln-7928"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7929"></a>            <span class="c">!       AUTHOR:          BG</span>
<a name="ln-7930"></a>            <span class="c">!       DATE WRITTEN:</span>
<a name="ln-7931"></a>
<a name="ln-7932"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7933"></a>            <span class="c">! reporting</span>
<a name="ln-7934"></a>
<a name="ln-7935"></a>
<a name="ln-7936"></a>            <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-7937"></a>
<a name="ln-7938"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-7939"></a>
<a name="ln-7940"></a>            <span class="c">! USE STATEMENTS: na</span>
<a name="ln-7941"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-7942"></a>
<a name="ln-7943"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-7944"></a>
<a name="ln-7945"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7946"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RunFlag</span>   <span class="c">! TRUE if Generator operating</span>
<a name="ln-7947"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">Num</span>       <span class="c">! Generator number</span>
<a name="ln-7948"></a>
<a name="ln-7949"></a>
<a name="ln-7950"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7951"></a>          <span class="c">! na</span>
<a name="ln-7952"></a>
<a name="ln-7953"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7954"></a>          <span class="c">! na</span>
<a name="ln-7955"></a>
<a name="ln-7956"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7957"></a>
<a name="ln-7958"></a>
<a name="ln-7959"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ACPowerGen</span>          <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ACPowerGen</span> <span class="c">!electrical power produced [W]</span>
<a name="ln-7960"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ACEnergyGen</span>         <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ACPowerGen</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span> <span class="c">! energy produced (J)</span>
<a name="ln-7961"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">QdotExhaust</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: exhaust gas heat recovered (W)</span>
<a name="ln-7962"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TotalHeatEnergyRec</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: total heat recovered (J)</span>
<a name="ln-7963"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ExhaustEnergyRec</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: exhaust gas heat recovered (J)</span>
<a name="ln-7964"></a>
<a name="ln-7965"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HeatRecInletTemp</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Heat Recovery Loop Inlet Temperature (C)</span>
<a name="ln-7966"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HeatRecOutletTemp</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Heat Recovery Loop Outlet Temperature (C)</span>
<a name="ln-7967"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HeatRecMdot</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Heat Recovery Loop Mass flow rate (kg/s)</span>
<a name="ln-7968"></a>
<a name="ln-7969"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ElectEfficiency</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7970"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ThermalEfficiency</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7971"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">OverallEfficiency</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7972"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ExergyEfficiency</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7973"></a>
<a name="ln-7974"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TairInlet</span>         <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">TairIntoBlower</span> <span class="c">! State point 1</span>
<a name="ln-7975"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TairIntoFCPM</span>      <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">TairIntoFCPM</span>   <span class="c">! State point 4</span>
<a name="ln-7976"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotAir</span>           <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotAir</span>        <span class="c">! air flow in kmol/sec</span>
<a name="ln-7977"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TotAirInEnthalphy</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TotAirInEnthalphy</span> <span class="c">! State point 4</span>
<a name="ln-7978"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">BlowerPower</span>       <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">PairCompEl</span> <span class="c">! electrical power used by air supply blower</span>
<a name="ln-7979"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">BlowerEnergy</span>      <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">PairCompEl</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span> <span class="c">! electrical energy</span>
<a name="ln-7980"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">BlowerSkinLoss</span>    <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AirSup</span><span class="p">%</span><span class="n">QskinLoss</span> <span class="c">! heat rate of losses by blower</span>
<a name="ln-7981"></a>
<a name="ln-7982"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TfuelInlet</span>        <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">TfuelIntoCompress</span>    <span class="c">! State point 2</span>
<a name="ln-7983"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TfuelIntoFCPM</span>     <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">TfuelIntoFCPM</span> <span class="c">! TEmperature state point 5 [C]</span>
<a name="ln-7984"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotFuel</span>          <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span>       <span class="c">! fuel flow in kmol/sec</span>
<a name="ln-7985"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TotFuelInEnthalpy</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TotFuelInEnthalphy</span> <span class="c">! enthalpy at state point 5 [W]</span>
<a name="ln-7986"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelCompressPower</span> <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">PfuelCompEl</span>
<a name="ln-7987"></a>                                                       <span class="c">! electrical power used by fuel supply compressor [W]</span>
<a name="ln-7988"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelCompressEnergy</span> <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">PfuelCompEl</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span> <span class="c">! elect energy</span>
<a name="ln-7989"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelCompressSkinLoss</span> <span class="o">=</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">QskinLoss</span>
<a name="ln-7990"></a>                                                              <span class="c">!heat rate of losses.by fuel supply compressor [W]</span>
<a name="ln-7991"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelEnergyLHV</span>        <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span> <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">LHV</span> <span class="p">&amp;</span>
<a name="ln-7992"></a>                                          <span class="o">*</span> <span class="mi">100000</span><span class="mf">0.0d0</span> <span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span> <span class="c">! reporting: Fuel Energy used (J)</span>
<a name="ln-7993"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelEnergyUseRateLHV</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span> <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">LHV</span> <span class="p">&amp;</span>
<a name="ln-7994"></a>                                          <span class="o">*</span> <span class="mi">100000</span><span class="mf">0.0d0</span> <span class="c">! reporting: Fuel Energy used (W)</span>
<a name="ln-7995"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelEnergyHHV</span>        <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span> <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">HHV</span> <span class="p">&amp;</span>
<a name="ln-7996"></a>                                          <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">KmolPerSecToKgPerSec</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-7997"></a>
<a name="ln-7998"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelEnergyUseRateHHV</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotFuel</span> <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">HHV</span> <span class="p">&amp;</span>
<a name="ln-7999"></a>                                          <span class="o">*</span> <span class="n">FuelSupply</span><span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelSupNum</span><span class="p">)%</span><span class="n">KmolPerSecToKgPerSec</span>
<a name="ln-8000"></a>
<a name="ln-8001"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">FuelRateMdot</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! (Kg/s)</span>
<a name="ln-8002"></a>
<a name="ln-8003"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TwaterInlet</span>    <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">TwaterIntoCompress</span>
<a name="ln-8004"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TwaterIntoFCPM</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">TwaterIntoFCPM</span>
<a name="ln-8005"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotWater</span>      <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotLiqwater</span>  <span class="c">! water flow in kmol/sec (reformer water)</span>
<a name="ln-8006"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">WaterPumpPower</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">PwaterCompEl</span>
<a name="ln-8007"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">WaterPumpEnergy</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">WaterSup</span><span class="p">%</span><span class="n">PwaterCompEl</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span> <span class="c">! electrical energy</span>
<a name="ln-8008"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">WaterIntoFCPMEnthalpy</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">WaterInEnthalpy</span>
<a name="ln-8009"></a>
<a name="ln-8010"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">TprodGas</span>       <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TprodGasLeavingFCPM</span> <span class="c">! temperature at State point 7</span>
<a name="ln-8011"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">EnthalProdGas</span>  <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">TotProdGasEnthalphy</span> <span class="c">! enthalpy at State point 7</span>
<a name="ln-8012"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotProdGas</span>    <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotProdGas</span>         <span class="c">! flow rate at point 7 [kmol/sec]</span>
<a name="ln-8013"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotProdAr</span>     <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotProdGas</span>
<a name="ln-8014"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotProdCO2</span>    <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotProdGas</span>
<a name="ln-8015"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotProdH2O</span>    <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotProdGas</span>
<a name="ln-8016"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotProdN2</span>     <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotProdGas</span>
<a name="ln-8017"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">NdotProdO2</span>     <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">ConstitMolalFract</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="o">*</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">NdotProdGas</span>
<a name="ln-8018"></a>
<a name="ln-8019"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">qHX</span>            <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">qHX</span>
<a name="ln-8020"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HXenergy</span>       <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">qHX</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-8021"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">THXexh</span>         <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">THXexh</span>
<a name="ln-8022"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">WaterVaporFractExh</span> <span class="o">=</span>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">WaterVaporFractExh</span>
<a name="ln-8023"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">CondensateRate</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustHX</span><span class="p">%</span><span class="n">CondensateRate</span>
<a name="ln-8024"></a>
<a name="ln-8025"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SeqSubstIterations</span>    <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">SeqSubstitIter</span>  <span class="c">! number of iterations in FuelCell loop</span>
<a name="ln-8026"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">RegulaFalsiIterations</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">RegulaFalsiIter</span> <span class="c">! number of iterations in Tproduct gas solving</span>
<a name="ln-8027"></a>
<a name="ln-8028"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ACancillariesPower</span>  <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelancillariesAC</span>
<a name="ln-8029"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ACancillariesEnergy</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">PelancillariesAC</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-8030"></a>
<a name="ln-8031"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">PCULosses</span>    <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Inverter</span><span class="p">%</span><span class="n">PCUlosses</span>  <span class="c">! inverter losses</span>
<a name="ln-8032"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">DCPowerGen</span>   <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Pel</span>  <span class="c">!DC power out of FCPM.</span>
<a name="ln-8033"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">DCPowerEff</span>   <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FCPM</span><span class="p">%</span><span class="n">Eel</span>  <span class="c">! FCPM efficienty Eel.</span>
<a name="ln-8034"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ElectEnergyinStorage</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">ThisTimeStepStateOfCharge</span>
<a name="ln-8035"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">StoredPower</span>  <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">PelIntoStorage</span>
<a name="ln-8036"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">StoredEnergy</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">PelIntoStorage</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-8037"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">DrawnPower</span>   <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">PelFromStorage</span>
<a name="ln-8038"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">DrawnEnergy</span>  <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">PelFromStorage</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-8039"></a>
<a name="ln-8040"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossPower</span>   <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QconvZone</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QradZone</span>
<a name="ln-8041"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossEnergy</span>  <span class="o">=</span> <span class="p">(</span><span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QconvZone</span> <span class="o">+</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QradZone</span><span class="p">)</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-8042"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossConvect</span> <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QconvZone</span>
<a name="ln-8043"></a>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">SkinLossRadiat</span>  <span class="o">=</span> <span class="n">FuelCell</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QradZone</span>
<a name="ln-8044"></a>
<a name="ln-8045"></a>
<a name="ln-8046"></a><span class="k">RETURN</span>
<a name="ln-8047"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateFuelCellGeneratorRecords</span>
<a name="ln-8048"></a>
<a name="ln-8049"></a><span class="k">SUBROUTINE </span><span class="n">GetFuelCellGeneratorResults</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span> <span class="n">GeneratorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8050"></a>                                 <span class="n">GeneratorPower</span><span class="p">,</span>  <span class="n">GeneratorEnergy</span><span class="p">,</span> <span class="n">ThermalPower</span><span class="p">,</span> <span class="n">ThermalEnergy</span><span class="p">)</span>
<a name="ln-8051"></a>
<a name="ln-8052"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8053"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-8054"></a>          <span class="c">!       DATE WRITTEN   March 2008</span>
<a name="ln-8055"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8056"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8057"></a>
<a name="ln-8058"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8059"></a>          <span class="c">! provide a get method to collect results at the load center level</span>
<a name="ln-8060"></a>
<a name="ln-8061"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8062"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-8063"></a>
<a name="ln-8064"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8065"></a>          <span class="c">! na</span>
<a name="ln-8066"></a>
<a name="ln-8067"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8068"></a>          <span class="c">! na</span>
<a name="ln-8069"></a>
<a name="ln-8070"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8071"></a>
<a name="ln-8072"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8073"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">GeneratorType</span>   <span class="c">! type of Generator</span>
<a name="ln-8074"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">GeneratorIndex</span>
<a name="ln-8075"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">GeneratorPower</span>  <span class="c">! electrical power</span>
<a name="ln-8076"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">GeneratorEnergy</span> <span class="c">! electrical energy</span>
<a name="ln-8077"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">ThermalPower</span>  <span class="c">! heat power</span>
<a name="ln-8078"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">ThermalEnergy</span> <span class="c">! heat energy</span>
<a name="ln-8079"></a>
<a name="ln-8080"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8081"></a>          <span class="c">! na</span>
<a name="ln-8082"></a>
<a name="ln-8083"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8084"></a>          <span class="c">! na</span>
<a name="ln-8085"></a>
<a name="ln-8086"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8087"></a>          <span class="c">! na</span>
<a name="ln-8088"></a>
<a name="ln-8089"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8090"></a>  <span class="n">GeneratorPower</span>  <span class="o">=</span>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ACPowerGen</span>
<a name="ln-8091"></a>  <span class="n">GeneratorEnergy</span> <span class="o">=</span>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">ACEnergyGen</span>
<a name="ln-8092"></a>  <span class="n">ThermalPower</span>    <span class="o">=</span>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">qHX</span>
<a name="ln-8093"></a>  <span class="n">ThermalEnergy</span>   <span class="o">=</span>  <span class="n">FuelCell</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">Report</span><span class="p">%</span><span class="n">HXenergy</span>
<a name="ln-8094"></a>
<a name="ln-8095"></a>  <span class="k">RETURN</span>
<a name="ln-8096"></a>
<a name="ln-8097"></a><span class="k">END SUBROUTINE </span><span class="n">GetFuelCellGeneratorResults</span>
<a name="ln-8098"></a>
<a name="ln-8099"></a>
<a name="ln-8100"></a>
<a name="ln-8101"></a>
<a name="ln-8102"></a><span class="k">END MODULE </span><span class="n">FuelCellElectricGenerator</span>
<a name="ln-8103"></a>
<a name="ln-8104"></a><span class="c">! End of the FuelCell Generator Module</span>
<a name="ln-8105"></a><span class="c">! ****************************************************************************************************</span>
<a name="ln-8106"></a>
<a name="ln-8107"></a><span class="k">MODULE </span><span class="n">ICEngineElectricGenerator</span>
<a name="ln-8108"></a>
<a name="ln-8109"></a>          <span class="c">! MODULE INFORMATION:</span>
<a name="ln-8110"></a>          <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-8111"></a>          <span class="c">!       DATE WRITTEN   Sept. 2000</span>
<a name="ln-8112"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8113"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8114"></a>
<a name="ln-8115"></a>          <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-8116"></a>          <span class="c">! This module simulates the operation of IC ENGINE Generators.</span>
<a name="ln-8117"></a>
<a name="ln-8118"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8119"></a>          <span class="c">! Once the ElectricPowerManager determines that the IC ENGINE Generator</span>
<a name="ln-8120"></a>          <span class="c">! is available to meet an electric load demand, it calls SimICEngineGenerator</span>
<a name="ln-8121"></a>          <span class="c">! which in turn calls the ICEngine Generator model.</span>
<a name="ln-8122"></a>
<a name="ln-8123"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8124"></a>          <span class="c">! N/A</span>
<a name="ln-8125"></a>
<a name="ln-8126"></a>          <span class="c">! OTHER NOTES:</span>
<a name="ln-8127"></a>          <span class="c">! N/A</span>
<a name="ln-8128"></a>
<a name="ln-8129"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8130"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-8131"></a><span class="k">USE </span><span class="n">DataGlobals</span> <span class="p">,</span>   <span class="n">ONLY</span> <span class="p">:</span> <span class="n">MaxNameLength</span><span class="p">,</span> <span class="n">NumOfTimeStepInHour</span><span class="p">,</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="n">BeginEnvrnFlag</span><span class="p">,</span> <span class="n">InitConvTemp</span>
<a name="ln-8132"></a><span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="n">ShowWarningMessage</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8133"></a>                           <span class="n">ShowContinueError</span><span class="p">,</span> <span class="n">SetupOutputVariable</span><span class="p">,</span><span class="n">ShowRecurringWarningErrorAtEnd</span>
<a name="ln-8134"></a><span class="k">USE </span><span class="n">DataGlobalConstants</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">iGeneratorICEngine</span>
<a name="ln-8135"></a><span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-8136"></a>
<a name="ln-8137"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-8138"></a>
<a name="ln-8139"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-8140"></a>
<a name="ln-8141"></a>  <span class="c">!MODULE PARAMETER DEFINITIONS</span>
<a name="ln-8142"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">ReferenceTemp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">5.0d0</span> <span class="c">!Reference temperature by which lower heating</span>
<a name="ln-8143"></a>                                                   <span class="c">! value is reported.  This should be subtracted</span>
<a name="ln-8144"></a>                                                   <span class="c">! off of when calculated exhaust energies.</span>
<a name="ln-8145"></a>
<a name="ln-8146"></a>
<a name="ln-8147"></a>  <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8148"></a>
<a name="ln-8149"></a><span class="k">TYPE </span><span class="n">ICEngineGeneratorSpecs</span>
<a name="ln-8150"></a>       <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>           <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! user identifier</span>
<a name="ln-8151"></a>       <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TypeOf</span>         <span class="o">=</span> <span class="s1">&#39;Generator:InternalCombustionEngine&#39;</span> <span class="c">! Type of Generator</span>
<a name="ln-8152"></a>       <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CompType_Num</span>   <span class="o">=</span> <span class="n">iGeneratorICEngine</span>
<a name="ln-8153"></a>       <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FuelType</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! Type of Fuel - DIESEL, GASOLINE, GAS</span>
<a name="ln-8154"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">RatedPowerOutput</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! W - design nominal capacity of Generator</span>
<a name="ln-8155"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ElectricCircuitNode</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Electric Circuit Node</span>
<a name="ln-8156"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">MinPartLoadRat</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! (IC ENGINE MIN) min allowed operating frac full load</span>
<a name="ln-8157"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">MaxPartLoadRat</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! (IC ENGINE MAX) max allowed operating frac full load</span>
<a name="ln-8158"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">OptPartLoadRat</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! (IC ENGINE BEST) optimal operating frac full load</span>
<a name="ln-8159"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ElecOutputFuelRat</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!(RELDC) Ratio of Generator output to Fuel Energy Input</span>
<a name="ln-8160"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ElecOutputFuelCurve</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">!Curve Index for generator output to Fuel Energy Input Coeff Poly Fit</span>
<a name="ln-8161"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">RecJacHeattoFuelRat</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!(RJACDC) Ratio of Recoverable Jacket Heat to Fuel Energy Input</span>
<a name="ln-8162"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">RecJacHeattoFuelCurve</span>     <span class="o">=</span> <span class="mi">0</span>   <span class="c">!Curve Index for Ratio of Recoverable Jacket Heat to</span>
<a name="ln-8163"></a>                                                            <span class="c">! Fuel Energy Input Coeff Poly Fit</span>
<a name="ln-8164"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">RecLubeHeattoFuelRat</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!(RLUBDC) Ratio of Recoverable Lube Oil Heat to Fuel Energy Input</span>
<a name="ln-8165"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">RecLubeHeattoFuelCurve</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">!Curve Index for Ratio of Recoverable Lube Oil Heat to</span>
<a name="ln-8166"></a>                                                            <span class="c">! Fuel Energy Input Coef Poly Fit</span>
<a name="ln-8167"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">TotExhausttoFuelRat</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!(REXDC) Total Exhaust heat Input to Fuel Energy Input</span>
<a name="ln-8168"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">TotExhausttoFuelCurve</span>     <span class="o">=</span> <span class="mi">0</span>   <span class="c">!Curve Index for Total Exhaust heat Input to Fuel Energy Input</span>
<a name="ln-8169"></a>                                                            <span class="c">! Coeffs Poly Fit</span>
<a name="ln-8170"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ExhaustTemp</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!(TEXDC) Exhaust Gas Temp to Fuel Energy Input</span>
<a name="ln-8171"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ExhaustTempCurve</span>          <span class="o">=</span> <span class="mi">0</span>   <span class="c">!Curve Index for Exhaust Gas Temp to Fuel Energy Input Coeffs Poly Fit</span>
<a name="ln-8172"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ErrExhaustTempIndex</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! error index for temp curve</span>
<a name="ln-8173"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">UA</span>                        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!(UACDC) exhaust gas Heat Exchanger UA to Capacity</span>
<a name="ln-8174"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UACoef</span>                    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Heat Exchanger UA Coeffs Poly Fit</span>
<a name="ln-8175"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">MaxExhaustperPowerOutput</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!MAX EXHAUST FLOW PER W DSL POWER OUTPUT COEFF</span>
<a name="ln-8176"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">DesignMinExitGasTemp</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Steam Saturation Temperature</span>
<a name="ln-8177"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">FuelHeatingValue</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Heating Value of Fuel in kJ/kg</span>
<a name="ln-8178"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">DesignHeatRecVolFlowRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! m3/s, Design Water mass flow rate through heat recovery loop</span>
<a name="ln-8179"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">DesignHeatRecMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! kg/s, Design Water mass flow rate through heat recovery loop</span>
<a name="ln-8180"></a>       <span class="kt">LOGICAL</span>           <span class="kd">::</span> <span class="n">HeatRecActive</span>             <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! True if Heat Rec Design Vol Flow Rate &gt; 0</span>
<a name="ln-8181"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">HeatRecInletNodeNum</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Node number on the heat recovery inlet side of the condenser</span>
<a name="ln-8182"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">HeatRecOutletNodeNum</span>      <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Node number on the heat recovery outlet side of the condenser</span>
<a name="ln-8183"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HeatRecInletTemp</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Inlet Temperature of the heat recovery fluid</span>
<a name="ln-8184"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HeatRecOutletTemp</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Outlet Temperature of the heat recovery fluid</span>
<a name="ln-8185"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HeatRecMdotDesign</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Heat Recovery Loop Mass flow rate</span>
<a name="ln-8186"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HeatRecMdotActual</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-8187"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">QTotalHeatRecovered</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! total heat recovered (W)</span>
<a name="ln-8188"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">QJacketRecovered</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! heat recovered from jacket (W)</span>
<a name="ln-8189"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">QLubeOilRecovered</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! heat recovered from lube (W)</span>
<a name="ln-8190"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">QExhaustRecovered</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! exhaust gas heat recovered (W)</span>
<a name="ln-8191"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">FuelEnergyUseRate</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Fuel Energy used (W)</span>
<a name="ln-8192"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">TotalHeatEnergyRec</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! total heat recovered (J)</span>
<a name="ln-8193"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">JacketEnergyRec</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! heat recovered from jacket (J)</span>
<a name="ln-8194"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">LubeOilEnergyRec</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! heat recovered from lube (J)</span>
<a name="ln-8195"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ExhaustEnergyRec</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! exhaust gas heat recovered (J)</span>
<a name="ln-8196"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">FuelEnergy</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Fuel Energy used (J)</span>
<a name="ln-8197"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">FuelMdot</span>                  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Fuel Amount used (Kg/s)</span>
<a name="ln-8198"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ExhaustStackTemp</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Exhaust Stack Temperature (C)</span>
<a name="ln-8199"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ElecPowerGenerated</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Electric Power Generated (W)</span>
<a name="ln-8200"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ElecEnergyGenerated</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Amount of Electric Energy Generated (J)</span>
<a name="ln-8201"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HeatRecMaxTemp</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Max Temp that can be produced in heat recovery</span>
<a name="ln-8202"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">HRLoopNum</span>                 <span class="o">=</span> <span class="mi">0</span>   <span class="c">! cooling water plant loop index number, for heat recovery</span>
<a name="ln-8203"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">HRLoopSideNum</span>             <span class="o">=</span> <span class="mi">0</span>   <span class="c">! cooling water plant loop side index, for heat recovery</span>
<a name="ln-8204"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">HRBranchNum</span>               <span class="o">=</span> <span class="mi">0</span>   <span class="c">! cooling water plant loop branch index, for heat recovery</span>
<a name="ln-8205"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">HRCompNum</span>                 <span class="o">=</span> <span class="mi">0</span>   <span class="c">! cooling water plant loop component index, for heat recovery</span>
<a name="ln-8206"></a>
<a name="ln-8207"></a><span class="k">END TYPE </span><span class="n">ICEngineGeneratorSpecs</span>
<a name="ln-8208"></a>
<a name="ln-8209"></a><span class="k">TYPE </span><span class="n">ReportVars</span>
<a name="ln-8210"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PowerGen</span>                   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: power (W)</span>
<a name="ln-8211"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EnergyGen</span>                  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: energy (J)</span>
<a name="ln-8212"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QJacketRecovered</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Heat Recovered from Jacket (W)</span>
<a name="ln-8213"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QLubeOilRecovered</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Heat Recovered from Lubricant (W)</span>
<a name="ln-8214"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QExhaustRecovered</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: exhaust gas heat recovered (W)</span>
<a name="ln-8215"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QTotalHeatRecovered</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Total Heat Recovered (W)</span>
<a name="ln-8216"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotalHeatEnergyRec</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: total heat recovered (J)</span>
<a name="ln-8217"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">JacketEnergyRec</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: heat recovered from jacket (J)</span>
<a name="ln-8218"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LubeOilEnergyRec</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: heat recovered from lube (J)</span>
<a name="ln-8219"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ExhaustEnergyRec</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: exhaust gas heat recovered (J)</span>
<a name="ln-8220"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FuelEnergy</span>                 <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Fuel Energy used (J)</span>
<a name="ln-8221"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FuelEnergyUseRate</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Fuel Energy used (W)</span>
<a name="ln-8222"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FuelMdot</span>                   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Fuel used (Kg/s)</span>
<a name="ln-8223"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ExhaustStackTemp</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Exhaust Stack Temperature (C)</span>
<a name="ln-8224"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecInletTemp</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Heat Recovery Loop Inlet Temperature (C)</span>
<a name="ln-8225"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecOutletTemp</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Heat Recovery Loop Outlet Temperature (C)</span>
<a name="ln-8226"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecMdot</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Heat Recovery Loop Mass flow rate (kg/s)</span>
<a name="ln-8227"></a><span class="k">END TYPE </span><span class="n">ReportVars</span>
<a name="ln-8228"></a>
<a name="ln-8229"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-8230"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">ICEngineGeneratorSpecs</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ICEngineGenerator</span>  <span class="c">!dimension to number of machines</span>
<a name="ln-8231"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">ReportVars</span><span class="p">),</span>              <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ICEngineGeneratorReport</span>
<a name="ln-8232"></a><span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumICEngineGenerators</span><span class="o">=</span><span class="mi">0</span> <span class="c">! number of IC ENGINE Generators specified in input</span>
<a name="ln-8233"></a><span class="kt">LOGICAL</span>  <span class="kd">::</span> <span class="n">GetICEInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>   <span class="c">! When TRUE, calls subroutine to read input file.</span>
<a name="ln-8234"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckEquipName</span>
<a name="ln-8235"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE IC ENGINEElectricGenerator</span>
<a name="ln-8236"></a>
<a name="ln-8237"></a><span class="k">PUBLIC     </span><span class="n">SimICEngineGenerator</span>
<a name="ln-8238"></a><span class="k">PUBLIC     </span><span class="n">GetICEGeneratorResults</span>
<a name="ln-8239"></a><span class="k">PUBLIC     </span><span class="n">SimICEPlantHeatRecovery</span>
<a name="ln-8240"></a><span class="k">PRIVATE    </span><span class="n">GetICEngineGeneratorInput</span>
<a name="ln-8241"></a><span class="k">PRIVATE    </span><span class="n">CalcICEngineGeneratorModel</span>
<a name="ln-8242"></a><span class="k">PRIVATE    </span><span class="n">CalcICEngineGenHeatRecovery</span>
<a name="ln-8243"></a><span class="k">PRIVATE    </span><span class="n">InitICEngineGenerators</span>
<a name="ln-8244"></a><span class="k">PRIVATE    </span><span class="n">UpdateICEngineGeneratorRecords</span>
<a name="ln-8245"></a>
<a name="ln-8246"></a><span class="k">CONTAINS</span>
<a name="ln-8247"></a>          <span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-8248"></a>
<a name="ln-8249"></a><span class="c">! Beginning of IC ENGINE Generator Module Driver Subroutines</span>
<a name="ln-8250"></a><span class="c">!*************************************************************************</span>
<a name="ln-8251"></a>
<a name="ln-8252"></a><span class="k">SUBROUTINE </span><span class="n">SimICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span><span class="n">GeneratorName</span><span class="p">,</span><span class="n">GeneratorIndex</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-8253"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8254"></a>          <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-8255"></a>          <span class="c">!       DATE WRITTEN   Sept. 2000</span>
<a name="ln-8256"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8257"></a>
<a name="ln-8258"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE: This is the IC ENGINE Generator model driver.  It</span>
<a name="ln-8259"></a>               <span class="c">! gets the input for the models, initializes simulation variables, call</span>
<a name="ln-8260"></a>               <span class="c">! the appropriate model and sets up reporting variables.</span>
<a name="ln-8261"></a>
<a name="ln-8262"></a>          <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-8263"></a>
<a name="ln-8264"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-8265"></a>
<a name="ln-8266"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8267"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-8268"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-8269"></a>
<a name="ln-8270"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-8271"></a>
<a name="ln-8272"></a>
<a name="ln-8273"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8274"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorType</span>     <span class="c">! type of Generator</span>
<a name="ln-8275"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorName</span>     <span class="c">! user specified name of Generator</span>
<a name="ln-8276"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorIndex</span>
<a name="ln-8277"></a>  <span class="kt">LOGICAL</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">RunFlag</span>                 <span class="c">! simulate Generator when TRUE</span>
<a name="ln-8278"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">MyLoad</span>                  <span class="c">! demand on electric generator</span>
<a name="ln-8279"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-8280"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8281"></a>          <span class="c">! na</span>
<a name="ln-8282"></a>
<a name="ln-8283"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8284"></a>          <span class="c">! na</span>
<a name="ln-8285"></a>
<a name="ln-8286"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8287"></a>          <span class="c">! na</span>
<a name="ln-8288"></a>
<a name="ln-8289"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8290"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">GenNum</span>           <span class="c">! Generator number counter</span>
<a name="ln-8291"></a>
<a name="ln-8292"></a>
<a name="ln-8293"></a>        <span class="c">!Get Generator data from input file</span>
<a name="ln-8294"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetICEInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8295"></a><span class="k">    CALL </span><span class="n">GetICEngineGeneratorInput</span>
<a name="ln-8296"></a>    <span class="n">GetICEInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8297"></a>  <span class="k">END IF</span>
<a name="ln-8298"></a>
<a name="ln-8299"></a>
<a name="ln-8300"></a>        <span class="c">!SELECT and CALL MODELS</span>
<a name="ln-8301"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GeneratorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8302"></a><span class="k">    </span><span class="n">GenNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumICEngineGenerators</span><span class="p">)</span>
<a name="ln-8303"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GenNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimICEngineGenerator: Specified Generator not one of Valid ICEngine Generators &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8304"></a>                                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">))</span>
<a name="ln-8305"></a>    <span class="n">GeneratorIndex</span><span class="o">=</span><span class="n">GenNum</span>
<a name="ln-8306"></a>  <span class="k">ELSE</span>
<a name="ln-8307"></a><span class="k">    </span><span class="n">GenNum</span><span class="o">=</span><span class="n">GeneratorIndex</span>
<a name="ln-8308"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GenNum</span> <span class="o">&gt;</span> <span class="n">NumICEngineGenerators</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">GenNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8309"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimICEngineGenerator: Invalid GeneratorIndex passed=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">GenNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8310"></a>                          <span class="s1">&#39;, Number of IC Engine Generators=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumICEngineGenerators</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8311"></a>                          <span class="s1">&#39;, Generator name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">))</span>
<a name="ln-8312"></a>    <span class="n">ENDIF</span>
<a name="ln-8313"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">GenNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8314"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GeneratorName</span> <span class="o">/=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8315"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimICEngineGenerator: Invalid GeneratorIndex passed=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">GenNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8316"></a>                            <span class="s1">&#39;, Generator name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Generator Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8317"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-8318"></a>      <span class="n">ENDIF</span>
<a name="ln-8319"></a>      <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-8320"></a>    <span class="n">ENDIF</span>
<a name="ln-8321"></a>  <span class="n">ENDIF</span>
<a name="ln-8322"></a>
<a name="ln-8323"></a>  <span class="k">CALL </span><span class="n">InitICEngineGenerators</span><span class="p">(</span><span class="n">GenNum</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-8324"></a>  <span class="k">CALL </span><span class="n">CalcICEngineGeneratorModel</span><span class="p">(</span><span class="n">GenNum</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-8325"></a>  <span class="k">CALL </span><span class="n">UpdateICEngineGeneratorRecords</span><span class="p">(</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">GenNum</span><span class="p">)</span>
<a name="ln-8326"></a>
<a name="ln-8327"></a><span class="k">RETURN</span>
<a name="ln-8328"></a><span class="k">END SUBROUTINE </span><span class="n">SimICEngineGenerator</span>
<a name="ln-8329"></a>
<a name="ln-8330"></a><span class="k">SUBROUTINE </span><span class="n">GetICEGeneratorResults</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span> <span class="n">GeneratorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8331"></a>                                 <span class="n">GeneratorPower</span><span class="p">,</span>  <span class="n">GeneratorEnergy</span><span class="p">,</span> <span class="n">ThermalPower</span><span class="p">,</span> <span class="n">ThermalEnergy</span><span class="p">)</span>
<a name="ln-8332"></a>
<a name="ln-8333"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8334"></a>          <span class="c">!       AUTHOR         &lt;author&gt;</span>
<a name="ln-8335"></a>          <span class="c">!       DATE WRITTEN   &lt;date_written&gt;</span>
<a name="ln-8336"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8337"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8338"></a>
<a name="ln-8339"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8340"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-8341"></a>
<a name="ln-8342"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8343"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-8344"></a>
<a name="ln-8345"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8346"></a>          <span class="c">! na</span>
<a name="ln-8347"></a>
<a name="ln-8348"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8349"></a>          <span class="c">! na</span>
<a name="ln-8350"></a>
<a name="ln-8351"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8352"></a>
<a name="ln-8353"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8354"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">GeneratorType</span>   <span class="c">! type of Generator</span>
<a name="ln-8355"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">GeneratorIndex</span>
<a name="ln-8356"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">GeneratorPower</span>  <span class="c">! electrical power</span>
<a name="ln-8357"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">GeneratorEnergy</span> <span class="c">! electrical energy</span>
<a name="ln-8358"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">ThermalPower</span>  <span class="c">! heat power</span>
<a name="ln-8359"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">ThermalEnergy</span> <span class="c">! heat energy</span>
<a name="ln-8360"></a>
<a name="ln-8361"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8362"></a>          <span class="c">! na</span>
<a name="ln-8363"></a>
<a name="ln-8364"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8365"></a>          <span class="c">! na</span>
<a name="ln-8366"></a>
<a name="ln-8367"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8368"></a>          <span class="c">! na</span>
<a name="ln-8369"></a>
<a name="ln-8370"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8371"></a>  <span class="n">GeneratorPower</span>  <span class="o">=</span>  <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">PowerGen</span>
<a name="ln-8372"></a>  <span class="n">GeneratorEnergy</span> <span class="o">=</span>  <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">EnergyGen</span>
<a name="ln-8373"></a>  <span class="n">ThermalPower</span>    <span class="o">=</span>  <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">QTotalHeatRecovered</span>
<a name="ln-8374"></a>  <span class="n">ThermalEnergy</span>   <span class="o">=</span>  <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">TotalHeatEnergyRec</span>
<a name="ln-8375"></a>
<a name="ln-8376"></a>  <span class="k">RETURN</span>
<a name="ln-8377"></a>
<a name="ln-8378"></a><span class="k">END SUBROUTINE </span><span class="n">GetICEGeneratorResults</span>
<a name="ln-8379"></a>
<a name="ln-8380"></a><span class="k">SUBROUTINE </span><span class="n">SimICEPlantHeatRecovery</span><span class="p">(</span><span class="n">CompType</span><span class="p">,</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompTypeNum</span><span class="p">,</span><span class="n">CompNum</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">InitLoopEquip</span><span class="p">,</span>  <span class="p">&amp;</span>  <span class="c">!DSU</span>
<a name="ln-8381"></a>                          <span class="n">MyLoad</span><span class="p">,</span><span class="n">MaxCap</span><span class="p">,</span><span class="n">MinCap</span><span class="p">,</span><span class="n">OptCap</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-8382"></a>
<a name="ln-8383"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8384"></a>          <span class="c">!       AUTHOR         BGriffith</span>
<a name="ln-8385"></a>          <span class="c">!       DATE WRITTEN   March 2008</span>
<a name="ln-8386"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8387"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8388"></a>
<a name="ln-8389"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8390"></a>          <span class="c">! Fill data needed in PlantLoopEquipments</span>
<a name="ln-8391"></a>
<a name="ln-8392"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8393"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-8394"></a>
<a name="ln-8395"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8396"></a>          <span class="c">! na</span>
<a name="ln-8397"></a>
<a name="ln-8398"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8399"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-8400"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">UpdateComponentHeatRecoverySide</span>
<a name="ln-8401"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">TypeOf_Generator_ICEngine</span>
<a name="ln-8402"></a>
<a name="ln-8403"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8404"></a>
<a name="ln-8405"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8406"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompType</span>
<a name="ln-8407"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompName</span>
<a name="ln-8408"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CompTypeNum</span>
<a name="ln-8409"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">CompNum</span>
<a name="ln-8410"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">RunFlag</span>
<a name="ln-8411"></a>  <span class="c">!INTEGER, INTENT(IN)          :: FlowLock !DSU</span>
<a name="ln-8412"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">InitLoopEquip</span>
<a name="ln-8413"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MyLoad</span>
<a name="ln-8414"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">MinCap</span>
<a name="ln-8415"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">MaxCap</span>
<a name="ln-8416"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">OptCap</span>
<a name="ln-8417"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! TRUE if First iteration of simulation</span>
<a name="ln-8418"></a>
<a name="ln-8419"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8420"></a>          <span class="c">! na</span>
<a name="ln-8421"></a>
<a name="ln-8422"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8423"></a>          <span class="c">! na</span>
<a name="ln-8424"></a>
<a name="ln-8425"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8426"></a>          <span class="c">! na</span>
<a name="ln-8427"></a>
<a name="ln-8428"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8429"></a>          <span class="c">! na</span>
<a name="ln-8430"></a>
<a name="ln-8431"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetICEInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8432"></a><span class="k">    CALL </span><span class="n">GetICEngineGeneratorInput</span>
<a name="ln-8433"></a>    <span class="n">GetICEInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8434"></a>  <span class="k">END IF</span>
<a name="ln-8435"></a>
<a name="ln-8436"></a><span class="k">  If</span> <span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-8437"></a><span class="k">    </span><span class="n">CompNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span> <span class="n">ICEngineGenerator</span><span class="p">%</span><span class="n">name</span><span class="p">,</span> <span class="n">NumICEngineGenerators</span><span class="p">)</span>
<a name="ln-8438"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">CompNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-8439"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimICEPlantHeatRecovery: ICE Generator Unit not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-8440"></a>      <span class="k">RETURN</span>
<a name="ln-8441"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-8442"></a>      <span class="n">MinCap</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8443"></a>      <span class="n">MaxCap</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8444"></a>      <span class="n">OptCap</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8445"></a>      <span class="k">RETURN</span>
<a name="ln-8446"></a><span class="k">  </span><span class="n">ENDIF</span> <span class="c">! End Of InitLoopEquip</span>
<a name="ln-8447"></a>
<a name="ln-8448"></a>
<a name="ln-8449"></a>  <span class="k">CALL </span><span class="n">UpdateComponentHeatRecoverySide</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span>               <span class="p">&amp;</span>
<a name="ln-8450"></a>                                    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-8451"></a>                                    <span class="n">TypeOf_Generator_ICEngine</span><span class="p">,</span>                           <span class="p">&amp;</span>
<a name="ln-8452"></a>                                    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-8453"></a>                                    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-8454"></a>                                    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">QTotalHeatRecovered</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-8455"></a>                                    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8456"></a>                                    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8457"></a>                                    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">HeatRecMdot</span> <span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8458"></a>                                    <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-8459"></a>
<a name="ln-8460"></a>  <span class="k">RETURN</span>
<a name="ln-8461"></a>
<a name="ln-8462"></a><span class="k">END SUBROUTINE </span><span class="n">SimICEPlantHeatRecovery</span>
<a name="ln-8463"></a>
<a name="ln-8464"></a>
<a name="ln-8465"></a><span class="c">! End IC ENGINE Generator Module Driver Subroutines</span>
<a name="ln-8466"></a><span class="c">!******************************************************************************</span>
<a name="ln-8467"></a>
<a name="ln-8468"></a>
<a name="ln-8469"></a><span class="c">! Beginning of IC ENGINE Generator Module Get Input subroutines</span>
<a name="ln-8470"></a><span class="c">!******************************************************************************</span>
<a name="ln-8471"></a>
<a name="ln-8472"></a>
<a name="ln-8473"></a><span class="k">SUBROUTINE </span><span class="n">GetICEngineGeneratorInput</span>
<a name="ln-8474"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8475"></a>            <span class="c">!       AUTHOR:          Dan Fisher</span>
<a name="ln-8476"></a>            <span class="c">!       DATE WRITTEN:    Sept. 2000</span>
<a name="ln-8477"></a>
<a name="ln-8478"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8479"></a>            <span class="c">! This routine will get the input</span>
<a name="ln-8480"></a>            <span class="c">! required by the IC ENGINE Generator models.</span>
<a name="ln-8481"></a>
<a name="ln-8482"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8483"></a>            <span class="c">! EnergyPlus input processor</span>
<a name="ln-8484"></a>
<a name="ln-8485"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-8486"></a>
<a name="ln-8487"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-8488"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-8489"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>  <span class="c">! Data for field names, blank numerics</span>
<a name="ln-8490"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>   <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetCurveIndex</span><span class="p">,</span> <span class="n">CurveValue</span>
<a name="ln-8491"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-8492"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-8493"></a>  <span class="k">Use </span><span class="n">General</span><span class="p">,</span> <span class="n">Only</span><span class="p">:</span>  <span class="n">RoundSigDigits</span>
<a name="ln-8494"></a>  <span class="k">Use </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-8495"></a>
<a name="ln-8496"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">!</span>
<a name="ln-8497"></a>
<a name="ln-8498"></a>            <span class="c">! PARAMETERS</span>
<a name="ln-8499"></a>
<a name="ln-8500"></a>            <span class="c">!LOCAL VARIABLES</span>
<a name="ln-8501"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">GeneratorNum</span> <span class="c">!Generator counter</span>
<a name="ln-8502"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumAlphas</span>  <span class="c">! Number of elements in the alpha array</span>
<a name="ln-8503"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumNums</span>    <span class="c">! Number of elements in the numeric array</span>
<a name="ln-8504"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">IOStat</span>     <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-8505"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">AlphArray</span> <span class="c">!character string data</span>
<a name="ln-8506"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>                   <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NumArray</span>  <span class="c">!numeric data</span>
<a name="ln-8507"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! error flag</span>
<a name="ln-8508"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsNotOK</span>              <span class="c">! Flag to verify name</span>
<a name="ln-8509"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsBlank</span>              <span class="c">! Flag for blank name</span>
<a name="ln-8510"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xValue</span> <span class="c">! test curve limits</span>
<a name="ln-8511"></a>
<a name="ln-8512"></a>         <span class="c">!FLOW</span>
<a name="ln-8513"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Generator:InternalCombustionEngine&#39;</span>
<a name="ln-8514"></a>  <span class="n">NumICEngineGenerators</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-8515"></a>
<a name="ln-8516"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumICEngineGenerators</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8517"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; equipment specified in input file&#39;</span><span class="p">)</span>
<a name="ln-8518"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8519"></a>  <span class="n">ENDIF</span>
<a name="ln-8520"></a>
<a name="ln-8521"></a>         <span class="c">!ALLOCATE ARRAYS</span>
<a name="ln-8522"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">NumICEngineGenerators</span><span class="p">))</span>
<a name="ln-8523"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">NumICEngineGenerators</span><span class="p">))</span>
<a name="ln-8524"></a>  <span class="n">CheckEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8525"></a>
<a name="ln-8526"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">NumICEngineGenerators</span><span class="p">))</span>
<a name="ln-8527"></a>
<a name="ln-8528"></a>
<a name="ln-8529"></a>         <span class="c">!LOAD ARRAYS WITH IC ENGINE Generator CURVE FIT  DATA</span>
<a name="ln-8530"></a>  <span class="k">DO </span><span class="n">GeneratorNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumICEngineGenerators</span>
<a name="ln-8531"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">GeneratorNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8532"></a>                    <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8533"></a>                    <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-8534"></a>
<a name="ln-8535"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-8536"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-8537"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ICEngineGenerator</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">GeneratorNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-8538"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8539"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8540"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-8541"></a>    <span class="n">ENDIF</span>
<a name="ln-8542"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span>                <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8543"></a>
<a name="ln-8544"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RatedPowerOutput</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8545"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8546"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-8547"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-8548"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8549"></a>    <span class="n">ENDIF</span>
<a name="ln-8550"></a>
<a name="ln-8551"></a>           <span class="c">! Not sure what to do with electric nodes, so do not use optional arguments</span>
<a name="ln-8552"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElectricCircuitNode</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-8553"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-8554"></a>               <span class="n">NodeType_Electric</span><span class="p">,</span><span class="n">NodeConnectionType_Electric</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-8555"></a>
<a name="ln-8556"></a>
<a name="ln-8557"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MinPartLoadRat</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-8558"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxPartLoadRat</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-8559"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">OptPartLoadRat</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-8560"></a>
<a name="ln-8561"></a><span class="c">!Load Special IC ENGINE Generator Curve Fit Inputs</span>
<a name="ln-8562"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecOutputFuelCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-8563"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecOutputFuelCurve</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8564"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-8565"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-8566"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8567"></a>    <span class="k">END IF</span>
<a name="ln-8568"></a>
<a name="ln-8569"></a><span class="k">    </span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RecJacHeattoFuelCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-8570"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RecJacHeattoFuelCurve</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8571"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-8572"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-8573"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8574"></a>    <span class="k">END IF</span>
<a name="ln-8575"></a>
<a name="ln-8576"></a><span class="k">    </span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RecLubeHeattoFuelCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-8577"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RecLubeHeattoFuelCurve</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8578"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-8579"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-8580"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8581"></a>    <span class="k">END IF</span>
<a name="ln-8582"></a>
<a name="ln-8583"></a><span class="k">    </span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">TotExhausttoFuelCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-8584"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">TotExhausttoFuelCurve</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8585"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-8586"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-8587"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8588"></a>    <span class="k">END IF</span>
<a name="ln-8589"></a>
<a name="ln-8590"></a><span class="k">    </span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-8591"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustTempCurve</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8592"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-8593"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-8594"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8595"></a>    <span class="k">ELSE</span>
<a name="ln-8596"></a><span class="k">      </span><span class="n">xValue</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustTempCurve</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-8597"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">xValue</span> <span class="o">&lt;</span> <span class="n">ReferenceTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8598"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetICEngineGeneratorInput: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; output has very low value.&#39;</span><span class="p">)</span>
<a name="ln-8599"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...curve generates [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">xValue</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C] at PLR=1.0&#39;</span><span class="p">)</span>
<a name="ln-8600"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...this is less than the Reference Temperature [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ReferenceTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8601"></a>           <span class="s1">&#39; C] and may cause errors.&#39;</span><span class="p">)</span>
<a name="ln-8602"></a>      <span class="n">ENDIF</span>
<a name="ln-8603"></a>    <span class="k">END IF</span>
<a name="ln-8604"></a>
<a name="ln-8605"></a><span class="k">    </span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">UACoef</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-8606"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">UACoef</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-8607"></a>
<a name="ln-8608"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxExhaustperPowerOutput</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-8609"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignMinExitGasTemp</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-8610"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelHeatingValue</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-8611"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecVolFlowRate</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-8612"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8613"></a><span class="k">      </span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8614"></a>      <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-8615"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-8616"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-8617"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8618"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-8619"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-8620"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8621"></a>      <span class="n">ENDIF</span>
<a name="ln-8622"></a>      <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-8623"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-8624"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-8625"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8626"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-8627"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-8628"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8629"></a>      <span class="n">ENDIF</span>
<a name="ln-8630"></a>      <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Heat Recovery Nodes&#39;</span><span class="p">)</span>
<a name="ln-8631"></a>      <span class="k">Call </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8632"></a>                                <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecVolFlowRate</span> <span class="p">)</span>
<a name="ln-8633"></a>    <span class="k">ELSE</span>
<a name="ln-8634"></a><span class="k">      </span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-8635"></a>      <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-8636"></a>      <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-8637"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8638"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Since Design Heat Flow Rate = 0.0, Heat Recovery inactive for &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8639"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-8640"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;However, Node names were specified for Heat Recovery inlet or outlet nodes&#39;</span><span class="p">)</span>
<a name="ln-8641"></a>      <span class="n">ENDIF</span>
<a name="ln-8642"></a>    <span class="n">ENDIF</span>
<a name="ln-8643"></a>
<a name="ln-8644"></a>    <span class="c">!Fuel Type Case Statement</span>
<a name="ln-8645"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<a name="ln-8646"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">)</span> <span class="c">!If blank then the default is Diesel</span>
<a name="ln-8647"></a>      <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Diesel&#39;</span>
<a name="ln-8648"></a>
<a name="ln-8649"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURALGAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURAL GAS&#39;</span><span class="p">)</span>
<a name="ln-8650"></a>      <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Gas&#39;</span>
<a name="ln-8651"></a>
<a name="ln-8652"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DIESEL&#39;</span><span class="p">)</span>
<a name="ln-8653"></a>      <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Diesel&#39;</span>
<a name="ln-8654"></a>
<a name="ln-8655"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GASOLINE&#39;</span><span class="p">)</span>
<a name="ln-8656"></a>      <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Gasoline&#39;</span>
<a name="ln-8657"></a>
<a name="ln-8658"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FUEL OIL #1&#39;</span><span class="p">,</span><span class="s1">&#39;FUELOIL#1&#39;</span><span class="p">,</span><span class="s1">&#39;FUEL OIL&#39;</span><span class="p">,</span><span class="s1">&#39;DISTILLATE OIL&#39;</span><span class="p">)</span>
<a name="ln-8659"></a>       <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;FuelOil#1&#39;</span>
<a name="ln-8660"></a>
<a name="ln-8661"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FUEL OIL #2&#39;</span><span class="p">,</span><span class="s1">&#39;FUELOIL#2&#39;</span><span class="p">,</span><span class="s1">&#39;RESIDUAL OIL&#39;</span><span class="p">)</span>
<a name="ln-8662"></a>       <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;FuelOil#2&#39;</span>
<a name="ln-8663"></a>
<a name="ln-8664"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;PROPANE&#39;</span><span class="p">,</span><span class="s1">&#39;LPG&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANEGAS&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANE GAS&#39;</span><span class="p">)</span>
<a name="ln-8665"></a>       <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Propane&#39;</span>
<a name="ln-8666"></a>
<a name="ln-8667"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHERFUEL1&#39;</span><span class="p">)</span>
<a name="ln-8668"></a>       <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;OtherFuel1&#39;</span>
<a name="ln-8669"></a>
<a name="ln-8670"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHERFUEL2&#39;</span><span class="p">)</span>
<a name="ln-8671"></a>       <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;OtherFuel2&#39;</span>
<a name="ln-8672"></a>
<a name="ln-8673"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-8674"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<a name="ln-8675"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-8676"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8677"></a>    <span class="k">END SELECT</span>
<a name="ln-8678"></a>
<a name="ln-8679"></a>
<a name="ln-8680"></a><span class="k">    </span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxTemp</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-8681"></a>
<a name="ln-8682"></a>
<a name="ln-8683"></a>  <span class="k">END DO</span>
<a name="ln-8684"></a>
<a name="ln-8685"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8686"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in processing input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">))</span>
<a name="ln-8687"></a>  <span class="n">ENDIF</span>
<a name="ln-8688"></a>
<a name="ln-8689"></a>  <span class="k">DO </span><span class="n">GeneratorNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumICEngineGenerators</span>
<a name="ln-8690"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8691"></a>          <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PowerGen</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8692"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8693"></a>          <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">EnergyGen</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8694"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ElectricityProduced&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-8695"></a>
<a name="ln-8696"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator &#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8697"></a>          <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergyUseRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8698"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator &#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8699"></a>          <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8700"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-8701"></a>
<a name="ln-8702"></a><span class="c">!    general fuel use report to match other generators.</span>
<a name="ln-8703"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel HHV Basis Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8704"></a>          <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergyUseRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8705"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel HHV Basis Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8706"></a>          <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-8707"></a>
<a name="ln-8708"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator &#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8709"></a>          <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelMdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8710"></a>
<a name="ln-8711"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Exhaust Air Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8712"></a>          <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustStackTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8713"></a>
<a name="ln-8714"></a>
<a name="ln-8715"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8716"></a><span class="k">       CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Heat Recovery Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8717"></a>            <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8718"></a>
<a name="ln-8719"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Jacket Heat Recovery Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8720"></a>            <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QJacketRecovered</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8721"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Jacket Heat Recovery Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8722"></a>            <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">JacketEnergyRec</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8723"></a>                                <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATRECOVERY&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-8724"></a>
<a name="ln-8725"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Lube Heat Recovery Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8726"></a>            <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QLubeOilRecovered</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8727"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Lube Heat Recovery Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8728"></a>            <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">LubeOilEnergyRec</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8729"></a>                                <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATRECOVERY&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-8730"></a>
<a name="ln-8731"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Exhaust Heat Recovery Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8732"></a>            <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QExhaustRecovered</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8733"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Exhaust Heat Recovery Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8734"></a>            <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustEnergyRec</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8735"></a>                                <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATRECOVERY&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-8736"></a>
<a name="ln-8737"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Thermal Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8738"></a>            <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QTotalHEatRecovered</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8739"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Thermal Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8740"></a>            <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">TotalHeatEnergyRec</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8741"></a>
<a name="ln-8742"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Heat Recovery Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8743"></a>          <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8744"></a>
<a name="ln-8745"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Heat Recovery Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8746"></a>          <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8747"></a>    <span class="n">ENDIF</span>
<a name="ln-8748"></a>
<a name="ln-8749"></a>  <span class="k">END DO</span>
<a name="ln-8750"></a>
<a name="ln-8751"></a>
<a name="ln-8752"></a><span class="k">RETURN</span>
<a name="ln-8753"></a><span class="k">END SUBROUTINE </span><span class="n">GetICEngineGeneratorInput</span>
<a name="ln-8754"></a>
<a name="ln-8755"></a><span class="c">! End of Get Input subroutines for the IC ENGINE Generator Module</span>
<a name="ln-8756"></a><span class="c">!******************************************************************************</span>
<a name="ln-8757"></a>
<a name="ln-8758"></a>
<a name="ln-8759"></a><span class="c">! Beginning of Generator model Subroutines</span>
<a name="ln-8760"></a><span class="c">! *****************************************************************************</span>
<a name="ln-8761"></a>
<a name="ln-8762"></a><span class="k">SUBROUTINE </span><span class="n">CalcICEngineGeneratorModel</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-8763"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8764"></a>          <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-8765"></a>          <span class="c">!       DATE WRITTEN   Sept. 2000</span>
<a name="ln-8766"></a>          <span class="c">!       MODIFIED     na</span>
<a name="ln-8767"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-8768"></a>
<a name="ln-8769"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8770"></a>          <span class="c">! simulate a IC ENGINE generator using the BLAST model</span>
<a name="ln-8771"></a>
<a name="ln-8772"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8773"></a>          <span class="c">! curve fit of performance data:</span>
<a name="ln-8774"></a>
<a name="ln-8775"></a>          <span class="c">! REFERENCES:na</span>
<a name="ln-8776"></a>
<a name="ln-8777"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8778"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">FirstTimeStepSysFlag</span><span class="p">,</span><span class="n">TimeStepSys</span>
<a name="ln-8779"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>    <span class="n">ONLY</span> <span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-8780"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-8781"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span> <span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-8782"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-8783"></a>
<a name="ln-8784"></a>
<a name="ln-8785"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8786"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">GeneratorNum</span>    <span class="c">! Generator number</span>
<a name="ln-8787"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">RunFlag</span>         <span class="c">! TRUE when Generator operating</span>
<a name="ln-8788"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myload</span>          <span class="c">! Generator demand</span>
<a name="ln-8789"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-8790"></a>
<a name="ln-8791"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8792"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">ExhaustCP</span> <span class="o">=</span> <span class="mf">1.047d0</span>    <span class="c">!Exhaust Gas Specific Heat (J/kg-K)</span>
<a name="ln-8793"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">KJtoJ</span> <span class="o">=</span> <span class="mi">100</span><span class="mf">0.d0</span>        <span class="c">!convert Kjoules to joules</span>
<a name="ln-8794"></a>
<a name="ln-8795"></a>
<a name="ln-8796"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8797"></a>
<a name="ln-8798"></a>
<a name="ln-8799"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8800"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinPartLoadRat</span>      <span class="c">! min allowed operating frac full load</span>
<a name="ln-8801"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxPartLoadRat</span>      <span class="c">! max allowed operating frac full load</span>
<a name="ln-8802"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLR</span>                 <span class="c">! Generator operating part load ratio</span>
<a name="ln-8803"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedPowerOutput</span>    <span class="c">! Generator nominal capacity (W)</span>
<a name="ln-8804"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecPowerGenerated</span>  <span class="c">! Generator output (W)</span>
<a name="ln-8805"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElectricEnergyGen</span>   <span class="c">! Generator output (J)</span>
<a name="ln-8806"></a>
<a name="ln-8807"></a><span class="c">! Special variables for IC ENGINE Generator</span>
<a name="ln-8808"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxExhaustperPowerOutput</span> <span class="c">!curve fit parameter</span>
<a name="ln-8809"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecOutputFuelRat</span>      <span class="c">!(RELDC) Ratio of generator output to Fuel Energy Input</span>
<a name="ln-8810"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RecJacHeattoFuelRat</span>  <span class="c">!(RJACDC) Ratio of Recoverable Jacket Heat to Fuel Energy Input</span>
<a name="ln-8811"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RecLubeHeattoFuelRat</span> <span class="c">!(RLUBDC) Ratio of Recoverable Lube Oil Heat to Fuel Energy Input</span>
<a name="ln-8812"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotExhausttoFuelRat</span>  <span class="c">!(REXDC) Total Exhaust Energy Input to Fuel Energy Input</span>
<a name="ln-8813"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExhaustTemp</span>          <span class="c">!(TEX) Exhaust Gas Temp</span>
<a name="ln-8814"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UA</span>                   <span class="c">!(UACDC) exhaust gas Heat Exchanger UA</span>
<a name="ln-8815"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FuelEnergyUseRate</span>    <span class="c">! IC ENGINE fuel use rate (W)</span>
<a name="ln-8816"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FuelEnergyUsed</span>       <span class="c">! IC ENGINE fuel use (J)</span>
<a name="ln-8817"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QTotalHeatRecovered</span>
<a name="ln-8818"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QJacketRec</span>                 <span class="c">! water jacket heat recovered (W)</span>
<a name="ln-8819"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLubeOilRec</span>                <span class="c">! lube oil cooler heat recovered (W)</span>
<a name="ln-8820"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QExhaustRec</span>                <span class="c">! exhaust gas heat recovered (W)</span>
<a name="ln-8821"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">JacketEnergyRec</span>            <span class="c">! water jacket heat recovered (J)</span>
<a name="ln-8822"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LubeOilEnergyRec</span>           <span class="c">! lube oil cooler heat recovered (J)</span>
<a name="ln-8823"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExhaustEnergyRec</span>           <span class="c">! exhaust gas heat recovered (J)</span>
<a name="ln-8824"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QExhaustTotal</span>   <span class="c">! total engine exhaust heat (W)</span>
<a name="ln-8825"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExhaustGasFlow</span>       <span class="c">! exhaust gas mass flow rate (kg/s)</span>
<a name="ln-8826"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExhaustStackTemp</span>     <span class="c">! engine stack temp. (C)</span>
<a name="ln-8827"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DesignMinExitGasTemp</span>   <span class="c">! design engine stact saturated steam temp. (C)</span>
<a name="ln-8828"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FuelHeatingValue</span>     <span class="c">!Heating Value of Fuel in kJ/kg</span>
<a name="ln-8829"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HeatRecInNode</span>        <span class="c">!Heat Recovery Fluid Inlet Node Num</span>
<a name="ln-8830"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatRecInTemp</span>        <span class="c">!Heat Recovery Fluid Inlet Temperature (C)</span>
<a name="ln-8831"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatRecMdot</span>          <span class="c">!Heat Recovery Fluid Mass FlowRate (kg/s)</span>
<a name="ln-8832"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatRecCp</span>            <span class="c">!Specific Heat of the Heat Recovery Fluid (J/kg-K)</span>
<a name="ln-8833"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HRecRatio</span>              <span class="c">!When Max Temp is reached the amount of recovered heat has to be reduced.</span>
<a name="ln-8834"></a>                                    <span class="c">! and this assumption uses this ratio to accomplish this task.</span>
<a name="ln-8835"></a>
<a name="ln-8836"></a>
<a name="ln-8837"></a>
<a name="ln-8838"></a>    <span class="c">! LOAD LOCAL VARIABLES FROM DATA STRUCTURE (for code readability)</span>
<a name="ln-8839"></a>  <span class="n">MinPartLoadRat</span>    <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MinPartLoadRat</span>
<a name="ln-8840"></a>  <span class="n">MaxPartLoadRat</span>    <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxPartLoadRat</span>
<a name="ln-8841"></a>  <span class="n">RatedPowerOutput</span>  <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RatedPowerOutput</span>
<a name="ln-8842"></a>  <span class="n">MaxExhaustperPowerOutput</span>  <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxExhaustperPowerOutput</span>
<a name="ln-8843"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8844"></a><span class="k">    </span><span class="n">HeatRecInNode</span>     <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>
<a name="ln-8845"></a>    <span class="n">HeatRecInTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-8846"></a>    <span class="n">HeatRecCp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8847"></a>                                 <span class="n">HeatRecInTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8848"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8849"></a>                                 <span class="s1">&#39;CalcICEngineGeneratorModel&#39;</span><span class="p">)</span>
<a name="ln-8850"></a>    <span class="n">HeatRecMdot</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-8851"></a>
<a name="ln-8852"></a>  <span class="k">ELSE</span>
<a name="ln-8853"></a><span class="k">    </span><span class="n">HeatRecInTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8854"></a>    <span class="n">HeatRecMdot</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8855"></a>  <span class="n">ENDIF</span>
<a name="ln-8856"></a>
<a name="ln-8857"></a>        <span class="c">!If no loop demand or Generator OFF, return</span>
<a name="ln-8858"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Runflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8859"></a><span class="k">    </span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecPowerGenerated</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8860"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecEnergyGenerated</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8861"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span>     <span class="o">=</span> <span class="n">HeatRecInTemp</span>
<a name="ln-8862"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span>    <span class="o">=</span> <span class="n">HeatRecInTemp</span>
<a name="ln-8863"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMdotActual</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8864"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QJacketRecovered</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8865"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QExhaustRecovered</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8866"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QLubeOilRecovered</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8867"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QTotalHeatRecovered</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8868"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">JacketEnergyRec</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8869"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustEnergyRec</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8870"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">LubeOilEnergyRec</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8871"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">TotalHeatEnergyRec</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8872"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergyUseRate</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8873"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergy</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8874"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelMdot</span>             <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8875"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustStackTemp</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8876"></a>
<a name="ln-8877"></a>    <span class="k">RETURN</span>
<a name="ln-8878"></a><span class="k">  END IF</span>
<a name="ln-8879"></a>
<a name="ln-8880"></a>
<a name="ln-8881"></a>     <span class="c">! CALCULATE POWER GENERATED AND PLR</span>
<a name="ln-8882"></a>  <span class="n">ElecPowerGenerated</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">RatedPowerOutput</span><span class="p">)</span>
<a name="ln-8883"></a>  <span class="n">ElecPowerGenerated</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecPowerGenerated</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-8884"></a>  <span class="n">PLR</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">ElecPowerGenerated</span><span class="o">/</span><span class="n">RatedPowerOutput</span><span class="p">,</span> <span class="n">MaxPartLoadRat</span><span class="p">)</span>
<a name="ln-8885"></a>  <span class="n">PLR</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">PLR</span><span class="p">,</span> <span class="n">MinPartLoadRat</span><span class="p">)</span>
<a name="ln-8886"></a>  <span class="n">ElecPowerGenerated</span> <span class="o">=</span> <span class="n">PLR</span><span class="o">*</span><span class="n">RatedPowerOutput</span>
<a name="ln-8887"></a>
<a name="ln-8888"></a>        <span class="c">!DETERMINE FUEL CONSUMED AND AVAILABLE WASTE HEAT</span>
<a name="ln-8889"></a>
<a name="ln-8890"></a><span class="c">!Use Curve fit to determine Fuel Energy Input.  For electric power generated in Watts, the fuel</span>
<a name="ln-8891"></a><span class="c">!energy input is calculated in J/s.  The PLBasedFuelInputCurve selects ratio of fuel flow (J/s)/power generated (J/s).</span>
<a name="ln-8892"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PLR</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8893"></a><span class="k">      </span><span class="n">ElecOutputFuelRat</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecOutputFuelCurve</span><span class="p">,</span> <span class="n">PLR</span><span class="p">)</span>
<a name="ln-8894"></a>      <span class="n">FuelEnergyUseRate</span> <span class="o">=</span> <span class="n">ElecPowerGenerated</span> <span class="o">/</span> <span class="n">ElecOutputFuelRat</span>
<a name="ln-8895"></a>    <span class="k">ELSE</span>
<a name="ln-8896"></a><span class="k">      </span><span class="n">FuelEnergyUseRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8897"></a>    <span class="k">END IF</span>
<a name="ln-8898"></a>
<a name="ln-8899"></a><span class="c">!Use Curve fit to determine heat recovered in the water jacket.  This curve calculates the water jacket heat recovered (J/s) by</span>
<a name="ln-8900"></a><span class="c">!multiplying the total fuel input (J/s) by the fraction of that power that could be recovered in the water jacket at that</span>
<a name="ln-8901"></a><span class="c">!particular part load.</span>
<a name="ln-8902"></a>
<a name="ln-8903"></a>      <span class="n">RecJacHeattoFuelRat</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RecJacHeattoFuelCurve</span><span class="p">,</span> <span class="n">PLR</span><span class="p">)</span>
<a name="ln-8904"></a>      <span class="n">QJacketRec</span> <span class="o">=</span> <span class="n">FuelEnergyUseRate</span> <span class="o">*</span> <span class="n">RecJacHeattoFuelRat</span>
<a name="ln-8905"></a>
<a name="ln-8906"></a><span class="c">!Use Curve fit to determine Heat Recovered Lubricant heat.  This curve calculates the lube heat recovered (J/s) by</span>
<a name="ln-8907"></a><span class="c">!multiplying the total fuel input (J/s) by the fraction of that power that could be recovered in the lube oil at that</span>
<a name="ln-8908"></a><span class="c">!particular part load.</span>
<a name="ln-8909"></a>      <span class="n">RecLubeHeattoFuelRat</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RecLubeHeattoFuelCurve</span><span class="p">,</span> <span class="n">PLR</span><span class="p">)</span>
<a name="ln-8910"></a>      <span class="n">QLubeOilRec</span> <span class="o">=</span> <span class="n">FuelEnergyUseRate</span> <span class="o">*</span> <span class="n">RecLubeHeattoFuelRat</span>
<a name="ln-8911"></a>
<a name="ln-8912"></a><span class="c">!Use Curve fit to determine Heat Recovered from the exhaust.  This curve calculates the  heat recovered (J/s) by</span>
<a name="ln-8913"></a><span class="c">!multiplying the total fuel input (J/s) by the fraction of that power that could be recovered in the exhaust at that</span>
<a name="ln-8914"></a><span class="c">!particular part load.</span>
<a name="ln-8915"></a>      <span class="n">TotExhausttoFuelRat</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">TotExhausttoFuelCurve</span><span class="p">,</span> <span class="n">PLR</span><span class="p">)</span>
<a name="ln-8916"></a>      <span class="n">QExhaustTotal</span> <span class="o">=</span> <span class="n">FuelEnergyUseRate</span> <span class="o">*</span> <span class="n">TotExhausttoFuelRat</span>
<a name="ln-8917"></a>
<a name="ln-8918"></a>
<a name="ln-8919"></a><span class="c">!Use Curve fit to determine Exhaust Temperature in C.  The temperature is simply a curve fit</span>
<a name="ln-8920"></a><span class="c">!of the exhaust temperature in C to the part load ratio.</span>
<a name="ln-8921"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PLR</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8922"></a><span class="k">      </span><span class="n">ExhaustTemp</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustTempCurve</span><span class="p">,</span> <span class="n">PLR</span><span class="p">)</span>
<a name="ln-8923"></a>
<a name="ln-8924"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ExhaustTemp</span> <span class="o">&gt;</span> <span class="n">ReferenceTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8925"></a>
<a name="ln-8926"></a><span class="k">        </span><span class="n">ExhaustGasFlow</span> <span class="o">=</span> <span class="n">QExhaustTotal</span> <span class="o">/</span> <span class="p">(</span><span class="n">ExhaustCP</span><span class="o">*</span><span class="p">(</span><span class="n">ExhaustTemp</span><span class="o">-</span><span class="n">ReferenceTemp</span><span class="p">))</span>
<a name="ln-8927"></a>
<a name="ln-8928"></a>        <span class="c">!Use Curve fit to determine stack temp after heat recovery</span>
<a name="ln-8929"></a>        <span class="n">UA</span> <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">UACoef</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">RatedPowerOutput</span> <span class="o">**</span>  <span class="p">&amp;</span>
<a name="ln-8930"></a>                     <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">UACoef</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-8931"></a>
<a name="ln-8932"></a>        <span class="n">DesignMinExitGasTemp</span> <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignMinExitGasTemp</span>
<a name="ln-8933"></a>
<a name="ln-8934"></a>        <span class="n">ExhaustStackTemp</span> <span class="o">=</span> <span class="n">DesignMinExitGasTemp</span> <span class="o">+</span> <span class="p">(</span><span class="n">ExhaustTemp</span> <span class="o">-</span> <span class="n">DesignMinExitGasTemp</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-8935"></a>                           <span class="nb">EXP</span><span class="p">(</span><span class="n">UA</span><span class="o">/</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="n">ExhaustGasFlow</span><span class="p">,</span> <span class="n">MaxExhaustperPowerOutput</span> <span class="o">*</span> <span class="n">RatedPowerOutput</span><span class="p">)</span> <span class="o">*</span> <span class="n">ExhaustCP</span><span class="p">))</span>
<a name="ln-8936"></a>
<a name="ln-8937"></a>        <span class="n">QExhaustRec</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ExhaustGasFlow</span><span class="o">*</span><span class="n">ExhaustCP</span><span class="o">*</span><span class="p">(</span><span class="n">ExhaustTemp</span><span class="o">-</span><span class="n">ExhaustStackTemp</span><span class="p">),</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-8938"></a>      <span class="k">ELSE</span>
<a name="ln-8939"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ErrExhaustTempIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8940"></a><span class="k">          CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;CalcICEngineGeneratorModel: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">TypeOf</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8941"></a>              <span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; low Exhaust Temperature from Curve Value&#39;</span><span class="p">)</span>
<a name="ln-8942"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...curve generated temperature=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ExhaustTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8943"></a>              <span class="s1">&#39; C], PLR=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PLR</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-8944"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...simulation will continue with exhaust heat reclaim set to 0.&#39;</span><span class="p">)</span>
<a name="ln-8945"></a>        <span class="n">ENDIF</span>
<a name="ln-8946"></a>        <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcICEngineGeneratorModel: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">TypeOf</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8947"></a>          <span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; low Exhaust Temperature continues...&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-8948"></a>          <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ErrExhaustTempIndex</span><span class="p">,</span><span class="n">ReportMinOf</span><span class="o">=</span><span class="n">ExhaustTemp</span><span class="p">,</span><span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">ExhaustTemp</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-8949"></a>          <span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;[C]&#39;</span><span class="p">,</span><span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;[C]&#39;</span><span class="p">)</span>
<a name="ln-8950"></a>        <span class="n">QExhaustRec</span> <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-8951"></a>        <span class="n">ExhaustStackTemp</span> <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignMinExitGasTemp</span>
<a name="ln-8952"></a>      <span class="n">ENDIF</span>
<a name="ln-8953"></a>    <span class="k">ELSE</span>
<a name="ln-8954"></a><span class="k">      </span><span class="n">QExhaustRec</span> <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-8955"></a>    <span class="k">END IF</span>
<a name="ln-8956"></a>
<a name="ln-8957"></a>
<a name="ln-8958"></a><span class="k">  </span><span class="n">QTotalHeatRecovered</span> <span class="o">=</span> <span class="n">QExhaustRec</span> <span class="o">+</span> <span class="n">QLubeOilRec</span> <span class="o">+</span> <span class="n">QJacketRec</span>
<a name="ln-8959"></a>
<a name="ln-8960"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8961"></a><span class="k">    CALL </span><span class="n">CalcICEngineGenHeatRecovery</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span><span class="n">QTotalHeatRecovered</span><span class="p">,</span><span class="n">HeatRecMDot</span><span class="p">,</span><span class="n">HRecRatio</span><span class="p">)</span>
<a name="ln-8962"></a>    <span class="n">QExhaustRec</span> <span class="o">=</span> <span class="n">QExhaustRec</span><span class="o">*</span><span class="n">HRecRatio</span>
<a name="ln-8963"></a>    <span class="n">QLubeOilRec</span> <span class="o">=</span> <span class="n">QLubeOilRec</span><span class="o">*</span><span class="n">HRecRatio</span>
<a name="ln-8964"></a>    <span class="n">QJacketRec</span>  <span class="o">=</span> <span class="n">QJacketRec</span><span class="o">*</span><span class="n">HRecRatio</span>
<a name="ln-8965"></a>    <span class="n">QTotalHeatRecovered</span> <span class="o">=</span> <span class="n">QTotalHeatRecovered</span><span class="o">*</span><span class="n">HRecRatio</span>
<a name="ln-8966"></a>  <span class="k">ELSE</span>
<a name="ln-8967"></a><span class="k">    </span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span>    <span class="o">=</span> <span class="n">HeatRecInTemp</span>
<a name="ln-8968"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span>   <span class="o">=</span> <span class="n">HeatRecInTemp</span>
<a name="ln-8969"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMdotActual</span> <span class="o">=</span> <span class="n">HeatRecMdot</span>
<a name="ln-8970"></a>
<a name="ln-8971"></a>  <span class="n">ENDIF</span>
<a name="ln-8972"></a>
<a name="ln-8973"></a>      <span class="c">!Calculate Energy</span>
<a name="ln-8974"></a>   <span class="n">ElectricEnergyGen</span>    <span class="o">=</span> <span class="n">ElecPowerGenerated</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-8975"></a>   <span class="n">FuelEnergyUsed</span>       <span class="o">=</span> <span class="n">FuelEnergyUseRate</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-8976"></a>   <span class="n">JacketEnergyRec</span>      <span class="o">=</span> <span class="n">QJacketRec</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-8977"></a>   <span class="n">LubeOilEnergyRec</span>     <span class="o">=</span> <span class="n">QLubeOilRec</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-8978"></a>   <span class="n">ExhaustEnergyRec</span>     <span class="o">=</span> <span class="n">QExhaustRec</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-8979"></a>
<a name="ln-8980"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecPowerGenerated</span>  <span class="o">=</span> <span class="n">ElecPowerGenerated</span>
<a name="ln-8981"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecEnergyGenerated</span> <span class="o">=</span> <span class="n">ElectricEnergyGen</span>
<a name="ln-8982"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QJacketRecovered</span>    <span class="o">=</span> <span class="n">QJacketRec</span>
<a name="ln-8983"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QLubeOilRecovered</span>   <span class="o">=</span> <span class="n">QLubeOilRec</span>
<a name="ln-8984"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QExhaustRecovered</span>   <span class="o">=</span> <span class="n">QExhaustRec</span>
<a name="ln-8985"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QTotalHeatRecovered</span> <span class="o">=</span> <span class="n">QTotalHeatRecovered</span>
<a name="ln-8986"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">JacketEnergyRec</span>     <span class="o">=</span> <span class="n">JacketEnergyRec</span>
<a name="ln-8987"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">LubeOilEnergyRec</span>    <span class="o">=</span> <span class="n">LubeOilEnergyRec</span>
<a name="ln-8988"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustEnergyRec</span>    <span class="o">=</span> <span class="n">ExhaustEnergyRec</span>
<a name="ln-8989"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QTotalHeatRecovered</span> <span class="o">=</span> <span class="p">(</span><span class="n">QExhaustRec</span> <span class="o">+</span> <span class="n">QLubeOilRec</span> <span class="o">+</span> <span class="n">QJacketRec</span><span class="p">)</span>
<a name="ln-8990"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">TotalHeatEnergyRec</span> <span class="o">=</span> <span class="p">(</span><span class="n">ExhaustEnergyRec</span> <span class="o">+</span> <span class="n">LubeOilEnergyRec</span> <span class="o">+</span> <span class="n">JacketEnergyRec</span><span class="p">)</span>
<a name="ln-8991"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergyUseRate</span>   <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">FuelEnergyUseRate</span><span class="p">)</span>
<a name="ln-8992"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergy</span>          <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">FuelEnergyUsed</span><span class="p">)</span>
<a name="ln-8993"></a>
<a name="ln-8994"></a>  <span class="n">FuelHeatingValue</span> <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelHeatingValue</span>
<a name="ln-8995"></a>
<a name="ln-8996"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelMdot</span>      <span class="o">=</span>  <span class="nb">ABS</span><span class="p">(</span><span class="n">FuelEnergyUseRate</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">FuelHeatingValue</span> <span class="o">*</span> <span class="n">KJtoJ</span><span class="p">)</span>
<a name="ln-8997"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustStackTemp</span>    <span class="o">=</span> <span class="n">ExhaustStackTemp</span>
<a name="ln-8998"></a>
<a name="ln-8999"></a>
<a name="ln-9000"></a>
<a name="ln-9001"></a>
<a name="ln-9002"></a><span class="k">RETURN</span>
<a name="ln-9003"></a><span class="k">END SUBROUTINE </span><span class="n">CalcICEngineGeneratorModel</span>
<a name="ln-9004"></a>
<a name="ln-9005"></a><span class="k">SUBROUTINE </span><span class="n">CalcICEngineGenHeatRecovery</span><span class="p">(</span><span class="n">Num</span><span class="p">,</span><span class="n">EnergyRecovered</span><span class="p">,</span><span class="n">HeatRecMdot</span><span class="p">,</span><span class="n">HRecRatio</span><span class="p">)</span>
<a name="ln-9006"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9007"></a>            <span class="c">!       AUTHOR:          Brandon Anderson</span>
<a name="ln-9008"></a>            <span class="c">!       DATE WRITTEN:    November 2000</span>
<a name="ln-9009"></a>
<a name="ln-9010"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9011"></a>            <span class="c">! To perform heat recovery calculations and node updates</span>
<a name="ln-9012"></a>
<a name="ln-9013"></a>
<a name="ln-9014"></a>            <span class="c">! METHODOLOGY EMPLOYED: This routine is required for the heat recovery loop.</span>
<a name="ln-9015"></a>            <span class="c">! It works in conjunction with the Heat Recovery Manager, and the PlantWaterHeater.</span>
<a name="ln-9016"></a>            <span class="c">! The chiller sets the flow on the loop first by the input design flowrate and then</span>
<a name="ln-9017"></a>            <span class="c">! performs a check to verify that</span>
<a name="ln-9018"></a>
<a name="ln-9019"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-9020"></a>
<a name="ln-9021"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-9022"></a><span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-9023"></a><span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-9024"></a>
<a name="ln-9025"></a><span class="k">IMPLICIT NONE</span>
<a name="ln-9026"></a>
<a name="ln-9027"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9028"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">Num</span>              <span class="c">! HR Component number</span>
<a name="ln-9029"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">EnergyRecovered</span>  <span class="c">! Amount of heat recovered</span>
<a name="ln-9030"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">HeatRecMdot</span>
<a name="ln-9031"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">HRecRatio</span>        <span class="c">! Max Heat recovery ratio</span>
<a name="ln-9032"></a>
<a name="ln-9033"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9034"></a>          <span class="c">! na</span>
<a name="ln-9035"></a>
<a name="ln-9036"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9037"></a>          <span class="c">! na</span>
<a name="ln-9038"></a>
<a name="ln-9039"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9040"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">HeatRecInNode</span>
<a name="ln-9041"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">HeatRecOutNode</span>
<a name="ln-9042"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">MinHeatRecMdot</span>
<a name="ln-9043"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">HeatRecInTemp</span>
<a name="ln-9044"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">HeatRecOutTemp</span>
<a name="ln-9045"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">HeatRecCp</span>
<a name="ln-9046"></a>
<a name="ln-9047"></a>  <span class="c">!Load inputs to local structure</span>
<a name="ln-9048"></a>  <span class="n">HeatRecInNode</span> <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>
<a name="ln-9049"></a>  <span class="n">HeatRecOutNode</span> <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>
<a name="ln-9050"></a>
<a name="ln-9051"></a>
<a name="ln-9052"></a>  <span class="c">!Need to set the HeatRecRatio to 1.0 if it is not modified</span>
<a name="ln-9053"></a>  <span class="n">HRecRatio</span><span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9054"></a>
<a name="ln-9055"></a>
<a name="ln-9056"></a>  <span class="n">HeatRecInTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-9057"></a>  <span class="n">HeatRecCp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9058"></a>                                 <span class="n">HeatRecInTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9059"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9060"></a>                                 <span class="s1">&#39;CalcICEngineGeneratorModel&#39;</span><span class="p">)</span>
<a name="ln-9061"></a>
<a name="ln-9062"></a>  <span class="c">!Don&#39;t divide by zero - Note This also results in no heat recovery when</span>
<a name="ln-9063"></a>  <span class="c">!  design Mdot for Heat Recovery - Specified on Chiller Input - is zero</span>
<a name="ln-9064"></a>  <span class="c">!  In order to see what minimum heat recovery flow rate is for the design temperature</span>
<a name="ln-9065"></a>  <span class="c">!  The design heat recovery flow rate can be set very small, but greater than zero.</span>
<a name="ln-9066"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">HeatRecMdot</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">HeatRecCp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9067"></a><span class="k">    </span><span class="n">HeatRecOutTemp</span> <span class="o">=</span> <span class="p">(</span><span class="n">EnergyRecovered</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">HeatRecMdot</span> <span class="o">*</span> <span class="n">HeatRecCp</span><span class="p">)</span> <span class="o">+</span> <span class="n">HeatRecInTemp</span>
<a name="ln-9068"></a>  <span class="k">ELSE</span>
<a name="ln-9069"></a><span class="k">    </span><span class="n">HeatRecOutTemp</span> <span class="o">=</span> <span class="n">HeatRecInTemp</span>
<a name="ln-9070"></a>  <span class="k">END IF</span>
<a name="ln-9071"></a>
<a name="ln-9072"></a>
<a name="ln-9073"></a>    <span class="c">!Note: check to make sure the Max Temperature was not exceeded</span>
<a name="ln-9074"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">HeatRecOutTemp</span> <span class="o">&gt;</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecMaxTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9075"></a><span class="k">    IF</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecMaxTemp</span> <span class="o">/=</span> <span class="n">HeatRecInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9076"></a><span class="k">      </span><span class="n">MinHeatRecMdot</span> <span class="o">=</span> <span class="p">(</span><span class="n">EnergyRecovered</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">HeatRecCp</span> <span class="o">*</span> <span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecMaxTemp</span> <span class="o">-</span> <span class="n">HeatRecInTemp</span><span class="p">))</span>
<a name="ln-9077"></a>      <span class="k">If</span><span class="p">(</span><span class="n">MinHeatRecMdot</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">MinHeatRecMdot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9078"></a>    <span class="k">ELSE</span>
<a name="ln-9079"></a><span class="k">      </span><span class="n">MinHeatRecMdot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9080"></a>    <span class="k">END IF</span>
<a name="ln-9081"></a>
<a name="ln-9082"></a>    <span class="c">!Recalculate Outlet Temperature, with adjusted flowrate</span>
<a name="ln-9083"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">MinHeatRecMdot</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">HeatRecCp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9084"></a><span class="k">      </span><span class="n">HeatRecOutTemp</span> <span class="o">=</span> <span class="p">(</span><span class="n">EnergyRecovered</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">MinHeatRecMdot</span> <span class="o">*</span> <span class="n">HeatRecCp</span><span class="p">)</span> <span class="o">+</span> <span class="n">HeatRecInTemp</span>
<a name="ln-9085"></a>      <span class="n">HRecRatio</span> <span class="o">=</span> <span class="n">HeatRecMdot</span><span class="o">/</span><span class="n">MinHeatRecMdot</span>
<a name="ln-9086"></a>    <span class="k">ELSE</span>
<a name="ln-9087"></a><span class="k">      </span><span class="n">HeatRecOutTemp</span> <span class="o">=</span> <span class="n">HeatRecInTemp</span>
<a name="ln-9088"></a>      <span class="n">HRecRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9089"></a>    <span class="k">END IF</span>
<a name="ln-9090"></a>
<a name="ln-9091"></a><span class="k">  END IF</span>
<a name="ln-9092"></a>
<a name="ln-9093"></a>
<a name="ln-9094"></a>  <span class="c">!Update global variables for reporting later</span>
<a name="ln-9095"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span> <span class="o">=</span> <span class="n">HeatRecInTemp</span>
<a name="ln-9096"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span> <span class="o">=</span> <span class="n">HeatRecOutTemp</span>
<a name="ln-9097"></a>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecMdotActual</span> <span class="o">=</span> <span class="n">HeatRecMdot</span>
<a name="ln-9098"></a>
<a name="ln-9099"></a>
<a name="ln-9100"></a>
<a name="ln-9101"></a><span class="k">END SUBROUTINE </span><span class="n">CalcICEngineGenHeatRecovery</span>
<a name="ln-9102"></a>
<a name="ln-9103"></a>
<a name="ln-9104"></a><span class="c">! End IC ENGINE Generator Module Model Subroutines</span>
<a name="ln-9105"></a><span class="c">! *****************************************************************************</span>
<a name="ln-9106"></a>
<a name="ln-9107"></a><span class="c">! Begin IC ENGINE Generator Module Utility Subroutines</span>
<a name="ln-9108"></a><span class="c">! *****************************************************************************</span>
<a name="ln-9109"></a><span class="k">SUBROUTINE </span><span class="n">InitICEngineGenerators</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-9110"></a>
<a name="ln-9111"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9112"></a>          <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-9113"></a>          <span class="c">!       DATE WRITTEN   Oct 2000</span>
<a name="ln-9114"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9115"></a>          <span class="c">!       RE-ENGINEERED  Brent Griffith, Sept 2010, plant upgrades, generalize fluid props</span>
<a name="ln-9116"></a>
<a name="ln-9117"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9118"></a>          <span class="c">! This subroutine is for initializations of the IC ENGINE generators.</span>
<a name="ln-9119"></a>
<a name="ln-9120"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9121"></a>          <span class="c">! Uses the status flags to trigger initializations.</span>
<a name="ln-9122"></a>
<a name="ln-9123"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9124"></a>          <span class="c">! na</span>
<a name="ln-9125"></a>
<a name="ln-9126"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9127"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span>
<a name="ln-9128"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">ScanPlantLoopsForObject</span><span class="p">,</span> <span class="n">TypeOf_Generator_ICEngine</span>
<a name="ln-9129"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span><span class="p">,</span> <span class="n">InitComponentNodes</span>
<a name="ln-9130"></a>
<a name="ln-9131"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9132"></a>
<a name="ln-9133"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9134"></a>  <span class="kt">INTEGER</span><span class="p">,</span>     <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">GeneratorNum</span>    <span class="c">! Generator number</span>
<a name="ln-9135"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>     <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RunFlag</span>         <span class="c">! TRUE when Generator operating</span>
<a name="ln-9136"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MyLoad</span>          <span class="c">! Generator demand</span>
<a name="ln-9137"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>     <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-9138"></a>
<a name="ln-9139"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9140"></a>          <span class="c">! na</span>
<a name="ln-9141"></a>
<a name="ln-9142"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9143"></a>          <span class="c">! na</span>
<a name="ln-9144"></a>
<a name="ln-9145"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9146"></a>          <span class="c">! na</span>
<a name="ln-9147"></a>
<a name="ln-9148"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9149"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HeatRecInletNode</span> <span class="c">! inlet node number in heat recovery loop</span>
<a name="ln-9150"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HeatRecOutletNode</span> <span class="c">! outlet node number in heat recovery loop</span>
<a name="ln-9151"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>           <span class="c">! Initialization flag</span>
<a name="ln-9152"></a>
<a name="ln-9153"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span> <span class="c">! Used for initializations each begin environment flag</span>
<a name="ln-9154"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyPlantScanFlag</span>
<a name="ln-9155"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySizeAndNodeInitFlag</span>
<a name="ln-9156"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">mdot</span>
<a name="ln-9157"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">rho</span>
<a name="ln-9158"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-9159"></a>
<a name="ln-9160"></a>          <span class="c">! FLOW:</span>
<a name="ln-9161"></a><span class="c">! Do the one time initializations</span>
<a name="ln-9162"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9163"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumICEngineGenerators</span><span class="p">))</span>
<a name="ln-9164"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">NumICEngineGenerators</span><span class="p">))</span>
<a name="ln-9165"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MySizeAndNodeInitFlag</span><span class="p">(</span><span class="n">NumICEngineGenerators</span><span class="p">))</span>
<a name="ln-9166"></a>    <span class="n">MyEnvrnFlag</span>           <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9167"></a>    <span class="n">MyPlantScanFlag</span>       <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9168"></a>    <span class="n">MyOneTimeFlag</span>         <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9169"></a>    <span class="n">MySizeAndNodeInitFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9170"></a>  <span class="k">END IF</span>
<a name="ln-9171"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9172"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9173"></a><span class="k">    </span><span class="n">errFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9174"></a>    <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9175"></a>                                 <span class="n">TypeOf_Generator_ICEngine</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9176"></a>                                 <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9177"></a>                                 <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9178"></a>                                 <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9179"></a>                                 <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9180"></a>                                 <span class="n">errFlag</span> <span class="o">=</span> <span class="n">errFlag</span> <span class="p">)</span>
<a name="ln-9181"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9182"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitICEngineGenerators: Program terminated due to previous condition(s).&#39;</span><span class="p">)</span>
<a name="ln-9183"></a>    <span class="n">ENDIF</span>
<a name="ln-9184"></a>
<a name="ln-9185"></a>    <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9186"></a>  <span class="n">ENDIF</span>
<a name="ln-9187"></a>
<a name="ln-9188"></a>
<a name="ln-9189"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MySizeAndNodeInitFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-9190"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9191"></a>
<a name="ln-9192"></a><span class="k">    </span><span class="n">HeatRecInletNode</span>    <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>
<a name="ln-9193"></a>    <span class="n">HeatRecOutletNode</span>   <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>
<a name="ln-9194"></a>
<a name="ln-9195"></a>    <span class="c">!size mass flow rate</span>
<a name="ln-9196"></a>    <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9197"></a>                                     <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9198"></a>                                     <span class="n">PlantLoop</span><span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9199"></a>                                     <span class="s1">&#39;InitICEngineGenerators&#39;</span><span class="p">)</span>
<a name="ln-9200"></a>
<a name="ln-9201"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecVolFlowRate</span>
<a name="ln-9202"></a>    <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMdotDesign</span> <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span>
<a name="ln-9203"></a>
<a name="ln-9204"></a>    <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9205"></a>                                 <span class="n">HeatRecInletNode</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-9206"></a>                                 <span class="n">HeatRecOutletNode</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-9207"></a>                                 <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9208"></a>                                 <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9209"></a>                                 <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9210"></a>                                 <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-9211"></a>
<a name="ln-9212"></a>    <span class="n">MySizeAndNodeInitFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9213"></a>  <span class="k">END IF</span> <span class="c">! end one time inits</span>
<a name="ln-9214"></a>
<a name="ln-9215"></a>  <span class="c">! Do the Begin Environment initializations</span>
<a name="ln-9216"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9217"></a><span class="k">    </span><span class="n">HeatRecInletNode</span>    <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>
<a name="ln-9218"></a>    <span class="n">HeatRecOutletNode</span>   <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>
<a name="ln-9219"></a>    <span class="c">! set the node Temperature, assuming freeze control</span>
<a name="ln-9220"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">0.0d0</span>
<a name="ln-9221"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">0.0d0</span>
<a name="ln-9222"></a>   <span class="c">! set the node max and min mass flow rates</span>
<a name="ln-9223"></a>    <span class="k">Call </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9224"></a>                                 <span class="n">HeatRecInletNode</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-9225"></a>                                 <span class="n">HeatRecOutletNode</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-9226"></a>                                 <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9227"></a>                                 <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9228"></a>                                 <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9229"></a>                                 <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-9230"></a>
<a name="ln-9231"></a>    <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9232"></a>  <span class="k">END IF</span> <span class="c">! end environmental inits</span>
<a name="ln-9233"></a>
<a name="ln-9234"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9235"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9236"></a>  <span class="n">ENDIF</span>
<a name="ln-9237"></a>
<a name="ln-9238"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9239"></a><span class="k">    IF</span> <span class="p">(</span> <span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-9240"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">RunFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9241"></a><span class="k">        </span><span class="n">mdot</span> <span class="o">=</span>  <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span>
<a name="ln-9242"></a>      <span class="k">ELSE</span>
<a name="ln-9243"></a><span class="k">        </span><span class="n">mdot</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-9244"></a>      <span class="n">ENDIF</span>
<a name="ln-9245"></a>      <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdot</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9246"></a>                                   <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9247"></a>                                   <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9248"></a>                                   <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9249"></a>                                   <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9250"></a>                                   <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9251"></a>                                   <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-9252"></a>
<a name="ln-9253"></a>    <span class="k">ELSE</span>
<a name="ln-9254"></a><span class="k">      CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span>   <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMdotActual</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9255"></a>                                   <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9256"></a>                                   <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9257"></a>                                   <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9258"></a>                                   <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9259"></a>                                   <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9260"></a>                                   <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-9261"></a>    <span class="n">ENDIF</span>
<a name="ln-9262"></a>  <span class="n">ENDIF</span>
<a name="ln-9263"></a>
<a name="ln-9264"></a><span class="k">RETURN</span>
<a name="ln-9265"></a><span class="k">END SUBROUTINE </span><span class="n">InitICEngineGenerators</span>
<a name="ln-9266"></a><span class="c">! End IC ENGINE Generator Module Utility Subroutines</span>
<a name="ln-9267"></a><span class="c">! *****************************************************************************</span>
<a name="ln-9268"></a>
<a name="ln-9269"></a>
<a name="ln-9270"></a><span class="c">! Beginning of Record Keeping subroutines for the IC ENGINE Generator Module</span>
<a name="ln-9271"></a><span class="c">! *****************************************************************************</span>
<a name="ln-9272"></a>
<a name="ln-9273"></a><span class="k">SUBROUTINE </span><span class="n">UpdateICEngineGeneratorRecords</span><span class="p">(</span><span class="n">RunFlag</span><span class="p">,</span> <span class="n">Num</span><span class="p">)</span>
<a name="ln-9274"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9275"></a>            <span class="c">!       AUTHOR:          Dan Fisher</span>
<a name="ln-9276"></a>            <span class="c">!       DATE WRITTEN:    October 2000</span>
<a name="ln-9277"></a>
<a name="ln-9278"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9279"></a>            <span class="c">! reporting</span>
<a name="ln-9280"></a>
<a name="ln-9281"></a>
<a name="ln-9282"></a>            <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-9283"></a>
<a name="ln-9284"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-9285"></a>
<a name="ln-9286"></a>            <span class="c">! USE STATEMENTS: na</span>
<a name="ln-9287"></a>
<a name="ln-9288"></a>
<a name="ln-9289"></a><span class="k">IMPLICIT NONE</span>
<a name="ln-9290"></a>
<a name="ln-9291"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9292"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RunFlag</span>   <span class="c">! TRUE if Generator operating</span>
<a name="ln-9293"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">Num</span>       <span class="c">! Generator number</span>
<a name="ln-9294"></a>
<a name="ln-9295"></a>
<a name="ln-9296"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9297"></a>          <span class="c">! na</span>
<a name="ln-9298"></a>
<a name="ln-9299"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9300"></a>          <span class="c">! na</span>
<a name="ln-9301"></a>
<a name="ln-9302"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9303"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">HeatRecInletNode</span>
<a name="ln-9304"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">HeatRecOutletNode</span>
<a name="ln-9305"></a>
<a name="ln-9306"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9307"></a><span class="k">      </span><span class="n">HeatRecInletNode</span>    <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>
<a name="ln-9308"></a>      <span class="n">HeatRecOutletNode</span>   <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>
<a name="ln-9309"></a><span class="c">!      Node(HeatRecOutletNode)%MassFlowRate            = ICEngineGenerator(Num)%HeatRecMdotActual</span>
<a name="ln-9310"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecOutletNode</span><span class="p">)%</span><span class="n">Temp</span>                    <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span>
<a name="ln-9311"></a><span class="c">!      Node(HeatRecOutletNode)%MassFlowRateMaxAvail = Node(HeatRecInletNode)%MassFlowRateMaxAvail</span>
<a name="ln-9312"></a><span class="c">!      Node(HeatRecOutletNode)%MassFlowRateMinAvail = Node(HeatRecInletNode)%MassFlowRateMinAvail</span>
<a name="ln-9313"></a>    <span class="n">ENDIF</span>
<a name="ln-9314"></a>    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">PowerGen</span>             <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecPowerGenerated</span>
<a name="ln-9315"></a>    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QJacketRecovered</span>     <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QJacketRecovered</span>
<a name="ln-9316"></a>    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QLubeOilRecovered</span>    <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QLubeOilRecovered</span>
<a name="ln-9317"></a>    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QExhaustRecovered</span>    <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QExhaustRecovered</span>
<a name="ln-9318"></a>    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QTotalHeatRecovered</span>  <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QTotalHeatRecovered</span>
<a name="ln-9319"></a>    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelEnergyUseRate</span>    <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelEnergyUseRate</span>
<a name="ln-9320"></a>    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">EnergyGen</span>            <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecEnergyGenerated</span>
<a name="ln-9321"></a>    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">JacketEnergyRec</span>      <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">JacketEnergyRec</span>
<a name="ln-9322"></a>    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">LubeOilEnergyRec</span>     <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">LubeOilEnergyRec</span>
<a name="ln-9323"></a>    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustEnergyRec</span>     <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustEnergyRec</span>
<a name="ln-9324"></a>    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">TotalHeatEnergyRec</span>   <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">TotalHeatEnergyRec</span>
<a name="ln-9325"></a>    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelEnergy</span>           <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelEnergy</span>
<a name="ln-9326"></a>    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelMdot</span>             <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelMdot</span>
<a name="ln-9327"></a>    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustStackTemp</span>     <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustStackTemp</span>
<a name="ln-9328"></a>    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span>     <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span>
<a name="ln-9329"></a>    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span>    <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span>
<a name="ln-9330"></a>    <span class="n">ICEngineGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecMdot</span>          <span class="o">=</span> <span class="n">ICEngineGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecMdotActual</span>
<a name="ln-9331"></a>
<a name="ln-9332"></a><span class="k">RETURN</span>
<a name="ln-9333"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateICEngineGeneratorRecords</span>
<a name="ln-9334"></a>
<a name="ln-9335"></a><span class="c">! End of Record Keeping subroutines for the IC ENGINE Generator Module</span>
<a name="ln-9336"></a><span class="c">! *****************************************************************************</span>
<a name="ln-9337"></a>
<a name="ln-9338"></a>
<a name="ln-9339"></a><span class="k">END MODULE </span><span class="n">ICEngineElectricGenerator</span>
<a name="ln-9340"></a>
<a name="ln-9341"></a>
<a name="ln-9342"></a><span class="c">!******************************************************************************************************</span>
<a name="ln-9343"></a><span class="c">!+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>
<a name="ln-9344"></a><span class="c">!******************************************************************************************************</span>
<a name="ln-9345"></a><span class="c">!+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>
<a name="ln-9346"></a>
<a name="ln-9347"></a>
<a name="ln-9348"></a><span class="k">MODULE </span><span class="n">CTElectricGenerator</span>  <span class="c">!COMBUSTION Turbine Generator Module</span>
<a name="ln-9349"></a>
<a name="ln-9350"></a>          <span class="c">! MODULE INFORMATION:</span>
<a name="ln-9351"></a>          <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-9352"></a>          <span class="c">!       DATE WRITTEN   Sept 2000</span>
<a name="ln-9353"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9354"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9355"></a>
<a name="ln-9356"></a>          <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-9357"></a>          <span class="c">! This module simulates the performance of the COMBUSTION turbine</span>
<a name="ln-9358"></a>          <span class="c">! Generators.</span>
<a name="ln-9359"></a>
<a name="ln-9360"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9361"></a>          <span class="c">! Once the Electric power manager determines that the CT Generator</span>
<a name="ln-9362"></a>          <span class="c">! is available, it calls SimCTGenerator which in turn calls the</span>
<a name="ln-9363"></a>          <span class="c">! appropriate COMBUSTION turbine Generator model.</span>
<a name="ln-9364"></a>          <span class="c">! All CT Generator models are based on a polynomial fit of Generator</span>
<a name="ln-9365"></a>          <span class="c">! performance data.</span>
<a name="ln-9366"></a>
<a name="ln-9367"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-9368"></a>
<a name="ln-9369"></a>          <span class="c">! OTHER NOTES:</span>
<a name="ln-9370"></a>
<a name="ln-9371"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9372"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-9373"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-9374"></a><span class="k">USE </span><span class="n">DataGlobals</span> <span class="p">,</span>   <span class="n">ONLY</span> <span class="p">:</span> <span class="n">MaxNameLength</span><span class="p">,</span> <span class="n">NumOfTimeStepInHour</span><span class="p">,</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="n">BeginEnvrnFlag</span><span class="p">,</span> <span class="n">InitConvTemp</span>
<a name="ln-9375"></a><span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowFatalError</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9376"></a>                           <span class="n">ShowContinueError</span><span class="p">,</span> <span class="n">SetupOutputVariable</span>
<a name="ln-9377"></a><span class="k">USE </span><span class="n">DataGlobalConstants</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">iGeneratorCombTurbine</span>
<a name="ln-9378"></a>
<a name="ln-9379"></a>
<a name="ln-9380"></a><span class="k">IMPLICIT NONE</span>
<a name="ln-9381"></a>
<a name="ln-9382"></a><span class="k">PRIVATE</span>
<a name="ln-9383"></a>          <span class="c">! MODULE PARAMETER DEFINITIONS:</span>
<a name="ln-9384"></a>          <span class="c">! na</span>
<a name="ln-9385"></a>
<a name="ln-9386"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9387"></a><span class="k">TYPE </span><span class="n">CTGeneratorSpecs</span>
<a name="ln-9388"></a>       <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>           <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! user identifier</span>
<a name="ln-9389"></a>       <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TypeOf</span>         <span class="o">=</span> <span class="s1">&#39;Generator:CombustionTurbine&#39;</span> <span class="c">! Type of Generator</span>
<a name="ln-9390"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">CompType_Num</span>              <span class="o">=</span> <span class="n">iGeneratorCombTurbine</span>
<a name="ln-9391"></a>       <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FuelType</span>             <span class="c">! Type of Fuel - DIESEL, GASOLINE, GAS</span>
<a name="ln-9392"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">RatedPowerOutput</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! W - design nominal capacity of Generator</span>
<a name="ln-9393"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ElectricCircuitNode</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Electric Circuit Node</span>
<a name="ln-9394"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">MinPartLoadRat</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! (CT MIN) min allowed operating frac full load</span>
<a name="ln-9395"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">MaxPartLoadRat</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! (CT MAX) max allowed operating frac full load</span>
<a name="ln-9396"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">OptPartLoadRat</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! (CT BEST) optimal operating frac full load</span>
<a name="ln-9397"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">FuelEnergyUseRate</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!(EFUEL) rate of Fuel Energy Required to run COMBUSTION turbine (W)</span>
<a name="ln-9398"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">FuelEnergy</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Amount of Fuel Energy Required to run COMBUSTION turbine (J)</span>
<a name="ln-9399"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">PLBasedFuelInputCurve</span>     <span class="o">=</span> <span class="mi">0</span>   <span class="c">!(FUL1GC) Curve Index for Part Load Ratio Based Fuel Input</span>
<a name="ln-9400"></a>                                                            <span class="c">! Coefficients Poly Fit</span>
<a name="ln-9401"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">TempBasedFuelInputCurve</span>   <span class="o">=</span> <span class="mi">0</span>   <span class="c">!(FUL2GC) Curve Index for Ambient Temperature Based Fuel Input</span>
<a name="ln-9402"></a>                                                            <span class="c">! Coeff Poly Fit</span>
<a name="ln-9403"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ExhaustFlow</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!(FEX) Exhaust Gas Flow Rate cubic meters per second???</span>
<a name="ln-9404"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ExhaustFlowCurve</span>          <span class="o">=</span> <span class="mi">0</span>   <span class="c">!(FEXGC) Curve Index for Exhaust Gas Flow Rate Input Coef Poly Fit</span>
<a name="ln-9405"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ExhaustTemp</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!(TEX) Exhaust Gas Temperature in C</span>
<a name="ln-9406"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">PLBasedExhaustTempCurve</span>   <span class="o">=</span> <span class="mi">0</span>   <span class="c">!(TEX1GC) Curve Index for Part Load Ratio Based Exhaust Temp Input</span>
<a name="ln-9407"></a>                                                            <span class="c">! Coeffs Poly Fit</span>
<a name="ln-9408"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">TempBasedExhaustTempCurve</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c">!(TEX2GC) Curve Index for Ambient Temperature Based Exhaust Gas Temp to</span>
<a name="ln-9409"></a>                                                            <span class="c">! Fuel Energy Input Coeffs Poly Fit</span>
<a name="ln-9410"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">QLubeOilRecovered</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!(ELUBE) Recovered Lube Oil Energy (W)</span>
<a name="ln-9411"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">QExhaustRecovered</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!(EEX) Recovered Exhaust heat  (W)</span>
<a name="ln-9412"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">QTotalHeatRecovered</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!total heat recovered (W)</span>
<a name="ln-9413"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">LubeOilEnergyRec</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Recovered Lube Oil Energy (J)</span>
<a name="ln-9414"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ExhaustEnergyRec</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Recovered Exhaust heat  (J)</span>
<a name="ln-9415"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">TotalHeatEnergyRec</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!total heat recovered (J)</span>
<a name="ln-9416"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">QLubeOilRecoveredCurve</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">!(ELUBEGC) Curve Index for Recoverable Lube Oil heat Input Coef Poly Fit</span>
<a name="ln-9417"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">UA</span>                        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!(UACGC) exhaust gas Heat Exchanger UA</span>
<a name="ln-9418"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UACoef</span>                    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Heat Exchanger UA  Coeffs Poly Fit</span>
<a name="ln-9419"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">MaxExhaustperCTPower</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!MAX EXHAUST FLOW PER W POWER OUTPUT COEFF</span>
<a name="ln-9420"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">DesignHeatRecVolFlowRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! m3/s, Design Water mass flow rate through heat recovery loop</span>
<a name="ln-9421"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">DesignHeatRecMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! kg/s, Design Water mass flow rate through heat recovery loop</span>
<a name="ln-9422"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">DesignMinExitGasTemp</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Steam Saturation Temperature (C)</span>
<a name="ln-9423"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">DesignAirInletTemp</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Design Turbine Air Inlet Temperature (C)</span>
<a name="ln-9424"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ExhaustStackTemp</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!turbine exhaust gas temp (C)</span>
<a name="ln-9425"></a>       <span class="kt">LOGICAL</span>           <span class="kd">::</span> <span class="n">HeatRecActive</span>             <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! true when design max flow rate &gt; 0</span>
<a name="ln-9426"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">HeatRecInletNodeNum</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Node number on the heat recovery inlet side of the condenser</span>
<a name="ln-9427"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">HeatRecOutletNodeNum</span>      <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Node number on the heat recovery outlet side of the condenser</span>
<a name="ln-9428"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HeatRecInletTemp</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Inlet Temperature of the heat recovery fluid</span>
<a name="ln-9429"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HeatRecOutletTemp</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Outlet Temperature of the heat recovery fluid</span>
<a name="ln-9430"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HeatRecMdot</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Heat Recovery Loop Mass flow rate</span>
<a name="ln-9431"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">HRLoopNum</span>                 <span class="o">=</span> <span class="mi">0</span>   <span class="c">! cooling water plant loop index number, for heat recovery</span>
<a name="ln-9432"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">HRLoopSideNum</span>             <span class="o">=</span> <span class="mi">0</span>   <span class="c">! cooling water plant loop side index, for heat recovery</span>
<a name="ln-9433"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">HRBranchNum</span>               <span class="o">=</span> <span class="mi">0</span>   <span class="c">! cooling water plant loop branch index, for heat recovery</span>
<a name="ln-9434"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">HRCompNum</span>                 <span class="o">=</span> <span class="mi">0</span>   <span class="c">! cooling water plant loop component index, for heat recovery</span>
<a name="ln-9435"></a>
<a name="ln-9436"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">FuelMdot</span>                  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Fuel Amount used (kg/s)</span>
<a name="ln-9437"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">FuelHeatingValue</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Heating Value for Fuel in (kJ/kg)</span>
<a name="ln-9438"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ElecPowerGenerated</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: power generated (W)</span>
<a name="ln-9439"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ElecEnergyGenerated</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: power generated (W)</span>
<a name="ln-9440"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HeatRecMaxTemp</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Max Temp that can be produced in heat recovery</span>
<a name="ln-9441"></a>       <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">OAInletNode</span>               <span class="o">=</span> <span class="mi">0</span>   <span class="c">! optional inlet node index pointer for outdoor air for compustion</span>
<a name="ln-9442"></a><span class="k">END TYPE </span><span class="n">CTGeneratorSpecs</span>
<a name="ln-9443"></a>
<a name="ln-9444"></a><span class="k">TYPE </span><span class="n">ReportVars</span>
<a name="ln-9445"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PowerGen</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: power (W)</span>
<a name="ln-9446"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EnergyGen</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: power (W)</span>
<a name="ln-9447"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QTotalHeatRecovered</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: total Heat Recovered (W)</span>
<a name="ln-9448"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QLubeOilRecovered</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Heat Recovered from Lubricant (W)</span>
<a name="ln-9449"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QExhaustRecovered</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Heat Recovered from exhaust (W)</span>
<a name="ln-9450"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotalHeatEnergyRec</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: total Heat Recovered (W)</span>
<a name="ln-9451"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LubeOilEnergyRec</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Heat Recovered from Lubricant (W)</span>
<a name="ln-9452"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ExhaustEnergyRec</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Heat Recovered from exhaust (W)</span>
<a name="ln-9453"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FuelEnergyUseRate</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Fuel Energy use rate (W)</span>
<a name="ln-9454"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FuelEnergy</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Fuel Energy used (J)</span>
<a name="ln-9455"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FuelMdot</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Fuel Amount used (kg/s)</span>
<a name="ln-9456"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ExhaustStackTemp</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Exhaust Stack Temperature (C)</span>
<a name="ln-9457"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecInletTemp</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Heat Recovery Loop Inlet Temperature (C)</span>
<a name="ln-9458"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecOutletTemp</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Heat Recovery Loop Outlet Temperature (C)</span>
<a name="ln-9459"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecMdot</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! reporting: Heat Recovery Loop Mass flow rate (kg/s)</span>
<a name="ln-9460"></a><span class="k">END TYPE </span><span class="n">ReportVars</span>
<a name="ln-9461"></a>
<a name="ln-9462"></a>
<a name="ln-9463"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-9464"></a><span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">NumCTGenerators</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c">! number of CT Generators specified in input</span>
<a name="ln-9465"></a><span class="kt">LOGICAL</span>           <span class="kd">::</span> <span class="n">GetCTInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="c">! then TRUE, calls subroutine to read input file.</span>
<a name="ln-9466"></a>
<a name="ln-9467"></a><span class="k">TYPE</span><span class="p">(</span><span class="n">CTGeneratorSpecs</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CTGenerator</span>  <span class="c">!dimension to number of machines</span>
<a name="ln-9468"></a><span class="k">TYPE</span><span class="p">(</span><span class="n">ReportVars</span><span class="p">),</span>       <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CTGeneratorReport</span>
<a name="ln-9469"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckEquipName</span>
<a name="ln-9470"></a>
<a name="ln-9471"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE PrimaryPlantLoops</span>
<a name="ln-9472"></a><span class="k">PRIVATE    </span><span class="n">CalcCTGeneratorModel</span>
<a name="ln-9473"></a><span class="k">PRIVATE    </span><span class="n">GetCTGeneratorInput</span>
<a name="ln-9474"></a><span class="k">PRIVATE    </span><span class="n">UpdateCTGeneratorRecords</span>
<a name="ln-9475"></a><span class="k">PUBLIC     </span><span class="n">SimCTGenerator</span>
<a name="ln-9476"></a><span class="k">PUBLIC     </span><span class="n">GetCTGeneratorResults</span>
<a name="ln-9477"></a><span class="k">PUBLIC     </span><span class="n">SimCTPlantHeatRecovery</span>
<a name="ln-9478"></a>
<a name="ln-9479"></a><span class="k">CONTAINS</span>
<a name="ln-9480"></a>          <span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-9481"></a><span class="c">! Beginning of CT Generator Module Driver Subroutines</span>
<a name="ln-9482"></a><span class="c">!*************************************************************************</span>
<a name="ln-9483"></a>
<a name="ln-9484"></a><span class="k">SUBROUTINE </span><span class="n">SimCTGenerator</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span><span class="n">GeneratorName</span><span class="p">,</span><span class="n">GeneratorIndex</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-9485"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9486"></a>          <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-9487"></a>          <span class="c">!       DATE WRITTEN   Sept. 2000</span>
<a name="ln-9488"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9489"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9490"></a>
<a name="ln-9491"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE: This is the CT Generator driver.  It</span>
<a name="ln-9492"></a>               <span class="c">! gets the input for the models, initializes simulation variables, call</span>
<a name="ln-9493"></a>               <span class="c">! the appropriate model and sets up reporting variables.</span>
<a name="ln-9494"></a>
<a name="ln-9495"></a>          <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-9496"></a>
<a name="ln-9497"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-9498"></a>
<a name="ln-9499"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9500"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-9501"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-9502"></a>
<a name="ln-9503"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-9504"></a>
<a name="ln-9505"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9506"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorType</span>     <span class="c">! type of Generator</span>
<a name="ln-9507"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorName</span>     <span class="c">! user specified name of Generator</span>
<a name="ln-9508"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorIndex</span>
<a name="ln-9509"></a>  <span class="kt">LOGICAL</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">RunFlag</span>                 <span class="c">! simulate Generator when TRUE</span>
<a name="ln-9510"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">MyLoad</span>                  <span class="c">! generator demand</span>
<a name="ln-9511"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-9512"></a>
<a name="ln-9513"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9514"></a>          <span class="c">! na</span>
<a name="ln-9515"></a>
<a name="ln-9516"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9517"></a>          <span class="c">! na</span>
<a name="ln-9518"></a>
<a name="ln-9519"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9520"></a>          <span class="c">! na</span>
<a name="ln-9521"></a>
<a name="ln-9522"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9523"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">GenNum</span>         <span class="c">! Generator number counter</span>
<a name="ln-9524"></a>
<a name="ln-9525"></a>
<a name="ln-9526"></a>          <span class="c">!Get Generator data from input file</span>
<a name="ln-9527"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCTInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9528"></a><span class="k">    CALL </span><span class="n">GetCTGeneratorInput</span>
<a name="ln-9529"></a>    <span class="n">GetCTInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9530"></a>  <span class="k">END IF</span>
<a name="ln-9531"></a>
<a name="ln-9532"></a>
<a name="ln-9533"></a>
<a name="ln-9534"></a>        <span class="c">!SELECT and CALL MODELS</span>
<a name="ln-9535"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GeneratorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9536"></a><span class="k">    </span><span class="n">GenNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumCTGenerators</span><span class="p">)</span>
<a name="ln-9537"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GenNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimCTGenerator: Specified Generator not one of Valid COMBUSTION Turbine Generators &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9538"></a>                                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">))</span>
<a name="ln-9539"></a>    <span class="n">GeneratorIndex</span><span class="o">=</span><span class="n">GenNum</span>
<a name="ln-9540"></a>  <span class="k">ELSE</span>
<a name="ln-9541"></a><span class="k">    </span><span class="n">GenNum</span><span class="o">=</span><span class="n">GeneratorIndex</span>
<a name="ln-9542"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GenNum</span> <span class="o">&gt;</span> <span class="n">NumCTGenerators</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">GenNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9543"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimCTGenerator: Invalid GeneratorIndex passed=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">GenNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9544"></a>                          <span class="s1">&#39;, Number of CT Engine Generators=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumCTGenerators</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9545"></a>                          <span class="s1">&#39;, Generator name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">))</span>
<a name="ln-9546"></a>    <span class="n">ENDIF</span>
<a name="ln-9547"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">GenNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9548"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GeneratorName</span> <span class="o">/=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9549"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimCTGenerator: Invalid GeneratorIndex passed=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">GenNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9550"></a>                            <span class="s1">&#39;, Generator name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Generator Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9551"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9552"></a>      <span class="n">ENDIF</span>
<a name="ln-9553"></a>      <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9554"></a>    <span class="n">ENDIF</span>
<a name="ln-9555"></a>  <span class="n">ENDIF</span>
<a name="ln-9556"></a>
<a name="ln-9557"></a>  <span class="k">CALL </span><span class="n">InitCTGenerators</span><span class="p">(</span><span class="n">GenNum</span><span class="p">,</span><span class="n">Runflag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-9558"></a>  <span class="k">CALL </span><span class="n">CalcCTGeneratorModel</span><span class="p">(</span><span class="n">GenNum</span><span class="p">,</span><span class="n">Runflag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-9559"></a>  <span class="k">CALL </span><span class="n">UpdateCTGeneratorRecords</span><span class="p">(</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">GenNum</span><span class="p">)</span>
<a name="ln-9560"></a>
<a name="ln-9561"></a><span class="k">RETURN</span>
<a name="ln-9562"></a><span class="k">END SUBROUTINE </span><span class="n">SimCTGenerator</span>
<a name="ln-9563"></a><span class="k">SUBROUTINE </span><span class="n">SimCTPlantHeatRecovery</span><span class="p">(</span><span class="n">CompType</span><span class="p">,</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompTypeNum</span><span class="p">,</span><span class="n">CompNum</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">InitLoopEquip</span><span class="p">,</span>  <span class="p">&amp;</span>   <span class="c">!DSU</span>
<a name="ln-9564"></a>                          <span class="n">MyLoad</span><span class="p">,</span><span class="n">MaxCap</span><span class="p">,</span><span class="n">MinCap</span><span class="p">,</span><span class="n">OptCap</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-9565"></a>
<a name="ln-9566"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9567"></a>          <span class="c">!       AUTHOR         BGriffith</span>
<a name="ln-9568"></a>          <span class="c">!       DATE WRITTEN   March 2008</span>
<a name="ln-9569"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9570"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9571"></a>
<a name="ln-9572"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9573"></a>          <span class="c">! Fill data needed in PlantLoopEquipments</span>
<a name="ln-9574"></a>
<a name="ln-9575"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9576"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-9577"></a>
<a name="ln-9578"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9579"></a>          <span class="c">! na</span>
<a name="ln-9580"></a>
<a name="ln-9581"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9582"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-9583"></a>
<a name="ln-9584"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9585"></a>
<a name="ln-9586"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9587"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompType</span> <span class="c">!unused1208</span>
<a name="ln-9588"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompName</span>
<a name="ln-9589"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CompTypeNum</span> <span class="c">!unused1208</span>
<a name="ln-9590"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">CompNum</span>
<a name="ln-9591"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">RunFlag</span>
<a name="ln-9592"></a>  <span class="c">!INTEGER, INTENT(IN)          :: FlowLock !unused1208 !DSU</span>
<a name="ln-9593"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">InitLoopEquip</span>
<a name="ln-9594"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MyLoad</span>
<a name="ln-9595"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">MinCap</span>
<a name="ln-9596"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">MaxCap</span>
<a name="ln-9597"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">OptCap</span>
<a name="ln-9598"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! TRUE if First iteration of simulation</span>
<a name="ln-9599"></a>
<a name="ln-9600"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9601"></a>
<a name="ln-9602"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9603"></a>
<a name="ln-9604"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9605"></a>
<a name="ln-9606"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9607"></a>
<a name="ln-9608"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCTInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9609"></a><span class="k">    CALL </span><span class="n">GetCTGeneratorInput</span>
<a name="ln-9610"></a>    <span class="n">GetCTInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9611"></a>  <span class="k">END IF</span>
<a name="ln-9612"></a>
<a name="ln-9613"></a><span class="k">  If</span> <span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-9614"></a><span class="k">    </span><span class="n">CompNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span> <span class="n">CTGenerator</span><span class="p">%</span><span class="n">name</span><span class="p">,</span> <span class="n">NumCTGenerators</span><span class="p">)</span>
<a name="ln-9615"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">CompNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-9616"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimCTPlantHeatRecovery: CT Generator Unit not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-9617"></a>      <span class="k">RETURN</span>
<a name="ln-9618"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-9619"></a>      <span class="n">MinCap</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9620"></a>      <span class="n">MaxCap</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9621"></a>      <span class="n">OptCap</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9622"></a>      <span class="k">RETURN</span>
<a name="ln-9623"></a><span class="k">  </span><span class="n">ENDIF</span> <span class="c">! End Of InitLoopEquip</span>
<a name="ln-9624"></a>
<a name="ln-9625"></a>  <span class="k">RETURN</span>
<a name="ln-9626"></a>
<a name="ln-9627"></a><span class="k">END SUBROUTINE </span><span class="n">SimCTPlantHeatRecovery</span>
<a name="ln-9628"></a>
<a name="ln-9629"></a>
<a name="ln-9630"></a><span class="c">! End CT Generator Module Driver Subroutines</span>
<a name="ln-9631"></a><span class="c">!******************************************************************************</span>
<a name="ln-9632"></a>
<a name="ln-9633"></a>
<a name="ln-9634"></a><span class="c">! Beginning of CT Generator Module Get Input subroutines</span>
<a name="ln-9635"></a><span class="c">!******************************************************************************</span>
<a name="ln-9636"></a>
<a name="ln-9637"></a>
<a name="ln-9638"></a><span class="k">SUBROUTINE </span><span class="n">GetCTGeneratorInput</span>
<a name="ln-9639"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9640"></a>            <span class="c">!       AUTHOR:          Dan Fisher</span>
<a name="ln-9641"></a>            <span class="c">!       DATE WRITTEN:    April 2000</span>
<a name="ln-9642"></a>
<a name="ln-9643"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9644"></a>            <span class="c">! This routine will get the input</span>
<a name="ln-9645"></a>            <span class="c">! required by the CT Generator models.</span>
<a name="ln-9646"></a>
<a name="ln-9647"></a>
<a name="ln-9648"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9649"></a>            <span class="c">! EnergyPlus input processor</span>
<a name="ln-9650"></a>
<a name="ln-9651"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-9652"></a>
<a name="ln-9653"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-9654"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span>
<a name="ln-9655"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>  <span class="c">! Data for field names, blank numerics</span>
<a name="ln-9656"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>   <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetCurveIndex</span>
<a name="ln-9657"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-9658"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-9659"></a>  <span class="k">USE </span><span class="n">OutAirNodeManager</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">CheckOutAirNodeNumber</span>
<a name="ln-9660"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span>  <span class="n">RoundSigDigits</span>
<a name="ln-9661"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-9662"></a>
<a name="ln-9663"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">!</span>
<a name="ln-9664"></a>
<a name="ln-9665"></a>            <span class="c">! PARAMETERS</span>
<a name="ln-9666"></a>
<a name="ln-9667"></a>            <span class="c">!LOCAL VARIABLES</span>
<a name="ln-9668"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">GeneratorNum</span> <span class="c">!Generator counter</span>
<a name="ln-9669"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumAlphas</span>  <span class="c">! Number of elements in the alpha array</span>
<a name="ln-9670"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumNums</span>    <span class="c">! Number of elements in the numeric array</span>
<a name="ln-9671"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">IOStat</span>     <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-9672"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">AlphArray</span> <span class="c">!character string data</span>
<a name="ln-9673"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>                        <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NumArray</span>  <span class="c">!numeric data</span>
<a name="ln-9674"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>   <span class="c">! error flag</span>
<a name="ln-9675"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsNotOK</span>               <span class="c">! Flag to verify name</span>
<a name="ln-9676"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsBlank</span>               <span class="c">! Flag for blank name</span>
<a name="ln-9677"></a>
<a name="ln-9678"></a>         <span class="c">!FLOW</span>
<a name="ln-9679"></a>
<a name="ln-9680"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Generator:CombustionTurbine&#39;</span>
<a name="ln-9681"></a>  <span class="n">NumCTGenerators</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-9682"></a>
<a name="ln-9683"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumCTGenerators</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9684"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; equipment specified in input file&#39;</span><span class="p">)</span>
<a name="ln-9685"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9686"></a>  <span class="n">ENDIF</span>
<a name="ln-9687"></a>
<a name="ln-9688"></a>         <span class="c">!ALLOCATE ARRAYS</span>
<a name="ln-9689"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">NumCTGenerators</span><span class="p">))</span>
<a name="ln-9690"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">NumCTGenerators</span><span class="p">))</span>
<a name="ln-9691"></a>  <span class="n">CheckEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9692"></a>
<a name="ln-9693"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">NumCTGenerators</span><span class="p">))</span>
<a name="ln-9694"></a>
<a name="ln-9695"></a>         <span class="c">!LOAD ARRAYS WITH CT CURVE FIT Generator DATA</span>
<a name="ln-9696"></a>  <span class="k">DO </span><span class="n">GeneratorNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumCTGenerators</span>
<a name="ln-9697"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">GeneratorNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9698"></a>                    <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9699"></a>                    <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-9700"></a>
<a name="ln-9701"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9702"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9703"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">CTGenerator</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">GeneratorNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-9704"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9705"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9706"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-9707"></a>    <span class="n">ENDIF</span>
<a name="ln-9708"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span>                <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9709"></a>
<a name="ln-9710"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RatedPowerOutput</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9711"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9712"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-9713"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-9714"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9715"></a>    <span class="n">ENDIF</span>
<a name="ln-9716"></a>
<a name="ln-9717"></a>           <span class="c">! Not sure what to do with electric nodes, so do not use optional arguments</span>
<a name="ln-9718"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElectricCircuitNode</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-9719"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-9720"></a>               <span class="n">NodeType_Electric</span><span class="p">,</span><span class="n">NodeConnectionType_Electric</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-9721"></a>
<a name="ln-9722"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MinPartLoadRat</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-9723"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxPartLoadRat</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-9724"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">OptPartLoadRat</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-9725"></a>
<a name="ln-9726"></a>
<a name="ln-9727"></a>    <span class="c">!Load Special CT Generator Input</span>
<a name="ln-9728"></a>
<a name="ln-9729"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PLBasedFuelInputCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-9730"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PLBasedFuelInputCurve</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9731"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-9732"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-9733"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9734"></a>    <span class="k">END IF</span>
<a name="ln-9735"></a>
<a name="ln-9736"></a><span class="k">    </span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">TempBasedFuelInputCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-9737"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">TempBasedFuelInputCurve</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9738"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-9739"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-9740"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9741"></a>    <span class="k">END IF</span>
<a name="ln-9742"></a>
<a name="ln-9743"></a><span class="k">    </span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustFlowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-9744"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustFlowCurve</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9745"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-9746"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-9747"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9748"></a>    <span class="k">END IF</span>
<a name="ln-9749"></a>
<a name="ln-9750"></a><span class="k">    </span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PLBasedExhaustTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-9751"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PLBasedExhaustTempCurve</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9752"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-9753"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-9754"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9755"></a>    <span class="k">END IF</span>
<a name="ln-9756"></a>
<a name="ln-9757"></a><span class="k">    </span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">TempBasedExhaustTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-9758"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">TempBasedExhaustTempCurve</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9759"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-9760"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-9761"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9762"></a>    <span class="k">END IF</span>
<a name="ln-9763"></a>
<a name="ln-9764"></a><span class="k">    </span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QLubeOilRecoveredCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-9765"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QLubeOilRecoveredCurve</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9766"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-9767"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-9768"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9769"></a>    <span class="k">END IF</span>
<a name="ln-9770"></a>
<a name="ln-9771"></a><span class="k">    </span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">UACoef</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-9772"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">UACoef</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-9773"></a>
<a name="ln-9774"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxExhaustperCTPower</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-9775"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignMinExitGasTemp</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-9776"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignAirInletTemp</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-9777"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelHeatingValue</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-9778"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecVolFlowRate</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-9779"></a>
<a name="ln-9780"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9781"></a><span class="k">      </span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9782"></a>      <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-9783"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-9784"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-9785"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9786"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Missing Node Name, Heat Recovery Inlet, for &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9787"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-9788"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9789"></a>      <span class="n">ENDIF</span>
<a name="ln-9790"></a>      <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-9791"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-9792"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-9793"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9794"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Missing Node Name, Heat Recovery Outlet, for &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9795"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-9796"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9797"></a>      <span class="n">ENDIF</span>
<a name="ln-9798"></a>      <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;Heat Recovery Nodes&#39;</span><span class="p">)</span>
<a name="ln-9799"></a>      <span class="k">Call </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-9800"></a>                                 <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecVolFlowRate</span> <span class="p">)</span>
<a name="ln-9801"></a>    <span class="k">ELSE</span>
<a name="ln-9802"></a><span class="k">      </span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9803"></a>      <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9804"></a>      <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9805"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9806"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Since Design Heat Flow Rate = 0.0, Heat Recovery inactive for &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9807"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-9808"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;However, Node names were specified for Heat Recovery inlet or outlet nodes&#39;</span><span class="p">)</span>
<a name="ln-9809"></a>      <span class="n">ENDIF</span>
<a name="ln-9810"></a>    <span class="n">ENDIF</span>
<a name="ln-9811"></a>
<a name="ln-9812"></a>    <span class="c">!Fuel Type Case Statement</span>
<a name="ln-9813"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<a name="ln-9814"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">)</span> <span class="c">!If blank then the default is Natural Gas</span>
<a name="ln-9815"></a>      <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Gas&#39;</span>
<a name="ln-9816"></a>
<a name="ln-9817"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURALGAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURAL GAS&#39;</span><span class="p">)</span>
<a name="ln-9818"></a>      <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Gas&#39;</span>
<a name="ln-9819"></a>
<a name="ln-9820"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DIESEL&#39;</span><span class="p">)</span>
<a name="ln-9821"></a>      <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Diesel&#39;</span>
<a name="ln-9822"></a>
<a name="ln-9823"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GASOLINE&#39;</span><span class="p">)</span>
<a name="ln-9824"></a>      <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Gasoline&#39;</span>
<a name="ln-9825"></a>
<a name="ln-9826"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FUEL OIL #1&#39;</span><span class="p">,</span><span class="s1">&#39;FUELOIL#1&#39;</span><span class="p">,</span><span class="s1">&#39;FUEL OIL&#39;</span><span class="p">,</span><span class="s1">&#39;DISTILLATE OIL&#39;</span><span class="p">)</span>
<a name="ln-9827"></a>       <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;FuelOil#1&#39;</span>
<a name="ln-9828"></a>
<a name="ln-9829"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FUEL OIL #2&#39;</span><span class="p">,</span><span class="s1">&#39;FUELOIL#2&#39;</span><span class="p">,</span><span class="s1">&#39;RESIDUAL OIL&#39;</span><span class="p">)</span>
<a name="ln-9830"></a>       <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;FuelOil#2&#39;</span>
<a name="ln-9831"></a>
<a name="ln-9832"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;PROPANE&#39;</span><span class="p">,</span><span class="s1">&#39;LPG&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANEGAS&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANE GAS&#39;</span><span class="p">)</span>
<a name="ln-9833"></a>       <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Propane&#39;</span>
<a name="ln-9834"></a>
<a name="ln-9835"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHERFUEL1&#39;</span><span class="p">)</span>
<a name="ln-9836"></a>       <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;OtherFuel1&#39;</span>
<a name="ln-9837"></a>
<a name="ln-9838"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHERFUEL2&#39;</span><span class="p">)</span>
<a name="ln-9839"></a>       <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;OtherFuel2&#39;</span>
<a name="ln-9840"></a>
<a name="ln-9841"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-9842"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
<a name="ln-9843"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-9844"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9845"></a>    <span class="k">END SELECT</span>
<a name="ln-9846"></a>
<a name="ln-9847"></a><span class="k">    </span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxTemp</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-9848"></a>
<a name="ln-9849"></a>
<a name="ln-9850"></a>    <span class="c">!begin CR7021</span>
<a name="ln-9851"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9852"></a><span class="k">         </span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">OAInletNode</span>  <span class="o">=</span>  <span class="mi">0</span>
<a name="ln-9853"></a>      <span class="k">ELSE</span>
<a name="ln-9854"></a><span class="k">         </span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">OAInletNode</span>  <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-9855"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-9856"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-9857"></a>         <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">OAInletNode</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9858"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-9859"></a>                          <span class="s1">&#39;&quot; Outdoor Air Inlet Node Name not valid Outdoor Air Node= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>
<a name="ln-9860"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...does not appear in an OutdoorAir:NodeList or as an OutdoorAir:Node.&#39;</span><span class="p">)</span>
<a name="ln-9861"></a>           <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9862"></a>         <span class="n">ENDIF</span>
<a name="ln-9863"></a>
<a name="ln-9864"></a>      <span class="n">ENDIF</span>
<a name="ln-9865"></a>
<a name="ln-9866"></a>
<a name="ln-9867"></a>  <span class="k">END DO</span>
<a name="ln-9868"></a>
<a name="ln-9869"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9870"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in processing input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">))</span>
<a name="ln-9871"></a>  <span class="n">ENDIF</span>
<a name="ln-9872"></a>
<a name="ln-9873"></a>  <span class="k">DO </span><span class="n">GeneratorNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumCTGenerators</span>
<a name="ln-9874"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9875"></a>          <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PowerGen</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-9876"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9877"></a>          <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">EnergyGen</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9878"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ElectricityProduced&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-9879"></a>
<a name="ln-9880"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator &#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9881"></a>          <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergyUseRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-9882"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator &#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9883"></a>          <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9884"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-9885"></a>
<a name="ln-9886"></a><span class="c">!    general fuel use report (to match other generators)</span>
<a name="ln-9887"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel HHV Basis Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9888"></a>          <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergyUseRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-9889"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel HHV Basis Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9890"></a>          <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-9891"></a>
<a name="ln-9892"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator &#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9893"></a>          <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelMdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-9894"></a>
<a name="ln-9895"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Exhaust Air Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9896"></a>          <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustStackTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-9897"></a>
<a name="ln-9898"></a>
<a name="ln-9899"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9900"></a><span class="k">       CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Exhaust Heat Recovery Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9901"></a>            <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QExhaustRecovered</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-9902"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Exhaust Heat Recovery Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9903"></a>            <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustEnergyRec</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9904"></a>                                <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATRECOVERY&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-9905"></a>
<a name="ln-9906"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Lube Heat Recovery Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9907"></a>            <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QLubeOilRecovered</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-9908"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Lube Heat Recovery Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9909"></a>            <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">LubeOilEnergyRec</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9910"></a>                                <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATRECOVERY&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-9911"></a>
<a name="ln-9912"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Thermal Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9913"></a>            <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QTotalHeatRecovered</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-9914"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Thermal Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9915"></a>            <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">TotalHeatEnergyRec</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-9916"></a>
<a name="ln-9917"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Heat Recovery Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9918"></a>            <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-9919"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Heat Recovery Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9920"></a>            <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-9921"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Heat Recovery Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9922"></a>            <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-9923"></a>     <span class="n">ENDIF</span>
<a name="ln-9924"></a>
<a name="ln-9925"></a>  <span class="k">END DO</span>
<a name="ln-9926"></a>
<a name="ln-9927"></a>
<a name="ln-9928"></a>
<a name="ln-9929"></a><span class="k">RETURN</span>
<a name="ln-9930"></a><span class="k">END SUBROUTINE </span><span class="n">GetCTGeneratorInput</span>
<a name="ln-9931"></a>
<a name="ln-9932"></a><span class="c">! End of Get Input subroutines for the CT Generator Module</span>
<a name="ln-9933"></a><span class="c">!******************************************************************************</span>
<a name="ln-9934"></a>
<a name="ln-9935"></a>
<a name="ln-9936"></a><span class="c">! Beginning of Generator model Subroutines</span>
<a name="ln-9937"></a><span class="c">! *****************************************************************************</span>
<a name="ln-9938"></a>
<a name="ln-9939"></a><span class="k">SUBROUTINE </span><span class="n">CalcCTGeneratorModel</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span><span class="n">Runflag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-9940"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9941"></a>          <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-9942"></a>          <span class="c">!       DATE WRITTEN   Sept. 2000</span>
<a name="ln-9943"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9944"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9945"></a>
<a name="ln-9946"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9947"></a>          <span class="c">! simulate a vapor compression Generator using the CT model</span>
<a name="ln-9948"></a>
<a name="ln-9949"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9950"></a>          <span class="c">! curve fit of performance data.  This model was originally</span>
<a name="ln-9951"></a>          <span class="c">! developed by Dale Herron for the BLAST program</span>
<a name="ln-9952"></a>
<a name="ln-9953"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-9954"></a>
<a name="ln-9955"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9956"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">FirstTimeStepSysFlag</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-9957"></a>
<a name="ln-9958"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-9959"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>    <span class="n">ONLY</span> <span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-9960"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-9961"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span> <span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-9962"></a>
<a name="ln-9963"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-9964"></a>
<a name="ln-9965"></a>
<a name="ln-9966"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9967"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MyLoad</span>          <span class="c">! Generator demand</span>
<a name="ln-9968"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">GeneratorNum</span>    <span class="c">! Generator number</span>
<a name="ln-9969"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RunFlag</span>         <span class="c">! TRUE when Generator operating</span>
<a name="ln-9970"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-9971"></a>
<a name="ln-9972"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9973"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">ExhaustCP</span> <span class="o">=</span> <span class="mf">1.047d0</span>    <span class="c">!Exhaust Gas Specific Heat (J/kg-K)</span>
<a name="ln-9974"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">KJtoJ</span> <span class="o">=</span> <span class="mi">100</span><span class="mf">0.d0</span>        <span class="c">!convert Kjoules to joules</span>
<a name="ln-9975"></a>
<a name="ln-9976"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9977"></a>            <span class="c">! INTERFACE</span>
<a name="ln-9978"></a>
<a name="ln-9979"></a>            <span class="c">!  REAL(r64) FUNCTION CurveValue(CurveIndex,Var1,Var2)</span>
<a name="ln-9980"></a>            <span class="c">!</span>
<a name="ln-9981"></a>            <span class="c">!    INTEGER, INTENT (IN)        :: CurveIndex  ! index of curve in curve array</span>
<a name="ln-9982"></a>            <span class="c">!    REAL(r64), INTENT (IN)           :: Var1        ! 1st independent variable</span>
<a name="ln-9983"></a>            <span class="c">!    REAL(r64), INTENT (IN), OPTIONAL :: Var2        ! 2nd independent variable</span>
<a name="ln-9984"></a>            <span class="c">!</span>
<a name="ln-9985"></a>            <span class="c">!  END FUNCTION CurveValue</span>
<a name="ln-9986"></a>            <span class="c">!</span>
<a name="ln-9987"></a>            <span class="c">! END INTERFACE</span>
<a name="ln-9988"></a>
<a name="ln-9989"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9990"></a>          <span class="c">! na</span>
<a name="ln-9991"></a>
<a name="ln-9992"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9993"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">MinPartLoadRat</span>      <span class="c">! min allowed operating frac full load</span>
<a name="ln-9994"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">MaxPartLoadRat</span>      <span class="c">! max allowed operating frac full load</span>
<a name="ln-9995"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">RatedPowerOutput</span>    <span class="c">! Generator nominal capacity (W)</span>
<a name="ln-9996"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ElecPowerGenerated</span>  <span class="c">! Generator output (W)</span>
<a name="ln-9997"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ElectricEnergyGen</span>   <span class="c">! Generator output (J)</span>
<a name="ln-9998"></a>
<a name="ln-9999"></a><span class="c">! Special variables for CT Generator</span>
<a name="ln-10000"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxExhaustperCTPower</span>   <span class="c">!MAX EXHAUST FLOW PER W POWER OUTPUT COEFF</span>
<a name="ln-10001"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PLR</span>                    <span class="c">! Generator operating part load ratio</span>
<a name="ln-10002"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FuelUseRate</span>            <span class="c">!(EFUEL) rate of Fuel Energy Required to run COMBUSTION turbine (W)</span>
<a name="ln-10003"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FuelEnergyUsed</span>         <span class="c">!Amount of Fuel Energy Required to run COMBUSTION turbine (J)</span>
<a name="ln-10004"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ExhaustFlow</span>            <span class="c">!(FEX) Exhaust Gas Flow Rate cubic meters per second???</span>
<a name="ln-10005"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ExhaustTemp</span>            <span class="c">!(TEX) Exhaust Gas Temperature in C</span>
<a name="ln-10006"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UA</span>             <span class="c">!(UACGC) Heat Exchanger UA to Capacity</span>
<a name="ln-10007"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AmbientDeltaT</span>          <span class="c">!(ATAIR) Difference between ambient actual and ambient design temperatures</span>
<a name="ln-10008"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesignAirInletTemp</span>     <span class="c">! design turbine inlet temperature (C)</span>
<a name="ln-10009"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QLubeOilRec</span>          <span class="c">! recovered lube oil heat (W)</span>
<a name="ln-10010"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QExhaustRec</span>          <span class="c">! recovered exhaust heat (W)</span>
<a name="ln-10011"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LubeOilEnergyRec</span>     <span class="c">! recovered lube oil heat (J)</span>
<a name="ln-10012"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ExhaustEnergyRec</span>     <span class="c">! recovered exhaust heat (J)</span>
<a name="ln-10013"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MinHeatRecMdot</span>       <span class="c">! Heat Recovery Flow Rate if minimal heat recovery is accomplished</span>
<a name="ln-10014"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesignMinExitGasTemp</span>     <span class="c">! design engine stact saturated steam temp. (C)</span>
<a name="ln-10015"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ExhaustStackTemp</span>       <span class="c">! turbine stack temp. (C)</span>
<a name="ln-10016"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HeatRecInNode</span>          <span class="c">!Heat Recovery Fluid Inlet Node Num</span>
<a name="ln-10017"></a><span class="c">!notused  INTEGER :: HeatRecOutNode         !Heat Recovery Fluid Outlet Node Num</span>
<a name="ln-10018"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecInTemp</span>          <span class="c">!Heat Recovery Fluid Inlet Temperature (C)</span>
<a name="ln-10019"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecOutTemp</span>         <span class="c">!Heat Recovery Fluid Outlet Temperature (C)</span>
<a name="ln-10020"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecMdot</span>            <span class="c">!Heat Recovery Fluid Mass FlowRate (kg/s)</span>
<a name="ln-10021"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecCp</span>              <span class="c">!Specific Heat of the Heat Recovery Fluid (J/kg-K)</span>
<a name="ln-10022"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FuelHeatingValue</span>       <span class="c">!Heating Value of Fuel in (kJ/kg)</span>
<a name="ln-10023"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HRecRatio</span>              <span class="c">!When Max Temp is reached the amount of recovered heat has to be reduced.</span>
<a name="ln-10024"></a>                                    <span class="c">! and this assumption uses this ratio to accomplish this task.</span>
<a name="ln-10025"></a>
<a name="ln-10026"></a>          <span class="c">!  LOAD LOCAL VARIABLES FROM DATA STRUCTURE (for code readability)</span>
<a name="ln-10027"></a>  <span class="n">MinPartLoadRat</span>       <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MinPartLoadRat</span>
<a name="ln-10028"></a>  <span class="n">MaxPartLoadRat</span>       <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxPartLoadRat</span>
<a name="ln-10029"></a>  <span class="n">RatedPowerOutput</span>     <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RatedPowerOutput</span>
<a name="ln-10030"></a>  <span class="n">MaxExhaustperCTPower</span> <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxExhaustperCTPower</span>
<a name="ln-10031"></a>  <span class="n">DesignAirInletTemp</span>   <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignAirInletTemp</span>
<a name="ln-10032"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10033"></a><span class="k">    </span><span class="n">HeatRecInNode</span>        <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>
<a name="ln-10034"></a>    <span class="n">HeatRecInTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-10035"></a>
<a name="ln-10036"></a>    <span class="n">HeatRecCp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10037"></a>                             <span class="n">HeatRecInTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10038"></a>                             <span class="n">PlantLoop</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10039"></a>                             <span class="s1">&#39;CalcCTGeneratorModel&#39;</span><span class="p">)</span>
<a name="ln-10040"></a>    <span class="k">If</span><span class="p">(</span><span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RunFlag</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-10041"></a><span class="k">       </span><span class="n">HeatRecMdot</span> <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span>
<a name="ln-10042"></a>    <span class="k">Else</span>
<a name="ln-10043"></a><span class="k">       </span><span class="n">HeatRecMdot</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-10044"></a>    <span class="k">End If</span>
<a name="ln-10045"></a><span class="k">  ELSE</span>
<a name="ln-10046"></a><span class="k">    </span><span class="n">HeatRecInTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10047"></a>    <span class="n">HeatRecCp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10048"></a>    <span class="n">HeatRecMdot</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10049"></a>  <span class="n">ENDIF</span>
<a name="ln-10050"></a>
<a name="ln-10051"></a>        <span class="c">!If no loop demand or Generator OFF, return</span>
<a name="ln-10052"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Runflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10053"></a><span class="k">    </span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecPowerGenerated</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10054"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecEnergyGenerated</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10055"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span>    <span class="o">=</span> <span class="n">HeatRecInTemp</span>
<a name="ln-10056"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span>   <span class="o">=</span> <span class="n">HeatRecInTemp</span>
<a name="ln-10057"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMdot</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10058"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QLubeOilRecovered</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10059"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QExhaustRecovered</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10060"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QTotalHeatRecovered</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10061"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">LubeOilEnergyRec</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10062"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustEnergyRec</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10063"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">TotalHeatEnergyRec</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10064"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergyUseRate</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10065"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergy</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10066"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelMdot</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10067"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustStackTemp</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10068"></a>    <span class="k">RETURN</span>
<a name="ln-10069"></a><span class="k">  END IF</span>
<a name="ln-10070"></a>
<a name="ln-10071"></a>
<a name="ln-10072"></a>
<a name="ln-10073"></a>    <span class="c">! CALCULATE POWER GENERATED AND PLR</span>
<a name="ln-10074"></a>  <span class="n">ElecPowerGenerated</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">RatedPowerOutput</span><span class="p">)</span>
<a name="ln-10075"></a>  <span class="n">ElecPowerGenerated</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecPowerGenerated</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-10076"></a>  <span class="n">PLR</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">ElecPowerGenerated</span><span class="o">/</span><span class="n">RatedPowerOutput</span><span class="p">,</span> <span class="n">MaxPartLoadRat</span><span class="p">)</span>
<a name="ln-10077"></a>  <span class="n">PLR</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">PLR</span><span class="p">,</span> <span class="n">MinPartLoadRat</span><span class="p">)</span>
<a name="ln-10078"></a>  <span class="n">ElecPowerGenerated</span> <span class="o">=</span> <span class="n">PLR</span><span class="o">*</span><span class="n">RatedPowerOutput</span>
<a name="ln-10079"></a>
<a name="ln-10080"></a>
<a name="ln-10081"></a>    <span class="c">! SET OFF-DESIGN AIR TEMPERATURE DIFFERENCE</span>
<a name="ln-10082"></a>    <span class="c">!   use OA node if set by user CR7021</span>
<a name="ln-10083"></a>  <span class="k">If</span>  <span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">OAInletNode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-10084"></a><span class="k">    </span><span class="n">AmbientDeltaT</span> <span class="o">=</span> <span class="n">OutDryBulbTemp</span> <span class="o">-</span> <span class="n">DesignAirInletTemp</span>
<a name="ln-10085"></a>  <span class="k">ELSE</span>
<a name="ln-10086"></a><span class="k">    </span><span class="n">AmbientDeltaT</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">OAInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">DesignAirInletTemp</span>
<a name="ln-10087"></a>  <span class="n">ENDIF</span>
<a name="ln-10088"></a>
<a name="ln-10089"></a>
<a name="ln-10090"></a>
<a name="ln-10091"></a><span class="c">!Use Curve fit to determine Fuel Energy Input.  For electric power generated in Watts, the fuel</span>
<a name="ln-10092"></a><span class="c">!energy input is calculated in J/s.  The PLBasedFuelInputCurve selects ratio of fuel flow (J/s)/power generated (J/s).</span>
<a name="ln-10093"></a><span class="c">!The TempBasedFuelInputCurve is a correction based on deviation from design inlet air temperature conditions.</span>
<a name="ln-10094"></a><span class="c">!The first coefficient of this fit should be 1.0 to ensure that no correction is made at design conditions.</span>
<a name="ln-10095"></a>  <span class="n">FuelUseRate</span> <span class="o">=</span> <span class="n">ElecPowerGenerated</span> <span class="o">*</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PLBasedFuelInputCurve</span><span class="p">,</span> <span class="n">PLR</span><span class="p">)</span>  <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-10096"></a>                                      <span class="n">CurveValue</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">TempBasedFuelInputCurve</span><span class="p">,</span> <span class="n">AmbientDeltaT</span><span class="p">)</span>
<a name="ln-10097"></a>
<a name="ln-10098"></a><span class="c">!Use Curve fit to determine Exhaust Flow.  This curve shows the ratio of exhaust gas flow (kg/s) to electric power</span>
<a name="ln-10099"></a><span class="c">!output (J/s).  The units on ExhaustFlowCurve are (kg/J).  When multiplied by the rated power of the unit,</span>
<a name="ln-10100"></a><span class="c">!it gives the exhaust flow rate in kg/s</span>
<a name="ln-10101"></a>  <span class="n">ExhaustFlow</span> <span class="o">=</span> <span class="n">RatedPowerOutput</span> <span class="o">*</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustFlowCurve</span><span class="p">,</span> <span class="n">AmbientDeltaT</span><span class="p">)</span>
<a name="ln-10102"></a>
<a name="ln-10103"></a><span class="c">!Use Curve fit to determine Exhaust Temperature.  This curve calculates the exhaust temperature (C) by</span>
<a name="ln-10104"></a><span class="c">!multiplying the exhaust temperature (C) for a particular part load as given by PLBasedExhaustTempCurve</span>
<a name="ln-10105"></a><span class="c">!a correction factor based on the deviation from design temperature, TempBasedExhaustTempCurve</span>
<a name="ln-10106"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">PLR</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="p">(</span><span class="n">ExhaustFlow</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">MaxExhaustperCTPower</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-10107"></a>
<a name="ln-10108"></a><span class="k">    </span><span class="n">ExhaustTemp</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PLBasedExhaustTempCurve</span><span class="p">,</span> <span class="n">PLR</span><span class="p">)</span>  <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-10109"></a>                  <span class="n">CurveValue</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">TempBasedExhaustTempCurve</span><span class="p">,</span> <span class="n">AmbientDeltaT</span><span class="p">)</span>
<a name="ln-10110"></a>
<a name="ln-10111"></a>    <span class="n">UA</span> <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">UACoef</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">RatedPowerOutput</span> <span class="o">**</span>  <span class="p">&amp;</span>
<a name="ln-10112"></a>                   <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">UACoef</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-10113"></a>
<a name="ln-10114"></a>    <span class="n">DesignMinExitGasTemp</span> <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignMinExitGasTemp</span>
<a name="ln-10115"></a>    <span class="n">ExhaustStackTemp</span> <span class="o">=</span> <span class="n">DesignMinExitGasTemp</span> <span class="o">+</span> <span class="p">(</span><span class="n">ExhaustTemp</span> <span class="o">-</span> <span class="n">DesignMinExitGasTemp</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-10116"></a>                         <span class="nb">EXP</span><span class="p">(</span><span class="n">UA</span><span class="o">/</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="n">ExhaustFlow</span><span class="p">,</span> <span class="n">MaxExhaustperCTPower</span> <span class="o">*</span> <span class="n">RatedPowerOutput</span><span class="p">)</span> <span class="o">*</span> <span class="n">ExhaustCP</span><span class="p">))</span>
<a name="ln-10117"></a>
<a name="ln-10118"></a>    <span class="n">QExhaustRec</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ExhaustFlow</span><span class="o">*</span><span class="n">ExhaustCP</span><span class="o">*</span><span class="p">(</span><span class="n">ExhaustTemp</span><span class="o">-</span><span class="n">ExhaustStackTemp</span><span class="p">),</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-10119"></a>  <span class="k">ELSE</span>
<a name="ln-10120"></a><span class="k">    </span><span class="n">ExhaustStackTemp</span> <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignMinExitGasTemp</span>
<a name="ln-10121"></a>    <span class="n">QExhaustRec</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10122"></a>  <span class="k">END IF</span>
<a name="ln-10123"></a>
<a name="ln-10124"></a><span class="c">!Use Curve fit to determine Heat Recovered Lubricant heat.  This curve calculates the lube heat recovered (J/s) by</span>
<a name="ln-10125"></a><span class="c">!multiplying the total power generated by the fraction of that power that could be recovered in the lube oil at that</span>
<a name="ln-10126"></a><span class="c">!particular part load.</span>
<a name="ln-10127"></a>  <span class="n">QLubeOilRec</span> <span class="o">=</span> <span class="n">ElecPowerGenerated</span> <span class="o">*</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QLubeOilRecoveredCurve</span><span class="p">,</span> <span class="n">PLR</span><span class="p">)</span>
<a name="ln-10128"></a>
<a name="ln-10129"></a>
<a name="ln-10130"></a><span class="c">!Check for divide by zero</span>
<a name="ln-10131"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">HeatRecMdot</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">HeatRecCp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10132"></a><span class="k">    </span><span class="n">HeatRecOutTemp</span> <span class="o">=</span> <span class="p">(</span><span class="n">QExhaustRec</span> <span class="o">+</span> <span class="n">QLubeOilRec</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">HeatRecMdot</span> <span class="o">*</span> <span class="n">HeatRecCp</span><span class="p">)</span> <span class="o">+</span> <span class="n">HeatRecInTemp</span>
<a name="ln-10133"></a>  <span class="k">ELSE</span>
<a name="ln-10134"></a><span class="k">    </span><span class="n">HeatRecMdot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10135"></a>    <span class="n">HeatRecOutTemp</span> <span class="o">=</span> <span class="n">HeatRecInTemp</span>
<a name="ln-10136"></a>    <span class="n">QExhaustRec</span> <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10137"></a>    <span class="n">QLubeOilRec</span> <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10138"></a>  <span class="k">END IF</span>
<a name="ln-10139"></a>
<a name="ln-10140"></a>
<a name="ln-10141"></a>
<a name="ln-10142"></a>  <span class="c">!Now verify the maximum temperature was not exceeded</span>
<a name="ln-10143"></a>  <span class="n">HRecRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10144"></a>  <span class="n">MinHeatRecMdot</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10145"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">HeatRecOutTemp</span> <span class="o">&gt;</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10146"></a><span class="k">   IF</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxTemp</span> <span class="o">/=</span> <span class="n">HeatRecInTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10147"></a><span class="k">      </span><span class="n">MinHeatRecMdot</span> <span class="o">=</span> <span class="p">(</span><span class="n">QExhaustRec</span> <span class="o">+</span> <span class="n">QLubeOilRec</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">HeatRecCp</span> <span class="o">*</span> <span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxTemp</span> <span class="o">-</span> <span class="n">HeatRecInTemp</span><span class="p">))</span>
<a name="ln-10148"></a>      <span class="k">If</span><span class="p">(</span><span class="n">MinHeatRecMdot</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">MinHeatRecMdot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10149"></a>   <span class="k">END IF</span>
<a name="ln-10150"></a>
<a name="ln-10151"></a>    <span class="c">!Recalculate Outlet Temperature, with adjusted flowrate</span>
<a name="ln-10152"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">MinHeatRecMdot</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">HeatRecCp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10153"></a><span class="k">      </span><span class="n">HeatRecOutTemp</span> <span class="o">=</span> <span class="p">(</span><span class="n">QExhaustRec</span> <span class="o">+</span> <span class="n">QLubeOilRec</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">MinHeatRecMdot</span> <span class="o">*</span> <span class="n">HeatRecCp</span><span class="p">)</span> <span class="o">+</span> <span class="n">HeatRecInTemp</span>
<a name="ln-10154"></a>      <span class="n">HRecRatio</span> <span class="o">=</span> <span class="n">HeatRecMdot</span><span class="o">/</span><span class="n">MinHeatRecMdot</span>
<a name="ln-10155"></a>    <span class="k">ELSE</span>
<a name="ln-10156"></a><span class="k">      </span><span class="n">HeatRecOutTemp</span> <span class="o">=</span> <span class="n">HeatRecInTemp</span>
<a name="ln-10157"></a>      <span class="n">HRecRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10158"></a>    <span class="k">END IF</span>
<a name="ln-10159"></a><span class="k">    </span><span class="n">QLubeOilRec</span> <span class="o">=</span> <span class="n">QLubeOilRec</span><span class="o">*</span><span class="n">HRecRatio</span>
<a name="ln-10160"></a>    <span class="n">QExhaustRec</span> <span class="o">=</span> <span class="n">QExhaustRec</span><span class="o">*</span><span class="n">HRecRatio</span>
<a name="ln-10161"></a>  <span class="k">END IF</span>
<a name="ln-10162"></a>
<a name="ln-10163"></a>
<a name="ln-10164"></a>        <span class="c">!Calculate Energy</span>
<a name="ln-10165"></a>  <span class="n">ElectricEnergyGen</span>    <span class="o">=</span> <span class="n">ElecPowerGenerated</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-10166"></a>  <span class="n">FuelEnergyUsed</span>       <span class="o">=</span> <span class="n">FuelUseRate</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-10167"></a>  <span class="n">LubeOilEnergyRec</span>     <span class="o">=</span> <span class="n">QLubeOilRec</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-10168"></a>  <span class="n">ExhaustEnergyRec</span>     <span class="o">=</span> <span class="n">QExhaustRec</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-10169"></a>
<a name="ln-10170"></a>
<a name="ln-10171"></a>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecPowerGenerated</span> <span class="o">=</span> <span class="n">ElecPowerGenerated</span>
<a name="ln-10172"></a>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecEnergyGenerated</span> <span class="o">=</span> <span class="n">ElectricEnergyGen</span>
<a name="ln-10173"></a>
<a name="ln-10174"></a>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span> <span class="o">=</span> <span class="n">HeatRecInTemp</span>
<a name="ln-10175"></a>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span> <span class="o">=</span> <span class="n">HeatRecOutTemp</span>
<a name="ln-10176"></a>
<a name="ln-10177"></a>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMdot</span>         <span class="o">=</span> <span class="n">HeatRecMdot</span>
<a name="ln-10178"></a>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QExhaustRecovered</span>   <span class="o">=</span> <span class="n">QExhaustRec</span>
<a name="ln-10179"></a>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QLubeOilRecovered</span>   <span class="o">=</span> <span class="n">QLubeOilRec</span>
<a name="ln-10180"></a>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QTotalHeatRecovered</span> <span class="o">=</span> <span class="n">QExhaustRec</span> <span class="o">+</span> <span class="n">QLubeOilRec</span>
<a name="ln-10181"></a>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergyUseRate</span>   <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">FuelUseRate</span><span class="p">)</span>
<a name="ln-10182"></a>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustEnergyRec</span>    <span class="o">=</span> <span class="n">ExhaustEnergyRec</span>
<a name="ln-10183"></a>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">LubeOilEnergyRec</span>    <span class="o">=</span> <span class="n">LubeOilEnergyRec</span>
<a name="ln-10184"></a>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">TotalHeatEnergyRec</span>  <span class="o">=</span> <span class="n">ExhaustEnergyRec</span> <span class="o">+</span> <span class="n">LubeOilEnergyRec</span>
<a name="ln-10185"></a>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergy</span>          <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">FuelEnergyUsed</span><span class="p">)</span>
<a name="ln-10186"></a>
<a name="ln-10187"></a>  <span class="n">FuelHeatingValue</span> <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelHeatingValue</span>
<a name="ln-10188"></a>
<a name="ln-10189"></a>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelMdot</span> <span class="o">=</span>  <span class="nb">ABS</span><span class="p">(</span><span class="n">FuelUseRate</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">FuelHeatingValue</span>  <span class="o">*</span> <span class="n">KJtoJ</span><span class="p">)</span>
<a name="ln-10190"></a>
<a name="ln-10191"></a>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustStackTemp</span> <span class="o">=</span> <span class="n">ExhaustStackTemp</span>
<a name="ln-10192"></a>
<a name="ln-10193"></a>  <span class="k">RETURN</span>
<a name="ln-10194"></a><span class="k">END SUBROUTINE </span><span class="n">CalcCTGeneratorModel</span>
<a name="ln-10195"></a>
<a name="ln-10196"></a><span class="c">! End of CT Generator Module Model Subroutines</span>
<a name="ln-10197"></a><span class="c">! *****************************************************************************</span>
<a name="ln-10198"></a>
<a name="ln-10199"></a><span class="c">! Begin CT Generator Module Utility Subroutines</span>
<a name="ln-10200"></a><span class="c">! *****************************************************************************</span>
<a name="ln-10201"></a><span class="k">SUBROUTINE </span><span class="n">InitCTGenerators</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span> <span class="n">RunFlag</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-10202"></a>
<a name="ln-10203"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10204"></a>          <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-10205"></a>          <span class="c">!       DATE WRITTEN   Oct 2000</span>
<a name="ln-10206"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10207"></a>          <span class="c">!       RE-ENGINEERED  Brent Griffith, Sept 2010 plant upgrades, generalize fluid props</span>
<a name="ln-10208"></a>
<a name="ln-10209"></a>
<a name="ln-10210"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10211"></a>          <span class="c">! This subroutine is for initializations of the CT generators.</span>
<a name="ln-10212"></a>
<a name="ln-10213"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10214"></a>          <span class="c">! Uses the status flags to trigger initializations.</span>
<a name="ln-10215"></a>
<a name="ln-10216"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10217"></a>          <span class="c">! na</span>
<a name="ln-10218"></a>
<a name="ln-10219"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10220"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span>
<a name="ln-10221"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">ScanPlantLoopsForObject</span><span class="p">,</span> <span class="n">TypeOf_Generator_CTurbine</span>
<a name="ln-10222"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span><span class="p">,</span> <span class="n">InitComponentNodes</span>
<a name="ln-10223"></a>
<a name="ln-10224"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10225"></a>
<a name="ln-10226"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10227"></a>  <span class="kt">INTEGER</span><span class="p">,</span>     <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">GeneratorNum</span>    <span class="c">! Generator number</span>
<a name="ln-10228"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>     <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RunFlag</span>         <span class="c">! TRUE when Generator operating</span>
<a name="ln-10229"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MyLoad</span>          <span class="c">! Generator demand</span>
<a name="ln-10230"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>     <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-10231"></a>
<a name="ln-10232"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10233"></a>          <span class="c">! na</span>
<a name="ln-10234"></a>
<a name="ln-10235"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-10236"></a>          <span class="c">! na</span>
<a name="ln-10237"></a>
<a name="ln-10238"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-10239"></a>          <span class="c">! na</span>
<a name="ln-10240"></a>
<a name="ln-10241"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10242"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HeatRecInletNode</span> <span class="c">! inlet node number in heat recovery loop</span>
<a name="ln-10243"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HeatRecOutletNode</span> <span class="c">! outlet node number in heat recovery loop</span>
<a name="ln-10244"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>           <span class="c">! Initialization flag</span>
<a name="ln-10245"></a>
<a name="ln-10246"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span> <span class="c">! Used for initializations each begin environment flag</span>
<a name="ln-10247"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyPlantScanFlag</span>
<a name="ln-10248"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySizeAndNodeInitFlag</span>
<a name="ln-10249"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">mdot</span>
<a name="ln-10250"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">rho</span>
<a name="ln-10251"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-10252"></a>
<a name="ln-10253"></a>            <span class="c">! FLOW:</span>
<a name="ln-10254"></a>
<a name="ln-10255"></a><span class="c">! Do the one time initializations</span>
<a name="ln-10256"></a>
<a name="ln-10257"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10258"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumCTGenerators</span><span class="p">))</span>
<a name="ln-10259"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">NumCTGenerators</span><span class="p">))</span>
<a name="ln-10260"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MySizeAndNodeInitFlag</span><span class="p">(</span><span class="n">NumCTGenerators</span><span class="p">))</span>
<a name="ln-10261"></a>    <span class="n">MyEnvrnFlag</span>           <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10262"></a>    <span class="n">MyPlantScanFlag</span>       <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10263"></a>    <span class="n">MyOneTimeFlag</span>         <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10264"></a>    <span class="n">MySizeAndNodeInitFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10265"></a>  <span class="k">END IF</span>
<a name="ln-10266"></a>
<a name="ln-10267"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10268"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10269"></a><span class="k">    </span><span class="n">errFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10270"></a>    <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10271"></a>                                 <span class="n">TypeOf_Generator_CTurbine</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10272"></a>                                 <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10273"></a>                                 <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10274"></a>                                 <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10275"></a>                                 <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10276"></a>                                 <span class="n">errFlag</span> <span class="o">=</span> <span class="n">errFlag</span> <span class="p">)</span>
<a name="ln-10277"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10278"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitCTGenerators: Program terminated due to previous condition(s).&#39;</span><span class="p">)</span>
<a name="ln-10279"></a>    <span class="n">ENDIF</span>
<a name="ln-10280"></a>    <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10281"></a>  <span class="n">ENDIF</span>
<a name="ln-10282"></a>
<a name="ln-10283"></a>
<a name="ln-10284"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MySizeAndNodeInitFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-10285"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10286"></a><span class="k">    </span><span class="n">HeatRecInletNode</span>    <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>
<a name="ln-10287"></a>    <span class="n">HeatRecOutletNode</span>   <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>
<a name="ln-10288"></a>
<a name="ln-10289"></a>    <span class="c">!size mass flow rate</span>
<a name="ln-10290"></a>    <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10291"></a>                                     <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10292"></a>                                     <span class="n">PlantLoop</span><span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10293"></a>                                     <span class="s1">&#39;InitICEngineGenerators&#39;</span><span class="p">)</span>
<a name="ln-10294"></a>
<a name="ln-10295"></a>    <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecVolFlowRate</span>
<a name="ln-10296"></a>
<a name="ln-10297"></a>    <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10298"></a>                                 <span class="n">HeatRecInletNode</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-10299"></a>                                 <span class="n">HeatRecOutletNode</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-10300"></a>                                 <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10301"></a>                                 <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10302"></a>                                 <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10303"></a>                                 <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-10304"></a>
<a name="ln-10305"></a>    <span class="n">MySizeAndNodeInitFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10306"></a>  <span class="k">END IF</span> <span class="c">! end one time inits</span>
<a name="ln-10307"></a>
<a name="ln-10308"></a>  <span class="c">! Do the Begin Environment initializations</span>
<a name="ln-10309"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10310"></a><span class="k">    </span><span class="n">HeatRecInletNode</span>    <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>
<a name="ln-10311"></a>    <span class="n">HeatRecOutletNode</span>   <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>
<a name="ln-10312"></a>    <span class="c">! set the node Temperature, assuming freeze control</span>
<a name="ln-10313"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">0.0d0</span>
<a name="ln-10314"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">0.0d0</span>
<a name="ln-10315"></a>   <span class="c">! set the node max and min mass flow rates</span>
<a name="ln-10316"></a>    <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10317"></a>                                 <span class="n">HeatRecInletNode</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-10318"></a>                                 <span class="n">HeatRecOutletNode</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-10319"></a>                                 <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10320"></a>                                 <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10321"></a>                                 <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10322"></a>                                 <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-10323"></a>
<a name="ln-10324"></a>    <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10325"></a>  <span class="k">END IF</span> <span class="c">! end environmental inits</span>
<a name="ln-10326"></a>
<a name="ln-10327"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10328"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10329"></a>  <span class="n">ENDIF</span>
<a name="ln-10330"></a>
<a name="ln-10331"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10332"></a><span class="k">    IF</span> <span class="p">(</span> <span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-10333"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">RunFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10334"></a><span class="k">        </span><span class="n">mdot</span> <span class="o">=</span>  <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span>
<a name="ln-10335"></a>      <span class="k">ELSE</span>
<a name="ln-10336"></a><span class="k">        </span><span class="n">mdot</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-10337"></a>      <span class="n">ENDIF</span>
<a name="ln-10338"></a>      <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdot</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10339"></a>                                   <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10340"></a>                                   <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10341"></a>                                   <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10342"></a>                                   <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10343"></a>                                   <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10344"></a>                                   <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-10345"></a>
<a name="ln-10346"></a>    <span class="k">ELSE</span>
<a name="ln-10347"></a><span class="k">      CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span>   <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMdot</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10348"></a>                                   <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10349"></a>                                   <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10350"></a>                                   <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10351"></a>                                   <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10352"></a>                                   <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10353"></a>                                   <span class="n">CTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-10354"></a>    <span class="n">ENDIF</span>
<a name="ln-10355"></a>  <span class="n">ENDIF</span>
<a name="ln-10356"></a>
<a name="ln-10357"></a><span class="k">RETURN</span>
<a name="ln-10358"></a><span class="k">END SUBROUTINE </span><span class="n">InitCTGenerators</span>
<a name="ln-10359"></a><span class="c">! End CT Generator Module Utility Subroutines</span>
<a name="ln-10360"></a><span class="c">! *****************************************************************************</span>
<a name="ln-10361"></a>
<a name="ln-10362"></a>
<a name="ln-10363"></a><span class="c">! Beginning of Record Keeping subroutines for the CT Generator Module</span>
<a name="ln-10364"></a><span class="c">! *****************************************************************************</span>
<a name="ln-10365"></a>
<a name="ln-10366"></a><span class="k">SUBROUTINE </span><span class="n">UpdateCTGeneratorRecords</span><span class="p">(</span><span class="n">RunFlag</span><span class="p">,</span> <span class="n">Num</span><span class="p">)</span>
<a name="ln-10367"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10368"></a>            <span class="c">!       AUTHOR:          Dan Fisher</span>
<a name="ln-10369"></a>            <span class="c">!       DATE WRITTEN:    October 1998</span>
<a name="ln-10370"></a>
<a name="ln-10371"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10372"></a>            <span class="c">! reporting</span>
<a name="ln-10373"></a>
<a name="ln-10374"></a>
<a name="ln-10375"></a>            <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-10376"></a>
<a name="ln-10377"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-10378"></a>
<a name="ln-10379"></a>            <span class="c">! USE STATEMENTS: na</span>
<a name="ln-10380"></a>
<a name="ln-10381"></a>
<a name="ln-10382"></a><span class="k">IMPLICIT NONE</span>
<a name="ln-10383"></a>
<a name="ln-10384"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10385"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RunFlag</span>   <span class="c">! TRUE if Generator operating</span>
<a name="ln-10386"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">Num</span>       <span class="c">! Generator number</span>
<a name="ln-10387"></a>
<a name="ln-10388"></a>
<a name="ln-10389"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10390"></a>          <span class="c">! na</span>
<a name="ln-10391"></a>
<a name="ln-10392"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-10393"></a>          <span class="c">! na</span>
<a name="ln-10394"></a>
<a name="ln-10395"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10396"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">HeatRecInletNode</span>
<a name="ln-10397"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">HeatRecOutletNode</span>
<a name="ln-10398"></a>
<a name="ln-10399"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10400"></a><span class="k">    </span><span class="n">HeatRecInletNode</span> <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>
<a name="ln-10401"></a>    <span class="n">HeatRecOutletNode</span> <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>
<a name="ln-10402"></a>
<a name="ln-10403"></a><span class="c">!    Node(HeatRecOutletNode)%MassFlowRate = CTGenerator(Num)%HeatRecMdot</span>
<a name="ln-10404"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span>
<a name="ln-10405"></a><span class="c">!    Node(HeatRecOutletNode)%MassFlowRateMaxAvail = Node(HeatRecInletNode)%MassFlowRateMaxAvail</span>
<a name="ln-10406"></a><span class="c">!    Node(HeatRecOutletNode)%MassFlowRateMinAvail = Node(HeatRecInletNode)%MassFlowRateMinAvail</span>
<a name="ln-10407"></a>
<a name="ln-10408"></a>  <span class="n">ENDIF</span>
<a name="ln-10409"></a>    <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">PowerGen</span>            <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecPowerGenerated</span>
<a name="ln-10410"></a>    <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">EnergyGen</span>            <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecEnergyGenerated</span>
<a name="ln-10411"></a>    <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QExhaustRecovered</span> <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QExhaustRecovered</span>
<a name="ln-10412"></a>    <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QLubeOilRecovered</span>    <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QLubeOilRecovered</span>
<a name="ln-10413"></a>    <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustEnergyRec</span> <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustEnergyRec</span>
<a name="ln-10414"></a>    <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">LubeOilEnergyRec</span>    <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">LubeOilEnergyRec</span>
<a name="ln-10415"></a>    <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QTotalHeatRecovered</span>    <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QTotalHeatRecovered</span>
<a name="ln-10416"></a>    <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">TotalHeatEnergyRec</span>    <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">TotalHeatEnergyRec</span>
<a name="ln-10417"></a>    <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelEnergyUseRate</span>       <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelEnergyUseRate</span>
<a name="ln-10418"></a>    <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelEnergy</span>       <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelEnergy</span>
<a name="ln-10419"></a>    <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelMdot</span>       <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelMdot</span>
<a name="ln-10420"></a>    <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustStackTemp</span>     <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustStackTemp</span>
<a name="ln-10421"></a>    <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span>     <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span>
<a name="ln-10422"></a>    <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span>    <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span>
<a name="ln-10423"></a>    <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecMdot</span>          <span class="o">=</span> <span class="n">CTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecMdot</span>
<a name="ln-10424"></a>
<a name="ln-10425"></a>
<a name="ln-10426"></a><span class="k">RETURN</span>
<a name="ln-10427"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateCTGeneratorRecords</span>
<a name="ln-10428"></a>
<a name="ln-10429"></a>
<a name="ln-10430"></a><span class="k">SUBROUTINE </span><span class="n">GetCTGeneratorResults</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span> <span class="n">GeneratorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10431"></a>                                 <span class="n">GeneratorPower</span><span class="p">,</span>  <span class="n">GeneratorEnergy</span><span class="p">,</span> <span class="n">ThermalPower</span><span class="p">,</span> <span class="n">ThermalEnergy</span><span class="p">)</span>
<a name="ln-10432"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10433"></a>          <span class="c">!       AUTHOR         B Griffith</span>
<a name="ln-10434"></a>          <span class="c">!       DATE WRITTEN   March 2008</span>
<a name="ln-10435"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10436"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10437"></a>
<a name="ln-10438"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10439"></a>          <span class="c">! get some results for load center&#39;s aggregation</span>
<a name="ln-10440"></a>
<a name="ln-10441"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10442"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-10443"></a>
<a name="ln-10444"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10445"></a>          <span class="c">! na</span>
<a name="ln-10446"></a>
<a name="ln-10447"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10448"></a>          <span class="c">! na</span>
<a name="ln-10449"></a>
<a name="ln-10450"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10451"></a>
<a name="ln-10452"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10453"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">GeneratorType</span>   <span class="c">! type of Generator</span>
<a name="ln-10454"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">GeneratorIndex</span>
<a name="ln-10455"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">GeneratorPower</span>  <span class="c">! electrical power</span>
<a name="ln-10456"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">GeneratorEnergy</span> <span class="c">! electrical energy</span>
<a name="ln-10457"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">ThermalPower</span>  <span class="c">! heat power</span>
<a name="ln-10458"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">ThermalEnergy</span> <span class="c">! heat energy</span>
<a name="ln-10459"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10460"></a>          <span class="c">! na</span>
<a name="ln-10461"></a>
<a name="ln-10462"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10463"></a>          <span class="c">! na</span>
<a name="ln-10464"></a>
<a name="ln-10465"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10466"></a>          <span class="c">! na</span>
<a name="ln-10467"></a>
<a name="ln-10468"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10469"></a>  <span class="n">GeneratorPower</span>  <span class="o">=</span>  <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">PowerGen</span>
<a name="ln-10470"></a>  <span class="n">GeneratorEnergy</span> <span class="o">=</span>  <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">EnergyGen</span>
<a name="ln-10471"></a>  <span class="n">ThermalPower</span>    <span class="o">=</span>  <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">QTotalHeatRecovered</span>
<a name="ln-10472"></a>  <span class="n">ThermalEnergy</span>   <span class="o">=</span>  <span class="n">CTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">TotalHeatEnergyRec</span>
<a name="ln-10473"></a>
<a name="ln-10474"></a>  <span class="k">RETURN</span>
<a name="ln-10475"></a>
<a name="ln-10476"></a><span class="k">END SUBROUTINE </span><span class="n">GetCTGeneratorResults</span>
<a name="ln-10477"></a>
<a name="ln-10478"></a>
<a name="ln-10479"></a><span class="c">! End of Record Keeping subroutines for the CT Generator Module</span>
<a name="ln-10480"></a><span class="c">! *****************************************************************************</span>
<a name="ln-10481"></a>
<a name="ln-10482"></a><span class="k">END MODULE </span><span class="n">CTElectricGenerator</span>
<a name="ln-10483"></a>
<a name="ln-10484"></a>
<a name="ln-10485"></a><span class="c">!******************************************************************************************************</span>
<a name="ln-10486"></a><span class="c">!+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>
<a name="ln-10487"></a><span class="c">!******************************************************************************************************</span>
<a name="ln-10488"></a><span class="c">!+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>
<a name="ln-10489"></a>
<a name="ln-10490"></a><span class="k">MODULE </span><span class="n">MicroturbineElectricGenerator</span>  <span class="c">! Microturbine Electric Generator Module</span>
<a name="ln-10491"></a>
<a name="ln-10492"></a>          <span class="c">! MODULE INFORMATION:</span>
<a name="ln-10493"></a>          <span class="c">!       AUTHOR         R. Raustad/D. Shirey</span>
<a name="ln-10494"></a>          <span class="c">!       DATE WRITTEN   Mar 2008</span>
<a name="ln-10495"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10496"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10497"></a>
<a name="ln-10498"></a>          <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-10499"></a>          <span class="c">!  This module simulates the performance of microturbine electric</span>
<a name="ln-10500"></a>          <span class="c">!  generators.</span>
<a name="ln-10501"></a>
<a name="ln-10502"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10503"></a>          <span class="c">!  Once the electric power manager determines that the MT Generator</span>
<a name="ln-10504"></a>          <span class="c">!  is available, it calls SimMTGenerator which in turn calls the</span>
<a name="ln-10505"></a>          <span class="c">!  appropriate microturbine generator model.</span>
<a name="ln-10506"></a>          <span class="c">!</span>
<a name="ln-10507"></a>          <span class="c">!  MT Generator models are based on polynomial curve fits of generator</span>
<a name="ln-10508"></a>          <span class="c">!  performance data.</span>
<a name="ln-10509"></a>
<a name="ln-10510"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-10511"></a>
<a name="ln-10512"></a>          <span class="c">! OTHER NOTES: na</span>
<a name="ln-10513"></a>
<a name="ln-10514"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10515"></a>
<a name="ln-10516"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-10517"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-10518"></a><span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>   <span class="n">ONLY</span> <span class="p">:</span> <span class="n">MaxNameLength</span><span class="p">,</span> <span class="n">NumOfTimeStepInHour</span><span class="p">,</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="n">BeginEnvrnFlag</span><span class="p">,</span> <span class="n">InitConvTemp</span>
<a name="ln-10519"></a><span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowSevereMessage</span><span class="p">,</span> <span class="n">ShowWarningMessage</span><span class="p">,</span> <span class="n">ShowFatalError</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10520"></a>                           <span class="n">ShowContinueError</span><span class="p">,</span> <span class="n">SetupOutputVariable</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10521"></a>                           <span class="n">ShowContinueErrorTimeStamp</span><span class="p">,</span> <span class="n">ShowRecurringWarningErrorAtEnd</span>
<a name="ln-10522"></a><span class="k">USE </span><span class="n">DataGlobalConstants</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">iGeneratorMicroturbine</span>
<a name="ln-10523"></a>
<a name="ln-10524"></a>
<a name="ln-10525"></a><span class="k">IMPLICIT NONE</span>
<a name="ln-10526"></a>
<a name="ln-10527"></a><span class="k">PRIVATE</span>
<a name="ln-10528"></a>          <span class="c">! MODULE PARAMETER DEFINITIONS:</span>
<a name="ln-10529"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-10530"></a>
<a name="ln-10531"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10532"></a><span class="k">TYPE </span><span class="n">MTGeneratorSpecs</span>
<a name="ln-10533"></a><span class="c">!      User inputs</span>
<a name="ln-10534"></a>       <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>   <span class="c">! User identifier (name)</span>
<a name="ln-10535"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RefElecPowerOutput</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reference Electrical Power Output from generator (W)</span>
<a name="ln-10536"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MinElecPowerOutput</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Minimum Electrical Power Output (W)</span>
<a name="ln-10537"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MaxElecPowerOutput</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Maximum Electrical Power Output (W)</span>
<a name="ln-10538"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RefThermalPowerOutput</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reference Electrical Power Output from generator (W)</span>
<a name="ln-10539"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MinThermalPowerOutput</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Minimum Electrical Power Output (W)</span>
<a name="ln-10540"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MaxThermalPowerOutput</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Maximum Electrical Power Output (W)</span>
<a name="ln-10541"></a>
<a name="ln-10542"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RefElecEfficiencyLHV</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reference Electrical Efficiency based on fuel LHV</span>
<a name="ln-10543"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RefCombustAirInletTemp</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reference Combustion Air Inlet Temperature (C)</span>
<a name="ln-10544"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RefCombustAirInletHumRat</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reference Combustion Air Inlet Humidity Ratio (kg/kg)</span>
<a name="ln-10545"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RefElevation</span>                 <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reference Elevation (m)</span>
<a name="ln-10546"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ElecPowFTempElevCurveNum</span>     <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Curve index for Electrical Power as a function of temp and elev.</span>
<a name="ln-10547"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ElecEffFTempCurveNum</span>         <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Curve index for Electrical Efficiency function of temp</span>
<a name="ln-10548"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ElecEffFPLRCurveNum</span>          <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Curve index for Electrical Efficiency as a function of PLR</span>
<a name="ln-10549"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FuelHigherHeatingValue</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Higher Heating Value for Fuel (kJ/kg)</span>
<a name="ln-10550"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FuelLowerHeatingValue</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Lower Heating Value for Fuel (kJ/kg)</span>
<a name="ln-10551"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">StandbyPower</span>                 <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Standby Power entered by user (W)</span>
<a name="ln-10552"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">AncillaryPower</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Ancillary Power entered by user (W)</span>
<a name="ln-10553"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">AncillaryPowerFuelCurveNum</span>   <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Index to ancillary power modifer curve (function of fuel input)</span>
<a name="ln-10554"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatRecInletNodeNum</span>          <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Heat Recovery Water Inlet Node number</span>
<a name="ln-10555"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatRecOutletNodeNum</span>         <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Heat Recovery Water Outlet Node number</span>
<a name="ln-10556"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RefThermalEffLHV</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reference Thermal Efficiency (LHV Basis)</span>
<a name="ln-10557"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RefInletWaterTemp</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reference Inlet Water Temperature for heat recovery (C)</span>
<a name="ln-10558"></a>       <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">InternalFlowControl</span>          <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!  A9, \field Heat Recovery Water Flow Operating Mode</span>
<a name="ln-10559"></a>       <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">PlantFlowControl</span>             <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">!  Default = Plant Control</span>
<a name="ln-10560"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RefHeatRecVolFlowRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reference Heat Recovery Water Flow Rate (m3/s)</span>
<a name="ln-10561"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatRecFlowFTempPowCurveNum</span>  <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Curve index for Heat Recovery Water Flow Rate function of temp &amp; power</span>
<a name="ln-10562"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ThermEffFTempElevCurveNum</span>    <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Curve index for Thermal Efficiency function of temp &amp; elevation</span>
<a name="ln-10563"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatRecRateFPLRCurveNum</span>      <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Curve index for Heat Recovery Rate function of part-load ratio</span>
<a name="ln-10564"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatRecRateFTempCurveNum</span>     <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Curve index for Heat Recovery Rate function of inlet water temp</span>
<a name="ln-10565"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatRecRateFWaterFlowCurveNum</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">! Curve index for Heat Recovery Rate function of water flow rate</span>
<a name="ln-10566"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatRecMinVolFlowRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Minimum Heat Recovery Water volume Flow Rate (m3/s)</span>
<a name="ln-10567"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatRecMaxVolFlowRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Maximum Heat Recovery Water volume Flow Rate (m3/s)</span>
<a name="ln-10568"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatRecMaxWaterTemp</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Maximum Heat Recovery Water Temperature (C)</span>
<a name="ln-10569"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CombustionAirInletNodeNum</span>    <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Combustion Air Inlet Node number</span>
<a name="ln-10570"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CombustionAirOutletNodeNum</span>   <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Combustion Air Outlet (Exhaust) Node number</span>
<a name="ln-10571"></a>       <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">ExhAirCalcsActive</span>            <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Flag to enable exhaust air calculations</span>
<a name="ln-10572"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RefExhaustAirMassFlowRate</span>    <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! Reference Exhaust Air Mass Flow Rate (kg/s)</span>
<a name="ln-10573"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ExhaustAirMassFlowRate</span>       <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! Actual Exhaust Air Mass Flow Rate (kg/s)</span>
<a name="ln-10574"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ExhFlowFTempCurveNum</span>         <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Curve index for Exhaust Air Flow Rate function of inlet air temp</span>
<a name="ln-10575"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ExhFlowFPLRCurveNum</span>          <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Curve index for Exhaust Air Flow Rate function of part-load ratio</span>
<a name="ln-10576"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NomExhAirOutletTemp</span>          <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! Nominal Exhaust Air Outlet Temperature (C)</span>
<a name="ln-10577"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ExhAirTempFTempCurveNum</span>      <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Curve index for Exhaust Air Temperature function of inlet air temp</span>
<a name="ln-10578"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ExhAirTempFPLRCurveNum</span>       <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Curve index for Exhaust Air Temperature function of part-load ratio</span>
<a name="ln-10579"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ExhaustAirTemperature</span>        <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! Combustion exhaust air temperature (C)</span>
<a name="ln-10580"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ExhaustAirHumRat</span>             <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! Combustion exhaust air humidity ratio (kg/kg)</span>
<a name="ln-10581"></a>
<a name="ln-10582"></a><span class="c">!      Other required variables/calculated values</span>
<a name="ln-10583"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CompType_Num</span>                 <span class="o">=</span> <span class="n">iGeneratorMicroturbine</span>
<a name="ln-10584"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RefCombustAirInletDensity</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reference combustion air inlet density (kg/m3)</span>
<a name="ln-10585"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MinPartLoadRat</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Min allowed operating frac full load</span>
<a name="ln-10586"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MaxPartLoadRat</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Max allowed operating frac full load</span>
<a name="ln-10587"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FuelEnergyUseRateHHV</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Rate of Fuel Energy required to run microturbine, HHV basis (W)</span>
<a name="ln-10588"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FuelEnergyUseRateLHV</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Rate of Fuel Energy required to run microturbine, LHV basis (W)</span>
<a name="ln-10589"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">QHeatRecovered</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Recovered exhaust energy rate to heat water  (W)</span>
<a name="ln-10590"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ExhaustEnergyRec</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Recovered exhaust energy to heat water (J)</span>
<a name="ln-10591"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesignHeatRecMassFlowRate</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Design Water mass flow rate through heat recovery loop (kg/s)</span>
<a name="ln-10592"></a>       <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">HeatRecActive</span>                <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! TRUE when heat recovery water inlet and outlet nodes are defined</span>
<a name="ln-10593"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatRecInletTemp</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Inlet Temperature of the heat recovery fluid (C)</span>
<a name="ln-10594"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatRecOutletTemp</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Outlet Temperature of the heat recovery fluid (C)</span>
<a name="ln-10595"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatRecMinMassFlowRate</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Minimum heat recovery water mass flow rate (kg/s)</span>
<a name="ln-10596"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatRecMaxMassFlowRate</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Maximum heat recovery water mass flow rate (kg/s)</span>
<a name="ln-10597"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatRecMdot</span>                  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Heat Recovery Loop Mass flow rate (kg/s)</span>
<a name="ln-10598"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HRLoopNum</span>                    <span class="o">=</span> <span class="mi">0</span>     <span class="c">! cooling water plant loop index number, for heat recovery</span>
<a name="ln-10599"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HRLoopSideNum</span>                <span class="o">=</span> <span class="mi">0</span>     <span class="c">! cooling water plant loop side index, for heat recovery</span>
<a name="ln-10600"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HRBranchNum</span>                  <span class="o">=</span> <span class="mi">0</span>     <span class="c">! cooling water plant loop branch index, for heat recovery</span>
<a name="ln-10601"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HRCompNum</span>                    <span class="o">=</span> <span class="mi">0</span>     <span class="c">! cooling water plant loop component index, for heat recovery</span>
<a name="ln-10602"></a>
<a name="ln-10603"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FuelMdot</span>                     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Fuel Amount used (kg/s)</span>
<a name="ln-10604"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ElecPowerGenerated</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Electric power generated (W)</span>
<a name="ln-10605"></a>
<a name="ln-10606"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">StandbyPowerRate</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Standby power rate this time step (W)</span>
<a name="ln-10607"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">AncillaryPowerRate</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Ancillary power rate this time step (W)</span>
<a name="ln-10608"></a>
<a name="ln-10609"></a><span class="c">!     Warning message variables</span>
<a name="ln-10610"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">PowerFTempElevErrorIndex</span>     <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to power as a function of temp/elevation warning message</span>
<a name="ln-10611"></a><span class="c">!       INTEGER    :: PowerFTempElevErrorCount     = 0   ! Counter for power as a function of temp/elevation warning messages</span>
<a name="ln-10612"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">EffFTempErrorIndex</span>           <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to efficiency as a function of temperature warning message</span>
<a name="ln-10613"></a><span class="c">!       INTEGER    :: EffFTempErrorCount           = 0   ! Counter for efficiency as a function of temperature warning messages</span>
<a name="ln-10614"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">EffFPLRErrorIndex</span>            <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to efficiency as a function of PLR warning message</span>
<a name="ln-10615"></a><span class="c">!       INTEGER    :: EffFPLRErrorCount            = 0   ! Counter for efficiency as a function of PLR warning messages</span>
<a name="ln-10616"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ExhFlowFTempErrorIndex</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to exhaust flow as a function of temp warning message</span>
<a name="ln-10617"></a><span class="c">!       INTEGER    :: ExhFlowFTempErrorCount       = 0   ! Counter for exhaust flow as a function of temp warning messages</span>
<a name="ln-10618"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ExhFlowFPLRErrorIndex</span>        <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to exhaust flow as a function of PLR warning message</span>
<a name="ln-10619"></a><span class="c">!       INTEGER    :: ExhFlowFPLRErrorCount        = 0   ! Counter for exhaust flow as a function of PLR warning messages</span>
<a name="ln-10620"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ExhTempFTempErrorIndex</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to exhaust temp as a function of temp warning message</span>
<a name="ln-10621"></a><span class="c">!       INTEGER    :: ExhTempFTempErrorCount       = 0   ! Counter for exhaust temp as a function of temp warning messages</span>
<a name="ln-10622"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ExhTempFPLRErrorIndex</span>        <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to exhaust temp as a function of PLR warning message</span>
<a name="ln-10623"></a><span class="c">!       INTEGER    :: ExhTempFPLRErrorCount        = 0   ! Counter for exhaust temp as a function of PLR warning messages</span>
<a name="ln-10624"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HRMinFlowErrorIndex</span>          <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to reclaim water flow rate warning message</span>
<a name="ln-10625"></a><span class="c">!       INTEGER    :: HRMinFlowErrorCount          = 0   ! Counter for reclaim water flow rate warning messages</span>
<a name="ln-10626"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HRMaxFlowErrorIndex</span>          <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to reclaim water flow rate warning message</span>
<a name="ln-10627"></a><span class="c">!       INTEGER    :: HRMaxFlowErrorCount          = 0   ! Counter for reclaim water flow rate warning messages</span>
<a name="ln-10628"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ExhTempLTInletTempIndex</span>      <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to exhaust temp &lt; combustion inlet air temp warning messages</span>
<a name="ln-10629"></a><span class="c">!       INTEGER    :: ExhTempLTInletTempCount      = 0   ! Counter for exhaust temp &lt; combustion inlet air temp warning messages</span>
<a name="ln-10630"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ExhHRLTInletHRIndex</span>          <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to exhaust hum rat &lt; combustion inlet air hum rat warning messages</span>
<a name="ln-10631"></a><span class="c">!       INTEGER    :: ExhHRLTInletHRCount          = 0   ! Counter for exhaust hum rat &lt; combustion inlet air hum rat warn messages</span>
<a name="ln-10632"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">AnciPowerIterErrorIndex</span>      <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to Ancillary Power iteration loop warning messages</span>
<a name="ln-10633"></a><span class="c">!       INTEGER    :: AnciPowerIterErrorCount      = 0   ! Count for Ancillary Power iteration loop warning messages</span>
<a name="ln-10634"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">AnciPowerFMdotFuelErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to Ancillary Power as a function of fuel input warning messages</span>
<a name="ln-10635"></a><span class="c">!       INTEGER    :: AnciPowerFMdotFuelErrorCount = 0   ! Count for Ancillary Power as a function of fuel input warning messages</span>
<a name="ln-10636"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatRecRateFPLRErrorIndex</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to heat recovery rate as a function of PLR warning messages</span>
<a name="ln-10637"></a><span class="c">!       INTEGER    :: HeatRecRateFPLRErrorCount    = 0   ! Count for heat recovery rate as a function of PLR warning messages</span>
<a name="ln-10638"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatRecRateFTempErrorIndex</span>   <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to heat recovery rate as a function of temp warning messages</span>
<a name="ln-10639"></a><span class="c">!       INTEGER    :: HeatRecRateFTempErrorCount   = 0   ! Count for heat recovery rate as a function of temp warning messages</span>
<a name="ln-10640"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HeatRecRateFFlowErrorIndex</span>   <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to heat recovery rate as a function of flow warning messages</span>
<a name="ln-10641"></a><span class="c">!       INTEGER    :: HeatRecRateFFlowErrorCount   = 0   ! Count for heat recovery rate as a function of flow warning messages</span>
<a name="ln-10642"></a>       <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ThermEffFTempElevErrorIndex</span>  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to thermal efficiency as a function of temp/elevation warnings</span>
<a name="ln-10643"></a><span class="c">!       INTEGER    :: ThermEffFTempElevErrorCount  = 0   ! Count for thermal efficiency as a function of temp/elevation warnings</span>
<a name="ln-10644"></a>
<a name="ln-10645"></a><span class="k">END TYPE </span><span class="n">MTGeneratorSpecs</span>
<a name="ln-10646"></a>
<a name="ln-10647"></a><span class="k">TYPE </span><span class="n">ReportVars</span>
<a name="ln-10648"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PowerGen</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reporting: Electric power produced (W)</span>
<a name="ln-10649"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnergyGen</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reporting: Electric energy produced (J)</span>
<a name="ln-10650"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QHeatRecovered</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reporting: Heat recovered from exhaust to heat water (W)</span>
<a name="ln-10651"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExhaustEnergyRec</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reporting: Heat recovered from exhaust to heat water (J)</span>
<a name="ln-10652"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FuelEnergyUseRateHHV</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reporting: Fuel Energy use rate, HHV basis (W)</span>
<a name="ln-10653"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FuelEnergyHHV</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reporting: Fuel Energy used (J)</span>
<a name="ln-10654"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FuelMdot</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reporting: Fuel Amount used (kg/s)</span>
<a name="ln-10655"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElectricEfficiencyLHV</span>   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reporting: Electric efficiency LHV (-)</span>
<a name="ln-10656"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThermalEfficiencyLHV</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reporting: Thermal (heat recovery to water) efficiency LHV (-)</span>
<a name="ln-10657"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatRecInletTemp</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reporting: Heat Recovery Loop Inlet Temperature (C)</span>
<a name="ln-10658"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatRecOutletTemp</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reporting: Heat Recovery Loop Outlet Temperature (C)</span>
<a name="ln-10659"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatRecMdot</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reporting: Heat Recovery Loop Mass flow rate (kg/s)</span>
<a name="ln-10660"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AncillaryPowerRate</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reporting: Ancillary power use rate (W)</span>
<a name="ln-10661"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AncillaryEnergy</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reporting: Ancillary energy use (J)</span>
<a name="ln-10662"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StandbyPowerRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reporting: Standby power use rate (W)</span>
<a name="ln-10663"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StandbyEnergy</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Reporting: Standby energy use (J)</span>
<a name="ln-10664"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ExhAirMassFlowRate</span>       <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! Actual Exhaust Air Mass Flow Rate (kg/s)</span>
<a name="ln-10665"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ExhAirTemperature</span>        <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! Combustion exhaust air temperature (C)</span>
<a name="ln-10666"></a><span class="k">END TYPE </span><span class="n">ReportVars</span>
<a name="ln-10667"></a>
<a name="ln-10668"></a>
<a name="ln-10669"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-10670"></a><span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">NumMTGenerators</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c">! number of MT Generators specified in input</span>
<a name="ln-10671"></a><span class="kt">LOGICAL</span>            <span class="kd">::</span> <span class="n">GetMTInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="c">! then TRUE, calls subroutine to read input file.</span>
<a name="ln-10672"></a>
<a name="ln-10673"></a><span class="k">TYPE</span><span class="p">(</span><span class="n">MTGeneratorSpecs</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MTGenerator</span>  <span class="c">! dimension to number of generators</span>
<a name="ln-10674"></a><span class="k">TYPE</span><span class="p">(</span><span class="n">ReportVars</span><span class="p">),</span>       <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MTGeneratorReport</span>
<a name="ln-10675"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckEquipName</span>
<a name="ln-10676"></a>
<a name="ln-10677"></a>
<a name="ln-10678"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE MicroturbineElectricGenerator</span>
<a name="ln-10679"></a><span class="k">PUBLIC     </span><span class="n">SimMTGenerator</span>
<a name="ln-10680"></a><span class="k">PRIVATE    </span><span class="n">GetMTGeneratorInput</span>
<a name="ln-10681"></a><span class="k">PRIVATE    </span><span class="n">InitMTGenerators</span>
<a name="ln-10682"></a><span class="k">PRIVATE    </span><span class="n">CalcMTGeneratorModel</span>
<a name="ln-10683"></a><span class="k">PRIVATE    </span><span class="n">UpdateMTGeneratorRecords</span>
<a name="ln-10684"></a><span class="k">PUBLIC     </span><span class="n">GetMTGeneratorResults</span>
<a name="ln-10685"></a><span class="k">PUBLIC     </span><span class="n">SimMTPlantHeatRecovery</span>
<a name="ln-10686"></a><span class="k">PUBLIC </span><span class="n">GetMTGeneratorExhaustNode</span>
<a name="ln-10687"></a>
<a name="ln-10688"></a><span class="k">CONTAINS</span>
<a name="ln-10689"></a>          <span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-10690"></a><span class="c">! Beginning of MT Generator Module Driver Subroutine</span>
<a name="ln-10691"></a><span class="c">!*************************************************************************</span>
<a name="ln-10692"></a>
<a name="ln-10693"></a><span class="k">SUBROUTINE </span><span class="n">SimMTGenerator</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span><span class="n">GeneratorName</span><span class="p">,</span><span class="n">GeneratorIndex</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-10694"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10695"></a>          <span class="c">!       AUTHOR         R. Raustad/D. Shirey</span>
<a name="ln-10696"></a>          <span class="c">!       DATE WRITTEN   Mar 2008</span>
<a name="ln-10697"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10698"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10699"></a>
<a name="ln-10700"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE: This is the MT Generator driver subroutine. It gets the input</span>
<a name="ln-10701"></a>          <span class="c">!                             for the model, initializes simulation variables, calls</span>
<a name="ln-10702"></a>          <span class="c">!                             the appropriate model and updates reporting variables.</span>
<a name="ln-10703"></a>
<a name="ln-10704"></a>          <span class="c">! METHODOLOGY EMPLOYED:       Uses empirical models based on manufacturers data</span>
<a name="ln-10705"></a>
<a name="ln-10706"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10707"></a>          <span class="c">!  na</span>
<a name="ln-10708"></a>
<a name="ln-10709"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10710"></a>
<a name="ln-10711"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-10712"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-10713"></a>
<a name="ln-10714"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-10715"></a>
<a name="ln-10716"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10717"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">GeneratorType</span>      <span class="c">! Type of generator !unused1208</span>
<a name="ln-10718"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorName</span>      <span class="c">! User-specified name of generator</span>
<a name="ln-10719"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">GeneratorIndex</span>     <span class="c">! Index to microturbine generator</span>
<a name="ln-10720"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">RunFlag</span>            <span class="c">! Simulate generator when TRUE</span>
<a name="ln-10721"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">MyLoad</span>             <span class="c">! Generator demand (W)</span>
<a name="ln-10722"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! Simulation flag for First HVAC (system) iteration</span>
<a name="ln-10723"></a>
<a name="ln-10724"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10725"></a>          <span class="c">! na</span>
<a name="ln-10726"></a>
<a name="ln-10727"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10728"></a>          <span class="c">! na</span>
<a name="ln-10729"></a>
<a name="ln-10730"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10731"></a>          <span class="c">! na</span>
<a name="ln-10732"></a>
<a name="ln-10733"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10734"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">GenNum</span>           <span class="c">! Generator number counter</span>
<a name="ln-10735"></a>
<a name="ln-10736"></a>
<a name="ln-10737"></a>          <span class="c">! Get Generator data from input file</span>
<a name="ln-10738"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetMTInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10739"></a><span class="k">    CALL </span><span class="n">GetMTGeneratorInput</span>
<a name="ln-10740"></a>    <span class="n">GetMTInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10741"></a>  <span class="k">END IF</span>
<a name="ln-10742"></a>
<a name="ln-10743"></a>
<a name="ln-10744"></a>
<a name="ln-10745"></a>        <span class="c">! SELECT and CALL GENERATOR MODEL</span>
<a name="ln-10746"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GeneratorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10747"></a><span class="k">    </span><span class="n">GenNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumMTGenerators</span><span class="p">)</span>
<a name="ln-10748"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GenNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimMTGenerator: Specified Generator not a valid COMBUSTION Turbine Generator &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10749"></a>                                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">))</span>
<a name="ln-10750"></a>    <span class="n">GeneratorIndex</span> <span class="o">=</span> <span class="n">GenNum</span>
<a name="ln-10751"></a>  <span class="k">ELSE</span>
<a name="ln-10752"></a><span class="k">    </span><span class="n">GenNum</span> <span class="o">=</span> <span class="n">GeneratorIndex</span>
<a name="ln-10753"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GenNum</span> <span class="o">&gt;</span> <span class="n">NumMTGenerators</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">GenNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10754"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimMTGenerator: Invalid GeneratorIndex passed = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">GenNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10755"></a>                          <span class="s1">&#39;, Number of CT Engine Generators = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumMTGenerators</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10756"></a>                          <span class="s1">&#39;, Generator name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">))</span>
<a name="ln-10757"></a>    <span class="k">END IF</span>
<a name="ln-10758"></a>
<a name="ln-10759"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">GenNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10760"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GeneratorName</span> <span class="o">/=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10761"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimMTGenerator: Invalid GeneratorIndex passed = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">GenNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10762"></a>                            <span class="s1">&#39;, Generator name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Generator Name for that index = &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10763"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10764"></a>      <span class="k">END IF</span>
<a name="ln-10765"></a><span class="k">      </span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-10766"></a>    <span class="n">ENDIF</span>
<a name="ln-10767"></a>  <span class="k">END IF</span>
<a name="ln-10768"></a>
<a name="ln-10769"></a><span class="k">  CALL </span><span class="n">InitMTGenerators</span><span class="p">(</span><span class="n">GenNum</span><span class="p">,</span> <span class="n">Runflag</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-10770"></a>  <span class="k">CALL </span><span class="n">CalcMTGeneratorModel</span><span class="p">(</span><span class="n">GenNum</span><span class="p">,</span><span class="n">Runflag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-10771"></a>  <span class="k">CALL </span><span class="n">UpdateMTGeneratorRecords</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)</span>
<a name="ln-10772"></a>
<a name="ln-10773"></a>  <span class="k">RETURN</span>
<a name="ln-10774"></a>
<a name="ln-10775"></a><span class="k">END SUBROUTINE </span><span class="n">SimMTGenerator</span>
<a name="ln-10776"></a>
<a name="ln-10777"></a><span class="k">SUBROUTINE </span><span class="n">SimMTPlantHeatRecovery</span><span class="p">(</span><span class="n">CompType</span><span class="p">,</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompTypeNum</span><span class="p">,</span><span class="n">CompNum</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">InitLoopEquip</span><span class="p">,</span>  <span class="p">&amp;</span>   <span class="c">!DSU</span>
<a name="ln-10778"></a>                          <span class="n">MyLoad</span><span class="p">,</span><span class="n">MaxCap</span><span class="p">,</span><span class="n">MinCap</span><span class="p">,</span><span class="n">OptCap</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-10779"></a>
<a name="ln-10780"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10781"></a>          <span class="c">!       AUTHOR         BGriffith</span>
<a name="ln-10782"></a>          <span class="c">!       DATE WRITTEN   March 2008</span>
<a name="ln-10783"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10784"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10785"></a>
<a name="ln-10786"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10787"></a>          <span class="c">! Fill data needed in PlantLoopEquipments</span>
<a name="ln-10788"></a>
<a name="ln-10789"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10790"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-10791"></a>
<a name="ln-10792"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10793"></a>          <span class="c">! na</span>
<a name="ln-10794"></a>
<a name="ln-10795"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10796"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-10797"></a>
<a name="ln-10798"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10799"></a>
<a name="ln-10800"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10801"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompType</span> <span class="c">!unused1208</span>
<a name="ln-10802"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompName</span>
<a name="ln-10803"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CompTypeNum</span> <span class="c">!unused1208</span>
<a name="ln-10804"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">CompNum</span>
<a name="ln-10805"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">RunFlag</span> <span class="c">!unused1208</span>
<a name="ln-10806"></a> <span class="c">! INTEGER, INTENT(IN)          :: FlowLock !unused1208 !DSU</span>
<a name="ln-10807"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">InitLoopEquip</span>
<a name="ln-10808"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MyLoad</span> <span class="c">!unused1208</span>
<a name="ln-10809"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">MinCap</span>
<a name="ln-10810"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">MaxCap</span>
<a name="ln-10811"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">OptCap</span>
<a name="ln-10812"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! TRUE if First iteration of simulation !unused1208</span>
<a name="ln-10813"></a>
<a name="ln-10814"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10815"></a>          <span class="c">! na</span>
<a name="ln-10816"></a>
<a name="ln-10817"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10818"></a>          <span class="c">! na</span>
<a name="ln-10819"></a>
<a name="ln-10820"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10821"></a>          <span class="c">! na</span>
<a name="ln-10822"></a>
<a name="ln-10823"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10824"></a>          <span class="c">! na</span>
<a name="ln-10825"></a>
<a name="ln-10826"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetMTInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10827"></a><span class="k">    CALL </span><span class="n">GetMTGeneratorInput</span>
<a name="ln-10828"></a>    <span class="n">GetMTInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10829"></a>  <span class="k">END IF</span>
<a name="ln-10830"></a>
<a name="ln-10831"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10832"></a><span class="k">    </span><span class="n">CompNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span> <span class="n">MTGenerator</span><span class="p">%</span><span class="n">name</span><span class="p">,</span> <span class="n">NumMTGenerators</span><span class="p">)</span>
<a name="ln-10833"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CompNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10834"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimMTPlantHeatRecovery: Microturbine Generator Unit not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-10835"></a>      <span class="k">RETURN</span>
<a name="ln-10836"></a><span class="k">    END IF</span>
<a name="ln-10837"></a><span class="k">      </span><span class="n">MinCap</span>  <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">MinThermalPowerOutput</span>
<a name="ln-10838"></a>      <span class="n">MaxCap</span>  <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">MaxThermalPowerOutput</span>
<a name="ln-10839"></a>      <span class="n">OptCap</span>  <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">RefThermalPowerOutput</span>
<a name="ln-10840"></a>      <span class="k">RETURN</span>
<a name="ln-10841"></a><span class="k">  END IF</span> <span class="c">! End Of InitLoopEquip</span>
<a name="ln-10842"></a>
<a name="ln-10843"></a>  <span class="k">RETURN</span>
<a name="ln-10844"></a>
<a name="ln-10845"></a><span class="k">END SUBROUTINE </span><span class="n">SimMTPlantHeatRecovery</span>
<a name="ln-10846"></a>
<a name="ln-10847"></a>
<a name="ln-10848"></a><span class="c">! End MT Generator Module Driver Subroutine</span>
<a name="ln-10849"></a><span class="c">!******************************************************************************</span>
<a name="ln-10850"></a>
<a name="ln-10851"></a>
<a name="ln-10852"></a><span class="c">! Beginning of Microturbine (MT) Generator Module Get Input Subroutine</span>
<a name="ln-10853"></a><span class="c">!******************************************************************************</span>
<a name="ln-10854"></a>
<a name="ln-10855"></a>
<a name="ln-10856"></a><span class="k">SUBROUTINE </span><span class="n">GetMTGeneratorInput</span>
<a name="ln-10857"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10858"></a>            <span class="c">!       AUTHOR         R. Raustad/D. Shirey</span>
<a name="ln-10859"></a>            <span class="c">!       DATE WRITTEN   Mar 2008</span>
<a name="ln-10860"></a>            <span class="c">!       MODIFIED       na</span>
<a name="ln-10861"></a>            <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10862"></a>
<a name="ln-10863"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10864"></a>            <span class="c">!  This routine gets the input information for the Microturbine (MT) Generator model.</span>
<a name="ln-10865"></a>
<a name="ln-10866"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10867"></a>            <span class="c">!  EnergyPlus input processor.</span>
<a name="ln-10868"></a>
<a name="ln-10869"></a>            <span class="c">! REFERENCES:</span>
<a name="ln-10870"></a>            <span class="c">!  na</span>
<a name="ln-10871"></a>
<a name="ln-10872"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-10873"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-10874"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurveIndex</span><span class="p">,</span> <span class="n">CurveValue</span><span class="p">,</span> <span class="n">GetCurveType</span><span class="p">,</span> <span class="n">GetCurveMinMaxValues</span>
<a name="ln-10875"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-10876"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>  <span class="c">! Data for field names, blank numerics</span>
<a name="ln-10877"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-10878"></a>  <span class="k">USE </span><span class="n">OutAirNodeManager</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">CheckOutAirNodeNumber</span>
<a name="ln-10879"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span>
<a name="ln-10880"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span>  <span class="n">RoundSigDigits</span>
<a name="ln-10881"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyRhoAirFnPbTdbW</span>
<a name="ln-10882"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-10883"></a>
<a name="ln-10884"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">!</span>
<a name="ln-10885"></a>
<a name="ln-10886"></a>            <span class="c">! PARAMETERS:</span>
<a name="ln-10887"></a>            <span class="c">!  na</span>
<a name="ln-10888"></a>
<a name="ln-10889"></a>            <span class="c">! LOCAL VARIABLES:</span>
<a name="ln-10890"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">GeneratorNum</span>             <span class="c">! Index to generator</span>
<a name="ln-10891"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">NumAlphas</span>                <span class="c">! Number of elements in the alpha array</span>
<a name="ln-10892"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">NumNums</span>                  <span class="c">! Number of elements in the numeric array</span>
<a name="ln-10893"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">IOStat</span>                   <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-10894"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>      <span class="c">! Error flag... trips fatal error message at end of get input</span>
<a name="ln-10895"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsNotOK</span>                  <span class="c">! Flag to verify name</span>
<a name="ln-10896"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">IsBlank</span>                  <span class="c">! Flag for blank name</span>
<a name="ln-10897"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">ElectOutFTempElevOutput</span>  <span class="c">! Output of Electrical Power Output Modifier Curve (function of temp and elev)</span>
<a name="ln-10898"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">ElecEfficFTempOutput</span>     <span class="c">! Output of Electrical Efficiency Modifier Curve (function of temp)</span>
<a name="ln-10899"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">ElecEfficFPLROutput</span>      <span class="c">! Output of Electrical Efficiency Modifier Curve (function of PLR)</span>
<a name="ln-10900"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">AncillaryPowerOutput</span>     <span class="c">! Output of Ancillary Power Modifer Curve (function of temps and fuel flow)</span>
<a name="ln-10901"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">RefFuelUseMdot</span>           <span class="c">! Fuel mass flow rate at reference conditions (kg/s)</span>
<a name="ln-10902"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">RefBaroPressure</span>          <span class="c">! Reference barometric pressure, adjusted for reference elevation (Pa)</span>
<a name="ln-10903"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">ThermalEffTempElevOutput</span> <span class="c">! Output of Thermal Efficiency Modifier Curve (function of temp and elevation)</span>
<a name="ln-10904"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">HeatRecRateFPLROutput</span>    <span class="c">! Output of Heat Recovery Rate Modifier Curve (function of PLR)</span>
<a name="ln-10905"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">HeatRecRateFTempOutput</span>   <span class="c">! Output of Heat Recovery Rate Modifier Curve (function of inlet water temp)</span>
<a name="ln-10906"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">HeatRecRateFFlowOutput</span>   <span class="c">! Output of Heat Recovery Rate Modifier Curve (function of water flow rate)</span>
<a name="ln-10907"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">ExhFlowFTempOutput</span>       <span class="c">! Output of Exhaust Air Flow Modifier Curve (function of inlet air temp)</span>
<a name="ln-10908"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">ExhFlowFPLROutput</span>        <span class="c">! Output of Exhaust Air Flow Modifier Curve (function of PLR)</span>
<a name="ln-10909"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">ExhAirTempFTempOutput</span>    <span class="c">! Output of Exhaust Air Temperature Modifier Curve (function of inlet air temp)</span>
<a name="ln-10910"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">ExhOutAirTempFPLROutput</span>  <span class="c">! Output of Exhaust Air Temperature Modifier Curve (function of PLR)</span>
<a name="ln-10911"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">Var1Min</span><span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Minimum value for variable 1, value obtained from a curve object</span>
<a name="ln-10912"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">Var1Max</span><span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Maximum value for variable 1, value obtained from a curve object</span>
<a name="ln-10913"></a>
<a name="ln-10914"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>                   <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NumArray</span>      <span class="c">! Numeric data array</span>
<a name="ln-10915"></a>
<a name="ln-10916"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AlphArray</span> <span class="c">! Character string data array</span>
<a name="ln-10917"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">FuelType</span>  <span class="c">! Type of fuel used for generator</span>
<a name="ln-10918"></a>
<a name="ln-10919"></a>         <span class="c">! FLOW:</span>
<a name="ln-10920"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Generator:MicroTurbine&#39;</span>
<a name="ln-10921"></a>  <span class="n">NumMTGenerators</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-10922"></a>
<a name="ln-10923"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumMTGenerators</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10924"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; equipment specified in input file&#39;</span><span class="p">)</span>
<a name="ln-10925"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10926"></a>  <span class="k">END IF</span>
<a name="ln-10927"></a>
<a name="ln-10928"></a>         <span class="c">! ALLOCATE ARRAYS</span>
<a name="ln-10929"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">NumMTGenerators</span><span class="p">))</span>
<a name="ln-10930"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">NumMTGenerators</span><span class="p">))</span>
<a name="ln-10931"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">NumMTGenerators</span><span class="p">))</span>
<a name="ln-10932"></a>  <span class="n">CheckEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10933"></a>
<a name="ln-10934"></a>         <span class="c">! LOAD ARRAYS WITH MICROTURBINE GENERATOR DATA</span>
<a name="ln-10935"></a>  <span class="k">DO </span><span class="n">GeneratorNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumMTGenerators</span>
<a name="ln-10936"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">GeneratorNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10937"></a>                    <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10938"></a>                    <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-10939"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-10940"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-10941"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">MTGenerator</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">GeneratorNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-10942"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10943"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10944"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-10945"></a>    <span class="k">END IF</span>
<a name="ln-10946"></a><span class="k">    </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span>               <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10947"></a>
<a name="ln-10948"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecPowerOutput</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10949"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecPowerOutput</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10950"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-10951"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-10952"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than 0.&#39;</span><span class="p">)</span>
<a name="ln-10953"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10954"></a>    <span class="k">END IF</span>
<a name="ln-10955"></a>
<a name="ln-10956"></a><span class="k">    </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MinElecPowerOutput</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-10957"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxElecPowerOutput</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-10958"></a>
<a name="ln-10959"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MinElecPowerOutput</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10960"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-10961"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-10962"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than 0.&#39;</span><span class="p">)</span>
<a name="ln-10963"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10964"></a>    <span class="k">END IF</span>
<a name="ln-10965"></a>
<a name="ln-10966"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10967"></a><span class="k">       </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxElecPowerOutput</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecPowerOutput</span>
<a name="ln-10968"></a>    <span class="k">ELSE</span>
<a name="ln-10969"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxElecPowerOutput</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10970"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-10971"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-10972"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than 0.&#39;</span><span class="p">)</span>
<a name="ln-10973"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10974"></a>      <span class="k">END IF</span>
<a name="ln-10975"></a><span class="k">    END IF</span>
<a name="ln-10976"></a>
<a name="ln-10977"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MinElecPowerOutput</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxElecPowerOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10978"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10979"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] &gt; &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10980"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-10981"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Minimum Full Load Electrical Power Output must be less than or equal&#39;</span><span class="p">)</span>
<a name="ln-10982"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;to Maximum Full Load Electrical Power Output.&#39;</span><span class="p">)</span>
<a name="ln-10983"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10984"></a>    <span class="k">END IF</span>
<a name="ln-10985"></a>
<a name="ln-10986"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecPowerOutput</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxElecPowerOutput</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10987"></a>        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecPowerOutput</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MinElecPowerOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10988"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10989"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-10990"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &lt;= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-10991"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-10992"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-10993"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-10994"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10995"></a>    <span class="k">END IF</span>
<a name="ln-10996"></a>
<a name="ln-10997"></a><span class="k">    </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecEfficiencyLHV</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-10998"></a>
<a name="ln-10999"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecEfficiencyLHV</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11000"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-11001"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-11002"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than 0.&#39;</span><span class="p">)</span>
<a name="ln-11003"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11004"></a>    <span class="k">END IF</span>
<a name="ln-11005"></a>
<a name="ln-11006"></a><span class="k">    </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletTemp</span>   <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-11007"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletHumRat</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-11008"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElevation</span>             <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-11009"></a>
<a name="ln-11010"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletHumRat</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11011"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-11012"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-11013"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than 0.&#39;</span><span class="p">)</span>
<a name="ln-11014"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11015"></a>    <span class="k">ELSE</span>
<a name="ln-11016"></a><span class="c">!      Barometric pressure adjusted for elevation</span>
<a name="ln-11017"></a>       <span class="n">RefBaroPressure</span> <span class="o">=</span> <span class="mi">10132</span><span class="mf">5.0d0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="mf">2.25577D-05</span><span class="o">*</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElevation</span><span class="p">)</span><span class="o">**</span><span class="mf">5.2559d0</span>
<a name="ln-11018"></a>       <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">RefBaroPressure</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11019"></a>                  <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletTemp</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletHumRat</span><span class="p">)</span>
<a name="ln-11020"></a>    <span class="k">END IF</span>
<a name="ln-11021"></a>
<a name="ln-11022"></a><span class="k">    </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecPowFTempElevCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="c">! Convert curve name to number</span>
<a name="ln-11023"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecPowFTempElevCurveNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11024"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-11025"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-11026"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11027"></a>    <span class="k">ELSE</span>
<a name="ln-11028"></a>      <span class="c">! Verify curve object, only legal type is BiQuadratic</span>
<a name="ln-11029"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecPowFTempElevCurveNum</span><span class="p">))</span>
<a name="ln-11030"></a>
<a name="ln-11031"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-11032"></a>        <span class="c">! Check electrical power output at reference combustion inlet temp and elevation</span>
<a name="ln-11033"></a>        <span class="n">ElectOutFTempElevOutput</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecPowFTempElevCurveNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11034"></a>                                         <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11035"></a>                                         <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElevation</span><span class="p">)</span>
<a name="ln-11036"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ElectOutFTempElevOutput</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11037"></a><span class="k">         CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11038"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-11039"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output at reference conditions should equal 1 (+-10%).&#39;</span><span class="p">)</span>
<a name="ln-11040"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Reference combustion air inlet temperature = &#39;</span> <span class="p">&amp;</span>
<a name="ln-11041"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletTemp</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-11042"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Reference elevation                        = &#39;</span> <span class="p">&amp;</span>
<a name="ln-11043"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElevation</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m&#39;</span><span class="p">)</span>
<a name="ln-11044"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Curve output                               = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ElectOutFTempElevOutput</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-11045"></a>        <span class="k">END IF</span>
<a name="ln-11046"></a>
<a name="ln-11047"></a><span class="k">      CASE </span><span class="n">DEFAULT</span>
<a name="ln-11048"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11049"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11050"></a>                               <span class="s1">&#39; for this object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecPowFTempElevCurveNum</span><span class="p">)))</span>
<a name="ln-11051"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve type must be BIQUADRATIC.&#39;</span><span class="p">)</span> <span class="c">!TODO rename point (curves)</span>
<a name="ln-11052"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11053"></a>
<a name="ln-11054"></a>      <span class="k">END SELECT</span>
<a name="ln-11055"></a>
<a name="ln-11056"></a><span class="k">    END IF</span>
<a name="ln-11057"></a>
<a name="ln-11058"></a><span class="k">    </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecEffFTempCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="c">! Convert curve name to number</span>
<a name="ln-11059"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecEffFTempCurveNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11060"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11061"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-11062"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11063"></a>    <span class="k">ELSE</span>
<a name="ln-11064"></a>      <span class="c">! Verify curve object, only legal types are Quadratic and Cubic</span>
<a name="ln-11065"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecEffFTempCurveNum</span><span class="p">))</span>
<a name="ln-11066"></a>
<a name="ln-11067"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-11068"></a>        <span class="c">! Check electrical efficiency at reference combustion inlet temp</span>
<a name="ln-11069"></a>        <span class="n">ElecEfficFTempOutput</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecEffFTempCurveNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11070"></a>                                        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletTemp</span><span class="p">)</span>
<a name="ln-11071"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ElecEfficFTempOutput</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11072"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11073"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-11074"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output at reference condition should equal 1 (+-10%).&#39;</span><span class="p">)</span>
<a name="ln-11075"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Reference combustion air inlet temperature = &#39;</span> <span class="p">&amp;</span>
<a name="ln-11076"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletTemp</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-11077"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output                               = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ElecEfficFTempOutput</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-11078"></a>        <span class="k">END IF</span>
<a name="ln-11079"></a>
<a name="ln-11080"></a><span class="k">      CASE </span><span class="n">DEFAULT</span>
<a name="ln-11081"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11082"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11083"></a>                               <span class="s1">&#39; for this object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecEffFTempCurveNum</span><span class="p">)))</span>
<a name="ln-11084"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be QUADRATIC or CUBIC.&#39;</span><span class="p">)</span> <span class="c">!TODO rename point (curves)</span>
<a name="ln-11085"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11086"></a>
<a name="ln-11087"></a>      <span class="k">END SELECT</span>
<a name="ln-11088"></a>
<a name="ln-11089"></a><span class="k">    END IF</span>
<a name="ln-11090"></a>
<a name="ln-11091"></a><span class="k">    </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecEffFPLRCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="c">! Convert curve name to number</span>
<a name="ln-11092"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecEffFPLRCurveNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11093"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11094"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-11095"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11096"></a>    <span class="k">ELSE</span>
<a name="ln-11097"></a>      <span class="c">! Verify curve object, only legal types are Quadratic and Cubic</span>
<a name="ln-11098"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecEffFPLRCurveNum</span><span class="p">))</span>
<a name="ln-11099"></a>
<a name="ln-11100"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-11101"></a>        <span class="c">! Check electrical efficiency at PLR = 1</span>
<a name="ln-11102"></a>        <span class="n">ElecEfficFPLROutput</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecEffFPLRCurveNum</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-11103"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ElecEfficFPLROutput</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11104"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11105"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-11106"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output at a part-load ratio of 1 should equal 1 (+-10%).&#39;</span><span class="p">)</span>
<a name="ln-11107"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ElecEfficFPLROutput</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-11108"></a>        <span class="k">END IF</span>
<a name="ln-11109"></a>
<a name="ln-11110"></a><span class="k">        CALL </span><span class="n">GetCurveMinMaxValues</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecEffFPLRCurveNum</span><span class="p">,</span><span class="n">Var1Min</span><span class="p">,</span><span class="n">Var1Max</span><span class="p">)</span>
<a name="ln-11111"></a>        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MinPartLoadRat</span>     <span class="o">=</span> <span class="n">Var1Min</span>
<a name="ln-11112"></a>        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxPartLoadRat</span>     <span class="o">=</span> <span class="n">Var1Max</span>
<a name="ln-11113"></a>
<a name="ln-11114"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-11115"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11116"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11117"></a>                               <span class="s1">&#39; for this object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecEffFPLRCurveNum</span><span class="p">)))</span>
<a name="ln-11118"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be QUADRATIC or CUBIC.&#39;</span><span class="p">)</span> <span class="c">!TODO rename point (curves)</span>
<a name="ln-11119"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11120"></a>
<a name="ln-11121"></a>      <span class="k">END SELECT</span>
<a name="ln-11122"></a>
<a name="ln-11123"></a><span class="k">    END IF</span>
<a name="ln-11124"></a>
<a name="ln-11125"></a>    <span class="c">! Fuel Type case statement</span>
<a name="ln-11126"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-11127"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">)</span> <span class="c">! If blank, then the default is Natural Gas</span>
<a name="ln-11128"></a>      <span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Gas&#39;</span>
<a name="ln-11129"></a>
<a name="ln-11130"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURALGAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURAL GAS&#39;</span><span class="p">)</span>
<a name="ln-11131"></a>      <span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Gas&#39;</span>
<a name="ln-11132"></a>
<a name="ln-11133"></a><span class="c">!    CASE (&#39;DIESEL&#39;)</span>
<a name="ln-11134"></a><span class="c">!      FuelType = &#39;Diesel&#39;</span>
<a name="ln-11135"></a>
<a name="ln-11136"></a><span class="c">!    CASE (&#39;GASOLINE&#39;)</span>
<a name="ln-11137"></a><span class="c">!      FuelType = &#39;Gasoline&#39;</span>
<a name="ln-11138"></a>
<a name="ln-11139"></a><span class="c">!    CASE (&#39;FUEL OIL #1&#39;,&#39;FUELOIL#1&#39;,&#39;FUEL OIL&#39;,&#39;DISTILLATE OIL&#39;)</span>
<a name="ln-11140"></a><span class="c">!      FuelType = &#39;FuelOil#1&#39;</span>
<a name="ln-11141"></a>
<a name="ln-11142"></a><span class="c">!    CASE (&#39;FUEL OIL #2&#39;,&#39;FUELOIL#2&#39;,&#39;RESIDUAL OIL&#39;)</span>
<a name="ln-11143"></a><span class="c">!      FuelType = &#39;FuelOil#2&#39;</span>
<a name="ln-11144"></a>
<a name="ln-11145"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;PROPANE&#39;</span><span class="p">,</span><span class="s1">&#39;LPG&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANEGAS&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANE GAS&#39;</span><span class="p">)</span>
<a name="ln-11146"></a>      <span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Propane&#39;</span>
<a name="ln-11147"></a>
<a name="ln-11148"></a><span class="c">!    CASE (&#39;OTHERFUEL1&#39;)</span>
<a name="ln-11149"></a><span class="c">!       FuelType = &#39;OtherFuel1&#39;</span>
<a name="ln-11150"></a>
<a name="ln-11151"></a><span class="c">!    CASE (&#39;OTHERFUEL2&#39;)</span>
<a name="ln-11152"></a><span class="c">!       FuelType = &#39;OtherFuel2&#39;</span>
<a name="ln-11153"></a>
<a name="ln-11154"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-11155"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11156"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-11157"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11158"></a>    <span class="k">END SELECT</span>
<a name="ln-11159"></a>
<a name="ln-11160"></a><span class="k">    </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelHigherHeatingValue</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-11161"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelLowerHeatingValue</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-11162"></a>
<a name="ln-11163"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelLowerHeatingValue</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11164"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-11165"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-11166"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than 0.&#39;</span><span class="p">)</span>
<a name="ln-11167"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11168"></a>    <span class="k">END IF</span>
<a name="ln-11169"></a>
<a name="ln-11170"></a><span class="k">    IF</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelHigherHeatingValue</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11171"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-11172"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-11173"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than 0.&#39;</span><span class="p">)</span>
<a name="ln-11174"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11175"></a>    <span class="k">END IF</span>
<a name="ln-11176"></a>
<a name="ln-11177"></a><span class="k">    IF</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelLowerHeatingValue</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelHigherHeatingValue</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11178"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11179"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than the &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-11180"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-11181"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-11182"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-11183"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11184"></a>    <span class="k">END IF</span>
<a name="ln-11185"></a>
<a name="ln-11186"></a><span class="k">    </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StandbyPower</span>   <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-11187"></a>    <span class="k">IF</span><span class="p">(</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StandbyPower</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11188"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-11189"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-11190"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than 0.&#39;</span><span class="p">)</span>
<a name="ln-11191"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Resetting to 0 and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-11192"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StandbyPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11193"></a>    <span class="k">END IF</span>
<a name="ln-11194"></a>
<a name="ln-11195"></a><span class="k">    </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPower</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-11196"></a>    <span class="k">IF</span><span class="p">(</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPower</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11197"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-11198"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-11199"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than 0.&#39;</span><span class="p">)</span>
<a name="ln-11200"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Resetting to 0 and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-11201"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11202"></a>    <span class="k">END IF</span>
<a name="ln-11203"></a>
<a name="ln-11204"></a><span class="k">    </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPowerFuelCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="c">! Convert curve name to number</span>
<a name="ln-11205"></a><span class="c">!   If blank, then the calc routine assumes modifier curve value = 1 for entire simulation</span>
<a name="ln-11206"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPowerFuelCurveNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11207"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-11208"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-11209"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11210"></a>    <span class="k">ELSE IF</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPowerFuelCurveNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11211"></a>      <span class="c">! Verify curve object, only legal type is Quadratic</span>
<a name="ln-11212"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPowerFuelCurveNum</span><span class="p">))</span>
<a name="ln-11213"></a>
<a name="ln-11214"></a>      <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-11215"></a>
<a name="ln-11216"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelLowerHeatingValue</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11217"></a>         <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecEfficiencyLHV</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11218"></a>
<a name="ln-11219"></a><span class="k">        </span><span class="n">RefFuelUseMdot</span> <span class="o">=</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecPowerOutput</span> <span class="o">/</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecEfficiencyLHV</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-11220"></a>                      <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelLowerHeatingValue</span>  <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-11221"></a>        <span class="n">AncillaryPowerOutput</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPowerFuelCurveNum</span><span class="p">,</span> <span class="n">RefFuelUseMdot</span><span class="p">)</span>
<a name="ln-11222"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">AncillaryPowerOutput</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11223"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11224"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-11225"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output at reference conditions should equal 1 (+-10%).&#39;</span><span class="p">)</span>
<a name="ln-11226"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Reference Electrical Power Output           = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11227"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecPowerOutput</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-11228"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Reference Electrical Efficiency (LHV basis) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11229"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecEfficiencyLHV</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-11230"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Fuel Lower Heating Value                    = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11231"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelLowerHeatingValue</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kJ/kg&#39;</span><span class="p">)</span>
<a name="ln-11232"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Calculated fuel flow                        = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11233"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RefFuelUseMdot</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s&#39;</span><span class="p">)</span>
<a name="ln-11234"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output                                = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11235"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">AncillaryPowerOutput</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-11236"></a>        <span class="k">END IF</span>
<a name="ln-11237"></a><span class="k">      END IF</span>
<a name="ln-11238"></a>
<a name="ln-11239"></a><span class="k">      CASE </span><span class="n">DEFAULT</span>
<a name="ln-11240"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11241"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11242"></a>                               <span class="s1">&#39; for this object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPowerFuelCurveNum</span><span class="p">)))</span>
<a name="ln-11243"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve type must be QUADRATIC.&#39;</span><span class="p">)</span>
<a name="ln-11244"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11245"></a>
<a name="ln-11246"></a>      <span class="k">END SELECT</span>
<a name="ln-11247"></a>
<a name="ln-11248"></a><span class="k">    END IF</span>
<a name="ln-11249"></a>
<a name="ln-11250"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11251"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-11252"></a>                 <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11253"></a>                 <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-11254"></a>    <span class="k">END IF</span>
<a name="ln-11255"></a>
<a name="ln-11256"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11257"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-11258"></a>                 <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11259"></a>                 <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-11260"></a>    <span class="k">END IF</span>
<a name="ln-11261"></a>
<a name="ln-11262"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11263"></a>        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11264"></a><span class="k">      CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;Heat Recovery Nodes&#39;</span><span class="p">)</span>
<a name="ln-11265"></a>    <span class="k">END IF</span>
<a name="ln-11266"></a>
<a name="ln-11267"></a><span class="k">    IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11268"></a>         <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11269"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11270"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... If one Heat Recovery Water Node Name is specified, then both the Inlet and Outlet Heat Recovery&#39;</span><span class="p">)</span>
<a name="ln-11271"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Water Node Names must be specified. Only one water node is being specified for this generator.&#39;</span><span class="p">)</span>
<a name="ln-11272"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11273"></a>    <span class="k">END IF</span>
<a name="ln-11274"></a>
<a name="ln-11275"></a><span class="c">!   Heat recovery to water input fields only valid if water nodes are defined</span>
<a name="ln-11276"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11277"></a>        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11278"></a>
<a name="ln-11279"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11280"></a>
<a name="ln-11281"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefThermalEffLHV</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-11282"></a>      <span class="k">IF</span><span class="p">(</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefThermalEffLHV</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11283"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11284"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0.&#39;</span><span class="p">)</span>
<a name="ln-11285"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Resetting to 0 and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-11286"></a>        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefThermalEffLHV</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11287"></a>      <span class="k">END IF</span>
<a name="ln-11288"></a>
<a name="ln-11289"></a>      <span class="c">! Next store thermal power output ranges using nominal thermal to electrical efficiency ratio and electrical power data</span>
<a name="ln-11290"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefThermalPowerOutput</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecPowerOutput</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-11291"></a>                          <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefThermalEffLHV</span> <span class="o">/</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecEfficiencyLHV</span>
<a name="ln-11292"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MinThermalPowerOutput</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MinElecPowerOutput</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-11293"></a>                          <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefThermalEffLHV</span> <span class="o">/</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecEfficiencyLHV</span>
<a name="ln-11294"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxThermalPowerOutput</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxElecPowerOutput</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-11295"></a>                          <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefThermalEffLHV</span> <span class="o">/</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecEfficiencyLHV</span>
<a name="ln-11296"></a>
<a name="ln-11297"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefInletWaterTemp</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-11298"></a>
<a name="ln-11299"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="s1">&#39;InternalControl&#39;</span><span class="p">))</span>  <span class="k">THEN</span>
<a name="ln-11300"></a><span class="k">        </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">InternalFlowControl</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">!  A9, \field Heat Recovery Water Flow Operating Mode</span>
<a name="ln-11301"></a>        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PlantFlowControl</span>    <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-11302"></a>      <span class="k">END IF</span>
<a name="ln-11303"></a><span class="k">      IF</span> <span class="p">(</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="s1">&#39;InternalControl&#39;</span><span class="p">)))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11304"></a>           <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="s1">&#39;PlantControl&#39;</span><span class="p">)))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11305"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-11306"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-11307"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Operating Mode must be INTERNAL CONTROL or PLANT CONTROL.&#39;</span><span class="p">)</span>
<a name="ln-11308"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11309"></a>      <span class="k">END IF</span>
<a name="ln-11310"></a>
<a name="ln-11311"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefHeatRecVolFlowRate</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-11312"></a>
<a name="ln-11313"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefHeatRecVolFlowRate</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11314"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-11315"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-11316"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than 0.&#39;</span><span class="p">)</span>
<a name="ln-11317"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11318"></a>      <span class="k">END IF</span>
<a name="ln-11319"></a>
<a name="ln-11320"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">InternalFlowControl</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Get Heat Recovery Water Flow Rate Modifier Curve</span>
<a name="ln-11321"></a>
<a name="ln-11322"></a>        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecFlowFTempPowCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<a name="ln-11323"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecFlowFTempPowCurveNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11324"></a>          <span class="c">! Verify curve object, only legal type is BiQuadratic</span>
<a name="ln-11325"></a>          <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecFlowFTempPowCurveNum</span><span class="p">))</span>
<a name="ln-11326"></a>
<a name="ln-11327"></a>          <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-11328"></a><span class="c">!          NEED TO FIGURE OUT WHAT TO USE FOR Pnet............Shirey</span>
<a name="ln-11329"></a><span class="c">!</span>
<a name="ln-11330"></a><span class="c">!    HeatRecFlowFTempPowCurveOutput = CurveValue(MTGenerator(GeneratorNum)%HeatRecFlowFTempPowCurveNum, Pnet)</span>
<a name="ln-11331"></a><span class="c">!    IF(ABS(HeatRecFlowFTempPowCurveOutput-1.0d0) .GT. 0.1d0)THEN !</span>
<a name="ln-11332"></a><span class="c">!      CALL ShowWarningError(&#39;GENERATOR:MICROTURBINE &quot;&#39;//TRIM(MTGenerator(GeneratorNum)%Name)//&#39;&quot;&#39;)</span>
<a name="ln-11333"></a><span class="c">!      CALL ShowContinueError(&#39;Heat Recovery Water Flow Rate Modifier Curve (function of temp and power) = &#39;//TRIM(AlphArray(10)))</span>
<a name="ln-11334"></a><span class="c">!      CALL ShowContinueError(&#39;... Curve ouput at a reference conditions should equal 1 (+-10%).&#39;)</span>
<a name="ln-11335"></a><span class="c">!      CALL ShowContinueError(&#39;... Curve output = &#39;//TRIM(TrimSigDigits(HeatRecFlowFTempPowCurveOutput,4)))</span>
<a name="ln-11336"></a><span class="c">!    END IF</span>
<a name="ln-11337"></a>
<a name="ln-11338"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-11339"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11340"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11341"></a>                                <span class="s1">&#39; for this object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecFlowFTempPowCurveNum</span><span class="p">)))</span>
<a name="ln-11342"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BIQUADRATIC.&#39;</span><span class="p">)</span>
<a name="ln-11343"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11344"></a>
<a name="ln-11345"></a>          <span class="k">END SELECT</span>
<a name="ln-11346"></a>
<a name="ln-11347"></a><span class="k">        END IF</span>
<a name="ln-11348"></a>
<a name="ln-11349"></a><span class="k">      END IF</span> <span class="c">! End of IF (MTGenerator(GeneratorNum)%InternalFlowControl) THEN</span>
<a name="ln-11350"></a>
<a name="ln-11351"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ThermEffFTempElevCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-11352"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ThermEffFTempElevCurveNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11353"></a>        <span class="c">! Verify curve object, only legal types are BiQuadratic and BiCubic</span>
<a name="ln-11354"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ThermEffFTempElevCurveNum</span><span class="p">))</span>
<a name="ln-11355"></a>
<a name="ln-11356"></a>        <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;BICUBIC&#39;</span><span class="p">)</span>
<a name="ln-11357"></a>
<a name="ln-11358"></a>          <span class="n">ThermalEffTempElevOutput</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ThermEffFTempElevCurveNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11359"></a>                                                <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11360"></a>                                                <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElevation</span><span class="p">)</span>
<a name="ln-11361"></a>
<a name="ln-11362"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ThermalEffTempElevOutput</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11363"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11364"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span>  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
<a name="ln-11365"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output at reference conditions should equal 1 (+-10%).&#39;</span><span class="p">)</span>
<a name="ln-11366"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Reference combustion air inlet temperature      = &#39;</span> <span class="p">&amp;</span>
<a name="ln-11367"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletTemp</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-11368"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Reference elevation                             = &#39;</span> <span class="p">&amp;</span>
<a name="ln-11369"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElevation</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m&#39;</span><span class="p">)</span>
<a name="ln-11370"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output                                    = &#39;</span> <span class="p">&amp;</span>
<a name="ln-11371"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ThermalEffTempElevOutput</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-11372"></a>          <span class="k">END IF</span>
<a name="ln-11373"></a>
<a name="ln-11374"></a><span class="k">        CASE </span><span class="n">DEFAULT</span>
<a name="ln-11375"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11376"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11377"></a>                               <span class="s1">&#39; for this object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ThermEffFTempElevCurveNum</span><span class="p">)))</span>
<a name="ln-11378"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve type must be BIQUADRATIC or BICUBIC.&#39;</span><span class="p">)</span>
<a name="ln-11379"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11380"></a>
<a name="ln-11381"></a>        <span class="k">END SELECT</span>
<a name="ln-11382"></a>
<a name="ln-11383"></a><span class="k">      END IF</span>
<a name="ln-11384"></a>
<a name="ln-11385"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFPLRCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-11386"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFPLRCurveNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11387"></a>        <span class="c">! Verify curve object, only legal types are Quadratic or Cubic</span>
<a name="ln-11388"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFPLRCurveNum</span><span class="p">))</span>
<a name="ln-11389"></a>
<a name="ln-11390"></a>        <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-11391"></a>
<a name="ln-11392"></a>          <span class="n">HeatRecRateFPLROutput</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFPLRCurveNum</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-11393"></a>
<a name="ln-11394"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">HeatRecRateFPLROutput</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11395"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11396"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>
<a name="ln-11397"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output at a part-load ratio of 1 should equal 1 (+-10%).&#39;</span><span class="p">)</span>
<a name="ln-11398"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatRecRateFPLROutput</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-11399"></a>          <span class="k">END IF</span>
<a name="ln-11400"></a>
<a name="ln-11401"></a><span class="k">        CASE </span><span class="n">DEFAULT</span>
<a name="ln-11402"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11403"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11404"></a>                               <span class="s1">&#39; for this object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFPLRCurveNum</span><span class="p">)))</span>
<a name="ln-11405"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve type must be QUADRATIC or CUBIC.&#39;</span><span class="p">)</span>
<a name="ln-11406"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11407"></a>
<a name="ln-11408"></a>        <span class="k">END SELECT</span>
<a name="ln-11409"></a>
<a name="ln-11410"></a><span class="k">      END IF</span>
<a name="ln-11411"></a>
<a name="ln-11412"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFTempCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-11413"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFTempCurveNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11414"></a>        <span class="c">! Verify curve object, only legal type is Quadratic</span>
<a name="ln-11415"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFTempCurveNum</span><span class="p">))</span>
<a name="ln-11416"></a>
<a name="ln-11417"></a>        <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-11418"></a>
<a name="ln-11419"></a>          <span class="n">HeatRecRateFTempOutput</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFTempCurveNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11420"></a>                                              <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefInletWaterTemp</span><span class="p">)</span>
<a name="ln-11421"></a>
<a name="ln-11422"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">HeatRecRateFTempOutput</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11423"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11424"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)))</span>
<a name="ln-11425"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output at reference condition should equal 1 (+-10%).&#39;</span><span class="p">)</span>
<a name="ln-11426"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Reference inlet water temperature temperature      = &#39;</span> <span class="p">&amp;</span>
<a name="ln-11427"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefInletWaterTemp</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-11428"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatRecRateFTempOutput</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-11429"></a>          <span class="k">END IF</span>
<a name="ln-11430"></a>
<a name="ln-11431"></a><span class="k">        CASE </span><span class="n">DEFAULT</span>
<a name="ln-11432"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11433"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11434"></a>                               <span class="s1">&#39; for this object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFTempCurveNum</span><span class="p">)))</span>
<a name="ln-11435"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve type must be QUADRATIC.&#39;</span><span class="p">)</span>
<a name="ln-11436"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11437"></a>
<a name="ln-11438"></a>        <span class="k">END SELECT</span>
<a name="ln-11439"></a>
<a name="ln-11440"></a><span class="k">      END IF</span>
<a name="ln-11441"></a>
<a name="ln-11442"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFWaterFlowCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>
<a name="ln-11443"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFWaterFlowCurveNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11444"></a>        <span class="c">! Verify curve object, only legal type is Quadratic</span>
<a name="ln-11445"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFWaterFlowCurveNum</span><span class="p">))</span>
<a name="ln-11446"></a>
<a name="ln-11447"></a>        <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-11448"></a>
<a name="ln-11449"></a>          <span class="n">HeatRecRateFFlowOutput</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFWaterFlowCurveNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11450"></a>                                              <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefHeatRecVolFlowRate</span><span class="p">)</span>
<a name="ln-11451"></a>
<a name="ln-11452"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">HeatRecRateFFlowOutput</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11453"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11454"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)))</span>
<a name="ln-11455"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output at reference condition should equal 1 (+-10%).&#39;</span><span class="p">)</span>
<a name="ln-11456"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Reference Heat Recovery Water Flow Rate      = &#39;</span> <span class="p">&amp;</span>
<a name="ln-11457"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefHeatRecVolFlowRate</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s&#39;</span><span class="p">)</span>
<a name="ln-11458"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatRecRateFFlowOutput</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-11459"></a>          <span class="k">END IF</span>
<a name="ln-11460"></a>
<a name="ln-11461"></a><span class="k">        CASE </span><span class="n">DEFAULT</span>
<a name="ln-11462"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11463"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11464"></a>                             <span class="s1">&#39; for this object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFWaterFlowCurveNum</span><span class="p">)))</span>
<a name="ln-11465"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve type must be QUADRATIC.&#39;</span><span class="p">)</span>
<a name="ln-11466"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11467"></a>
<a name="ln-11468"></a>        <span class="k">END SELECT</span>
<a name="ln-11469"></a>
<a name="ln-11470"></a><span class="k">      END IF</span>
<a name="ln-11471"></a>
<a name="ln-11472"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMinVolFlowRate</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-11473"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMinVolFlowRate</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11474"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11475"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0.&#39;</span><span class="p">)</span>
<a name="ln-11476"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Resetting to 0 and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-11477"></a>        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMinVolFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11478"></a>      <span class="k">END IF</span>
<a name="ln-11479"></a>
<a name="ln-11480"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxVolFlowRate</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-11481"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxVolFlowRate</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-11482"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11483"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0.&#39;</span><span class="p">)</span>
<a name="ln-11484"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Resetting to 0 and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-11485"></a>        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxVolFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11486"></a>      <span class="k">END IF</span>
<a name="ln-11487"></a>
<a name="ln-11488"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxVolFlowRate</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMinVolFlowRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11489"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11490"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span>
<a name="ln-11491"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Resetting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11492"></a>                               <span class="s1">&#39; and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-11493"></a>        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxVolFlowRate</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMinVolFlowRate</span>
<a name="ln-11494"></a>      <span class="k">END IF</span>
<a name="ln-11495"></a>
<a name="ln-11496"></a><span class="c">!     Check if reference heat recovery water flow rate is below the minimum flow rate</span>
<a name="ln-11497"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefHeatRecVolFlowRate</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMinVolFlowRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11498"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11499"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span>
<a name="ln-11500"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Resetting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11501"></a>                               <span class="s1">&#39; and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-11502"></a>        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefHeatRecVolFlowRate</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMinVolFlowRate</span>
<a name="ln-11503"></a>      <span class="k">END IF</span>
<a name="ln-11504"></a>
<a name="ln-11505"></a><span class="c">!     Check if reference heat recovery water flow rate is above the maximum flow rate</span>
<a name="ln-11506"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefHeatRecVolFlowRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxVolFlowRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11507"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11508"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &lt;= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">16</span><span class="p">)))</span>
<a name="ln-11509"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Resetting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11510"></a>                               <span class="s1">&#39; and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-11511"></a>        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefHeatRecVolFlowRate</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxVolFlowRate</span>
<a name="ln-11512"></a>      <span class="k">END IF</span>
<a name="ln-11513"></a>
<a name="ln-11514"></a>
<a name="ln-11515"></a><span class="k">      CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span> <span class="p">,&amp;</span>
<a name="ln-11516"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxVolFlowRate</span><span class="p">)</span>
<a name="ln-11517"></a>
<a name="ln-11518"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxWaterTemp</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-11519"></a>
<a name="ln-11520"></a>    <span class="k">END IF</span>  <span class="c">! End of &#39;IF (MTGenerator(GeneratorNum)%HeatRecInletNodeNum .NE. 0 .AND. &amp;</span>
<a name="ln-11521"></a>            <span class="c">!             MTGenerator(GeneratorNum)%HeatRecOutletNodeNum .NE. 0) THEN&#39;</span>
<a name="ln-11522"></a>
<a name="ln-11523"></a>
<a name="ln-11524"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11525"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CombustionAirInletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-11526"></a>                  <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-11527"></a>                  <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-11528"></a>    <span class="k">END IF</span>
<a name="ln-11529"></a>
<a name="ln-11530"></a><span class="c">!    Combustion air inlet node must be an outside air node</span>
<a name="ln-11531"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CombustionAirInletNodeNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-11532"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11533"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not a valid Outdoor Air Node = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span>
<a name="ln-11534"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;it does not appear in an OutdoorAir:NodeList or as an OutdoorAir:Node.&#39;</span><span class="p">)</span>
<a name="ln-11535"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11536"></a>    <span class="k">END IF</span>
<a name="ln-11537"></a>
<a name="ln-11538"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-11539"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CombustionAirOutletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-11540"></a>                  <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-11541"></a>                  <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-11542"></a>    <span class="k">END IF</span>
<a name="ln-11543"></a>
<a name="ln-11544"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CombustionAirOutletNodeNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11545"></a>        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CombustionAirInletNodeNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11546"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11547"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;A &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be specified when a &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11548"></a>                              <span class="s1">&#39; is specified.&#39;</span><span class="p">)</span>
<a name="ln-11549"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11550"></a>    <span class="k">END IF</span>
<a name="ln-11551"></a>
<a name="ln-11552"></a><span class="c">!   Get other exhaust air inputs only if combustion air inlet and outlet nodes are valid</span>
<a name="ln-11553"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CombustionAirOutletNodeNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11554"></a>        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CombustionAirInletNodeNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11555"></a>
<a name="ln-11556"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirCalcsActive</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11557"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefExhaustAirMassFlowRate</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-11558"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefExhaustAirMassFlowRate</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11559"></a>          <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-11560"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">18</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-11561"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-11562"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than 0.&#39;</span><span class="p">)</span>
<a name="ln-11563"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11564"></a>      <span class="k">END IF</span>
<a name="ln-11565"></a>
<a name="ln-11566"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFTempCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span>
<a name="ln-11567"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFTempCurveNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11568"></a>        <span class="c">! Verify curve object, only legal types are Quadratic and Cubic</span>
<a name="ln-11569"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFTempCurveNum</span><span class="p">))</span>
<a name="ln-11570"></a>
<a name="ln-11571"></a>        <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-11572"></a>
<a name="ln-11573"></a>          <span class="n">ExhFlowFTempOutput</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFTempCurveNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11574"></a>                                          <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletTemp</span><span class="p">)</span>
<a name="ln-11575"></a>
<a name="ln-11576"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ExhFlowFTempOutput</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11577"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11578"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)))</span>
<a name="ln-11579"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output at reference condition should equal 1 (+-10%).&#39;</span><span class="p">)</span>
<a name="ln-11580"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Reference combustion air inlet temperature      = &#39;</span> <span class="p">&amp;</span>
<a name="ln-11581"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletTemp</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-11582"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ExhFlowFTempOutput</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-11583"></a>          <span class="k">END IF</span>
<a name="ln-11584"></a>
<a name="ln-11585"></a><span class="k">        CASE </span><span class="n">DEFAULT</span>
<a name="ln-11586"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11587"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11588"></a>                               <span class="s1">&#39; for this object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFTempCurveNum</span><span class="p">)))</span>
<a name="ln-11589"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve type must be QUADRATIC or CUBIC.&#39;</span><span class="p">)</span>
<a name="ln-11590"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11591"></a>
<a name="ln-11592"></a>        <span class="k">END SELECT</span>
<a name="ln-11593"></a>
<a name="ln-11594"></a><span class="k">      END IF</span>
<a name="ln-11595"></a>
<a name="ln-11596"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFPLRCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-11597"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFPLRCurveNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11598"></a>        <span class="c">! Verify curve object, legal types are Quadratic or Cubic</span>
<a name="ln-11599"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFPLRCurveNum</span><span class="p">))</span>
<a name="ln-11600"></a>
<a name="ln-11601"></a>        <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-11602"></a>
<a name="ln-11603"></a>          <span class="n">ExhFlowFPLROutput</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFPLRCurveNum</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-11604"></a>
<a name="ln-11605"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ExhFlowFPLROutput</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11606"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11607"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">18</span><span class="p">)))</span>
<a name="ln-11608"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output at a part-load ratio of 1 should equal 1 (+-10%).&#39;</span><span class="p">)</span>
<a name="ln-11609"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ExhFlowFPLROutput</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-11610"></a>          <span class="k">END IF</span>
<a name="ln-11611"></a>
<a name="ln-11612"></a><span class="k">        CASE </span><span class="n">DEFAULT</span>
<a name="ln-11613"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11614"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11615"></a>                               <span class="s1">&#39; for this object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFPLRCurveNum</span><span class="p">)))</span>
<a name="ln-11616"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve type must be QUADRATIC or CUBIC.&#39;</span><span class="p">)</span>
<a name="ln-11617"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11618"></a>
<a name="ln-11619"></a>        <span class="k">END SELECT</span>
<a name="ln-11620"></a>
<a name="ln-11621"></a><span class="k">      END IF</span>
<a name="ln-11622"></a>
<a name="ln-11623"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">NomExhAirOutletTemp</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="ln-11624"></a>
<a name="ln-11625"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirTempFTempCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span>
<a name="ln-11626"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirTempFTempCurveNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11627"></a>        <span class="c">! Verify curve object, only legal types are Quadratic and Cubic</span>
<a name="ln-11628"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirTempFTempCurveNum</span><span class="p">))</span>
<a name="ln-11629"></a>
<a name="ln-11630"></a>        <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-11631"></a>
<a name="ln-11632"></a>          <span class="n">ExhAirTempFTempOutput</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirTempFTempCurveNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11633"></a>                                                <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletTemp</span><span class="p">)</span>
<a name="ln-11634"></a>
<a name="ln-11635"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ExhAirTempFTempOutput</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11636"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11637"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">19</span><span class="p">)))</span>
<a name="ln-11638"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output at reference condition should equal 1 (+-10%).&#39;</span><span class="p">)</span>
<a name="ln-11639"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Reference combustion air inlet temperature      = &#39;</span> <span class="p">&amp;</span>
<a name="ln-11640"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletTemp</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-11641"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ExhAirTempFTempOutput</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-11642"></a>          <span class="k">END IF</span>
<a name="ln-11643"></a>
<a name="ln-11644"></a><span class="k">        CASE </span><span class="n">DEFAULT</span>
<a name="ln-11645"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11646"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11647"></a>                               <span class="s1">&#39; for this object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirTempFTempCurveNum</span><span class="p">)))</span>
<a name="ln-11648"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve type must be QUADRATIC or CUBIC.&#39;</span><span class="p">)</span>
<a name="ln-11649"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11650"></a>
<a name="ln-11651"></a>        <span class="k">END SELECT</span>
<a name="ln-11652"></a>
<a name="ln-11653"></a><span class="k">      END IF</span>
<a name="ln-11654"></a>
<a name="ln-11655"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirTempFPLRCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span> <span class="c">! convert curve name to number</span>
<a name="ln-11656"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirTempFPLRCurveNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11657"></a>        <span class="c">! Verify curve object, legal types are Quadratic or Cubic</span>
<a name="ln-11658"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirTempFPLRCurveNum</span><span class="p">))</span>
<a name="ln-11659"></a>
<a name="ln-11660"></a>        <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">,</span> <span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-11661"></a>
<a name="ln-11662"></a>          <span class="n">ExhOutAirTempFPLROutput</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirTempFPLRCurveNum</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-11663"></a>
<a name="ln-11664"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ExhOutAirTempFPLROutput</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11665"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11666"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">20</span><span class="p">)))</span>
<a name="ln-11667"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output at a part-load ratio of 1 should equal 1 (+-10%).&#39;</span><span class="p">)</span>
<a name="ln-11668"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve output = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ExhOutAirTempFPLROutput</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-11669"></a>          <span class="k">END IF</span>
<a name="ln-11670"></a>
<a name="ln-11671"></a><span class="k">        CASE </span><span class="n">DEFAULT</span>
<a name="ln-11672"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-11673"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-11674"></a>                               <span class="s1">&#39; for this object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirTempFPLRCurveNum</span><span class="p">)))</span>
<a name="ln-11675"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Curve type must be QUADRATIC or CUBIC.&#39;</span><span class="p">)</span>
<a name="ln-11676"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11677"></a>
<a name="ln-11678"></a>        <span class="k">END SELECT</span>
<a name="ln-11679"></a>
<a name="ln-11680"></a><span class="k">      END IF</span>
<a name="ln-11681"></a>
<a name="ln-11682"></a><span class="k">    END IF</span> <span class="c">! End of &#39;    IF (MTGenerator(GeneratorNum)%CombustionAirOutletNodeNum .GT. 0 .AND. &amp;</span>
<a name="ln-11683"></a>           <span class="c">!                 MTGenerator(GeneratorNum)%CombustionAirInletNodeNum .GT. 0) THEN</span>
<a name="ln-11684"></a>
<a name="ln-11685"></a>  <span class="k">END DO</span>
<a name="ln-11686"></a>
<a name="ln-11687"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11688"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in processing input for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">))</span>
<a name="ln-11689"></a>  <span class="k">END IF</span>
<a name="ln-11690"></a>
<a name="ln-11691"></a><span class="k">  DO </span><span class="n">GeneratorNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumMTGenerators</span>
<a name="ln-11692"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11693"></a>          <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PowerGen</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-11694"></a>
<a name="ln-11695"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11696"></a>          <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">EnergyGen</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11697"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ElectricityProduced&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-11698"></a>
<a name="ln-11699"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator LHV Basis Electric Efficiency []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11700"></a>          <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElectricEfficiencyLHV</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-11701"></a>
<a name="ln-11702"></a><span class="c">!    Fuel specific report variables</span>
<a name="ln-11703"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator &#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">FuelType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; HHV Basis Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11704"></a>          <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergyUseRateHHV</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-11705"></a>
<a name="ln-11706"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator &#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">FuelType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; HHV Basis Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11707"></a>          <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergyHHV</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11708"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="n">FuelType</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-11709"></a>
<a name="ln-11710"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator &#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">FuelType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11711"></a>          <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelMdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-11712"></a>
<a name="ln-11713"></a><span class="c">!    general fuel use report (to match other generators)</span>
<a name="ln-11714"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel HHV Basis Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11715"></a>          <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergyUseRateHHV</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-11716"></a>
<a name="ln-11717"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Fuel HHV Basis Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11718"></a>          <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergyHHV</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-11719"></a>
<a name="ln-11720"></a><span class="c">!    Heat recovery (to water) report variables</span>
<a name="ln-11721"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11722"></a>
<a name="ln-11723"></a><span class="k">       CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Thermal Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11724"></a>            <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QHeatRecovered</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-11725"></a>
<a name="ln-11726"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Produced Thermal Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11727"></a>            <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustEnergyRec</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11728"></a>                              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATRECOVERY&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-11729"></a>
<a name="ln-11730"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Thermal Efficiency LHV Basis []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11731"></a>            <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ThermalEfficiencyLHV</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-11732"></a>
<a name="ln-11733"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Heat Recovery Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11734"></a>          <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-11735"></a>
<a name="ln-11736"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Heat Recovery Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11737"></a>          <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-11738"></a>
<a name="ln-11739"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Heat Recovery Water Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11740"></a>          <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-11741"></a>
<a name="ln-11742"></a>     <span class="k">END IF</span>
<a name="ln-11743"></a>
<a name="ln-11744"></a><span class="k">     IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StandbyPower</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Report Standby Power if entered by user</span>
<a name="ln-11745"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Standby Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11746"></a>            <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StandbyPowerRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-11747"></a>
<a name="ln-11748"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Standby Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11749"></a>            <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StandbyEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11750"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cogeneration&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-11751"></a>     <span class="k">END IF</span>
<a name="ln-11752"></a>
<a name="ln-11753"></a><span class="k">     IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPower</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Report Ancillary Power if entered by user</span>
<a name="ln-11754"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Ancillary Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11755"></a>            <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPowerRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-11756"></a>
<a name="ln-11757"></a>       <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Ancillary Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11758"></a>            <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-11759"></a>     <span class="k">END IF</span>
<a name="ln-11760"></a><span class="c">!   Report combustion air outlet conditions if exhaust air calculations are active</span>
<a name="ln-11761"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirCalcsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11762"></a><span class="k">       CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Exhaust Air Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11763"></a>     <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirMassFlowRate</span> <span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-11764"></a>     <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Exhaust Air Temperature  [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11765"></a>       <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirTemperature</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-11766"></a>    <span class="n">ENDIF</span>
<a name="ln-11767"></a>
<a name="ln-11768"></a>  <span class="k">END DO</span>
<a name="ln-11769"></a>
<a name="ln-11770"></a><span class="k">  RETURN</span>
<a name="ln-11771"></a>
<a name="ln-11772"></a><span class="k">END SUBROUTINE </span><span class="n">GetMTGeneratorInput</span>
<a name="ln-11773"></a>
<a name="ln-11774"></a><span class="c">! End of Get Input subroutine for the MT Generator Module</span>
<a name="ln-11775"></a><span class="c">!******************************************************************************</span>
<a name="ln-11776"></a>
<a name="ln-11777"></a><span class="c">! Begin MT Generator Module Initialize Subroutine</span>
<a name="ln-11778"></a><span class="c">! *****************************************************************************</span>
<a name="ln-11779"></a>
<a name="ln-11780"></a><span class="k">SUBROUTINE </span><span class="n">InitMTGenerators</span><span class="p">(</span><span class="n">GenNum</span><span class="p">,</span> <span class="n">RunFlag</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-11781"></a>
<a name="ln-11782"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-11783"></a>          <span class="c">!       AUTHOR         R. Raustad/D. Shirey</span>
<a name="ln-11784"></a>          <span class="c">!       DATE WRITTEN   Mar 2008</span>
<a name="ln-11785"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-11786"></a>          <span class="c">!       RE-ENGINEERED  B. Griffith, Sept 2010, plant upgrades, general fluid props</span>
<a name="ln-11787"></a>
<a name="ln-11788"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-11789"></a>          <span class="c">!  This subroutine is for initializations of the CT generators.</span>
<a name="ln-11790"></a>
<a name="ln-11791"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-11792"></a>          <span class="c">!  Uses the status flags to trigger initializations.</span>
<a name="ln-11793"></a>
<a name="ln-11794"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-11795"></a>          <span class="c">!  na</span>
<a name="ln-11796"></a>
<a name="ln-11797"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-11798"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span>
<a name="ln-11799"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-11800"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span><span class="p">,</span><span class="n">ScanPlantLoopsForObject</span><span class="p">,</span> <span class="n">TypeOf_Generator_MicroTurbine</span>
<a name="ln-11801"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span><span class="p">,</span> <span class="n">InitComponentNodes</span>
<a name="ln-11802"></a>
<a name="ln-11803"></a>
<a name="ln-11804"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-11805"></a>
<a name="ln-11806"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-11807"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GenNum</span>
<a name="ln-11808"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RunFlag</span> <span class="c">!</span>
<a name="ln-11809"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MyLoad</span> <span class="c">! electrical load in W</span>
<a name="ln-11810"></a>  <span class="kt">Logical</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-11811"></a>
<a name="ln-11812"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-11813"></a>          <span class="c">!  na</span>
<a name="ln-11814"></a>
<a name="ln-11815"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-11816"></a>          <span class="c">!  na</span>
<a name="ln-11817"></a>
<a name="ln-11818"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-11819"></a>          <span class="c">!  na</span>
<a name="ln-11820"></a>
<a name="ln-11821"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-11822"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">Num</span>                        <span class="c">! Loop index over all generators</span>
<a name="ln-11823"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HeatRecInletNode</span>           <span class="c">! Inlet node number in heat recovery loop</span>
<a name="ln-11824"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HeatRecOutletNode</span>          <span class="c">! Outlet node number in heat recovery loop</span>
<a name="ln-11825"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">InitGeneratorOnce</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! Flag for 1 time initialization</span>
<a name="ln-11826"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>  <span class="kd">::</span> <span class="n">MyEnvrnFlag</span>  <span class="c">! Flag for init once at start of environment</span>
<a name="ln-11827"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyPlantScanFlag</span>
<a name="ln-11828"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySizeAndNodeInitFlag</span>
<a name="ln-11829"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>           <span class="c">! Initialization flag</span>
<a name="ln-11830"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">rho</span> <span class="c">! local temporary fluid density</span>
<a name="ln-11831"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesiredMassFlowRate</span>
<a name="ln-11832"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-11833"></a>
<a name="ln-11834"></a>          <span class="c">! FLOW:</span>
<a name="ln-11835"></a>  <span class="c">! Do the one time initializations</span>
<a name="ln-11836"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11837"></a><span class="k">    ALLOCATE</span> <span class="p">(</span><span class="n">MyEnvrnFlag</span>    <span class="p">(</span><span class="n">NumMTGenerators</span><span class="p">))</span>
<a name="ln-11838"></a>    <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">NumMTGenerators</span><span class="p">))</span>
<a name="ln-11839"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MySizeAndNodeInitFlag</span><span class="p">(</span><span class="n">NumMTGenerators</span><span class="p">))</span>
<a name="ln-11840"></a>    <span class="n">MyEnvrnFlag</span>           <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11841"></a>    <span class="n">MyPlantScanFlag</span>       <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11842"></a>    <span class="n">MySizeAndNodeInitFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11843"></a>    <span class="n">MyOneTimeFlag</span>         <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-11844"></a>  <span class="n">ENDIF</span>
<a name="ln-11845"></a>
<a name="ln-11846"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-11847"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11848"></a><span class="k">    </span><span class="n">errFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-11849"></a>    <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11850"></a>                                 <span class="n">TypeOf_Generator_MicroTurbine</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11851"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11852"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11853"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11854"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRCompNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11855"></a>                                 <span class="n">errFlag</span> <span class="o">=</span> <span class="n">errFlag</span><span class="p">)</span>
<a name="ln-11856"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11857"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitMTGenerators: Program terminated due to previous condition(s).&#39;</span><span class="p">)</span>
<a name="ln-11858"></a>    <span class="n">ENDIF</span>
<a name="ln-11859"></a>
<a name="ln-11860"></a>    <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-11861"></a>  <span class="n">ENDIF</span>
<a name="ln-11862"></a>
<a name="ln-11863"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MySizeAndNodeInitFlag</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">GenNum</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-11864"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HeatRecActive</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11865"></a>
<a name="ln-11866"></a>
<a name="ln-11867"></a><span class="k">    </span><span class="n">HeatRecInletNode</span>    <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>
<a name="ln-11868"></a>    <span class="n">HeatRecOutletNode</span>   <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>
<a name="ln-11869"></a>
<a name="ln-11870"></a>    <span class="c">!size mass flow rate</span>
<a name="ln-11871"></a>    <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11872"></a>                                     <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11873"></a>                                     <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11874"></a>                                     <span class="s1">&#39;InitMTGenerators&#39;</span><span class="p">)</span>
<a name="ln-11875"></a>
<a name="ln-11876"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">RefHeatRecVolFlowRate</span>
<a name="ln-11877"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HeatRecMaxMassFlowRate</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HeatRecMaxVolFlowRate</span>
<a name="ln-11878"></a>
<a name="ln-11879"></a>    <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span>  <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HeatRecMaxMassFlowRate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-11880"></a>                                 <span class="n">HeatRecInletNode</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-11881"></a>                                 <span class="n">HeatRecOutletNode</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-11882"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11883"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11884"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11885"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-11886"></a>
<a name="ln-11887"></a>    <span class="n">MySizeAndNodeInitFlag</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-11888"></a>
<a name="ln-11889"></a>  <span class="k">END IF</span> <span class="c">! end one time inits</span>
<a name="ln-11890"></a>
<a name="ln-11891"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-11892"></a>
<a name="ln-11893"></a><span class="k">  </span><span class="n">HeatRecInletNode</span>    <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>
<a name="ln-11894"></a>  <span class="n">HeatRecOutletNode</span>   <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>
<a name="ln-11895"></a>  <span class="c">! Do the Begin Environment initializations</span>
<a name="ln-11896"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GenNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-11897"></a>      <span class="c">! set the node max and min mass flow rates</span>
<a name="ln-11898"></a>    <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span>  <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HeatRecMaxMassFlowRate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-11899"></a>                                 <span class="n">HeatRecInletNode</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-11900"></a>                                 <span class="n">HeatRecOutletNode</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-11901"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11902"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11903"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11904"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-11905"></a>
<a name="ln-11906"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">0.0d0</span> <span class="c">! Set the node temperature, assuming freeze control</span>
<a name="ln-11907"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">0.0d0</span>
<a name="ln-11908"></a>
<a name="ln-11909"></a>    <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-11910"></a>  <span class="k">END IF</span> <span class="c">! end environmental inits</span>
<a name="ln-11911"></a>
<a name="ln-11912"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11913"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)</span> <span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-11914"></a>  <span class="k">END IF</span>
<a name="ln-11915"></a>
<a name="ln-11916"></a>  <span class="c">! set/request flow rates</span>
<a name="ln-11917"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11918"></a>
<a name="ln-11919"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">RunFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11920"></a><span class="k">      </span><span class="n">DesiredMassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-11921"></a>
<a name="ln-11922"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">RunFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">InternalFlowControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11923"></a>      <span class="c">! assume dispatch power in MyLoad is what gets produced (future, reset during calc routine and iterate)</span>
<a name="ln-11924"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HeatRecFlowFTempPowCurveNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11925"></a><span class="k">        </span><span class="n">DesiredMassFlowRate</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span> <span class="p">&amp;</span>
<a name="ln-11926"></a>                              <span class="o">*</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HeatRecFlowFTempPowCurveNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11927"></a>                               <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11928"></a>                               <span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-11929"></a>      <span class="k">ELSE</span>
<a name="ln-11930"></a><span class="k">        </span><span class="n">DesiredMassFlowRate</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span> <span class="c">! Assume modifier = 1 if curve not specified</span>
<a name="ln-11931"></a>      <span class="k">END IF</span>
<a name="ln-11932"></a>
<a name="ln-11933"></a><span class="k">      </span><span class="n">DesiredMassFlowRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">constant_zero</span><span class="p">,</span>  <span class="n">DesiredMassFlowRate</span><span class="p">)</span> <span class="c">! protect from neg. curve result</span>
<a name="ln-11934"></a>
<a name="ln-11935"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">RunFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">InternalFlowControl</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-11936"></a><span class="k">      </span><span class="n">DesiredMassFlowRate</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span>
<a name="ln-11937"></a>    <span class="k">END IF</span>
<a name="ln-11938"></a>
<a name="ln-11939"></a><span class="k">    CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">DesiredMassFlowRate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-11940"></a>                                 <span class="n">HeatRecInletNode</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-11941"></a>                                 <span class="n">HeatRecOutletNode</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-11942"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11943"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11944"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11945"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-11946"></a>  <span class="k">ELSE</span> <span class="c">! not FirstHVACIteration</span>
<a name="ln-11947"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">RunFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11948"></a><span class="k">      </span><span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">constant_zero</span><span class="p">,</span> <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">)</span>
<a name="ln-11949"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">constant_zero</span><span class="p">,</span> <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span><span class="p">)</span>
<a name="ln-11950"></a>
<a name="ln-11951"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">RunFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">InternalFlowControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11952"></a>      <span class="c">! assume dispatch power in MyLoad is what gets produced (future, reset during calc routine and iterate)</span>
<a name="ln-11953"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HeatRecFlowFTempPowCurveNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11954"></a><span class="k">        </span><span class="n">DesiredMassFlowRate</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span> <span class="p">&amp;</span>
<a name="ln-11955"></a>                              <span class="o">*</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HeatRecFlowFTempPowCurveNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11956"></a>                               <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11957"></a>                               <span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-11958"></a>        <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">DesiredMassFlowRate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-11959"></a>                                 <span class="n">HeatRecInletNode</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-11960"></a>                                 <span class="n">HeatRecOutletNode</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-11961"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11962"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11963"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11964"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-11965"></a>      <span class="k">ELSE</span>
<a name="ln-11966"></a><span class="k">        CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HeatRecMdot</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-11967"></a>                                 <span class="n">HeatRecInletNode</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-11968"></a>                                 <span class="n">HeatRecOutletNode</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-11969"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11970"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11971"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11972"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-11973"></a>      <span class="k">END IF</span>
<a name="ln-11974"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">RunFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">InternalFlowControl</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-11975"></a><span class="k">        CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HeatRecMdot</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-11976"></a>                                 <span class="n">HeatRecInletNode</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-11977"></a>                                 <span class="n">HeatRecOutletNode</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-11978"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11979"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11980"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11981"></a>                                 <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-11982"></a>    <span class="n">ENDIF</span>
<a name="ln-11983"></a>  <span class="k">END IF</span>
<a name="ln-11984"></a>
<a name="ln-11985"></a><span class="k">  RETURN</span>
<a name="ln-11986"></a>
<a name="ln-11987"></a><span class="k">END SUBROUTINE </span><span class="n">InitMTGenerators</span>
<a name="ln-11988"></a>
<a name="ln-11989"></a><span class="c">!  End of MT Generator Module Initialize Subroutine</span>
<a name="ln-11990"></a><span class="c">! *****************************************************************************</span>
<a name="ln-11991"></a>
<a name="ln-11992"></a>
<a name="ln-11993"></a><span class="c">!  Beginning of MT Generator Model Calculation Subroutine</span>
<a name="ln-11994"></a><span class="c">! *****************************************************************************</span>
<a name="ln-11995"></a>
<a name="ln-11996"></a><span class="k">SUBROUTINE </span><span class="n">CalcMTGeneratorModel</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">,</span><span class="n">Runflag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-11997"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-11998"></a>          <span class="c">!       AUTHOR         R. Raustad/D. Shirey</span>
<a name="ln-11999"></a>          <span class="c">!       DATE WRITTEN   Mar 2008</span>
<a name="ln-12000"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-12001"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-12002"></a>
<a name="ln-12003"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-12004"></a>          <span class="c">!  Simulate a combustion generator.</span>
<a name="ln-12005"></a>
<a name="ln-12006"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-12007"></a>          <span class="c">!  Curve fits of performance data.</span>
<a name="ln-12008"></a>
<a name="ln-12009"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-12010"></a>
<a name="ln-12011"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-12012"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FirstTimeStepSysFlag</span>
<a name="ln-12013"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutDryBulbTemp</span><span class="p">,</span> <span class="n">OutHumRat</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="n">Elevation</span>
<a name="ln-12014"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-12015"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyHFnTdbW</span><span class="p">,</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">,</span> <span class="n">PsyHfgAirFnWTdb</span><span class="p">,</span> <span class="n">PsyRhoAirFnPbTdbW</span>
<a name="ln-12016"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-12017"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">,</span> <span class="n">GetDensityGlycol</span>
<a name="ln-12018"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-12019"></a>
<a name="ln-12020"></a>
<a name="ln-12021"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-12022"></a>
<a name="ln-12023"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-12024"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MyLoad</span>                    <span class="c">! Generator demand (W)</span>
<a name="ln-12025"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">GeneratorNum</span>              <span class="c">! Generator number</span>
<a name="ln-12026"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RunFlag</span>                   <span class="c">! TRUE when generator is being asked to operate</span>
<a name="ln-12027"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">!unused1208</span>
<a name="ln-12028"></a>
<a name="ln-12029"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-12030"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">KJtoJ</span> <span class="o">=</span> <span class="mi">100</span><span class="mf">0.0d0</span>          <span class="c">! Convert kilojoules to joules</span>
<a name="ln-12031"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">MaxAncPowerIter</span> <span class="o">=</span> <span class="mi">50</span>      <span class="c">! Maximum number of iteration (subroutine ancillary power iteration loop)</span>
<a name="ln-12032"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">AncPowerDiffToler</span> <span class="o">=</span> <span class="mf">5.0d0</span> <span class="c">! Tolerance for Ancillary Power Difference (W)</span>
<a name="ln-12033"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">RelaxFactor</span> <span class="o">=</span> <span class="mf">0.7d0</span>       <span class="c">! Relaxation factor for iteration loop</span>
<a name="ln-12034"></a>
<a name="ln-12035"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-12036"></a>          <span class="c">!  na</span>
<a name="ln-12037"></a>
<a name="ln-12038"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-12039"></a>          <span class="c">!  na</span>
<a name="ln-12040"></a>
<a name="ln-12041"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-12042"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinPartLoadRat</span>          <span class="c">! Min allowed operating fraction at full load</span>
<a name="ln-12043"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxPartLoadRat</span>          <span class="c">! Max allowed operating fraction at full load</span>
<a name="ln-12044"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReferencePowerOutput</span>    <span class="c">! Generator reference capacity (W)</span>
<a name="ln-12045"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RefElecEfficiency</span>       <span class="c">! Reference electrical efficiency</span>
<a name="ln-12046"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OperatingElecEfficiency</span> <span class="c">! Actual operating efficiency</span>
<a name="ln-12047"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecEfficiencyFTemp</span>     <span class="c">! Electrical efficiency as a function of temperature curve output</span>
<a name="ln-12048"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecEfficiencyFPLR</span>      <span class="c">! Electrical efficiency as a function of PLR curve output</span>
<a name="ln-12049"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThermalEffFTempElev</span>     <span class="c">! Thermal efficiency as a function of air temperature and elevation</span>
<a name="ln-12050"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLR</span>                     <span class="c">! Generator operating part load ratio</span>
<a name="ln-12051"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PowerFTempElev</span>          <span class="c">! Power ratio as a function of inlet air temperature and elevation</span>
<a name="ln-12052"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CombustionAirInletTemp</span>  <span class="c">! Combustion air inlet temperature (C)</span>
<a name="ln-12053"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CombustionAirInletPress</span> <span class="c">! Barometric pressure of combustion inlet air (Pa)</span>
<a name="ln-12054"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CombustionAirInletW</span>     <span class="c">! Combustion air inlet humidity ratio (kg/kg)</span>
<a name="ln-12055"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExhFlowFTemp</span>            <span class="c">! Exhaust air flow rate as a function of temperature curve output</span>
<a name="ln-12056"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExhFlowFPLR</span>             <span class="c">! Exhaust air flow rate as a function of part-load ratio curve output</span>
<a name="ln-12057"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExhAirMassFlowRate</span>      <span class="c">! Actual exhaust air mass flow rate (accounting for temp and PLR modifier curves)</span>
<a name="ln-12058"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExhAirTempFTemp</span>         <span class="c">! Exhaust air temperature as a function of inlet air temp curve output</span>
<a name="ln-12059"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExhAirTempFPLR</span>          <span class="c">! Exhaust air temperature as a function of part-load ratio curve output</span>
<a name="ln-12060"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExhaustAirTemp</span>          <span class="c">! Actual exhaust air temperature (accounting for temp and PLR modifier curves)</span>
<a name="ln-12061"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpAir</span>                   <span class="c">! Heat capacity of air (J/kg-C)</span>
<a name="ln-12062"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H2OHtOfVap</span>              <span class="c">! Heat of vaporization of water (J/kg)</span>
<a name="ln-12063"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ActualElevation</span>         <span class="c">! Actual elevation of the microturbine (m)</span>
<a name="ln-12064"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirDensity</span>              <span class="c">! Density of air at actual combustion inlet air conditions (kg/m3)</span>
<a name="ln-12065"></a>
<a name="ln-12066"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecPowerGenerated</span>      <span class="c">! Generator electric power output (W)</span>
<a name="ln-12067"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadPowerOutput</span>     <span class="c">! Generator full-load power output at actual inlet conditions and elevation (W)</span>
<a name="ln-12068"></a>
<a name="ln-12069"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FuelUseEnergyRateLHV</span>    <span class="c">! Rate of fuel energy required to run microturbine, LHV basis (W)</span>
<a name="ln-12070"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QHeatRecToWater</span>         <span class="c">! Recovered waste heat to water (W)</span>
<a name="ln-12071"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinHeatRecMdot</span>          <span class="c">! Heat recovery flow rate if minimal heat recovery is accomplished (kg/s)</span>
<a name="ln-12072"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">HeatRecInNode</span>           <span class="c">! Heat recovery fluid inlet node number</span>
<a name="ln-12073"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatRecInTemp</span>           <span class="c">! Heat recovery fluid inlet temperature (C)</span>
<a name="ln-12074"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatRecOutTemp</span>          <span class="c">! Heat recovery fluid outlet temperature (C)</span>
<a name="ln-12075"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatRecMdot</span>             <span class="c">! Heat recovery fluid mass flow rate (kg/s)</span>
<a name="ln-12076"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatRecVolFlowRate</span>      <span class="c">! Heat recovery fluid flow rate (m3/s)</span>
<a name="ln-12077"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatRecCp</span>               <span class="c">! Specific heat of the heat recovery fluid (J/kg-K)</span>
<a name="ln-12078"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatRecRateFPLR</span>         <span class="c">! Heat recovery rate as a function of PLR curve output</span>
<a name="ln-12079"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatRecRateFTemp</span>        <span class="c">! Heat recovery rate as a function of inlet water temp curve output</span>
<a name="ln-12080"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatRecRateFFlow</span>        <span class="c">! Heat recovery rate as a function of water flow rate curve output</span>
<a name="ln-12081"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FuelHigherHeatingValue</span>  <span class="c">! Higher heating value (HHV) of fuel (kJ/kg)</span>
<a name="ln-12082"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FuelLowerHeatingValue</span>   <span class="c">! Lower heating value (LLV) of fuel kJ/kg)</span>
<a name="ln-12083"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HRecRatio</span>               <span class="c">! When maximum temperature is reached the amount of recovered heat has to be reduced</span>
<a name="ln-12084"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AncillaryPowerRate</span>      <span class="c">! Ancillary power used by pump (if not specified in manufacturers data)</span>
<a name="ln-12085"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AncillaryPowerRateLast</span>  <span class="c">! Ancillary power used by pump from last iteration (iteration loop within this subroutine)</span>
<a name="ln-12086"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AncillaryPowerRateDiff</span>  <span class="c">! Difference between ancillary power rate and ancillary power rate last (last iteration)</span>
<a name="ln-12087"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AnciPowerFMdotFuel</span>      <span class="c">! Ancillary power as a function of fuel flow curve output</span>
<a name="ln-12088"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">AncPowerCalcIterIndex</span>   <span class="c">! Index for subroutine iteration loop if Ancillary Power (function of fuel flow) is used</span>
<a name="ln-12089"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span>                     <span class="c">! local fluid density</span>
<a name="ln-12090"></a>
<a name="ln-12091"></a>
<a name="ln-12092"></a><span class="c">!   Load local variables from data structure (for code readability)</span>
<a name="ln-12093"></a>    <span class="n">MinPartLoadRat</span>       <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MinPartLoadRat</span>
<a name="ln-12094"></a>    <span class="n">MaxPartLoadRat</span>       <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxPartLoadRat</span>
<a name="ln-12095"></a>    <span class="n">ReferencePowerOutput</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecPowerOutput</span>
<a name="ln-12096"></a>    <span class="n">RefElecEfficiency</span>    <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefElecEfficiencyLHV</span>
<a name="ln-12097"></a>
<a name="ln-12098"></a><span class="c">!   Initialize variables</span>
<a name="ln-12099"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecPowerGenerated</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12100"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12101"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12102"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMdot</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12103"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QHeatRecovered</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12104"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustEnergyRec</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12105"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergyUseRateHHV</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12106"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelMdot</span>               <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12107"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPowerRate</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12108"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StandbyPowerRate</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12109"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergyUseRateLHV</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12110"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12111"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirTemperature</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12112"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirHumRat</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12113"></a>    <span class="n">ExhAirTempFTemp</span>                                  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12114"></a>    <span class="n">QHeatRecToWater</span>                                  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12115"></a>
<a name="ln-12116"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12117"></a><span class="k">      </span><span class="n">HeatRecInNode</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>
<a name="ln-12118"></a>      <span class="n">HeatRecInTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-12119"></a>      <span class="n">HeatRecCp</span> <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12120"></a>                                 <span class="n">HeatRecInTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12121"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12122"></a>                                 <span class="s1">&#39;CalcMTGeneratorModel&#39;</span><span class="p">)</span>
<a name="ln-12123"></a>      <span class="n">HeatRecMdot</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-12124"></a>    <span class="k">ELSE</span>
<a name="ln-12125"></a><span class="k">      </span><span class="n">HeatRecInTemp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-12126"></a>      <span class="n">HeatRecCp</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-12127"></a>      <span class="n">HeatRecMdot</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-12128"></a>    <span class="k">END IF</span>
<a name="ln-12129"></a>
<a name="ln-12130"></a><span class="c">!   Set combustion inlet air temperature, humidity ratio and pressure local variables</span>
<a name="ln-12131"></a>    <span class="k">IF</span>  <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CombustionAirInletNodeNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! no inlet air node specified, so use weather file values</span>
<a name="ln-12132"></a>      <span class="n">CombustionAirInletTemp</span> <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-12133"></a>      <span class="n">CombustionAirInletW</span> <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-12134"></a>      <span class="n">CombustionAirInletPress</span> <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-12135"></a>      <span class="n">ActualElevation</span> <span class="o">=</span> <span class="n">Elevation</span> <span class="c">! from DataEnvironment</span>
<a name="ln-12136"></a>    <span class="k">ELSE</span> <span class="c">! use inlet node information</span>
<a name="ln-12137"></a>      <span class="n">CombustionAirInletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CombustionAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-12138"></a>      <span class="n">CombustionAirInletW</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CombustionAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-12139"></a>      <span class="n">CombustionAirInletPress</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CombustionAirInletNodeNum</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-12140"></a>      <span class="n">ActualElevation</span> <span class="o">=</span> <span class="n">Elevation</span> <span class="c">! from DataEnvironment</span>
<a name="ln-12141"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CombustionAirInletNodeNum</span><span class="p">)%</span><span class="n">Height</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12142"></a><span class="k">        </span><span class="n">ActualElevation</span> <span class="o">=</span> <span class="n">Elevation</span> <span class="o">+</span>  <span class="n">Node</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CombustionAirInletNodeNum</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-12143"></a>      <span class="k">END IF</span>
<a name="ln-12144"></a><span class="c">!     Initialize combustion outlet air conditions to inlet air conditions (all node properties)</span>
<a name="ln-12145"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirCalcsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12146"></a><span class="k">        </span><span class="n">Node</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CombustionAirOutletNodeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">CombustionAirInletNodeNum</span><span class="p">)</span>
<a name="ln-12147"></a>      <span class="k">END IF</span>
<a name="ln-12148"></a><span class="k">    END IF</span>
<a name="ln-12149"></a>
<a name="ln-12150"></a><span class="c">!   If no loop demand or generator OFF, set some variables and then return</span>
<a name="ln-12151"></a><span class="c">!    IF (.NOT. Runflag .OR. MyLoad .LE. 0.0d0) THEN</span>
<a name="ln-12152"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MyLoad</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12153"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span>      <span class="o">=</span> <span class="n">HeatRecInTemp</span>
<a name="ln-12154"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span>     <span class="o">=</span> <span class="n">HeatRecInTemp</span>
<a name="ln-12155"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Runflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12156"></a><span class="k">        </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StandbyPowerRate</span>    <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StandbyPower</span>
<a name="ln-12157"></a>      <span class="k">END IF</span>
<a name="ln-12158"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirTemperature</span> <span class="o">=</span> <span class="n">CombustionAirInletTemp</span>
<a name="ln-12159"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirHumRat</span>      <span class="o">=</span> <span class="n">CombustionAirInletW</span>
<a name="ln-12160"></a>      <span class="k">RETURN</span>
<a name="ln-12161"></a><span class="k">    END IF</span>
<a name="ln-12162"></a>
<a name="ln-12163"></a><span class="c">!   Calculate power modifier curve value (function of inlet air temperature and elevation)</span>
<a name="ln-12164"></a>    <span class="n">PowerFTempElev</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecPowFTempElevCurveNum</span><span class="p">,</span> <span class="n">CombustionAirInletTemp</span><span class="p">,</span> <span class="n">Elevation</span><span class="p">)</span>
<a name="ln-12165"></a>
<a name="ln-12166"></a><span class="c">!   Warn user if power modifier curve output is less than 0</span>
<a name="ln-12167"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PowerFTempElev</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12168"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PowerFTempElevErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12169"></a><span class="c">!        MTGenerator(GeneratorNum)%PowerFTempElevErrorCount = MTGenerator(GeneratorNum)%PowerFTempElevErrorCount + 1</span>
<a name="ln-12170"></a>        <span class="k">CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-12171"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Electrical Power Modifier curve (function of temperature and elevation) output is &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-12172"></a>                               <span class="s1">&#39;less than zero (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">PowerFTempElev</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-12173"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Value occurs using a combustion inlet air temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-12174"></a>                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CombustionAirInletTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C.&#39;</span><span class="p">)</span>
<a name="ln-12175"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... and an elevation of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Elevation</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m.&#39;</span><span class="p">)</span>
<a name="ln-12176"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;... Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-12177"></a>      <span class="n">ENDIF</span>
<a name="ln-12178"></a>      <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12179"></a>          <span class="s1">&#39; Electrical Power Modifier curve is less than zero warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-12180"></a>          <span class="p">,</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">PowerFTempElevErrorIndex</span><span class="p">,</span> <span class="n">PowerFTempElev</span><span class="p">,</span> <span class="n">PowerFTempElev</span><span class="p">)</span>
<a name="ln-12181"></a>      <span class="n">PowerFTempElev</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12182"></a>    <span class="k">END IF</span>
<a name="ln-12183"></a>
<a name="ln-12184"></a><span class="c">!   Calculate available full-load power output. cannot exceed maximum full-load power output.</span>
<a name="ln-12185"></a>    <span class="n">FullLoadPowerOutput</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">ReferencePowerOutput</span> <span class="o">*</span> <span class="n">PowerFTempElev</span><span class="p">),</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MaxElecPowerOutput</span><span class="p">)</span>
<a name="ln-12186"></a><span class="c">!   Also can&#39;t be below the minimum full-load power output.</span>
<a name="ln-12187"></a>    <span class="n">FullLoadPowerOutput</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">FullLoadPowerOutput</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">MinElecPowerOutput</span><span class="p">)</span>
<a name="ln-12188"></a>
<a name="ln-12189"></a>    <span class="n">AncillaryPowerRate</span>     <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPower</span>
<a name="ln-12190"></a>    <span class="n">AncillaryPowerRateLast</span> <span class="o">=</span> <span class="n">AncillaryPowerRate</span>
<a name="ln-12191"></a>    <span class="n">AncillaryPowerRateDiff</span> <span class="o">=</span> <span class="n">AncPowerDiffToler</span> <span class="o">+</span> <span class="mf">1.0d0</span> <span class="c">! Initialize to force through DO WHILE Loop at least once</span>
<a name="ln-12192"></a>    <span class="n">AncPowerCalcIterIndex</span>  <span class="o">=</span> <span class="mi">0</span> <span class="c">! Initialize iteration index (counter)</span>
<a name="ln-12193"></a>
<a name="ln-12194"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">AncillaryPowerRateDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">AncPowerDiffToler</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">AncPowerCalcIterIndex</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">MaxAncPowerIter</span><span class="p">)</span>
<a name="ln-12195"></a>
<a name="ln-12196"></a>      <span class="n">AncPowerCalcIterIndex</span> <span class="o">=</span> <span class="n">AncPowerCalcIterIndex</span> <span class="o">+</span> <span class="mi">1</span> <span class="c">! Increment iteration loop counter</span>
<a name="ln-12197"></a>
<a name="ln-12198"></a><span class="c">!     Calculate operating power output (gross)</span>
<a name="ln-12199"></a>      <span class="n">ElecPowerGenerated</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">MyLoad</span> <span class="o">+</span> <span class="n">AncillaryPowerRate</span><span class="p">),</span> <span class="n">FullLoadPowerOutput</span> <span class="p">)</span>
<a name="ln-12200"></a>
<a name="ln-12201"></a><span class="c">!     Calculate PLR, but must be between the minPLR and maxPLR</span>
<a name="ln-12202"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FullLoadPowerOutput</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12203"></a><span class="k">        </span><span class="n">PLR</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">ElecPowerGenerated</span><span class="o">/</span><span class="n">FullLoadPowerOutput</span><span class="p">,</span> <span class="n">MaxPartLoadRat</span><span class="p">)</span>
<a name="ln-12204"></a>        <span class="n">PLR</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">PLR</span><span class="p">,</span> <span class="n">MinPartLoadRat</span><span class="p">)</span>
<a name="ln-12205"></a>      <span class="k">ELSE</span>
<a name="ln-12206"></a><span class="k">        </span><span class="n">PLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12207"></a>      <span class="k">END IF</span>
<a name="ln-12208"></a>
<a name="ln-12209"></a><span class="c">!     Recalculate ElecPowerGenerated based on &quot;final&quot; PLR</span>
<a name="ln-12210"></a>      <span class="n">ElecPowerGenerated</span> <span class="o">=</span> <span class="n">FullLoadPowerOutput</span> <span class="o">*</span> <span class="n">PLR</span>
<a name="ln-12211"></a>
<a name="ln-12212"></a><span class="c">!     Calculate electrical efficiency modifier curve output (function of temp)</span>
<a name="ln-12213"></a>      <span class="n">ElecEfficiencyFTemp</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecEffFTempCurveNum</span><span class="p">,</span> <span class="n">CombustionAirInletTemp</span><span class="p">)</span>
<a name="ln-12214"></a>
<a name="ln-12215"></a><span class="c">!     Warn user if efficiency modifier curve output is less than 0</span>
<a name="ln-12216"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ElecEfficiencyFTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12217"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">EffFTempErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12218"></a><span class="c">!          MTGenerator(GeneratorNum)%EffFTempErrorCount = MTGenerator(GeneratorNum)%EffFTempErrorCount + 1</span>
<a name="ln-12219"></a>          <span class="k">CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-12220"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Electrical Efficiency Modifier (function of temperature) output is less than &#39;</span> <span class="p">&amp;</span>
<a name="ln-12221"></a>                            <span class="o">//</span><span class="s1">&#39;zero (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ElecEfficiencyFTemp</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-12222"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Value occurs using a combustion inlet air temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-12223"></a>                             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CombustionAirInletTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C.&#39;</span><span class="p">)</span>
<a name="ln-12224"></a>          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;... Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-12225"></a>        <span class="n">ENDIF</span>
<a name="ln-12226"></a>        <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12227"></a>            <span class="s1">&#39; Electrical Efficiency Modifier (function of temperature) output is less than zero warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-12228"></a>            <span class="p">,</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">EffFTempErrorIndex</span><span class="p">,</span> <span class="n">ElecEfficiencyFTemp</span><span class="p">,</span> <span class="n">ElecEfficiencyFTemp</span><span class="p">)</span>
<a name="ln-12229"></a>        <span class="n">ElecEfficiencyFTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12230"></a>      <span class="k">END IF</span>
<a name="ln-12231"></a>
<a name="ln-12232"></a><span class="c">!     Calculate efficiency modifier curve output (function of PLR)</span>
<a name="ln-12233"></a>      <span class="n">ElecEfficiencyFPLR</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecEffFPLRCurveNum</span><span class="p">,</span> <span class="n">PLR</span><span class="p">)</span>
<a name="ln-12234"></a>
<a name="ln-12235"></a><span class="c">!     Warn user if efficiency modifier curve output is less than 0</span>
<a name="ln-12236"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ElecEfficiencyFPLR</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12237"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">EffFPLRErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12238"></a><span class="k">          CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-12239"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Electrical Efficiency Modifier (function of part-load ratio) output is less than&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-12240"></a>                                 <span class="s1">&#39; zero (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ElecEfficiencyFPLR</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-12241"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Value occurs using a part-load ratio of &#39;</span> <span class="p">&amp;</span>
<a name="ln-12242"></a>                             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">PLR</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-12243"></a>          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;... Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-12244"></a>        <span class="n">ENDIF</span>
<a name="ln-12245"></a>        <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12246"></a>            <span class="s1">&#39; Electrical Efficiency Modifier (function of part-load ratio) output is less than zero warning&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-12247"></a>            <span class="s1">&#39; continues...&#39;</span><span class="p">,</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">EffFPLRErrorIndex</span><span class="p">,</span> <span class="n">ElecEfficiencyFPLR</span><span class="p">,</span> <span class="n">ElecEfficiencyFPLR</span><span class="p">)</span>
<a name="ln-12248"></a>        <span class="n">ElecEfficiencyFPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12249"></a>      <span class="k">END IF</span>
<a name="ln-12250"></a>
<a name="ln-12251"></a><span class="c">!     Calculate operating electrical efficiency</span>
<a name="ln-12252"></a>      <span class="n">OperatingElecEfficiency</span> <span class="o">=</span> <span class="n">RefElecEfficiency</span> <span class="o">*</span> <span class="n">ElecEfficiencyFTemp</span> <span class="o">*</span> <span class="n">ElecEfficiencyFPLR</span>
<a name="ln-12253"></a>
<a name="ln-12254"></a><span class="c">!     Calculate fuel use (W = J/s), LHV basis</span>
<a name="ln-12255"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">OperatingElecEfficiency</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12256"></a><span class="k">        </span><span class="n">FuelUseEnergyRateLHV</span> <span class="o">=</span> <span class="n">ElecPowerGenerated</span> <span class="o">/</span> <span class="n">OperatingElecEfficiency</span>
<a name="ln-12257"></a>      <span class="k">ELSE</span>
<a name="ln-12258"></a><span class="k">        </span><span class="n">FuelUseEnergyRateLHV</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! If fuel use rate is zero, then</span>
<a name="ln-12259"></a>        <span class="n">ElecPowerGenerated</span>   <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!  electric power generated must be zero.</span>
<a name="ln-12260"></a>      <span class="k">END IF</span>
<a name="ln-12261"></a>
<a name="ln-12262"></a><span class="c">!     Set fuel heating values</span>
<a name="ln-12263"></a>      <span class="n">FuelHigherHeatingValue</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelHigherHeatingValue</span>
<a name="ln-12264"></a>      <span class="n">FuelLowerHeatingValue</span>  <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelLowerHeatingValue</span>
<a name="ln-12265"></a>
<a name="ln-12266"></a><span class="c">!     Calculate fuel mass flow rate</span>
<a name="ln-12267"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelMdot</span> <span class="o">=</span> <span class="n">FuelUseEnergyRateLHV</span> <span class="o">/</span> <span class="p">(</span><span class="n">FuelLowerHeatingValue</span> <span class="o">*</span> <span class="n">KJtoJ</span><span class="p">)</span>
<a name="ln-12268"></a>
<a name="ln-12269"></a><span class="c">!     Calculate ancillary power requirement</span>
<a name="ln-12270"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPowerFuelCurveNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12271"></a><span class="k">        </span><span class="n">AnciPowerFMdotFuel</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPowerFuelCurveNum</span><span class="p">,</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelMdot</span><span class="p">)</span>
<a name="ln-12272"></a><span class="c">!       Warn user if ancillary power modifier curve output is less than 0</span>
<a name="ln-12273"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AnciPowerFMdotFuel</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12274"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AnciPowerFMdotFuelErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12275"></a><span class="k">            CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-12276"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Ancillary Power Modifier (function of fuel input) output is less than&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-12277"></a>                                   <span class="s1">&#39; zero (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">AnciPowerFMdotFuel</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-12278"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Value occurs using a fuel input mass flow rate of &#39;</span> <span class="p">&amp;</span>
<a name="ln-12279"></a>                                   <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelMdot</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s.&#39;</span><span class="p">)</span>
<a name="ln-12280"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;... Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-12281"></a>          <span class="n">ENDIF</span>
<a name="ln-12282"></a>          <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12283"></a>              <span class="s1">&#39; Ancillary Power Modifier (function of fuel input) output is less than zero warning&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-12284"></a>              <span class="s1">&#39; continues...&#39;</span><span class="p">,</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AnciPowerFMdotFuelErrorIndex</span><span class="p">,</span> <span class="n">AnciPowerFMdotFuel</span><span class="p">,</span> <span class="n">AnciPowerFMdotFuel</span><span class="p">)</span>
<a name="ln-12285"></a>          <span class="n">AnciPowerFMdotFuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12286"></a>        <span class="k">END IF</span>
<a name="ln-12287"></a><span class="k">      ELSE</span>
<a name="ln-12288"></a><span class="k">        </span><span class="n">AnciPowerFMdotFuel</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12289"></a>      <span class="k">END IF</span>
<a name="ln-12290"></a>
<a name="ln-12291"></a><span class="k">      </span><span class="n">AncillaryPowerRateLast</span> <span class="o">=</span> <span class="n">AncillaryPowerRate</span>
<a name="ln-12292"></a>
<a name="ln-12293"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPowerFuelCurveNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12294"></a><span class="k">          </span><span class="n">AncillaryPowerRate</span> <span class="o">=</span> <span class="n">RelaxFactor</span> <span class="o">*</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPower</span> <span class="o">*</span> <span class="n">AnciPowerFMdotFuel</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-12295"></a>                               <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">RelaxFactor</span><span class="p">)</span> <span class="o">*</span> <span class="n">AncillaryPowerRateLast</span>
<a name="ln-12296"></a>      <span class="k">END IF</span>
<a name="ln-12297"></a>
<a name="ln-12298"></a><span class="k">      </span><span class="n">AncillaryPowerRateDiff</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">AncillaryPowerRate</span> <span class="o">-</span> <span class="n">AncillaryPowerRateLast</span><span class="p">)</span>
<a name="ln-12299"></a>
<a name="ln-12300"></a>    <span class="k">END DO</span>
<a name="ln-12301"></a>
<a name="ln-12302"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">AncPowerCalcIterIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxAncPowerIter</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12303"></a>
<a name="ln-12304"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AnciPowerIterErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12305"></a><span class="k">        CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-12306"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Iteration loop for electric power generation is not converging within tolerance.&#39;</span><span class="p">)</span>
<a name="ln-12307"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Check the Ancillary Power Modifier Curve (function of fuel input).&#39;</span><span class="p">)</span>
<a name="ln-12308"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Ancillary Power = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">AncillaryPowerRate</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W.&#39;</span><span class="p">)</span>
<a name="ln-12309"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Fuel input rate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">AnciPowerFMdotFuel</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s.&#39;</span><span class="p">)</span>
<a name="ln-12310"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;... Simulation will continue.&#39;</span><span class="p">)</span>
<a name="ln-12311"></a>      <span class="n">ENDIF</span>
<a name="ln-12312"></a>      <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12313"></a>            <span class="s1">&#39; Iteration loop for electric power generation is not converging within tolerance continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12314"></a>              <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AnciPowerIterErrorIndex</span><span class="p">)</span>
<a name="ln-12315"></a>
<a name="ln-12316"></a>    <span class="k">END IF</span>
<a name="ln-12317"></a>
<a name="ln-12318"></a><span class="c">!   Calculate electrical power generated</span>
<a name="ln-12319"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ElecPowerGenerated</span> <span class="o">=</span> <span class="n">ElecPowerGenerated</span> <span class="o">-</span> <span class="n">AncillaryPowerRate</span>
<a name="ln-12320"></a>
<a name="ln-12321"></a><span class="c">!   Report fuel energy use rate on HHV basis, which is the unit of measure when the fuel is sold</span>
<a name="ln-12322"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergyUseRateHHV</span>  <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelMdot</span> <span class="o">*</span> <span class="n">FuelHigherHeatingValue</span> <span class="o">*</span> <span class="n">KJtoJ</span>
<a name="ln-12323"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">AncillaryPowerRate</span>    <span class="o">=</span> <span class="n">AncillaryPowerRate</span>  <span class="c">! Move to data structure for later reporting</span>
<a name="ln-12324"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelEnergyUseRateLHV</span>  <span class="o">=</span> <span class="n">FuelUseEnergyRateLHV</span> <span class="c">! Move to data structure for reporting calculations</span>
<a name="ln-12325"></a>
<a name="ln-12326"></a><span class="c">!   When generator operates, standby losses are 0</span>
<a name="ln-12327"></a>    <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">StandbyPowerRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12328"></a>
<a name="ln-12329"></a><span class="c">!   Calculate heat recovery if active</span>
<a name="ln-12330"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12331"></a>
<a name="ln-12332"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ThermEffFTempElevCurveNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12333"></a><span class="k">         </span><span class="n">ThermalEffFTempElev</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ThermEffFTempElevCurveNum</span><span class="p">,</span> <span class="n">CombustionAirInletTemp</span><span class="p">,</span> <span class="n">Elevation</span><span class="p">)</span>
<a name="ln-12334"></a><span class="c">!       Warn user if power modifier curve output is less than 0</span>
<a name="ln-12335"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ThermalEffFTempElev</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12336"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ThermEffFTempElevErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12337"></a><span class="k">            CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-12338"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Electrical Power Modifier curve (function of temperature and elevation) output is &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-12339"></a>                                   <span class="s1">&#39;less than zero (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">PowerFTempElev</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-12340"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Value occurs using a combustion inlet air temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-12341"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CombustionAirInletTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C.&#39;</span><span class="p">)</span>
<a name="ln-12342"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... and an elevation of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Elevation</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m.&#39;</span><span class="p">)</span>
<a name="ln-12343"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;... Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-12344"></a>          <span class="n">ENDIF</span>
<a name="ln-12345"></a>          <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12346"></a>              <span class="s1">&#39; Electrical Power Modifier curve is less than zero warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-12347"></a>              <span class="p">,</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ThermEffFTempElevErrorIndex</span><span class="p">,</span> <span class="n">ThermalEffFTempElev</span><span class="p">,</span> <span class="n">ThermalEffFTempElev</span><span class="p">)</span>
<a name="ln-12348"></a>          <span class="n">ThermalEffFTempElev</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12349"></a>        <span class="k">END IF</span>
<a name="ln-12350"></a><span class="k">      ELSE</span>
<a name="ln-12351"></a><span class="k">         </span><span class="n">ThermalEffFTempElev</span> <span class="o">=</span> <span class="mf">1.0d0</span>  <span class="c">! If no curve provided, assume multiplier factor = 1.0</span>
<a name="ln-12352"></a>      <span class="k">END IF</span>
<a name="ln-12353"></a>
<a name="ln-12354"></a><span class="k">      </span><span class="n">QHeatRecToWater</span> <span class="o">=</span> <span class="n">FuelUseEnergyRateLHV</span> <span class="o">*</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefThermalEffLHV</span> <span class="o">*</span> <span class="n">ThermalEffFTempElev</span>
<a name="ln-12355"></a>
<a name="ln-12356"></a><span class="c">!     Calculate heat recovery rate modifier curve output (function of PLR)</span>
<a name="ln-12357"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFPLRCurveNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12358"></a><span class="k">        </span><span class="n">HeatRecRateFPLR</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFPLRCurveNum</span><span class="p">,</span> <span class="n">PLR</span><span class="p">)</span>
<a name="ln-12359"></a><span class="c">!       Warn user if heat recovery modifier curve output is less than 0</span>
<a name="ln-12360"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">HeatRecRateFPLR</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12361"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFPLRErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12362"></a><span class="k">            CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-12363"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Heat Recovery Rate Modifier (function of part-load ratio) output is less than&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-12364"></a>                                   <span class="s1">&#39; zero (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatRecRateFPLR</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-12365"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Value occurs using a part-load ratio of &#39;</span> <span class="p">&amp;</span>
<a name="ln-12366"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">PLR</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-12367"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;... Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-12368"></a>          <span class="n">ENDIF</span>
<a name="ln-12369"></a>          <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12370"></a>              <span class="s1">&#39; Heat Recovery Rate Modifier (function of part-load ratio) output is less than zero warning&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-12371"></a>              <span class="s1">&#39; continues...&#39;</span><span class="p">,</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFPLRErrorIndex</span><span class="p">,</span> <span class="n">HeatRecRateFPLR</span><span class="p">,</span> <span class="n">HeatRecRateFPLR</span><span class="p">)</span>
<a name="ln-12372"></a>          <span class="n">HeatRecRateFPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12373"></a>        <span class="k">END IF</span>
<a name="ln-12374"></a><span class="k">      ELSE</span>
<a name="ln-12375"></a><span class="k">        </span><span class="n">HeatRecRateFPLR</span> <span class="o">=</span> <span class="mf">1.0d0</span>  <span class="c">! If no curve provided, assume multiplier factor = 1.0</span>
<a name="ln-12376"></a>      <span class="k">END IF</span>
<a name="ln-12377"></a>
<a name="ln-12378"></a><span class="c">!     Calculate heat recovery rate modifier curve output (function of inlet water temp)</span>
<a name="ln-12379"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFTempCurveNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12380"></a><span class="k">        </span><span class="n">HeatRecRateFTemp</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFTempCurveNum</span><span class="p">,</span> <span class="n">HeatRecInTemp</span><span class="p">)</span>
<a name="ln-12381"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">HeatRecRateFTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12382"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFTempErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12383"></a><span class="k">            CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-12384"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Heat Recovery Rate Modifier (function of inlet water temp) output is less than &#39;</span> <span class="p">&amp;</span>
<a name="ln-12385"></a>                              <span class="o">//</span><span class="s1">&#39;zero (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatRecRateFTemp</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-12386"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Value occurs using an inlet water temperature temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-12387"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatRecInTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C.&#39;</span><span class="p">)</span>
<a name="ln-12388"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;... Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-12389"></a>          <span class="n">ENDIF</span>
<a name="ln-12390"></a>          <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12391"></a>                 <span class="s1">&#39; Heat Recovery Rate Modifier (function of inlet water temp) output is less than zero warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-12392"></a>                 <span class="p">,</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFTempErrorIndex</span><span class="p">,</span> <span class="n">HeatRecRateFTemp</span><span class="p">,</span> <span class="n">HeatRecRateFTemp</span><span class="p">)</span>
<a name="ln-12393"></a>          <span class="n">HeatRecRateFTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12394"></a>        <span class="k">END IF</span>
<a name="ln-12395"></a><span class="k">      ELSE</span>
<a name="ln-12396"></a><span class="k">        </span><span class="n">HeatRecRateFTemp</span> <span class="o">=</span> <span class="mf">1.0d0</span>  <span class="c">! If no curve provided, assume multiplier factor = 1.0</span>
<a name="ln-12397"></a>      <span class="k">END IF</span>
<a name="ln-12398"></a>
<a name="ln-12399"></a><span class="c">!     Calculate heat recovery rate modifier curve output (function of water [volumetric] flow rate)</span>
<a name="ln-12400"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFWaterFlowCurveNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12401"></a><span class="k">        </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12402"></a>                                 <span class="n">HeatRecInTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12403"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12404"></a>                                 <span class="s1">&#39;CalcMTGeneratorModel&#39;</span><span class="p">)</span>
<a name="ln-12405"></a>
<a name="ln-12406"></a>        <span class="n">HeatRecVolFlowRate</span> <span class="o">=</span> <span class="n">HeatRecMdot</span> <span class="o">/</span> <span class="n">rho</span>
<a name="ln-12407"></a>        <span class="n">HeatRecRateFFlow</span>  <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFWaterFlowCurveNum</span><span class="p">,</span><span class="n">HeatRecVolFlowRate</span><span class="p">)</span>
<a name="ln-12408"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">HeatRecRateFFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12409"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFFlowErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12410"></a><span class="k">            CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-12411"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Heat Recovery Rate Modifier (function of water flow rate) output is less than &#39;</span> <span class="p">&amp;</span>
<a name="ln-12412"></a>                              <span class="o">//</span><span class="s1">&#39;zero (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatRecRateFFlow</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-12413"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Value occurs using a water flow rate of &#39;</span> <span class="p">&amp;</span>
<a name="ln-12414"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatRecVolFlowRate</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s.&#39;</span><span class="p">)</span>
<a name="ln-12415"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;... Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-12416"></a>          <span class="n">ENDIF</span>
<a name="ln-12417"></a>          <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12418"></a>              <span class="s1">&#39; Heat Recovery Rate Modifier (function of water flow rate) output is less than zero warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-12419"></a>              <span class="p">,</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecRateFFlowErrorIndex</span><span class="p">,</span> <span class="n">HeatRecRateFFlow</span><span class="p">,</span> <span class="n">HeatRecRateFFlow</span><span class="p">)</span>
<a name="ln-12420"></a>          <span class="n">HeatRecRateFFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12421"></a>        <span class="k">END IF</span>
<a name="ln-12422"></a><span class="k">      ELSE</span>
<a name="ln-12423"></a><span class="k">        </span><span class="n">HeatRecRateFFlow</span> <span class="o">=</span> <span class="mf">1.0d0</span>  <span class="c">! If no curve provided, assume multiplier factor = 1.0</span>
<a name="ln-12424"></a>      <span class="k">END IF</span>
<a name="ln-12425"></a>
<a name="ln-12426"></a><span class="k">      </span><span class="n">QHeatRecToWater</span> <span class="o">=</span> <span class="n">QHeatRecToWater</span> <span class="o">*</span> <span class="n">HeatRecRateFPLR</span> <span class="o">*</span> <span class="n">HeatRecRateFTemp</span> <span class="o">*</span> <span class="n">HeatRecRateFFlow</span>
<a name="ln-12427"></a>
<a name="ln-12428"></a><span class="c">!     Check for divide by zero</span>
<a name="ln-12429"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">HeatRecMdot</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">HeatRecCp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12430"></a><span class="k">        </span><span class="n">HeatRecOutTemp</span> <span class="o">=</span>  <span class="n">HeatRecInTemp</span> <span class="o">+</span> <span class="n">QHeatRecToWater</span><span class="o">/</span> <span class="p">(</span><span class="n">HeatRecMdot</span> <span class="o">*</span> <span class="n">HeatRecCp</span><span class="p">)</span>
<a name="ln-12431"></a>      <span class="k">ELSE</span>
<a name="ln-12432"></a><span class="k">        </span><span class="n">HeatRecMdot</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12433"></a>        <span class="n">HeatRecOutTemp</span>  <span class="o">=</span> <span class="n">HeatRecInTemp</span>
<a name="ln-12434"></a>        <span class="n">QHeatRecToWater</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12435"></a>      <span class="k">END IF</span>
<a name="ln-12436"></a>
<a name="ln-12437"></a><span class="c">!     Now verify the maximum heat recovery temperature was not exceeded</span>
<a name="ln-12438"></a>      <span class="n">HRecRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-12439"></a>      <span class="n">MinHeatRecMdot</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-12440"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HeatRecOutTemp</span> <span class="o">&gt;</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxWaterTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12441"></a>
<a name="ln-12442"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxWaterTemp</span> <span class="o">/=</span> <span class="n">HeatRecInTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12443"></a><span class="k">          </span><span class="n">MinHeatRecMdot</span> <span class="o">=</span> <span class="n">QHeatRecToWater</span><span class="o">/</span><span class="p">(</span><span class="n">HeatRecCp</span> <span class="o">*</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxWaterTemp</span> <span class="o">-</span> <span class="n">HeatRecInTemp</span><span class="p">))</span>
<a name="ln-12444"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">MinHeatRecMdot</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">MinHeatRecMdot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12445"></a>        <span class="k">END IF</span>
<a name="ln-12446"></a>
<a name="ln-12447"></a><span class="c">!       Recalculate outlet water temperature with minimum flow rate (will normally match the max water outlet temp,</span>
<a name="ln-12448"></a><span class="c">!       unless the inlet water temp is greater than the max outlet temp)</span>
<a name="ln-12449"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">MinHeatRecMdot</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">HeatRecCp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-12450"></a><span class="k">          </span><span class="n">HeatRecOutTemp</span> <span class="o">=</span> <span class="n">QHeatRecToWater</span><span class="o">/</span><span class="p">(</span><span class="n">MinHeatRecMdot</span> <span class="o">*</span> <span class="n">HeatRecCp</span><span class="p">)</span> <span class="o">+</span> <span class="n">HeatRecInTemp</span>
<a name="ln-12451"></a>          <span class="n">HRecRatio</span> <span class="o">=</span> <span class="n">HeatRecMdot</span><span class="o">/</span><span class="n">MinHeatRecMdot</span>
<a name="ln-12452"></a>        <span class="k">ELSE</span>
<a name="ln-12453"></a><span class="k">          </span><span class="n">HeatRecOutTemp</span> <span class="o">=</span> <span class="n">HeatRecInTemp</span>
<a name="ln-12454"></a>          <span class="n">HRecRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12455"></a>        <span class="k">END IF</span>
<a name="ln-12456"></a><span class="k">        </span><span class="n">QHeatRecToWater</span> <span class="o">=</span> <span class="n">QHeatRecToWater</span><span class="o">*</span><span class="n">HRecRatio</span> <span class="c">! Scale heat recovery rate using HRecRatio. Don&#39;t adjust flow rate.</span>
<a name="ln-12457"></a>
<a name="ln-12458"></a>      <span class="k">END IF</span>
<a name="ln-12459"></a>
<a name="ln-12460"></a><span class="c">!     Check water mass flow rate against minimum</span>
<a name="ln-12461"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMinMassFlowRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">HeatRecMdot</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">HeatRecMdot</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12462"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRMinFlowErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12463"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-12464"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heat reclaim water flow rate is below the generators minimum mass flow rate of (&#39;</span> <span class="p">&amp;</span>
<a name="ln-12465"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMinMassFlowRate</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-12466"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heat reclaim water mass flow rate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatRecMdot</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-12467"></a>          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;...Check inputs for heat recovery water flow rate.&#39;</span><span class="p">)</span>
<a name="ln-12468"></a>        <span class="n">ENDIF</span>
<a name="ln-12469"></a>        <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12470"></a>               <span class="s1">&#39; Heat recovery water flow rate is below the generators minimum mass flow rate warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-12471"></a>               <span class="p">,</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRMinFlowErrorIndex</span><span class="p">,</span> <span class="n">HeatRecMdot</span><span class="p">,</span> <span class="n">HeatRecMdot</span><span class="p">)</span>
<a name="ln-12472"></a>      <span class="k">END IF</span>
<a name="ln-12473"></a>
<a name="ln-12474"></a><span class="c">!     Check water mass flow rate against maximum</span>
<a name="ln-12475"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HeatRecMdot</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxMassFlowRate</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">HeatRecMdot</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12476"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRMaxFlowErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12477"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-12478"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heat reclaim water flow rate is above the generators maximum mass flow rate of (&#39;</span> <span class="p">&amp;</span>
<a name="ln-12479"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMaxMassFlowRate</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-12480"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heat reclaim water mass flow rate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatRecMdot</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-12481"></a>          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;...Check inputs for heat recovery water flow rate.&#39;</span><span class="p">)</span>
<a name="ln-12482"></a>        <span class="n">ENDIF</span>
<a name="ln-12483"></a>        <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12484"></a>               <span class="s1">&#39; Heat recovery water flow rate is above the generators maximum mass flow rate warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-12485"></a>               <span class="p">,</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HRMaxFlowErrorIndex</span><span class="p">,</span> <span class="n">HeatRecMdot</span><span class="p">,</span> <span class="n">HeatRecMdot</span><span class="p">)</span>
<a name="ln-12486"></a>      <span class="k">END IF</span>
<a name="ln-12487"></a>
<a name="ln-12488"></a><span class="c">!     Set report variables</span>
<a name="ln-12489"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span>   <span class="o">=</span> <span class="n">HeatRecInTemp</span>
<a name="ln-12490"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span>  <span class="o">=</span> <span class="n">HeatRecOutTemp</span>
<a name="ln-12491"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">HeatRecMdot</span>        <span class="o">=</span> <span class="n">HeatRecMdot</span>
<a name="ln-12492"></a>      <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">QHeatRecovered</span>     <span class="o">=</span> <span class="n">QHeatRecToWater</span>
<a name="ln-12493"></a>
<a name="ln-12494"></a>    <span class="k">END IF</span> <span class="c">! End of  IF (MTGenerator(GeneratorNum)%HeatRecActive) THEN</span>
<a name="ln-12495"></a>
<a name="ln-12496"></a><span class="c">!   Calculate combustion air outlet conditions if exhaust air calculations are active</span>
<a name="ln-12497"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirCalcsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12498"></a>
<a name="ln-12499"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFTempCurveNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Exhaust Flow Rate versus Inlet Air Temp</span>
<a name="ln-12500"></a>        <span class="n">ExhFlowFTemp</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFTempCurveNum</span><span class="p">,</span><span class="n">CombustionAirInletTemp</span><span class="p">)</span>
<a name="ln-12501"></a><span class="c">!       Warn user if exhaust modifier curve output is less than or equal to 0</span>
<a name="ln-12502"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ExhFlowFTemp</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12503"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFTempErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12504"></a><span class="k">            CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-12505"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Exhaust Air Flow Rate Modifier (function of temperature) output is less than or equal &#39;</span><span class="p">&amp;</span>
<a name="ln-12506"></a>                              <span class="o">//</span><span class="s1">&#39;to zero (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ExhFlowFTemp</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-12507"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Value occurs using a combustion inlet air temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-12508"></a>                             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CombustionAirInletTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-12509"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;...Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-12510"></a>          <span class="n">ENDIF</span>
<a name="ln-12511"></a>          <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12512"></a>            <span class="s1">&#39; Exhaust Air Flow Rate Modifier (function of temperature) output is less than or equal to zero warning continues...&#39;</span><span class="p">&amp;</span>
<a name="ln-12513"></a>            <span class="p">,</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFTempErrorIndex</span><span class="p">,</span> <span class="n">ExhFlowFTemp</span><span class="p">,</span> <span class="n">ExhFlowFTemp</span><span class="p">)</span>
<a name="ln-12514"></a>          <span class="n">ExhFlowFTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12515"></a>        <span class="k">END IF</span>
<a name="ln-12516"></a><span class="k">      ELSE</span>
<a name="ln-12517"></a><span class="k">        </span><span class="n">ExhFlowFTemp</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! No curve input means modifier = 1.0 always</span>
<a name="ln-12518"></a>      <span class="k">END IF</span>
<a name="ln-12519"></a>
<a name="ln-12520"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFPLRCurveNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Exhaust Flow Rate versus Part-Load Ratio</span>
<a name="ln-12521"></a>        <span class="n">ExhFlowFPLR</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFPLRCurveNum</span><span class="p">,</span><span class="n">PLR</span><span class="p">)</span>
<a name="ln-12522"></a><span class="c">!       Warn user if exhaust modifier curve output is less than or equal to 0</span>
<a name="ln-12523"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ExhFlowFPLR</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12524"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFPLRErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12525"></a><span class="k">            CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-12526"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Exhaust Air Flow Rate Modifier (function of part-load ratio) output is less than or &#39;</span><span class="p">&amp;</span>
<a name="ln-12527"></a>                              <span class="o">//</span><span class="s1">&#39;equal to zero (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ExhFlowFPLR</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-12528"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Value occurs using a part-load ratio of &#39;</span> <span class="p">&amp;</span>
<a name="ln-12529"></a>                             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">PLR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-12530"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;...Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-12531"></a>          <span class="n">ENDIF</span>
<a name="ln-12532"></a>          <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12533"></a>            <span class="s1">&#39; Exhaust Air Flow Rate Modifier (function of part-load ratio) output is less than or equal to zero warning&#39;</span><span class="p">&amp;</span>
<a name="ln-12534"></a>             <span class="o">//</span><span class="s1">&#39; continues...&#39;</span><span class="p">,</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhFlowFPLRErrorIndex</span><span class="p">,</span> <span class="n">ExhFlowFPLR</span><span class="p">,</span> <span class="n">ExhFlowFPLR</span><span class="p">)</span>
<a name="ln-12535"></a>          <span class="n">ExhFlowFPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12536"></a>        <span class="k">END IF</span>
<a name="ln-12537"></a><span class="k">      ELSE</span>
<a name="ln-12538"></a><span class="k">        </span><span class="n">ExhFlowFPLR</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! No curve input means modifier = 1.0 always</span>
<a name="ln-12539"></a>      <span class="k">END IF</span>
<a name="ln-12540"></a>
<a name="ln-12541"></a><span class="c">!     Calculate exhaust air mass flow, accounting for temperature and PLR modifier factors</span>
<a name="ln-12542"></a>      <span class="n">ExhAirMassFlowRate</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefExhaustAirMassFlowRate</span> <span class="o">*</span> <span class="n">ExhFlowFTemp</span> <span class="o">*</span> <span class="n">ExhFlowFPLR</span>
<a name="ln-12543"></a><span class="c">!     Adjust for difference in air density at reference conditions versus actual inlet air conditions</span>
<a name="ln-12544"></a>      <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">CombustionAirInletPress</span><span class="p">,</span><span class="n">CombustionAirInletTemp</span><span class="p">,</span><span class="n">CombustionAirInletW</span><span class="p">)</span>
<a name="ln-12545"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletDensity</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12546"></a><span class="k">        </span><span class="n">ExhAirMassFlowRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">ExhAirMassFlowRate</span><span class="o">*</span><span class="n">AirDensity</span><span class="o">/</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">RefCombustAirInletDensity</span><span class="p">)</span>
<a name="ln-12547"></a>      <span class="k">ELSE</span>
<a name="ln-12548"></a><span class="k">        </span><span class="n">ExhAirMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12549"></a>      <span class="k">END IF</span>
<a name="ln-12550"></a><span class="k">      </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirMassFlowRate</span> <span class="o">=</span> <span class="n">ExhAirMassFlowRate</span>
<a name="ln-12551"></a>
<a name="ln-12552"></a>
<a name="ln-12553"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirTempFTempCurveNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Exhaust Air Temp versus Inlet Air Temp</span>
<a name="ln-12554"></a>        <span class="n">ExhAirTempFTemp</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirTempFTempCurveNum</span><span class="p">,</span><span class="n">CombustionAirInletTemp</span><span class="p">)</span>
<a name="ln-12555"></a><span class="c">!       Warn user if exhaust modifier curve output is less than or equal to 0</span>
<a name="ln-12556"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ExhAirTempFTemp</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12557"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhTempFTempErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12558"></a><span class="k">            CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-12559"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Exhaust Air Temperature Modifier (function of temperature) output is less than or equal &#39;</span><span class="p">&amp;</span>
<a name="ln-12560"></a>                              <span class="o">//</span><span class="s1">&#39;to zero (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ExhAirTempFTemp</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-12561"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Value occurs using a combustion inlet air temperature of &#39;</span> <span class="p">&amp;</span>
<a name="ln-12562"></a>                             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CombustionAirInletTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-12563"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;...Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-12564"></a>          <span class="n">ENDIF</span>
<a name="ln-12565"></a>          <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12566"></a>            <span class="s1">&#39; Exhaust Air Temperature Modifier (function of temperature) output is less than or equal to zero&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12567"></a>            <span class="s1">&#39; warning continues...&#39;</span><span class="p">,</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhTempFTempErrorIndex</span><span class="p">,</span> <span class="n">ExhAirTempFTemp</span><span class="p">,</span> <span class="n">ExhAirTempFTemp</span><span class="p">)</span>
<a name="ln-12568"></a>          <span class="n">ExhAirTempFTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12569"></a>        <span class="k">END IF</span>
<a name="ln-12570"></a><span class="k">      ELSE</span>
<a name="ln-12571"></a><span class="k">        </span><span class="n">ExhAirTempFTemp</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! No curve input means modifier = 1.0 always</span>
<a name="ln-12572"></a>      <span class="k">END IF</span>
<a name="ln-12573"></a>
<a name="ln-12574"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirTempFPLRCurveNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Exhaust Air Temp versus Part-Load Ratio</span>
<a name="ln-12575"></a>        <span class="n">ExhAirTempFPLR</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhAirTempFPLRCurveNum</span><span class="p">,</span><span class="n">PLR</span><span class="p">)</span>
<a name="ln-12576"></a><span class="c">!       Warn user if exhaust modifier curve output is less than or equal to 0</span>
<a name="ln-12577"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ExhAirTempFPLR</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12578"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhTempFPLRErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12579"></a><span class="k">            CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-12580"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Exhaust Air Temperature Modifier (function of part-load ratio) output is less than or &#39;</span><span class="p">&amp;</span>
<a name="ln-12581"></a>                              <span class="o">//</span><span class="s1">&#39;equal to zero (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ExhAirTempFPLR</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-12582"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Value occurs using a part-load ratio of &#39;</span> <span class="p">&amp;</span>
<a name="ln-12583"></a>                             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">PLR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-12584"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;...Resetting curve output to zero and continuing simulation.&#39;</span><span class="p">)</span>
<a name="ln-12585"></a>          <span class="n">ENDIF</span>
<a name="ln-12586"></a>          <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-12587"></a>            <span class="s1">&#39; Exhaust Air Temperature Modifier (function of part-load ratio) output is less than or equal to zero warning&#39;</span> <span class="p">&amp;</span>
<a name="ln-12588"></a>             <span class="o">//</span><span class="s1">&#39; continues...&#39;</span><span class="p">,</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhTempFPLRErrorIndex</span><span class="p">,</span> <span class="n">ExhAirTempFPLR</span><span class="p">,</span> <span class="n">ExhAirTempFPLR</span><span class="p">)</span>
<a name="ln-12589"></a>          <span class="n">ExhAirTempFPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12590"></a>        <span class="k">END IF</span>
<a name="ln-12591"></a><span class="k">      ELSE</span>
<a name="ln-12592"></a><span class="k">        </span><span class="n">ExhAirTempFPLR</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! No curve input means modifier = 1.0 always</span>
<a name="ln-12593"></a>      <span class="k">END IF</span>
<a name="ln-12594"></a>
<a name="ln-12595"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ExhAirMassFlowRate</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12596"></a><span class="k">        </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirTemperature</span> <span class="o">=</span> <span class="n">CombustionAirInletTemp</span>
<a name="ln-12597"></a>        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirHumRat</span> <span class="o">=</span> <span class="n">CombustionAirInletW</span>
<a name="ln-12598"></a>      <span class="k">ELSE</span>
<a name="ln-12599"></a><span class="c">!       Calculate exhaust air temperature, accounting for inlet air temperature and PLR modifier factors</span>
<a name="ln-12600"></a>        <span class="n">ExhaustAirTemp</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">NomExhAirOutletTemp</span> <span class="o">*</span> <span class="n">ExhAirTempFTemp</span> <span class="o">*</span> <span class="n">ExhAirTempFPLR</span>
<a name="ln-12601"></a>        <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirTemperature</span> <span class="o">=</span> <span class="n">ExhaustAirTemp</span>
<a name="ln-12602"></a><span class="c">!       Adjust exhaust air temperature if heat recovery to water is being done</span>
<a name="ln-12603"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">QHeatRecToWater</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12604"></a><span class="k">          </span><span class="n">CpAir</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">CombustionAirInletW</span><span class="p">,</span><span class="n">CombustionAirInletTemp</span><span class="p">)</span>
<a name="ln-12605"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CpAir</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12606"></a><span class="k">            </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirTemperature</span> <span class="o">=</span> <span class="n">ExhaustAirTemp</span> <span class="o">-</span> <span class="n">QHeatRecToWater</span> <span class="o">/</span> <span class="p">(</span><span class="n">CpAir</span> <span class="o">*</span> <span class="n">ExhAirMassFlowRate</span><span class="p">)</span>
<a name="ln-12607"></a>          <span class="k">END IF</span>
<a name="ln-12608"></a><span class="k">        END IF</span>
<a name="ln-12609"></a><span class="c">!       Calculate exhaust air humidity ratio</span>
<a name="ln-12610"></a>        <span class="n">H2OHtOfVap</span> <span class="o">=</span> <span class="n">PsyHfgAirFnWTdb</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">6.0d0</span><span class="p">,</span><span class="s1">&#39;CalcMTGeneratorModel&#39;</span><span class="p">)</span> <span class="c">! W not used, passing 1.0 as dummy.</span>
<a name="ln-12611"></a>                                                                          <span class="c">! Assume fuel is at 16C (ASHRAE HOF)</span>
<a name="ln-12612"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">H2OHtOfVap</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12613"></a><span class="k">          </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirHumRat</span> <span class="o">=</span> <span class="n">CombustionAirInletW</span> <span class="o">+</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">FuelMdot</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-12614"></a>                                                       <span class="p">((</span><span class="n">FuelHigherHeatingValue</span><span class="o">-</span><span class="n">FuelLowerHeatingValue</span><span class="p">)</span><span class="o">*</span><span class="n">KJtoJ</span><span class="o">/</span><span class="n">H2OHtOfVap</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-12615"></a>                                                       <span class="n">ExhAirMassFlowRate</span>
<a name="ln-12616"></a>        <span class="k">ELSE</span>
<a name="ln-12617"></a><span class="k">          </span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirHumRat</span> <span class="o">=</span> <span class="n">CombustionAirInletW</span>
<a name="ln-12618"></a>        <span class="k">END IF</span>
<a name="ln-12619"></a><span class="k">      END IF</span>
<a name="ln-12620"></a>
<a name="ln-12621"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirTemperature</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">CombustionAirInletTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12622"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhTempLTInletTempIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12623"></a><span class="k">          CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-12624"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...The model has calculated the exhaust air temperature to be less than &#39;</span><span class="p">&amp;</span>
<a name="ln-12625"></a>                            <span class="o">//</span><span class="s1">&#39;the combustion air inlet temperature.&#39;</span><span class="p">)</span>
<a name="ln-12626"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Value of exhaust air temperature   =&#39;</span> <span class="p">&amp;</span>
<a name="ln-12627"></a>                                 <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirTemperature</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C.&#39;</span><span class="p">)</span>
<a name="ln-12628"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Value of combustion air inlet temp =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CombustionAirInletTemp</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C.&#39;</span><span class="p">)</span>
<a name="ln-12629"></a>          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;... Simulation will continue.&#39;</span><span class="p">)</span>
<a name="ln-12630"></a>        <span class="n">ENDIF</span>
<a name="ln-12631"></a>        <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-12632"></a>          <span class="s1">&#39; Exhaust air temperature less than combustion air inlet temperature warning continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12633"></a>            <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhTempLTInletTempIndex</span><span class="p">,</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirTemperature</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12634"></a>            <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirTemperature</span><span class="p">)</span>
<a name="ln-12635"></a>      <span class="k">END IF</span>
<a name="ln-12636"></a>
<a name="ln-12637"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirHumRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">CombustionAirInletW</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12638"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhHRLTInletHRIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12639"></a><span class="k">          CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-12640"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...The model has calculated the exhaust air humidity ratio to be less than &#39;</span><span class="p">&amp;</span>
<a name="ln-12641"></a>                            <span class="o">//</span><span class="s1">&#39;the combustion air inlet humidity ratio.&#39;</span><span class="p">)</span>
<a name="ln-12642"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Value of exhaust air humidity ratio          =&#39;</span> <span class="p">&amp;</span>
<a name="ln-12643"></a>                                 <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kgWater/kgDryAir.&#39;</span><span class="p">)</span>
<a name="ln-12644"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Value of combustion air inlet humidity ratio =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CombustionAirInletW</span><span class="p">,</span><span class="mi">6</span><span class="p">))&amp;</span>
<a name="ln-12645"></a>                                 <span class="o">//</span><span class="s1">&#39; kgWater/kgDryAir.&#39;</span><span class="p">)</span>
<a name="ln-12646"></a>          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;... Simulation will continue.&#39;</span><span class="p">)</span>
<a name="ln-12647"></a>        <span class="n">ENDIF</span>
<a name="ln-12648"></a>        <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;GENERATOR:MICROTURBINE &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-12649"></a>          <span class="s1">&#39; Exhaust air humidity ratio less than combustion air inlet humidity ratio warning continues...&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12650"></a>            <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhHRLTInletHRIndex</span><span class="p">,</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirHumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12651"></a>            <span class="n">MTGenerator</span><span class="p">(</span><span class="n">GeneratorNum</span><span class="p">)%</span><span class="n">ExhaustAirHumRat</span><span class="p">)</span>
<a name="ln-12652"></a>      <span class="k">END IF</span>
<a name="ln-12653"></a>
<a name="ln-12654"></a><span class="k">    END IF</span> <span class="c">! End of IF (MTGenerator(GeneratorNum)%ExhAirCalcsActive) THEN</span>
<a name="ln-12655"></a>
<a name="ln-12656"></a>  <span class="k">RETURN</span>
<a name="ln-12657"></a>
<a name="ln-12658"></a><span class="k">END SUBROUTINE </span><span class="n">CalcMTGeneratorModel</span>
<a name="ln-12659"></a>
<a name="ln-12660"></a><span class="c">!  End of MT Generator Model Calculation Subroutine</span>
<a name="ln-12661"></a><span class="c">! *****************************************************************************</span>
<a name="ln-12662"></a>
<a name="ln-12663"></a>
<a name="ln-12664"></a><span class="c">!  Beginning of record keeping subroutine for the MT Generator Module</span>
<a name="ln-12665"></a><span class="c">! *****************************************************************************</span>
<a name="ln-12666"></a>
<a name="ln-12667"></a><span class="k">SUBROUTINE </span><span class="n">UpdateMTGeneratorRecords</span><span class="p">(</span><span class="n">Num</span><span class="p">)</span>
<a name="ln-12668"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-12669"></a>          <span class="c">!       AUTHOR         R. Raustad/D. Shirey</span>
<a name="ln-12670"></a>          <span class="c">!       DATE WRITTEN   Mar 2008</span>
<a name="ln-12671"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-12672"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-12673"></a>
<a name="ln-12674"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-12675"></a>          <span class="c">!  Reporting and updating nodes if necessary.</span>
<a name="ln-12676"></a>
<a name="ln-12677"></a>          <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-12678"></a>
<a name="ln-12679"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-12680"></a>
<a name="ln-12681"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-12682"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-12683"></a>
<a name="ln-12684"></a>
<a name="ln-12685"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-12686"></a>
<a name="ln-12687"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-12688"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">Num</span>                <span class="c">! Generator number</span>
<a name="ln-12689"></a>
<a name="ln-12690"></a>
<a name="ln-12691"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-12692"></a>          <span class="c">! na</span>
<a name="ln-12693"></a>
<a name="ln-12694"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-12695"></a>          <span class="c">! na</span>
<a name="ln-12696"></a>
<a name="ln-12697"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-12698"></a>  <span class="kt">INTEGER</span>              <span class="kd">::</span> <span class="n">HeatRecInletNode</span>       <span class="c">! Node number for heat recovery (water) inlet node</span>
<a name="ln-12699"></a>  <span class="kt">INTEGER</span>              <span class="kd">::</span> <span class="n">HeatRecOutletNode</span>      <span class="c">! Node number for heat recovery (water) outlet node</span>
<a name="ln-12700"></a>  <span class="kt">INTEGER</span>              <span class="kd">::</span> <span class="n">ExhaustAirNodeNum</span>      <span class="c">! Node number for exhaust air node</span>
<a name="ln-12701"></a>  <span class="kt">INTEGER</span>              <span class="kd">::</span> <span class="n">CombustAirInletNodeNum</span> <span class="c">! Node number for combustion inlet air node</span>
<a name="ln-12702"></a>
<a name="ln-12703"></a>
<a name="ln-12704"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12705"></a>
<a name="ln-12706"></a><span class="k">    </span><span class="n">HeatRecInletNode</span>  <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>
<a name="ln-12707"></a>    <span class="n">HeatRecOutletNode</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>
<a name="ln-12708"></a>
<a name="ln-12709"></a><span class="c">!   Node(HeatRecOutletNode)%MassFlowRate         = MTGenerator(Num)%HeatRecMdot</span>
<a name="ln-12710"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecOutletNode</span><span class="p">)%</span><span class="n">Temp</span>                 <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span>
<a name="ln-12711"></a><span class="c">!    Node(HeatRecOutletNode)%MassFlowRateMaxAvail = Node(HeatRecInletNode)%MassFlowRateMaxAvail</span>
<a name="ln-12712"></a><span class="c">!    Node(HeatRecOutletNode)%MassFlowRateMinAvail = Node(HeatRecInletNode)%MassFlowRateMinAvail</span>
<a name="ln-12713"></a>
<a name="ln-12714"></a>  <span class="k">END IF</span>
<a name="ln-12715"></a>
<a name="ln-12716"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhAirCalcsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12717"></a><span class="k">    </span><span class="n">ExhaustAirNodeNum</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">CombustionAirOutletNodeNum</span>
<a name="ln-12718"></a>    <span class="n">CombustAirInletNodeNum</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">CombustionAirInletNodeNum</span>
<a name="ln-12719"></a>
<a name="ln-12720"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">ExhaustAirNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>         <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustAirMassFlowRate</span>
<a name="ln-12721"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">CombustAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>    <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustAirMassFlowRate</span>
<a name="ln-12722"></a>
<a name="ln-12723"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">ExhaustAirNodeNum</span><span class="p">)%</span><span class="n">Temp</span>                 <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustAirTemperature</span>
<a name="ln-12724"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">ExhaustAirNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>               <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustAirHumRat</span>
<a name="ln-12725"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">ExhaustAirNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">CombustAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>
<a name="ln-12726"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">ExhaustAirNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">CombustAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span>
<a name="ln-12727"></a>
<a name="ln-12728"></a><span class="c">! also update the report variables</span>
<a name="ln-12729"></a>   <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhAirMassFlowRate</span>     <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustAirMassFlowRate</span>
<a name="ln-12730"></a>   <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhAirTemperature</span>      <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustAirTemperature</span>
<a name="ln-12731"></a>   <span class="c">! for exhaust only report</span>
<a name="ln-12732"></a>
<a name="ln-12733"></a>  <span class="k">END IF</span>
<a name="ln-12734"></a>
<a name="ln-12735"></a><span class="k">  </span><span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">PowerGen</span>                <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecPowerGenerated</span>
<a name="ln-12736"></a>  <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">EnergyGen</span>               <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecPowerGenerated</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-12737"></a>  <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QHeatRecovered</span>          <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QHeatRecovered</span>
<a name="ln-12738"></a>  <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ExhaustEnergyRec</span>        <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QHeatRecovered</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-12739"></a>  <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelEnergyUseRateHHV</span>    <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelEnergyUseRateHHV</span>
<a name="ln-12740"></a>  <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelEnergyHHV</span>           <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelEnergyUseRateHHV</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-12741"></a>  <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelMdot</span>                <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelMdot</span>
<a name="ln-12742"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelEnergyUseRateLHV</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12743"></a><span class="k">    </span><span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElectricEfficiencyLHV</span>   <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElecPowerGenerated</span> <span class="o">/</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelEnergyUseRateLHV</span>
<a name="ln-12744"></a>    <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ThermalEfficiencyLHV</span>    <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">QHeatRecovered</span> <span class="o">/</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">FuelEnergyUseRateLHV</span>
<a name="ln-12745"></a>  <span class="k">ELSE</span>
<a name="ln-12746"></a><span class="k">    </span><span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ElectricEfficiencyLHV</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12747"></a>    <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">ThermalEfficiencyLHV</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-12748"></a>  <span class="k">END IF</span>
<a name="ln-12749"></a><span class="k">  </span><span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span>        <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecInletTemp</span>
<a name="ln-12750"></a>  <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span>       <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecOutletTemp</span>
<a name="ln-12751"></a>  <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecMdot</span>             <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">HeatRecMdot</span>
<a name="ln-12752"></a>  <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AncillaryPowerRate</span>      <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AncillaryPowerRate</span>
<a name="ln-12753"></a>  <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AncillaryEnergy</span>         <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">AncillaryPowerRate</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-12754"></a>  <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">StandbyPowerRate</span>        <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">StandbyPowerRate</span>
<a name="ln-12755"></a>  <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">StandbyEnergy</span>           <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">Num</span><span class="p">)%</span><span class="n">StandbyPowerRate</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-12756"></a>
<a name="ln-12757"></a>  <span class="k">RETURN</span>
<a name="ln-12758"></a>
<a name="ln-12759"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateMTGeneratorRecords</span>
<a name="ln-12760"></a>
<a name="ln-12761"></a>
<a name="ln-12762"></a>
<a name="ln-12763"></a><span class="k">SUBROUTINE </span><span class="n">GetMTGeneratorResults</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span> <span class="n">GeneratorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-12764"></a>                                 <span class="n">GeneratorPower</span><span class="p">,</span>  <span class="n">GeneratorEnergy</span><span class="p">,</span> <span class="n">ThermalPower</span><span class="p">,</span> <span class="n">ThermalEnergy</span><span class="p">)</span>
<a name="ln-12765"></a>
<a name="ln-12766"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-12767"></a>          <span class="c">!       AUTHOR         B Griffith</span>
<a name="ln-12768"></a>          <span class="c">!       DATE WRITTEN   March 2008</span>
<a name="ln-12769"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-12770"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-12771"></a>
<a name="ln-12772"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-12773"></a>          <span class="c">! get some results for load center&#39;s aggregation</span>
<a name="ln-12774"></a>
<a name="ln-12775"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-12776"></a>          <span class="c">!</span>
<a name="ln-12777"></a>
<a name="ln-12778"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-12779"></a>          <span class="c">! na</span>
<a name="ln-12780"></a>
<a name="ln-12781"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-12782"></a>          <span class="c">! na</span>
<a name="ln-12783"></a>
<a name="ln-12784"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-12785"></a>
<a name="ln-12786"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-12787"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">GeneratorType</span>   <span class="c">! type of Generator !unused1208</span>
<a name="ln-12788"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">GeneratorIndex</span>
<a name="ln-12789"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">GeneratorPower</span>  <span class="c">! electrical power</span>
<a name="ln-12790"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">GeneratorEnergy</span> <span class="c">! electrical energy</span>
<a name="ln-12791"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">ThermalPower</span>  <span class="c">! heat power</span>
<a name="ln-12792"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">ThermalEnergy</span> <span class="c">! heat energy</span>
<a name="ln-12793"></a>
<a name="ln-12794"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-12795"></a>          <span class="c">! na</span>
<a name="ln-12796"></a>
<a name="ln-12797"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-12798"></a>          <span class="c">! na</span>
<a name="ln-12799"></a>
<a name="ln-12800"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-12801"></a>          <span class="c">! na</span>
<a name="ln-12802"></a>
<a name="ln-12803"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-12804"></a>
<a name="ln-12805"></a>  <span class="n">GeneratorPower</span>  <span class="o">=</span>  <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">PowerGen</span>
<a name="ln-12806"></a>  <span class="n">GeneratorEnergy</span> <span class="o">=</span>  <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">EnergyGen</span>
<a name="ln-12807"></a>  <span class="n">ThermalPower</span>    <span class="o">=</span>  <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">QHeatRecovered</span>
<a name="ln-12808"></a>  <span class="n">ThermalEnergy</span>   <span class="o">=</span>  <span class="n">MTGeneratorReport</span><span class="p">(</span><span class="n">GeneratorIndex</span><span class="p">)%</span><span class="n">ExhaustEnergyRec</span>
<a name="ln-12809"></a>
<a name="ln-12810"></a>
<a name="ln-12811"></a>  <span class="k">RETURN</span>
<a name="ln-12812"></a>
<a name="ln-12813"></a><span class="k">END SUBROUTINE </span><span class="n">GetMTGeneratorResults</span>
<a name="ln-12814"></a>
<a name="ln-12815"></a><span class="k">SUBROUTINE </span><span class="n">GetMTGeneratorExhaustNode</span><span class="p">(</span><span class="n">CompType</span><span class="p">,</span><span class="n">CompName</span><span class="p">,</span><span class="n">ExhaustOutletNodeNum</span><span class="p">)</span>
<a name="ln-12816"></a>
<a name="ln-12817"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-12818"></a>          <span class="c">!       AUTHOR         Mahabir Bhandari</span>
<a name="ln-12819"></a>          <span class="c">!       DATE WRITTEN   Jul 2011</span>
<a name="ln-12820"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-12821"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-12822"></a>
<a name="ln-12823"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-12824"></a>          <span class="c">! To pass exhaust outlet number from Micro Turbine to Exhaust fired absorption chiller.</span>
<a name="ln-12825"></a>          <span class="c">!</span>
<a name="ln-12826"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-12827"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-12828"></a>
<a name="ln-12829"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-12830"></a>          <span class="c">! na</span>
<a name="ln-12831"></a>
<a name="ln-12832"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-12833"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-12834"></a>
<a name="ln-12835"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-12836"></a>
<a name="ln-12837"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-12838"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CompType</span>
<a name="ln-12839"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompName</span>
<a name="ln-12840"></a>
<a name="ln-12841"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ExhaustOutletNodeNum</span>
<a name="ln-12842"></a>
<a name="ln-12843"></a>
<a name="ln-12844"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-12845"></a>          <span class="c">! na</span>
<a name="ln-12846"></a>
<a name="ln-12847"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-12848"></a>          <span class="c">! na</span>
<a name="ln-12849"></a>
<a name="ln-12850"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-12851"></a>          <span class="c">! na</span>
<a name="ln-12852"></a>
<a name="ln-12853"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-12854"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CompNum</span>
<a name="ln-12855"></a>
<a name="ln-12856"></a>
<a name="ln-12857"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetMTInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12858"></a>     <span class="c">! Read input data.</span>
<a name="ln-12859"></a>    <span class="k">CALL </span><span class="n">GetMTGeneratorInput</span>
<a name="ln-12860"></a>    <span class="n">GetMTInput</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-12861"></a>  <span class="n">ENDIF</span>
<a name="ln-12862"></a>
<a name="ln-12863"></a>  <span class="n">ExhaustOutletNodeNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-12864"></a>
<a name="ln-12865"></a>  <span class="n">CompNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">MTGenerator</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumMTGenerators</span><span class="p">)</span>
<a name="ln-12866"></a>
<a name="ln-12867"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-12868"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;GetMTGeneratorExhaustNode: Unit not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-12869"></a>  <span class="k">ELSE</span>
<a name="ln-12870"></a><span class="k">    </span><span class="n">ExhaustOutletNodeNum</span> <span class="o">=</span> <span class="n">MTGenerator</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">CombustionAirOutletNodeNum</span>
<a name="ln-12871"></a>  <span class="n">ENDIF</span>
<a name="ln-12872"></a>  <span class="k">RETURN</span>
<a name="ln-12873"></a><span class="k">END SUBROUTINE </span><span class="n">GetMTGeneratorExhaustNode</span>
<a name="ln-12874"></a>
<a name="ln-12875"></a><span class="c">! End of Record Keeping subroutine for the MT Generator Module</span>
<a name="ln-12876"></a><span class="c">! *****************************************************************************</span>
<a name="ln-12877"></a>
<a name="ln-12878"></a><span class="k">END MODULE </span><span class="n">MicroturbineElectricGenerator</span>
<a name="ln-12879"></a>
<a name="ln-12880"></a><span class="c">!     NOTICE</span>
<a name="ln-12881"></a><span class="c">!</span>
<a name="ln-12882"></a><span class="c">!     Copyright  1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-12883"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-12884"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-12885"></a><span class="c">!</span>
<a name="ln-12886"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-12887"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-12888"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-12889"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-12890"></a><span class="c">!</span>
<a name="ln-12891"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-12892"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-12893"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-12894"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-12895"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-12896"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-12897"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-12898"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-12899"></a><span class="c">!     permit others to do so.</span>
<a name="ln-12900"></a><span class="c">!</span>
<a name="ln-12901"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-12902"></a><span class="c">!</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
