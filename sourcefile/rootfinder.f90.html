<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>RootFinder.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>RootFinder.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 0.2% of total for source files.">923 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/RootFinder.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">RootFinder.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/rootfinder.html">RootFinder</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/rootfinder.f90.html#src">RootFinder.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~rootfinder.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilerootfinderf90EfferentGraph" width="641pt" height="493pt"
 viewBox="0.00 0.00 641.00 493.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~rootfinder.f90~~EfferentGraph" class="graph" transform="scale(.7248 .7248) rotate(0) translate(4 676.7158)">
<title>sourcefile~~rootfinder.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-676.7158 880.3501,-676.7158 880.3501,4 -4,4"/>
<!-- sourcefile~rootfinder.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~rootfinder.f90</title>
<polygon fill="none" stroke="#000000" points="876.2905,-451.9759 795.5291,-451.9759 795.5291,-429.965 876.2905,-429.965 876.2905,-451.9759"/>
<text text-anchor="middle" x="835.9098" y="-437.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">RootFinder.f90</text>
</g>
<!-- sourcefile~datarootfinder.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~datarootfinder.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/datarootfinder.f90.html" xlink:title="DataRootFinder.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="759.4994,-530.9759 656.3797,-530.9759 656.3797,-508.965 759.4994,-508.965 759.4994,-530.9759"/>
<text text-anchor="middle" x="707.9396" y="-516.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRootFinder.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datarootfinder.f90&#45;&gt;sourcefile~rootfinder.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~datarootfinder.f90&#45;&gt;sourcefile~rootfinder.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M726.0032,-508.8192C747.725,-495.4097 784.3704,-472.7873 809.3232,-457.3831"/>
<polygon fill="#ff0000" stroke="#ff0000" points="811.2675,-460.2962 817.9381,-452.0649 807.5903,-454.3397 811.2675,-460.2962"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="741.3084,-255.9759 674.5708,-255.9759 674.5708,-233.965 741.3084,-233.965 741.3084,-255.9759"/>
<text text-anchor="middle" x="707.9396" y="-241.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~rootfinder.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~rootfinder.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M739.668,-256.0723C746.8252,-259.6747 753.9334,-264.2582 759.4695,-269.9704 801.7412,-313.5876 823.0212,-384.5895 831.4381,-419.7947"/>
<polygon fill="#ff0000" stroke="#ff0000" points="828.1022,-420.91 833.7292,-429.887 834.9285,-419.3603 828.1022,-420.91"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-215.9759 -.2403,-215.9759 -.2403,-193.965 130.719,-193.965 130.719,-215.9759"/>
<text text-anchor="middle" x="65.2394" y="-201.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~rootfinder.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~rootfinder.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M551.6558,-637.9704C650.2795,-611.4918 679.8722,-603.9395 759.4695,-539.9704 787.4834,-517.4568 811.2251,-482.6738 824.5094,-460.8964"/>
<polygon fill="#ff0000" stroke="#ff0000" points="827.5987,-462.5491 829.6999,-452.1647 821.5815,-458.9722 827.5987,-462.5491"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datarootfinder.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datarootfinder.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M551.6558,-637.9704C613.755,-626.639 667.9858,-569.6727 693.0956,-539.2284"/>
<polygon fill="#ff0000" stroke="#ff0000" points="696.1255,-541.0454 699.6598,-531.0575 690.6683,-536.6613 696.1255,-541.0454"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M66.4096,-216.2268C72.7761,-275.1557 105.2295,-547.419 166.4788,-599.9704 297.0318,-711.9841 382.4292,-668.8499 551.6558,-637.9704"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M223.8406,-166.9704C271.8187,-157.7859 270.808,-124.2615 317.2024,-108.9704 416.4917,-76.2458 452.8694,-55.7578 551.6558,-89.9704"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M551.6558,-89.9704C620.9691,-113.8629 674.1681,-188.9999 696.4759,-225.1533"/>
<polygon fill="#cbff00" stroke="#cbff00" points="693.5518,-227.0822 701.7057,-233.8471 699.5501,-223.4739 693.5518,-227.0822"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-255.9759 180.0456,-255.9759 180.0456,-233.965 267.6355,-233.965 267.6355,-255.9759"/>
<text text-anchor="middle" x="223.8406" y="-241.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M108.9977,-216.0065C127.9011,-220.774 150.202,-226.3984 170.099,-231.4166"/>
<polygon fill="#0066ff" stroke="#0066ff" points="169.3977,-234.8492 179.95,-233.901 171.1096,-228.0618 169.3977,-234.8492"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="430.8519,-255.9759 333.2524,-255.9759 333.2524,-233.965 430.8519,-233.965 430.8519,-255.9759"/>
<text text-anchor="middle" x="382.0521" y="-241.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M223.8406,-166.9704C270.7036,-157.9994 274.0765,-199.5551 317.2024,-219.9704 324.8008,-223.5675 333.0666,-227.0583 341.0738,-230.2343"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="340.061,-233.5952 350.6503,-233.9382 342.5862,-227.0665 340.061,-233.5952"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.7452,-139.9759 324.3591,-139.9759 324.3591,-117.965 439.7452,-117.965 439.7452,-139.9759"/>
<text text-anchor="middle" x="382.0521" y="-125.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-166.9704C259.7352,-160.0991 299.7569,-150.4677 330.5667,-142.6209"/>
<polygon fill="#ff0000" stroke="#ff0000" points="331.8268,-145.911 340.6428,-140.0348 330.0866,-139.1307 331.8268,-145.911"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="598.2848,-61.9759 505.0268,-61.9759 505.0268,-39.965 598.2848,-39.965 598.2848,-61.9759"/>
<text text-anchor="middle" x="551.6558" y="-47.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M67.87,-193.9469C76.089,-162.1988 104.5254,-70.321 166.4788,-30.9704 247.6677,20.5979 285.9988,-7.0008 382.0521,-11.9704"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M382.0521,-11.9704C426.5545,-13.9956 476.0561,-26.6254 510.0356,-36.9723"/>
<polygon fill="#ffff00" stroke="#ffff00" points="509.0363,-40.3268 519.6247,-39.9573 511.1169,-33.6431 509.0363,-40.3268"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436.3521,-333.9759 327.7521,-333.9759 327.7521,-311.965 436.3521,-311.965 436.3521,-333.9759"/>
<text text-anchor="middle" x="382.0521" y="-319.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-521.9704C293.0339,-551.3159 268.0416,-437.8219 317.2024,-380.9704 330.0076,-366.1621 346.4692,-351.4813 359.6026,-340.5948"/>
<polygon fill="#00ff00" stroke="#00ff00" points="362.1306,-343.0503 367.6807,-334.0254 357.714,-337.6194 362.1306,-343.0503"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M66.1056,-216.0687C70.6853,-265.812 96.9356,-468.149 223.8406,-521.9704"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="620.1645,-217.9759 483.1471,-217.9759 483.1471,-195.965 620.1645,-195.965 620.1645,-217.9759"/>
<text text-anchor="middle" x="551.6558" y="-203.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M382.0521,-205.9704C411.5551,-206.0574 443.9445,-206.2295 472.4415,-206.4067"/>
<polygon fill="#00ffff" stroke="#00ffff" points="472.7297,-209.9085 482.7518,-206.4721 472.7742,-202.9087 472.7297,-209.9085"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-166.9704C294.9701,-153.354 309.6313,-205.7569 382.0521,-205.9704"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="601.2148,-431.9759 502.0967,-431.9759 502.0967,-409.965 601.2148,-409.965 601.2148,-431.9759"/>
<text text-anchor="middle" x="551.6558" y="-417.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M223.8406,-521.9704C269.6405,-541.3946 400.6024,-521.1719 446.9019,-502.9704 482.2292,-489.0824 515.3729,-459.2281 534.5755,-439.6331"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="537.3119,-441.8355 541.6879,-432.1866 532.2499,-437.0006 537.3119,-441.8355"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-61.9759 168.8556,-61.9759 168.8556,-39.965 278.8255,-39.965 278.8255,-61.9759"/>
<text text-anchor="middle" x="223.8406" y="-47.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M76.6456,-193.8951C103.6053,-167.7175 171.4899,-101.8024 204.8032,-69.4555"/>
<polygon fill="#ff0000" stroke="#ff0000" points="207.3736,-71.8382 212.1098,-62.3609 202.4972,-66.8161 207.3736,-71.8382"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="440.5199,-61.9759 323.5844,-61.9759 323.5844,-39.965 440.5199,-39.965 440.5199,-61.9759"/>
<text text-anchor="middle" x="382.0521" y="-47.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M106.7538,-193.9163C138.6185,-185.7016 183.7952,-174.6364 223.8406,-166.9704"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-166.9704C280.7513,-156.0759 268.4276,-107.2521 317.2024,-75.9704 323.0711,-72.2065 329.5944,-68.8681 336.1776,-65.9548"/>
<polygon fill="#00ffff" stroke="#00ffff" points="337.8846,-69.037 345.7966,-61.9908 335.2173,-62.5651 337.8846,-69.037"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="422.3437,-493.9759 341.7606,-493.9759 341.7606,-471.965 422.3437,-471.965 422.3437,-493.9759"/>
<text text-anchor="middle" x="382.0521" y="-479.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-521.9704C245.389,-531.1093 305.1844,-512.1385 344.7783,-497.5793"/>
<polygon fill="#00ffff" stroke="#00ffff" points="346.2321,-500.7725 354.3737,-493.9927 343.7812,-494.2155 346.2321,-500.7725"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="446.7519,-571.9759 317.3523,-571.9759 317.3523,-549.965 446.7519,-549.965 446.7519,-571.9759"/>
<text text-anchor="middle" x="382.0521" y="-557.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M223.8406,-521.9704C250.2834,-533.1851 280.6376,-541.6387 307.6413,-547.7573"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="306.9068,-551.1794 317.4249,-549.9067 308.4089,-544.3424 306.9068,-551.1794"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~rootfinder.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~rootfinder.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M382.0521,-283.9704C457.272,-288.8714 478.3963,-266.2193 551.6558,-283.9704"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M382.0521,-283.9704C459.1369,-288.9929 474.5353,-250.4116 551.6558,-245.9704"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M254.8447,-256.0688C286.3752,-266.5289 336.8847,-281.0276 382.0521,-283.9704"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M232.7669,-233.6815C248.18,-214.8443 281.574,-176.8207 317.2024,-153.9704 323.0711,-150.2065 329.5944,-146.8681 336.1776,-143.9548"/>
<polygon fill="#ff0000" stroke="#ff0000" points="337.8846,-147.037 345.7966,-139.9908 335.2173,-140.5651 337.8846,-147.037"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M240.8607,-233.9538C259.1817,-222.422 289.4404,-204.3091 317.2024,-191.9704 372.6978,-167.3058 401.1006,-188.8494 446.9019,-148.9704 474.1845,-125.2155 455.9619,-100.1134 482.9019,-75.9704 487.04,-72.262 491.7718,-69.0909 496.7734,-66.3818"/>
<polygon fill="#ffff00" stroke="#ffff00" points="498.4748,-69.4482 505.9979,-61.9882 495.4646,-63.1285 498.4748,-69.4482"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M241.6641,-256.1451C260.1459,-267.4785 290.0803,-285.1311 317.2024,-297.9704 324.8008,-301.5675 333.0666,-305.0583 341.0738,-308.2343"/>
<polygon fill="#00ff00" stroke="#00ff00" points="340.061,-311.5952 350.6503,-311.9382 342.5862,-305.0665 340.061,-311.5952"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M251.061,-233.9521C282.1929,-222.3707 334.9503,-205.8316 382.0521,-205.9704"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M231.4283,-256.1985C245.7694,-276.5572 278.8761,-319.6135 317.2024,-342.9704 368.4953,-374.2295 389.9768,-361.797 446.9019,-380.9704 469.7323,-388.6602 494.9686,-398.2625 514.9499,-406.1314"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="513.7172,-409.4076 524.3032,-409.839 516.2968,-402.9002 513.7172,-409.4076"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M235.4093,-233.9544C247.7708,-221.7798 267.4421,-201.2051 281.2024,-180.9704 301.3209,-151.3859 295.4831,-137.4006 317.2024,-108.9704 328.9367,-93.6106 345.144,-79.1139 358.4204,-68.4555"/>
<polygon fill="#00ffff" stroke="#00ffff" points="360.9161,-70.9475 366.6451,-62.0352 356.6087,-65.4296 360.9161,-70.9475"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="446.2726,-452.9759 317.8316,-452.9759 317.8316,-430.965 446.2726,-430.965 446.2726,-452.9759"/>
<text text-anchor="middle" x="382.0521" y="-438.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.6438,-256.3353C234.9017,-287.4414 262.0896,-374.7263 317.2024,-420.9704 319.4546,-422.8603 321.8805,-424.5811 324.425,-426.1478"/>
<polygon fill="#ff0000" stroke="#ff0000" points="322.9751,-429.3399 333.4539,-430.9033 326.2372,-423.1464 322.9751,-429.3399"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="426.5167,-411.9759 337.5875,-411.9759 337.5875,-389.965 426.5167,-389.965 426.5167,-411.9759"/>
<text text-anchor="middle" x="382.0521" y="-397.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M228.953,-256.1188C240.9106,-281.036 273.0692,-341.7341 317.2024,-375.9704 321.9664,-379.6661 327.3413,-382.8715 332.9072,-385.6373"/>
<polygon fill="#7fff00" stroke="#7fff00" points="331.8236,-388.9872 342.3803,-389.8857 334.6881,-382.6001 331.8236,-388.9872"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M225.3919,-256.3015C230.8758,-291.984 252.6237,-403.1423 317.2024,-461.9704 321.63,-466.0037 326.8414,-469.2631 332.3538,-471.8968"/>
<polygon fill="#00ffff" stroke="#00ffff" points="331.2484,-475.2259 341.8295,-475.7648 333.8939,-468.745 331.2484,-475.2259"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~rootfinder.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~rootfinder.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M551.6558,-283.9704C664.2827,-290.4238 774.5135,-382.713 817.2809,-422.7072"/>
<polygon fill="#ff0000" stroke="#ff0000" points="815.0322,-425.3987 824.6917,-429.7513 819.8549,-420.325 815.0322,-425.3987"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M431.1081,-255.9316C465.0146,-263.5859 511.1337,-274.1517 551.6558,-283.9704"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M551.6558,-245.9704C589.6217,-243.7841 632.8606,-243.692 664.2188,-244.0563"/>
<polygon fill="#cbff00" stroke="#cbff00" points="664.3262,-247.558 674.3731,-244.195 664.4218,-240.5587 664.3262,-247.558"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M431.079,-246.901C464.9726,-247.8335 511.0881,-248.3066 551.6558,-245.9704"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M431.1085,-233.9793C450.2742,-229.6852 472.4215,-224.723 492.4629,-220.2327"/>
<polygon fill="#00ffff" stroke="#00ffff" points="493.4232,-223.6044 502.4161,-218.0027 491.8927,-216.7738 493.4232,-223.6044"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M421.7772,-255.9869C430.5913,-259.5619 439.5021,-264.1546 446.9019,-269.9704 493.0783,-306.2631 527.0099,-368.436 542.431,-400.5057"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="539.3681,-402.2181 546.7795,-409.7893 545.7072,-399.2488 539.3681,-402.2181"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M412.6161,-117.8643C454.1755,-103.4629 526.2464,-81.1704 551.6558,-89.9704"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M597.2214,-62.0921C605.5633,-65.5744 613.7304,-70.1025 620.4097,-75.9704 666.9762,-116.881 692.2976,-188.5833 702.505,-223.9817"/>
<polygon fill="#cbff00" stroke="#cbff00" points="699.1603,-225.0189 705.1944,-233.7276 705.9081,-223.1568 699.1603,-225.0189"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M428.0526,-311.9604C491.0421,-296.8841 603.31,-270.0132 664.7777,-255.3011"/>
<polygon fill="#cbff00" stroke="#cbff00" points="665.6433,-258.6928 674.5539,-252.9612 664.0138,-251.8851 665.6433,-258.6928"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M415.3916,-334.0671C425.7233,-337.9675 436.9916,-342.7062 446.9019,-347.9704 477.392,-364.1665 509.5564,-387.6761 530.0719,-403.6052"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="528.0871,-406.4969 538.1122,-409.9244 532.4126,-400.9932 528.0871,-406.4969"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M597.2796,-218.0638C618.4945,-223.2221 643.6014,-229.3268 664.5333,-234.4163"/>
<polygon fill="#cbff00" stroke="#cbff00" points="663.8944,-237.8629 674.4383,-236.8247 665.5483,-231.0611 663.8944,-237.8629"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-590.9759 166.6166,-590.9759 166.6166,-568.965 281.0645,-568.965 281.0645,-590.9759"/>
<text text-anchor="middle" x="223.8406" y="-576.8204" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M382.0521,-599.9704C507.3403,-577.1837 542.7422,-541.8869 620.4097,-440.9704 663.6458,-384.792 690.9563,-303.8829 702.1364,-266.0137"/>
<polygon fill="#cbff00" stroke="#cbff00" points="705.5806,-266.7002 704.9755,-256.1226 698.8523,-264.7688 705.5806,-266.7002"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M382.0521,-599.9704C411.6011,-594.5962 422.7773,-598.8597 446.9019,-580.9704 496.6901,-544.0507 529.5708,-475.8898 543.726,-441.6869"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="547.043,-442.8189 547.5158,-432.2346 540.5457,-440.2138 547.043,-442.8189"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M260.7771,-590.9994C292.952,-599.0935 340.785,-607.4759 382.0521,-599.9704"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M281.4061,-573.0573C289.7886,-572.0506 298.5204,-571.002 307.1841,-569.9615"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="307.7872,-573.4143 317.2985,-568.7469 306.9524,-566.4643 307.7872,-573.4143"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M561.432,-409.9609C587.4008,-380.716 658.3496,-300.8165 691.0384,-264.0039"/>
<polygon fill="#cbff00" stroke="#cbff00" points="693.7398,-266.2328 697.7626,-256.4313 688.5056,-261.5849 693.7398,-266.2328"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M249.1484,-39.8824C280.0154,-27.4991 334.0242,-9.4856 382.0521,-11.9704"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.7313,-50.9704C289.9829,-50.9704 301.9578,-50.9704 313.6177,-50.9704"/>
<polygon fill="#00ffff" stroke="#00ffff" points="313.757,-54.4705 323.757,-50.9704 313.757,-47.4705 313.757,-54.4705"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M440.4201,-50.9704C458.0421,-50.9704 477.3563,-50.9704 494.8734,-50.9704"/>
<polygon fill="#ffff00" stroke="#ffff00" points="494.9532,-54.4705 504.9532,-50.9704 494.9531,-47.4705 494.9532,-54.4705"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M446.6558,-433.9713C461.5637,-432.1255 477.3558,-430.1701 492.0399,-428.352"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="492.5102,-431.8206 502.0043,-427.1182 491.65,-424.8736 492.5102,-431.8206"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M426.6135,-406.2252C446.6092,-408.5831 470.4906,-411.3993 491.9993,-413.9356"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="491.6739,-417.4214 502.015,-415.1167 492.4937,-410.4696 491.6739,-417.4214"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M417.5217,-471.9083C427.0975,-468.8066 437.4291,-465.3546 446.9019,-461.9704 469.8193,-453.7832 495.2458,-443.8522 515.3089,-435.8148"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="516.7232,-439.0184 524.6927,-432.0372 514.1091,-432.5249 516.7232,-439.0184"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~rootfinder.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M419.5469,-549.8973C428.9131,-546.241 438.6359,-541.6251 446.9019,-535.9704 485.8118,-509.3524 520.3647,-465.5641 538.4106,-440.3982"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="541.4018,-442.2291 544.2898,-432.0355 535.6753,-438.2033 541.4018,-442.2291"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilerootfinderf90EfferentGraph = svgPanZoom('#sourcefilerootfinderf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~rootfinder.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilerootfinderf90AfferentGraph" width="641pt" height="65pt"
 viewBox="0.00 0.00 641.00 65.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~rootfinder.f90~~AfferentGraph" class="graph" transform="scale(.3924 .3924) rotate(0) translate(4 162.915)">
<title>sourcefile~~rootfinder.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-162.915 1629.5181,-162.915 1629.5181,4 -4,4"/>
<!-- sourcefile~rootfinder.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~rootfinder.f90</title>
<polygon fill="none" stroke="#000000" points="80.821,-130.9205 .0596,-130.9205 .0596,-108.9096 80.821,-108.9096 80.821,-130.9205"/>
<text text-anchor="middle" x="40.4403" y="-116.765" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">RootFinder.f90</text>
</g>
<!-- sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~hvaccontrollers.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/hvaccontrollers.f90.html" xlink:title="HVACControllers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="225.3995,-130.9205 117.0407,-130.9205 117.0407,-108.9096 225.3995,-108.9096 225.3995,-130.9205"/>
<text text-anchor="middle" x="171.2201" y="-116.765" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACControllers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~rootfinder.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~rootfinder.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M81.103,-119.915C89.1869,-119.915 97.8622,-119.915 106.5214,-119.915"/>
<polygon fill="#ff0000" stroke="#ff0000" points="106.6426,-123.4151 116.6426,-119.915 106.6426,-116.4151 106.6426,-123.4151"/>
</g>
<!-- sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~simairservingzones.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/simairservingzones.f90.html" xlink:title="SimAirServingZones.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="519.3105,-110.9205 393.8834,-110.9205 393.8834,-88.9096 519.3105,-88.9096 519.3105,-110.9205"/>
<text text-anchor="middle" x="456.5969" y="-96.765" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimAirServingZones.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M212.2806,-108.844C227.6216,-105.2333 245.2717,-101.6964 261.5596,-99.915 301.7109,-95.5237 346.7904,-95.2247 383.4879,-96.1578"/>
<polygon fill="#ff0000" stroke="#ff0000" points="383.5079,-99.6597 393.6052,-96.4513 383.7109,-92.6627 383.5079,-99.6597"/>
</g>
<!-- sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~hvacfurnace.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/hvacfurnace.f90.html" xlink:title="HVACFurnace.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="358.2065,-130.9205 261.3433,-130.9205 261.3433,-108.9096 358.2065,-108.9096 358.2065,-130.9205"/>
<text text-anchor="middle" x="309.7749" y="-116.765" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFurnace.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M225.583,-119.915C233.9912,-119.915 242.7072,-119.915 251.2031,-119.915"/>
<polygon fill="#ff0000" stroke="#ff0000" points="251.4216,-123.4151 261.4215,-119.915 251.4215,-116.4151 251.4216,-123.4151"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1493.1007,-121.9205 1373.2902,-121.9205 1373.2902,-99.9096 1493.1007,-99.9096 1493.1007,-121.9205"/>
<text text-anchor="middle" x="1433.1954" y="-107.765" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M216.0481,-130.9605C230.5051,-134.2211 246.6466,-137.5467 261.5596,-139.915 347.5753,-153.5749 369.5033,-158.915 456.5969,-158.915 456.5969,-158.915 456.5969,-158.915 1137.2622,-158.915 1224.1043,-158.915 1323.4534,-138.5258 1382.1182,-124.3246"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1383.0041,-127.7111 1391.8809,-121.9272 1381.3347,-120.9131 1383.0041,-127.7111"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1337.4825,-121.9205 1238.525,-121.9205 1238.525,-99.9096 1337.4825,-99.9096 1337.4825,-121.9205"/>
<text text-anchor="middle" x="1288.0038" y="-107.765" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M519.3158,-106.7621C580.9265,-112.8904 677.6422,-120.915 761.651,-120.915 761.651,-120.915 761.651,-120.915 952.6648,-120.915 1049.0019,-120.915 1160.8376,-116.7406 1227.9294,-113.7859"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1228.4697,-117.2654 1238.3038,-113.323 1228.1577,-110.2723 1228.4697,-117.2654"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="653.8721,-73.9205 555.314,-73.9205 555.314,-51.9096 653.8721,-51.9096 653.8721,-73.9205"/>
<text text-anchor="middle" x="604.593" y="-59.765" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M501.0006,-88.8138C516.5831,-84.9181 534.2618,-80.4983 550.5472,-76.4268"/>
<polygon fill="#ff0000" stroke="#ff0000" points="551.6234,-79.7656 560.4758,-73.9446 549.9255,-72.9746 551.6234,-79.7656"/>
</g>
<!-- sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M358.2568,-113.3108C366.4216,-112.1986 375.0533,-111.0228 383.6759,-109.8483"/>
<polygon fill="#00ff00" stroke="#00ff00" points="384.3294,-113.2917 393.7655,-108.4739 383.3846,-106.3557 384.3294,-113.2917"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1618.9164,-142.9205 1535.4994,-142.9205 1535.4994,-120.9096 1618.9164,-120.9096 1618.9164,-142.9205"/>
<text text-anchor="middle" x="1577.2079" y="-128.765" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1493.0186,-119.6385C1503.6832,-121.1936 1514.715,-122.8023 1525.1413,-124.3226"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1524.9294,-127.8287 1535.3298,-125.8083 1525.9395,-120.9019 1524.9294,-127.8287"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~AfferentGraph_node12"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1625.329,-101.9205 1529.0868,-101.9205 1529.0868,-79.9096 1625.329,-79.9096 1625.329,-101.9205"/>
<text text-anchor="middle" x="1577.2079" y="-87.765" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1493.0186,-102.607C1501.4795,-101.4319 1510.1716,-100.2248 1518.609,-99.053"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1519.3185,-102.4882 1528.742,-97.6458 1518.3555,-95.5547 1519.3185,-102.4882"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1337.5644,-110.915C1345.8308,-110.915 1354.5417,-110.915 1363.2031,-110.915"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1363.3186,-114.4151 1373.3186,-110.915 1363.3185,-107.4151 1363.3186,-114.4151"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1137.2622,-4.915C1207.3247,-12.2648 1219.5564,-37.2498 1288.0038,-53.915"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1288.0038,-53.915C1328.4263,-63.7569 1372.6228,-82.3148 1401.5052,-95.5826"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1400.1427,-98.809 1410.6854,-99.8591 1403.0986,-92.4637 1400.1427,-98.809"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M648.0799,-51.8814C738.9202,-30.2223 955.4678,14.1557 1137.2622,-4.915"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="833.4886,-73.9205 689.8134,-73.9205 689.8134,-51.9096 833.4886,-51.9096 833.4886,-73.9205"/>
<text text-anchor="middle" x="761.651" y="-59.765" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M654.2871,-62.915C662.4259,-62.915 671.0446,-62.915 679.7187,-62.915"/>
<polygon fill="#00ffff" stroke="#00ffff" points="679.9015,-66.4151 689.9014,-62.915 679.9014,-59.4151 679.9015,-66.4151"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M833.4655,-63.6747C845.4387,-63.7748 857.7299,-63.8612 869.3196,-63.915 1017.4046,-64.6027 1054.6787,-72.5321 1202.5144,-63.915 1240.7039,-61.689 1250.6729,-45.5605 1288.0038,-53.915"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1035.8555,-54.9205 869.4741,-54.9205 869.4741,-32.9096 1035.8555,-32.9096 1035.8555,-54.9205"/>
<text text-anchor="middle" x="952.6648" y="-40.765" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M833.3209,-55.7861C841.7667,-54.946 850.4781,-54.0795 859.1673,-53.2151"/>
<polygon fill="#ff0000" stroke="#ff0000" points="859.7359,-56.676 869.3403,-52.2032 859.0429,-49.7103 859.7359,-56.676"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M990.9912,-32.9052C1036.4019,-20.3758 1109.409,-1.9931 1137.2622,-4.915"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~rootfinder.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1202.2675,-54.9205 1072.2569,-54.9205 1072.2569,-32.9096 1202.2675,-32.9096 1202.2675,-54.9205"/>
<text text-anchor="middle" x="1137.2622" y="-40.765" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1036.0524,-43.915C1044.774,-43.915 1053.6028,-43.915 1062.2232,-43.915"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1062.2283,-47.4151 1072.2282,-43.915 1062.2282,-40.4151 1062.2283,-47.4151"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1202.4376,-43.8744C1229.2135,-44.9823 1260.3614,-47.7287 1288.0038,-53.915"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~rootfinder.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1162.1541,-54.9787C1187.1384,-66.0834 1225.8184,-83.2755 1253.7024,-95.6691"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1252.5153,-98.9716 1263.0749,-99.8349 1255.3584,-92.575 1252.5153,-98.9716"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilerootfinderf90AfferentGraph = svgPanZoom('#sourcefilerootfinderf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/rootfinder.html">RootFinder</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/rootfinder.f90.html#src">RootFinder.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">RootFinder</span>
<a name="ln-2"></a>  <span class="c">! Module containing the derivative-free, root finder routines for smooth,</span>
<a name="ln-3"></a>  <span class="c">! &quot;mostly&quot; monotonic functions in one variable.</span>
<a name="ln-4"></a>  <span class="c">!</span>
<a name="ln-5"></a>  <span class="c">! The algorithm is guaranteed to find the root if:</span>
<a name="ln-6"></a>  <span class="c">! - it is bracketed between min/max bounds</span>
<a name="ln-7"></a>  <span class="c">! - there is an odd number of roots between the min/max bounds</span>
<a name="ln-8"></a>  <span class="c">!</span>
<a name="ln-9"></a>  <span class="c">! Note that there is an even number of roots between the min/max bounds then it is possible</span>
<a name="ln-10"></a>  <span class="c">! that the algorithm will terminate with a min or max constrained solution instead of the</span>
<a name="ln-11"></a>  <span class="c">! actual root.</span>
<a name="ln-12"></a>  <span class="c">!</span>
<a name="ln-13"></a>
<a name="ln-14"></a>  <span class="c">! MODULE INFORMATION:</span>
<a name="ln-15"></a>  <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-16"></a>  <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-17"></a>  <span class="c">!       MODIFIED       na</span>
<a name="ln-18"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-19"></a>
<a name="ln-20"></a>  <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-21"></a>  <span class="c">! To encapsulate the data and algorithms required to</span>
<a name="ln-22"></a>  <span class="c">! find the root of a 1-dimensional function F(X) = Y .</span>
<a name="ln-23"></a>  <span class="c">!</span>
<a name="ln-24"></a>  <span class="c">! At any moment during the solution process, the following condition is satisfied:</span>
<a name="ln-25"></a>  <span class="c">! - For an overall increasing function F(X):</span>
<a name="ln-26"></a>  <span class="c">!  MinPoint%X &lt;= LowerPoint%X &lt;= CurrentPoint%X &lt;= UpperPoint%X &lt;= MaxPoint%X</span>
<a name="ln-27"></a>  <span class="c">!  MinPoint%Y &lt;= LowerPoint%Y &lt;= CurrentPoint%Y &lt;= UpperPoint%Y &lt;= MaxPoint%Y</span>
<a name="ln-28"></a>  <span class="c">! - For an overall decreasing function F(X):</span>
<a name="ln-29"></a>  <span class="c">!  MinPoint%X &lt;= LowerPoint%X &lt;= CurrentPoint%X &lt;= UpperPoint%X &lt;= MaxPoint%X</span>
<a name="ln-30"></a>  <span class="c">!  MinPoint%Y &gt;= LowerPoint%Y &gt;= CurrentPoint%Y &gt;= UpperPoint%Y &gt;= MaxPoint%Y</span>
<a name="ln-31"></a>  <span class="c">!</span>
<a name="ln-32"></a>  <span class="c">! Requirements for function F():</span>
<a name="ln-33"></a>  <span class="c">! - smooth, continuous, deterministic function</span>
<a name="ln-34"></a>  <span class="c">! - root XRoot bracketed within the min and max bounds, referred to as XMin, XMax</span>
<a name="ln-35"></a>  <span class="c">! - XMin and XMax must remain constant during iterations</span>
<a name="ln-36"></a>  <span class="c">! - If F(X) is increasing, set action to iSlopeIncreasing</span>
<a name="ln-37"></a>  <span class="c">!   This implies that if X1 &lt; X2, then F(X1) &lt; F(X2) must be satisfied.</span>
<a name="ln-38"></a>  <span class="c">! - If F(X) is decreasing, set action to iSlopeDecreasing</span>
<a name="ln-39"></a>  <span class="c">!   This implies that if X1 &lt; X2, then F(X1) &gt; F(X2) must be satisfied.</span>
<a name="ln-40"></a>  <span class="c">!</span>
<a name="ln-41"></a>  <span class="c">! Note that the residual function is allowed to be non-monotonic between the min and max</span>
<a name="ln-42"></a>  <span class="c">! points as long as the slope specification is satisfied at the min and max points.</span>
<a name="ln-43"></a>  <span class="c">!</span>
<a name="ln-44"></a>  <span class="c">! Unconstrained convergence conditions:</span>
<a name="ln-45"></a>  <span class="c">! - ABS(F(XRoot)) &lt;= ATolY</span>
<a name="ln-46"></a>  <span class="c">! - ABS(X2-X1)    &lt;= TolX * (ABS(X2)+ABS(X1))/2 + ATolX</span>
<a name="ln-47"></a>  <span class="c">!</span>
<a name="ln-48"></a>  <span class="c">! Constrained convergence conditions:</span>
<a name="ln-49"></a>  <span class="c">! For iSlopeIncreasing action:</span>
<a name="ln-50"></a>  <span class="c">!   - YMin &gt;= 0</span>
<a name="ln-51"></a>  <span class="c">!   - YMax &lt;= 0</span>
<a name="ln-52"></a>  <span class="c">! For iSlopeDecreasing action:</span>
<a name="ln-53"></a>  <span class="c">!   - YMin &lt;= 0</span>
<a name="ln-54"></a>  <span class="c">!   - YMax &gt;= 0</span>
<a name="ln-55"></a>
<a name="ln-56"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-57"></a>  <span class="c">! Implements an hybrid solution method consisting of:</span>
<a name="ln-58"></a>  <span class="c">! - bisection method (aka interval halving)</span>
<a name="ln-59"></a>  <span class="c">! - false position method (aka regula falsi)</span>
<a name="ln-60"></a>  <span class="c">! - secant method</span>
<a name="ln-61"></a>  <span class="c">! - Brent&#39;s method (inverse quadratic interpolation)</span>
<a name="ln-62"></a>  <span class="c">!</span>
<a name="ln-63"></a>  <span class="c">! with safeguards against:</span>
<a name="ln-64"></a>  <span class="c">! - out-of-range error</span>
<a name="ln-65"></a>  <span class="c">! - singularity (i.e., locally singular Jacobian)</span>
<a name="ln-66"></a>  <span class="c">! - bad slope</span>
<a name="ln-67"></a>  <span class="c">! - round-off error</span>
<a name="ln-68"></a>  <span class="c">!</span>
<a name="ln-69"></a>  <span class="c">! Typical usage of the root finder, assuming that :</span>
<a name="ln-70"></a>  <span class="c">! - the function is called MyFunc()</span>
<a name="ln-71"></a>  <span class="c">! - the function is strictly increasing between the min and max bounds</span>
<a name="ln-72"></a>  <span class="c">! - the root is bracketed between XMin=0 and XMax=1</span>
<a name="ln-73"></a>  <span class="c">! - the function is defined with the prototype real FUNCTION MyFunc( X )</span>
<a name="ln-74"></a>  <span class="c">! - the solution method to use is the Brent&#39;s method</span>
<a name="ln-75"></a>  <span class="c">! - the absolute tolerance for Y=MyFunc(X) is ATolY=1.0E-4</span>
<a name="ln-76"></a>  <span class="c">! As a safeguard the iterative process stops after 50 iterations if the root has not been</span>
<a name="ln-77"></a>  <span class="c">! located within the specified tolerance yet.</span>
<a name="ln-78"></a>  <span class="c">!</span>
<a name="ln-79"></a>  <span class="c">! &lt;BEGIN CODE SNIPPET&gt;</span>
<a name="ln-80"></a>  <span class="c">!</span>
<a name="ln-81"></a>  <span class="c">! TYPE(RootFinderDataType)  :: RF</span>
<a name="ln-82"></a>  <span class="c">! INTEGER                   :: IterationCount</span>
<a name="ln-83"></a>  <span class="c">! REAL(r64)                 :: X, Y</span>
<a name="ln-84"></a>  <span class="c">! LOGICAL                   :: IsDoneFlag</span>
<a name="ln-85"></a>  <span class="c">!</span>
<a name="ln-86"></a>  <span class="c">! CALL SetupRootFinder(   &amp;</span>
<a name="ln-87"></a>  <span class="c">!   RF,                   &amp; ! RootFinderData</span>
<a name="ln-88"></a>  <span class="c">!   iSlopeIncreasing,     &amp; ! SlopeType</span>
<a name="ln-89"></a>  <span class="c">!   iMethodBrent,         &amp; ! MethodType</span>
<a name="ln-90"></a>  <span class="c">!   1.0d-6,               &amp; ! TolX</span>
<a name="ln-91"></a>  <span class="c">!   1.0d-6,               &amp; ! ATolX</span>
<a name="ln-92"></a>  <span class="c">!   1.0d-4                &amp; ! ATolY</span>
<a name="ln-93"></a>  <span class="c">! )</span>
<a name="ln-94"></a>  <span class="c">! CALL InitializeRootFinder(   &amp;</span>
<a name="ln-95"></a>  <span class="c">!   RF,                   &amp; ! RootFinderData</span>
<a name="ln-96"></a>  <span class="c">!   0.0d0,                &amp; ! XMin</span>
<a name="ln-97"></a>  <span class="c">!   1.0d0                 &amp; ! XMax</span>
<a name="ln-98"></a>  <span class="c">! )</span>
<a name="ln-99"></a>  <span class="c">!</span>
<a name="ln-100"></a>  <span class="c">! IterationCount = 0</span>
<a name="ln-101"></a>  <span class="c">! IsDoneFlag = .FALSE.</span>
<a name="ln-102"></a>  <span class="c">! RF%XCandidate = 0.1d0 ! Sets X to initial value XInit</span>
<a name="ln-103"></a>  <span class="c">!</span>
<a name="ln-104"></a>  <span class="c">! DO WHILE ( .NOT.IsDoneFlag  )</span>
<a name="ln-105"></a>  <span class="c">!   IterationCount = IterationCount+1</span>
<a name="ln-106"></a>  <span class="c">!</span>
<a name="ln-107"></a>  <span class="c">!   IF ( IterationCount&gt;50 ) THEN</span>
<a name="ln-108"></a>  <span class="c">!     WRITE(*,*) &#39;Error: Too many iterations...&quot;</span>
<a name="ln-109"></a>  <span class="c">!     EXIT</span>
<a name="ln-110"></a>  <span class="c">!   END IF</span>
<a name="ln-111"></a>  <span class="c">!</span>
<a name="ln-112"></a>  <span class="c">!   ! Evaluate function with new root candidate</span>
<a name="ln-113"></a>  <span class="c">!   X = RF%XCandidate</span>
<a name="ln-114"></a>  <span class="c">!   Y = MyFunc( X )</span>
<a name="ln-115"></a>  <span class="c">!</span>
<a name="ln-116"></a>  <span class="c">!   ! Update root finder data with new iterate</span>
<a name="ln-117"></a>  <span class="c">!   CALL IterateRootFinder( RF, X, Y, IsDoneFlag )</span>
<a name="ln-118"></a>  <span class="c">! END DO</span>
<a name="ln-119"></a>  <span class="c">!</span>
<a name="ln-120"></a>  <span class="c">! ! Write root finder status description to standard output</span>
<a name="ln-121"></a>  <span class="c">! CALL WriteRootFinderStatus( 6, RF )</span>
<a name="ln-122"></a>  <span class="c">! &lt;END CODE SNIPPET&gt;</span>
<a name="ln-123"></a>  <span class="c">!</span>
<a name="ln-124"></a>
<a name="ln-125"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-126"></a>  <span class="c">! &quot;Numerical Recipes in FORTRAN&quot;, Chapter 9 &quot;Root Finding and Nonlinear Sets of Equations&quot;, pp.340-352</span>
<a name="ln-127"></a>  <span class="c">! Used for formulas, but not for code.</span>
<a name="ln-128"></a>  <span class="c">!</span>
<a name="ln-129"></a>
<a name="ln-130"></a>  <span class="c">! OTHER NOTES:</span>
<a name="ln-131"></a>  <span class="c">! na</span>
<a name="ln-132"></a>
<a name="ln-133"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-134"></a>  <span class="c">! Use statements for data only modules</span>
<a name="ln-135"></a>  <span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-136"></a>  <span class="k">USE </span><span class="n">DataRootFinder</span>
<a name="ln-137"></a>  <span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-138"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>        <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-139"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-140"></a>
<a name="ln-141"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-142"></a>
<a name="ln-143"></a><span class="k">PUBLIC</span>
<a name="ln-144"></a>
<a name="ln-145"></a>  <span class="c">! MODULE PARAMETER DEFINITIONS</span>
<a name="ln-146"></a>  <span class="c">! na</span>
<a name="ln-147"></a>
<a name="ln-148"></a>  <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-149"></a>  <span class="c">! na</span>
<a name="ln-150"></a>
<a name="ln-151"></a>  <span class="c">!MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-152"></a>  <span class="c">! na</span>
<a name="ln-153"></a>
<a name="ln-154"></a>  <span class="c">! SUBROUTINE SPECIFICATIONS FOR THE MODULE</span>
<a name="ln-155"></a>  <span class="k">PUBLIC  </span><span class="n">SetupRootFinder</span>
<a name="ln-156"></a>  <span class="k">PUBLIC  </span><span class="n">InitializeRootFinder</span>
<a name="ln-157"></a>  <span class="k">PUBLIC  </span><span class="n">IterateRootFinder</span>
<a name="ln-158"></a>
<a name="ln-159"></a>  <span class="k">PUBLIC  </span><span class="n">WriteRootFinderTraceHeader</span>
<a name="ln-160"></a>  <span class="k">PUBLIC  </span><span class="n">WriteRootFinderTrace</span>
<a name="ln-161"></a>  <span class="k">PUBLIC  </span><span class="n">WriteRootFinderStatus</span>
<a name="ln-162"></a>
<a name="ln-163"></a>  <span class="k">PUBLIC  </span><span class="n">CheckRootFinderConvergence</span>   <span class="c">! ABS(Y) &lt;= Controls%ATolY</span>
<a name="ln-164"></a>  <span class="k">PUBLIC  </span><span class="n">CheckRootFinderCandidate</span>     <span class="c">! CheckMinMaxRange(X) .AND. CheckLowerUpperBracket(X)</span>
<a name="ln-165"></a>
<a name="ln-166"></a>  <span class="k">PRIVATE </span><span class="n">ResetRootFinder</span>
<a name="ln-167"></a>  <span class="k">PRIVATE </span><span class="n">UpdateRootFinder</span>
<a name="ln-168"></a>  <span class="k">PRIVATE </span><span class="n">AdvanceRootFinder</span>
<a name="ln-169"></a>
<a name="ln-170"></a>  <span class="k">PRIVATE </span><span class="n">CheckMinMaxRange</span>             <span class="c">! MinPoint%X &lt;= X &lt;= MaxPoint%X</span>
<a name="ln-171"></a>  <span class="k">PRIVATE </span><span class="n">CheckLowerUpperBracket</span>       <span class="c">! LowerPoint%X &lt; X &lt; UpperPoint%X</span>
<a name="ln-172"></a>  <span class="k">PRIVATE </span><span class="n">CheckInternalConsistency</span>     <span class="c">! For debugging only</span>
<a name="ln-173"></a>  <span class="k">PRIVATE </span><span class="n">CheckSlope</span>                   <span class="c">! For an increasing function, MinPoint%Y &lt; MaxPoint%Y;</span>
<a name="ln-174"></a>                                       <span class="c">! For a decreasing function,  MinPoint%Y &gt; MaxPoint%Y</span>
<a name="ln-175"></a>  <span class="k">PRIVATE </span><span class="n">CheckNonSingularity</span>          <span class="c">! MinPoint%Y == MaxPoint%Y</span>
<a name="ln-176"></a>  <span class="k">PRIVATE </span><span class="n">CheckMinConstraint</span>
<a name="ln-177"></a>  <span class="k">PRIVATE </span><span class="n">CheckMaxConstraint</span>
<a name="ln-178"></a>  <span class="k">PRIVATE </span><span class="n">CheckIncrementRoundOff</span>
<a name="ln-179"></a>  <span class="k">PRIVATE </span><span class="n">CheckBracketRoundOff</span>
<a name="ln-180"></a>
<a name="ln-181"></a>  <span class="k">PRIVATE </span><span class="n">UpdateMinMax</span>
<a name="ln-182"></a>  <span class="k">PRIVATE </span><span class="n">UpdateBracket</span>
<a name="ln-183"></a>  <span class="k">PRIVATE </span><span class="n">UpdateHistory</span>
<a name="ln-184"></a>  <span class="k">PRIVATE </span><span class="n">SortHistory</span>
<a name="ln-185"></a>
<a name="ln-186"></a>  <span class="k">PRIVATE </span><span class="n">WritePoint</span>
<a name="ln-187"></a>  <span class="k">PUBLIC  </span><span class="n">DebugRootFinder</span>
<a name="ln-188"></a>
<a name="ln-189"></a>  <span class="k">PRIVATE </span><span class="n">BracketRoot</span>
<a name="ln-190"></a>  <span class="k">PRIVATE </span><span class="n">BisectionMethod</span>
<a name="ln-191"></a>  <span class="k">PRIVATE </span><span class="n">FalsePositionMethod</span>
<a name="ln-192"></a>  <span class="k">PRIVATE </span><span class="n">SecantMethod</span>
<a name="ln-193"></a>  <span class="k">PRIVATE </span><span class="n">SecantFormula</span>
<a name="ln-194"></a>  <span class="k">PRIVATE </span><span class="n">BrentMethod</span>
<a name="ln-195"></a>
<a name="ln-196"></a><span class="k">CONTAINS</span>
<a name="ln-197"></a>
<a name="ln-198"></a><span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-199"></a><span class="c">!*************************************************************************</span>
<a name="ln-200"></a>
<a name="ln-201"></a><span class="k">SUBROUTINE </span><span class="n">SetupRootFinder</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">SlopeType</span><span class="p">,</span> <span class="n">MethodType</span><span class="p">,</span> <span class="n">TolX</span><span class="p">,</span> <span class="n">ATolX</span><span class="p">,</span> <span class="n">ATolY</span> <span class="p">)</span>
<a name="ln-202"></a>
<a name="ln-203"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-204"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-205"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-206"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-207"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-208"></a>
<a name="ln-209"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-210"></a>          <span class="c">! This subroutine loads the numerical controls for the root finder.</span>
<a name="ln-211"></a>
<a name="ln-212"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-213"></a>          <span class="c">! na</span>
<a name="ln-214"></a>
<a name="ln-215"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-216"></a>          <span class="c">! na</span>
<a name="ln-217"></a>
<a name="ln-218"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-219"></a>          <span class="c">! na</span>
<a name="ln-220"></a>
<a name="ln-221"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-222"></a>
<a name="ln-223"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-224"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RootFinderData</span>     <span class="c">! Data used by root finding algorithm</span>
<a name="ln-225"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">SlopeType</span>          <span class="c">! Either iSlopeIncreasing or iSlopeDecreasing</span>
<a name="ln-226"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">MethodType</span>         <span class="c">! Any of the iMethod&lt;name&gt; code but iMethodNone</span>
<a name="ln-227"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">TolX</span>               <span class="c">! Relative tolerance for X variables</span>
<a name="ln-228"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">ATolX</span>              <span class="c">! Absolute tolerance for X variables</span>
<a name="ln-229"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">ATolY</span>              <span class="c">! Absolute tolerance for Y variables</span>
<a name="ln-230"></a>
<a name="ln-231"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-232"></a>          <span class="c">! na</span>
<a name="ln-233"></a>
<a name="ln-234"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-235"></a>          <span class="c">! na</span>
<a name="ln-236"></a>
<a name="ln-237"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-238"></a>          <span class="c">! na</span>
<a name="ln-239"></a>
<a name="ln-240"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-241"></a>          <span class="c">! na</span>
<a name="ln-242"></a>
<a name="ln-243"></a>          <span class="c">! FLOW:</span>
<a name="ln-244"></a>
<a name="ln-245"></a>  <span class="c">! Load assumed action for underlying function F(X)</span>
<a name="ln-246"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">SlopeType</span> <span class="o">/=</span> <span class="n">iSlopeIncreasing</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SlopeType</span> <span class="o">/=</span> <span class="n">iSlopeDecreasing</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-247"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;SetupRootFinder: Invalid function slope specification. Valid choices are:&#39;</span> <span class="p">)</span>
<a name="ln-248"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;SetupRootFinder: iSlopeIncreasing=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iSlopeIncreasing</span><span class="p">)))</span>
<a name="ln-249"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;SetupRootFinder: iSlopeDecreasing=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iSlopeDecreasing</span><span class="p">)))</span>
<a name="ln-250"></a>    <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SetupRootFinder: Preceding error causes program termination.&#39;</span><span class="p">)</span>
<a name="ln-251"></a>  <span class="k">END IF</span>
<a name="ln-252"></a><span class="k">  </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">SlopeType</span> <span class="o">=</span> <span class="n">SlopeType</span>
<a name="ln-253"></a>
<a name="ln-254"></a>  <span class="c">! Load solution method</span>
<a name="ln-255"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">MethodType</span> <span class="o">/=</span> <span class="n">iMethodBisection</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>     <span class="p">&amp;</span>
<a name="ln-256"></a>       <span class="n">MethodType</span> <span class="o">/=</span> <span class="n">iMethodFalsePosition</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-257"></a>       <span class="n">MethodType</span> <span class="o">/=</span> <span class="n">iMethodSecant</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>        <span class="p">&amp;</span>
<a name="ln-258"></a>       <span class="n">MethodType</span> <span class="o">/=</span> <span class="n">iMethodBrent</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-259"></a>
<a name="ln-260"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;SetupRootFinder: Invalid solution method specification. Valid choices are:&#39;</span> <span class="p">)</span>
<a name="ln-261"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;SetupRootFinder: iMethodBisection=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iMethodBisection</span><span class="p">)))</span>
<a name="ln-262"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;SetupRootFinder: iMethodFalsePosition=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iMethodFalsePosition</span><span class="p">)))</span>
<a name="ln-263"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;SetupRootFinder: iMethodSecant=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iMethodSecant</span><span class="p">)))</span>
<a name="ln-264"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;SetupRootFinder: iMethodBrent=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iMethodBrent</span><span class="p">)))</span>
<a name="ln-265"></a>    <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SetupRootFinder: Preceding error causes program termination.&#39;</span><span class="p">)</span>
<a name="ln-266"></a>
<a name="ln-267"></a>  <span class="k">END IF</span>
<a name="ln-268"></a><span class="k">  </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">MethodType</span> <span class="o">=</span> <span class="n">MethodType</span>
<a name="ln-269"></a>
<a name="ln-270"></a>  <span class="c">! Load relative tolerance parameter for X variables</span>
<a name="ln-271"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">TolX</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-272"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SetupRootFinder: Invalid tolerance specification for X variables. TolX &gt;= 0&#39;</span><span class="p">)</span>
<a name="ln-273"></a>  <span class="k">END IF</span>
<a name="ln-274"></a><span class="k">  </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">TolX</span> <span class="o">=</span> <span class="n">TolX</span>
<a name="ln-275"></a>
<a name="ln-276"></a>  <span class="c">! Load absolute tolerance parameter for X variables</span>
<a name="ln-277"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">ATolX</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-278"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SetupRootFinder: Invalid absolute tolerance specification for X variables. ATolX &gt;= 0&#39;</span><span class="p">)</span>
<a name="ln-279"></a>  <span class="k">END IF</span>
<a name="ln-280"></a><span class="k">  </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">ATolX</span> <span class="o">=</span> <span class="n">ATolX</span>
<a name="ln-281"></a>
<a name="ln-282"></a>  <span class="c">! Load absolute tolerance parameter for Y variables</span>
<a name="ln-283"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">ATolY</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-284"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SetupRootFinder: Invalid absolute tolerance specification for Y variables. ATolY &gt;= 0&#39;</span><span class="p">)</span>
<a name="ln-285"></a>  <span class="k">END IF</span>
<a name="ln-286"></a><span class="k">  </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">ATolY</span> <span class="o">=</span> <span class="n">ATolY</span>
<a name="ln-287"></a>
<a name="ln-288"></a>  <span class="c">! Reset internal data for root finder with fictive min and max values</span>
<a name="ln-289"></a>  <span class="k">CALL </span><span class="n">ResetRootFinder</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">constant_zero</span><span class="p">,</span> <span class="n">constant_zero</span> <span class="p">)</span>
<a name="ln-290"></a>
<a name="ln-291"></a>  <span class="k">RETURN</span>
<a name="ln-292"></a>
<a name="ln-293"></a><span class="k">END SUBROUTINE </span><span class="n">SetupRootFinder</span>
<a name="ln-294"></a>
<a name="ln-295"></a>
<a name="ln-296"></a><span class="k">SUBROUTINE </span><span class="n">ResetRootFinder</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">XMin</span><span class="p">,</span> <span class="n">XMax</span> <span class="p">)</span>
<a name="ln-297"></a>
<a name="ln-298"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-299"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-300"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-301"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-302"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-303"></a>
<a name="ln-304"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-305"></a>          <span class="c">! This subroutine initializes the data for the root finder.</span>
<a name="ln-306"></a>
<a name="ln-307"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-308"></a>          <span class="c">! na</span>
<a name="ln-309"></a>
<a name="ln-310"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-311"></a>          <span class="c">! na</span>
<a name="ln-312"></a>
<a name="ln-313"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-314"></a>          <span class="c">! na</span>
<a name="ln-315"></a>
<a name="ln-316"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-317"></a>
<a name="ln-318"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-319"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-320"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">XMin</span>           <span class="c">! Minimum X value allowed</span>
<a name="ln-321"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">XMax</span>           <span class="c">! Maximum X value allowed</span>
<a name="ln-322"></a>
<a name="ln-323"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-324"></a>          <span class="c">! na</span>
<a name="ln-325"></a>
<a name="ln-326"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-327"></a>          <span class="c">! na</span>
<a name="ln-328"></a>
<a name="ln-329"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-330"></a>          <span class="c">! na</span>
<a name="ln-331"></a>
<a name="ln-332"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-333"></a>          <span class="c">! na</span>
<a name="ln-334"></a>
<a name="ln-335"></a>          <span class="c">! FLOW:</span>
<a name="ln-336"></a>
<a name="ln-337"></a>  <span class="c">! Reset min point</span>
<a name="ln-338"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">X</span>           <span class="o">=</span> <span class="n">XMin</span>
<a name="ln-339"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">Y</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-340"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-341"></a>
<a name="ln-342"></a>  <span class="c">! Reset max point</span>
<a name="ln-343"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">X</span>           <span class="o">=</span> <span class="n">XMax</span>
<a name="ln-344"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">Y</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-345"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-346"></a>
<a name="ln-347"></a>  <span class="c">! Reset lower point</span>
<a name="ln-348"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-349"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">Y</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-350"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-351"></a>
<a name="ln-352"></a>  <span class="c">! Reset upper point</span>
<a name="ln-353"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">X</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-354"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">Y</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-355"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-356"></a>
<a name="ln-357"></a>  <span class="c">! Reset previous point</span>
<a name="ln-358"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentPoint</span><span class="p">%</span><span class="n">X</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-359"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentPoint</span><span class="p">%</span><span class="n">Y</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-360"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-361"></a>
<a name="ln-362"></a>  <span class="c">! Reset iterate history with last 3 best points</span>
<a name="ln-363"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">NumHistory</span>             <span class="o">=</span> <span class="mi">0</span>
<a name="ln-364"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(:)%</span><span class="n">X</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-365"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(:)%</span><span class="n">Y</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-366"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(:)%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-367"></a>
<a name="ln-368"></a>  <span class="c">! Reset increments over successive iterationes</span>
<a name="ln-369"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Increment</span><span class="p">%</span><span class="n">X</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-370"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Increment</span><span class="p">%</span><span class="n">Y</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-371"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Increment</span><span class="p">%</span><span class="n">DefinedFlag</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-372"></a>
<a name="ln-373"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-374"></a>
<a name="ln-375"></a>  <span class="c">! Reset default state</span>
<a name="ln-376"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusNone</span>
<a name="ln-377"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentMethodType</span> <span class="o">=</span> <span class="n">iMethodNone</span>
<a name="ln-378"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">ConvergenceRate</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0d0</span>
<a name="ln-379"></a>
<a name="ln-380"></a>  <span class="k">RETURN</span>
<a name="ln-381"></a>
<a name="ln-382"></a><span class="k">END SUBROUTINE </span><span class="n">ResetRootFinder</span>
<a name="ln-383"></a>
<a name="ln-384"></a>
<a name="ln-385"></a><span class="k">SUBROUTINE </span><span class="n">InitializeRootFinder</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">XMin</span><span class="p">,</span> <span class="n">XMax</span> <span class="p">)</span>
<a name="ln-386"></a>
<a name="ln-387"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-388"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-389"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-390"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-391"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-392"></a>
<a name="ln-393"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-394"></a>          <span class="c">! This subroutine initializes the min and max for the root finder before</span>
<a name="ln-395"></a>          <span class="c">! finding a new root.</span>
<a name="ln-396"></a>
<a name="ln-397"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-398"></a>          <span class="c">! na</span>
<a name="ln-399"></a>
<a name="ln-400"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-401"></a>          <span class="c">! na</span>
<a name="ln-402"></a>
<a name="ln-403"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-404"></a>          <span class="c">! na</span>
<a name="ln-405"></a>
<a name="ln-406"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-407"></a>
<a name="ln-408"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-409"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-410"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">XMin</span>           <span class="c">! Minimum X value allowed</span>
<a name="ln-411"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">XMax</span>           <span class="c">! Maximum X value allowed</span>
<a name="ln-412"></a>
<a name="ln-413"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-414"></a>          <span class="c">! na</span>
<a name="ln-415"></a>
<a name="ln-416"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-417"></a>          <span class="c">! na</span>
<a name="ln-418"></a>
<a name="ln-419"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-420"></a>          <span class="c">! na</span>
<a name="ln-421"></a>
<a name="ln-422"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-423"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">SavedXCandidate</span>
<a name="ln-424"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">XMinReset</span>
<a name="ln-425"></a>          <span class="c">! FLOW:</span>
<a name="ln-426"></a>  <span class="n">XMinReset</span> <span class="o">=</span> <span class="n">XMin</span>
<a name="ln-427"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">XMin</span> <span class="o">&gt;</span> <span class="n">XMax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-428"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">XMax</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-429"></a><span class="k">      </span><span class="n">XMinReset</span> <span class="o">=</span> <span class="n">XMax</span>
<a name="ln-430"></a>    <span class="k">ELSE</span>
<a name="ln-431"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-432"></a>        <span class="s1">&#39;InitializeRootFinder: Invalid min/max bounds &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-433"></a>        <span class="s1">&#39;XMin=&#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">XMin</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be smaller than &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-434"></a>        <span class="s1">&#39;XMax=&#39;</span><span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">XMax</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-435"></a>      <span class="p">)</span>
<a name="ln-436"></a>    <span class="k">END IF</span>
<a name="ln-437"></a><span class="k">  END IF</span>
<a name="ln-438"></a>
<a name="ln-439"></a>  <span class="c">! First save current candidate value before it is overriden in ResetRootFinder()</span>
<a name="ln-440"></a>  <span class="n">SavedXCandidate</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span>
<a name="ln-441"></a>
<a name="ln-442"></a>  <span class="c">! Reset internal data for root finder with actual min and max values</span>
<a name="ln-443"></a>  <span class="c">!</span>
<a name="ln-444"></a>  <span class="c">! NOTE: This resets the value of RootFinderData%XCandidate to zero</span>
<a name="ln-445"></a>  <span class="k">CALL </span><span class="n">ResetRootFinder</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">XMinReset</span><span class="p">,</span> <span class="n">XMax</span> <span class="p">)</span>
<a name="ln-446"></a>
<a name="ln-447"></a>  <span class="c">! Enforce min/max constraints on previous candidate if available</span>
<a name="ln-448"></a>  <span class="c">!</span>
<a name="ln-449"></a>  <span class="c">! NOTE: If XMin == XMax then this forces the value of XCandidateto the desired solution</span>
<a name="ln-450"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-451"></a>                                    <span class="nb">MAX</span><span class="p">(</span> <span class="n">SavedXCandidate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-452"></a>                                         <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">X</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-453"></a>
<a name="ln-454"></a>  <span class="k">RETURN</span>
<a name="ln-455"></a>
<a name="ln-456"></a><span class="k">END SUBROUTINE </span><span class="n">InitializeRootFinder</span>
<a name="ln-457"></a>
<a name="ln-458"></a>
<a name="ln-459"></a><span class="k">SUBROUTINE </span><span class="n">IterateRootFinder</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">IsDoneFlag</span> <span class="p">)</span>
<a name="ln-460"></a>
<a name="ln-461"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-462"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-463"></a>          <span class="c">!       DATE WRITTEN   March 2006</span>
<a name="ln-464"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-465"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-466"></a>
<a name="ln-467"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-468"></a>          <span class="c">! This subroutine is the workhorse of the root finder framework.</span>
<a name="ln-469"></a>          <span class="c">! It should be invoked with every new candidate (X,Y) until</span>
<a name="ln-470"></a>          <span class="c">! convergence is achieved or abnormal termination is detected.</span>
<a name="ln-471"></a>          <span class="c">!</span>
<a name="ln-472"></a>          <span class="c">! The subroutine performs the following tasks:</span>
<a name="ln-473"></a>          <span class="c">! - it checks for convergence</span>
<a name="ln-474"></a>          <span class="c">! - it updates the internal data with the current iterate (X,Y)</span>
<a name="ln-475"></a>          <span class="c">! - it computes a new root candidate if not converged yet.</span>
<a name="ln-476"></a>          <span class="c">!</span>
<a name="ln-477"></a>          <span class="c">! Sets IsDoneFlag to FALSE when iteration should continue with the new candidate value.</span>
<a name="ln-478"></a>          <span class="c">! Sets IsDoneFlag to TRUE  when iteration should be stopped because convergence has been achieved</span>
<a name="ln-479"></a>          <span class="c">! or because of a fatal error.</span>
<a name="ln-480"></a>          <span class="c">!</span>
<a name="ln-481"></a>          <span class="c">! Note that only upon normal termination (iStatusOK&lt;...&gt; codes)</span>
<a name="ln-482"></a>          <span class="c">! will the XCandidate value contain the root.</span>
<a name="ln-483"></a>          <span class="c">! If the root has not been located yet the XCandidate value contains</span>
<a name="ln-484"></a>          <span class="c">! the next candidate root to try.</span>
<a name="ln-485"></a>          <span class="c">!</span>
<a name="ln-486"></a>          <span class="c">! Status                          IsDoneFlag          XCandidate</span>
<a name="ln-487"></a>          <span class="c">! ========================================================================</span>
<a name="ln-488"></a>          <span class="c">! iStatusErrorRange               TRUE                na</span>
<a name="ln-489"></a>          <span class="c">! iStatusErrorSingular            TRUE                na</span>
<a name="ln-490"></a>          <span class="c">! iStatusErrorSlope               TRUE                na</span>
<a name="ln-491"></a>          <span class="c">! iStatusErrorBracket             TRUE                na</span>
<a name="ln-492"></a>          <span class="c">! ------------------------------------------------------------------------</span>
<a name="ln-493"></a>          <span class="c">! iStatusOKMin                    TRUE                MinPoint%X</span>
<a name="ln-494"></a>          <span class="c">! iStatusOKMax                    TRUE                MaxPoint%X</span>
<a name="ln-495"></a>          <span class="c">! iStatusOK                       TRUE                X</span>
<a name="ln-496"></a>          <span class="c">! iStatusOKRoundOff               TRUE                X</span>
<a name="ln-497"></a>          <span class="c">! ------------------------------------------------------------------------</span>
<a name="ln-498"></a>          <span class="c">! iStatusNone                     FALSE               AdvanceRootFinder()</span>
<a name="ln-499"></a>          <span class="c">! iStatusWarningNonMonotonic      FALSE               AdvanceRootFinder()</span>
<a name="ln-500"></a>          <span class="c">! iStatusWarningSingular          FALSE               AdvanceRootFinder()</span>
<a name="ln-501"></a>          <span class="c">!</span>
<a name="ln-502"></a>
<a name="ln-503"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-504"></a>          <span class="c">! The methodology reflects the same approach implemented in the subroutine CalcSimpleController()</span>
<a name="ln-505"></a>          <span class="c">! whereby the iteration was exited by checking the following conditions in this specified</span>
<a name="ln-506"></a>          <span class="c">! sequence:</span>
<a name="ln-507"></a>          <span class="c">!   1. Check for singular function so that YMin /= YMax</span>
<a name="ln-508"></a>          <span class="c">!   2. Check for slope condition for the residual function</span>
<a name="ln-509"></a>          <span class="c">!      - increasing: YMin &lt; YMax</span>
<a name="ln-510"></a>          <span class="c">!      - decreasing: YMin &gt; YMax</span>
<a name="ln-511"></a>          <span class="c">!   3. Check for min constraint</span>
<a name="ln-512"></a>          <span class="c">!      - increasing: YMin &lt;= 0</span>
<a name="ln-513"></a>          <span class="c">!      - decreasing: YMin &gt;= 0</span>
<a name="ln-514"></a>          <span class="c">!   4. Check for max constraint</span>
<a name="ln-515"></a>          <span class="c">!      - increasing: YMax &gt; 0</span>
<a name="ln-516"></a>          <span class="c">!      - decreasing: YMax &lt; 0</span>
<a name="ln-517"></a>          <span class="c">!   5. Check unconstrained convergence</span>
<a name="ln-518"></a>          <span class="c">!</span>
<a name="ln-519"></a>          <span class="c">! Note that the slope condition was not explicitly checked in the original implementation</span>
<a name="ln-520"></a>          <span class="c">! in CalcSimpleController().</span>
<a name="ln-521"></a>          <span class="c">!</span>
<a name="ln-522"></a>          <span class="c">! Finally, we also check the X increments between successive iterations to detect possible</span>
<a name="ln-523"></a>          <span class="c">! cases whereby the allowed precision in the X space limits the precision attainable in</span>
<a name="ln-524"></a>          <span class="c">! the Y space. This check is implemented in:</span>
<a name="ln-525"></a>          <span class="c">! - CheckIncrementRoundOff()</span>
<a name="ln-526"></a>          <span class="c">! - CheckBracketRoundOff()</span>
<a name="ln-527"></a>          <span class="c">!</span>
<a name="ln-528"></a>
<a name="ln-529"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-530"></a>          <span class="c">! na</span>
<a name="ln-531"></a>
<a name="ln-532"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-533"></a>          <span class="c">! na</span>
<a name="ln-534"></a>
<a name="ln-535"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-536"></a>
<a name="ln-537"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-538"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-539"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">X</span>              <span class="c">! X value of current iterate</span>
<a name="ln-540"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">Y</span>              <span class="c">! Y value of current iterate</span>
<a name="ln-541"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">),</span> <span class="k">OPTIONAL</span>          <span class="kd">::</span> <span class="n">IsDoneFlag</span>     <span class="c">! If TRUE indicates that the iteration should be stopped</span>
<a name="ln-542"></a>
<a name="ln-543"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-544"></a>          <span class="c">! na</span>
<a name="ln-545"></a>
<a name="ln-546"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-547"></a>          <span class="c">! na</span>
<a name="ln-548"></a>
<a name="ln-549"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-550"></a>          <span class="c">! na</span>
<a name="ln-551"></a>
<a name="ln-552"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-553"></a>          <span class="c">! na</span>
<a name="ln-554"></a>
<a name="ln-555"></a>          <span class="c">! FLOW:</span>
<a name="ln-556"></a>
<a name="ln-557"></a>  <span class="c">! Reset status flag</span>
<a name="ln-558"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusNone</span>
<a name="ln-559"></a>
<a name="ln-560"></a>  <span class="c">! Check that MinPoint%X &lt;= X &lt;= MaxPoint%X</span>
<a name="ln-561"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">CheckMinMaxRange</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-562"></a><span class="k">    </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusErrorRange</span>
<a name="ln-563"></a>
<a name="ln-564"></a>    <span class="c">! Fatal error: No need to continue iterating</span>
<a name="ln-565"></a>    <span class="n">IsDoneFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-566"></a>    <span class="k">RETURN</span>
<a name="ln-567"></a><span class="k">  END IF</span>
<a name="ln-568"></a>
<a name="ln-569"></a>  <span class="c">! Update min/max support points with current iterate</span>
<a name="ln-570"></a>  <span class="k">CALL </span><span class="n">UpdateMinMax</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="p">)</span>
<a name="ln-571"></a>
<a name="ln-572"></a>  <span class="c">!----------------------------------------------------------------------------</span>
<a name="ln-573"></a>  <span class="c">! Check &quot;global&quot; singularity and bad slope conditions between min and</span>
<a name="ln-574"></a>  <span class="c">! max points</span>
<a name="ln-575"></a>  <span class="c">!----------------------------------------------------------------------------</span>
<a name="ln-576"></a>
<a name="ln-577"></a>  <span class="c">! NOTE: Performed before checking min and max constraints to mimic original implementation</span>
<a name="ln-578"></a>  <span class="c">!       in ManagerControllers()</span>
<a name="ln-579"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-580"></a>
<a name="ln-581"></a>    <span class="c">! Check that min and max points are distinct</span>
<a name="ln-582"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">X</span> <span class="o">==</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">X</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-583"></a><span class="k">      </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusOKMin</span>
<a name="ln-584"></a>      <span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">X</span>
<a name="ln-585"></a>
<a name="ln-586"></a>      <span class="c">! Solution found: No need to continue iterating</span>
<a name="ln-587"></a>      <span class="n">IsDoneFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-588"></a>      <span class="k">RETURN</span>
<a name="ln-589"></a><span class="k">    END IF</span>
<a name="ln-590"></a>
<a name="ln-591"></a><span class="k">    IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-592"></a><span class="k">      IF</span> <span class="p">(</span> <span class="n">CheckMinConstraint</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-593"></a><span class="k">        </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusOKMin</span>
<a name="ln-594"></a>        <span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">X</span>
<a name="ln-595"></a>
<a name="ln-596"></a>        <span class="c">! Solution found: No need to continue iterating</span>
<a name="ln-597"></a>        <span class="n">IsDoneFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-598"></a>        <span class="k">RETURN</span>
<a name="ln-599"></a><span class="k">      END IF</span>
<a name="ln-600"></a><span class="k">    END IF</span>
<a name="ln-601"></a>
<a name="ln-602"></a>    <span class="c">! Check singularity condition between min and max points</span>
<a name="ln-603"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">CheckNonSingularity</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-604"></a><span class="k">      </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusErrorSingular</span>
<a name="ln-605"></a>
<a name="ln-606"></a>      <span class="c">! Fatal error: No need to continue iterating</span>
<a name="ln-607"></a>      <span class="n">IsDoneFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-608"></a>      <span class="k">RETURN</span>
<a name="ln-609"></a><span class="k">    END IF</span>
<a name="ln-610"></a>
<a name="ln-611"></a>    <span class="c">! Check slope condition between min and max points</span>
<a name="ln-612"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">CheckSlope</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-613"></a><span class="k">      </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusErrorSlope</span>
<a name="ln-614"></a>
<a name="ln-615"></a>      <span class="c">! Fatal error: No need to continue iterating</span>
<a name="ln-616"></a>      <span class="n">IsDoneFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-617"></a>      <span class="k">RETURN</span>
<a name="ln-618"></a><span class="k">    END IF</span>
<a name="ln-619"></a><span class="k">  END IF</span>
<a name="ln-620"></a>
<a name="ln-621"></a>  <span class="c">!----------------------------------------------------------------------------</span>
<a name="ln-622"></a>  <span class="c">! Check that F(X) is not min or max constrained</span>
<a name="ln-623"></a>  <span class="c">!----------------------------------------------------------------------------</span>
<a name="ln-624"></a>
<a name="ln-625"></a>  <span class="c">! Check min constraint before max constraint to mimic original implementation</span>
<a name="ln-626"></a>  <span class="c">! in ManagerControllers()</span>
<a name="ln-627"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-628"></a><span class="k">    IF</span> <span class="p">(</span> <span class="n">CheckMinConstraint</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-629"></a><span class="k">      </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusOKMin</span>
<a name="ln-630"></a>      <span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">X</span>
<a name="ln-631"></a>
<a name="ln-632"></a>      <span class="c">! Solution found: No need to continue iterating</span>
<a name="ln-633"></a>      <span class="n">IsDoneFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-634"></a>      <span class="k">RETURN</span>
<a name="ln-635"></a><span class="k">    END IF</span>
<a name="ln-636"></a><span class="k">  END IF</span>
<a name="ln-637"></a>
<a name="ln-638"></a>  <span class="c">! Min point should always be evaluated first to ensure that we return with the min</span>
<a name="ln-639"></a>  <span class="c">! consrained solution even in cases where the residual function has inconsistent slope.</span>
<a name="ln-640"></a>  <span class="c">!</span>
<a name="ln-641"></a>  <span class="c">! TODO: Force to evaluate min point before exiting with max constrained solution</span>
<a name="ln-642"></a>  <span class="c">!       in order to be able to detect singularity and bad slope conditions.</span>
<a name="ln-643"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-644"></a><span class="k">    IF</span> <span class="p">(</span> <span class="n">CheckMaxConstraint</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-645"></a>
<a name="ln-646"></a><span class="k">      </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusOKMax</span>
<a name="ln-647"></a>      <span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">X</span>
<a name="ln-648"></a>
<a name="ln-649"></a>      <span class="c">! Solution found: No need to continue iterating</span>
<a name="ln-650"></a>      <span class="n">IsDoneFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-651"></a>      <span class="k">RETURN</span>
<a name="ln-652"></a><span class="k">    END IF</span>
<a name="ln-653"></a><span class="k">  END IF</span>
<a name="ln-654"></a>
<a name="ln-655"></a>  <span class="c">!----------------------------------------------------------------------------</span>
<a name="ln-656"></a>  <span class="c">! Check convergence of current iterate</span>
<a name="ln-657"></a>  <span class="c">!----------------------------------------------------------------------------</span>
<a name="ln-658"></a>
<a name="ln-659"></a>  <span class="c">! Check unconstrained convergence after we are sure that the candidate X value lies</span>
<a name="ln-660"></a>  <span class="c">! within the allowed min/max range</span>
<a name="ln-661"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">CheckRootFinderConvergence</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">Y</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-662"></a><span class="k">    </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusOK</span>
<a name="ln-663"></a>    <span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-664"></a>
<a name="ln-665"></a>    <span class="c">! Update root finder internal data with current iterate (X,Y)</span>
<a name="ln-666"></a>    <span class="k">CALL </span><span class="n">UpdateRootFinder</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="p">)</span>
<a name="ln-667"></a>
<a name="ln-668"></a>    <span class="c">! Solution found: No need to continue iterating</span>
<a name="ln-669"></a>    <span class="n">IsDoneFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-670"></a>    <span class="k">RETURN</span>
<a name="ln-671"></a><span class="k">  END IF</span>
<a name="ln-672"></a>
<a name="ln-673"></a>  <span class="c">! Check last as this was not done in the original implementation</span>
<a name="ln-674"></a>  <span class="c">!</span>
<a name="ln-675"></a>  <span class="c">! Essentially we stop the iteration if:</span>
<a name="ln-676"></a>  <span class="c">! - the increment beween successive iterates is smaller than the user-specified</span>
<a name="ln-677"></a>  <span class="c">!   tolerance for the X variables.</span>
<a name="ln-678"></a>  <span class="c">! - the distance between the lower and upper bounds is smaller than the user-specified</span>
<a name="ln-679"></a>  <span class="c">!   tolerance for the X variables. (USING brackets from previous iteration)</span>
<a name="ln-680"></a>  <span class="c">!</span>
<a name="ln-681"></a>  <span class="c">! BUG: Relaxed check to avoid detecting round-off in case 2 successive iterates are the same!</span>
<a name="ln-682"></a>  <span class="c">!</span>
<a name="ln-683"></a>  <span class="c">!IF ( CheckIncrementRoundOff( RootFinderData, X ) ) THEN</span>
<a name="ln-684"></a>  <span class="c">!  RootFinderData%StatusFlag = iStatusOKRoundOff</span>
<a name="ln-685"></a>  <span class="c">!  RETURN</span>
<a name="ln-686"></a>  <span class="c">!END IF</span>
<a name="ln-687"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">CheckBracketRoundOff</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-688"></a><span class="k">    </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusOKRoundOff</span>
<a name="ln-689"></a>    <span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-690"></a>
<a name="ln-691"></a>    <span class="c">! Update root finder internal data with current iterate (X,Y)</span>
<a name="ln-692"></a>    <span class="k">CALL </span><span class="n">UpdateRootFinder</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="p">)</span>
<a name="ln-693"></a>
<a name="ln-694"></a>    <span class="c">! Solution found: No need to continue iterating</span>
<a name="ln-695"></a>    <span class="n">IsDoneFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-696"></a>    <span class="k">RETURN</span>
<a name="ln-697"></a><span class="k">  END IF</span>
<a name="ln-698"></a>
<a name="ln-699"></a>  <span class="c">!----------------------------------------------------------------------------</span>
<a name="ln-700"></a>  <span class="c">! If the current iterate lies within the current lower and upper brackets,</span>
<a name="ln-701"></a>  <span class="c">! proceed with normal processing to identify the next root candidate:</span>
<a name="ln-702"></a>  <span class="c">! - update lower/upper bracket with current iterate</span>
<a name="ln-703"></a>  <span class="c">! - update history</span>
<a name="ln-704"></a>  <span class="c">! - update increments across successive iterations</span>
<a name="ln-705"></a>  <span class="c">! - update current point</span>
<a name="ln-706"></a>  <span class="c">! - compute next candidate (see AdvanceRootFinder() ).</span>
<a name="ln-707"></a>  <span class="c">!----------------------------------------------------------------------------</span>
<a name="ln-708"></a>
<a name="ln-709"></a>  <span class="c">! Check that current iterate is within the current lower and upper points</span>
<a name="ln-710"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">CheckLowerUpperBracket</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-711"></a><span class="k">    </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusErrorBracket</span>
<a name="ln-712"></a>
<a name="ln-713"></a>    <span class="c">! Fatal error: No need to continue iterating</span>
<a name="ln-714"></a>    <span class="n">IsDoneFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-715"></a>    <span class="k">RETURN</span>
<a name="ln-716"></a><span class="k">  END IF</span>
<a name="ln-717"></a>
<a name="ln-718"></a>  <span class="c">! Update root finder internal data with current iterate (X,Y)</span>
<a name="ln-719"></a>  <span class="k">CALL </span><span class="n">UpdateRootFinder</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="p">)</span>
<a name="ln-720"></a>
<a name="ln-721"></a>  <span class="c">! Compute new root candidate and store value in in RootFinderData%XCandidate</span>
<a name="ln-722"></a>  <span class="c">! - First attempt to bracket root within lower and upper points</span>
<a name="ln-723"></a>  <span class="c">! - Then use whatever requested solution method in SetupRootFinder() to</span>
<a name="ln-724"></a>  <span class="c">!   compute the next candidate.</span>
<a name="ln-725"></a>  <span class="k">CALL </span><span class="n">AdvanceRootFinder</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-726"></a>
<a name="ln-727"></a>  <span class="c">! Indicates that we should continue iterating with new candidate</span>
<a name="ln-728"></a>  <span class="n">IsDoneFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-729"></a>
<a name="ln-730"></a>  <span class="k">RETURN</span>
<a name="ln-731"></a><span class="k">END SUBROUTINE </span><span class="n">IterateRootFinder</span>
<a name="ln-732"></a>
<a name="ln-733"></a>
<a name="ln-734"></a><span class="kt">INTEGER </span><span class="k">FUNCTION </span><span class="n">CheckInternalConsistency</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-735"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-736"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-737"></a>          <span class="c">!       DATE WRITTEN   March 2006</span>
<a name="ln-738"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-739"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-740"></a>
<a name="ln-741"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-742"></a>          <span class="c">! This function checks whether the lower and upper points (if defined)</span>
<a name="ln-743"></a>          <span class="c">! determine a consistent interval bracketting the root.</span>
<a name="ln-744"></a>          <span class="c">!</span>
<a name="ln-745"></a>          <span class="c">! Returns the status code accordingly.</span>
<a name="ln-746"></a>          <span class="c">!</span>
<a name="ln-747"></a>          <span class="c">! This function does not modify the argument RooFinderData.</span>
<a name="ln-748"></a>          <span class="c">!</span>
<a name="ln-749"></a>          <span class="c">! Only used internally for debugging.</span>
<a name="ln-750"></a>          <span class="c">!</span>
<a name="ln-751"></a>
<a name="ln-752"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-753"></a>          <span class="c">! na</span>
<a name="ln-754"></a>
<a name="ln-755"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-756"></a>          <span class="c">! na</span>
<a name="ln-757"></a>
<a name="ln-758"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-759"></a>          <span class="c">! na</span>
<a name="ln-760"></a>
<a name="ln-761"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-762"></a>
<a name="ln-763"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-764"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-765"></a>
<a name="ln-766"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-767"></a>          <span class="c">! na</span>
<a name="ln-768"></a>
<a name="ln-769"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-770"></a>          <span class="c">! na</span>
<a name="ln-771"></a>
<a name="ln-772"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-773"></a>          <span class="c">! na</span>
<a name="ln-774"></a>
<a name="ln-775"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-776"></a>          <span class="c">! na</span>
<a name="ln-777"></a>
<a name="ln-778"></a>          <span class="c">! FLOW:</span>
<a name="ln-779"></a>
<a name="ln-780"></a>  <span class="c">! Default initialization</span>
<a name="ln-781"></a>  <span class="n">CheckInternalConsistency</span> <span class="o">=</span> <span class="n">iStatusNone</span>
<a name="ln-782"></a>
<a name="ln-783"></a>  <span class="c">! Internal consistency check involving both support points</span>
<a name="ln-784"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-785"></a>
<a name="ln-786"></a>    <span class="c">! Check that the existing lower and upper points do bracket the root</span>
<a name="ln-787"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span> <span class="o">&gt;</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">X</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-788"></a><span class="k">      </span><span class="n">CheckInternalConsistency</span> <span class="o">=</span> <span class="n">iStatusErrorRange</span>
<a name="ln-789"></a>      <span class="k">RETURN</span>
<a name="ln-790"></a><span class="k">    END IF</span>
<a name="ln-791"></a>
<a name="ln-792"></a>    <span class="c">! Check for non-monotonicity between the existing lower and upper points</span>
<a name="ln-793"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">SlopeType</span> <span class="p">)</span>
<a name="ln-794"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">iSlopeIncreasing</span><span class="p">)</span>
<a name="ln-795"></a>      <span class="c">! Y-value of lower point must be strictly smaller than Y-value of upper point</span>
<a name="ln-796"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">&gt;</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">Y</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-797"></a><span class="k">        </span><span class="n">CheckInternalConsistency</span> <span class="o">=</span> <span class="n">iStatusWarningNonMonotonic</span>
<a name="ln-798"></a>        <span class="k">RETURN</span>
<a name="ln-799"></a><span class="k">      END IF</span>
<a name="ln-800"></a>
<a name="ln-801"></a><span class="k">    CASE</span> <span class="p">(</span><span class="n">iSlopeDecreasing</span><span class="p">)</span>
<a name="ln-802"></a>      <span class="c">! Y-value of lower point must be strictly larger than Y-value of upper point</span>
<a name="ln-803"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">&lt;</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">Y</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-804"></a><span class="k">        </span><span class="n">CheckInternalConsistency</span> <span class="o">=</span> <span class="n">iStatusWarningNonMonotonic</span>
<a name="ln-805"></a>        <span class="k">RETURN</span>
<a name="ln-806"></a><span class="k">      END IF</span>
<a name="ln-807"></a>
<a name="ln-808"></a><span class="k">    CASE </span><span class="n">DEFAULT</span>
<a name="ln-809"></a>      <span class="c">! Should never happen</span>
<a name="ln-810"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;CheckInternalConsistency: Invalid function slope specification. Valid choices are:&#39;</span><span class="p">)</span>
<a name="ln-811"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;CheckInternalConsistency: iSlopeIncreasing=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iSlopeIncreasing</span><span class="p">)))</span>
<a name="ln-812"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;CheckInternalConsistency: iSlopeDecreasing=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iSlopeDecreasing</span><span class="p">)))</span>
<a name="ln-813"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CheckInternalConsistency: Preceding error causes program termination.&#39;</span><span class="p">)</span>
<a name="ln-814"></a>    <span class="k">END SELECT</span>
<a name="ln-815"></a>
<a name="ln-816"></a>    <span class="c">! Check for in singularity with respect to the existing lower and upper points</span>
<a name="ln-817"></a>    <span class="c">! Only check if the lower and upper points are distinct!</span>
<a name="ln-818"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">X</span> <span class="o">&gt;</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-819"></a><span class="k">      IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">==</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">Y</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-820"></a><span class="k">        </span><span class="n">CheckInternalConsistency</span> <span class="o">=</span> <span class="n">iStatusErrorSingular</span>
<a name="ln-821"></a>        <span class="k">RETURN</span>
<a name="ln-822"></a><span class="k">      END IF</span>
<a name="ln-823"></a><span class="k">    END IF</span>
<a name="ln-824"></a>
<a name="ln-825"></a><span class="k">  END IF</span>
<a name="ln-826"></a>
<a name="ln-827"></a>
<a name="ln-828"></a>  <span class="c">! Check min constraint for min point if already defined</span>
<a name="ln-829"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-830"></a><span class="k">    SELECT CASE</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">SlopeType</span> <span class="p">)</span>
<a name="ln-831"></a>    <span class="k">CASE</span> <span class="p">(</span> <span class="n">iSlopeIncreasing</span> <span class="p">)</span>
<a name="ln-832"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-833"></a><span class="k">        </span><span class="n">CheckInternalConsistency</span> <span class="o">=</span> <span class="n">iStatusOKMin</span>
<a name="ln-834"></a>        <span class="k">RETURN</span>
<a name="ln-835"></a><span class="k">      END IF</span>
<a name="ln-836"></a>
<a name="ln-837"></a><span class="k">    CASE</span> <span class="p">(</span> <span class="n">iSlopeDecreasing</span> <span class="p">)</span>
<a name="ln-838"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-839"></a><span class="k">        </span><span class="n">CheckInternalConsistency</span> <span class="o">=</span> <span class="n">iStatusOKMin</span>
<a name="ln-840"></a>        <span class="k">RETURN</span>
<a name="ln-841"></a><span class="k">      END IF</span>
<a name="ln-842"></a>
<a name="ln-843"></a><span class="k">    CASE </span><span class="n">DEFAULT</span>
<a name="ln-844"></a>      <span class="c">! Should never happen</span>
<a name="ln-845"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;CheckInternalConsistency: Invalid function slope specification. Valid choices are:&#39;</span><span class="p">)</span>
<a name="ln-846"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;CheckInternalConsistency: iSlopeIncreasing=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iSlopeIncreasing</span><span class="p">)))</span>
<a name="ln-847"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;CheckInternalConsistency: iSlopeDecreasing=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iSlopeDecreasing</span><span class="p">)))</span>
<a name="ln-848"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CheckInternalConsistency: Preceding error causes program termination.&#39;</span><span class="p">)</span>
<a name="ln-849"></a>    <span class="k">END SELECT</span>
<a name="ln-850"></a><span class="k">  END IF</span>
<a name="ln-851"></a>
<a name="ln-852"></a>
<a name="ln-853"></a>  <span class="c">! Check max constraint for max point if already defined</span>
<a name="ln-854"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-855"></a><span class="k">    SELECT CASE</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">SlopeType</span> <span class="p">)</span>
<a name="ln-856"></a>    <span class="k">CASE</span> <span class="p">(</span> <span class="n">iSlopeIncreasing</span> <span class="p">)</span>
<a name="ln-857"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-858"></a><span class="k">        </span><span class="n">CheckInternalConsistency</span> <span class="o">=</span> <span class="n">iStatusOKMax</span>
<a name="ln-859"></a>        <span class="k">RETURN</span>
<a name="ln-860"></a><span class="k">      END IF</span>
<a name="ln-861"></a>
<a name="ln-862"></a><span class="k">    CASE</span> <span class="p">(</span> <span class="n">iSlopeDecreasing</span> <span class="p">)</span>
<a name="ln-863"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-864"></a><span class="k">        </span><span class="n">CheckInternalConsistency</span> <span class="o">=</span> <span class="n">iStatusOKMax</span>
<a name="ln-865"></a>        <span class="k">RETURN</span>
<a name="ln-866"></a><span class="k">      END IF</span>
<a name="ln-867"></a>
<a name="ln-868"></a><span class="k">    CASE </span><span class="n">DEFAULT</span>
<a name="ln-869"></a>      <span class="c">! Should never happen</span>
<a name="ln-870"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;CheckInternalConsistency: Invalid function slope specification. Valid choices are:&#39;</span><span class="p">)</span>
<a name="ln-871"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;CheckInternalConsistency: iSlopeIncreasing=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iSlopeIncreasing</span><span class="p">)))</span>
<a name="ln-872"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;CheckInternalConsistency: iSlopeDecreasing=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iSlopeDecreasing</span><span class="p">)))</span>
<a name="ln-873"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CheckInternalConsistency: Preceding error causes program termination.&#39;</span><span class="p">)</span>
<a name="ln-874"></a>    <span class="k">END SELECT</span>
<a name="ln-875"></a><span class="k">  END IF</span>
<a name="ln-876"></a>
<a name="ln-877"></a><span class="k">  RETURN</span>
<a name="ln-878"></a><span class="k">END FUNCTION </span><span class="n">CheckInternalConsistency</span>
<a name="ln-879"></a>
<a name="ln-880"></a>
<a name="ln-881"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">CheckRootFinderCandidate</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span> <span class="p">)</span>
<a name="ln-882"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-883"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-884"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-885"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-886"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-887"></a>
<a name="ln-888"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-889"></a>          <span class="c">! This function checks whether the root candidate X lies within the specified</span>
<a name="ln-890"></a>          <span class="c">! min/max limits as well as within the current lower and upper brackets (if defined).</span>
<a name="ln-891"></a>          <span class="c">!</span>
<a name="ln-892"></a>          <span class="c">! Returns TRUE if X value is a valid root candidate.</span>
<a name="ln-893"></a>          <span class="c">! Returns FALSE otherwise.</span>
<a name="ln-894"></a>          <span class="c">!</span>
<a name="ln-895"></a>
<a name="ln-896"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-897"></a>          <span class="c">! na</span>
<a name="ln-898"></a>
<a name="ln-899"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-900"></a>          <span class="c">! na</span>
<a name="ln-901"></a>
<a name="ln-902"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-903"></a>          <span class="c">! na</span>
<a name="ln-904"></a>
<a name="ln-905"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-906"></a>
<a name="ln-907"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-908"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-909"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">X</span>              <span class="c">! X value for current iterate</span>
<a name="ln-910"></a>
<a name="ln-911"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-912"></a>          <span class="c">! na</span>
<a name="ln-913"></a>
<a name="ln-914"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-915"></a>          <span class="c">! na</span>
<a name="ln-916"></a>
<a name="ln-917"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-918"></a>          <span class="c">! na</span>
<a name="ln-919"></a>
<a name="ln-920"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-921"></a>          <span class="c">! na</span>
<a name="ln-922"></a>
<a name="ln-923"></a>          <span class="c">! FLOW:</span>
<a name="ln-924"></a>
<a name="ln-925"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">CheckMinMaxRange</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span> <span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CheckLowerUpperBracket</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-926"></a><span class="k">    </span><span class="n">CheckRootFinderCandidate</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-927"></a>  <span class="k">ELSE</span>
<a name="ln-928"></a><span class="k">    </span><span class="n">CheckRootFinderCandidate</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-929"></a>  <span class="k">END IF</span>
<a name="ln-930"></a>
<a name="ln-931"></a><span class="k">  RETURN</span>
<a name="ln-932"></a><span class="k">END FUNCTION </span><span class="n">CheckRootFinderCandidate</span>
<a name="ln-933"></a>
<a name="ln-934"></a>
<a name="ln-935"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">CheckMinMaxRange</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span> <span class="p">)</span>
<a name="ln-936"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-937"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-938"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-939"></a>          <span class="c">!       MODIFIED       Brent Griffith (NREL) added DefinedFlag traps</span>
<a name="ln-940"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-941"></a>
<a name="ln-942"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-943"></a>          <span class="c">! This function checks whether the current iterate X lies within the specified min/max limits</span>
<a name="ln-944"></a>          <span class="c">! or not.</span>
<a name="ln-945"></a>          <span class="c">!</span>
<a name="ln-946"></a>          <span class="c">! Returns TRUE if current iterate satisfies min/max constraints.</span>
<a name="ln-947"></a>          <span class="c">! Returns FALSE if current iterate is out-of-range.</span>
<a name="ln-948"></a>          <span class="c">!</span>
<a name="ln-949"></a>
<a name="ln-950"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-951"></a>          <span class="c">! na</span>
<a name="ln-952"></a>
<a name="ln-953"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-954"></a>          <span class="c">! na</span>
<a name="ln-955"></a>
<a name="ln-956"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-957"></a>          <span class="c">! na</span>
<a name="ln-958"></a>
<a name="ln-959"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-960"></a>
<a name="ln-961"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-962"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-963"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">X</span>              <span class="c">! X value for current iterate</span>
<a name="ln-964"></a>
<a name="ln-965"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-966"></a>          <span class="c">! na</span>
<a name="ln-967"></a>
<a name="ln-968"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-969"></a>          <span class="c">! na</span>
<a name="ln-970"></a>
<a name="ln-971"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-972"></a>          <span class="c">! na</span>
<a name="ln-973"></a>
<a name="ln-974"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-975"></a>          <span class="c">! na</span>
<a name="ln-976"></a>
<a name="ln-977"></a>          <span class="c">! FLOW:</span>
<a name="ln-978"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">DefinedFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!DSU3 testing</span>
<a name="ln-979"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">X</span> <span class="o">&lt;</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">X</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-980"></a><span class="k">      </span><span class="n">CheckMinMaxRange</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-981"></a>      <span class="k">RETURN</span>
<a name="ln-982"></a><span class="k">    END IF</span>
<a name="ln-983"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-984"></a>
<a name="ln-985"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">DefinedFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!DSU3 testing</span>
<a name="ln-986"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">X</span> <span class="o">&gt;</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">X</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-987"></a><span class="k">      </span><span class="n">CheckMinMaxRange</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-988"></a>      <span class="k">RETURN</span>
<a name="ln-989"></a><span class="k">    END IF</span>
<a name="ln-990"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-991"></a>
<a name="ln-992"></a>  <span class="n">CheckMinMaxRange</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-993"></a>
<a name="ln-994"></a>  <span class="k">RETURN</span>
<a name="ln-995"></a><span class="k">END FUNCTION </span><span class="n">CheckMinMaxRange</span>
<a name="ln-996"></a>
<a name="ln-997"></a>
<a name="ln-998"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">CheckLowerUpperBracket</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span> <span class="p">)</span>
<a name="ln-999"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1000"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-1001"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-1002"></a>          <span class="c">!       MODIFIED       Brent Griffith, March 2010, changed to LowerPoint%X &lt;= X &lt;= UpperPoint%X</span>
<a name="ln-1003"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1004"></a>
<a name="ln-1005"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1006"></a>          <span class="c">! This function checks whether the current iterate X lies within the current lower</span>
<a name="ln-1007"></a>          <span class="c">! and upper points or not (if defined):</span>
<a name="ln-1008"></a>          <span class="c">!   LowerPoint%X &lt; X &lt; UpperPoint%X</span>
<a name="ln-1009"></a>          <span class="c">!</span>
<a name="ln-1010"></a>          <span class="c">! Returns TRUE if current iterate lies within the lower/upper bracket.</span>
<a name="ln-1011"></a>          <span class="c">! Returns FALSE otherwise.</span>
<a name="ln-1012"></a>          <span class="c">!</span>
<a name="ln-1013"></a>
<a name="ln-1014"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1015"></a>          <span class="c">! na</span>
<a name="ln-1016"></a>
<a name="ln-1017"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1018"></a>          <span class="c">! na</span>
<a name="ln-1019"></a>
<a name="ln-1020"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1021"></a>          <span class="c">! na</span>
<a name="ln-1022"></a>
<a name="ln-1023"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1024"></a>
<a name="ln-1025"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1026"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-1027"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">X</span>              <span class="c">! X value for current iterate</span>
<a name="ln-1028"></a>
<a name="ln-1029"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-1030"></a>          <span class="c">! na</span>
<a name="ln-1031"></a>
<a name="ln-1032"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1033"></a>          <span class="c">! na</span>
<a name="ln-1034"></a>
<a name="ln-1035"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1036"></a>          <span class="c">! na</span>
<a name="ln-1037"></a>
<a name="ln-1038"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1039"></a>          <span class="c">! na</span>
<a name="ln-1040"></a>
<a name="ln-1041"></a>          <span class="c">! FLOW:</span>
<a name="ln-1042"></a>
<a name="ln-1043"></a>
<a name="ln-1044"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1045"></a><span class="k">    IF</span> <span class="p">(</span> <span class="n">X</span> <span class="o">&lt;</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span> <span class="p">)</span> <span class="k">THEN</span>  <span class="c">!DSU3 test with &lt; instead of &lt;=</span>
<a name="ln-1046"></a>      <span class="n">CheckLowerUpperBracket</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1047"></a>      <span class="k">RETURN</span>
<a name="ln-1048"></a><span class="k">    END IF</span>
<a name="ln-1049"></a><span class="k">  END IF</span>
<a name="ln-1050"></a>
<a name="ln-1051"></a><span class="k">  IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1052"></a><span class="k">    IF</span> <span class="p">(</span> <span class="n">X</span> <span class="o">&gt;</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">X</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">!DSU3 test with &gt; instead of &gt;=</span>
<a name="ln-1053"></a>      <span class="n">CheckLowerUpperBracket</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1054"></a>      <span class="k">RETURN</span>
<a name="ln-1055"></a><span class="k">    END IF</span>
<a name="ln-1056"></a><span class="k">  END IF</span>
<a name="ln-1057"></a>
<a name="ln-1058"></a><span class="k">  </span><span class="n">CheckLowerUpperBracket</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1059"></a>
<a name="ln-1060"></a>  <span class="k">RETURN</span>
<a name="ln-1061"></a><span class="k">END FUNCTION </span><span class="n">CheckLowerUpperBracket</span>
<a name="ln-1062"></a>
<a name="ln-1063"></a>
<a name="ln-1064"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">CheckSlope</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-1065"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1066"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-1067"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-1068"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-1069"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1070"></a>
<a name="ln-1071"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1072"></a>          <span class="c">! This function checks whether the current iterate (X,Y) satisfies the slope</span>
<a name="ln-1073"></a>          <span class="c">! requirement between the min and max points.</span>
<a name="ln-1074"></a>          <span class="c">!</span>
<a name="ln-1075"></a>          <span class="c">! Returns FALSE if the slope requirement is NOT satisfied.</span>
<a name="ln-1076"></a>          <span class="c">! Returns TRUE if the slope requirement is satisfied.</span>
<a name="ln-1077"></a>          <span class="c">!</span>
<a name="ln-1078"></a>          <span class="c">! PRECONDITION:</span>
<a name="ln-1079"></a>          <span class="c">! - Function assumes that both the min and max points are defined.</span>
<a name="ln-1080"></a>          <span class="c">!</span>
<a name="ln-1081"></a>          <span class="c">! POSTCONDITION:</span>
<a name="ln-1082"></a>          <span class="c">! - RootFinderData is NOT changed by this function.</span>
<a name="ln-1083"></a>          <span class="c">!</span>
<a name="ln-1084"></a>
<a name="ln-1085"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1086"></a>          <span class="c">! na</span>
<a name="ln-1087"></a>
<a name="ln-1088"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1089"></a>          <span class="c">! na</span>
<a name="ln-1090"></a>
<a name="ln-1091"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1092"></a>          <span class="c">! na</span>
<a name="ln-1093"></a>
<a name="ln-1094"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1095"></a>
<a name="ln-1096"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1097"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-1098"></a>
<a name="ln-1099"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-1100"></a>          <span class="c">! na</span>
<a name="ln-1101"></a>
<a name="ln-1102"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1103"></a>          <span class="c">! na</span>
<a name="ln-1104"></a>
<a name="ln-1105"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1106"></a>          <span class="c">! na</span>
<a name="ln-1107"></a>
<a name="ln-1108"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1109"></a>          <span class="c">! na</span>
<a name="ln-1110"></a>
<a name="ln-1111"></a>          <span class="c">! FLOW:</span>
<a name="ln-1112"></a>
<a name="ln-1113"></a>  <span class="c">! Check that the slope requirement is respected at the min and max points</span>
<a name="ln-1114"></a>  <span class="c">!</span>
<a name="ln-1115"></a>  <span class="c">! Note that the singularity check takes care of RootFinderData%MinPoint%Y == RootFinderData%MaxPoint%Y</span>
<a name="ln-1116"></a>  <span class="c">! therefore we use strict comparison operators &lt; and &gt;.</span>
<a name="ln-1117"></a>  <span class="n">SelectSlope</span><span class="p">:</span> <span class="k">SELECT CASE</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">SlopeType</span> <span class="p">)</span>
<a name="ln-1118"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">iSlopeIncreasing</span> <span class="p">)</span>
<a name="ln-1119"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">&lt;</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">Y</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1120"></a><span class="k">      </span><span class="n">CheckSlope</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1121"></a>      <span class="k">RETURN</span>
<a name="ln-1122"></a><span class="k">    END IF</span>
<a name="ln-1123"></a>
<a name="ln-1124"></a><span class="k">  CASE</span> <span class="p">(</span> <span class="n">iSlopeDecreasing</span> <span class="p">)</span>
<a name="ln-1125"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">&gt;</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">Y</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1126"></a><span class="k">      </span><span class="n">CheckSlope</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1127"></a>      <span class="k">RETURN</span>
<a name="ln-1128"></a><span class="k">    END IF</span>
<a name="ln-1129"></a>
<a name="ln-1130"></a><span class="k">  CASE </span><span class="n">DEFAULT</span>
<a name="ln-1131"></a>    <span class="c">! Should never happen</span>
<a name="ln-1132"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;CheckSlope: Invalid function slope specification. Valid choices are:&#39;</span><span class="p">)</span>
<a name="ln-1133"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;CheckSlope: iSlopeIncreasing=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iSlopeIncreasing</span><span class="p">)))</span>
<a name="ln-1134"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;CheckSlope: iSlopeDecreasing=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iSlopeDecreasing</span><span class="p">)))</span>
<a name="ln-1135"></a>    <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CheckSlope: Preceding error causes program termination.&#39;</span><span class="p">)</span>
<a name="ln-1136"></a>
<a name="ln-1137"></a>  <span class="k">END SELECT </span><span class="n">SelectSlope</span>
<a name="ln-1138"></a>
<a name="ln-1139"></a>  <span class="n">CheckSlope</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1140"></a>
<a name="ln-1141"></a>  <span class="k">RETURN</span>
<a name="ln-1142"></a><span class="k">END FUNCTION </span><span class="n">CheckSlope</span>
<a name="ln-1143"></a>
<a name="ln-1144"></a>
<a name="ln-1145"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">CheckNonSingularity</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-1146"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1147"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-1148"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-1149"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-1150"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1151"></a>
<a name="ln-1152"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1153"></a>          <span class="c">! This function checks whether the min and max points define a locally, singular</span>
<a name="ln-1154"></a>          <span class="c">! equation system. In a 1-dimensional system, &quot;singularity&quot; is detected if the</span>
<a name="ln-1155"></a>          <span class="c">! min and max points have the same y-values, thereby producing a zero slope</span>
<a name="ln-1156"></a>          <span class="c">! across the min/max range.</span>
<a name="ln-1157"></a>          <span class="c">!</span>
<a name="ln-1158"></a>          <span class="c">! Returns TRUE if the function satisfies the non-singularity condition.</span>
<a name="ln-1159"></a>          <span class="c">! Returns FALSE otherwise (i.e., F(X) essentially displays a zero slope</span>
<a name="ln-1160"></a>          <span class="c">! between the min and max points) .</span>
<a name="ln-1161"></a>          <span class="c">!</span>
<a name="ln-1162"></a>          <span class="c">! PRECONDITION:</span>
<a name="ln-1163"></a>          <span class="c">! - Function assumes that both the min and max points are defined.</span>
<a name="ln-1164"></a>          <span class="c">!</span>
<a name="ln-1165"></a>          <span class="c">! POSTCONDITION:</span>
<a name="ln-1166"></a>          <span class="c">! - RootFinderData is NOT changed by this function.</span>
<a name="ln-1167"></a>          <span class="c">!</span>
<a name="ln-1168"></a>
<a name="ln-1169"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1170"></a>          <span class="c">! na</span>
<a name="ln-1171"></a>
<a name="ln-1172"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1173"></a>          <span class="c">! na</span>
<a name="ln-1174"></a>
<a name="ln-1175"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1176"></a>          <span class="c">! na</span>
<a name="ln-1177"></a>
<a name="ln-1178"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1179"></a>
<a name="ln-1180"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1181"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-1182"></a>
<a name="ln-1183"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-1184"></a>  <span class="c">! Safety factor used to detect a singular residual function between the min and max</span>
<a name="ln-1185"></a>  <span class="c">! points.</span>
<a name="ln-1186"></a>  <span class="c">!</span>
<a name="ln-1187"></a>  <span class="c">! NOTE: Requesting exactly the same value is obtained by setting SafetyFactor = 0.0</span>
<a name="ln-1188"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>                         <span class="kd">::</span> <span class="n">SafetyFactor</span> <span class="o">=</span> <span class="mf">0.1d0</span>
<a name="ln-1189"></a>
<a name="ln-1190"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1191"></a>          <span class="c">! na</span>
<a name="ln-1192"></a>
<a name="ln-1193"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1194"></a>          <span class="c">! na</span>
<a name="ln-1195"></a>
<a name="ln-1196"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1197"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">DeltaY</span>     <span class="c">! Difference between min and max Y-values</span>
<a name="ln-1198"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ATolY</span>      <span class="c">! Absolute tolerance used to detected equal min and max Y-values</span>
<a name="ln-1199"></a>
<a name="ln-1200"></a>          <span class="c">! FLOW:</span>
<a name="ln-1201"></a>
<a name="ln-1202"></a>  <span class="c">! Added this check based on an absolute tolerance test for y values to avoid incorrectly detecting</span>
<a name="ln-1203"></a>  <span class="c">! functions with bad slope due to numerical noise.</span>
<a name="ln-1204"></a>  <span class="c">!</span>
<a name="ln-1205"></a>  <span class="c">! Typically, this takes care of situations where the controlled equipment in ManageControllers()</span>
<a name="ln-1206"></a>  <span class="c">! would be misdiagnosed as displaying the &quot;wrong slope&quot; instead of being treated as &quot;singular&quot;</span>
<a name="ln-1207"></a>  <span class="c">! (i.e. in inactive mode).</span>
<a name="ln-1208"></a>  <span class="n">DeltaY</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">-</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span>
<a name="ln-1209"></a>  <span class="n">ATolY</span>  <span class="o">=</span> <span class="n">SafetyFactor</span> <span class="o">*</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">ATolY</span>
<a name="ln-1210"></a>
<a name="ln-1211"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaY</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ATolY</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1212"></a><span class="k">    </span><span class="n">CheckNonSingularity</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1213"></a>  <span class="k">ELSE</span>
<a name="ln-1214"></a><span class="k">    </span><span class="n">CheckNonSingularity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1215"></a>  <span class="k">END IF</span>
<a name="ln-1216"></a>
<a name="ln-1217"></a><span class="k">  RETURN</span>
<a name="ln-1218"></a><span class="k">END FUNCTION </span><span class="n">CheckNonSingularity</span>
<a name="ln-1219"></a>
<a name="ln-1220"></a>
<a name="ln-1221"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">CheckMinConstraint</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-1222"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1223"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-1224"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-1225"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-1226"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1227"></a>
<a name="ln-1228"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1229"></a>          <span class="c">! This function checks whether the min point satisfies the min constraint</span>
<a name="ln-1230"></a>          <span class="c">! condition or not.</span>
<a name="ln-1231"></a>          <span class="c">!</span>
<a name="ln-1232"></a>          <span class="c">! PRECONDITION:</span>
<a name="ln-1233"></a>          <span class="c">! - Function assumes that the min point is defined.</span>
<a name="ln-1234"></a>          <span class="c">!</span>
<a name="ln-1235"></a>          <span class="c">! POSTCONDITION:</span>
<a name="ln-1236"></a>          <span class="c">! - RootFinderData is NOT changed by this function.</span>
<a name="ln-1237"></a>          <span class="c">!</span>
<a name="ln-1238"></a>
<a name="ln-1239"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1240"></a>          <span class="c">! na</span>
<a name="ln-1241"></a>
<a name="ln-1242"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1243"></a>          <span class="c">! na</span>
<a name="ln-1244"></a>
<a name="ln-1245"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1246"></a>          <span class="c">! na</span>
<a name="ln-1247"></a>
<a name="ln-1248"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1249"></a>
<a name="ln-1250"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1251"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-1252"></a>
<a name="ln-1253"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-1254"></a>          <span class="c">! na</span>
<a name="ln-1255"></a>
<a name="ln-1256"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1257"></a>          <span class="c">! na</span>
<a name="ln-1258"></a>
<a name="ln-1259"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1260"></a>          <span class="c">! na</span>
<a name="ln-1261"></a>
<a name="ln-1262"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1263"></a>          <span class="c">! na</span>
<a name="ln-1264"></a>
<a name="ln-1265"></a>          <span class="c">! FLOW:</span>
<a name="ln-1266"></a>
<a name="ln-1267"></a>  <span class="n">SelectSlope</span><span class="p">:</span> <span class="k">SELECT CASE</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">SlopeType</span> <span class="p">)</span>
<a name="ln-1268"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">iSlopeIncreasing</span> <span class="p">)</span>
<a name="ln-1269"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1270"></a><span class="k">      </span><span class="n">CheckMinConstraint</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1271"></a>      <span class="k">RETURN</span>
<a name="ln-1272"></a><span class="k">    END IF</span>
<a name="ln-1273"></a>
<a name="ln-1274"></a><span class="k">  CASE</span> <span class="p">(</span> <span class="n">iSlopeDecreasing</span> <span class="p">)</span>
<a name="ln-1275"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1276"></a><span class="k">      </span><span class="n">CheckMinConstraint</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1277"></a>      <span class="k">RETURN</span>
<a name="ln-1278"></a><span class="k">    END IF</span>
<a name="ln-1279"></a>
<a name="ln-1280"></a><span class="k">  CASE </span><span class="n">DEFAULT</span>
<a name="ln-1281"></a>    <span class="c">! Should never happen</span>
<a name="ln-1282"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;CheckMinConstraint: Invalid function slope specification. Valid choices are:&#39;</span><span class="p">)</span>
<a name="ln-1283"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;CheckMinConstraint: iSlopeIncreasing=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iSlopeIncreasing</span><span class="p">)))</span>
<a name="ln-1284"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;CheckMinConstraint: iSlopeDecreasing=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iSlopeDecreasing</span><span class="p">)))</span>
<a name="ln-1285"></a>    <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CheckMinConstraint: Preceding error causes program termination.&#39;</span><span class="p">)</span>
<a name="ln-1286"></a>  <span class="k">END SELECT </span><span class="n">SelectSlope</span>
<a name="ln-1287"></a>
<a name="ln-1288"></a>  <span class="n">CheckMinConstraint</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1289"></a>
<a name="ln-1290"></a>  <span class="k">RETURN</span>
<a name="ln-1291"></a><span class="k">END FUNCTION </span><span class="n">CheckMinConstraint</span>
<a name="ln-1292"></a>
<a name="ln-1293"></a>
<a name="ln-1294"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">CheckMaxConstraint</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-1295"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1296"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-1297"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-1298"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-1299"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1300"></a>
<a name="ln-1301"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1302"></a>          <span class="c">! This function checks whether the max point satisfies the max constraint</span>
<a name="ln-1303"></a>          <span class="c">! condition or not.</span>
<a name="ln-1304"></a>          <span class="c">!</span>
<a name="ln-1305"></a>          <span class="c">! PRECONDITION:</span>
<a name="ln-1306"></a>          <span class="c">! - Function assumes that the max point is defined.</span>
<a name="ln-1307"></a>          <span class="c">!</span>
<a name="ln-1308"></a>          <span class="c">! POSTCONDITION:</span>
<a name="ln-1309"></a>          <span class="c">! - RootFinderData is NOT changed by this function.</span>
<a name="ln-1310"></a>          <span class="c">!</span>
<a name="ln-1311"></a>
<a name="ln-1312"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1313"></a>          <span class="c">! na</span>
<a name="ln-1314"></a>
<a name="ln-1315"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1316"></a>          <span class="c">! na</span>
<a name="ln-1317"></a>
<a name="ln-1318"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1319"></a>          <span class="c">! na</span>
<a name="ln-1320"></a>
<a name="ln-1321"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1322"></a>
<a name="ln-1323"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1324"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-1325"></a>
<a name="ln-1326"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-1327"></a>          <span class="c">! na</span>
<a name="ln-1328"></a>
<a name="ln-1329"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1330"></a>          <span class="c">! na</span>
<a name="ln-1331"></a>
<a name="ln-1332"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1333"></a>          <span class="c">! na</span>
<a name="ln-1334"></a>
<a name="ln-1335"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1336"></a>          <span class="c">! na</span>
<a name="ln-1337"></a>
<a name="ln-1338"></a>          <span class="c">! FLOW:</span>
<a name="ln-1339"></a>
<a name="ln-1340"></a>  <span class="c">! Check for max constrained convergence with respect to the new iterate (X,Y)</span>
<a name="ln-1341"></a>  <span class="n">SelectSlope</span><span class="p">:</span> <span class="k">SELECT CASE</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">SlopeType</span> <span class="p">)</span>
<a name="ln-1342"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">iSlopeIncreasing</span> <span class="p">)</span>
<a name="ln-1343"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1344"></a><span class="k">      </span><span class="n">CheckMaxConstraint</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1345"></a>      <span class="k">RETURN</span>
<a name="ln-1346"></a><span class="k">    END IF</span>
<a name="ln-1347"></a>
<a name="ln-1348"></a><span class="k">  CASE</span> <span class="p">(</span> <span class="n">iSlopeDecreasing</span> <span class="p">)</span>
<a name="ln-1349"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1350"></a><span class="k">      </span><span class="n">CheckMaxConstraint</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1351"></a>      <span class="k">RETURN</span>
<a name="ln-1352"></a><span class="k">    END IF</span>
<a name="ln-1353"></a>
<a name="ln-1354"></a><span class="k">  CASE </span><span class="n">DEFAULT</span>
<a name="ln-1355"></a>    <span class="c">! Should never happen</span>
<a name="ln-1356"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;CheckMaxConstraint: Invalid function slope specification. Valid choices are:&#39;</span><span class="p">)</span>
<a name="ln-1357"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;CheckMaxConstraint: iSlopeIncreasing=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iSlopeIncreasing</span><span class="p">)))</span>
<a name="ln-1358"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;CheckMaxConstraint: iSlopeDecreasing=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iSlopeDecreasing</span><span class="p">)))</span>
<a name="ln-1359"></a>    <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CheckMaxConstraint: Preceding error causes program termination.&#39;</span><span class="p">)</span>
<a name="ln-1360"></a>  <span class="k">END SELECT </span><span class="n">SelectSlope</span>
<a name="ln-1361"></a>
<a name="ln-1362"></a>  <span class="n">CheckMaxConstraint</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1363"></a>
<a name="ln-1364"></a>  <span class="k">RETURN</span>
<a name="ln-1365"></a><span class="k">END FUNCTION </span><span class="n">CheckMaxConstraint</span>
<a name="ln-1366"></a>
<a name="ln-1367"></a>
<a name="ln-1368"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">CheckRootFinderConvergence</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">Y</span> <span class="p">)</span>
<a name="ln-1369"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1370"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-1371"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-1372"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-1373"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1374"></a>
<a name="ln-1375"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1376"></a>          <span class="c">! This function checks whether the current iterate (X,Y) satisfies the</span>
<a name="ln-1377"></a>          <span class="c">! unconstrained convergence criterion or not.</span>
<a name="ln-1378"></a>
<a name="ln-1379"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1380"></a>          <span class="c">! na</span>
<a name="ln-1381"></a>
<a name="ln-1382"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1383"></a>          <span class="c">! na</span>
<a name="ln-1384"></a>
<a name="ln-1385"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1386"></a>          <span class="c">! na</span>
<a name="ln-1387"></a>
<a name="ln-1388"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1389"></a>
<a name="ln-1390"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1391"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-1392"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">Y</span>              <span class="c">! Y value for current iterate</span>
<a name="ln-1393"></a>
<a name="ln-1394"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-1395"></a>          <span class="c">! na</span>
<a name="ln-1396"></a>
<a name="ln-1397"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1398"></a>          <span class="c">! na</span>
<a name="ln-1399"></a>
<a name="ln-1400"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1401"></a>          <span class="c">! na</span>
<a name="ln-1402"></a>
<a name="ln-1403"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1404"></a>          <span class="c">! na</span>
<a name="ln-1405"></a>
<a name="ln-1406"></a>          <span class="c">! FLOW:</span>
<a name="ln-1407"></a>
<a name="ln-1408"></a>  <span class="c">! Check for unconstrained convergence</span>
<a name="ln-1409"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">ATolY</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1410"></a><span class="k">      </span><span class="n">CheckRootFinderConvergence</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1411"></a>      <span class="k">RETURN</span>
<a name="ln-1412"></a><span class="k">  END IF</span>
<a name="ln-1413"></a>
<a name="ln-1414"></a><span class="k">  </span><span class="n">CheckRootFinderConvergence</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1415"></a>
<a name="ln-1416"></a>  <span class="k">RETURN</span>
<a name="ln-1417"></a><span class="k">END FUNCTION </span><span class="n">CheckRootFinderConvergence</span>
<a name="ln-1418"></a>
<a name="ln-1419"></a>
<a name="ln-1420"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">CheckIncrementRoundOff</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span> <span class="p">)</span>
<a name="ln-1421"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1422"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-1423"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-1424"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-1425"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1426"></a>
<a name="ln-1427"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1428"></a>          <span class="c">! This function checks whether the current iterate X satisfies the</span>
<a name="ln-1429"></a>          <span class="c">! round-off criterion or not.</span>
<a name="ln-1430"></a>          <span class="c">!</span>
<a name="ln-1431"></a>
<a name="ln-1432"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1433"></a>          <span class="c">! na</span>
<a name="ln-1434"></a>
<a name="ln-1435"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1436"></a>          <span class="c">! na</span>
<a name="ln-1437"></a>
<a name="ln-1438"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1439"></a>          <span class="c">! na</span>
<a name="ln-1440"></a>
<a name="ln-1441"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1442"></a>
<a name="ln-1443"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1444"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-1445"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">X</span>              <span class="c">! X value for current iterate</span>
<a name="ln-1446"></a>
<a name="ln-1447"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-1448"></a>          <span class="c">! na</span>
<a name="ln-1449"></a>
<a name="ln-1450"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1451"></a>          <span class="c">! na</span>
<a name="ln-1452"></a>
<a name="ln-1453"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1454"></a>          <span class="c">! na</span>
<a name="ln-1455"></a>
<a name="ln-1456"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1457"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">DeltaX</span>             <span class="c">! Increment in X since last iterate</span>
<a name="ln-1458"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">TolX</span>               <span class="c">! Tolerance to satisfy for X increment</span>
<a name="ln-1459"></a>          <span class="c">! FLOW:</span>
<a name="ln-1460"></a>
<a name="ln-1461"></a>  <span class="n">CheckIncrementRoundOff</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1462"></a>  <span class="c">! Check for round-off error in X increments since last iterate</span>
<a name="ln-1463"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1464"></a>    <span class="c">! TODO: Use typical value for X averaged over successive iterations</span>
<a name="ln-1465"></a>    <span class="n">TolX</span>   <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">TolX</span> <span class="o">*</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">ATolX</span>
<a name="ln-1466"></a>    <span class="n">DeltaX</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentPoint</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-1467"></a>
<a name="ln-1468"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaX</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TolX</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1469"></a><span class="k">        </span><span class="n">CheckIncrementRoundOff</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1470"></a>        <span class="k">RETURN</span>
<a name="ln-1471"></a><span class="k">    END IF</span>
<a name="ln-1472"></a><span class="k">  END IF</span>
<a name="ln-1473"></a>
<a name="ln-1474"></a><span class="k">  RETURN</span>
<a name="ln-1475"></a><span class="k">END FUNCTION </span><span class="n">CheckIncrementRoundOff</span>
<a name="ln-1476"></a>
<a name="ln-1477"></a>
<a name="ln-1478"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">CheckBracketRoundOff</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-1479"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-1480"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-1481"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-1482"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-1483"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1484"></a>
<a name="ln-1485"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-1486"></a>          <span class="c">! This function checks whether the current lower and upper brackets satisfies</span>
<a name="ln-1487"></a>          <span class="c">! the round-off criterion or not.</span>
<a name="ln-1488"></a>          <span class="c">!</span>
<a name="ln-1489"></a>
<a name="ln-1490"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1491"></a>          <span class="c">! na</span>
<a name="ln-1492"></a>
<a name="ln-1493"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1494"></a>          <span class="c">! na</span>
<a name="ln-1495"></a>
<a name="ln-1496"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1497"></a>          <span class="c">! na</span>
<a name="ln-1498"></a>
<a name="ln-1499"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1500"></a>
<a name="ln-1501"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-1502"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-1503"></a>
<a name="ln-1504"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-1505"></a>          <span class="c">! na</span>
<a name="ln-1506"></a>
<a name="ln-1507"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1508"></a>          <span class="c">! na</span>
<a name="ln-1509"></a>
<a name="ln-1510"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1511"></a>          <span class="c">! na</span>
<a name="ln-1512"></a>
<a name="ln-1513"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1514"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">DeltaUL</span>            <span class="c">! Distance between lower and upper points</span>
<a name="ln-1515"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">TypUL</span>              <span class="c">! Typical value for values lying within lower/upper interval</span>
<a name="ln-1516"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">TolUL</span>              <span class="c">! Tolerance to satisfy for lower-upper distance</span>
<a name="ln-1517"></a>          <span class="c">! FLOW:</span>
<a name="ln-1518"></a>
<a name="ln-1519"></a>  <span class="c">! Check for round-off error in Lower/Upper interval</span>
<a name="ln-1520"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1521"></a><span class="k">    </span><span class="n">DeltaUL</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">X</span> <span class="o">-</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span>
<a name="ln-1522"></a>    <span class="n">TypUL</span>   <span class="o">=</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span><span class="p">))</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-1523"></a>    <span class="n">TolUL</span>   <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">TolX</span> <span class="o">*</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TypUL</span><span class="p">)</span> <span class="o">+</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">ATolX</span>
<a name="ln-1524"></a>
<a name="ln-1525"></a>    <span class="c">! Halve tolerance to reflect the fact that solution can be anywhere between the lower and upper points.</span>
<a name="ln-1526"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">DeltaUL</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TolUL</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1527"></a><span class="k">        </span><span class="n">CheckBracketRoundOff</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1528"></a>        <span class="k">RETURN</span>
<a name="ln-1529"></a><span class="k">    END IF</span>
<a name="ln-1530"></a><span class="k">  END IF</span>
<a name="ln-1531"></a>
<a name="ln-1532"></a><span class="k">  </span><span class="n">CheckBracketRoundOff</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1533"></a>
<a name="ln-1534"></a>  <span class="k">RETURN</span>
<a name="ln-1535"></a><span class="k">END FUNCTION </span><span class="n">CheckBracketRoundOff</span>
<a name="ln-1536"></a>
<a name="ln-1537"></a>
<a name="ln-1538"></a><span class="k">SUBROUTINE </span><span class="n">UpdateMinMax</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="p">)</span>
<a name="ln-1539"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1540"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-1541"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-1542"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-1543"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1544"></a>
<a name="ln-1545"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1546"></a>          <span class="c">! This subroutine updates the min/max support points in the root finder data.</span>
<a name="ln-1547"></a>          <span class="c">!</span>
<a name="ln-1548"></a>
<a name="ln-1549"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1550"></a>          <span class="c">!</span>
<a name="ln-1551"></a>          <span class="c">! PRECONDITION:</span>
<a name="ln-1552"></a>          <span class="c">! na</span>
<a name="ln-1553"></a>          <span class="c">!</span>
<a name="ln-1554"></a>          <span class="c">! POSTCONDITION:</span>
<a name="ln-1555"></a>          <span class="c">! - RootFinderData%MinPoint possibly updated</span>
<a name="ln-1556"></a>          <span class="c">! - RootFinderData%MaxPoint possibly updated</span>
<a name="ln-1557"></a>          <span class="c">!</span>
<a name="ln-1558"></a>
<a name="ln-1559"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1560"></a>          <span class="c">! na</span>
<a name="ln-1561"></a>
<a name="ln-1562"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1563"></a>          <span class="c">! na</span>
<a name="ln-1564"></a>
<a name="ln-1565"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1566"></a>
<a name="ln-1567"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1568"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-1569"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">X</span>              <span class="c">! X value for current iterate</span>
<a name="ln-1570"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">Y</span>              <span class="c">! Y value for current iterate, F(X)=Y</span>
<a name="ln-1571"></a>
<a name="ln-1572"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1573"></a>          <span class="c">! na</span>
<a name="ln-1574"></a>
<a name="ln-1575"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1576"></a>          <span class="c">! na</span>
<a name="ln-1577"></a>
<a name="ln-1578"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1579"></a>          <span class="c">! na</span>
<a name="ln-1580"></a>
<a name="ln-1581"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1582"></a>          <span class="c">! na</span>
<a name="ln-1583"></a>
<a name="ln-1584"></a>          <span class="c">! FLOW:</span>
<a name="ln-1585"></a>
<a name="ln-1586"></a>  <span class="c">! Update min support point</span>
<a name="ln-1587"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">X</span> <span class="o">==</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">X</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1588"></a><span class="k">    </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-1589"></a>    <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1590"></a>  <span class="k">END IF</span>
<a name="ln-1591"></a>
<a name="ln-1592"></a>  <span class="c">! Update max support point</span>
<a name="ln-1593"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">X</span> <span class="o">==</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">X</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1594"></a><span class="k">    </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-1595"></a>    <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1596"></a>  <span class="k">END IF</span>
<a name="ln-1597"></a>
<a name="ln-1598"></a><span class="k">  RETURN</span>
<a name="ln-1599"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateMinMax</span>
<a name="ln-1600"></a>
<a name="ln-1601"></a>
<a name="ln-1602"></a><span class="k">SUBROUTINE </span><span class="n">UpdateBracket</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="p">)</span>
<a name="ln-1603"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1604"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-1605"></a>          <span class="c">!       DATE WRITTEN   March 2006</span>
<a name="ln-1606"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-1607"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1608"></a>
<a name="ln-1609"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1610"></a>          <span class="c">! This subroutine updates the lower/upper support points in the root finder data</span>
<a name="ln-1611"></a>          <span class="c">! with the current iterate (X,Y).</span>
<a name="ln-1612"></a>          <span class="c">!</span>
<a name="ln-1613"></a>
<a name="ln-1614"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1615"></a>         <span class="c">!</span>
<a name="ln-1616"></a>          <span class="c">! PRECONDITION:</span>
<a name="ln-1617"></a>          <span class="c">! - The current iterate (X,Y) must satisfy:</span>
<a name="ln-1618"></a>          <span class="c">!   MinPoint%X &lt;= LowerPoint%X &lt; X &lt; UpperPoint%X &lt;= MaxPoint%X</span>
<a name="ln-1619"></a>          <span class="c">! - RootFinderData%StatusFlag == iStatusNone</span>
<a name="ln-1620"></a>          <span class="c">!</span>
<a name="ln-1621"></a>          <span class="c">! POSTCONDITION:</span>
<a name="ln-1622"></a>          <span class="c">! - RootFinderData%LowerPoint possibly updated</span>
<a name="ln-1623"></a>          <span class="c">! - RootFinderData%UpperPoint possibly updated</span>
<a name="ln-1624"></a>          <span class="c">! - RootFinderData%StatusFlag possibly updated with:</span>
<a name="ln-1625"></a>          <span class="c">!   - iStatusWarningNonMonotonic</span>
<a name="ln-1626"></a>          <span class="c">!   - iStatusWarningSingular</span>
<a name="ln-1627"></a>          <span class="c">!</span>
<a name="ln-1628"></a>
<a name="ln-1629"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1630"></a>          <span class="c">! na</span>
<a name="ln-1631"></a>
<a name="ln-1632"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1633"></a>          <span class="c">! na</span>
<a name="ln-1634"></a>
<a name="ln-1635"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1636"></a>
<a name="ln-1637"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1638"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-1639"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">X</span>              <span class="c">! X value for current iterate</span>
<a name="ln-1640"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">Y</span>              <span class="c">! Y value for current iterate, F(X)=Y</span>
<a name="ln-1641"></a>
<a name="ln-1642"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1643"></a>          <span class="c">! na</span>
<a name="ln-1644"></a>
<a name="ln-1645"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1646"></a>          <span class="c">! na</span>
<a name="ln-1647"></a>
<a name="ln-1648"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1649"></a>          <span class="c">! na</span>
<a name="ln-1650"></a>
<a name="ln-1651"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1652"></a>          <span class="c">! na</span>
<a name="ln-1653"></a>
<a name="ln-1654"></a>          <span class="c">! FLOW:</span>
<a name="ln-1655"></a>
<a name="ln-1656"></a>  <span class="n">SelectSlope</span><span class="p">:</span> <span class="k">SELECT CASE</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">SlopeType</span> <span class="p">)</span>
<a name="ln-1657"></a>
<a name="ln-1658"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">iSlopeIncreasing</span> <span class="p">)</span>
<a name="ln-1659"></a>    <span class="c">! Update lower point</span>
<a name="ln-1660"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">Y</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1661"></a><span class="k">      IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1662"></a><span class="k">        </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1663"></a>        <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-1664"></a>        <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-1665"></a>      <span class="k">ELSE</span>
<a name="ln-1666"></a><span class="k">        IF</span> <span class="p">(</span> <span class="n">X</span> <span class="o">&gt;=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1667"></a><span class="k">          IF</span> <span class="p">(</span> <span class="n">Y</span> <span class="o">==</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">Y</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1668"></a><span class="k">            </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusWarningSingular</span>
<a name="ln-1669"></a>          <span class="k">ELSE IF</span> <span class="p">(</span> <span class="n">Y</span> <span class="o">&lt;</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">Y</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1670"></a><span class="k">            </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusWarningNonMonotonic</span>
<a name="ln-1671"></a>          <span class="k">END IF</span>
<a name="ln-1672"></a>          <span class="c">! Update lower point with current iterate</span>
<a name="ln-1673"></a>          <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-1674"></a>          <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-1675"></a>        <span class="k">ELSE</span>
<a name="ln-1676"></a>          <span class="c">! Should never happen if CheckLowerUpperBracket() is called before</span>
<a name="ln-1677"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;UpdateBracket: Current iterate is smaller than the lower bracket.&#39;</span><span class="p">)</span>
<a name="ln-1678"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1679"></a>            <span class="s1">&#39;UpdateBracket: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1680"></a>            <span class="s1">&#39;X=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1681"></a>            <span class="s1">&#39;Y=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-1682"></a>          <span class="p">)</span>
<a name="ln-1683"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1684"></a>            <span class="s1">&#39;UpdateBracket: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1685"></a>            <span class="s1">&#39;XLower=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1686"></a>            <span class="s1">&#39;YLower=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-1687"></a>          <span class="p">)</span>
<a name="ln-1688"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;UpdateBracket: Preceding error causes program termination.&#39;</span><span class="p">)</span>
<a name="ln-1689"></a>        <span class="k">END IF</span>
<a name="ln-1690"></a><span class="k">      END IF</span>
<a name="ln-1691"></a>
<a name="ln-1692"></a>    <span class="c">! Update upper point</span>
<a name="ln-1693"></a>    <span class="k">ELSE</span>
<a name="ln-1694"></a><span class="k">      IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1695"></a><span class="k">        </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1696"></a>        <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-1697"></a>        <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-1698"></a>      <span class="k">ELSE</span>
<a name="ln-1699"></a><span class="k">        IF</span> <span class="p">(</span> <span class="n">X</span> <span class="o">&lt;=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">X</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1700"></a><span class="k">          IF</span> <span class="p">(</span> <span class="n">Y</span> <span class="o">==</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">Y</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1701"></a><span class="k">            </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusWarningSingular</span>
<a name="ln-1702"></a>          <span class="k">ELSE IF</span> <span class="p">(</span> <span class="n">Y</span> <span class="o">&gt;</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">Y</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1703"></a><span class="k">            </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusWarningNonMonotonic</span>
<a name="ln-1704"></a>          <span class="k">END IF</span>
<a name="ln-1705"></a>          <span class="c">! Update upper point with current iterate</span>
<a name="ln-1706"></a>          <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-1707"></a>          <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-1708"></a>        <span class="k">ELSE</span>
<a name="ln-1709"></a>          <span class="c">! Should never happen if CheckLowerUpperBracket() is called before</span>
<a name="ln-1710"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;UpdateBracket: Current iterate is greater than the upper bracket.&#39;</span><span class="p">)</span>
<a name="ln-1711"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1712"></a>            <span class="s1">&#39;UpdateBracket: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1713"></a>            <span class="s1">&#39;X=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1714"></a>            <span class="s1">&#39;Y=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-1715"></a>          <span class="p">)</span>
<a name="ln-1716"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1717"></a>            <span class="s1">&#39;UpdateBracket: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1718"></a>            <span class="s1">&#39;XUpper=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">X</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1719"></a>            <span class="s1">&#39;YUpper=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-1720"></a>          <span class="p">)</span>
<a name="ln-1721"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;UpdateBracket: Preceding error causes program termination.&#39;</span><span class="p">)</span>
<a name="ln-1722"></a>        <span class="k">END IF</span>
<a name="ln-1723"></a><span class="k">      END IF</span>
<a name="ln-1724"></a><span class="k">    END IF</span>
<a name="ln-1725"></a>
<a name="ln-1726"></a>  <span class="c">! Monotone, decreasing function</span>
<a name="ln-1727"></a>  <span class="k">CASE</span> <span class="p">(</span> <span class="n">iSlopeDecreasing</span> <span class="p">)</span>
<a name="ln-1728"></a>    <span class="c">! Update lower point</span>
<a name="ln-1729"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">Y</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1730"></a><span class="k">      IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1731"></a><span class="k">        </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1732"></a>        <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-1733"></a>        <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-1734"></a>      <span class="k">ELSE</span>
<a name="ln-1735"></a><span class="k">        IF</span> <span class="p">(</span> <span class="n">X</span> <span class="o">&gt;=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1736"></a><span class="k">          IF</span> <span class="p">(</span> <span class="n">Y</span> <span class="o">==</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">Y</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1737"></a><span class="k">            </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusWarningSingular</span>
<a name="ln-1738"></a>          <span class="k">ELSE IF</span> <span class="p">(</span> <span class="n">Y</span> <span class="o">&gt;</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">Y</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1739"></a><span class="k">            </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusWarningNonMonotonic</span>
<a name="ln-1740"></a>          <span class="k">END IF</span>
<a name="ln-1741"></a>          <span class="c">! Update lower point with current iterate</span>
<a name="ln-1742"></a>          <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-1743"></a>          <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-1744"></a>        <span class="k">ELSE</span>
<a name="ln-1745"></a>          <span class="c">! Should never happen if CheckLowerUpperBracket() is called before</span>
<a name="ln-1746"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;UpdateBracket: Current iterate is smaller than the lower bracket.&#39;</span><span class="p">)</span>
<a name="ln-1747"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1748"></a>            <span class="s1">&#39;UpdateBracket: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1749"></a>            <span class="s1">&#39;X=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1750"></a>            <span class="s1">&#39;Y=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-1751"></a>          <span class="p">)</span>
<a name="ln-1752"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1753"></a>            <span class="s1">&#39;UpdateBracket: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1754"></a>            <span class="s1">&#39;XLower=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1755"></a>            <span class="s1">&#39;YLower=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-1756"></a>          <span class="p">)</span>
<a name="ln-1757"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;UpdateBracket: Preceding error causes program termination.&#39;</span><span class="p">)</span>
<a name="ln-1758"></a>        <span class="k">END IF</span>
<a name="ln-1759"></a><span class="k">      END IF</span>
<a name="ln-1760"></a>
<a name="ln-1761"></a>    <span class="c">! Update upper point</span>
<a name="ln-1762"></a>    <span class="k">ELSE</span>
<a name="ln-1763"></a><span class="k">      IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1764"></a><span class="k">        </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1765"></a>        <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-1766"></a>        <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-1767"></a>      <span class="k">ELSE</span>
<a name="ln-1768"></a><span class="k">        IF</span> <span class="p">(</span> <span class="n">X</span> <span class="o">&lt;=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">X</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1769"></a><span class="k">          IF</span> <span class="p">(</span> <span class="n">Y</span> <span class="o">==</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">Y</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1770"></a><span class="k">            </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusWarningSingular</span>
<a name="ln-1771"></a>          <span class="k">ELSE IF</span> <span class="p">(</span> <span class="n">Y</span> <span class="o">&lt;</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">Y</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1772"></a><span class="k">            </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">=</span> <span class="n">iStatusWarningNonMonotonic</span>
<a name="ln-1773"></a>          <span class="k">END IF</span>
<a name="ln-1774"></a>          <span class="c">! Update upper point with current iterate</span>
<a name="ln-1775"></a>          <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-1776"></a>          <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-1777"></a>        <span class="k">ELSE</span>
<a name="ln-1778"></a>          <span class="c">! Should never happen if CheckLowerUpperBracket() is called before</span>
<a name="ln-1779"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;UpdateBracket: Current iterate is greater than the upper bracket.&#39;</span><span class="p">)</span>
<a name="ln-1780"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1781"></a>            <span class="s1">&#39;UpdateBracket: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1782"></a>            <span class="s1">&#39;X=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1783"></a>            <span class="s1">&#39;Y=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-1784"></a>          <span class="p">)</span>
<a name="ln-1785"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1786"></a>            <span class="s1">&#39;UpdateBracket: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1787"></a>            <span class="s1">&#39;XUpper=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">X</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1788"></a>            <span class="s1">&#39;YUpper=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-1789"></a>          <span class="p">)</span>
<a name="ln-1790"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;UpdateBracket: Preceding error causes program termination.&#39;</span><span class="p">)</span>
<a name="ln-1791"></a>        <span class="k">END IF</span>
<a name="ln-1792"></a><span class="k">      END IF</span>
<a name="ln-1793"></a><span class="k">    END IF</span>
<a name="ln-1794"></a>
<a name="ln-1795"></a><span class="k">  CASE </span><span class="n">DEFAULT</span>
<a name="ln-1796"></a>    <span class="c">! Should never happen</span>
<a name="ln-1797"></a>    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;UpdateBracket: Invalid function slope specification. Valid choices are:&#39;</span><span class="p">)</span>
<a name="ln-1798"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;UpdateBracket: iSlopeIncreasing=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iSlopeIncreasing</span><span class="p">)))</span>
<a name="ln-1799"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;UpdateBracket: iSlopeDecreasing=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iSlopeDecreasing</span><span class="p">)))</span>
<a name="ln-1800"></a>    <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;UpdateBracket: Preceding error causes program termination.&#39;</span><span class="p">)</span>
<a name="ln-1801"></a>
<a name="ln-1802"></a>  <span class="k">END SELECT </span><span class="n">SelectSlope</span>
<a name="ln-1803"></a>
<a name="ln-1804"></a>  <span class="k">RETURN</span>
<a name="ln-1805"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateBracket</span>
<a name="ln-1806"></a>
<a name="ln-1807"></a>
<a name="ln-1808"></a><span class="k">SUBROUTINE </span><span class="n">UpdateHistory</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="p">)</span>
<a name="ln-1809"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1810"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-1811"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-1812"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-1813"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1814"></a>
<a name="ln-1815"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1816"></a>          <span class="c">! This subroutine updates the min/max support points in the root finder data.</span>
<a name="ln-1817"></a>          <span class="c">!</span>
<a name="ln-1818"></a>
<a name="ln-1819"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1820"></a>          <span class="c">!</span>
<a name="ln-1821"></a>          <span class="c">! PRECONDITION:</span>
<a name="ln-1822"></a>          <span class="c">! - The current iterate (X,Y) must be a valid iterate:</span>
<a name="ln-1823"></a>          <span class="c">!   MinPoint%X &lt;= LowerPoint%X &lt; X &lt; UpperPoint%X &lt;= MaxPoint%X</span>
<a name="ln-1824"></a>          <span class="c">!</span>
<a name="ln-1825"></a>          <span class="c">! POSTCONDITION:</span>
<a name="ln-1826"></a>          <span class="c">! - RootFinderData%History(:) updated with last 3 best iterates</span>
<a name="ln-1827"></a>          <span class="c">!</span>
<a name="ln-1828"></a>
<a name="ln-1829"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1830"></a>          <span class="c">! na</span>
<a name="ln-1831"></a>
<a name="ln-1832"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1833"></a>          <span class="c">! na</span>
<a name="ln-1834"></a>
<a name="ln-1835"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1836"></a>
<a name="ln-1837"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1838"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-1839"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">X</span>              <span class="c">! X value for current iterate</span>
<a name="ln-1840"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">Y</span>              <span class="c">! Y value for current iterate, F(X)=Y</span>
<a name="ln-1841"></a>
<a name="ln-1842"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1843"></a>          <span class="c">! na</span>
<a name="ln-1844"></a>
<a name="ln-1845"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1846"></a>          <span class="c">! na</span>
<a name="ln-1847"></a>
<a name="ln-1848"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1849"></a>          <span class="c">! na</span>
<a name="ln-1850"></a>
<a name="ln-1851"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1852"></a>  <span class="kt">INTEGER</span>                                 <span class="kd">::</span> <span class="n">NumHistory</span>
<a name="ln-1853"></a>
<a name="ln-1854"></a>          <span class="c">! FLOW:</span>
<a name="ln-1855"></a>
<a name="ln-1856"></a>  <span class="c">! Update history with best iterates so that:</span>
<a name="ln-1857"></a>  <span class="c">!   ABS(History(1)%Y) &lt;= ABS(History(2)%Y) &lt;= ABS(History(3)%Y)</span>
<a name="ln-1858"></a>  <span class="c">!</span>
<a name="ln-1859"></a>  <span class="c">! Note that the history points are sorted so that</span>
<a name="ln-1860"></a>  <span class="c">!   SIGN(History(1)%Y) = - SIGN(History(3)%Y)</span>
<a name="ln-1861"></a>  <span class="c">! to ensure that the history points bracket the candidate root.</span>
<a name="ln-1862"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(:)%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1863"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(:)%</span><span class="n">X</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1864"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(:)%</span><span class="n">Y</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1865"></a>
<a name="ln-1866"></a>  <span class="n">NumHistory</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1867"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1868"></a><span class="k">    </span><span class="n">NumHistory</span> <span class="o">=</span> <span class="n">NumHistory</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1869"></a>    <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="n">NumHistory</span><span class="p">)%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">DefinedFlag</span>
<a name="ln-1870"></a>    <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="n">NumHistory</span><span class="p">)%</span><span class="n">X</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span>
<a name="ln-1871"></a>    <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="n">NumHistory</span><span class="p">)%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-1872"></a>  <span class="k">END IF</span>
<a name="ln-1873"></a><span class="k">  IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1874"></a><span class="k">    </span><span class="n">NumHistory</span> <span class="o">=</span> <span class="n">NumHistory</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1875"></a>    <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="n">NumHistory</span><span class="p">)%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">DefinedFlag</span>
<a name="ln-1876"></a>    <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="n">NumHistory</span><span class="p">)%</span><span class="n">X</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">X</span>
<a name="ln-1877"></a>    <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="n">NumHistory</span><span class="p">)%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-1878"></a>  <span class="k">END IF</span>
<a name="ln-1879"></a><span class="k">  </span><span class="n">NumHistory</span> <span class="o">=</span> <span class="n">NumHistory</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1880"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="n">NumHistory</span><span class="p">)%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1881"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="n">NumHistory</span><span class="p">)%</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-1882"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="n">NumHistory</span><span class="p">)%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-1883"></a>
<a name="ln-1884"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">NumHistory</span> <span class="o">=</span> <span class="n">NumHistory</span>
<a name="ln-1885"></a>  <span class="k">CALL </span><span class="n">SortHistory</span><span class="p">(</span> <span class="n">NumHistory</span><span class="p">,</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span> <span class="p">)</span>
<a name="ln-1886"></a>
<a name="ln-1887"></a>  <span class="k">RETURN</span>
<a name="ln-1888"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateHistory</span>
<a name="ln-1889"></a>
<a name="ln-1890"></a>
<a name="ln-1891"></a><span class="k">SUBROUTINE </span><span class="n">UpdateRootFinder</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="p">)</span>
<a name="ln-1892"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1893"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-1894"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-1895"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-1896"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1897"></a>
<a name="ln-1898"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1899"></a>          <span class="c">! This subroutine updates the root finder internal data to account for</span>
<a name="ln-1900"></a>          <span class="c">! the current iterate (X,Y):</span>
<a name="ln-1901"></a>          <span class="c">! - Lower / Upper support points</span>
<a name="ln-1902"></a>          <span class="c">! - Increments for successive iterates</span>
<a name="ln-1903"></a>          <span class="c">! - Convergence rate</span>
<a name="ln-1904"></a>          <span class="c">!</span>
<a name="ln-1905"></a>
<a name="ln-1906"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1907"></a>          <span class="c">!</span>
<a name="ln-1908"></a>          <span class="c">! PRECONDITION:</span>
<a name="ln-1909"></a>          <span class="c">! - The current iterate (X,Y) must be a valid iterate:</span>
<a name="ln-1910"></a>          <span class="c">!   MinPoint%X &lt;= LowerPoint%X &lt; X &lt; UpperPoint%X &lt;= MaxPoint%X</span>
<a name="ln-1911"></a>          <span class="c">! - Invoke UpdateRootFinder() only if:</span>
<a name="ln-1912"></a>          <span class="c">!   - CheckRootFinderCandidate() returned TRUE</span>
<a name="ln-1913"></a>          <span class="c">!   - CheckNonSingularity() returned TRUE</span>
<a name="ln-1914"></a>          <span class="c">!   - CheckSlope() returned TRUE</span>
<a name="ln-1915"></a>          <span class="c">!</span>
<a name="ln-1916"></a>          <span class="c">! POSTCONDITION:</span>
<a name="ln-1917"></a>          <span class="c">! - RootFinderData%LowerPoint possibly updated</span>
<a name="ln-1918"></a>          <span class="c">! - RootFinderData%UpperPoint possibly updated</span>
<a name="ln-1919"></a>          <span class="c">! - RootFinderData%CurrentPoint updated with current iterate (X,Y)</span>
<a name="ln-1920"></a>          <span class="c">! - RootFinderData%History(:) updated with last 3 best iterates</span>
<a name="ln-1921"></a>          <span class="c">! - RootFinderData%Increment updated</span>
<a name="ln-1922"></a>          <span class="c">! - RootFinderData%ConvergenceRate updated</span>
<a name="ln-1923"></a>          <span class="c">!</span>
<a name="ln-1924"></a>
<a name="ln-1925"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1926"></a>          <span class="c">! na</span>
<a name="ln-1927"></a>
<a name="ln-1928"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1929"></a>          <span class="c">! na</span>
<a name="ln-1930"></a>
<a name="ln-1931"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1932"></a>
<a name="ln-1933"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1934"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-1935"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">X</span>              <span class="c">! X value for current iterate</span>
<a name="ln-1936"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">Y</span>              <span class="c">! Y value for current iterate, F(X)=Y</span>
<a name="ln-1937"></a>
<a name="ln-1938"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1939"></a>          <span class="c">! na</span>
<a name="ln-1940"></a>
<a name="ln-1941"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1942"></a>          <span class="c">! na</span>
<a name="ln-1943"></a>
<a name="ln-1944"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1945"></a>          <span class="c">! na</span>
<a name="ln-1946"></a>
<a name="ln-1947"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1948"></a>          <span class="c">! na</span>
<a name="ln-1949"></a>
<a name="ln-1950"></a>          <span class="c">! FLOW:</span>
<a name="ln-1951"></a>
<a name="ln-1952"></a>
<a name="ln-1953"></a>  <span class="c">! Update history with best iterates so that:</span>
<a name="ln-1954"></a>  <span class="c">!   ABS(History(1)%Y) &lt;= ABS(History(2)%Y) &lt;= ABS(History(3)%Y)</span>
<a name="ln-1955"></a>  <span class="c">!</span>
<a name="ln-1956"></a>  <span class="c">! Note that we must update the history before updating the lower/upper points</span>
<a name="ln-1957"></a>  <span class="k">CALL </span><span class="n">UpdateHistory</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="p">)</span>
<a name="ln-1958"></a>
<a name="ln-1959"></a>  <span class="c">! Update lower and upper points</span>
<a name="ln-1960"></a>  <span class="k">CALL </span><span class="n">UpdateBracket</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="p">)</span>
<a name="ln-1961"></a>
<a name="ln-1962"></a>  <span class="c">! Update increments and convergence rate</span>
<a name="ln-1963"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1964"></a><span class="k">    </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">Increment</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1965"></a>    <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Increment</span><span class="p">%</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentPoint</span><span class="p">%</span><span class="n">X</span>
<a name="ln-1966"></a>    <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Increment</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">-</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentPoint</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-1967"></a>
<a name="ln-1968"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentPoint</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1969"></a>      <span class="c">! NOTE: Should be smaller than one for convergent process</span>
<a name="ln-1970"></a>      <span class="n">RootFinderData</span><span class="p">%</span><span class="n">ConvergenceRate</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">/</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentPoint</span><span class="p">%</span><span class="n">Y</span><span class="p">)</span>
<a name="ln-1971"></a>    <span class="k">ELSE</span>
<a name="ln-1972"></a>      <span class="c">! NOTE: Should never happen</span>
<a name="ln-1973"></a>      <span class="n">RootFinderData</span><span class="p">%</span><span class="n">ConvergenceRate</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0d0</span>
<a name="ln-1974"></a>    <span class="k">END IF</span>
<a name="ln-1975"></a><span class="k">  END IF</span>
<a name="ln-1976"></a>
<a name="ln-1977"></a>  <span class="c">! Finally update CurrentPoint (must be done last)</span>
<a name="ln-1978"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1979"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentPoint</span><span class="p">%</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>
<a name="ln-1980"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>
<a name="ln-1981"></a>
<a name="ln-1982"></a>  <span class="k">RETURN</span>
<a name="ln-1983"></a>
<a name="ln-1984"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateRootFinder</span>
<a name="ln-1985"></a>
<a name="ln-1986"></a>
<a name="ln-1987"></a><span class="k">SUBROUTINE </span><span class="n">SortHistory</span><span class="p">(</span> <span class="n">N</span><span class="p">,</span> <span class="n">History</span> <span class="p">)</span>
<a name="ln-1988"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1989"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-1990"></a>          <span class="c">!       DATE WRITTEN   March 2006</span>
<a name="ln-1991"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-1992"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1993"></a>
<a name="ln-1994"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1995"></a>          <span class="c">! This subroutine orders the N points in the history array in increasing</span>
<a name="ln-1996"></a>          <span class="c">! order of ABS(Y) values.</span>
<a name="ln-1997"></a>          <span class="c">!</span>
<a name="ln-1998"></a>
<a name="ln-1999"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2000"></a>          <span class="c">! na</span>
<a name="ln-2001"></a>
<a name="ln-2002"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2003"></a>          <span class="c">! na</span>
<a name="ln-2004"></a>
<a name="ln-2005"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2006"></a>          <span class="c">! na</span>
<a name="ln-2007"></a>
<a name="ln-2008"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2009"></a>
<a name="ln-2010"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2011"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">N</span>           <span class="c">! Number of points to sort in history array</span>
<a name="ln-2012"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">PointType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">History</span><span class="p">(:)</span>  <span class="c">! Array of PointType variables. At least N of them</span>
<a name="ln-2013"></a>
<a name="ln-2014"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2015"></a>          <span class="c">! na</span>
<a name="ln-2016"></a>
<a name="ln-2017"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2018"></a>          <span class="c">! na</span>
<a name="ln-2019"></a>
<a name="ln-2020"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2021"></a>          <span class="c">! na</span>
<a name="ln-2022"></a>
<a name="ln-2023"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2024"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">I</span><span class="p">,</span> <span class="n">J</span>
<a name="ln-2025"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">XTemp</span><span class="p">,</span> <span class="n">YTemp</span>
<a name="ln-2026"></a>          <span class="c">! FLOW:</span>
<a name="ln-2027"></a>
<a name="ln-2028"></a>  <span class="c">! Nothing to do if only one point stored in history</span>
<a name="ln-2029"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">N</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2030"></a><span class="k">    RETURN</span>
<a name="ln-2031"></a><span class="k">  END IF</span>
<a name="ln-2032"></a>
<a name="ln-2033"></a><span class="k">  DO </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2034"></a>    <span class="k">DO </span><span class="n">J</span><span class="o">=</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span>
<a name="ln-2035"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="n">History</span><span class="p">(</span><span class="n">J</span><span class="p">)%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2036"></a>        <span class="c">! Swap I and J elements</span>
<a name="ln-2037"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">History</span><span class="p">(</span><span class="n">J</span><span class="p">)%</span><span class="n">Y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">History</span><span class="p">(</span><span class="n">I</span><span class="p">)%</span><span class="n">Y</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2038"></a><span class="k">          </span><span class="n">XTemp</span> <span class="o">=</span> <span class="n">History</span><span class="p">(</span><span class="n">I</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-2039"></a>          <span class="n">YTemp</span> <span class="o">=</span> <span class="n">History</span><span class="p">(</span><span class="n">I</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-2040"></a>          <span class="n">History</span><span class="p">(</span><span class="n">I</span><span class="p">)%</span><span class="n">X</span> <span class="o">=</span> <span class="n">History</span><span class="p">(</span><span class="n">J</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-2041"></a>          <span class="n">History</span><span class="p">(</span><span class="n">I</span><span class="p">)%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">History</span><span class="p">(</span><span class="n">J</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-2042"></a>          <span class="n">History</span><span class="p">(</span><span class="n">J</span><span class="p">)%</span><span class="n">X</span> <span class="o">=</span> <span class="n">XTemp</span>
<a name="ln-2043"></a>          <span class="n">History</span><span class="p">(</span><span class="n">J</span><span class="p">)%</span><span class="n">Y</span> <span class="o">=</span> <span class="n">YTemp</span>
<a name="ln-2044"></a>        <span class="k">END IF</span>
<a name="ln-2045"></a><span class="k">      END IF</span>
<a name="ln-2046"></a><span class="k">    END DO</span>
<a name="ln-2047"></a><span class="k">  END DO</span>
<a name="ln-2048"></a>
<a name="ln-2049"></a><span class="k">  RETURN</span>
<a name="ln-2050"></a><span class="k">END SUBROUTINE </span><span class="n">SortHistory</span>
<a name="ln-2051"></a>
<a name="ln-2052"></a>
<a name="ln-2053"></a><span class="k">SUBROUTINE </span><span class="n">AdvanceRootFinder</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-2054"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2055"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-2056"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-2057"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-2058"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2059"></a>
<a name="ln-2060"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2061"></a>          <span class="c">! This subroutine computes the next candidate value based on the information available so far.</span>
<a name="ln-2062"></a>          <span class="c">! Stores new value into RootFinderData%XCandidate</span>
<a name="ln-2063"></a>          <span class="c">!</span>
<a name="ln-2064"></a>          <span class="c">! PRECONDITION:</span>
<a name="ln-2065"></a>          <span class="c">! na</span>
<a name="ln-2066"></a>          <span class="c">!</span>
<a name="ln-2067"></a>          <span class="c">! POSTCONDITION:</span>
<a name="ln-2068"></a>          <span class="c">! - LowerPoint%X &lt; XCandidate &lt; UpperPoint%X</span>
<a name="ln-2069"></a>          <span class="c">! - RootFinderData%CurrentMethodType update with current solution method.</span>
<a name="ln-2070"></a>          <span class="c">!</span>
<a name="ln-2071"></a>
<a name="ln-2072"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2073"></a>          <span class="c">! The subroutine first attempts to bracket the root within a lower and upper point.</span>
<a name="ln-2074"></a>          <span class="c">! Once it is bracketed, then we use the specified solution methods (Bisection,</span>
<a name="ln-2075"></a>          <span class="c">! False position, Secant and Brent) to compute the next candidate.</span>
<a name="ln-2076"></a>          <span class="c">!</span>
<a name="ln-2077"></a>
<a name="ln-2078"></a>
<a name="ln-2079"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2080"></a>          <span class="c">! na</span>
<a name="ln-2081"></a>
<a name="ln-2082"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2083"></a>          <span class="c">! na</span>
<a name="ln-2084"></a>
<a name="ln-2085"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2086"></a>
<a name="ln-2087"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2088"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-2089"></a>
<a name="ln-2090"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2091"></a>          <span class="c">! na</span>
<a name="ln-2092"></a>
<a name="ln-2093"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2094"></a>          <span class="c">! na</span>
<a name="ln-2095"></a>
<a name="ln-2096"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2097"></a>          <span class="c">! na</span>
<a name="ln-2098"></a>
<a name="ln-2099"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2100"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">XNext</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2101"></a>
<a name="ln-2102"></a>          <span class="c">! FLOW:</span>
<a name="ln-2103"></a>
<a name="ln-2104"></a>  <span class="c">!----------------------------------------------------------------------------</span>
<a name="ln-2105"></a>  <span class="c">! First attempt to bracket root between a lower point and an upper point.</span>
<a name="ln-2106"></a>  <span class="c">!----------------------------------------------------------------------------</span>
<a name="ln-2107"></a>
<a name="ln-2108"></a>  <span class="c">! Detect the lower bracket</span>
<a name="ln-2109"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2110"></a><span class="k">    </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentMethodType</span> <span class="o">=</span> <span class="n">iMethodBracket</span>
<a name="ln-2111"></a>    <span class="c">! If we have 2 points already, try to detect lower point using the Secant formula</span>
<a name="ln-2112"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">BracketRoot</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">XNext</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2113"></a><span class="k">        </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="n">XNext</span>
<a name="ln-2114"></a>    <span class="k">ELSE</span>
<a name="ln-2115"></a><span class="k">      IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2116"></a><span class="k">        </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">%</span><span class="n">X</span>
<a name="ln-2117"></a>      <span class="k">ELSE</span>
<a name="ln-2118"></a>        <span class="c">! Should never happen</span>
<a name="ln-2119"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;AdvanceRootFinder: Cannot find lower bracket.&#39;</span><span class="p">)</span>
<a name="ln-2120"></a>      <span class="k">END IF</span>
<a name="ln-2121"></a><span class="k">    END IF</span>
<a name="ln-2122"></a>
<a name="ln-2123"></a>  <span class="c">! Detect the upper bracket</span>
<a name="ln-2124"></a>  <span class="k">ELSE IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2125"></a><span class="k">    </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentMethodType</span> <span class="o">=</span> <span class="n">iMethodBracket</span>
<a name="ln-2126"></a>    <span class="c">! If we have 2 points already, try to detect upper point using the Secant formula</span>
<a name="ln-2127"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">BracketRoot</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">XNext</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2128"></a><span class="k">        </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="n">XNext</span>
<a name="ln-2129"></a>    <span class="k">ELSE</span>
<a name="ln-2130"></a><span class="k">      IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2131"></a><span class="k">        </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">%</span><span class="n">X</span>
<a name="ln-2132"></a>      <span class="k">ELSE</span>
<a name="ln-2133"></a>        <span class="c">! Should never happen</span>
<a name="ln-2134"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;AdvanceRootFinder: Cannot find upper bracket.&#39;</span><span class="p">)</span>
<a name="ln-2135"></a>      <span class="k">END IF</span>
<a name="ln-2136"></a><span class="k">    END IF</span>
<a name="ln-2137"></a>
<a name="ln-2138"></a>
<a name="ln-2139"></a>  <span class="c">!----------------------------------------------------------------------------</span>
<a name="ln-2140"></a>  <span class="c">! Root finding can start ...</span>
<a name="ln-2141"></a>  <span class="c">!</span>
<a name="ln-2142"></a>  <span class="c">! Assumptions:</span>
<a name="ln-2143"></a>  <span class="c">! - the lower and upper support points are defined.</span>
<a name="ln-2144"></a>  <span class="c">! - the increments are defined (at least 2 history points are available)</span>
<a name="ln-2145"></a>  <span class="c">!----------------------------------------------------------------------------</span>
<a name="ln-2146"></a>  <span class="k">ELSE</span>
<a name="ln-2147"></a><span class="k">    </span><span class="n">SelectRecoveryMethod</span><span class="p">:</span> <span class="k">SELECT CASE</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="p">)</span>
<a name="ln-2148"></a>    <span class="k">CASE</span> <span class="p">(</span> <span class="n">iStatusOKRoundOff</span> <span class="p">)</span>
<a name="ln-2149"></a>      <span class="c">! Should never happen if we exit the root finder upon detecting round-off condition</span>
<a name="ln-2150"></a>      <span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="n">BisectionMethod</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">)</span>
<a name="ln-2151"></a>
<a name="ln-2152"></a>    <span class="k">CASE</span> <span class="p">(</span> <span class="n">iStatusWarningSingular</span><span class="p">,</span> <span class="n">iStatusWarningNonMonotonic</span> <span class="p">)</span>
<a name="ln-2153"></a>      <span class="c">! Following local singularity or non-monotonicity warnings we attempt</span>
<a name="ln-2154"></a>      <span class="c">! to recover with the false position method to avoid running into trouble</span>
<a name="ln-2155"></a>      <span class="c">! because the latest iterate did nt produce any improvement compared to</span>
<a name="ln-2156"></a>      <span class="c">! the previous lower and upper brackets.</span>
<a name="ln-2157"></a>      <span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="n">FalsePositionMethod</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">)</span>
<a name="ln-2158"></a>
<a name="ln-2159"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2160"></a>      <span class="c">! Assuming that the root is bracketed between the lower and upper points,</span>
<a name="ln-2161"></a>      <span class="c">! we execute the requested solution method to produce the next candidate value</span>
<a name="ln-2162"></a>      <span class="c">! for the root.</span>
<a name="ln-2163"></a>      <span class="n">SelectMethod</span><span class="p">:</span> <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">Controls</span><span class="p">%</span><span class="n">MethodType</span><span class="p">)</span>
<a name="ln-2164"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">iMethodBisection</span><span class="p">)</span>
<a name="ln-2165"></a>        <span class="c">! Bisection method (aka interval halving)</span>
<a name="ln-2166"></a>        <span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="n">BisectionMethod</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">)</span>
<a name="ln-2167"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">iMethodFalsePosition</span><span class="p">)</span>
<a name="ln-2168"></a>        <span class="c">! False position method (aka regula falsi)</span>
<a name="ln-2169"></a>        <span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="n">FalsePositionMethod</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">)</span>
<a name="ln-2170"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">iMethodSecant</span><span class="p">)</span>
<a name="ln-2171"></a>        <span class="c">! Secant method</span>
<a name="ln-2172"></a>        <span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="n">SecantMethod</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">)</span>
<a name="ln-2173"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">iMethodBrent</span><span class="p">)</span>
<a name="ln-2174"></a>        <span class="c">! Brent method</span>
<a name="ln-2175"></a>        <span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span> <span class="o">=</span> <span class="n">BrentMethod</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">)</span>
<a name="ln-2176"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2177"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;AdvanceRootFinder: Invalid solution method specification. Valid choices are:&#39;</span> <span class="p">)</span>
<a name="ln-2178"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;AdvanceRootFinder: iMethodBisection=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iMethodBisection</span><span class="p">)))</span>
<a name="ln-2179"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;AdvanceRootFinder: iMethodFalsePosition=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iMethodFalsePosition</span><span class="p">)))</span>
<a name="ln-2180"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;AdvanceRootFinder: iMethodSecant=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iMethodSecant</span><span class="p">)))</span>
<a name="ln-2181"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;AdvanceRootFinder: iMethodBrent=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">iMethodBrent</span><span class="p">)))</span>
<a name="ln-2182"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;AdvanceRootFinder: Preceding error causes program termination.&#39;</span><span class="p">)</span>
<a name="ln-2183"></a>      <span class="k">END SELECT </span><span class="n">SelectMethod</span>
<a name="ln-2184"></a>    <span class="k">END SELECT </span><span class="n">SelectRecoveryMethod</span>
<a name="ln-2185"></a>  <span class="k">END IF</span>
<a name="ln-2186"></a>
<a name="ln-2187"></a><span class="k">  RETURN</span>
<a name="ln-2188"></a><span class="k">END SUBROUTINE </span><span class="n">AdvanceRootFinder</span>
<a name="ln-2189"></a>
<a name="ln-2190"></a>
<a name="ln-2191"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">BracketRoot</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">XNext</span> <span class="p">)</span>
<a name="ln-2192"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2193"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-2194"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-2195"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-2196"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2197"></a>
<a name="ln-2198"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2199"></a>          <span class="c">! This function attempts to compute a new point that will bracket the root</span>
<a name="ln-2200"></a>          <span class="c">! using the secant formula to take advantage of the slope between the last 2</span>
<a name="ln-2201"></a>          <span class="c">! iterates.</span>
<a name="ln-2202"></a>          <span class="c">!</span>
<a name="ln-2203"></a>          <span class="c">! Returns TRUE if successfully computed a new bracket in XNext.</span>
<a name="ln-2204"></a>          <span class="c">! Else returns FASLE and does not update the XNext argument.</span>
<a name="ln-2205"></a>          <span class="c">!</span>
<a name="ln-2206"></a>          <span class="c">! Should only be used while in braketing mode (iMethodBracket).</span>
<a name="ln-2207"></a>          <span class="c">! When the lower and upper brackets are detected then the FUNCTION SecantMethod</span>
<a name="ln-2208"></a>          <span class="c">! should be used instead.</span>
<a name="ln-2209"></a>          <span class="c">!</span>
<a name="ln-2210"></a>          <span class="c">! PRECONDITION:</span>
<a name="ln-2211"></a>          <span class="c">! na</span>
<a name="ln-2212"></a>          <span class="c">!</span>
<a name="ln-2213"></a>          <span class="c">! POSTCONDITION:</span>
<a name="ln-2214"></a>          <span class="c">! - MinPoint%X &lt;= XNext &lt;= MaxPoint%X</span>
<a name="ln-2215"></a>          <span class="c">! - LowerPoint%X &lt; XNext &lt; UpperPoint%X</span>
<a name="ln-2216"></a>          <span class="c">!</span>
<a name="ln-2217"></a>
<a name="ln-2218"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2219"></a>          <span class="c">! na</span>
<a name="ln-2220"></a>
<a name="ln-2221"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2222"></a>          <span class="c">! na</span>
<a name="ln-2223"></a>
<a name="ln-2224"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2225"></a>          <span class="c">! na</span>
<a name="ln-2226"></a>
<a name="ln-2227"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2228"></a>
<a name="ln-2229"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2230"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-2231"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">XNext</span>          <span class="c">! Next value</span>
<a name="ln-2232"></a>
<a name="ln-2233"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-2234"></a>          <span class="c">! na</span>
<a name="ln-2235"></a>
<a name="ln-2236"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2237"></a>          <span class="c">! na</span>
<a name="ln-2238"></a>
<a name="ln-2239"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2240"></a>          <span class="c">! na</span>
<a name="ln-2241"></a>
<a name="ln-2242"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2243"></a>          <span class="c">! na</span>
<a name="ln-2244"></a>
<a name="ln-2245"></a>          <span class="c">! FLOW:</span>
<a name="ln-2246"></a>
<a name="ln-2247"></a>  <span class="c">! Cannot use Secant method unless there are at least 2 points</span>
<a name="ln-2248"></a>  <span class="c">! Also do not use Secant method more than once, i.e. NumHistory==3, in order to avoid</span>
<a name="ln-2249"></a>  <span class="c">! the pathological case whereby the secant method always comes up short of bracketting</span>
<a name="ln-2250"></a>  <span class="c">! the root because the function slope flattens as we come closer to either min/max point.</span>
<a name="ln-2251"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">NumHistory</span> <span class="o">/=</span> <span class="mi">2</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2252"></a><span class="k">    </span><span class="n">BracketRoot</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2253"></a>    <span class="k">RETURN</span>
<a name="ln-2254"></a><span class="k">  END IF</span>
<a name="ln-2255"></a>
<a name="ln-2256"></a>  <span class="c">! Should not use Secant method if the last 2 points produced a warning</span>
<a name="ln-2257"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">==</span> <span class="n">iStatusWarningSingular</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2258"></a>       <span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="o">==</span> <span class="n">iStatusWarningNonMonotonic</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2259"></a><span class="k">    </span><span class="n">BracketRoot</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2260"></a>    <span class="k">RETURN</span>
<a name="ln-2261"></a><span class="k">  END IF</span>
<a name="ln-2262"></a>
<a name="ln-2263"></a>  <span class="c">! Try to compute next root candidate using Secant formula</span>
<a name="ln-2264"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">SecantFormula</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">XNext</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2265"></a>
<a name="ln-2266"></a>    <span class="c">! Check that next candidate is consistent with min/max constraints and lower/upper brackets</span>
<a name="ln-2267"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">CheckRootFinderCandidate</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">XNext</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2268"></a><span class="k">      </span><span class="n">BracketRoot</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2269"></a>      <span class="k">RETURN</span>
<a name="ln-2270"></a><span class="k">    END IF</span>
<a name="ln-2271"></a><span class="k">  END IF</span>
<a name="ln-2272"></a>
<a name="ln-2273"></a><span class="k">  </span><span class="n">BracketRoot</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2274"></a>
<a name="ln-2275"></a>  <span class="k">RETURN</span>
<a name="ln-2276"></a><span class="k">END FUNCTION </span><span class="n">BracketRoot</span>
<a name="ln-2277"></a>
<a name="ln-2278"></a>
<a name="ln-2279"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">BisectionMethod</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-2280"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2281"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-2282"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-2283"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-2284"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2285"></a>
<a name="ln-2286"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2287"></a>          <span class="c">! This function computes the next iterate using the bisection method (aka interval halving).</span>
<a name="ln-2288"></a>          <span class="c">! Convergence rate is at best linear.</span>
<a name="ln-2289"></a>          <span class="c">!</span>
<a name="ln-2290"></a>          <span class="c">! PRECONDITION:</span>
<a name="ln-2291"></a>          <span class="c">! Lower and upper points must be defined and distinct.</span>
<a name="ln-2292"></a>          <span class="c">!</span>
<a name="ln-2293"></a>          <span class="c">! POSTCONDITION:</span>
<a name="ln-2294"></a>          <span class="c">! - LowerPoint%X &lt; XCandidate &lt; UpperPoint%X</span>
<a name="ln-2295"></a>          <span class="c">! - RootFinderData%CurrentMethodType update with current solution method.</span>
<a name="ln-2296"></a>          <span class="c">!</span>
<a name="ln-2297"></a>
<a name="ln-2298"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2299"></a>          <span class="c">! na</span>
<a name="ln-2300"></a>
<a name="ln-2301"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2302"></a>          <span class="c">! na</span>
<a name="ln-2303"></a>
<a name="ln-2304"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2305"></a>          <span class="c">! na</span>
<a name="ln-2306"></a>
<a name="ln-2307"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2308"></a>
<a name="ln-2309"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2310"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-2311"></a>
<a name="ln-2312"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-2313"></a>          <span class="c">! na</span>
<a name="ln-2314"></a>
<a name="ln-2315"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2316"></a>          <span class="c">! na</span>
<a name="ln-2317"></a>
<a name="ln-2318"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2319"></a>          <span class="c">! na</span>
<a name="ln-2320"></a>
<a name="ln-2321"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2322"></a>          <span class="c">! na</span>
<a name="ln-2323"></a>
<a name="ln-2324"></a>          <span class="c">! FLOW:</span>
<a name="ln-2325"></a>  <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentMethodType</span> <span class="o">=</span> <span class="n">iMethodBisection</span>
<a name="ln-2326"></a>  <span class="n">BisectionMethod</span> <span class="o">=</span> <span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span> <span class="o">+</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">X</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-2327"></a>
<a name="ln-2328"></a>  <span class="k">RETURN</span>
<a name="ln-2329"></a><span class="k">END FUNCTION </span><span class="n">BisectionMethod</span>
<a name="ln-2330"></a>
<a name="ln-2331"></a>
<a name="ln-2332"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">FalsePositionMethod</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-2333"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2334"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-2335"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-2336"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-2337"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2338"></a>
<a name="ln-2339"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2340"></a>          <span class="c">! This function computes the next iterate using the false position method (aka regula falsi).</span>
<a name="ln-2341"></a>          <span class="c">! If new iterate does not lie within the lower and upper points then</span>
<a name="ln-2342"></a>          <span class="c">! the Bisection method is used instead.</span>
<a name="ln-2343"></a>          <span class="c">!</span>
<a name="ln-2344"></a>          <span class="c">! Convergence rate is at best superlinear.</span>
<a name="ln-2345"></a>          <span class="c">!</span>
<a name="ln-2346"></a>          <span class="c">! PRECONDITION:</span>
<a name="ln-2347"></a>          <span class="c">! Lower and upper points must be defined and distinct.</span>
<a name="ln-2348"></a>          <span class="c">!</span>
<a name="ln-2349"></a>          <span class="c">! POSTCONDITION:</span>
<a name="ln-2350"></a>          <span class="c">! - LowerPoint%X &lt; XCandidate &lt; UpperPoint%X</span>
<a name="ln-2351"></a>          <span class="c">! - RootFinderData%CurrentMethodType update with current solution method.</span>
<a name="ln-2352"></a>          <span class="c">!</span>
<a name="ln-2353"></a>
<a name="ln-2354"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2355"></a>          <span class="c">! na</span>
<a name="ln-2356"></a>
<a name="ln-2357"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2358"></a>          <span class="c">! na</span>
<a name="ln-2359"></a>
<a name="ln-2360"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2361"></a>          <span class="c">! na</span>
<a name="ln-2362"></a>
<a name="ln-2363"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2364"></a>
<a name="ln-2365"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2366"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-2367"></a>
<a name="ln-2368"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-2369"></a>          <span class="c">! na</span>
<a name="ln-2370"></a>
<a name="ln-2371"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2372"></a>          <span class="c">! na</span>
<a name="ln-2373"></a>
<a name="ln-2374"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2375"></a>          <span class="c">! na</span>
<a name="ln-2376"></a>
<a name="ln-2377"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2378"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">XCandidate</span>
<a name="ln-2379"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">Num</span><span class="p">,</span> <span class="n">Den</span>
<a name="ln-2380"></a>
<a name="ln-2381"></a>          <span class="c">! FLOW:</span>
<a name="ln-2382"></a>
<a name="ln-2383"></a>  <span class="n">Num</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">X</span> <span class="o">-</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span>
<a name="ln-2384"></a>  <span class="n">Den</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">-</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-2385"></a>
<a name="ln-2386"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">Den</span> <span class="o">/=</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2387"></a>    <span class="c">! False position method</span>
<a name="ln-2388"></a>    <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentMethodType</span> <span class="o">=</span> <span class="n">iMethodFalsePosition</span>
<a name="ln-2389"></a>    <span class="n">XCandidate</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">X</span> <span class="o">-</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">*</span> <span class="n">Num</span><span class="o">/</span><span class="n">Den</span>
<a name="ln-2390"></a>
<a name="ln-2391"></a>    <span class="c">! Check that new candidate is within range and brackets</span>
<a name="ln-2392"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">CheckRootFinderCandidate</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">,</span> <span class="n">XCandidate</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2393"></a>      <span class="c">! Recovery method</span>
<a name="ln-2394"></a>      <span class="n">XCandidate</span> <span class="o">=</span> <span class="n">BisectionMethod</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">)</span>
<a name="ln-2395"></a>    <span class="k">END IF</span>
<a name="ln-2396"></a><span class="k">  ELSE</span>
<a name="ln-2397"></a>    <span class="c">! Recovery method</span>
<a name="ln-2398"></a>    <span class="n">XCandidate</span> <span class="o">=</span> <span class="n">BisectionMethod</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">)</span>
<a name="ln-2399"></a>  <span class="k">END IF</span>
<a name="ln-2400"></a>
<a name="ln-2401"></a><span class="k">  </span><span class="n">FalsePositionMethod</span> <span class="o">=</span> <span class="n">XCandidate</span>
<a name="ln-2402"></a>  <span class="k">RETURN</span>
<a name="ln-2403"></a><span class="k">END FUNCTION </span><span class="n">FalsePositionMethod</span>
<a name="ln-2404"></a>
<a name="ln-2405"></a>
<a name="ln-2406"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">SecantMethod</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-2407"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2408"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-2409"></a>          <span class="c">!       DATE WRITTEN   February 2006</span>
<a name="ln-2410"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-2411"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2412"></a>
<a name="ln-2413"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2414"></a>          <span class="c">! This function computes the next iterate using the secant method.</span>
<a name="ln-2415"></a>          <span class="c">! If new iterate does not lie within the lower and upper points then</span>
<a name="ln-2416"></a>          <span class="c">! the false position method is used instead.</span>
<a name="ln-2417"></a>          <span class="c">!</span>
<a name="ln-2418"></a>          <span class="c">! Convergence rate is at best superlinear.</span>
<a name="ln-2419"></a>          <span class="c">!</span>
<a name="ln-2420"></a>          <span class="c">! PRECONDITION:</span>
<a name="ln-2421"></a>          <span class="c">! There must be at least 2 history points so that RootFinderData%Increment is defined.</span>
<a name="ln-2422"></a>          <span class="c">! See FUNCTION SecantFormula.</span>
<a name="ln-2423"></a>          <span class="c">!</span>
<a name="ln-2424"></a>          <span class="c">! POSTCONDITION:</span>
<a name="ln-2425"></a>          <span class="c">! - LowerPoint%X &lt; XCandidate &lt; UpperPoint%X</span>
<a name="ln-2426"></a>          <span class="c">! - RootFinderData%CurrentMethodType update with current solution method.</span>
<a name="ln-2427"></a>          <span class="c">!</span>
<a name="ln-2428"></a>
<a name="ln-2429"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2430"></a>          <span class="c">! na</span>
<a name="ln-2431"></a>
<a name="ln-2432"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2433"></a>          <span class="c">! na</span>
<a name="ln-2434"></a>
<a name="ln-2435"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2436"></a>          <span class="c">! na</span>
<a name="ln-2437"></a>
<a name="ln-2438"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2439"></a>
<a name="ln-2440"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2441"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-2442"></a>
<a name="ln-2443"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-2444"></a>          <span class="c">! na</span>
<a name="ln-2445"></a>
<a name="ln-2446"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2447"></a>          <span class="c">! na</span>
<a name="ln-2448"></a>
<a name="ln-2449"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2450"></a>          <span class="c">! na</span>
<a name="ln-2451"></a>
<a name="ln-2452"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2453"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">XCandidate</span>
<a name="ln-2454"></a>
<a name="ln-2455"></a>          <span class="c">! FLOW:</span>
<a name="ln-2456"></a>
<a name="ln-2457"></a>  <span class="c">! Recover with false position</span>
<a name="ln-2458"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">SecantFormula</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">,</span> <span class="n">XCandidate</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2459"></a>    <span class="c">! Secant method</span>
<a name="ln-2460"></a>    <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentMethodType</span> <span class="o">=</span> <span class="n">iMethodSecant</span>
<a name="ln-2461"></a>
<a name="ln-2462"></a>    <span class="c">! Check that new candidate is within range and brackets</span>
<a name="ln-2463"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">CheckRootFinderCandidate</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">,</span> <span class="n">XCandidate</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2464"></a>      <span class="c">! Recovery method</span>
<a name="ln-2465"></a>      <span class="n">XCandidate</span> <span class="o">=</span> <span class="n">FalsePositionMethod</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">)</span>
<a name="ln-2466"></a>    <span class="k">END IF</span>
<a name="ln-2467"></a><span class="k">  ELSE</span>
<a name="ln-2468"></a>    <span class="c">! Recovery method</span>
<a name="ln-2469"></a>    <span class="n">XCandidate</span> <span class="o">=</span> <span class="n">FalsePositionMethod</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">)</span>
<a name="ln-2470"></a>  <span class="k">END IF</span>
<a name="ln-2471"></a>
<a name="ln-2472"></a><span class="k">  </span><span class="n">SecantMethod</span> <span class="o">=</span> <span class="n">XCandidate</span>
<a name="ln-2473"></a>  <span class="k">RETURN</span>
<a name="ln-2474"></a><span class="k">END FUNCTION </span><span class="n">SecantMethod</span>
<a name="ln-2475"></a>
<a name="ln-2476"></a>
<a name="ln-2477"></a><span class="kt">LOGICAL </span><span class="k">FUNCTION </span><span class="n">SecantFormula</span><span class="p">(</span> <span class="n">RootFinderData</span><span class="p">,</span> <span class="n">XNext</span> <span class="p">)</span>
<a name="ln-2478"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2479"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-2480"></a>          <span class="c">!       DATE WRITTEN   April 2006</span>
<a name="ln-2481"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-2482"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2483"></a>
<a name="ln-2484"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2485"></a>          <span class="c">! This function computes the next iterate using the secant formula.</span>
<a name="ln-2486"></a>          <span class="c">! If the new iterate cannot be computed the function returns FALSE, else TRUE.</span>
<a name="ln-2487"></a>          <span class="c">!</span>
<a name="ln-2488"></a>          <span class="c">! Convergence rate is at best superlinear.</span>
<a name="ln-2489"></a>          <span class="c">!</span>
<a name="ln-2490"></a>          <span class="c">! PRECONDITION:</span>
<a name="ln-2491"></a>          <span class="c">! There must be at least 2 history points so that RootFinderData%Increment is defined.</span>
<a name="ln-2492"></a>          <span class="c">!</span>
<a name="ln-2493"></a>          <span class="c">! POSTCONDITION:</span>
<a name="ln-2494"></a>          <span class="c">! XNext contains the result from applying the Secant formula.</span>
<a name="ln-2495"></a>          <span class="c">! If XNext could not be computed then leave XNext unchanged.</span>
<a name="ln-2496"></a>          <span class="c">!</span>
<a name="ln-2497"></a>
<a name="ln-2498"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2499"></a>          <span class="c">! na</span>
<a name="ln-2500"></a>
<a name="ln-2501"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2502"></a>          <span class="c">! na</span>
<a name="ln-2503"></a>
<a name="ln-2504"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2505"></a>          <span class="c">! na</span>
<a name="ln-2506"></a>
<a name="ln-2507"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2508"></a>
<a name="ln-2509"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2510"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-2511"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">XNext</span>          <span class="c">! Result from Secant formula if possible to compute</span>
<a name="ln-2512"></a>
<a name="ln-2513"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-2514"></a>          <span class="c">! na</span>
<a name="ln-2515"></a>
<a name="ln-2516"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2517"></a>          <span class="c">! na</span>
<a name="ln-2518"></a>
<a name="ln-2519"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2520"></a>          <span class="c">! na</span>
<a name="ln-2521"></a>
<a name="ln-2522"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2523"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">Num</span>
<a name="ln-2524"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">Den</span>
<a name="ln-2525"></a>
<a name="ln-2526"></a>          <span class="c">! FLOW:</span>
<a name="ln-2527"></a>
<a name="ln-2528"></a>  <span class="n">Num</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Increment</span><span class="p">%</span><span class="n">X</span>
<a name="ln-2529"></a>  <span class="n">Den</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">Increment</span><span class="p">%</span><span class="n">Y</span>
<a name="ln-2530"></a>
<a name="ln-2531"></a>  <span class="c">! Cannot use secant with infinite slope (Den==0).</span>
<a name="ln-2532"></a>  <span class="c">! Cannot use secant with null slope (Num==0).</span>
<a name="ln-2533"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">Den</span> <span class="o">/=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Num</span> <span class="o">/=</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2534"></a><span class="k">    </span><span class="n">XNext</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentPoint</span><span class="p">%</span><span class="n">X</span> <span class="o">-</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentPoint</span><span class="p">%</span><span class="n">Y</span> <span class="o">*</span> <span class="n">Num</span><span class="o">/</span><span class="n">Den</span>
<a name="ln-2535"></a>    <span class="n">SecantFormula</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2536"></a>  <span class="k">ELSE</span>
<a name="ln-2537"></a><span class="k">    </span><span class="n">SecantFormula</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2538"></a>  <span class="k">END IF</span>
<a name="ln-2539"></a>
<a name="ln-2540"></a><span class="k">  RETURN</span>
<a name="ln-2541"></a><span class="k">END FUNCTION </span><span class="n">SecantFormula</span>
<a name="ln-2542"></a>
<a name="ln-2543"></a>
<a name="ln-2544"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">BrentMethod</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-2545"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2546"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-2547"></a>          <span class="c">!       DATE WRITTEN   March 2006</span>
<a name="ln-2548"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-2549"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2550"></a>
<a name="ln-2551"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2552"></a>          <span class="c">! This function computes the next iterate using the Brent&#39;s method.</span>
<a name="ln-2553"></a>          <span class="c">! If new iterate does not lie within the lower and upper points then</span>
<a name="ln-2554"></a>          <span class="c">! the secant method is used instead.</span>
<a name="ln-2555"></a>          <span class="c">!</span>
<a name="ln-2556"></a>          <span class="c">! Convergence rate is at best quadratic.</span>
<a name="ln-2557"></a>          <span class="c">!</span>
<a name="ln-2558"></a>          <span class="c">! PRECONDITION:</span>
<a name="ln-2559"></a>          <span class="c">! Lower and upper points must be defined and distinct.</span>
<a name="ln-2560"></a>          <span class="c">!</span>
<a name="ln-2561"></a>          <span class="c">! POSTCONDITION:</span>
<a name="ln-2562"></a>          <span class="c">! - LowerPoint%X &lt; XCandidate &lt; UpperPoint%X</span>
<a name="ln-2563"></a>          <span class="c">! - RootFinderData%CurrentMethodType update with current solution method.</span>
<a name="ln-2564"></a>          <span class="c">!</span>
<a name="ln-2565"></a>
<a name="ln-2566"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2567"></a>          <span class="c">! Inverse quadratic interpolation using the last 3 best iterates.</span>
<a name="ln-2568"></a>          <span class="c">! The next root estimate is x = B + P/Q whereby B is the current best estimate</span>
<a name="ln-2569"></a>          <span class="c">! of the root.</span>
<a name="ln-2570"></a>          <span class="c">!</span>
<a name="ln-2571"></a>
<a name="ln-2572"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2573"></a>          <span class="c">! na</span>
<a name="ln-2574"></a>
<a name="ln-2575"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2576"></a>          <span class="c">! na</span>
<a name="ln-2577"></a>
<a name="ln-2578"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2579"></a>
<a name="ln-2580"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2581"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-2582"></a>
<a name="ln-2583"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-2584"></a>          <span class="c">! na</span>
<a name="ln-2585"></a>
<a name="ln-2586"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2587"></a>          <span class="c">! na</span>
<a name="ln-2588"></a>
<a name="ln-2589"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2590"></a>          <span class="c">! na</span>
<a name="ln-2591"></a>
<a name="ln-2592"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2593"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">XCandidate</span>
<a name="ln-2594"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">A</span><span class="p">,</span> <span class="n">FA</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">FB</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">FC</span>
<a name="ln-2595"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">R</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">Q</span>
<a name="ln-2596"></a>          <span class="c">! FLOW:</span>
<a name="ln-2597"></a>
<a name="ln-2598"></a>  <span class="c">! Only attempt Brent&#39;s method if enough history points are available</span>
<a name="ln-2599"></a>  <span class="c">! and if the root finder is converging (not diverging) since the previous</span>
<a name="ln-2600"></a>  <span class="c">! iterate.</span>
<a name="ln-2601"></a>  <span class="c">!</span>
<a name="ln-2602"></a>  <span class="c">! We assume that;</span>
<a name="ln-2603"></a>  <span class="c">! - the root is bracketed between the lower and upper points (see AdvanceRootFinder() ).</span>
<a name="ln-2604"></a>  <span class="c">! - there are at least 3 history points</span>
<a name="ln-2605"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">NumHistory</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2606"></a>
<a name="ln-2607"></a><span class="k">    </span><span class="n">A</span>  <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-2608"></a>    <span class="n">FA</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-2609"></a>    <span class="n">B</span>  <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-2610"></a>    <span class="n">FB</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-2611"></a>    <span class="n">C</span>  <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-2612"></a>    <span class="n">FC</span> <span class="o">=</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-2613"></a>
<a name="ln-2614"></a>    <span class="c">! Should never happen if CheckRootFinderConvergence() is invoked prior to this subroutine</span>
<a name="ln-2615"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FC</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2616"></a><span class="k">      </span><span class="n">BrentMethod</span> <span class="o">=</span> <span class="n">C</span>
<a name="ln-2617"></a>      <span class="k">RETURN</span>
<a name="ln-2618"></a>    <span class="c">! Should never happen if CheckRootFinderConvergence() is invoked prior to this subroutine</span>
<a name="ln-2619"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FA</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2620"></a><span class="k">      </span><span class="n">BrentMethod</span> <span class="o">=</span> <span class="n">A</span>
<a name="ln-2621"></a>      <span class="k">RETURN</span>
<a name="ln-2622"></a><span class="k">    ELSE</span>
<a name="ln-2623"></a><span class="k">      </span><span class="n">R</span> <span class="o">=</span> <span class="n">FB</span><span class="o">/</span><span class="n">FC</span>
<a name="ln-2624"></a>      <span class="n">S</span> <span class="o">=</span> <span class="n">FB</span><span class="o">/</span><span class="n">FA</span>
<a name="ln-2625"></a>      <span class="n">T</span> <span class="o">=</span> <span class="n">FA</span><span class="o">/</span><span class="n">FC</span>
<a name="ln-2626"></a>
<a name="ln-2627"></a>      <span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">-</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">B</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">R</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">B</span><span class="o">-</span><span class="n">A</span><span class="p">))</span>
<a name="ln-2628"></a>      <span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">S</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-2629"></a>
<a name="ln-2630"></a>      <span class="c">! Only accept correction if it is small enough (75% of previous increment)</span>
<a name="ln-2631"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.75d0</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Q</span><span class="o">*</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">Increment</span><span class="p">%</span><span class="n">X</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2632"></a><span class="k">        </span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentMethodType</span> <span class="o">=</span> <span class="n">iMethodBrent</span>
<a name="ln-2633"></a>        <span class="n">XCandidate</span> <span class="o">=</span> <span class="n">B</span> <span class="o">+</span> <span class="n">P</span><span class="o">/</span><span class="n">Q</span>
<a name="ln-2634"></a>
<a name="ln-2635"></a>        <span class="c">! Check that new candidate is within range and brackets</span>
<a name="ln-2636"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">CheckRootFinderCandidate</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">,</span> <span class="n">XCandidate</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2637"></a>          <span class="c">! Recovery method</span>
<a name="ln-2638"></a>          <span class="n">XCandidate</span> <span class="o">=</span> <span class="n">FalsePositionMethod</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-2639"></a>        <span class="k">END IF</span>
<a name="ln-2640"></a><span class="k">      ELSE</span>
<a name="ln-2641"></a>        <span class="c">! Recover from bad correction with bisection</span>
<a name="ln-2642"></a>        <span class="c">! Biscetion produced the best numerical performance in testing compared to</span>
<a name="ln-2643"></a>        <span class="c">! - Secant</span>
<a name="ln-2644"></a>        <span class="c">! - False position (very slow recovery)</span>
<a name="ln-2645"></a>        <span class="n">XCandidate</span> <span class="o">=</span> <span class="n">BisectionMethod</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-2646"></a>      <span class="k">END IF</span>
<a name="ln-2647"></a><span class="k">    END IF</span>
<a name="ln-2648"></a><span class="k">  ELSE</span>
<a name="ln-2649"></a>    <span class="c">! Not enough history to try Brent&#39;s method yet: use Secant&#39;s method</span>
<a name="ln-2650"></a>    <span class="n">XCandidate</span> <span class="o">=</span> <span class="n">SecantMethod</span><span class="p">(</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-2651"></a>  <span class="k">END IF</span>
<a name="ln-2652"></a>
<a name="ln-2653"></a><span class="k">  </span><span class="n">BrentMethod</span> <span class="o">=</span> <span class="n">XCandidate</span>
<a name="ln-2654"></a>  <span class="k">RETURN</span>
<a name="ln-2655"></a><span class="k">END FUNCTION </span><span class="n">BrentMethod</span>
<a name="ln-2656"></a>
<a name="ln-2657"></a>
<a name="ln-2658"></a><span class="k">SUBROUTINE </span><span class="n">WriteRootFinderTraceHeader</span><span class="p">(</span> <span class="n">TraceFileUnit</span> <span class="p">)</span>
<a name="ln-2659"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2660"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-2661"></a>          <span class="c">!       DATE WRITTEN   March 2006</span>
<a name="ln-2662"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-2663"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2664"></a>
<a name="ln-2665"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2666"></a>          <span class="c">! This subroutine writes the header for the trace file to the specified</span>
<a name="ln-2667"></a>          <span class="c">! file unit using CSV formatting.</span>
<a name="ln-2668"></a>          <span class="c">!</span>
<a name="ln-2669"></a>
<a name="ln-2670"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2671"></a>          <span class="c">! na</span>
<a name="ln-2672"></a>
<a name="ln-2673"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2674"></a>          <span class="c">! na</span>
<a name="ln-2675"></a>
<a name="ln-2676"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2677"></a>          <span class="c">! na</span>
<a name="ln-2678"></a>
<a name="ln-2679"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2680"></a>
<a name="ln-2681"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2682"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">TraceFileUnit</span>  <span class="c">! Unit for trace file</span>
<a name="ln-2683"></a>
<a name="ln-2684"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2685"></a>          <span class="c">! na</span>
<a name="ln-2686"></a>
<a name="ln-2687"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2688"></a>          <span class="c">! na</span>
<a name="ln-2689"></a>
<a name="ln-2690"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2691"></a>          <span class="c">! na</span>
<a name="ln-2692"></a>
<a name="ln-2693"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2694"></a>          <span class="c">! na</span>
<a name="ln-2695"></a>
<a name="ln-2696"></a>          <span class="c">! FLOW:</span>
<a name="ln-2697"></a>
<a name="ln-2698"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">TraceFileUnit</span><span class="p">,</span><span class="s1">&#39;(20(A,A))&#39;</span><span class="p">,</span><span class="n">ADVANCE</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2699"></a>    <span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;Method&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2700"></a>    <span class="s1">&#39;CurrentPoint%X&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;CurrentPoint%Y&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2701"></a>    <span class="s1">&#39;XCandidate&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;ConvergenceRate&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2702"></a>    <span class="c">!&#39;MinPoint%DefinedFlag&#39;, &#39;,&#39;, &amp;</span>
<a name="ln-2703"></a>    <span class="s1">&#39;MinPoint%X&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;MinPoint%Y&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2704"></a>    <span class="c">!&#39;LowerPoint%DefinedFlag&#39;, &#39;,&#39;, &amp;</span>
<a name="ln-2705"></a>    <span class="s1">&#39;LowerPoint%X&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;LowerPoint%Y&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2706"></a>    <span class="c">!&#39;UpperPoint%DefinedFlag&#39;, &#39;,&#39;, &amp;</span>
<a name="ln-2707"></a>    <span class="s1">&#39;UpperPoint%X&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;UpperPoint%Y&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2708"></a>    <span class="c">!&#39;MaxPoint%DefinedFlag&#39;, &#39;,&#39;, &amp;</span>
<a name="ln-2709"></a>    <span class="s1">&#39;MaxPoint%X&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;MaxPoint%Y&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2710"></a>    <span class="c">!&#39;History(1)%DefinedFlag&#39;, &#39;,&#39;, &amp;</span>
<a name="ln-2711"></a>    <span class="s1">&#39;History(1)%X&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;History(1)%Y&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2712"></a>    <span class="c">!&#39;History(2)%DefinedFlag&#39;, &#39;,&#39;, &amp;</span>
<a name="ln-2713"></a>    <span class="s1">&#39;History(2)%X&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;History(2)%Y&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2714"></a>    <span class="c">!&#39;History(3)%DefinedFlag&#39;, &#39;,&#39;, &amp;</span>
<a name="ln-2715"></a>    <span class="s1">&#39;History(3)%X&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;History(3)%Y&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span>
<a name="ln-2716"></a>
<a name="ln-2717"></a>  <span class="k">RETURN</span>
<a name="ln-2718"></a><span class="k">END SUBROUTINE </span><span class="n">WriteRootFinderTraceHeader</span>
<a name="ln-2719"></a>
<a name="ln-2720"></a>
<a name="ln-2721"></a><span class="k">SUBROUTINE </span><span class="n">WriteRootFinderTrace</span><span class="p">(</span> <span class="n">TraceFileUnit</span><span class="p">,</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-2722"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2723"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-2724"></a>          <span class="c">!       DATE WRITTEN   March 2006</span>
<a name="ln-2725"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-2726"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2727"></a>
<a name="ln-2728"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2729"></a>          <span class="c">! This subroutine writes the current state of the root finder data to the trace file</span>
<a name="ln-2730"></a>          <span class="c">! unit using CSV formatting.</span>
<a name="ln-2731"></a>          <span class="c">!</span>
<a name="ln-2732"></a>
<a name="ln-2733"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2734"></a>          <span class="c">! na</span>
<a name="ln-2735"></a>
<a name="ln-2736"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2737"></a>          <span class="c">! na</span>
<a name="ln-2738"></a>
<a name="ln-2739"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2740"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-2741"></a>
<a name="ln-2742"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2743"></a>
<a name="ln-2744"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2745"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">TraceFileUnit</span>  <span class="c">! Unit for trace file</span>
<a name="ln-2746"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-2747"></a>
<a name="ln-2748"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2749"></a>          <span class="c">! na</span>
<a name="ln-2750"></a>
<a name="ln-2751"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2752"></a>          <span class="c">! na</span>
<a name="ln-2753"></a>
<a name="ln-2754"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2755"></a>          <span class="c">! na</span>
<a name="ln-2756"></a>
<a name="ln-2757"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2758"></a>          <span class="c">! na</span>
<a name="ln-2759"></a>
<a name="ln-2760"></a>          <span class="c">! FLOW:</span>
<a name="ln-2761"></a>
<a name="ln-2762"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">TraceFileUnit</span><span class="p">,</span><span class="s1">&#39;(2(A,A))&#39;</span><span class="p">,</span><span class="n">ADVANCE</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2763"></a>    <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span><span class="p">)),</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2764"></a>    <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentMethodType</span><span class="p">)),</span> <span class="s1">&#39;,&#39;</span>
<a name="ln-2765"></a>
<a name="ln-2766"></a>  <span class="c">! Only show current point if defined.</span>
<a name="ln-2767"></a>  <span class="k">CALL </span><span class="n">WritePoint</span><span class="p">(</span> <span class="n">TraceFileUnit</span><span class="p">,</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentPoint</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">)</span>
<a name="ln-2768"></a>
<a name="ln-2769"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">TraceFileUnit</span><span class="p">,</span><span class="s1">&#39;(2(F20.10,A))&#39;</span><span class="p">,</span><span class="n">ADVANCE</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2770"></a>    <span class="n">RootFinderData</span><span class="p">%</span><span class="n">XCandidate</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2771"></a>    <span class="n">RootFinderData</span><span class="p">%</span><span class="n">ConvergenceRate</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span>
<a name="ln-2772"></a>
<a name="ln-2773"></a>  <span class="c">! Always show min and max points.</span>
<a name="ln-2774"></a>  <span class="c">! Only show lower and upper points if defined.</span>
<a name="ln-2775"></a>  <span class="k">CALL </span><span class="n">WritePoint</span><span class="p">(</span> <span class="n">TraceFileUnit</span><span class="p">,</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">,</span>   <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="p">)</span>
<a name="ln-2776"></a>  <span class="k">CALL </span><span class="n">WritePoint</span><span class="p">(</span> <span class="n">TraceFileUnit</span><span class="p">,</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">)</span>
<a name="ln-2777"></a>  <span class="k">CALL </span><span class="n">WritePoint</span><span class="p">(</span> <span class="n">TraceFileUnit</span><span class="p">,</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">)</span>
<a name="ln-2778"></a>  <span class="k">CALL </span><span class="n">WritePoint</span><span class="p">(</span> <span class="n">TraceFileUnit</span><span class="p">,</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">,</span>   <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="p">)</span>
<a name="ln-2779"></a>  <span class="c">! Only show history points if defined.</span>
<a name="ln-2780"></a>  <span class="k">CALL </span><span class="n">WritePoint</span><span class="p">(</span> <span class="n">TraceFileUnit</span><span class="p">,</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">)</span>
<a name="ln-2781"></a>  <span class="k">CALL </span><span class="n">WritePoint</span><span class="p">(</span> <span class="n">TraceFileUnit</span><span class="p">,</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">)</span>
<a name="ln-2782"></a>  <span class="k">CALL </span><span class="n">WritePoint</span><span class="p">(</span> <span class="n">TraceFileUnit</span><span class="p">,</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">History</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">)</span>
<a name="ln-2783"></a>
<a name="ln-2784"></a>  <span class="k">RETURN</span>
<a name="ln-2785"></a><span class="k">END SUBROUTINE </span><span class="n">WriteRootFinderTrace</span>
<a name="ln-2786"></a>
<a name="ln-2787"></a>
<a name="ln-2788"></a><span class="k">SUBROUTINE </span><span class="n">WritePoint</span><span class="p">(</span> <span class="n">TraceFileUnit</span><span class="p">,</span> <span class="n">PointData</span><span class="p">,</span> <span class="n">ShowXValue</span> <span class="p">)</span>
<a name="ln-2789"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2790"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-2791"></a>          <span class="c">!       DATE WRITTEN   March 2006</span>
<a name="ln-2792"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-2793"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2794"></a>
<a name="ln-2795"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2796"></a>          <span class="c">! This subroutine writes the current point data to the trace file</span>
<a name="ln-2797"></a>          <span class="c">! unit using CSV formatting.</span>
<a name="ln-2798"></a>          <span class="c">! If not defined writes an empty string instead.</span>
<a name="ln-2799"></a>          <span class="c">!</span>
<a name="ln-2800"></a>
<a name="ln-2801"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2802"></a>          <span class="c">! na</span>
<a name="ln-2803"></a>
<a name="ln-2804"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2805"></a>          <span class="c">! na</span>
<a name="ln-2806"></a>
<a name="ln-2807"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2808"></a>          <span class="c">! na</span>
<a name="ln-2809"></a>
<a name="ln-2810"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2811"></a>
<a name="ln-2812"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2813"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">TraceFileUnit</span>  <span class="c">! Unit for trace file</span>
<a name="ln-2814"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">PointType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">PointData</span>      <span class="c">! Point data structure</span>
<a name="ln-2815"></a>  <span class="c">! If set to TRUE, ten always show the X value even if not defined</span>
<a name="ln-2816"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">ShowXValue</span>
<a name="ln-2817"></a>
<a name="ln-2818"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2819"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">NoValue</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">! String used whenever the value is not available</span>
<a name="ln-2820"></a>
<a name="ln-2821"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2822"></a>          <span class="c">! na</span>
<a name="ln-2823"></a>
<a name="ln-2824"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2825"></a>          <span class="c">! na</span>
<a name="ln-2826"></a>
<a name="ln-2827"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2828"></a>          <span class="c">! na</span>
<a name="ln-2829"></a>
<a name="ln-2830"></a>          <span class="c">! FLOW:</span>
<a name="ln-2831"></a>
<a name="ln-2832"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">PointData</span><span class="p">%</span><span class="n">DefinedFlag</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2833"></a><span class="k">      WRITE</span><span class="p">(</span><span class="n">TraceFileUnit</span><span class="p">,</span><span class="s1">&#39;(2(F20.10,A))&#39;</span><span class="p">,</span><span class="n">ADVANCE</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-2834"></a>        <span class="n">PointData</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2835"></a>        <span class="n">PointData</span><span class="p">%</span><span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span>
<a name="ln-2836"></a>    <span class="k">ELSE</span>
<a name="ln-2837"></a><span class="k">      IF</span> <span class="p">(</span> <span class="n">ShowXValue</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2838"></a><span class="k">        WRITE</span><span class="p">(</span><span class="n">TraceFileUnit</span><span class="p">,</span><span class="s1">&#39;(1(F20.10,A),1(A,A))&#39;</span><span class="p">,</span><span class="n">ADVANCE</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-2839"></a>          <span class="n">PointData</span><span class="p">%</span><span class="n">X</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2840"></a>          <span class="n">NoValue</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span>
<a name="ln-2841"></a>      <span class="k">ELSE</span>
<a name="ln-2842"></a><span class="k">        WRITE</span><span class="p">(</span><span class="n">TraceFileUnit</span><span class="p">,</span><span class="s1">&#39;(2(A,A))&#39;</span><span class="p">,</span><span class="n">ADVANCE</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-2843"></a>          <span class="n">NoValue</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2844"></a>          <span class="n">NoValue</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span>
<a name="ln-2845"></a>      <span class="k">END IF</span>
<a name="ln-2846"></a><span class="k">    END IF</span>
<a name="ln-2847"></a>
<a name="ln-2848"></a><span class="k">  RETURN</span>
<a name="ln-2849"></a><span class="k">END SUBROUTINE </span><span class="n">WritePoint</span>
<a name="ln-2850"></a>
<a name="ln-2851"></a>
<a name="ln-2852"></a><span class="k">SUBROUTINE </span><span class="n">DebugRootFinder</span><span class="p">(</span> <span class="n">FileUnit</span><span class="p">,</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-2853"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2854"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-2855"></a>          <span class="c">!       DATE WRITTEN   April 2006</span>
<a name="ln-2856"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-2857"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2858"></a>
<a name="ln-2859"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2860"></a>          <span class="c">! This subroutine writes the current min/max range and lower/upper bracket to</span>
<a name="ln-2861"></a>          <span class="c">! the standard output file.</span>
<a name="ln-2862"></a>          <span class="c">!</span>
<a name="ln-2863"></a>          <span class="c">! Used only for debugging.</span>
<a name="ln-2864"></a>          <span class="c">!</span>
<a name="ln-2865"></a>
<a name="ln-2866"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2867"></a>          <span class="c">! na</span>
<a name="ln-2868"></a>
<a name="ln-2869"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2870"></a>          <span class="c">! na</span>
<a name="ln-2871"></a>
<a name="ln-2872"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2873"></a>          <span class="c">! na</span>
<a name="ln-2874"></a>
<a name="ln-2875"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2876"></a>
<a name="ln-2877"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2878"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-2879"></a>
<a name="ln-2880"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2881"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">FileUnit</span>       <span class="c">! File unit where to write debugging info</span>
<a name="ln-2882"></a>
<a name="ln-2883"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2884"></a>          <span class="c">! na</span>
<a name="ln-2885"></a>
<a name="ln-2886"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2887"></a>          <span class="c">! na</span>
<a name="ln-2888"></a>
<a name="ln-2889"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2890"></a>          <span class="c">! na</span>
<a name="ln-2891"></a>
<a name="ln-2892"></a>          <span class="c">! FLOW:</span>
<a name="ln-2893"></a>
<a name="ln-2894"></a>  <span class="c">! UNIT=0 should correspond to the standard output file (screen).</span>
<a name="ln-2895"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">ADVANCE</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;Current = &#39;</span>
<a name="ln-2896"></a>  <span class="k">CALL </span><span class="n">WritePoint</span><span class="p">(</span> <span class="n">FileUnit</span><span class="p">,</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">CurrentPoint</span><span class="p">,</span>   <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="p">)</span>
<a name="ln-2897"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-2898"></a>
<a name="ln-2899"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">ADVANCE</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;Min     = &#39;</span>
<a name="ln-2900"></a>  <span class="k">CALL </span><span class="n">WritePoint</span><span class="p">(</span> <span class="n">FileUnit</span><span class="p">,</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MinPoint</span><span class="p">,</span>   <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="p">)</span>
<a name="ln-2901"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-2902"></a>
<a name="ln-2903"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">ADVANCE</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;Lower   = &#39;</span>
<a name="ln-2904"></a>  <span class="k">CALL </span><span class="n">WritePoint</span><span class="p">(</span> <span class="n">FileUnit</span><span class="p">,</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">LowerPoint</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">)</span>
<a name="ln-2905"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-2906"></a>
<a name="ln-2907"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">ADVANCE</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;Upper   = &#39;</span>
<a name="ln-2908"></a>  <span class="k">CALL </span><span class="n">WritePoint</span><span class="p">(</span> <span class="n">FileUnit</span><span class="p">,</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">UpperPoint</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">)</span>
<a name="ln-2909"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-2910"></a>
<a name="ln-2911"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">ADVANCE</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;Max     = &#39;</span>
<a name="ln-2912"></a>  <span class="k">CALL </span><span class="n">WritePoint</span><span class="p">(</span> <span class="n">FileUnit</span><span class="p">,</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">MaxPoint</span><span class="p">,</span>   <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="p">)</span>
<a name="ln-2913"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-2914"></a>
<a name="ln-2915"></a>  <span class="k">RETURN</span>
<a name="ln-2916"></a><span class="k">END SUBROUTINE  </span><span class="n">DebugRootFinder</span>
<a name="ln-2917"></a>
<a name="ln-2918"></a>
<a name="ln-2919"></a><span class="k">SUBROUTINE </span><span class="n">WriteRootFinderStatus</span><span class="p">(</span> <span class="n">FileUnit</span><span class="p">,</span> <span class="n">RootFinderData</span> <span class="p">)</span>
<a name="ln-2920"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2921"></a>          <span class="c">!       AUTHOR         Dimitri Curtil (LBNL)</span>
<a name="ln-2922"></a>          <span class="c">!       DATE WRITTEN   May 2006</span>
<a name="ln-2923"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-2924"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2925"></a>
<a name="ln-2926"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2927"></a>          <span class="c">!</span>
<a name="ln-2928"></a>
<a name="ln-2929"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2930"></a>          <span class="c">! na</span>
<a name="ln-2931"></a>
<a name="ln-2932"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2933"></a>          <span class="c">! na</span>
<a name="ln-2934"></a>
<a name="ln-2935"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2936"></a>          <span class="c">! na</span>
<a name="ln-2937"></a>
<a name="ln-2938"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2939"></a>
<a name="ln-2940"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2941"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">FileUnit</span>   <span class="c">! File unit where to write the status description</span>
<a name="ln-2942"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">RootFinderDataType</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RootFinderData</span> <span class="c">! Data used by root finding algorithm</span>
<a name="ln-2943"></a>
<a name="ln-2944"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2945"></a>          <span class="c">! na</span>
<a name="ln-2946"></a>
<a name="ln-2947"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2948"></a>          <span class="c">! na</span>
<a name="ln-2949"></a>
<a name="ln-2950"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2951"></a>          <span class="c">! na</span>
<a name="ln-2952"></a>
<a name="ln-2953"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2954"></a>          <span class="c">! na</span>
<a name="ln-2955"></a>
<a name="ln-2956"></a>          <span class="c">! FLOW:</span>
<a name="ln-2957"></a>
<a name="ln-2958"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span> <span class="n">RootFinderData</span><span class="p">%</span><span class="n">StatusFlag</span> <span class="p">)</span>
<a name="ln-2959"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">iStatusOK</span><span class="p">)</span>
<a name="ln-2960"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Found unconstrained root&#39;</span>
<a name="ln-2961"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">iStatusOKMin</span><span class="p">)</span>
<a name="ln-2962"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Found min constrained root&#39;</span>
<a name="ln-2963"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">iStatusOKMax</span><span class="p">)</span>
<a name="ln-2964"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Found max constrained root&#39;</span>
<a name="ln-2965"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">iStatusOKRoundOff</span> <span class="p">)</span>
<a name="ln-2966"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Detected round-off convergence in bracket&#39;</span>
<a name="ln-2967"></a>
<a name="ln-2968"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">iStatusWarningSingular</span> <span class="p">)</span>
<a name="ln-2969"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Detected singularity warning&#39;</span>
<a name="ln-2970"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">iStatusWarningNonMonotonic</span> <span class="p">)</span>
<a name="ln-2971"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Detected non-monotonicity warning&#39;</span>
<a name="ln-2972"></a>
<a name="ln-2973"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">iStatusErrorRange</span><span class="p">)</span>
<a name="ln-2974"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Detected out-of-range error&#39;</span>
<a name="ln-2975"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">iStatusErrorBracket</span><span class="p">)</span>
<a name="ln-2976"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Detected bracket error&#39;</span>
<a name="ln-2977"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">iStatusErrorSlope</span><span class="p">)</span>
<a name="ln-2978"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Detected slope error&#39;</span>
<a name="ln-2979"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">iStatusErrorSingular</span><span class="p">)</span>
<a name="ln-2980"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Detected singularity error&#39;</span>
<a name="ln-2981"></a>
<a name="ln-2982"></a>  <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2983"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">FileUnit</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Detected bad root finder status&#39;</span>
<a name="ln-2984"></a>  <span class="k">END SELECT</span>
<a name="ln-2985"></a>
<a name="ln-2986"></a><span class="k">  RETURN</span>
<a name="ln-2987"></a><span class="k">END SUBROUTINE </span><span class="n">WriteRootFinderStatus</span>
<a name="ln-2988"></a>
<a name="ln-2989"></a><span class="c">!     NOTICE</span>
<a name="ln-2990"></a><span class="c">!</span>
<a name="ln-2991"></a><span class="c">!     Copyright  1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-2992"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-2993"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-2994"></a><span class="c">!</span>
<a name="ln-2995"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-2996"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-2997"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-2998"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-2999"></a><span class="c">!</span>
<a name="ln-3000"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-3001"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-3002"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-3003"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-3004"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-3005"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-3006"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-3007"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-3008"></a><span class="c">!     permit others to do so.</span>
<a name="ln-3009"></a><span class="c">!</span>
<a name="ln-3010"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-3011"></a><span class="c">!</span>
<a name="ln-3012"></a>
<a name="ln-3013"></a><span class="k">END MODULE </span><span class="n">RootFinder</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
