<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>DaylightingManager.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>DaylightingManager.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 1.6% of total for source files.">6080 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/DaylightingManager.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">DaylightingManager.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/daylightingmanager.html">DaylightingManager</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html#src">DaylightingManager.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~daylightingmanager.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefiledaylightingmanagerf90EfferentGraph" width="641pt" height="2906pt"
 viewBox="0.00 0.00 641.00 2905.58" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph" class="graph" transform="scale(.1536 .1536) rotate(0) translate(4 18912.5969)">
<title>sourcefile~~daylightingmanager.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-18912.5969 4169.1873,-18912.5969 4169.1873,4 -4,4"/>
<!-- sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~daylightingmanager.f90</title>
<polygon fill="none" stroke="#000000" points="4165.3511,-17606.0289 4042.6965,-17606.0289 4042.6965,-17584.0181 4165.3511,-17584.0181 4165.3511,-17606.0289"/>
<text text-anchor="middle" x="4104.0238" y="-17591.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">DaylightingManager.f90</text>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~heatbalanceinternalheatgains.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/heatbalanceinternalheatgains.f90.html" xlink:title="HeatBalanceInternalHeatGains.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3860.9416,-17339.0289 3686.4051,-17339.0289 3686.4051,-17317.0181 3860.9416,-17317.0181 3860.9416,-17339.0289"/>
<text text-anchor="middle" x="3773.6733" y="-17324.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceInternalHeatGains.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge961" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3827.9346,-17339.0439C3839.2358,-17342.5696 3850.7566,-17347.1404 3860.8074,-17353.0235 3909.9066,-17381.7631 3928.6328,-17391.0772 3951.8339,-17443.0235"/>
</g>
<!-- sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~delightmanagerf.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/delightmanagerf.f90.html" xlink:title="DElightManagerF.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="4006.8869,-17606.0289 3896.7809,-17606.0289 3896.7809,-17584.0181 4006.8869,-17584.0181 4006.8869,-17606.0289"/>
<text text-anchor="middle" x="3951.8339" y="-17591.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DElightManagerF.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge917" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M3781.1019,-17339.1562C3808.4372,-17380.1223 3903.6619,-17522.8306 3938.7345,-17575.3921"/>
<polygon fill="#b100ff" stroke="#b100ff" points="3935.9118,-17577.4677 3944.3736,-17583.8433 3941.7345,-17573.5824 3935.9118,-17577.4677"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-12453.0289 344.7839,-12453.0289 344.7839,-12431.0181 453.3838,-12431.0181 453.3838,-12453.0289"/>
<text text-anchor="middle" x="399.0839" y="-12438.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge962" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.2345,-12430.9305C455.0979,-12424.3685 471.7198,-12414.2607 480.9653,-12399.0235 554.3108,-12278.1454 477.6055,-2354.8244 516.9653,-2219.0235 548.9592,-2108.6371 618.8035,-2109.2776 654.4731,-2000.0235 724.9967,-1784.0138 615.4531,-1704.5131 690.4731,-1490.0235 861.6898,-1000.4982 979.1142,-881.3043 1372.1997,-543.0235 1525.4574,-411.1333 1581.0563,-397.5911 1764.717,-313.0235 1837.5843,-279.4714 2367.2612,-68.6468 2447.0435,-77.0235"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge791" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M426.9042,-12453.1229C445.8787,-12462.3298 469.5599,-12477.428 480.9653,-12499.0235 532.079,-12595.8041 493.0014,-16332.2302 516.9653,-16439.0235 537.1138,-16528.8135 625.8972,-16749.4633 690.4731,-16815.0235 803.641,-16929.9162 863.2729,-16925.2259 1017.6013,-16972.0235 1770.6541,-17200.3747 1985.8922,-17166.778 2771.2632,-17216.0235 2920.1538,-17225.3595 2968.2906,-17273.1392 3106.9189,-17218.0235 3127.3698,-17209.8927 3123.2186,-17193.8339 3142.9189,-17184.0235 3176.382,-17167.3596 3191.58,-17184.9427 3225.8566,-17170.0235"/>
</g>
<!-- sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~daylightingdevices.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/daylightingdevices.f90.html" xlink:title="DaylightingDevices.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1707.012,-17415.0289 1588.4023,-17415.0289 1588.4023,-17393.0181 1707.012,-17393.0181 1707.012,-17415.0289"/>
<text text-anchor="middle" x="1647.7072" y="-17400.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DaylightingDevices.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge875" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M426.9089,-12453.1204C445.8856,-12462.3262 469.5676,-12477.424 480.9653,-12499.0235 536.3742,-12604.0275 473.5629,-16662.5147 516.9653,-16773.0235 537.8679,-16826.2444 643.8761,-16929.8859 690.4731,-16963.0235 760.2362,-17012.6357 788.6708,-17005.5424 867.457,-17039.0235 1040.4367,-17112.5333 1098.3578,-17106.7415 1251.9829,-17215.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1131.8486,-8173.0289 1017.5188,-8173.0289 1017.5188,-8151.0181 1131.8486,-8151.0181 1131.8486,-8173.0289"/>
<text text-anchor="middle" x="1074.6837" y="-8158.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge886" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#009bff" stroke-dasharray="5,2" d="M428.6229,-12430.8965C445.2927,-12423.6042 465.763,-12412.8542 480.9653,-12399.0235 585.3718,-12304.037 597.4872,-12262.1582 654.4731,-12133.0235 781.2483,-11845.7408 787.7978,-11759.9852 831.457,-11449.0235 853.0304,-11295.3679 825.7417,-10202.4735 867.457,-10053.0235 881.2149,-10003.7342 920.0331,-10003.999 924.5292,-9953.0235"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="794.3339,-9546.0289 727.5963,-9546.0289 727.5963,-9524.0181 794.3339,-9524.0181 794.3339,-9546.0289"/>
<text text-anchor="middle" x="760.9651" y="-9531.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge895" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0058ff" stroke-dasharray="5,2" d="M437.1115,-12430.9114C453.1861,-12424.258 470.5614,-12414.0838 480.9653,-12399.0235 555.7886,-12290.7126 482.1943,-12231.991 516.9653,-12105.0235 557.206,-11958.0833 619.8664,-11939.3917 654.4731,-11791.0235 694.3922,-11619.8797 682.2529,-11176.5689 690.4731,-11001.0235 718.0945,-10411.1636 753.4744,-9687.8817 759.9305,-9556.1237"/>
<polygon fill="#0058ff" stroke="#0058ff" points="763.4266,-9556.2879 760.4204,-9546.1285 756.435,-9555.9451 763.4266,-9556.2879"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge924" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M426.9112,-12453.1192C445.8891,-12462.3243 469.5715,-12477.4219 480.9653,-12499.0235 538.8175,-12608.7054 475.3129,-16846.2242 516.9653,-16963.0235 542.4395,-17034.4565 1321.3735,-17970.7358 1372.1997,-18027.0235 1453.6047,-18117.1759 1470.3256,-18145.0862 1566.6973,-18219.0235 1749.6372,-18359.3768 1826.5351,-18361.9689 2054.7312,-18395.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.2783,-6576.0289 536.1602,-6576.0289 536.1602,-6554.0181 635.2783,-6554.0181 635.2783,-6576.0289"/>
<text text-anchor="middle" x="585.7192" y="-6561.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge956" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M439.2086,-12430.9147C455.0674,-12424.3499 471.6929,-12414.2443 480.9653,-12399.0235 517.7312,-12338.672 513.4694,-7381.6054 516.9653,-7311.0235 531.204,-7023.5472 572.2037,-6675.6207 583.0568,-6586.5814"/>
<polygon fill="#ff0042" stroke="#ff0042" points="586.5631,-6586.7434 584.3055,-6576.3919 579.6151,-6585.8919 586.5631,-6586.7434"/>
</g>
<!-- sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~outputreporttabular.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/outputreporttabular.f90.html" xlink:title="OutputReportTabular.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3650.7465,-9149.0289 3523.919,-9149.0289 3523.919,-9127.0181 3650.7465,-9127.0181 3650.7465,-9149.0289"/>
<text text-anchor="middle" x="3587.3328" y="-9134.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportTabular.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge432" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3225.8566,-8133.0235C3299.7718,-8324.223 3321.2561,-8371.4833 3416.4602,-8553.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.222,-12430.9229C455.0833,-12424.3596 471.7069,-12414.2528 480.9653,-12399.0235 530.5613,-12317.4427 449.2788,-5592.3565 516.9653,-5525.0235 618.9115,-5423.6099 709.6042,-5524.6716 831.457,-5601.0235 927.0826,-5660.9417 2265.0714,-6882.0304 2366.7283,-6931.0235 2668.1867,-7076.3103 2888.6514,-6815.3609 3106.9189,-7069.0235 3182.3342,-7156.6684 3071.8578,-8017.8128 3142.9189,-8109.0235 3166.5027,-8139.2945 3212.0198,-8097.2315 3225.8566,-8133.0235"/>
</g>
<!-- sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~plantpipeheattransfer.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/plantpipeheattransfer.f90.html" xlink:title="PlantPipeHeatTransfer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2321.0876,-16047.0289 2186.5369,-16047.0289 2186.5369,-16025.0181 2321.0876,-16025.0181 2321.0876,-16047.0289"/>
<text text-anchor="middle" x="2253.8123" y="-16032.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantPipeHeatTransfer.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge504" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M426.8128,-12453.1716C445.743,-12462.4021 469.4089,-12477.5085 480.9653,-12499.0235 562.7443,-12651.2745 450.5435,-13894.4732 516.9653,-14054.0235 550.8526,-14135.4235 609.5428,-14121.1581 654.4731,-14197.0235 931.7972,-14665.288 899.7115,-14838.9953 981.6013,-15377.0235 991.2169,-15440.199 981.356,-15898.3938 1017.6013,-15951.0235 1022.3541,-15957.9248 1558.8479,-16198.0902 1566.6973,-16201.0235 1601.8725,-16214.1687 1610.6755,-16218.7983 1647.7072,-16225.0235"/>
</g>
<!-- sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~plantwateruse.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/plantwateruse.f90.html" xlink:title="PlantWaterUse.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2496.7814,-14701.0289 2397.3056,-14701.0289 2397.3056,-14679.0181 2496.7814,-14679.0181 2496.7814,-14701.0289"/>
<text text-anchor="middle" x="2447.0435" y="-14686.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantWaterUse.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge521" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M426.8912,-12453.1298C445.8594,-12462.34 469.5385,-12477.4394 480.9653,-12499.0235 523.0258,-12578.4711 504.2434,-15646.0338 516.9653,-15735.0235 557.4605,-16018.286 462.5002,-16182.0903 690.4731,-16355.0235 793.5598,-16433.2219 852.5862,-16364.8696 981.6013,-16355.0235 1502.2037,-16315.2927 1653.1165,-16351.2392 2140.8962,-16165.0235 2231.787,-16130.3249 2280.1729,-16139.1456 2330.7283,-16056.0235 2378.7536,-15977.0614 2357.8556,-15317.0166 2366.7283,-15225.0235 2386.1145,-15024.0242 2429.5865,-14783.2891 2443.0145,-14711.3311"/>
<polygon fill="#65ff00" stroke="#65ff00" points="2446.4993,-14711.7373 2444.9033,-14701.2634 2439.6193,-14710.4465 2446.4993,-14711.7373"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~zoneplenumcomponent.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/zoneplenumcomponent.f90.html" xlink:title="ZonePlenumComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3488.2926,-16104.0289 3344.6278,-16104.0289 3344.6278,-16082.0181 3488.2926,-16082.0181 3488.2926,-16104.0289"/>
<text text-anchor="middle" x="3416.4602" y="-16089.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZonePlenumComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge605" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M760.9651,-16683.0235C785.5626,-16703.4007 802.4039,-16683.7501 831.457,-16697.0235 849.8938,-16705.4466 848.8522,-16716.9783 867.457,-16725.0235 991.4556,-16778.6438 1033.9637,-16753.3772 1167.7661,-16772.0235 1766.2462,-16855.426 1955.4996,-16968.2456 2527.3586,-16773.0235 2745.4926,-16698.5566 2754.128,-16587.7097 2965.166,-16495.0235 3024.8859,-16468.795 3051.795,-16491.8911 3106.9189,-16457.0235 3255.6518,-16362.9456 3370.453,-16174.8125 3405.4173,-16113.123"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="3408.5027,-16114.7766 3410.3364,-16104.3417 3402.3956,-16111.3556 3408.5027,-16114.7766"/>
</g>
<!-- sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~electricpowermanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/electricpowermanager.f90.html" xlink:title="ElectricPowerManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3103.1081,-10141.0289 2968.9768,-10141.0289 2968.9768,-10119.0181 3103.1081,-10119.0181 3103.1081,-10141.0289"/>
<text text-anchor="middle" x="3036.0425" y="-10126.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ElectricPowerManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge697" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M426.747,-12453.2071C445.6454,-12462.4548 469.3003,-12477.5672 480.9653,-12499.0235 538.4201,-12604.7039 469.1449,-13470.6487 516.9653,-13581.0235 670.7378,-13935.9475 919.6049,-13873.5972 1131.7661,-14197.0235 1155.6227,-14233.3913 1148.805,-14248.8798 1167.7661,-14288.0235 1244.8114,-14447.0773 1435.4577,-14857.6586 1566.6973,-14976.0235 1706.1995,-15101.8405 1781.6764,-15087.9707 1968.5662,-15107.0235 2132.7504,-15123.7615 2205.5992,-15132.6308 2330.7283,-15025.0235 2455.8588,-14917.415 2479.7184,-14868.035 2527.3586,-14710.0235 2569.1667,-14571.356 2541.657,-13550.2214 2563.3586,-13407.0235 2614.6753,-13068.4115 2531.7628,-12909.8318 2771.2632,-12665.0235 2796.9105,-12638.8078 2838.8347,-12675.8882 2850.2146,-12641.0235"/>
</g>
<!-- sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~electricpowergenerators.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/electricpowergenerators.f90.html" xlink:title="ElectricPowerGenerators.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2520.2673,-13736.0289 2373.8197,-13736.0289 2373.8197,-13714.0181 2520.2673,-13714.0181 2520.2673,-13736.0289"/>
<text text-anchor="middle" x="2447.0435" y="-13721.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ElectricPowerGenerators.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge712" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M760.9651,-13643.0235C801.6841,-13707.2802 818.9189,-13718.4486 867.457,-13777.0235 982.1211,-13915.398 1023.9973,-13939.2138 1131.7661,-14083.0235 1249.8203,-14240.5584 1241.1987,-14308.0787 1372.1997,-14455.0235 1446.6864,-14538.5758 1461.9614,-14575.5311 1566.6973,-14615.0235 1617.4633,-14634.1657 2019.4696,-14672.2575 2054.7312,-14631.0235"/>
</g>
<!-- sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~plantwaterthermaltank.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/plantwaterthermaltank.f90.html" xlink:title="PlantWaterThermalTank.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3106.7956,-11816.0289 2965.2893,-11816.0289 2965.2893,-11794.0181 3106.7956,-11794.0181 3106.7956,-11816.0289"/>
<text text-anchor="middle" x="3036.0425" y="-11801.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantWaterThermalTank.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge761" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M426.8976,-12453.1264C445.8688,-12462.335 469.5489,-12477.4339 480.9653,-12499.0235 526.9994,-12586.0789 493.686,-15948.3373 516.9653,-16044.0235 557.4442,-16210.406 567.4537,-16268.9106 690.4731,-16388.0235 845.8389,-16538.4555 986.8126,-16432.5343 1131.7661,-16593.0235 1164.5513,-16629.3226 1127.922,-16668.652 1167.7661,-16697.0235 1228.7457,-16740.4448 1262.6073,-16710.7376 1336.1997,-16697.0235 1801.9976,-16610.2211 2045.727,-16691.5425 2330.7283,-16313.0235 2385.21,-16240.6647 2317.8848,-15983.3017 2366.7283,-15907.0235 2411.0934,-15837.739 2458.559,-15860.1369 2527.3586,-15815.0235 2623.7411,-15751.8235 2665.862,-15752.0414 2735.2632,-15660.0235 2762.4516,-15623.9749 2738.2825,-15595.8617 2771.2632,-15565.0235 2798.0518,-15539.9751 2834.744,-15574.2758 2850.2146,-15541.0235"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1505.1742,-5591.0289 1397.7228,-5591.0289 1397.7228,-5569.0181 1505.1742,-5569.0181 1505.1742,-5591.0289"/>
<text text-anchor="middle" x="1451.4485" y="-5576.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.2233,-12430.9236C455.0847,-12424.3605 471.7082,-12414.2536 480.9653,-12399.0235 532.1992,-12314.7325 447.0397,-5366.5956 516.9653,-5297.0235 663.356,-5151.3731 781.9737,-5244.174 981.6013,-5297.0235 1073.6426,-5321.3906 1079.9817,-5366.1556 1167.7661,-5403.0235 1203.6498,-5418.094 1216.5018,-5411.0283 1251.9829,-5427.0235"/>
</g>
<!-- sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~exteriorenergyusemanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/exteriorenergyusemanager.f90.html" xlink:title="ExteriorEnergyUseManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1530.9468,-7526.0289 1371.9501,-7526.0289 1371.9501,-7504.0181 1530.9468,-7504.0181 1530.9468,-7526.0289"/>
<text text-anchor="middle" x="1451.4485" y="-7511.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ExteriorEnergyUseManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M438.533,-12430.9378C454.4743,-12424.3497 471.349,-12414.2197 480.9653,-12399.0235 532.9385,-12316.8934 473.8269,-11612.1191 516.9653,-11525.0235 552.2,-11453.8855 620.3789,-11482.7151 654.4731,-11411.0235 701.0135,-11313.1607 638.9384,-7605.3508 690.4731,-7510.0235 699.3928,-7493.5242 1240.0645,-7120.5411 1251.9829,-7135.0235"/>
</g>
<!-- sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node48" class="node">
<title>sourcefile~pollutionanalysismodule.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node48"><a xlink:href="../sourcefile/pollutionanalysismodule.f90.html" xlink:title="PollutionAnalysisModule.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1323.8102,-2053.0289 1180.1556,-2053.0289 1180.1556,-2031.0181 1323.8102,-2031.0181 1323.8102,-2053.0289"/>
<text text-anchor="middle" x="1251.9829" y="-2038.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PollutionAnalysisModule.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge420" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M585.7192,-2803.0235C646.0071,-2631.1374 746.0343,-2635.9036 831.457,-2475.0235 854.3955,-2431.8226 844.0731,-2413.985 867.457,-2371.0235 919.2451,-2275.8774 940.133,-2254.743 1017.6013,-2179.0235 1077.1425,-2120.8265 1093.3364,-2104.3366 1167.7661,-2067.0235 1176.0766,-2062.8573 1185.204,-2059.2578 1194.2881,-2056.1912"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="1195.6208,-2059.4401 1204.0877,-2053.0713 1193.4971,-2052.77 1195.6208,-2059.4401"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node65" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node65"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1500.8384,-4907.0289 1402.0586,-4907.0289 1402.0586,-4885.0181 1500.8384,-4885.0181 1500.8384,-4907.0289"/>
<text text-anchor="middle" x="1451.4485" y="-4892.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.2255,-12430.925C455.0874,-12424.3621 471.7105,-12414.255 480.9653,-12399.0235 535.5253,-12309.229 462.2988,-4923.7532 516.9653,-4834.0235 689.607,-4550.6494 989.8603,-4499.5591 1251.9829,-4703.0235"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node68" class="node">
<title>sourcefile~hvacheatingcoils.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node68"><a xlink:href="../sourcefile/hvacheatingcoils.f90.html" xlink:title="HVACHeatingCoils.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3094.9842,-7100.0289 2977.1007,-7100.0289 2977.1007,-7078.0181 3094.9842,-7078.0181 3094.9842,-7100.0289"/>
<text text-anchor="middle" x="3036.0425" y="-7085.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACHeatingCoils.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge287" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2649.3109,-7413.0235C2738.2459,-7420.9836 2767.0669,-7445.5697 2850.2146,-7413.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2447.0435,-7261.0235C2544.6532,-7316.8581 2537.3079,-7402.9988 2649.3109,-7413.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M439.2207,-12430.9221C455.0817,-12424.3586 471.7055,-12414.252 480.9653,-12399.0235 528.9234,-12320.1528 451.518,-5818.1173 516.9653,-5753.0235 668.8741,-5601.9354 851.7363,-5942.1937 867.457,-5954.0235 1060.815,-6099.5243 1137.6964,-6092.6247 1336.1997,-6231.0235 1520.8334,-6359.7523 1582.283,-6380.0914 1728.717,-6551.0235 1845.3341,-6687.1504 1858.9703,-6735.5802 1932.5662,-6899.0235 1953.6866,-6945.9282 1934.0379,-6970.8932 1968.5662,-7009.0235 2024.7537,-7071.0727 2072.4715,-7036.8032 2140.8962,-7085.0235 2159.9129,-7098.425 2158.0308,-7109.4099 2176.8962,-7123.0235 2238.1103,-7167.1967 2263.6645,-7160.3699 2330.7283,-7195.0235 2383.5333,-7222.3093 2395.4499,-7231.511 2447.0435,-7261.0235"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node70" class="node">
<title>sourcefile~hvacwatercoilcomponent.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node70"><a xlink:href="../sourcefile/hvacwatercoilcomponent.f90.html" xlink:title="HVACWaterCoilComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2929.1175,-3928.0289 2771.3117,-3928.0289 2771.3117,-3906.0181 2929.1175,-3906.0181 2929.1175,-3928.0289"/>
<text text-anchor="middle" x="2850.2146" y="-3913.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACWaterCoilComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge343" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M439.2325,-12430.9293C455.0956,-12424.3671 471.7178,-12414.2594 480.9653,-12399.0235 549.1241,-12286.7276 486.6325,-3068.8355 516.9653,-2941.0235 532.7882,-2874.3515 566.8354,-2868.894 585.7192,-2803.0235"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-2803.0235C606.8056,-2729.4705 654.09,-2542.3359 690.4731,-2475.0235 724.2889,-2412.4611 1080.0414,-1964.7503 1167.7661,-1889.0235 1399.2248,-1689.2209 1467.8442,-1620.2405 1764.717,-1547.0235 1837.1464,-1529.1604 1859.1047,-1534.0423 1932.5662,-1547.0235 2237.0805,-1600.8334 2378.3253,-1637.0741 2527.3586,-1908.0235 2578.706,-2001.3753 2535.4819,-2042.1936 2563.3586,-2145.0235 2590.3928,-2244.7455 2626.1814,-2260.3243 2649.3109,-2361.0235"/>
</g>
<!-- sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node79" class="node">
<title>sourcefile~heatrecovery.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node79"><a xlink:href="../sourcefile/heatrecovery.f90.html" xlink:title="HeatRecovery.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3083.8097,-2260.0289 2988.2753,-2260.0289 2988.2753,-2238.0181 3083.8097,-2238.0181 3083.8097,-2260.0289"/>
<text text-anchor="middle" x="3036.0425" y="-2245.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatRecovery.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge265" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M439.233,-12430.9295C455.0961,-12424.3674 471.7182,-12414.2597 480.9653,-12399.0235 515.5907,-12341.9722 505.8693,-2854.8312 516.9653,-2789.0235 556.4938,-2554.5898 555.4071,-2478.6733 690.4731,-2283.0235 736.7328,-2216.0141 780.289,-2229.3642 831.457,-2166.0235 853.1931,-2139.1165 851.3285,-2127.6228 867.457,-2097.0235 999.8747,-1845.799 1018.7063,-1774.7452 1167.7661,-1533.0235 1235.7844,-1422.7222 1273.6055,-1408.4908 1336.1997,-1295.0235 1356.4126,-1258.3827 1340.1406,-1234.9182 1372.1997,-1208.0235 1563.4639,-1047.5704 1685.716,-1131.7113 1932.5662,-1169.0235 2027.8387,-1183.4243 2052.104,-1191.6046 2140.8962,-1229.0235 2230.346,-1266.7196 2250.0291,-1283.08 2330.7283,-1337.0235 2439.6373,-1409.8239 2450.1475,-1452.1122 2563.3586,-1518.0235 2682.642,-1587.47 2762.0391,-1530.833 2850.2146,-1637.0235"/>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node84" class="node">
<title>sourcefile~heatbalanceconvectioncoeffs.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node84"><a xlink:href="../sourcefile/heatbalanceconvectioncoeffs.f90.html" xlink:title="HeatBalanceConvectionCoeffs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2141.0616,-12025.0289 1968.4008,-12025.0289 1968.4008,-12003.0181 2141.0616,-12003.0181 2141.0616,-12025.0289"/>
<text text-anchor="middle" x="2054.7312" y="-12010.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceConvectionCoeffs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge486" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-12917.0235C1071.0201,-12812.5467 946.8128,-12688.4441 1017.6013,-12523.0235 1092.0584,-12349.0299 1433.0381,-12006.0119 1566.6973,-11872.0235 1624.7048,-11813.8731 1801.7031,-11565.6208 1848.6416,-11633.0235"/>
</g>
<!-- sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node86" class="node">
<title>sourcefile~poweredinductionunits.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node86"><a xlink:href="../sourcefile/poweredinductionunits.f90.html" xlink:title="PoweredInductionUnits.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3294.8499,-10370.0289 3156.8633,-10370.0289 3156.8633,-10348.0181 3294.8499,-10348.0181 3294.8499,-10370.0289"/>
<text text-anchor="middle" x="3225.8566" y="-10355.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PoweredInductionUnits.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge569" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-16683.0235C888.8328,-16711.2797 1806.0159,-16844.6921 1932.5662,-16811.0235 2031.0989,-16784.8089 2253.6059,-16649.7171 2330.7283,-16583.0235 2570.786,-16375.4272 2562.3021,-16259.8942 2771.2632,-16021.0235 2837.4628,-15945.3485 2870.1271,-15940.4084 2929.166,-15859.0235 2989.269,-15776.1719 2981.6608,-15741.7379 3036.0425,-15655.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M426.9006,-12453.1248C445.8733,-12462.3327 469.5539,-12477.4312 480.9653,-12499.0235 529.1599,-12590.2152 496.4427,-16110.9421 516.9653,-16212.0235 563.874,-16443.0651 530.135,-16635.0849 760.9651,-16683.0235"/>
</g>
<!-- sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node89" class="node">
<title>sourcefile~photovoltaics.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node89"><a xlink:href="../sourcefile/photovoltaics.f90.html" xlink:title="Photovoltaics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2896.1797,-10121.0289 2804.2495,-10121.0289 2804.2495,-10099.0181 2896.1797,-10099.0181 2896.1797,-10121.0289"/>
<text text-anchor="middle" x="2850.2146" y="-10106.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Photovoltaics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge668" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M412.0976,-12453.1952C432.7038,-12470.0663 474.8412,-12501.3175 516.9653,-12513.0235 651.6361,-12550.4477 702.4875,-12566.909 831.457,-12513.0235 919.0735,-12476.416 939.9941,-12446.3792 981.6013,-12361.0235 1036.5781,-12248.2407 974.8998,-12199.0023 1017.6013,-12081.0235 1059.9124,-11964.1233 1081.0564,-11934.1152 1167.7661,-11845.0235 1570.3345,-11431.3965 1856.561,-11596.1345 2330.7283,-11267.0235 2430.5614,-11197.7311 2448.96,-11169.8769 2527.3586,-11077.0235 2632.9572,-10951.9551 2682.5766,-10927.9986 2735.2632,-10773.0235 2758.4383,-10704.8551 2724.1557,-10180.4744 2771.2632,-10126.0235 2777.3109,-10119.033 2785.4985,-10114.5856 2794.3178,-10111.8341"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2795.169,-10115.2292 2804.0644,-10109.4739 2793.5215,-10108.4258 2795.169,-10115.2292"/>
</g>
<!-- sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node91" class="node">
<title>sourcefile~photovoltaicthermalcollectors.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node91"><a xlink:href="../sourcefile/photovoltaicthermalcollectors.f90.html" xlink:title="PhotovoltaicThermalCollectors.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2735.2155,-9513.0289 2563.4063,-9513.0289 2563.4063,-9491.0181 2735.2155,-9491.0181 2735.2155,-9513.0289"/>
<text text-anchor="middle" x="2649.3109" y="-9498.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PhotovoltaicThermalCollectors.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge612" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M435.9189,-12430.918C523.3762,-12402.3343 742.8208,-12317.0832 831.457,-12158.0235 912.0312,-12013.4313 789.1043,-11559.8315 867.457,-11414.0235 913.0694,-11329.1426 1485.6132,-10953.0873 1566.6973,-10901.0235 1723.3596,-10800.4311 1804.284,-10831.9517 1932.5662,-10697.0235 1957.492,-10670.8063 1944.9229,-10651.403 1968.5662,-10624.0235 2029.3996,-10553.5769 2094.4366,-10585.6767 2140.8962,-10505.0235 2191.6341,-10416.9434 2143.3655,-10144.9825 2176.8962,-10049.0235 2217.2197,-9933.6247 2270.2057,-9927.2303 2330.7283,-9821.0235 2349.2333,-9788.5504 2342.708,-9773.6585 2366.7283,-9745.0235 2422.9899,-9677.953 2461.2749,-9688.441 2527.3586,-9631.0235 2568.7143,-9595.0913 2611.438,-9546.861 2633.6895,-9520.7371"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2636.3833,-9522.9718 2640.167,-9513.0756 2631.0378,-9518.4524 2636.3833,-9522.9718"/>
</g>
<!-- sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node92" class="node">
<title>sourcefile~hvactranspiredcollector.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node92"><a xlink:href="../sourcefile/hvactranspiredcollector.f90.html" xlink:title="HVACTranspiredCollector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2723.3833,-11758.0289 2575.2385,-11758.0289 2575.2385,-11736.0181 2723.3833,-11736.0181 2723.3833,-11758.0289"/>
<text text-anchor="middle" x="2649.3109" y="-11743.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACTranspiredCollector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge648" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M421.9905,-12453.1833C440.1398,-12463.0403 465.0146,-12478.9558 480.9653,-12499.0235 507.7719,-12532.749 491.3472,-12554.3867 516.9653,-12589.0235 586.0971,-12682.4925 829.3847,-12983.8307 924.5292,-12917.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M924.5292,-12917.0235C1003.3476,-12875.637 964.6187,-12812.4121 981.6013,-12725.0235 1013.795,-12559.3625 962.6321,-12506.5803 1017.6013,-12347.0235 1142.0015,-11985.9324 1245.6195,-11892.8356 1566.6973,-11686.0235 1896.4208,-11473.6425 2055.2949,-11728.1455 2447.0435,-11747.0235"/>
</g>
<!-- sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node95" class="node">
<title>sourcefile~plantsolarcollectors.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node95"><a xlink:href="../sourcefile/plantsolarcollectors.f90.html" xlink:title="PlantSolarCollectors.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2509.1831,-13338.0289 2384.9038,-13338.0289 2384.9038,-13316.0181 2509.1831,-13316.0181 2509.1831,-13338.0289"/>
<text text-anchor="middle" x="2447.0435" y="-13323.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantSolarCollectors.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge751" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M425.5204,-12453.0578C444.3295,-12462.3909 468.407,-12477.6746 480.9653,-12499.0235 521.281,-12567.5597 503.6942,-12776.6242 516.9653,-12855.0235 578.156,-13216.5086 464.6591,-13427.1102 760.9651,-13643.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-13643.0235C877.02,-13801.6528 995.51,-13742.3681 1131.7661,-13884.0235 1254.7934,-14011.9259 1251.029,-14071.3293 1336.1997,-14227.0235 1353.3699,-14258.4111 1343.0295,-14278.3089 1372.1997,-14299.0235 1575.286,-14443.2411 1720.2028,-14420.1949 1932.5662,-14290.0235 1965.7795,-14269.6649 2121.1379,-14041.5974 2140.8962,-14008.0235 2160.4662,-13974.7698 2153.5367,-13959.7338 2176.8962,-13929.0235 2230.9151,-13858.0059 2283.5552,-13875.7615 2330.7283,-13800.0235 2355.5164,-13760.2253 2424.6519,-13434.3891 2442.6925,-13347.987"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2446.1497,-13348.5532 2444.7623,-13338.0496 2439.2967,-13347.1258 2446.1497,-13348.5532"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-12530.0289 350.2841,-12530.0289 350.2841,-12508.0181 447.8836,-12508.0181 447.8836,-12530.0289"/>
<text text-anchor="middle" x="399.0839" y="-12515.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge963" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.9261,-12530.1699C407.313,-12628.491 461.2647,-13358.0672 480.9653,-13951.0235 488.1013,-14165.8032 478.4702,-17607.6013 516.9653,-17819.0235 527.0118,-17874.2006 656.4589,-18248.4312 690.4731,-18293.0235 726.9704,-18340.8709 1092.1022,-18561.7665 1131.7661,-18607.0235 1154.3051,-18632.7407 1140.2575,-18654.7095 1167.7661,-18675.0235 1312.9596,-18782.2432 1387.7489,-18727.4722 1566.6973,-18751.0235 2083.0121,-18818.9756 2216.9606,-18786.4183 2735.2632,-18837.0235 2786.4866,-18842.0248 2798.749,-18851.4037 2850.2146,-18851.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2850.2146,-18851.0235C3017.5501,-18838.4924 3058.1226,-18808.175 3225.8566,-18813.0235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge793" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-17215.0235C596.5669,-17245.517 632.8168,-17214.9709 654.4731,-17239.0235 701.2156,-17290.9382 656.4794,-17330.9955 690.4731,-17392.0235 733.5969,-17469.4423 775.811,-17464.0536 831.457,-17533.0235 908.8135,-17628.9022 920.2983,-17659.1652 981.6013,-17766.0235 999.207,-17796.7122 991.6192,-17813.0093 1017.6013,-17837.0235 1080.1827,-17894.8647 1290.1108,-17960.1448 1372.1997,-17983.0235 1790.1456,-18099.5078 1934.21,-17974.15 2330.7283,-17798.0235 2601.8193,-17677.6096 3330.2058,-17384.1231 3488.1262,-17133.0235 3579.506,-16987.726 3562.4344,-16197.1951 3587.3328,-16367.0235"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1320.3807,-2929.0289 1183.5852,-2929.0289 1183.5852,-2907.0181 1320.3807,-2907.0181 1320.3807,-2929.0289"/>
<text text-anchor="middle" x="1251.9829" y="-2914.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge830" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#f3ff00" stroke-dasharray="5,2" d="M585.7192,-4000.0235C625.2922,-3908.9197 792.5793,-3718.2865 867.457,-3653.0235 913.4019,-3612.9783 949.3571,-3628.7426 981.6013,-3577.0235 1046.1155,-3473.5439 976.815,-3419.9435 1017.6013,-3305.0235 1050.0437,-3213.6134 1096.3341,-3209.3169 1131.7661,-3119.0235 1161.5682,-3043.0772 1111.4481,-2998.0513 1167.7661,-2939.0235 1169.8628,-2936.826 1172.1513,-2934.8443 1174.5886,-2933.0581"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="1176.6597,-2935.8951 1183.3854,-2927.7088 1173.0226,-2929.9141 1176.6597,-2935.8951"/>
<path fill="none" stroke="#f3ff00" stroke-dasharray="5,2" d="M426.9347,-12507.9402C445.9239,-12498.741 469.6102,-12483.6455 480.9653,-12462.0235 532.8786,-12363.1721 507.7305,-4534.2948 516.9653,-4423.0235 532.7187,-4233.2089 512.8074,-4175.9826 585.7192,-4000.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="979.6672,-11445.0289 869.3911,-11445.0289 869.3911,-11423.0181 979.6672,-11423.0181 979.6672,-11445.0289"/>
<text text-anchor="middle" x="924.5292" y="-11430.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge838" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M420.7557,-12530.1619C467.2237,-12552.3459 578.3923,-12596.1876 654.4731,-12551.0235 683.2051,-12533.9672 669.6096,-12511.1225 690.4731,-12485.0235 742.5784,-12419.8431 795.139,-12436.153 831.457,-12361.0235 899.5374,-12220.1887 844.0312,-11812.6864 867.457,-11658.0235 878.9932,-11581.8589 905.3168,-11493.9748 917.7661,-11454.7679"/>
<polygon fill="#6eff00" stroke="#6eff00" points="921.1614,-11455.6417 920.8857,-11445.0505 914.4965,-11453.502 921.1614,-11455.6417"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1130.5005,-15555.0289 1018.8669,-15555.0289 1018.8669,-15533.0181 1130.5005,-15533.0181 1130.5005,-15555.0289"/>
<text text-anchor="middle" x="1074.6837" y="-15540.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge858" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff58" stroke-dasharray="5,2" d="M585.7192,-14211.0235C882.043,-14698.7151 1042.2926,-15394.4503 1070.2486,-15523.138"/>
<polygon fill="#00ff58" stroke="#00ff58" points="1066.8294,-15523.8865 1072.3559,-15532.9258 1073.6726,-15522.4131 1066.8294,-15523.8865"/>
</g>
<!-- sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~vectorutilities.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/vectorutilities.f90.html" xlink:title="VectorUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="971.153,-17875.0289 877.9053,-17875.0289 877.9053,-17853.0181 971.153,-17853.0181 971.153,-17875.0289"/>
<text text-anchor="middle" x="924.5292" y="-17860.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VectorUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge867" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M399.9194,-12530.1701C407.2493,-12628.4931 460.8054,-13358.0826 480.9653,-13951.0235 484.0955,-14043.0869 490.2347,-17178.8706 516.9653,-17267.0235 557.9245,-17402.0994 605.3819,-17420.4063 690.4731,-17533.0235 748.0132,-17609.177 784.4556,-17611.9508 831.457,-17695.0235 856.9961,-17740.1625 840.5491,-17761.6868 867.457,-17806.0235 876.7471,-17821.3308 890.8285,-17835.6985 902.6794,-17846.3045"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="900.5863,-17849.1216 910.4412,-17853.0115 905.1631,-17843.825 900.5863,-17849.1216"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge878" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M1074.6837,-17215.0235C1150.6009,-17236.1413 1187.5747,-17169.6256 1251.9829,-17215.0235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge890" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#009bff" stroke-dasharray="5,2" d="M417.606,-12507.9943C434.8598,-12497.3012 460.8695,-12480.0861 480.9653,-12462.0235 568.4852,-12383.3586 595.3117,-12363.7477 654.4731,-12262.0235 773.4078,-12057.5231 789.0435,-11992.7615 831.457,-11760.0235 864.712,-11577.5413 798.1736,-10263.0859 867.457,-10091.0235 895.4358,-10021.5394 953.6414,-10036.5152 981.6013,-9967.0235 1052.6211,-9790.511 963.9682,-8437.5721 1017.6013,-8255.0235 1025.862,-8226.9069 1044.9814,-8198.8134 1058.8206,-8180.9808"/>
<polygon fill="#009bff" stroke="#009bff" points="1061.6127,-8183.0934 1065.1196,-8173.0958 1056.1435,-8178.7243 1061.6127,-8183.0934"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge899" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0058ff" stroke-dasharray="5,2" d="M585.7192,-12119.0235C595.654,-12079.0941 637.1133,-12094.3289 654.4731,-12057.0235 704.005,-11950.5824 685.6537,-11118.326 690.4731,-11001.0235 714.7141,-10411.015 752.8339,-9687.8536 759.8395,-9556.1197"/>
<polygon fill="#0058ff" stroke="#0058ff" points="763.3348,-9556.2984 760.3716,-9546.1264 756.3447,-9555.9261 763.3348,-9556.2984"/>
</g>
<!-- sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~solarreflectionmanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/solarreflectionmanager.f90.html" xlink:title="SolarReflectionManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1322.5673,-18139.0289 1181.3986,-18139.0289 1181.3986,-18117.0181 1322.5673,-18117.0181 1322.5673,-18139.0289"/>
<text text-anchor="middle" x="1251.9829" y="-18124.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SolarReflectionManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge914" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M399.9211,-12530.1701C407.2653,-12628.4926 460.9214,-13358.0787 480.9653,-13951.0235 484.1938,-14046.5297 485.7762,-17300.6958 516.9653,-17391.0235 575.108,-17559.4121 676.3667,-17552.2485 760.9651,-17709.0235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge929" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M399.9246,-12530.1699C407.2992,-12628.4914 461.1657,-13358.0705 480.9653,-13951.0235 484.427,-14054.6928 483.3462,-17586.8958 516.9653,-17685.0235 581.461,-17873.2741 962.2448,-18345.1868 1167.7661,-18465.0235 1321.8617,-18554.8746 1388.3247,-18507.6479 1566.6973,-18509.0235 1638.7039,-18509.5788 1656.7423,-18511.2381 1728.717,-18509.0235 2176.7067,-18495.2392 2288.9305,-18487.9127 2735.2632,-18447.0235 2786.5156,-18442.3282 2799.4616,-18424.4804 2850.2146,-18433.0235"/>
</g>
<!-- sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~windowcomplexmanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/windowcomplexmanager.f90.html" xlink:title="WindowComplexManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2129.3875,-17721.0289 1980.0749,-17721.0289 1980.0749,-17699.0181 2129.3875,-17699.0181 2129.3875,-17721.0289"/>
<text text-anchor="middle" x="2054.7312" y="-17706.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowComplexManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge948" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M585.7192,-17215.0235C596.158,-17245.6594 629.7949,-17218.0829 654.4731,-17239.0235 679.9503,-17260.642 668.4023,-17279.9372 690.4731,-17305.0235 937.6312,-17585.9509 1043.7915,-17619.7043 1372.1997,-17799.0235 1453.6562,-17843.5008 1475.494,-17857.8374 1566.6973,-17875.0235 1637.4607,-17888.358 1662.535,-17903.3996 1728.717,-17875.0235 1799.7716,-17844.5584 1783.1813,-17707.8918 1848.6416,-17749.0235"/>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M399.9178,-12530.1702C407.2334,-12628.4937 460.6908,-13358.0866 480.9653,-13951.0235 484.0051,-14039.9216 480.3604,-17071.9545 516.9653,-17153.0235 533.8982,-17190.5247 571.9284,-17176.2567 585.7192,-17215.0235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge960" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M426.9183,-12507.9315C445.8996,-12498.7282 469.5831,-12483.6312 480.9653,-12462.0235 514.3088,-12398.7252 513.4292,-7382.4795 516.9653,-7311.0235 531.1916,-7023.5466 572.2003,-6675.6206 583.0562,-6586.5813"/>
<polygon fill="#ff0042" stroke="#ff0042" points="586.5624,-6586.7435 584.3051,-6576.3919 579.6144,-6585.8918 586.5624,-6586.7435"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge435" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.6837,-14211.0235C1094.8561,-14228.574 1115.6381,-14208.6968 1131.7661,-14230.0235 1184.8336,-14300.1968 1140.5721,-14937.3519 1167.7661,-15021.0235 1218.7789,-15177.9816 1249.8121,-15220.3012 1372.1997,-15331.0235 1564.1848,-15504.7098 2068.6851,-15693.0235 2253.8123,-15693.0235 2253.8123,-15693.0235 2253.8123,-15693.0235 3225.8566,-15693.0235 3402.1586,-15693.0235 3575.4289,-9566.2969 3586.7462,-9159.2439"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3590.2489,-9159.1943 3587.0276,-9149.101 3583.2515,-9159.0001 3590.2489,-9159.1943"/>
</g>
<!-- sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~datazoneequipment.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/datazoneequipment.f90.html" xlink:title="DataZoneEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1911.4652,-3585.0289 1785.818,-3585.0289 1785.818,-3563.0181 1911.4652,-3563.0181 1911.4652,-3585.0289"/>
<text text-anchor="middle" x="1848.6416" y="-3570.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge467" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M585.7192,-3867.0235C610.7365,-3786.8574 625.0934,-3769.6956 654.4731,-3691.0235 671.1451,-3646.3798 660.6919,-3627.2268 690.4731,-3590.0235 736.7809,-3532.175 778.5584,-3552.9137 831.457,-3501.0235 918.0733,-3416.0584 939.0935,-3386.6656 981.6013,-3273.0235 1023.7059,-3160.4595 963.7322,-3112.4552 1017.6013,-3005.0235 1059.4642,-2921.536 1081.2911,-2893.3043 1167.7661,-2858.0235 1237.0787,-2829.7447 1269.6211,-2823.8004 1336.1997,-2858.0235 1414.3052,-2898.1718 1765.1125,-3443.1952 1836.0943,-3554.3247"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1833.2444,-3556.3651 1841.5739,-3562.9126 1839.1454,-3552.5998 1833.2444,-3556.3651"/>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M426.9362,-12507.9409C445.9262,-12498.7422 469.6127,-12483.6468 480.9653,-12462.0235 535.6885,-12357.7923 486.2373,-4099.6657 516.9653,-3986.0235 532.9089,-3927.0592 567.9432,-3925.4615 585.7192,-3867.0235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge507" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.9098,-12530.1704C407.1566,-12628.4963 460.1374,-13358.1057 480.9653,-13951.0235 482.3044,-13989.1422 489.8185,-16670.2303 516.9653,-16697.0235 663.9403,-16842.0843 813.3847,-16816.8043 981.6013,-16697.0235 1021.4454,-16668.652 988.8893,-16632.6229 1017.6013,-16593.0235 1066.7881,-16525.1856 1091.9898,-16514.7906 1167.7661,-16479.0235 1317.6753,-16408.2651 1373.9272,-16446.8999 1530.6973,-16393.0235 1716.4725,-16329.1791 1754.5299,-16292.0395 1932.5662,-16209.0235 1987.0394,-16183.6234 2006.9883,-16187.5354 2054.7312,-16151.0235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge526" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M585.7192,-16949.0235C639.4458,-17012.8508 1254.8874,-16943.6989 1336.1997,-16925.0235 1619.0573,-16860.0581 1702.5795,-16836.0407 1932.5662,-16659.0235 2044.2987,-16573.0247 2281.1726,-16297.0242 2330.7283,-16165.0235 2365.9812,-16071.1208 2357.7558,-15362.9234 2366.7283,-15263.0235 2386.173,-15046.5261 2430.1303,-14786.6232 2443.267,-14711.3813"/>
<polygon fill="#65ff00" stroke="#65ff00" points="2446.7576,-14711.739 2445.0389,-14701.2845 2439.863,-14710.5289 2446.7576,-14711.739"/>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M399.9131,-12530.1703C407.188,-12628.4952 460.364,-13358.0978 480.9653,-13951.0235 483.7782,-14031.9808 488.8045,-16791.0698 516.9653,-16867.0235 533.499,-16911.617 559.9946,-16909.0211 585.7192,-16949.0235"/>
</g>
<!-- sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~refrigeratedcase.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/refrigeratedcase.f90.html" xlink:title="RefrigeratedCase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2502.85,-11836.0289 2391.2369,-11836.0289 2391.2369,-11814.0181 2502.85,-11814.0181 2502.85,-11836.0289"/>
<text text-anchor="middle" x="2447.0435" y="-11821.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RefrigeratedCase.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge534" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-14040.0235C630.9876,-14080.4235 1080.4753,-14012.6099 1131.7661,-14045.0235 1162.684,-14064.5623 1144.1567,-14091.0901 1167.7661,-14119.0235 1239.839,-14204.2966 1269.4317,-14221.3804 1372.1997,-14265.0235 1487.0167,-14313.7835 1856.8438,-14331.1527 1932.5662,-14232.0235 1972.9059,-14179.2142 1957.0274,-13700.4679 1968.5662,-13635.0235 2015.2597,-13370.1928 2090.7241,-13319.2173 2140.8962,-13055.0235 2175.4377,-12873.1372 2135.9267,-12820.5706 2176.8962,-12640.0235 2219.8736,-12450.6283 2269.7499,-12415.4123 2330.7283,-12231.0235 2355.6367,-12155.7043 2421.5429,-11917.6306 2441.3407,-11845.7639"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2444.7338,-11846.625 2444.0133,-11836.0547 2437.9848,-11844.7672 2444.7338,-11846.625"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge607" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M399.9157,-12530.1702C407.2129,-12628.4944 460.543,-13358.0916 480.9653,-13951.0235 483.8972,-14036.1456 473.873,-16943.5564 516.9653,-17017.0235 685.75,-17304.7805 856.3517,-17271.3848 1167.7661,-17391.0235 1254.524,-17424.354 1280.2976,-17421.1725 1372.1997,-17435.0235 1529.0604,-17458.6647 1577.2871,-17499.2798 1728.717,-17452.0235 2084.6509,-17340.9483 2805.3747,-16714.3355 3106.9189,-16495.0235 3197.7482,-16428.9637 3240.7298,-16432.3604 3308.7942,-16343.0235 3335.1532,-16308.4264 3327.8533,-16292.0829 3344.7942,-16252.0235 3365.9989,-16201.8817 3392.7697,-16143.7405 3406.8278,-16113.5711"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="3410.179,-16114.6669 3411.2402,-16104.1253 3403.8368,-16111.7042 3410.179,-16114.6669"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge701" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M1074.6837,-14211.0235C1095.4844,-14227.8246 1115.4534,-14208.8377 1131.7661,-14230.0235 1170.6171,-14280.4806 1152.368,-14740.2319 1167.7661,-14802.0235 1220.9804,-15015.5689 1224.3003,-15090.0536 1372.1997,-15253.0235 1658.6461,-15568.6579 1955.0523,-15423.3795 2330.7283,-15222.0235 2426.4315,-15170.7282 2477.3466,-15173.4036 2527.3586,-15077.0235 2569.3845,-14996.0339 2542.4178,-13523.8321 2563.3586,-13435.0235 2604.4195,-13260.8876 2674.3655,-13239.2519 2735.2632,-13071.0235 2756.9848,-13011.018 2749.5293,-12992.0246 2771.2632,-12932.0235 2799.2236,-12854.8326 2840.0804,-12846.4944 2850.2146,-12765.0235"/>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M2850.2146,-12765.0235C2858.0605,-12705.3591 2910.3203,-12712.1745 2929.166,-12655.0235 2972.3178,-12524.1624 2897.9218,-10295.2938 2965.166,-10175.0235 2972.2063,-10162.4316 2984.3972,-10152.8498 2996.7038,-10145.8328"/>
<polygon fill="#00cbff" stroke="#00cbff" points="2998.376,-10148.9081 3005.6133,-10141.1703 2995.1303,-10142.706 2998.376,-10148.9081"/>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M585.7192,-14211.0235C640.1718,-14305.0535 990.839,-14141.9091 1074.6837,-14211.0235"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1500.9974,-12742.0289 1401.8996,-12742.0289 1401.8996,-12720.0181 1500.9974,-12720.0181 1500.9974,-12742.0289"/>
<text text-anchor="middle" x="1451.4485" y="-12727.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge710" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M760.9651,-13567.0235C1060.0124,-13507.337 1177.6306,-13453.4992 1336.1997,-13193.0235 1428.0209,-13042.1921 1446.8499,-12821.4093 1450.5679,-12752.4254"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1454.0677,-12752.5124 1451.0583,-12742.354 1447.076,-12752.1719 1454.0677,-12752.5124"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge715" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-14211.0235C744.9253,-14475.9634 1463.441,-14879.9403 1764.717,-14949.0235 1837.4295,-14965.6966 1868.1711,-14986.6848 1932.5662,-14949.0235 1960.7376,-14932.5475 1951.022,-14912.5424 1968.5662,-14885.0235 2123.5176,-14641.9749 2224.8771,-14615.1244 2330.7283,-14347.0235 2418.9763,-14123.508 2441.3375,-13827.8382 2445.9771,-13746.51"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2449.4948,-13746.2742 2446.5388,-13736.1001 2442.505,-13745.897 2449.4948,-13746.2742"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge765" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1074.6837,-17215.0235C1134.6263,-17231.6976 1280.6731,-17143.0937 1336.1997,-17115.0235 1617.3244,-16972.9075 1676.797,-16915.8989 1932.5662,-16732.0235 2117.3564,-16599.1757 2183.7415,-16583.7787 2330.7283,-16410.0235 2465.5413,-16250.6592 2454.1986,-16179.9438 2563.3586,-16002.0235 2635.9969,-15883.6303 2682.1862,-15869.3828 2735.2632,-15741.0235 2765.7726,-15667.2408 2717.502,-15624.0528 2771.2632,-15565.0235 2795.9581,-15537.9087 2834.6847,-15574.2481 2850.2146,-15541.0235"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M585.7192,-16949.0235C614.6211,-16993.9665 643.6084,-16982.3548 690.4731,-17008.0235 819.038,-17078.4408 852.914,-17092.8302 981.6013,-17163.0235 1023.2028,-17185.7153 1028.6953,-17203.5927 1074.6837,-17215.0235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5539.0235C634.0937,-5396.8943 1116.4382,-5362.4601 1251.9829,-5427.0235"/>
</g>
<!-- sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~radiantsystemlowtemp.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/radiantsystemlowtemp.f90.html" xlink:title="RadiantSystemLowTemp.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2519.6933,-2295.0289 2374.3936,-2295.0289 2374.3936,-2273.0181 2519.6933,-2273.0181 2519.6933,-2295.0289"/>
<text text-anchor="middle" x="2447.0435" y="-2280.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RadiantSystemLowTemp.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M426.9372,-12507.9415C445.9277,-12498.743 469.6144,-12483.6477 480.9653,-12462.0235 537.7654,-12353.8159 467.072,-3774.5842 516.9653,-3663.0235 550.5626,-3587.9006 603.4877,-3603.6201 654.4731,-3539.0235 675.1745,-3512.7957 673.614,-3501.8716 690.4731,-3473.0235 813.6914,-3262.1821 895.5039,-3235.5494 981.6013,-3007.0235 1016.5323,-2914.3072 983.8497,-2880.1756 1017.6013,-2787.0235 1112.5281,-2525.0325 1236.3962,-2507.1958 1336.1997,-2247.0235 1365.1076,-2171.665 1314.3761,-2125.3351 1372.1997,-2069.0235 1418.7109,-2023.7286 1830.6499,-2018.4252 1848.6416,-2017.0235"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1848.6416,-2017.0235C2027.8062,-1998.9309 2108.1814,-1911.1038 2253.8123,-2017.0235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M425.5221,-12507.9902C444.3321,-12498.6577 468.41,-12483.3742 480.9653,-12462.0235 521.3835,-12393.2911 496.7264,-12182.1478 516.9653,-12105.0235 555.6358,-11957.6623 622.5738,-11939.9973 654.4731,-11791.0235 677.4362,-11683.7832 626.2266,-7931.9063 690.4731,-7843.0235 729.2489,-7789.3787 784.5336,-7841.7088 831.457,-7795.0235 866.1317,-7760.5248 835.288,-7727.8698 867.457,-7691.0235 965.8411,-7578.3348 1023.8532,-7579.8556 1167.7661,-7539.0235 1231.1256,-7521.0467 1305.3841,-7515.2817 1362.0299,-7513.8863"/>
<polygon fill="#5cff00" stroke="#5cff00" points="1362.1107,-7517.3855 1372.0366,-7513.6805 1361.9667,-7510.3869 1362.1107,-7517.3855"/>
</g>
<!-- sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node47" class="node">
<title>sourcefile~ventilatedslab.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node47"><a xlink:href="../sourcefile/ventilatedslab.f90.html" xlink:title="VentilatedSlab.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3464.6171,-5570.0289 3368.3033,-5570.0289 3368.3033,-5548.0181 3464.6171,-5548.0181 3464.6171,-5570.0289"/>
<text text-anchor="middle" x="3416.4602" y="-5555.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VentilatedSlab.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge395" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M760.9651,-6033.0235C803.6487,-6032.0229 2136.8117,-6616.3224 2176.8962,-6631.0235 2345.8734,-6692.9963 2385.4429,-6724.8222 2563.3586,-6752.0235 2638.8831,-6763.5704 2662.4986,-6775.317 2735.2632,-6752.0235 2795.0316,-6732.8904 2787.7154,-6675.6972 2850.2146,-6670.0235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge423" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M1074.6837,-2193.0235C1093.4713,-2166.4033 1111.8492,-2172.8097 1131.7661,-2147.0235 1155.5997,-2116.1665 1138.4086,-2092.6815 1167.7661,-2067.0235 1172.0008,-2063.3225 1176.7628,-2060.169 1181.8125,-2057.482"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="1183.5709,-2060.5242 1191.1607,-2053.1319 1180.6176,-2054.1777 1183.5709,-2060.5242"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M426.939,-12507.9424C445.9303,-12498.7443 469.6173,-12483.6492 480.9653,-12462.0235 541.6749,-12346.331 453.4272,-3169.187 516.9653,-3055.0235 552.0199,-2992.0385 612.0005,-3027.2645 654.4731,-2969.0235 692.8359,-2916.4183 666.4744,-2887.5468 690.4731,-2827.0235 738.0642,-2707.0018 785.8048,-2693.796 831.457,-2573.0235 857.843,-2503.2197 829.8089,-2473.4549 867.457,-2409.0235 901.7807,-2350.2816 942.5698,-2362.7484 981.6013,-2307.0235 1006.3171,-2271.7371 987.4059,-2247.752 1017.6013,-2217.0235 1036.8907,-2197.3936 1058.8146,-2215.5087 1074.6837,-2193.0235"/>
</g>
<!-- sourcefile~plantutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node53" class="node">
<title>sourcefile~plantutilities.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node53"><a xlink:href="../sourcefile/plantutilities.f90.html" xlink:title="PlantUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2297.5969,-12671.0289 2210.0276,-12671.0289 2210.0276,-12649.0181 2297.5969,-12649.0181 2297.5969,-12671.0289"/>
<text text-anchor="middle" x="2253.8123" y="-12656.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M585.7192,-13567.0235C634.7973,-13603.8872 632.9175,-13635.6944 690.4731,-13657.0235 749.2279,-13678.7971 769.2698,-13664.7018 831.457,-13657.0235 1239.4879,-13606.6438 1366.5996,-13626.6982 1728.717,-13432.0235 1947.3825,-13314.4688 2028.6882,-13276.4802 2140.8962,-13055.0235 2207.9787,-12922.6279 2106.2258,-12853.5391 2176.8962,-12723.0235 2187.5063,-12703.4287 2206.9746,-12687.5758 2223.6693,-12676.6737"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="2225.9381,-12679.3846 2232.5848,-12671.1341 2222.2437,-12673.4389 2225.9381,-12679.3846"/>
</g>
<!-- sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node54" class="node">
<title>sourcefile~datasurfacelists.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node54"><a xlink:href="../sourcefile/datasurfacelists.f90.html" xlink:title="DataSurfaceLists.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1306.9524,-2970.0289 1197.0134,-2970.0289 1197.0134,-2948.0181 1306.9524,-2948.0181 1306.9524,-2970.0289"/>
<text text-anchor="middle" x="1251.9829" y="-2955.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaceLists.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M760.9651,-3867.0235C884.6357,-3808.9928 916.9475,-3773.3642 981.6013,-3653.0235 1022.6914,-3576.5422 957.9265,-3524.0845 1017.6013,-3461.0235 1035.5558,-3442.0502 1067.8445,-3472.2341 1074.6837,-3447.0235"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1074.6837,-3447.0235C1081.9818,-3420.4877 1115.6122,-3445.3049 1131.7661,-3423.0235 1189.2201,-3343.7763 1106.0639,-3060.0099 1167.7661,-2984.0235 1172.9712,-2977.6134 1179.7415,-2972.7964 1187.182,-2969.1854"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="1188.9573,-2972.2415 1196.8978,-2965.2273 1186.3163,-2965.7588 1188.9573,-2972.2415"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M585.7192,-4000.0235C612.4882,-3938.3967 633.7871,-3927.0947 690.4731,-3891.0235 718.3952,-3873.2558 732.3132,-3883.5886 760.9651,-3867.0235"/>
</g>
<!-- sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node55" class="node">
<title>sourcefile~reportsizingmanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node55"><a xlink:href="../sourcefile/reportsizingmanager.f90.html" xlink:title="ReportSizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2319.3073,-6133.0289 2188.3172,-6133.0289 2188.3172,-6111.0181 2319.3073,-6111.0181 2319.3073,-6133.0289"/>
<text text-anchor="middle" x="2253.8123" y="-6118.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ReportSizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M585.7192,-5767.0235C590.95,-5760.7173 1159.6505,-5861.8987 1167.7661,-5863.0235 1506.5808,-5909.9825 1606.0933,-5846.9648 1932.5662,-5949.0235 2052.0548,-5986.3769 2178.5123,-6069.1632 2229.9641,-6104.971"/>
<polygon fill="#5cff00" stroke="#5cff00" points="2228.2067,-6108.0135 2238.4028,-6110.8928 2232.2276,-6102.2836 2228.2067,-6108.0135"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node58" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node58"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1524.7031,-9013.0289 1378.1939,-9013.0289 1378.1939,-8991.0181 1524.7031,-8991.0181 1524.7031,-9013.0289"/>
<text text-anchor="middle" x="1451.4485" y="-8998.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M426.8405,-12508.016C477.9318,-12486.5332 587.7304,-12434.5163 654.4731,-12360.0235 775.8475,-12224.5555 788.3458,-12167.7287 831.457,-11991.0235 891.9007,-11743.2758 832.4888,-11096.6291 867.457,-10844.0235 896.282,-10635.7959 935.6105,-10590.1441 981.6013,-10385.0235 999.4505,-10305.4157 999.9214,-10284.6691 1017.6013,-10205.0235 1032.8447,-10136.3542 1127.6064,-9647.7732 1167.7661,-9590.0235 1193.5704,-9552.9169 1231.742,-9573.4347 1251.9829,-9533.0235"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node59" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node59"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2092.3576,-10655.0289 2017.1048,-10655.0289 2017.1048,-10633.0181 2092.3576,-10633.0181 2092.3576,-10655.0289"/>
<text text-anchor="middle" x="2054.7312" y="-10640.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M760.9651,-12499.0235C832.2279,-12407.9232 923.4329,-12460.9939 981.6013,-12361.0235 1029.4209,-12278.839 963.4397,-11584.1741 1017.6013,-11506.0235 1039.5012,-11474.4238 1303.0455,-11390.4901 1336.1997,-11371.0235 1353.6792,-11360.7604 1356.0802,-11355.3127 1372.1997,-11343.0235 1582.4123,-11182.7618 1587.3146,-11026.7901 1848.6416,-10987.0235"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node61" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node61"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1707.0427,-8405.0289 1588.3716,-8405.0289 1588.3716,-8383.0181 1707.0427,-8383.0181 1707.0427,-8405.0289"/>
<text text-anchor="middle" x="1647.7072" y="-8390.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M585.7192,-3867.0235C613.4838,-3777.9184 625.3299,-3751.8588 690.4731,-3685.0235 754.7912,-3619.0348 783.8764,-3615.8255 867.457,-3577.0235 915.9539,-3554.509 948.5047,-3581.0171 981.6013,-3539.0235 1039.5862,-3465.4514 978.0564,-3203.943 1017.6013,-3119.0235 1047.8715,-3054.0207 1093.961,-3065.9532 1131.7661,-3005.0235 1158.2198,-2962.3886 1127.021,-2927.3043 1167.7661,-2898.0235 1228.5564,-2854.3376 1282.8872,-2845.4716 1336.1997,-2898.0235 1385.7599,-2946.8766 1344.9553,-5338.9877 1372.1997,-5403.0235 1411.0176,-5494.2615 1491.3653,-5469.0059 1530.6973,-5560.0235 1561.6266,-5631.5966 1563.4934,-6885.1193 1566.6973,-6963.0235 1590.344,-7538.0189 1637.3804,-8241.9947 1646.2473,-8372.6392"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1642.7734,-8373.1428 1646.9441,-8382.8821 1649.7572,-8372.6676 1642.7734,-8373.1428"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node62" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node62"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1501.5758,-12701.0289 1401.3212,-12701.0289 1401.3212,-12679.0181 1501.5758,-12679.0181 1501.5758,-12701.0289"/>
<text text-anchor="middle" x="1451.4485" y="-12686.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M760.9651,-13567.0235C822.0506,-13556.5991 819.4234,-13516.1754 867.457,-13477.0235 933.2445,-13423.4006 946.2174,-13404.9338 1017.6013,-13359.0235 1065.639,-13328.1282 1086.1632,-13334.4113 1131.7661,-13300.0235 1237.5612,-13220.2466 1281.4416,-13203.6822 1336.1997,-13083.0235 1370.5221,-13007.3945 1318.4345,-12774.325 1372.1997,-12711.0235 1377.3826,-12704.9213 1384.114,-12700.4868 1391.4632,-12697.2818"/>
<polygon fill="#ff008b" stroke="#ff008b" points="1392.803,-12700.5196 1401.0324,-12693.8468 1390.4379,-12693.9313 1392.803,-12700.5196"/>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M585.7192,-13567.0235C647.9953,-13613.8005 684.5845,-13582.2682 760.9651,-13567.0235"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node64" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node64"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1912.1443,-10465.0289 1785.1389,-10465.0289 1785.1389,-10443.0181 1912.1443,-10443.0181 1912.1443,-10465.0289"/>
<text text-anchor="middle" x="1848.6416" y="-10450.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.2168,-12530.312C405.1801,-12573.8257 428.8662,-12732.4507 516.9653,-12817.0235 540.3137,-12839.4373 555.3088,-12829.9451 585.7192,-12841.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-12499.0235C788.4085,-12467.5955 808.1977,-12471.6626 831.457,-12437.0235 858.7242,-12396.4157 848.8509,-12378.2596 867.457,-12333.0235 912.0821,-12224.5286 952.5503,-12208.6835 981.6013,-12095.0235 1055.9973,-11803.9544 961.7703,-11715.2165 1017.6013,-11420.0235 1044.7083,-11276.702 1340.7226,-10275.9742 1451.4485,-10181.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-12841.0235C746.1956,-12899.4847 655.734,-12633.5479 760.9651,-12499.0235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M426.9289,-12507.9371C445.9153,-12498.7365 469.6006,-12483.6404 480.9653,-12462.0235 524.3267,-12379.5453 502.2932,-5845.043 516.9653,-5753.0235 532.6951,-5654.3704 554.4429,-5633.9006 585.7192,-5539.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5539.0235C722.4223,-5124.3341 822.4027,-4895.2277 1251.9829,-4817.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.9829,-4817.0235C1319.7195,-4802.1044 1394.4549,-4850.6918 1430.1652,-4878.2886"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1428.3656,-4881.3285 1438.3752,-4884.801 1432.7158,-4875.8443 1428.3656,-4881.3285"/>
</g>
<!-- sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node66" class="node">
<title>sourcefile~hvacfancomponent.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node66"><a xlink:href="../sourcefile/hvacfancomponent.f90.html" xlink:title="HVACFanComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2714.6003,-6743.0289 2584.0215,-6743.0289 2584.0215,-6721.0181 2714.6003,-6721.0181 2714.6003,-6743.0289"/>
<text text-anchor="middle" x="2649.3109" y="-6728.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFanComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M426.9268,-12507.936C445.9122,-12498.7349 469.5972,-12483.6386 480.9653,-12462.0235 521.9154,-12384.1618 463.4849,-6197.8749 516.9653,-6128.0235 536.2378,-6102.8515 565.6608,-6133.5738 585.7192,-6109.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-6109.0235C639.4333,-6043.2806 676.127,-6036.1584 760.9651,-6033.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-6033.0235C907.0696,-6027.6247 1984.9362,-6144.5543 2054.7312,-6273.0235"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node67" class="node">
<title>sourcefile~hvachxassistedcoolingcoil.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node67"><a xlink:href="../sourcefile/hvachxassistedcoolingcoil.f90.html" xlink:title="HVACHXAssistedCoolingCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3308.7319,-4308.0289 3142.9813,-4308.0289 3142.9813,-4286.0181 3308.7319,-4286.0181 3308.7319,-4308.0289"/>
<text text-anchor="middle" x="3225.8566" y="-4293.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACHXAssistedCoolingCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge282" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M585.7192,-5767.0235C653.1163,-5680.857 722.4454,-5771.8857 831.457,-5781.0235 1322.1128,-5822.1523 1448.5219,-5812.8247 1932.5662,-5903.0235 2026.7091,-5920.5665 2064.9443,-5899.6972 2140.8962,-5958.0235 2166.4736,-5977.6653 2149.0037,-6004.8369 2176.8962,-6021.0235 2391.535,-6145.5832 2498.2282,-6094.5038 2735.2632,-6021.0235 3304.1927,-5844.6567 2761.7381,-5243.7419 3036.0425,-4715.0235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge290" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M426.229,-12507.9716C445.1346,-12498.7102 469.0214,-12483.5242 480.9653,-12462.0235 556.4973,-12326.0553 450.1202,-11903.4663 516.9653,-11763.0235 552.3321,-11688.7173 620.6779,-11714.0576 654.4731,-11639.0235 742.1772,-11444.2981 608.1761,-7992.095 690.4731,-7795.0235 724.7437,-7712.958 785.4401,-7729.1265 831.457,-7653.0235 858.9495,-7607.5562 833.0636,-7579.5229 867.457,-7539.0235 915.8709,-7482.0145 949.7204,-7494.426 1017.6013,-7463.0235 1168.2759,-7393.3196 1250.5642,-7410.2488 1336.1997,-7268.0235 1396.8291,-7167.329 1283.611,-7083.2721 1372.1997,-7006.0235 1437.2358,-6949.3126 1874.6534,-7085.6668 1932.5662,-7138.0235 2031.7734,-7227.713 1933.0866,-7357.4458 2054.7312,-7413.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2054.7312,-7413.0235C2296.5199,-7519.6554 2386.1054,-7389.4655 2649.3109,-7413.0235"/>
</g>
<!-- sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node69" class="node">
<title>sourcefile~outairnodemanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node69"><a xlink:href="../sourcefile/outairnodemanager.f90.html" xlink:title="OutAirNodeManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1911.3808,-8789.0289 1785.9024,-8789.0289 1785.9024,-8767.0181 1911.3808,-8767.0181 1911.3808,-8789.0289"/>
<text text-anchor="middle" x="1848.6416" y="-8774.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutAirNodeManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge319" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M424.6755,-12507.9075C443.3049,-12498.4481 467.5338,-12483.04 480.9653,-12462.0235 530.5451,-12384.4458 488.2655,-12345.5036 516.9653,-12258.0235 538.4501,-12192.5357 569.0782,-12185.9064 585.7192,-12119.0235"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-12119.0235C604.1116,-12045.1019 638.5126,-12036.5081 654.4731,-11962.0235 699.0104,-11754.1767 623.9159,-8337.8997 690.4731,-8136.0235 732.4206,-8008.7917 784.8214,-7997.4695 867.457,-7892.0235 915.9228,-7830.1795 942.7265,-7825.305 981.6013,-7757.0235 1005.8018,-7714.5167 977.7572,-7681.395 1017.6013,-7653.0235 1294.5717,-7455.8032 1111.2282,-7740.3937 1566.6973,-8179.0235 1632.0123,-8241.9238 1685.348,-8223.3892 1728.717,-8303.0235 1776.6974,-8391.1251 1701.5936,-8675.0528 1764.717,-8753.0235 1768.098,-8757.1998 1772.1452,-8760.6994 1776.61,-8763.6296"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1775.1957,-8766.8459 1785.6458,-8768.5909 1778.5648,-8760.71 1775.1957,-8766.8459"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge347" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2447.0435,-1922.0235C2468.914,-1955.3688 2504.9134,-1929.0623 2527.3586,-1962.0235 2579.2119,-2038.1707 2541.5134,-2285.5252 2563.3586,-2375.0235 2610.796,-2569.3708 2686.3901,-2597.0323 2735.2632,-2791.0235 2763.3071,-2902.3378 2835.929,-3748.589 2848.3838,-3895.361"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2844.9294,-3896.049 2849.2612,-3905.7178 2851.9044,-3895.458 2844.9294,-3896.049"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M426.9376,-12507.9417C445.9282,-12498.7433 469.615,-12483.648 480.9653,-12462.0235 538.5627,-12352.2894 441.7068,-3637.4876 516.9653,-3539.0235 555.4687,-3488.6478 612.3055,-3548.3745 654.4731,-3501.0235 723.8679,-3423.0987 660.0255,-3368.8275 690.4731,-3269.0235 790.4436,-2941.3315 857.0202,-2873.6617 1017.6013,-2571.0235 1078.7105,-2455.8546 1084.4109,-2419.2738 1167.7661,-2319.0235 1231.4779,-2242.3981 1291.5338,-2260.1055 1336.1997,-2171.0235 1381.2638,-2081.1474 1299.7368,-1789.7201 1372.1997,-1720.0235 1433.7766,-1660.7974 2056.5862,-1687.1938 2140.8962,-1701.0235 2228.7577,-1715.4358 2259.8298,-1711.1648 2330.7283,-1765.0235 2353.4033,-1782.2488 2350.0181,-1794.9663 2366.7283,-1818.0235 2400.9993,-1865.3117 2413.4523,-1874.25 2447.0435,-1922.0235"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node71" class="node">
<title>sourcefile~hvacsteamcoilcomponent.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node71"><a xlink:href="../sourcefile/hvacsteamcoilcomponent.f90.html" xlink:title="HVACSteamCoilComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2527.1743,-10237.0289 2366.9127,-10237.0289 2366.9127,-10215.0181 2527.1743,-10215.0181 2527.1743,-10237.0289"/>
<text text-anchor="middle" x="2447.0435" y="-10222.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACSteamCoilComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge383" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M585.7192,-12841.0235C676.1796,-12873.978 926.5798,-12744.028 981.6013,-12665.0235 1052.8678,-12562.6931 978.0581,-12223.2891 1017.6013,-12105.0235 1026.4115,-12078.674 1543.7643,-11284.7077 1566.6973,-11269.0235 1703.9342,-11175.1656 1780.7661,-11258.847 1932.5662,-11191.0235 2037.2123,-11144.2682 2054.8309,-11114.7178 2140.8962,-11039.0235 2158.3655,-11023.6593 2156.4379,-11012.1001 2176.8962,-11001.0235 2207.4518,-10984.4801 2231.7723,-11013.8854 2253.8123,-10987.0235"/>
</g>
<!-- sourcefile~emsmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node72" class="node">
<title>sourcefile~emsmanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node72"><a xlink:href="../sourcefile/emsmanager.f90.html" xlink:title="EMSManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2493.6776,-5223.0289 2400.4093,-5223.0289 2400.4093,-5201.0181 2493.6776,-5201.0181 2493.6776,-5223.0289"/>
<text text-anchor="middle" x="2447.0435" y="-5208.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EMSManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M426.927,-12507.9361C445.9125,-12498.735 469.5975,-12483.6388 480.9653,-12462.0235 522.1276,-12383.7555 507.5969,-6182.9578 516.9653,-6095.0235 532.7446,-5946.9157 495.7103,-5885.6966 585.7192,-5767.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5767.0235C638.4386,-5697.5152 614.0782,-5643.1489 690.4731,-5601.0235 745.3436,-5570.7671 769.3277,-5592.8899 831.457,-5601.0235 968.4138,-5618.953 1011.6131,-5612.8921 1131.7661,-5681.0235 1151.1779,-5692.0307 1147.0898,-5707.6292 1167.7661,-5716.0235 1237.1272,-5744.1832 1261.7369,-5723.7184 1336.1997,-5716.0235 1347.2793,-5714.8786 1721.1936,-5642.2374 1728.717,-5634.0235 1820.3153,-5534.0192 1671.1052,-5429.1455 1764.717,-5331.0235 1790.8202,-5303.6627 1826.1593,-5347.4297 1848.6416,-5317.0235"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node74" class="node">
<title>sourcefile~runtimelanguageprocessor.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node74"><a xlink:href="../sourcefile/runtimelanguageprocessor.f90.html" xlink:title="RuntimeLanguageProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1728.7269,-5591.0289 1566.6874,-5591.0289 1566.6874,-5569.0181 1728.7269,-5569.0181 1728.7269,-5591.0289"/>
<text text-anchor="middle" x="1647.7072" y="-5576.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RuntimeLanguageProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5539.0235C673.3665,-5340.1646 859.4862,-5569.3048 1074.6837,-5539.0235"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node76" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node76"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="654.2279,-4865.0289 517.2105,-4865.0289 517.2105,-4843.0181 654.2279,-4843.0181 654.2279,-4865.0289"/>
<text text-anchor="middle" x="585.7192" y="-4850.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M426.9316,-12507.9385C445.9194,-12498.7386 469.6052,-12483.6428 480.9653,-12462.0235 527.9918,-12372.5282 506.3213,-5283.5601 516.9653,-5183.0235 529.4689,-5064.9236 565.5471,-4926.6625 579.8128,-4874.9416"/>
<polygon fill="#00ffff" stroke="#00ffff" points="583.1987,-4875.8293 582.5096,-4865.2569 576.4553,-4873.9515 583.1987,-4875.8293"/>
</g>
<!-- sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node78" class="node">
<title>sourcefile~dxcoil.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node78"><a xlink:href="../sourcefile/dxcoil.f90.html" xlink:title="DXCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2881.4026,-4803.0289 2819.0266,-4803.0289 2819.0266,-4781.0181 2881.4026,-4781.0181 2881.4026,-4803.0289"/>
<text text-anchor="middle" x="2850.2146" y="-4788.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DXCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge230" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M426.9331,-12507.9393C445.9216,-12498.7398 469.6076,-12483.6441 480.9653,-12462.0235 530.2359,-12368.2318 480.6392,-4933.5468 516.9653,-4834.0235 765.6572,-4152.679 1208.0842,-3987.3276 1932.5662,-4022.0235 2025.4765,-4026.473 2076.4816,-3974.9199 2140.8962,-4042.0235 2242,-4147.3477 2083.7698,-4585.584 2176.8962,-4698.0235 2199.357,-4725.1423 2235.4211,-4686.9955 2253.8123,-4717.0235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge268" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2649.3109,-1637.0235C2753.1695,-1678.8558 2768.8825,-1712.0713 2850.2146,-1789.0235"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M426.9378,-12507.9418C445.9285,-12498.7434 469.6154,-12483.6482 480.9653,-12462.0235 538.9871,-12351.4769 498.1576,-3596.447 516.9653,-3473.0235 548.2775,-3267.5412 593.8224,-3224.8323 654.4731,-3026.0235 670.5966,-2973.1721 665.8269,-2956.4785 690.4731,-2907.0235 737.8539,-2811.9493 778.0428,-2805.8438 831.457,-2714.0235 851.0624,-2680.3215 850.0214,-2668.8975 867.457,-2634.0235 929.2061,-2510.5157 941.3142,-2477.1208 1017.6013,-2362.0235 1047.43,-2317.0198 1127.8748,-2207.4071 1167.7661,-2171.0235 1233.6468,-2110.9358 1289.9114,-2138.235 1336.1997,-2062.0235 1379.8881,-1990.0927 1321.4583,-1752.1653 1372.1997,-1685.0235 1485.0892,-1535.6464 1581.5122,-1570.6699 1764.717,-1532.0235 1853.4521,-1513.3052 1877.9004,-1525.024 1968.5662,-1523.0235 2218.0577,-1517.5186 2289.2107,-1503.4454 2527.3586,-1578.0235 2584.818,-1596.0174 2593.4602,-1614.5279 2649.3109,-1637.0235"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2850.2146,-1789.0235C2985.0261,-1916.575 3024.5469,-2155.2922 3033.6813,-2227.6782"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3030.2321,-2228.3121 3034.8964,-2237.825 3037.1825,-2227.4798 3030.2321,-2228.3121"/>
</g>
<!-- sourcefile~globalnames.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node80" class="node">
<title>sourcefile~globalnames.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node80"><a xlink:href="../sourcefile/globalnames.f90.html" xlink:title="GlobalNames.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2300.4361,-7081.0289 2207.1884,-7081.0289 2207.1884,-7059.0181 2300.4361,-7059.0181 2300.4361,-7081.0289"/>
<text text-anchor="middle" x="2253.8123" y="-7066.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GlobalNames.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-6109.0235C655.8398,-6024.6127 729.5161,-6092.4016 831.457,-6133.0235 850.2869,-6140.5269 850.9007,-6149.3293 867.457,-6161.0235 932.1515,-6206.719 948.8242,-6217.7405 1017.6013,-6257.0235 1420.3696,-6487.0699 1604.8482,-6430.7788 1932.5662,-6759.0235 1954.5384,-6781.0311 1945.5928,-6798.0631 1968.5662,-6819.0235 2031.3669,-6876.3215 2087.1586,-6836.1504 2140.8962,-6902.0235 2182.3245,-6952.8074 2132.1469,-6997.1403 2176.8962,-7045.0235 2182.6845,-7051.2171 2190.0207,-7055.8799 2197.8527,-7059.3893"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2196.622,-7062.6659 2207.2115,-7063.0019 2199.1428,-7056.1355 2196.622,-7062.6659"/>
</g>
<!-- sourcefile~watermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node81" class="node">
<title>sourcefile~watermanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node81"><a xlink:href="../sourcefile/watermanager.f90.html" xlink:title="WaterManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1300.9824,-7259.0289 1202.9834,-7259.0289 1202.9834,-7237.0181 1300.9824,-7237.0181 1300.9824,-7259.0289"/>
<text text-anchor="middle" x="1251.9829" y="-7244.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WaterManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M426.2878,-12508.0041C445.2226,-12498.7589 469.1202,-12483.5788 480.9653,-12462.0235 572.1221,-12296.1396 421.754,-11774.6139 516.9653,-11611.0235 553.2243,-11548.7241 619.2376,-11587.9074 654.4731,-11525.0235 705.5029,-11433.9521 664.0732,-7868.0239 690.4731,-7767.0235 723.4194,-7640.978 774.6505,-7627.2666 831.457,-7510.0235 849.3459,-7473.1027 834.6172,-7449.6142 867.457,-7425.0235 941.6726,-7369.4504 1006.4268,-7463.7716 1074.6837,-7401.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1074.6837,-7401.0235C1104.2614,-7373.3731 1108.2325,-7362.9713 1131.7661,-7330.0235 1149.1815,-7305.6415 1143.8773,-7291.1095 1167.7661,-7273.0235 1175.347,-7267.2841 1184.2301,-7262.8575 1193.3317,-7259.4446"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1194.4881,-7262.7484 1202.8501,-7256.2425 1192.2561,-7256.1138 1194.4881,-7262.7484"/>
</g>
<!-- sourcefile~standardratings.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node82" class="node">
<title>sourcefile~standardratings.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node82"><a xlink:href="../sourcefile/standardratings.f90.html" xlink:title="StandardRatings.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2307.5431,-3662.0289 2200.0815,-3662.0289 2200.0815,-3640.0181 2307.5431,-3640.0181 2307.5431,-3662.0289"/>
<text text-anchor="middle" x="2253.8123" y="-3647.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">StandardRatings.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge224" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M760.9651,-3867.0235C903.9356,-3784.3652 1011.4334,-3956.1297 1131.7661,-3843.0235 1177.9592,-3799.6045 1141.9655,-3617.9315 1167.7661,-3560.0235 1268.5512,-3333.8174 1332.552,-3251.6637 1566.6973,-3171.0235 1880.2499,-3063.0352 2180.0787,-3527.7185 2242.1259,-3631.0379"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2239.262,-3633.0698 2247.3807,-3639.8771 2245.2791,-3629.4927 2239.262,-3633.0698"/>
</g>
<!-- sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node83" class="node">
<title>sourcefile~setpointmanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node83"><a xlink:href="../sourcefile/setpointmanager.f90.html" xlink:title="SetPointManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2704.3844,-3889.0289 2594.2374,-3889.0289 2594.2374,-3867.0181 2704.3844,-3867.0181 2704.3844,-3889.0289"/>
<text text-anchor="middle" x="2649.3109" y="-3874.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SetPointManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge324" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M426.9366,-12507.9412C445.9268,-12498.7425 469.6134,-12483.6472 480.9653,-12462.0235 536.5437,-12356.155 485.7589,-3968.4499 516.9653,-3853.0235 548.8485,-3735.0939 605.2299,-3726.8226 654.4731,-3615.0235 675.8907,-3566.3984 660.5442,-3544.9253 690.4731,-3501.0235 735.8632,-3434.4423 786.0669,-3453.6048 831.457,-3387.0235 861.386,-3343.1217 842.542,-3319.9527 867.457,-3273.0235 905.7526,-3200.8912 949.1253,-3203.9563 981.6013,-3129.0235 1024.8426,-3029.2518 978.0517,-2988.3153 1017.6013,-2887.0235 1060.7924,-2776.4055 1093.87,-2758.9815 1167.7661,-2666.0235 1251.0282,-2561.2836 1258.6269,-2515.7642 1372.1997,-2445.0235 1448.7668,-2397.3325 1477.4376,-2400.0489 1566.6973,-2387.0235 1826.3105,-2349.1389 1996.3242,-2305.087 2140.8962,-2524.0235 2220.2459,-2644.1887 2126.7598,-3036.0332 2176.8962,-3171.0235 2196.4183,-3223.5859 2212.6933,-3232.9034 2253.8123,-3271.0235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge490" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-13031.0235C1186.7504,-12998.3142 1239.3695,-12847.897 1336.1997,-12602.0235 1380.399,-12489.7918 1294.0434,-12424.8991 1372.1997,-12333.0235 1419.8904,-12276.9613 1483.2979,-12341.3323 1530.6973,-12285.0235 1614.9055,-12184.9873 1491.2611,-12099.8301 1566.6973,-11993.0235 1613.1417,-11927.265 1671.6294,-11968.7885 1728.717,-11912.0235 1753.8053,-11887.077 1734.5688,-11859.5393 1764.717,-11841.0235 1828.2852,-11801.9826 1873.9128,-11794.927 1932.5662,-11841.0235 1985.7914,-11882.854 1921.7572,-11940.1191 1968.5662,-11989.0235 1971.804,-11992.4063 1975.4696,-11995.3393 1979.4179,-11997.8816"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1978.0066,-12001.0996 1988.4565,-12002.8458 1981.3764,-11994.964 1978.0066,-12001.0996"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge572" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-16759.0235C2487.9273,-16713.8963 2503.3178,-16703.9698 2527.3586,-16648.0235 2561.6358,-16568.256 2521.3648,-16532.0123 2563.3586,-16456.0235 2613.697,-16364.9351 2676.9244,-16383.2072 2735.2632,-16297.0235 2760.3408,-16259.9763 2751.1842,-16243.0012 2771.2632,-16203.0235 2830.0783,-16085.921 2870.5571,-16071.2293 2929.166,-15954.0235 2949.3603,-15913.639 2943.4554,-15898.6135 2965.166,-15859.0235 3015.8249,-15766.6454 3072.6107,-15768.6376 3106.9189,-15669.0235 3199.3524,-15400.6427 3224.0127,-10734.8061 3225.7547,-10380.3138"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3229.2555,-10380.1252 3225.8043,-10370.1083 3222.2556,-10380.0911 3229.2555,-10380.1252"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.9148,-12530.1703C407.2042,-12628.4947 460.4806,-13358.0938 480.9653,-13951.0235 483.8544,-14034.6463 474.0402,-16891.2005 516.9653,-16963.0235 562.1778,-17038.6736 612.8083,-17017.3669 690.4731,-17059.0235 905.9923,-17174.6202 1520.3189,-17552.0131 1728.717,-17424.0235 1758.8653,-17405.5077 1743.6836,-17381.4726 1764.717,-17353.0235 1985.5938,-17054.2737 2035.4257,-16941.1801 2366.7283,-16773.0235 2399.0385,-16756.6241 2423.8227,-16786.8388 2447.0435,-16759.0235"/>
</g>
<!-- sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node88" class="node">
<title>sourcefile~hvacmixercomponent.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node88"><a xlink:href="../sourcefile/hvacmixercomponent.f90.html" xlink:title="HVACMixerComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1917.5032,-14223.0289 1779.78,-14223.0289 1779.78,-14201.0181 1917.5032,-14201.0181 1917.5032,-14223.0289"/>
<text text-anchor="middle" x="1848.6416" y="-14208.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACMixerComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge563" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-14040.0235C625.3671,-14068.1841 969.1316,-13972.9811 1017.6013,-13969.0235 1068.1729,-13964.8943 1084.4695,-13950.6504 1131.7661,-13969.0235 1308.3699,-14037.6281 1265.8906,-14289.2824 1451.4485,-14251.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1451.4485,-14251.0235C1540.1248,-14250.0786 1559.2019,-14281.4375 1647.7072,-14287.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.3672,-12530.2037C402.7145,-12659.2152 436.0475,-13863.7733 516.9653,-13997.0235 535.6727,-14027.8296 558.8292,-14016.0254 585.7192,-14040.0235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge671" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.2227,-12530.1649C400.6359,-12630.8607 414.5717,-13384.6683 516.9653,-13581.0235 583.6607,-13708.922 616.7212,-13795.0235 760.9651,-13795.0235 760.9651,-13795.0235 760.9651,-13795.0235 924.5292,-13795.0235 1409.3664,-13795.0235 1536.8207,-13658.1176 1932.5662,-13378.0235 2035.3445,-13305.2808 2055.4817,-13278.5398 2140.8962,-13186.0235 2329.7533,-12981.4641 2384.6191,-12932.0569 2527.3586,-12693.0235 2645.7172,-12494.8187 2681.9253,-12441.632 2735.2632,-12217.0235 2836.4055,-11791.1083 2848.887,-10324.1305 2850.0991,-10131.055"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2853.599,-10131.0721 2850.1588,-10121.0514 2846.5991,-10131.0303 2853.599,-10131.0721"/>
</g>
<!-- sourcefile~windturbine.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node90" class="node">
<title>sourcefile~windturbine.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node90"><a xlink:href="../sourcefile/windturbine.f90.html" xlink:title="WindTurbine.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1691.8609,-11903.0289 1603.5534,-11903.0289 1603.5534,-11881.0181 1691.8609,-11881.0181 1691.8609,-11903.0289"/>
<text text-anchor="middle" x="1647.7072" y="-11888.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindTurbine.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge685" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M924.5292,-13031.0235C954.0693,-13030.5039 1174.3544,-12801.2956 1336.1997,-12437.0235 1362.6352,-12377.5241 1327.2272,-12342.1031 1372.1997,-12295.0235 1397.6199,-12268.4123 1432.7307,-12302.7093 1451.4485,-12271.0235"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M760.9651,-12993.0235C830.8845,-13019.1214 850.4719,-13040.2614 924.5292,-13031.0235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge616" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-12993.0235C856.3929,-13028.6426 909.7838,-13003.2553 981.6013,-12931.0235 1024.1739,-12888.2053 998.0231,-12857.142 1017.6013,-12800.0235 1074.2124,-12634.8635 1083.5237,-12589.9479 1167.7661,-12437.0235 1516.2964,-11804.3399 1583.4659,-11574.8515 2176.8962,-11163.0235 2237.3203,-11121.0905 2265.5295,-11136.0611 2330.7283,-11102.0235 2385.6864,-11073.3321 2410.1849,-11074.8738 2447.0435,-11025.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-12841.0235C615.3071,-12850.8734 628.0061,-12838.5323 654.4731,-12855.0235 720.2257,-12895.9929 688.9803,-12964.3865 760.9651,-12993.0235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge651" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-13567.0235C683.8014,-13638.1409 1274.4633,-12880.2656 1336.1997,-12776.0235 1361.5532,-12733.214 1347.2818,-12713.088 1372.1997,-12670.0235 1437.7293,-12556.7719 1457.7771,-12521.525 1566.6973,-12449.0235 1879.0911,-12241.0821 2003.0322,-12271.5153 2366.7283,-12179.0235 2384.2863,-12174.5583 2436.1007,-12179.4623 2447.0435,-12165.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2447.0435,-12165.0235C2468.6988,-12134.7085 2503.7108,-12169.8113 2527.3586,-12141.0235 2580.919,-12075.8216 2506.4091,-11825.287 2563.3586,-11763.0235 2564.4151,-11761.8685 2565.5259,-11760.7806 2566.685,-11759.7562"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2568.8381,-11762.5201 2574.9709,-11753.8807 2564.789,-11756.81 2568.8381,-11762.5201"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.1842,-12530.0915C400.3723,-12633.2913 415.0356,-13426.5191 585.7192,-13567.0235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge753" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-14211.0235C611.5656,-14250.2442 643.6055,-14200.1415 690.4731,-14197.0235 886.1708,-14184.0042 951.9155,-14118.7878 1131.7661,-14197.0235 1275.4959,-14259.5465 1238.7099,-14372.8783 1372.1997,-14455.0235 1588.6532,-14588.2217 1714.02,-14698.7597 1932.5662,-14569.0235 1961.2982,-14551.9672 1951.6428,-14531.834 1968.5662,-14503.0235 2121.3455,-14242.9301 2224.1538,-14211.2149 2330.7283,-13929.0235 2366.3536,-13834.6935 2348.2442,-13804.1479 2366.7283,-13705.0235 2392.2092,-13568.3769 2429.0525,-13405.3203 2442.1762,-13348.107"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2445.6438,-13348.6449 2444.4743,-13338.1148 2438.8219,-13347.0759 2445.6438,-13348.6449"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.4362,-12530.3453C403.7271,-12666.3014 446.9903,-13983.7334 516.9653,-14140.0235 534.9152,-14180.1147 563.0942,-14173.3724 585.7192,-14211.0235"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-5287.0289 334.3841,-5287.0289 334.3841,-5265.0181 463.7837,-5265.0181 463.7837,-5287.0289"/>
<text text-anchor="middle" x="399.0839" y="-5272.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge964" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.2597,-5287.3019C402.6438,-5504.7625 454.0518,-8823.8415 480.9653,-11497.0235 482.4089,-11640.4086 483.6336,-16519.5589 516.9653,-16659.0235 548.8222,-16792.3173 620.6325,-16802.2195 654.4731,-16935.0235 708.1747,-17145.7696 613.8289,-17709.496 690.4731,-17913.0235 846.0063,-18326.039 964.841,-18465.2259 1372.1997,-18635.0235 1576.1036,-18720.0159 2021.7863,-18723.013 2253.8123,-18737.0235"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge832" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#f3ff00" stroke-dasharray="5,2" d="M413.3935,-5264.8673C432.9277,-5248.6427 467.0967,-5216.4659 480.9653,-5180.0235 514.703,-5091.3718 461.2344,-3549.7791 516.9653,-3473.0235 554.9975,-3420.6436 599.1861,-3458.6902 654.4731,-3425.0235 922.8025,-3261.626 892.2466,-3089.9818 1167.7661,-2939.0235 1172.1952,-2936.5968 1176.9081,-2934.4455 1181.7545,-2932.5392"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="1182.9587,-2935.8257 1191.1997,-2929.1671 1180.605,-2929.2333 1182.9587,-2935.8257"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge876" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M399.258,-5287.3019C402.6102,-5504.7628 453.5454,-8823.8467 480.9653,-11497.0235 481.6628,-11565.0218 488.684,-16331.1817 516.9653,-16393.0235 594.3075,-16562.145 698.5814,-16538.9159 831.457,-16669.0235 972.68,-16807.3046 1039.7814,-16822.0824 1131.7661,-16997.0235 1164.8813,-17060.0036 1128.6823,-17093.5629 1167.7661,-17153.0235 1193.2957,-17191.8633 1213.7141,-17188.6457 1251.9829,-17215.0235"/>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M1451.4485,-17329.0235C1485.8317,-17342.1436 1497.7176,-17336.693 1530.6973,-17353.0235 1548.3842,-17361.7815 1549.0334,-17370.2189 1566.6973,-17379.0235 1574.9201,-17383.1222 1583.9494,-17386.7084 1592.9029,-17389.7885"/>
<polygon fill="#00ddff" stroke="#00ddff" points="1591.9547,-17393.1606 1602.547,-17392.9323 1594.1242,-17386.5053 1591.9547,-17393.1606"/>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M1251.9829,-17215.0235C1284.5982,-17236.2603 1305.8033,-17214.7167 1336.1997,-17239.0235 1362.2954,-17259.8912 1346.2765,-17283.942 1372.1997,-17305.0235 1400.7516,-17328.2428 1417.0652,-17315.9034 1451.4485,-17329.0235"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge887" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#009bff" stroke-dasharray="5,2" d="M399.3103,-5287.3701C402.4555,-5442.2792 438.5182,-7134.4936 516.9653,-7339.0235 576.1062,-7493.2175 908.0112,-7771.1793 981.6013,-7919.0235 1010.6136,-7977.3099 993.3697,-8000.593 1017.6013,-8061.0235 1029.5732,-8090.88 1048.8239,-8122.793 1061.6121,-8142.5765"/>
<polygon fill="#009bff" stroke="#009bff" points="1058.733,-8144.5685 1067.1471,-8151.0069 1064.5845,-8140.7267 1058.733,-8144.5685"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge913" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M399.2592,-5287.3019C402.6346,-5504.7626 453.9125,-8823.8429 480.9653,-11497.0235 481.6802,-11567.6606 488.0292,-16518.5813 516.9653,-16583.0235 550.6748,-16658.0962 618.3282,-16633.0927 654.4731,-16707.0235 703.0122,-16806.3054 678.8426,-17093.1251 690.4731,-17203.0235 714.3695,-17428.8233 655.5318,-17507.9255 760.9651,-17709.0235"/>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M760.9651,-17709.0235C782.1034,-17749.3416 831.8528,-17855.6561 867.457,-17884.0235 888.366,-17900.6826 908.4969,-17881.6301 924.5292,-17903.0235"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge950" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M399.2586,-5287.3019C402.6221,-5504.7627 453.7247,-8823.8448 480.9653,-11497.0235 481.6711,-11566.2856 485.1638,-16422.4898 516.9653,-16484.0235 551.5402,-16550.9232 610.33,-16522.0122 654.4731,-16583.0235 685.6188,-16626.0707 664.1387,-16650.8758 690.4731,-16697.0235 847.9138,-16972.9178 939.472,-17008.1457 1167.7661,-17229.0235 1292.2306,-17349.4447 1609.5686,-17653.0714 1764.717,-17730.0235 1798.9781,-17747.0166 1816.2648,-17728.6684 1848.6416,-17749.0235"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge959" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M399.4037,-5287.0806C402.915,-5405.3594 435.7266,-6434.8104 516.9653,-6540.0235 519.8374,-6543.7431 523.3154,-6546.9098 527.1644,-6549.6056"/>
<polygon fill="#ff0042" stroke="#ff0042" points="525.6857,-6552.7942 536.0914,-6554.787 529.1996,-6546.74 525.6857,-6552.7942"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M428.7424,-5264.9222C466.0406,-5250.6333 531.733,-5224.3727 585.7192,-5197.0235"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.9829,-4703.0235C1327.2967,-4757.9829 1402.7097,-4840.1163 1435.0486,-4876.9509"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1432.7655,-4879.6585 1441.9735,-4884.8991 1438.0434,-4875.0601 1432.7655,-4879.6585"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M413.3476,-5264.8497C432.8273,-5248.6042 466.9318,-5216.4027 480.9653,-5180.0235 504.85,-5118.1072 469.3374,-4032.2371 516.9653,-3986.0235 872.4538,-3641.0917 905.852,-4450.4384 1251.9829,-4703.0235"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.9829,-5467.0235C1331.5749,-5470.7602 1303.6771,-5559.3602 1372.1997,-5600.0235 1403.3479,-5618.5077 1415.2488,-5617.8164 1451.4485,-5619.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M417.5287,-5287.0693C494.4177,-5332.2575 798.31,-5502.3813 1074.6837,-5539.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1451.4485,-5619.0235C1505.5857,-5620.8287 1566.584,-5605.9663 1606.0011,-5594.0706"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1607.266,-5597.3431 1615.7853,-5591.0445 1605.1976,-5590.6556 1607.266,-5597.3431"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.6837,-5539.0235C1158.9033,-5527.1727 1167.0272,-5463.035 1251.9829,-5467.0235"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge965" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1253.9724,-2906.6868C1264.0515,-2848.9235 1310.0213,-2581.4817 1336.1997,-2361.0235 1358.0827,-2176.7383 1323.233,-2124.0268 1372.1997,-1945.0235 1424.8871,-1752.419 1473.2658,-1716.4973 1566.6973,-1540.0235 1633.7909,-1413.2966 1666.872,-1390.393 1728.717,-1261.0235 1748.012,-1220.6616 1742.1125,-1205.6295 1764.717,-1167.0235 1777.9327,-1144.4526 2344.3833,-456.6178 2366.7283,-443.0235 2476.5762,-376.1941 2522.8019,-358.0407 2649.3109,-381.0235"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge438" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1254.005,-2906.8484C1263.5268,-2854.1492 1304.747,-2625.1613 1336.1997,-2437.0235 1352.9709,-2336.7049 1337.5464,-2306.649 1372.1997,-2211.0235 1419.0868,-2081.639 1481.6029,-2073.5867 1530.6973,-1945.0235 1560.5797,-1866.7705 1530.6307,-1835.6257 1566.6973,-1760.0235 1596.6101,-1697.3207 1908.6619,-1316.2072 1968.5662,-1281.0235 2246.2775,-1117.9148 3191.538,-986.5065 3416.4602,-1217.0235"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1320.7252,-2926.4737C1326.6554,-2929.6138 1331.9884,-2933.7089 1336.1997,-2939.0235 1426.4687,-3052.9414 1285.4588,-5438.3968 1372.1997,-5555.0235 1376.4225,-5560.7012 1381.9362,-5565.121 1388.091,-5568.5565"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1386.9474,-5571.8842 1397.4918,-5572.9175 1389.8932,-5565.5342 1386.9474,-5571.8842"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M1313.8104,-2929.1765C1321.6145,-2931.8017 1329.2792,-2935.0374 1336.1997,-2939.0235 1666.1254,-3129.0566 1782.6171,-3204.0538 1932.5662,-3554.0235 2012.1832,-3739.8436 1872.8323,-4284.97 1968.5662,-4463.0235 2013.2502,-4546.1305 2096.8152,-4503.5951 2140.8962,-4587.0235 2215.3551,-4727.9454 2124.0484,-5870.6566 2176.8962,-6021.0235 2188.4704,-6053.9554 2215.162,-6084.7963 2233.8363,-6103.5294"/>
<polygon fill="#5cff00" stroke="#5cff00" points="2231.6776,-6106.3129 2241.2812,-6110.7873 2236.564,-6101.3006 2231.6776,-6106.3129"/>
</g>
<!-- sourcefile~datadaylightingdevices.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~datadaylightingdevices.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/datadaylightingdevices.f90.html" xlink:title="DataDaylightingDevices.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="831.449,-11407.0289 690.4812,-11407.0289 690.4812,-11385.0181 831.449,-11385.0181 831.449,-11407.0289"/>
<text text-anchor="middle" x="760.9651" y="-11392.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataDaylightingDevices.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datadaylightingdevices.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge966" class="edge">
<title>sourcefile~datadaylightingdevices.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3036.0425,-609.0235C3125.5597,-593.3862 3135.7948,-520.9104 3225.8566,-533.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M815.0837,-11384.9303C821.4879,-11381.4711 827.2356,-11376.9443 831.457,-11371.0235 864.5004,-11324.6781 862.5738,-7329.7325 867.457,-7273.0235 894.2751,-6961.5875 954.2394,-6890.4122 981.6013,-6579.0235 988.731,-6497.8856 977.8244,-3718.1009 1017.6013,-3647.0235 1046.8967,-3594.6755 1101.1306,-3626.5987 1131.7661,-3575.0235 1195.7903,-3467.2381 1085.0457,-3106.2261 1167.7661,-3012.0235 1218.0995,-2954.7035 1285.9137,-3036.3851 1336.1997,-2979.0235 1378.6175,-2930.6373 1359.9306,-2464.1897 1372.1997,-2401.0235 1424.3622,-2132.4707 1437.3022,-2058.0597 1566.6973,-1817.0235 1774.8784,-1429.2251 1857.8418,-1340.2251 2176.8962,-1037.0235 2410.9969,-814.5546 2465.2555,-722.2456 2771.2632,-619.0235 2882.8494,-581.3834 2920.0356,-629.2882 3036.0425,-609.0235"/>
</g>
<!-- sourcefile~datadaylightingdevices.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge877" class="edge">
<title>sourcefile~datadaylightingdevices.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M761.9295,-11407.2774C769.1444,-11492.0424 814.8581,-12039.1584 831.457,-12485.0235 839.0633,-12689.3362 831.3942,-15963.7749 867.457,-16165.0235 902.2754,-16359.3276 881.7782,-16439.7808 1017.6013,-16583.0235 1036.5376,-16602.9942 1064.2024,-16581.5764 1074.6837,-16607.0235"/>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M1074.6837,-16607.0235C1101.6635,-16667.6659 1108.2152,-16682.969 1131.7661,-16745.0235 1149.1217,-16790.754 1144.5629,-16805.9642 1167.7661,-16849.0235 1238.4974,-16980.2828 1267.2227,-17009.138 1372.1997,-17115.0235 1435.1702,-17178.539 1481.7343,-17164.1761 1530.6973,-17239.0235 1565.8683,-17292.7878 1522.3631,-17332.5252 1566.6973,-17379.0235 1570.349,-17382.8535 1574.5728,-17386.1007 1579.136,-17388.8535"/>
<polygon fill="#00ddff" stroke="#00ddff" points="1577.7763,-17392.0902 1588.2686,-17393.5607 1580.9834,-17385.8681 1577.7763,-17392.0902"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge967" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M927.5369,-11422.7677C937.68,-11384.1639 970.6066,-11253.4239 981.6013,-11143.0235 991.8017,-11040.5984 970.1344,-3823.3572 1017.6013,-3732.0235 1046.2911,-3676.8199 1101.4293,-3705.3394 1131.7661,-3651.0235 1191.8164,-3543.5077 1100.0859,-3200.9073 1167.7661,-3098.0235 1213.9598,-3027.8024 1289.75,-3082.0755 1336.1997,-3012.0235 1397.3941,-2919.7347 1318.1626,-2611.6774 1372.1997,-2515.0235 1414.5437,-2439.2847 1487.5541,-2476.3099 1530.6973,-2401.0235 1615.9251,-2252.2979 1493.2479,-2171.9051 1566.6973,-2017.0235 1661.0521,-1818.059 2958.702,-608.7381 3036.0425,-609.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge800" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.6837,-15809.0235C1085.2123,-15834.4511 1108.3521,-15818.5598 1131.7661,-15833.0235 1156.6019,-15848.3655 1515.487,-16150.1068 1530.6973,-16175.0235 1566.6445,-16233.9106 1524.3167,-16271.5828 1566.6973,-16326.0235 1613.0881,-16385.6156 2702.3526,-16925.126 2771.2632,-16956.0235 2886.0461,-17007.4889 2910.8889,-17043.3582 3036.0425,-17056.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3036.0425,-17056.0235C3204.558,-17069.7609 3286.4445,-17164.1074 3416.4602,-17056.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M928.5006,-11445.4914C939.5916,-11478.1825 970.7894,-11574.8489 981.6013,-11658.0235 1038.5517,-12096.1334 946.2651,-15198.0249 1017.6013,-15634.0235 1030.8112,-15714.7608 1043.8272,-15733.2548 1074.6837,-15809.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge833" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#f3ff00" stroke-dasharray="5,2" d="M927.537,-11422.7677C937.6803,-11384.1639 970.6078,-11253.424 981.6013,-11143.0235 1002.0908,-10937.261 964.0899,-3898.7598 1017.6013,-3699.0235 1044.0882,-3600.1589 1102.357,-3597.0586 1131.7661,-3499.0235 1149.6817,-3439.3022 1127.8228,-2986.8998 1167.7661,-2939.0235 1169.9381,-2936.4201 1172.3789,-2934.1122 1175.0244,-2932.0678"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="1176.9351,-2935.0006 1183.5111,-2926.6936 1173.19,-2929.0867 1176.9351,-2935.0006"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge859" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff58" stroke-dasharray="5,2" d="M928.3237,-11445.0291C939.2216,-11477.2665 970.5401,-11574.4768 981.6013,-11658.0235 1019.6967,-11945.7624 1009.1044,-13979.8981 1017.6013,-14270.0235 1032.498,-14778.6678 1066.6569,-15400.8873 1073.4836,-15522.76"/>
<polygon fill="#00ff58" stroke="#00ff58" points="1070.0018,-15523.1837 1074.0574,-15532.9716 1076.9908,-15522.791 1070.0018,-15523.1837"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge888" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#009bff" stroke-dasharray="5,2" d="M927.4878,-11422.7627C937.473,-11384.1426 969.9525,-11253.3568 981.6013,-11143.0235 1031.8659,-10666.9361 997.1116,-9467.3183 1017.6013,-8989.0235 1031.3631,-8667.7795 1064.5812,-8277.366 1072.8139,-8183.1911"/>
<polygon fill="#009bff" stroke="#009bff" points="1076.303,-8183.4673 1073.691,-8173.1995 1069.3298,-8182.855 1076.303,-8183.4673"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge911" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M928.5033,-11445.491C939.6014,-11478.1813 970.816,-11574.8454 981.6013,-11658.0235 1042.7402,-12129.5375 994.197,-15462.1386 1017.6013,-15937.0235 1045.3671,-16500.4043 1093.5154,-16638.2574 1131.7661,-17201.0235 1143.6532,-17375.9138 1116.7691,-17821.3118 1167.7661,-17989.0235 1182.0112,-18035.8708 1215.6434,-18083.0785 1235.8321,-18108.6302"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="1233.3586,-18111.1388 1242.3586,-18116.729 1238.809,-18106.7464 1233.3586,-18111.1388"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge925" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M1074.6837,-15809.0235C1085.0638,-15834.512 1113.1967,-15812.7112 1131.7661,-15833.0235 1167.3309,-15871.9262 1141.5411,-15900.3013 1167.7661,-15946.0235 1176.0052,-15960.3881 1554.7067,-16377.602 1566.6973,-16389.0235 2166.0437,-16959.924 2369.9101,-17085.0491 3142.9189,-17381.0235 3410.9308,-17483.6416 3747.0215,-17555.3208 3886.5095,-17582.7007"/>
<polygon fill="#b100ff" stroke="#b100ff" points="3886.1226,-17586.1912 3896.6081,-17584.6728 3887.4643,-17579.321 3886.1226,-17586.1912"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge951" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M928.5024,-11445.4912C939.5979,-11478.1817 970.8064,-11574.8467 981.6013,-11658.0235 1011.3828,-11887.4966 962.0764,-15598.3865 1017.6013,-15823.0235 1054.6765,-15973.0184 1267.4632,-16302.6461 1336.1997,-16441.0235 1389.0185,-16547.3561 1503.282,-16822.6494 1566.6973,-16923.0235 1627.7986,-17019.7351 1687.3439,-17016.371 1728.717,-17123.0235 1753.1522,-17186.013 1721.001,-17678.5098 1764.717,-17730.0235 1789.4623,-17759.1827 1816.2444,-17728.7009 1848.6416,-17749.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge440" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M926.5198,-11422.9813C935.3397,-11374.6122 972.4596,-11176.767 1017.6013,-11018.0235 1059.9362,-10869.1503 1104.6569,-10841.4065 1131.7661,-10689.0235 1141.4351,-10634.6734 1132.0949,-8744.1541 1167.7661,-8702.0235 1248.3958,-8606.7934 1647.0776,-8632.6576 1728.717,-8727.0235 1792.967,-8801.2892 1689.8349,-8881.493 1764.717,-8945.0235 1916.8764,-9074.1164 1991.6688,-8841.2408 2176.8962,-8767.0235 2373.5207,-8688.2396 2437.4901,-8704.0235 2649.3109,-8704.0235 2649.3109,-8704.0235 2649.3109,-8704.0235 3036.0425,-8704.0235 3081.5192,-8704.0235 3394.7326,-8513.073 3416.4602,-8553.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge511" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M928.5,-11445.4915C939.5891,-11478.1829 970.7826,-11574.8498 981.6013,-11658.0235 995.597,-11765.6217 967.8492,-15467.5975 1017.6013,-15564.0235 1097.7985,-15719.4558 1220.6878,-15663.6927 1336.1997,-15795.0235 1358.2671,-15820.1129 1346.2765,-15839.942 1372.1997,-15861.0235 1429.3035,-15907.4621 1481.1687,-15854.5781 1530.6973,-15909.0235 1585.0103,-15968.7283 1504.2234,-16035.9199 1566.6973,-16087.0235 1663.7772,-16166.4349 1723.3312,-16080.315 1848.6416,-16075.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge530" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M928.1404,-11445.0554C938.5418,-11477.3644 968.6483,-11574.7492 981.6013,-11658.0235 1023.2067,-11925.5026 976.9782,-11998.3935 1017.6013,-12266.0235 1059.372,-12541.2134 1056.5247,-12618.8773 1167.7661,-12874.0235 1222.3463,-12999.21 1294.4345,-13000.9992 1336.1997,-13131.0235 1395.2399,-13314.8288 1284.0489,-13827.2692 1372.1997,-13999.0235 1413.0389,-14078.5952 1483.7018,-14046.9254 1530.6973,-14123.0235 1573.1072,-14191.6964 1527.9878,-14230.1988 1566.6973,-14301.0235 1679.4542,-14507.3288 1749.1345,-14560.6096 1968.5662,-14645.0235 2110.9895,-14699.8128 2294.1291,-14699.2844 2387.1131,-14694.5145"/>
<polygon fill="#65ff00" stroke="#65ff00" points="2387.3897,-14698.0047 2397.1833,-14693.9628 2387.0068,-14691.0151 2387.3897,-14698.0047"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge541" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M945.9053,-11445.1971C975.4752,-11460.8922 1030.243,-11490.8271 1074.6837,-11520.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2054.7312,-12129.0235C2094.4845,-12128.9855 2113.1637,-12133.5057 2140.8962,-12105.0235 2186.9177,-12057.758 2131.6083,-12008.9923 2176.8962,-11961.0235 2201.48,-11934.9846 2218.6653,-11943.8845 2253.8123,-11937.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1074.6837,-11520.0235C1135.4354,-11559.9358 1674.8596,-11486.2061 1728.717,-11535.0235 1777.8126,-11579.5246 1731.3463,-11773.7775 1764.717,-11831.0235 1811.4267,-11911.1518 1881.3475,-11877.6996 1932.5662,-11955.0235 1970.4269,-12012.1812 1920.9701,-12055.6772 1968.5662,-12105.0235 1996.164,-12133.6362 2014.9779,-12129.0615 2054.7312,-12129.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge610" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M927.8816,-11445.1C937.5812,-11477.5296 965.9755,-11575.2091 981.6013,-11658.0235 1005.6824,-11785.6497 967.9929,-11827.9929 1017.6013,-11948.0235 1049.198,-12024.4737 1102.0139,-12017.8368 1131.7661,-12095.0235 1169.9192,-12194.0047 1117.7689,-12477.4649 1167.7661,-12571.0235 1212.5925,-12654.9062 1293.0013,-12618.291 1336.1997,-12703.0235 1434.7776,-12896.3812 1275.7762,-13484.5825 1372.1997,-13679.0235 1412.6763,-13760.6457 1471.8997,-13739.429 1530.6973,-13809.0235 1551.5097,-13833.6577 1546.2777,-13847.0627 1566.6973,-13872.0235 1703.4837,-14039.2303 1836.3505,-13998.6037 1932.5662,-14192.0235 1982.7735,-14292.9541 1933.1977,-14590.9869 1968.5662,-14698.0235 2068.1666,-14999.4475 2137.6314,-15071.2707 2366.7283,-15291.0235 2521.6654,-15439.6413 2576.7153,-15464.2279 2771.2632,-15555.0235 2804.497,-15570.5337 2826.1346,-15551.3612 2850.2146,-15579.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge705" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M2649.3109,-12241.0235C2684.4986,-12222.7227 2710.8918,-12248.3146 2735.2632,-12217.0235 2784.5728,-12153.7134 2752.1072,-10850.9507 2771.2632,-10773.0235 2809.2169,-10618.6266 2883.2147,-10604.2318 2929.166,-10452.0235 2965.0461,-10333.175 2898.4685,-10279.7316 2965.166,-10175.0235 2973.1056,-10162.5592 2985.8739,-10152.9093 2998.4006,-10145.7996"/>
<polygon fill="#00cbff" stroke="#00cbff" points="3000.1822,-10148.8173 3007.4068,-10141.0677 2996.9264,-10142.6205 3000.1822,-10148.8173"/>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M1074.6837,-11520.0235C1092.1466,-11531.7944 1232.1558,-11579.9249 1251.9829,-11587.0235"/>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M1251.9829,-11587.0235C1453.145,-11659.0445 1579.2999,-11496.2893 1728.717,-11649.0235 1780.9214,-11702.3868 1716.6354,-11925.9175 1764.717,-11983.0235 1814.6909,-12042.3769 1876.8185,-11977.0567 1932.5662,-12031.0235 1970.1331,-12067.3904 1926.3145,-12112.2237 1968.5662,-12143.0235 2030.4585,-12188.1405 2075.2802,-12182.5297 2140.8962,-12143.0235 2170.1923,-12125.3849 2147.6001,-12092.6621 2176.8962,-12075.0235 2235.469,-12039.7579 2264.9093,-12056.5224 2330.7283,-12075.0235 2407.5802,-12096.6259 2578.7082,-12278.2813 2649.3109,-12241.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge709" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1074.6837,-11520.0235C1096.46,-11536.8522 1112.7839,-11524.0965 1131.7661,-11544.0235 1177.5252,-11592.0601 1322.7306,-12040.0621 1336.1997,-12105.0235 1349.8715,-12170.9622 1329.5636,-12657.8987 1372.1997,-12710.0235 1377.4532,-12716.4462 1384.4237,-12721.0327 1392.0567,-12724.2862"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1391.0301,-12727.635 1401.625,-12727.6276 1393.338,-12721.0263 1391.0301,-12727.635"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge720" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M927.9676,-11445.3629C938.2878,-11478.3976 971.1759,-11576.7259 1017.6013,-11648.0235 1058.4781,-11710.7998 1099.6354,-11704.3523 1131.7661,-11772.0235 1180.1035,-11873.8279 1138.7619,-11914.1227 1167.7661,-12023.0235 1219.9516,-12218.962 1294.584,-12248.5711 1336.1997,-12447.0235 1359.4744,-12558.0133 1320.3795,-13366.1518 1372.1997,-13467.0235 1375.3174,-13473.0923 1560.3855,-13614.4327 1566.6973,-13617.0235 1841.8171,-13729.954 2202.8829,-13733.9579 2363.6247,-13729.1142"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2364.0373,-13732.6028 2373.9197,-13728.7834 2363.8125,-13725.6064 2364.0373,-13732.6028"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge773" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M926.3309,-11445.2606C933.1336,-11485.4413 959.8589,-11624.8691 1017.6013,-11724.0235 1055.2996,-11788.7584 1101.437,-11779.5259 1131.7661,-11848.0235 1204.2122,-12011.6411 1120.2046,-12076.5212 1167.7661,-12249.0235 1213.651,-12415.4448 1294.6081,-12431.4777 1336.1997,-12599.0235 1361.4887,-12700.8967 1316.81,-13453.8627 1372.1997,-13543.0235 1414.4919,-13611.1012 1463.9961,-13584.592 1530.6973,-13629.0235 1547.7965,-13640.4138 1549.9815,-13646.0776 1566.6973,-13658.0235 1876.0623,-13879.1109 1990.4436,-14212.7077 2330.7283,-14043.0235 2460.7004,-13978.2124 2457.582,-13909.3987 2527.3586,-13782.0235 2654.5092,-13549.9139 2666.995,-13479.7217 2735.2632,-13224.0235 2760.3682,-13129.993 2721.6334,-13091.7426 2771.2632,-13008.0235 2794.0148,-12969.6445 2836.2074,-12988.3837 2850.2146,-12946.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.9829,-5581.0235C1294.327,-5541.4598 1366.5444,-5553.1933 1411.4857,-5566.0653"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1410.6054,-5569.4553 1421.1897,-5568.9836 1412.6214,-5562.7519 1410.6054,-5569.4553"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M927.5115,-11422.7651C937.5727,-11384.153 970.2675,-11253.3896 981.6013,-11143.0235 1000.172,-10962.1858 968.057,-8045.9307 1017.6013,-7871.0235 1044.4506,-7776.2368 1104.6178,-7775.725 1131.7661,-7681.0235 1163.5996,-7569.979 1095.8624,-5692.4343 1167.7661,-5602.0235 1191.7776,-5571.8318 1223.796,-5607.3596 1251.9829,-5581.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M927.5305,-11422.7671C937.6529,-11384.1612 970.5211,-11253.4153 981.6013,-11143.0235 1043.9438,-10521.9094 967.366,-6147.2339 1017.6013,-5525.0235 1044.099,-5196.8251 1101.244,-5120.8721 1131.7661,-4793.0235 1137.7583,-4728.6598 1137.7114,-3687.2539 1167.7661,-3630.0235 1210.9859,-3547.724 1287.9773,-3585.4953 1336.1997,-3506.0235 1390.1015,-3417.192 1333.5761,-3371.4842 1372.1997,-3275.0235 1400.4446,-3204.4832 1710.3943,-2768.153 1764.717,-2715.0235 1995.4352,-2489.3734 2075.7927,-2448.6849 2366.7283,-2309.0235 2375.1396,-2304.9857 2384.355,-2301.4062 2393.4492,-2298.3077"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="2394.7945,-2301.551 2403.2261,-2295.1354 2392.634,-2294.8927 2394.7945,-2301.551"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M927.3982,-11422.7527C937.0953,-11384.1007 968.7589,-11253.2242 981.6013,-11143.0235 1029.8931,-10728.6321 995.4322,-10621.6299 1017.6013,-10205.0235 1024.1288,-10082.3579 1112.4161,-8108.6859 1167.7661,-7999.0235 1212.0139,-7911.3573 1287.1942,-7941.1217 1336.1997,-7856.0235 1381.2715,-7777.7562 1341.6488,-7741.0169 1372.1997,-7656.0235 1388.8535,-7609.6924 1419.8677,-7560.6867 1437.7606,-7534.4017"/>
<polygon fill="#5cff00" stroke="#5cff00" points="1440.6954,-7536.3112 1443.4973,-7526.0936 1434.9352,-7532.3338 1440.6954,-7536.3112"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge401" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1074.6837,-10561.0235C1083.9646,-10487.3592 1118.2021,-10477.0207 1131.7661,-10404.0235 1151.2868,-10298.9697 1114.0378,-8573.3849 1167.7661,-8481.0235 1211.5418,-8405.7711 1263.7828,-8429.3457 1336.1997,-8381.0235 1442.5238,-8310.0758 1456.7542,-8274.2227 1566.6973,-8209.0235 2220.5864,-7821.2498 2690.3341,-8100.9454 3106.9189,-7465.0235 3266.1751,-7221.9171 3103.6879,-7085.7242 3225.8566,-6822.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge421" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M927.5374,-11422.7677C937.682,-11384.1641 970.6132,-11253.4245 981.6013,-11143.0235 1065.1921,-10303.1636 950.475,-4388.3594 1017.6013,-3547.0235 1066.3912,-2935.5096 1219.2298,-2196.3921 1247.4715,-2063.121"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="1250.9607,-2063.5397 1249.6177,-2053.0303 1244.1138,-2062.0834 1250.9607,-2063.5397"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M927.1288,-11422.9941C936.0854,-11384.5966 965.9677,-11253.123 981.6013,-11143.0235 994.335,-11053.3469 980.9757,-10819.8644 1017.6013,-10737.0235 1032.7471,-10702.7664 1069.4813,-10712.1163 1074.6837,-10675.0235"/>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M1074.6837,-10675.0235C1081.7917,-10624.3439 1118.2076,-10624.3704 1131.7661,-10575.0235 1161.8856,-10465.4018 1098.4796,-8619.1539 1167.7661,-8529.0235 1215.2067,-8467.3111 1264.7661,-8511.9471 1336.1997,-8481.0235 1390.9865,-8457.3063 1392.0809,-8418.3163 1451.4485,-8412.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M927.2422,-11423.0094C936.5694,-11384.6619 967.5166,-11253.3319 981.6013,-11143.0235 1015.2124,-10879.789 963.7035,-10806.8641 1017.6013,-10547.0235 1047.7608,-10401.6251 1104.674,-10379.0246 1131.7661,-10233.0235 1171.8097,-10017.2264 1109.8463,-8469.7241 1167.7661,-8258.0235 1207.812,-8111.6532 1275.5879,-8100.1426 1336.1997,-7961.0235 1357.4221,-7912.3129 1347.23,-7893.9237 1372.1997,-7847.0235 1425.3364,-7747.2178 1460.8733,-7736.9578 1530.6973,-7648.0235 1820.4816,-7278.9272 1839.981,-7139.6657 2176.8962,-6813.0235 2283.3979,-6709.7692 2303.0936,-6581.2117 2447.0435,-6617.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge297" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M927.1848,-11423.0019C936.3244,-11384.6297 966.7326,-11253.2289 981.6013,-11143.0235 1010.324,-10930.1335 954.812,-10866.4612 1017.6013,-10661.0235 1032.5594,-10612.0827 1068.2765,-10611.7964 1074.6837,-10561.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1074.6837,-10561.0235C1083.9794,-10487.361 1118.2447,-10477.0286 1131.7661,-10404.0235 1152.5203,-10291.9673 1122.7733,-8457.7278 1167.7661,-8353.0235 1238.5062,-8188.4019 1609.0157,-7899.6886 1764.717,-7811.0235 1936.6214,-7713.1315 1986.0835,-7695.2199 2176.8962,-7643.0235 2293.9695,-7610.9984 2333.2876,-7645.3479 2447.0435,-7603.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2447.0435,-7603.0235C2504.4873,-7579.0565 2508.1917,-7553.8476 2563.3586,-7525.0235 2684.6634,-7461.6431 2722.7281,-7462.8141 2850.2146,-7413.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge317" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1074.6837,-10675.0235C1081.7917,-10624.3439 1118.186,-10624.3644 1131.7661,-10575.0235 1160.5038,-10470.6098 1099.6604,-8710.2238 1167.7661,-8626.0235 1207.4981,-8576.9021 1680.5707,-8492.1154 1728.717,-8533.0235 1804.2212,-8597.1766 1699.2569,-8678.6497 1764.717,-8753.0235 1768.2059,-8756.9875 1772.293,-8760.336 1776.7519,-8763.1631"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1775.2591,-8766.3342 1785.725,-8767.9819 1778.5709,-8760.1672 1775.2591,-8766.3342"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge354" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M927.5203,-11422.766C937.6099,-11384.1568 970.3854,-11253.4016 981.6013,-11143.0235 1027.2075,-10694.2058 1000.6554,-7533.834 1017.6013,-7083.0235 1046.3796,-6317.4377 1097.9452,-6128.4031 1131.7661,-5363.0235 1133.7691,-5317.6956 1142.3557,-3767.6126 1167.7661,-3730.0235 1213.3605,-3662.5766 1285.4023,-3721.6439 1336.1997,-3658.0235 1391.735,-3588.4692 1325.101,-3536.5463 1372.1997,-3461.0235 1486.9762,-3276.9793 1580.0405,-3284.7798 1764.717,-3171.0235 1912.3085,-3080.1108 1992.9251,-2977.7301 2140.8962,-3068.0235 2170.7597,-3086.2465 2151.5017,-3113.9607 2176.8962,-3138.0235 2300.7874,-3255.4179 2403.2465,-3177.8628 2527.3586,-3295.0235 2723.1498,-3479.8485 2821.6998,-3809.9355 2844.819,-3896.0248"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2841.4907,-3897.13 2847.4261,-3905.9062 2848.2591,-3895.3441 2841.4907,-3897.13"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge386" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1251.9829,-11357.0235C1288.2073,-11342.7915 1301.4882,-11350.6266 1336.1997,-11333.0235 1354.2777,-11323.8557 1355.3765,-11316.3304 1372.1997,-11305.0235 1454.9894,-11249.3805 1471.0993,-11221.5072 1566.6973,-11193.0235 1686.9818,-11157.1844 1723.4501,-11168.0846 1848.6416,-11177.0235"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M979.838,-11435.5055C1008.2146,-11435.8902 1043.3207,-11435.7868 1074.6837,-11434.0235"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1074.6837,-11434.0235C1102.3365,-11432.4688 1107.9669,-11423.19 1131.7661,-11409.0235 1149.1837,-11398.6557 1149.6881,-11390.1913 1167.7661,-11381.0235 1202.4776,-11363.4204 1215.2329,-11369.8373 1251.9829,-11357.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M927.5073,-11422.7647C937.5553,-11384.1512 970.2127,-11253.384 981.6013,-11143.0235 990.1589,-11060.0968 978.8929,-8215.8593 1017.6013,-8142.0235 1046.4879,-8086.9227 1101.8426,-8115.5682 1131.7661,-8061.0235 1209.0324,-7920.182 1075.6274,-7470.6171 1167.7661,-7339.0235 1214.3611,-7272.4759 1290.2808,-7335.0394 1336.1997,-7268.0235 1412.6657,-7156.426 1334.889,-6181.058 1372.1997,-6051.0235 1427.8571,-5857.0476 1581.6561,-5659.7615 1631.7262,-5598.9886"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1634.6401,-5600.9582 1638.3369,-5591.0293 1629.2552,-5596.4857 1634.6401,-5600.9582"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge240" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.6837,-7667.0235C1086.1748,-7418.8794 1117.1303,-7359.002 1131.7661,-7111.0235 1135.5439,-7047.016 1128.7387,-4853.8968 1167.7661,-4803.0235 1215.1451,-4741.2637 1280.3176,-4809.2105 1336.1997,-4755.0235 1374.0403,-4718.3307 1342.0247,-4685.2408 1372.1997,-4642.0235 1434.85,-4552.2945 1467.9313,-4538.1577 1566.6973,-4491.0235 1633.4484,-4459.1678 1673.7978,-4502.5651 1728.717,-4453.0235 1765.0363,-4420.2606 1732.3905,-4385.7316 1764.717,-4349.0235 1821.9217,-4284.0653 2077.7558,-4188.8186 2140.8962,-4248.0235 2231.701,-4333.1685 2096.2525,-4712.1987 2176.8962,-4807.0235 2256.7026,-4900.8636 2324.1866,-4860.0121 2447.0435,-4869.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge271" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M927.5305,-11422.7671C937.6529,-11384.1612 970.5211,-11253.4153 981.6013,-11143.0235 1043.9438,-10521.9094 990.928,-6148.6884 1017.6013,-5525.0235 1053.702,-4680.9327 999.1076,-4457.8803 1167.7661,-3630.0235 1169.5525,-3621.2551 1369.3351,-3027.5011 1372.1997,-3019.0235 1373.5386,-3015.0612 1564.7949,-2452.7483 1566.6973,-2449.0235 1584.029,-2415.0881 1735.1395,-2193.0479 1764.717,-2169.0235 1863.9069,-2088.4564 2758.8543,-1699.6759 2850.2146,-1789.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M927.5091,-11422.7649C937.5627,-11384.152 970.2359,-11253.3863 981.6013,-11143.0235 999.302,-10971.1432 964.4412,-8197.432 1017.6013,-8033.0235 1044.7007,-7949.2132 1102.4712,-7954.0919 1131.7661,-7871.0235 1173.2398,-7753.421 1108.3793,-7420.6758 1167.7661,-7311.0235 1178.9244,-7290.4207 1200.0562,-7274.6433 1218.3595,-7264.0304"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1220.2571,-7266.9812 1227.3325,-7259.0951 1216.8836,-7260.8477 1220.2571,-7266.9812"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge329" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.6837,-7667.0235C1086.1381,-7418.8777 1117.6592,-7359.0326 1131.7661,-7111.0235 1136.778,-7022.9103 1137.0371,-4016.7568 1167.7661,-3934.0235 1208.2289,-3825.0835 1279.2407,-3835.3193 1336.1997,-3734.0235 1360.7921,-3690.2885 1343.6151,-3668.26 1372.1997,-3627.0235 1555.1257,-3363.1321 1727.3043,-3417.9407 1932.5662,-3171.0235 1953.9259,-3145.3291 1939.8342,-3122.0798 1968.5662,-3105.0235 2034.4268,-3065.9265 2082.6678,-3055.2676 2140.8962,-3105.0235 2218.8894,-3171.6682 2105.2103,-3259.637 2176.8962,-3333.0235 2201.1761,-3357.8793 2219.6361,-3340.7536 2253.8123,-3347.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-3347.0235C2340.3188,-3360.3397 2382.2518,-3250.1784 2447.0435,-3309.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M927.514,-11422.7654C937.5832,-11384.1541 970.3008,-11253.393 981.6013,-11143.0235 986.4991,-11095.1877 987.7278,-7718.7041 1017.6013,-7681.0235 1033.8296,-7660.5542 1073.4754,-7693.1174 1074.6837,-7667.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge493" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.9829,-11357.0235C1335.1995,-11328.591 1566.5096,-11325.2541 1647.7072,-11359.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-11359.0235C1686.5208,-11382.457 1704.0013,-11383.0136 1728.717,-11421.0235 1766.0912,-11478.5006 1726.8563,-11513.8658 1764.717,-11571.0235 1790.3264,-11609.6855 1822.1399,-11594.9677 1848.6416,-11633.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge578" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M927.3843,-11445.21C935.7365,-11477.9377 960.8423,-11576.3445 981.6013,-11658.0235 997.6388,-11721.1251 996.7395,-11738.3486 1017.6013,-11800.0235 1058.9546,-11922.2783 1099.787,-11941.9889 1131.7661,-12067.0235 1172.8152,-12227.5206 1109.8263,-12282.8226 1167.7661,-12438.0235 1212.9618,-12559.0871 1294.5232,-12552.7038 1336.1997,-12675.0235 1402.544,-12869.7426 1280.2723,-13415.9952 1372.1997,-13600.0235 1412.7877,-13681.2761 1466.0298,-13665.2466 1530.6973,-13729.0235 1548.4434,-13746.5252 1550.051,-13753.4726 1566.6973,-13772.0235 1651.5133,-13866.5445 1672.2633,-13890.9588 1764.717,-13978.0235 1836.0631,-14045.2109 1888.4551,-14033.51 1932.5662,-14121.0235 1985.1018,-14225.2508 1889.9689,-14558.7346 1968.5662,-14645.0235 2052.7489,-14737.4444 2425.8772,-14783.0294 2527.3586,-14710.0235 3104.6191,-14294.7418 2893.9481,-13889.8002 3036.0425,-13193.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge565" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-14173.0235C1667.9596,-14185.7665 1722.5102,-14195.8952 1769.6686,-14202.6336"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1769.2168,-14206.1044 1779.6045,-14204.0197 1770.1841,-14199.1715 1769.2168,-14206.1044"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M928.0476,-11445.0704C938.1971,-11477.42 967.6893,-11574.904 981.6013,-11658.0235 1013.7716,-11850.23 975.9368,-11904.6493 1017.6013,-12095.0235 1049.3485,-12240.0835 1097.1496,-12264.6213 1131.7661,-12409.0235 1162.4544,-12537.0392 1127.9715,-12577.5398 1167.7661,-12703.0235 1215.6389,-12853.98 1294.1284,-12864.3484 1336.1997,-13017.0235 1383.004,-13186.8745 1301.9806,-13647.4399 1372.1997,-13809.0235 1412.3462,-13901.406 1481.2533,-13883.265 1530.6973,-13971.0235 1562.2335,-14026.9974 1531.2408,-14057.447 1566.6973,-14111.0235 1591.7191,-14148.8327 1609.3325,-14148.8779 1647.7072,-14173.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge674" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.6837,-11434.0235C1367.0699,-11417.5845 1517.8529,-11310.8087 1728.717,-11514.0235 1801.6375,-11584.2987 1706.3676,-11656.2507 1764.717,-11739.0235 1813.7318,-11808.5545 1883.8048,-11761.3146 1932.5662,-11831.0235 1993.3826,-11917.9663 1888.0823,-11997.8858 1968.5662,-12067.0235 2026.6644,-12116.9314 2080.5267,-12114.1586 2140.8962,-12067.0235 2192.8939,-12026.425 2131.6083,-11970.9923 2176.8962,-11923.0235 2226.0637,-11870.9457 2275.9091,-11921.1147 2330.7283,-11875.0235 2357.5056,-11852.5095 2337.84,-11824.756 2366.7283,-11805.0235 2434.7129,-11758.5859 2679.4457,-11827.5444 2735.2632,-11767.0235 2797.0859,-11699.9913 2712.77,-10195.9799 2771.2632,-10126.0235 2777.1925,-10118.9322 2785.3227,-10114.4361 2794.1223,-10111.6677"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2794.9703,-10115.0636 2803.8609,-10109.3009 2793.3171,-10108.2616 2794.9703,-10115.0636"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge687" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1251.9829,-11587.0235C1413.4241,-11669.9856 1575.3459,-11821.1092 1629.0932,-11873.5298"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1626.9121,-11876.2932 1636.5007,-11880.7999 1631.8153,-11871.2973 1626.9121,-11876.2932"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge620" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.9829,-11357.0235C1260.5542,-11354.0349 1557.883,-11271.1931 1566.6973,-11269.0235 1728.141,-11229.2843 1772.0237,-11234.26 1932.5662,-11191.0235 2128.6009,-11138.2284 2172.9716,-11109.6476 2366.7283,-11049.0235 2402.2838,-11037.8986 2422.816,-11053.3252 2447.0435,-11025.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-11025.0235C2630.537,-10776.8529 2470.1986,-9935.2679 2563.3586,-9641.0235 2578.2856,-9593.8769 2612.73,-9546.4957 2633.1957,-9521.0543"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2635.9196,-9523.2522 2639.5519,-9513.2995 2630.5058,-9518.8148 2635.9196,-9523.2522"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge655" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1647.7072,-11359.0235C1686.5208,-11382.457 1705.4939,-11382.0837 1728.717,-11421.0235 1780.8145,-11508.3788 1716.8522,-11557.2792 1764.717,-11647.0235 1812.6446,-11736.8854 1884.7899,-11713.0811 1932.5662,-11803.0235 1981.3097,-11894.7868 1889.6392,-11966.4441 1968.5662,-12034.0235 2026.7448,-12083.8376 2080.7136,-12081.3971 2140.8962,-12034.0235 2194.4286,-11991.8848 2130.3231,-11934.746 2176.8962,-11885.0235 2201.3768,-11858.8875 2224.7399,-11881.9324 2253.8123,-11861.0235"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge757" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M931.2338,-11445.1514C945.8503,-11469.1289 982.1261,-11527.1302 1017.6013,-11572.0235 1064.0467,-11630.7994 1097.7167,-11629.2971 1131.7661,-11696.0235 1168.4523,-11767.9171 1137.8663,-11799.053 1167.7661,-11874.0235 1220.0207,-12005.0461 1294.3275,-12008.3232 1336.1997,-12143.0235 1391.0023,-12319.3199 1296.4372,-12804.6674 1372.1997,-12973.0235 1421.5369,-13082.6585 1460.463,-13104.7362 1566.6973,-13161.0235 1839.0825,-13305.3445 2217.376,-13325.6968 2374.3235,-13327.5296"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2374.7551,-13331.0338 2384.7875,-13327.6279 2374.8209,-13324.0341 2374.7551,-13331.0338"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1323.8205,-4981.0289 1180.1454,-4981.0289 1180.1454,-4959.0181 1323.8205,-4959.0181 1323.8205,-4981.0289"/>
<text text-anchor="middle" x="1251.9829" y="-4966.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge968" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1252.9989,-4958.9006C1264.2749,-4835.4903 1365.7412,-3726.0436 1372.1997,-3693.0235 1429.7563,-3398.7575 1434.8929,-3316.3428 1566.6973,-3047.0235 1621.3427,-2935.3651 1682.6872,-2934.5006 1728.717,-2819.0235 1770.9346,-2713.1104 1724.9643,-2671.8861 1764.717,-2565.0235 1823.1187,-2408.0292 1876.2918,-2387.8213 1968.5662,-2248.0235 2212.5254,-1878.4195 2300.3854,-1803.295 2527.3586,-1423.0235 2545.0865,-1393.3222 2539.4714,-1379.0404 2563.3586,-1354.0235 2761.0443,-1146.9891 3649.5063,-655.0984 3773.6733,-913.0235"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge801" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1252.376,-4958.9078C1255.3007,-4882.5027 1276.2939,-4427.552 1372.1997,-4073.0235 1419.9843,-3896.3816 1474.2023,-3867.0754 1530.6973,-3693.0235 1552.1307,-3626.9905 1547.8627,-3607.8443 1566.6973,-3541.0235 1629.3835,-3318.6267 1674.2895,-3271.5843 1728.717,-3047.0235 1752.572,-2948.6012 1728.044,-2916.4221 1764.717,-2822.0235 1770.2216,-2807.8545 2358.0498,-1920.5032 2366.7283,-1908.0235 2435.6442,-1808.9221 2479.8414,-1799.9857 2527.3586,-1689.0235 2563.2568,-1605.1941 2511.7953,-1562.2383 2563.3586,-1487.0235 2620.779,-1403.2652 3246.9938,-1040.3667 3344.7942,-1013.0235 3406.1447,-995.8711 3432.7192,-981.5887 3488.1262,-1013.0235 3562.8821,-1055.4358 3547.9597,-1102.6232 3587.3328,-1179.0235"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge916" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M1253.7993,-4981.1899C1264.418,-5047.0928 1318.5968,-5392.043 1336.1997,-5676.0235 1360.5175,-6068.3312 1313.2684,-12362.4057 1372.1997,-12751.0235 1416.6446,-13044.112 1446.1438,-13118.2043 1566.6973,-13389.0235 1694.9515,-13677.1422 1820.7019,-13702.1542 1932.5662,-13997.0235 1963.6715,-14079.0158 1946.1602,-14106.24 1968.5662,-14191.0235 2055.0564,-14518.3005 2714.0875,-16842.9765 2965.166,-17070.0235 3142.3394,-17230.2391 3289.6109,-17061.166 3488.1262,-17194.0235 3510.883,-17209.2536 3506.1197,-17223.3936 3524.1262,-17244.0235 3624.7082,-17359.2596 3631.9235,-17423.551 3773.6733,-17481.0235"/>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M3773.6733,-17481.0235C3831.2594,-17511.2943 3894.4692,-17554.2669 3927.9379,-17577.8622"/>
<polygon fill="#b100ff" stroke="#b100ff" points="3925.9906,-17580.772 3936.1727,-17583.7006 3930.0393,-17575.0616 3925.9906,-17580.772"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge441" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1252.6264,-4958.9396C1257.6572,-4875.0042 1292.605,-4338.9932 1372.1997,-4201.0235 1417.4463,-4122.5929 1487.4332,-4152.5649 1530.6973,-4073.0235 1603.726,-3938.7596 1506.4083,-3871.4701 1566.6973,-3731.0235 1610.4735,-3629.0442 1686.1848,-3643.5278 1728.717,-3541.0235 1804.9326,-3357.3411 1701.0266,-3283.4156 1764.717,-3095.0235 1818.3633,-2936.3413 1870.2863,-2913.6666 1968.5662,-2778.0235 2039.8095,-2679.6954 2071.9826,-2665.9982 2140.8962,-2566.0235 2335.5594,-2283.621 2417.0811,-2222.8061 2527.3586,-1898.0235 2566.9901,-1781.3033 2495.5814,-1725.9823 2563.3586,-1623.0235 2644.0168,-1500.4976 3006.9338,-1362.0361 3142.9189,-1307.0235 3172.58,-1295.0242 3393.8882,-1194.3461 3416.4602,-1217.0235"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge702" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M1286.5702,-4981.1107C1374.5415,-5011.1206 1608.3505,-5102.5216 1728.717,-5261.0235 1764.1985,-5307.7465 1747.2032,-5332.0303 1764.717,-5388.0235 1848.1642,-5654.8113 1866.6822,-5722.7183 1968.5662,-5983.0235 2037.6351,-6159.4892 2089.0081,-6190.7647 2140.8962,-6373.0235 2172.5978,-6484.3763 2148.7854,-6518.7104 2176.8962,-6631.0235 2225.062,-6823.4636 2280.6391,-6858.075 2330.7283,-7050.0235 2356.299,-7148.014 2324.4886,-7182.9811 2366.7283,-7275.0235 2412.8496,-7375.5243 2469.6444,-7370.7015 2527.3586,-7465.0235 2768.7681,-7859.5576 2823.9452,-7974.619 2929.166,-8425.0235 3009.0939,-8767.16 3032.6202,-9936.4116 3035.6821,-10108.7389"/>
<polygon fill="#00cbff" stroke="#00cbff" points="3032.1841,-10108.8859 3035.8579,-10118.8234 3039.183,-10108.7639 3032.1841,-10108.8859"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge774" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1451.4485,-5199.0235C1452.1384,-5199.7687 1565.832,-5288.492 1566.6973,-5289.0235 1634.4715,-5330.6511 1681.9691,-5300.6742 1728.717,-5365.0235 1766.6257,-5417.2053 1752.5957,-5589.6747 1764.717,-5653.0235 1998.7743,-6876.2624 2186.5441,-7151.9654 2563.3586,-8339.0235 2586.1725,-8410.8929 2717.5132,-8932.1404 2771.2632,-8985.0235 2797.4062,-9010.745 2839.8396,-8973.8466 2850.2146,-9009.0235"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1263.4807,-4981.2601C1280.007,-4997.5525 1311.2338,-5028.87 1336.1997,-5057.0235 1390.1284,-5117.8377 1395.3109,-5140.2422 1451.4485,-5199.0235"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1265.4401,-4981.0878C1285.015,-4998.0904 1320.6942,-5032.7193 1336.1997,-5071.0235 1376.6685,-5170.9959 1305.2476,-5470.4681 1372.1997,-5555.0235 1376.5321,-5560.495 1382.0569,-5564.7913 1388.1688,-5568.1612"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1386.9276,-5571.4433 1397.4731,-5572.4647 1389.8662,-5565.09 1386.9276,-5571.4433"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M1253.723,-4981.1949C1263.9074,-5047.1267 1316.0334,-5392.2135 1336.1997,-5676.0235 1360.6983,-6020.8024 1321.3551,-6889.1354 1372.1997,-7231.0235 1387.219,-7332.0162 1426.9439,-7448.0417 1443.7576,-7494.3639"/>
<polygon fill="#5cff00" stroke="#5cff00" points="1440.5182,-7495.6962 1447.2472,-7503.8798 1447.0902,-7493.2861 1440.5182,-7495.6962"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M1323.9534,-4975.3006C1361.8638,-4977.6579 1409.1476,-4979.9333 1451.4485,-4980.0235"/>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M1451.4485,-4980.0235C1759.1456,-4980.6799 1932.0984,-4817.0115 2140.8962,-5043.0235 2214.6853,-5122.896 2140.2413,-5918.6474 2176.8962,-6021.0235 2188.6628,-6053.8871 2215.3087,-6084.7442 2233.9202,-6103.4996"/>
<polygon fill="#5cff00" stroke="#5cff00" points="2231.7454,-6106.2688 2241.3378,-6110.7672 2236.6444,-6101.2687 2231.7454,-6106.2688"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1848.6416,-5165.0235C1956.466,-5237.801 1903.7361,-5319.2418 1968.5662,-5432.0235 2030.2903,-5539.4019 2096.8873,-5535.2513 2140.8962,-5651.0235 2188.4372,-5776.0873 2145.4872,-6121.9675 2176.8962,-6252.0235 2196.8407,-6334.6081 2204.8663,-6357.5809 2253.8123,-6427.0235"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge298" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1848.6416,-5165.0235C1880.2342,-5187.5393 1900.5005,-5167.1867 1932.5662,-5189.0235 2058.4266,-5274.7346 2088.2226,-5318.1504 2140.8962,-5461.0235 2193.3177,-5603.2127 2093.5251,-6015.473 2176.8962,-6142.0235 2272.4587,-6287.0795 2416.0835,-6181.6396 2527.3586,-6315.0235 2564.6677,-6359.7453 2520.9445,-6401.1106 2563.3586,-6441.0235 2620.3419,-6494.6464 2682.9194,-6420.8631 2735.2632,-6479.0235 2782.9861,-6532.0495 2735.2649,-6736.4333 2771.2632,-6798.0235 2814.9409,-6872.7528 2870.5236,-6848.3582 2929.166,-6912.0235 2974.7638,-6961.5269 3010.899,-7033.4609 3026.9737,-7068.416"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3023.8297,-7069.9581 3031.1374,-7077.6294 3030.2086,-7067.0754 3023.8297,-7069.9581"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1451.4485,-4980.0235C1581.0657,-4984.5925 1629.8132,-4987.1216 1728.717,-5071.0235 1755.0941,-5093.3997 1738.0336,-5118.0136 1764.717,-5140.0235 1794.7407,-5164.7886 1821.3689,-5137.2579 1848.6416,-5165.0235"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge355" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1255.484,-4959.0006C1267.6062,-4920.6244 1308.557,-4789.2121 1336.1997,-4679.0235 1354.8863,-4604.5353 1335.1467,-4577.2898 1372.1997,-4510.0235 1401.3524,-4457.0995 1519.1407,-4357.2956 1566.6973,-4320.0235 1817.9726,-4123.0884 1880.0255,-4058.4565 2176.8962,-3941.0235 2322.5859,-3883.3931 2370.9404,-3894.0746 2527.3586,-3903.0235 2581.8266,-3906.1397 2594.7692,-3915.7338 2649.3109,-3917.0235"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge241" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1257.2564,-4958.9116C1278.4466,-4914.338 1356.9823,-4749.8989 1372.1997,-4729.0235 1579.6947,-4444.3794 1637.1057,-4326.2308 1968.5662,-4207.0235 2040.638,-4181.1034 2068.8394,-4181.0617 2140.8962,-4207.0235 2483.1134,-4330.323 2489.0074,-4499.5741 2771.2632,-4729.0235 2790.3216,-4744.5163 2812.1588,-4761.9147 2828.0293,-4774.4959"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2826.1641,-4777.4834 2836.1768,-4780.9471 2830.5095,-4771.9954 2826.1641,-4777.4834"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge225" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2054.7312,-3727.0235C2087.1187,-3703.9719 2103.575,-3716.7149 2140.8962,-3703.0235 2169.6175,-3692.487 2201.1518,-3677.6759 2223.5781,-3666.5544"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2225.2232,-3669.645 2232.597,-3662.0372 2222.0883,-3663.3861 2225.2232,-3669.645"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1255.7538,-4958.7769C1268.5759,-4920.2026 1311.0865,-4789.5463 1336.1997,-4679.0235 1357.7642,-4584.1184 1337.2638,-4553.8612 1372.1997,-4463.0235 1429.7768,-4313.316 1466.1757,-4284.015 1566.6973,-4159.0235 1630.514,-4079.6719 1664.8142,-4076.3059 1728.717,-3997.0235 1747.285,-3973.9868 1744.4852,-3962.6136 1764.717,-3941.0235 1828.137,-3873.346 1871.6229,-3886.9395 1932.5662,-3817.0235 1954.5213,-3791.8359 1942.4083,-3771.8132 1968.5662,-3751.0235 1999.6874,-3726.289 2022.3437,-3750.0751 2054.7312,-3727.0235"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge621" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1451.4485,-5199.0235C1482.2275,-5231.4662 1504.7105,-5224.6289 1530.6973,-5261.0235 1559.1206,-5300.8306 1540.7422,-5323.5648 1566.6973,-5365.0235 1620.7318,-5451.3342 1689.1753,-5433.1847 1728.717,-5527.0235 1792.6855,-5678.8308 1690.3591,-8345.0259 1764.717,-8492.0235 1800.2764,-8562.3206 2280.8099,-8858.0785 2330.7283,-8919.0235 2406.3444,-9011.3428 2379.0784,-9062.9348 2447.0435,-9161.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-9161.0235C2529.8213,-9276.724 2610.7773,-9427.8691 2638.8984,-9481.8131"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2635.951,-9483.7322 2643.6635,-9490.9963 2642.1644,-9480.5081 2635.951,-9483.7322"/>
</g>
<!-- sourcefile~datadaylighting.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~datadaylighting.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/datadaylighting.f90.html" xlink:title="DataDaylighting.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1503.0883,-18481.0289 1399.8087,-18481.0289 1399.8087,-18459.0181 1503.0883,-18459.0181 1503.0883,-18481.0289"/>
<text text-anchor="middle" x="1451.4485" y="-18466.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataDaylighting.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datadaylighting.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge969" class="edge">
<title>sourcefile~datadaylighting.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3951.8339,-18714.0235C4038.2828,-18638.5362 4093.9102,-17765.0033 4102.7763,-17616.4378"/>
<polygon fill="#ff0000" stroke="#ff0000" points="4106.2775,-17616.5186 4103.3737,-17606.3295 4099.2897,-17616.1056 4106.2775,-17616.5186"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2649.3109,-18433.0235C2795.0806,-18440.6235 2822.181,-18493.6662 2965.166,-18523.0235 3194.7043,-18570.1518 3258.2117,-18544.7661 3488.1262,-18590.0235 3697.4432,-18631.2264 3791.1407,-18854.3409 3951.8339,-18714.0235"/>
</g>
<!-- sourcefile~datadaylighting.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge799" class="edge">
<title>sourcefile~datadaylighting.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-18433.0235C2533.0515,-18265.8514 2740.7459,-18086.2172 3488.1262,-17583.0235 3563.9095,-17532.0004 3597.2993,-17531.2662 3650.5393,-17457.0235 3679.0437,-17417.2744 3651.0341,-17386.6669 3686.5393,-17353.0235 3690.3681,-17349.3955 3694.6878,-17346.289 3699.3043,-17343.6296"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3701.1089,-17346.6408 3708.4969,-17339.0468 3697.9857,-17340.3761 3701.1089,-17346.6408"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1503.3077,-18458.9691C1542.7546,-18450.8718 1598.4578,-18440.1032 1647.7072,-18433.0235"/>
</g>
<!-- sourcefile~datadaylighting.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge879" class="edge">
<title>sourcefile~datadaylighting.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M1453.5198,-18458.7731C1472.6254,-18354.9988 1618.0426,-17565.1496 1643.8103,-17425.1898"/>
<polygon fill="#00ddff" stroke="#00ddff" points="1647.267,-17425.7438 1645.6356,-17415.2753 1640.3827,-17424.4763 1647.267,-17425.7438"/>
</g>
<!-- sourcefile~datadaylighting.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge926" class="edge">
<title>sourcefile~datadaylighting.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M1647.7072,-18433.0235C1826.7661,-18407.2834 1873.8316,-18433.0235 2054.7312,-18433.0235 2054.7312,-18433.0235 2054.7312,-18433.0235 2253.8123,-18433.0235 2429.5894,-18433.0235 2473.7291,-18424.7394 2649.3109,-18433.0235"/>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M2649.3109,-18433.0235C2738.4803,-18437.6725 2765.4386,-18404.991 2850.2146,-18433.0235"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge970" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3773.6733,-18775.0235C3857.1952,-18769.6411 3894.4179,-18774.9192 3951.8339,-18714.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1078.1214,-15555.3877C1088.58,-15590.5743 1120.0147,-15701.0143 1131.7661,-15795.0235 1210.8444,-16427.6343 1097.2643,-16595.3996 1167.7661,-17229.0235 1210.1622,-17610.0517 1282.122,-17695.477 1336.1997,-18075.0235 1342.7284,-18120.845 1338.2268,-18458.5899 1372.1997,-18490.0235 1377.9126,-18495.3094 1924.7861,-18494.8047 1932.5662,-18495.0235 2289.5788,-18505.0631 2379.5397,-18501.092 2735.2632,-18533.0235 2991.3644,-18556.0124 3057.9812,-18552.3742 3308.7942,-18609.0235 3435.6944,-18637.6855 3464.222,-18656.9651 3587.3328,-18699.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3587.3328,-18699.0235C3673.3478,-18723.5423 3684.4171,-18780.7755 3773.6733,-18775.0235"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge802" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1081.64,-15555.1919C1096.1749,-15578.1167 1131.4396,-15631.6385 1167.7661,-15671.0235 1203.9188,-15710.2202 1505.1712,-15938.2067 1530.6973,-15985.0235 1585.2775,-16085.128 1481.8407,-16162.8706 1566.6973,-16239.0235 1596.9686,-16266.19 1893.3306,-16240.3022 1932.5662,-16251.0235 2034.3807,-16278.8447 2054.476,-16304.4283 2140.8962,-16365.0235 2250.4311,-16441.826 2253.0483,-16493.5013 2366.7283,-16564.0235 2596.2212,-16706.3911 2686.4717,-16675.5541 2929.166,-16794.0235 2984.4092,-16820.9901 3361.6629,-17083.885 3416.4602,-17056.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3416.4602,-17056.0235C3659.0738,-16854.3355 3541.567,-16054.8618 3587.3328,-16367.0235"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge831" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#f3ff00" stroke-dasharray="5,2" d="M1075.3548,-15532.9728C1080.8945,-15441.1595 1119.1731,-14795.1499 1131.7661,-14270.0235 1132.7093,-14230.6909 1143.4948,-2969.9888 1167.7661,-2939.0235 1169.9042,-2936.2958 1172.3378,-2933.8887 1174.9967,-2931.7666"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="1177.08,-2934.5876 1183.5787,-2926.22 1173.2803,-2928.7086 1177.08,-2934.5876"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge880" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M1451.4485,-17101.0235C1472.07,-17140.7051 1507.8575,-17124.5758 1530.6973,-17163.0235 1580.4034,-17246.6973 1502.6472,-17305.746 1566.6973,-17379.0235 1570.2389,-17383.0754 1574.4213,-17386.4798 1578.9893,-17389.3391"/>
<polygon fill="#00ddff" stroke="#00ddff" points="1577.7046,-17392.6186 1588.1819,-17394.1926 1580.9729,-17386.4284 1577.7046,-17392.6186"/>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M1077.5472,-15555.4798C1086.3526,-15590.9315 1113.5351,-15702.0533 1131.7661,-15795.0235 1150.663,-15891.3893 1146.8274,-15917.0807 1167.7661,-16013.0235 1228.4674,-16291.1621 1264.8646,-16355.4205 1336.1997,-16631.0235 1390.0928,-16839.2392 1352.2708,-16910.178 1451.4485,-17101.0235"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge912" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M1078.1576,-15555.3832C1088.7205,-15590.5571 1120.4234,-15700.9641 1131.7661,-15795.0235 1160.9561,-16037.0804 1100.2546,-17754.7463 1167.7661,-17989.0235 1181.3839,-18036.2795 1215.4973,-18083.6212 1235.8851,-18109.0261"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="1233.1808,-18111.2481 1242.2235,-18116.769 1238.5973,-18106.814 1233.1808,-18111.2481"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge927" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M1077.8692,-15555.3981C1087.5043,-15588.4959 1118.7212,-15686.7297 1167.7661,-15755.0235 1297.4054,-15935.5429 1422.4849,-15904.9007 1530.6973,-16099.0235 1566.3982,-16163.0676 1524.5579,-16200.0196 1566.6973,-16260.0235 1615.7364,-16329.8521 1656.8813,-16316.9747 1728.717,-16363.0235 1874.3282,-16456.3644 2863.0826,-17208.0235 3036.0425,-17208.0235 3036.0425,-17208.0235 3036.0425,-17208.0235 3225.8566,-17208.0235 3293.8646,-17208.0235 3713.4756,-17449.3799 3773.6733,-17481.0235"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge949" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1077.2383,-15555.1981C1086.8408,-15596.5396 1122.5423,-15744.4471 1167.7661,-15861.0235 1373.1506,-16390.4573 1587.0116,-16459.1121 1728.717,-17009.0235 1748.7326,-17086.697 1713.1038,-17668.6243 1764.717,-17730.0235 1789.3257,-17759.298 1816.2472,-17728.6966 1848.6416,-17749.0235"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge443" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-16073.0235C1651.2445,-16074.0956 2173.2054,-16016.2217 2176.8962,-16016.0235 2245.1677,-16012.3573 2262.7957,-16008.3035 2330.7283,-16016.0235 2453.7302,-16030.0018 3370.281,-16380.8814 3416.4602,-16266.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.9829,-15657.0235C1291.6629,-15681.2266 1306.2601,-15683.472 1336.1997,-15719.0235 1359.2457,-15746.3892 1346.3046,-15766.3366 1372.1997,-15791.0235 1427.937,-15844.1603 1479.1739,-15803.7914 1530.6973,-15861.0235 1565.6802,-15899.8825 1541.8168,-15927.0367 1566.6973,-15973.0235 1593.9152,-16023.3307 1595.119,-16050.5265 1647.7072,-16073.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3416.4602,-16266.0235C3441.7887,-16195.3341 3471.2899,-16186.2018 3488.1262,-16113.0235 3572.132,-15747.8973 3586.4323,-9569.4792 3587.2897,-9159.3947"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3590.7901,-9159.185 3587.3108,-9149.1777 3583.7901,-9159.1705 3590.7901,-9159.185"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge469" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1251.9829,-3986.0235C1267.4469,-3950.3076 1308.041,-3988.8907 1336.1997,-3962.0235 1372.5015,-3927.3867 1340.6018,-3893.9992 1372.1997,-3855.0235 1491.524,-3707.8379 1709.9401,-3620.6101 1803.8148,-3588.3509"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1805.2231,-3591.5692 1813.5696,-3585.0433 1802.9752,-3584.94 1805.2231,-3591.5692"/>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1075.3534,-15532.9728C1080.8818,-15441.1592 1119.0864,-14795.1478 1131.7661,-14270.0235 1133.4869,-14198.7591 1123.1532,-4060.6226 1167.7661,-4005.0235 1191.7798,-3975.0964 1234.9603,-4020.4113 1251.9829,-3986.0235"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge509" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2054.7312,-16075.0235C2099.3561,-16066.5387 2149.5474,-16056.7042 2188.3695,-16049.0337"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2189.3618,-16052.4053 2198.4927,-16047.0317 2188.0037,-16045.5383 2189.3618,-16052.4053"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1848.6416,-16075.0235C1940.1554,-16071.1592 1964.7479,-16092.1326 2054.7312,-16075.0235"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1647.7072,-16073.0235C1733.1768,-16098.9267 1759.4125,-16078.7914 1848.6416,-16075.0235"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge528" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M1451.4485,-15657.0235C1510.017,-15676.3438 1672.3651,-15694.0835 1728.717,-15669.0235 1859.0419,-15611.0673 2056.7662,-15292.2 2140.8962,-15177.0235 2193.5271,-15104.9702 2194.2897,-15077.4972 2253.8123,-15011.0235"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge542" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1087.6693,-15533.0043C1181.7655,-15453.1582 1755.6748,-14966.1834 1764.717,-14959.0235 1837.4307,-14901.4469 1885.1101,-14914.712 1932.5662,-14835.0235 1991.3548,-14736.3053 1915.7132,-14681.0428 1968.5662,-14579.0235 2016.9216,-14485.6856 2089.5651,-14508.7586 2140.8962,-14417.0235 2179.4586,-14348.1077 2158.7667,-14319.8855 2176.8962,-14243.0235 2238.121,-13983.4559 2293.186,-13927.0583 2330.7283,-13663.0235 2427.7299,-12980.8105 2265.3951,-12794.6066 2366.7283,-12113.0235 2381.9895,-12010.3741 2422.3984,-11892.4031 2439.3682,-11845.6481"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2442.7275,-11846.6531 2442.8842,-11836.0594 2436.1554,-11844.2432 2442.7275,-11846.6531"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge608" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M2253.8123,-15959.0235C2476.0378,-15899.4878 2541.2219,-15969.9121 2771.2632,-15973.0235 2920.4299,-15975.041 2957.9945,-15981.7582 3106.9189,-15973.0235 3160.0537,-15969.9071 3177.1675,-15937.5201 3225.8566,-15959.0235"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge703" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M1251.9829,-15657.0235C1284.3882,-15676.7616 1298.9832,-15663.6324 1336.1997,-15671.0235 1423.2269,-15688.307 1467.3567,-15653.8912 1530.6973,-15716.0235 1577.4842,-15761.9179 1515.0062,-15818.7327 1566.6973,-15859.0235 1631.0526,-15909.1855 1854.1794,-15850.6805 1932.5662,-15828.0235 2253.3484,-15735.3043 2402.8901,-15678.8713 2527.3586,-15369.0235 2849.6101,-14566.8216 2658.1922,-14296.0891 2735.2632,-13435.0235 2755.2442,-13211.7886 2714.3952,-13148.8163 2771.2632,-12932.0235 2792.0942,-12852.6114 2842.1587,-12846.7261 2850.2146,-12765.0235"/>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M1124.5909,-15555.1104C1127.134,-15556.5529 1129.549,-15558.1826 1131.7661,-15560.0235 1159.5977,-15583.1329 1139.9847,-15609.8538 1167.7661,-15633.0235 1197.6554,-15657.9512 1218.7562,-15636.7566 1251.9829,-15657.0235"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge721" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1451.4485,-15657.0235C1606.3771,-15706.4022 1625.4377,-15551.9425 1764.717,-15468.0235 1839.2905,-15423.0912 1880.663,-15436.9247 1932.5662,-15367.0235 1971.3801,-15314.7503 1937.677,-15282.3373 1968.5662,-15225.0235 2033.6889,-15104.1906 2076.8778,-15091.0335 2176.8962,-14997.0235 2240.8838,-14936.8799 2288.8839,-14950.2292 2330.7283,-14873.0235 2358.725,-14821.3677 2433.1134,-13900.0056 2445.3336,-13746.5929"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2448.8566,-13746.4413 2446.1602,-13736.1954 2441.8786,-13745.8865 2448.8566,-13746.4413"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1251.9829,-15581.0235C1290.8431,-15583.1779 1301.4882,-15587.4204 1336.1997,-15605.0235 1354.2777,-15614.1913 1354.1977,-15623.7074 1372.1997,-15633.0235 1404.8839,-15649.9377 1416.6025,-15645.1871 1451.4485,-15657.0235"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge775" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2253.8123,-15959.0235C2341.7208,-15943.7342 2309.9835,-15861.8837 2366.7283,-15793.0235 2431.2097,-15714.7748 2464.7937,-15710.8129 2527.3586,-15631.0235 2636.6524,-15491.6407 2679.9759,-15459.2971 2735.2632,-15291.0235 2850.6904,-14939.7067 3018.6621,-12102.7771 3034.7872,-11826.6246"/>
<polygon fill="#ff0066" stroke="#ff0066" points="3038.2997,-11826.5116 3035.3875,-11816.3249 3031.3115,-11826.1043 3038.2997,-11826.5116"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1251.9829,-15657.0235C1377.3892,-15732.7633 1429.7708,-15726.8299 1530.6973,-15833.0235 1553.18,-15856.6796 1539.2954,-15879.2971 1566.6973,-15897.0235 1598.8787,-15917.8419 2216.1742,-15966.2638 2253.8123,-15959.0235"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1075.3506,-15532.9727C1080.8556,-15441.1585 1118.9074,-14795.1434 1131.7661,-14270.0235 1133.2271,-14210.3603 1133.0719,-5724.5842 1167.7661,-5676.0235 1193.6917,-5639.736 1312.2578,-5608.9732 1387.6641,-5592.6256"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1388.5008,-5596.0259 1397.5476,-5590.5117 1387.0367,-5589.1807 1388.5008,-5596.0259"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1075.3535,-15532.9728C1080.8827,-15441.1592 1119.0928,-14795.1479 1131.7661,-14270.0235 1133.4979,-14198.2662 1143.0385,-4001.4079 1167.7661,-3934.0235 1207.8011,-3824.9256 1279.2407,-3835.3193 1336.1997,-3734.0235 1360.7921,-3690.2885 1345.9948,-3669.8117 1372.1997,-3627.0235 1424.8073,-3541.1241 1471.4476,-3546.4836 1530.6973,-3465.0235 1547.1563,-3442.3946 1748.1731,-3041.5904 1764.717,-3019.0235 1827.3073,-2933.6465 1878.4368,-2941.0004 1932.5662,-2850.0235 1961.0373,-2802.1712 1925.7568,-2765.6297 1968.5662,-2730.0235 1993.0768,-2709.6371 2239.8222,-2727.6706 2253.8123,-2699.0235"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge402" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1251.9829,-8543.0235C1265.8135,-8510.3991 1505.5802,-8413.0189 1530.6973,-8388.0235 1553.8301,-8365.0027 1541.5996,-8344.8848 1566.6973,-8324.0235 1854.0067,-8085.2113 2001.1982,-8143.2618 2366.7283,-8066.0235 2452.8661,-8047.8222 2475.4811,-8047.3667 2563.3586,-8042.0235 2726.5597,-8032.1005 2774.257,-8028.7145 2929.166,-8081.0235 2979.2142,-8097.9236 2983.3048,-8129.9949 3036.0425,-8133.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M3036.0425,-8133.0235C3057.5514,-8133.0401 3212.1784,-8111.623 3225.8566,-8095.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M3225.8566,-8095.0235C3395.4076,-7889.2604 3414.6906,-5814.0527 3416.3275,-5580.3923"/>
<polygon fill="#002eff" stroke="#002eff" points="3419.8289,-5580.174 3416.3959,-5570.1508 3412.8291,-5580.1271 3419.8289,-5580.174"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1075.3546,-15532.9728C1080.8928,-15441.1594 1119.1612,-14795.1496 1131.7661,-14270.0235 1135.4896,-14114.9007 1125.7838,-3247.4037 1167.7661,-3098.0235 1181.072,-3050.6787 1215.2983,-3003.3692 1235.7898,-2977.9938"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="1238.5039,-2980.2038 1242.1625,-2970.2607 1233.1018,-2975.752 1238.5039,-2980.2038"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge284" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1075.3409,-15532.9725C1080.768,-15441.1564 1118.3097,-14795.1285 1131.7661,-14270.0235 1135.7284,-14115.4044 1129.9827,-8852.0075 1167.7661,-8702.0235 1187.3008,-8624.479 1231.3688,-8620.2881 1251.9829,-8543.0235"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1251.9829,-8543.0235C1260.9834,-8509.2882 1547.8307,-8028.4026 1566.6973,-7999.0235 1648.8621,-7871.0763 1657.1358,-7827.4843 1764.717,-7720.0235 2058.555,-7426.5145 2236.5366,-7476.5212 2527.3586,-7180.0235 2848.3058,-6852.8129 2959.4138,-6760.9776 3106.9189,-6327.0235 3175.0084,-6126.7073 3219.8696,-4521.5531 3225.3007,-4318.183"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3228.7998,-4318.2599 3225.5663,-4308.1706 3221.8023,-4318.0742 3228.7998,-4318.2599"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge299" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1075.3407,-15532.9725C1080.7656,-15441.1563 1118.2934,-14795.128 1131.7661,-14270.0235 1132.7484,-14231.7367 1143.0132,-8784.2492 1167.7661,-8755.0235 1220.6705,-8692.5594 1450.1912,-8706.8363 1530.6973,-8692.0235 1546.7278,-8689.0739 1550.4727,-8686.5863 1566.6973,-8685.0235 1638.3743,-8678.1196 1673.1252,-8639.2543 1728.717,-8685.0235 1793.0477,-8737.9874 1700.3864,-8816.0596 1764.717,-8869.0235 1822.309,-8916.4394 1862.3383,-8894.1859 1932.5662,-8869.0235 2013.1079,-8840.1657 2473.8727,-8446.7992 2527.3586,-8380.0235 2774.859,-8071.0264 2797.1008,-7958.2452 2929.166,-7585.0235 2945.4748,-7538.9342 3013.8736,-7199.7674 3031.7518,-7110.5019"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3035.2305,-7110.9545 3033.7605,-7100.4621 3028.3666,-7109.5811 3035.2305,-7110.9545"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1075.3426,-15532.9725C1080.7827,-15441.1567 1118.4098,-14795.131 1131.7661,-14270.0235 1135.9454,-14105.7125 1135.513,-8514.1921 1167.7661,-8353.0235 1206.5039,-8159.4507 1263.7866,-8125.6736 1336.1997,-7942.0235 1352.7622,-7900.0187 1353.9482,-7888.3224 1372.1997,-7847.0235 1435.07,-7704.763 1476.2701,-7680.7232 1530.6973,-7535.0235 1553.7826,-7473.2249 1546.9859,-7453.9795 1566.6973,-7391.0235 1627.4708,-7196.9196 1686.921,-7162.0784 1728.717,-6963.0235 1791.9113,-6662.0589 1697.3831,-6572.0891 1764.717,-6272.0235 1807.739,-6080.3014 1886.382,-6054.0085 1932.5662,-5863.0235 1976.8105,-5680.0603 1886.5488,-5610.4527 1968.5662,-5441.0235 2044.3599,-5284.4511 2091.829,-5236.4353 2253.8123,-5173.0235"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1075.344,-15532.9725C1080.7959,-15441.1571 1118.5,-14795.1333 1131.7661,-14270.0235 1140.565,-13921.74 1123.3607,-8344.5767 1167.7661,-7999.0235 1206.3518,-7698.7578 1293.1418,-7638.6806 1336.1997,-7339.0235 1368.2058,-7116.2801 1310.3528,-6543.3889 1372.1997,-6327.0235 1411.0767,-6191.0163 1483.1945,-6184.2634 1530.6973,-6051.0235 1563.6748,-5958.5252 1543.6627,-5928.4848 1566.6973,-5833.0235 1587.8401,-5745.4018 1623.9152,-5644.1119 1639.8007,-5601.0909"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1643.1798,-5602.0455 1643.383,-5591.4526 1636.6183,-5599.6067 1643.1798,-5602.0455"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge242" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1075.3519,-15532.9727C1080.8681,-15441.1589 1118.9931,-14795.1455 1131.7661,-14270.0235 1133.34,-14205.3199 1135.6381,-5006.2091 1167.7661,-4950.0235 1210.9816,-4874.448 1262.4713,-4896.3199 1336.1997,-4850.0235 1424.0452,-4794.8625 1446.4752,-4781.5727 1530.6973,-4721.0235 1532.3689,-4719.8218 1763.0633,-4540.2497 1764.717,-4539.0235 1853.8198,-4472.9554 1862.8448,-4428.5985 1968.5662,-4395.0235 2041.5645,-4371.8407 2085.0398,-4342.6187 2140.8962,-4395.0235 2232.4854,-4480.9529 2099.2978,-4860.2767 2176.8962,-4959.0235 2199.0227,-4987.1803 2220.5623,-4969.7259 2253.8123,-4983.0235"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1075.3454,-15532.9726C1080.8086,-15441.1574 1118.5869,-14795.1355 1131.7661,-14270.0235 1141.0426,-13900.4123 1125.1615,-7982.2882 1167.7661,-7615.0235 1183.3027,-7481.0933 1228.4694,-7324.7509 1245.4377,-7269.0431"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1248.846,-7269.8667 1248.4382,-7259.2798 1242.1549,-7267.8103 1248.846,-7269.8667"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge330" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.9829,-3986.0235C1269.2493,-3951.1432 1306.6949,-3987.4051 1336.1997,-3962.0235 1365.4505,-3936.8604 1342.4232,-3907.5622 1372.1997,-3883.0235 1428.1025,-3836.9542 1467.9723,-3881.26 1530.6973,-3845.0235 1550.8418,-3833.3859 1546.5241,-3818.6113 1566.6973,-3807.0235 1630.8322,-3770.1832 1661.98,-3800.9087 1728.717,-3769.0235 1747.0066,-3760.2852 1746.3939,-3749.691 1764.717,-3741.0235 1833.8591,-3708.3171 1876.9419,-3755.5237 1932.5662,-3703.0235 1974.6102,-3663.3408 1932.6863,-3623.3562 1968.5662,-3578.0235 1978.0289,-3566.0677 2435.5024,-3299.0591 2447.0435,-3309.0235"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge491" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1082.6122,-15532.9505C1098.6278,-15510.6018 1136.017,-15458.5235 1167.7661,-15415.0235 1209.9417,-15357.238 1909.6611,-14446.7975 1932.5662,-14379.0235 2013.1173,-14140.6798 1879.6792,-12350.3856 1968.5662,-12115.0235 1981.5062,-12080.7597 2011.5814,-12050.1173 2032.5334,-12031.8024"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2034.975,-12034.3208 2040.3334,-12025.1809 2030.4448,-12028.9844 2034.975,-12034.3208"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge665" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-15845.0235C1772.8085,-15881.3369 1811.6864,-15824.5735 1932.5662,-15776.0235 2275.1945,-15638.4106 2419.6718,-15549.202 2527.3586,-15196.0235 2579.8041,-15024.0191 2545.473,-13756.9541 2563.3586,-13578.0235 2606.5146,-13146.2843 2687.0215,-13048.224 2735.2632,-12617.0235 2793.4742,-12096.7141 2843.6984,-10343.8698 2849.6294,-10131.2093"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2853.1324,-10131.1459 2849.9116,-10121.0526 2846.1351,-10130.9515 2853.1324,-10131.1459"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge622" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1451.4485,-15657.0235C1464.0608,-15661.3076 1553.5065,-15688.1722 1566.6973,-15690.0235 1638.0072,-15700.0317 1659.104,-15708.4433 1728.717,-15690.0235 1829.4903,-15663.3586 1846.4105,-15632.7045 1932.5662,-15574.0235 2026.5014,-15510.0438 2266.6406,-15346.8851 2330.7283,-15253.0235 2360.6891,-15209.1434 2338.5301,-15184.0565 2366.7283,-15139.0235 2418.8905,-15055.7194 2488.1924,-15077.1705 2527.3586,-14987.0235 2586.5351,-14850.82 2522.28,-9783.7323 2563.3586,-9641.0235 2577.0383,-9593.5 2611.9338,-9546.2551 2632.8145,-9520.9391"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2635.5453,-9523.13 2639.3076,-9513.2257 2630.19,-9518.622 2635.5453,-9523.13"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge653" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1451.4485,-15657.0235C1486.2945,-15668.8599 1505.2319,-15654.4555 1530.6973,-15681.0235 1575.1537,-15727.4048 1522.1009,-15774.7767 1566.6973,-15821.0235 1592.7633,-15848.0542 1611.7597,-15834.1665 1647.7072,-15845.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1647.7072,-15845.0235C1714.8577,-15865.3047 1872.7191,-15745.614 1932.5662,-15709.0235 2122.5195,-15592.8861 2212.831,-15593.8896 2330.7283,-15405.0235 2373.9299,-15335.8164 2318.1167,-15290.5438 2366.7283,-15225.0235 2414.9794,-15159.989 2485.3276,-15208.2409 2527.3586,-15139.0235 2569.8938,-15068.976 2555.0033,-12270.547 2563.3586,-12189.0235 2580.1633,-12025.0607 2627.5899,-11831.3625 2643.7993,-11768.1269"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2647.2558,-11768.7398 2646.3681,-11758.1822 2640.4783,-11766.9891 2647.2558,-11768.7398"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge755" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1111.6068,-15555.1179C1147.1741,-15564.9937 1202.6912,-15578.2908 1251.9829,-15581.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.9829,-15581.0235C1423.4428,-15590.5292 1830.8715,-15353.3964 1932.5662,-15215.0235 1982.6884,-15146.8237 1942.086,-15108.4117 1968.5662,-15028.0235 2085.2547,-14673.782 2236.6942,-14631.9402 2330.7283,-14271.0235 2394.28,-14027.1027 2332.4434,-13954.7448 2366.7283,-13705.0235 2385.6349,-13567.3133 2426.5454,-13404.9147 2441.4592,-13347.991"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2444.9147,-13348.6132 2444.0811,-13338.0512 2438.1462,-13346.8278 2444.9147,-13348.6132"/>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge971" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M957.5534,-17875.0748C965.8851,-17878.7509 974.4784,-17883.3819 981.6013,-17889.0235 1035.6208,-17931.809 1019.3205,-17971.9915 1074.6837,-18013.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3416.4602,-18699.0235C3491.9977,-18706.8642 3514.2986,-18678.205 3587.3328,-18699.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.6837,-18013.0235C1124.3584,-18049.8395 1298.4725,-18059.0373 1336.1997,-18108.0235 1390.3865,-18178.3813 1311.2366,-18441.4486 1372.1997,-18506.0235 1457.1832,-18596.0419 1523.9109,-18547.0235 1647.7072,-18547.0235 1647.7072,-18547.0235 1647.7072,-18547.0235 2447.0435,-18547.0235 2883.1594,-18547.0235 2982.6749,-18653.9969 3416.4602,-18699.0235"/>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge870" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M938.0081,-17852.6111C950.4361,-17841.5963 968.837,-17823.9886 981.6013,-17806.0235 1002.5539,-17776.534 992.3181,-17758.8962 1017.6013,-17733.0235 1191.7131,-17554.8524 1483.0341,-17453.1006 1598.4537,-17418.0348"/>
<polygon fill="#00ddff" stroke="#00ddff" points="1599.5208,-17421.3688 1608.0901,-17415.1384 1597.5058,-17414.6651 1599.5208,-17421.3688"/>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge905" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M1074.6837,-18013.0235C1096.7943,-18029.4106 1111.3451,-18018.5738 1131.7661,-18037.0235 1156.5592,-18059.4233 1141.7851,-18082.0133 1167.7661,-18103.0235 1172.4764,-18106.8326 1177.7524,-18110.0615 1183.305,-18112.7986"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="1182.294,-18116.1756 1192.8601,-18116.9562 1185.0869,-18109.7569 1182.294,-18116.1756"/>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge935" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M952.5752,-17875.1495C961.9718,-17879.1805 972.3952,-17883.989 981.6013,-17889.0235 998.4729,-17898.25 1000.9093,-17903.4761 1017.6013,-17913.0235 1076.4478,-17946.6824 1503.7618,-18153.825 1566.6973,-18179.0235 1601.8014,-18193.0787 1610.6836,-18212.7112 1647.7072,-18205.0235"/>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1647.7072,-18205.0235C1886.5756,-18143.2824 2017.0228,-17817.091 2047.6513,-17730.9169"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="2050.9739,-17732.0183 2050.9634,-17721.4235 2044.3646,-17729.7124 2050.9739,-17732.0183"/>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge476" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M942.9519,-17852.8608C961.6435,-17841.6005 991.466,-17823.8137 1017.6013,-17809.0235 1330.388,-17632.015 1540.7132,-17730.3274 1728.717,-17424.0235 1768.3416,-17359.4654 1759.6248,-16136.6008 1764.717,-16061.0235 1811.1799,-15371.4381 1890.0372,-15204.8627 1932.5662,-14515.0235 1940.7716,-14381.9279 1921.5098,-12239.7932 1968.5662,-12115.0235 1981.4908,-12080.7539 2011.5697,-12050.1129 2032.5267,-12031.7999"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2034.9686,-12034.3181 2040.3288,-12025.1792 2030.4395,-12028.9808 2034.9686,-12034.3181"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1508.8516,-10383.0289 1394.0454,-10383.0289 1394.0454,-10361.0181 1508.8516,-10361.0181 1508.8516,-10383.0289"/>
<text text-anchor="middle" x="1451.4485" y="-10368.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge972" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3773.6733,-17367.0235C3850.7643,-17405.3351 3916.754,-17364.4093 3951.8339,-17443.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1509.0358,-10377.3243C1516.799,-10379.7924 1524.2847,-10383.2393 1530.6973,-10388.0235 1568.3062,-10416.0825 1714.0249,-10716.4603 1728.717,-10761.0235 1762.4894,-10863.4599 1735.1525,-10897.2945 1764.717,-11001.0235 1816.4413,-11182.5012 1876.4562,-11210.8536 1932.5662,-11391.0235 1956.8247,-11468.9178 1927.8377,-11500.3327 1968.5662,-11571.0235 2019.55,-11659.5142 2097.1377,-11630.7459 2140.8962,-11723.0235 2232.0821,-11915.3156 2109.8029,-12478.0592 2176.8962,-12680.0235 2214.8556,-12794.2887 2270.0243,-12799.0405 2330.7283,-12903.0235 2431.4063,-13075.4803 2473.0221,-13114.8648 2527.3586,-13307.0235 2828.2386,-14371.0725 2430.0499,-14731.2144 2771.2632,-15783.0235 2833.4238,-15974.6371 3523.5472,-17229.6458 3686.5393,-17348.0235 3718.6097,-17371.3156 3738.1787,-17349.3839 3773.6733,-17367.0235"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge445" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1509.2638,-10382.6228C1516.5204,-10384.2677 1523.8092,-10386.0749 1530.6973,-10388.0235 1706.4521,-10437.7442 1788.7018,-10586.5621 1932.5662,-10474.0235 2287.8273,-10196.1189 1962.7631,-9885.9976 2176.8962,-9489.0235 2297.0137,-9266.342 2363.9581,-9226.7626 2563.3586,-9071.0235 2852.2583,-8845.3824 3029.7287,-8955.7195 3308.7942,-8718.0235 3375.4552,-8661.2445 3372.3105,-8477.4037 3416.4602,-8553.0235"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M1453.0554,-10360.7978C1462.4651,-10294.5473 1510.6945,-9947.8119 1530.6973,-9663.0235 1535.5415,-9594.0534 1524.8438,-8474.0565 1566.6973,-8419.0235 1570.1498,-8414.4837 1574.4133,-8410.7455 1579.1631,-8407.6702"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1581.023,-8410.6439 1588.1677,-8402.8206 1577.7038,-8404.4808 1581.023,-8410.6439"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1478.7696,-10361.0087C1531.5621,-10341.6477 1649.3674,-10307.9827 1728.717,-10357.0235 1759.1508,-10375.8326 1737.3148,-10406.0209 1764.717,-10429.0235 1769.2674,-10432.8432 1774.3841,-10436.0794 1779.7882,-10438.821"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1778.5472,-10442.1 1789.1051,-10442.984 1781.4029,-10435.709 1778.5472,-10442.1"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge480" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1848.6416,-11405.0235C1884.6572,-11500.6283 1908.1948,-11519.8094 1932.5662,-11619.0235 1967.9723,-11763.159 1894.3379,-11822.498 1968.5662,-11951.0235 1980.513,-11971.7094 2002.2758,-11987.5367 2020.9399,-11998.1535"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2019.336,-12001.2652 2029.7968,-12002.9453 2022.667,-11995.1085 2019.336,-12001.2652"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1508.8998,-10381.1893C1517.266,-10384.8651 1524.9726,-10389.964 1530.6973,-10397.0235 1582.4512,-10460.8446 1535.5193,-10689.0002 1566.6973,-10765.0235 1610.1039,-10870.8647 1683.3067,-10860.0263 1728.717,-10965.0235 1775.7243,-11073.7131 1730.8276,-11115.5571 1764.717,-11229.0235 1789.5176,-11312.0592 1818.0914,-11323.9268 1848.6416,-11405.0235"/>
</g>
<!-- sourcefile~daylightingdevices.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge973" class="edge">
<title>sourcefile~daylightingdevices.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1649.5535,-17415.1179C1659.0736,-17470.8505 1704.5037,-17719.318 1764.717,-17763.0235 1819.7001,-17802.9325 1689.4005,-17880.1386 3106.9189,-17667.0235 3278.4808,-17641.2302 3320.2485,-17626.7938 3488.1262,-17583.0235 3491.3812,-17582.1749 3950.4625,-17439.952 3951.8339,-17443.0235"/>
</g>
<!-- sourcefile~daylightingdevices.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge807" class="edge">
<title>sourcefile~daylightingdevices.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1707.2167,-17406.2601C1805.1459,-17409.8172 2006.4203,-17416.6079 2176.8962,-17419.0235 2245.2592,-17419.9922 2262.7071,-17425.9189 2330.7283,-17419.0235 2681.07,-17383.5091 2768.5985,-17357.6956 3106.9189,-17260.0235 3199.0272,-17233.4321 3223.0245,-17226.8556 3308.7942,-17184.0235 3393.2884,-17141.8284 3436.9729,-17149.4152 3488.1262,-17070.0235 3659.0307,-16804.774 3541.9419,-16054.7652 3587.3328,-16367.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge974" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1083.6386,-8150.7554C1097.1665,-8132.9422 1122.2443,-8096.6312 1131.7661,-8061.0235 1147.5644,-8001.9445 1128.037,-3704.5156 1167.7661,-3658.0235 1192.4159,-3629.1776 1242.9748,-3680.882 1251.9829,-3644.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.9829,-3644.0235C1276.2488,-3544.7347 1306.1123,-3527.7059 1336.1997,-3430.0235 1357.5281,-3360.7784 1348.7428,-3339.5768 1372.1997,-3271.0235 1389.3091,-3221.0209 2143.764,-1588.1968 2176.8962,-1547.0235 2228.9954,-1482.2801 2703.6831,-1141.3862 2771.2632,-1093.0235 2942.7252,-970.3192 3415.7139,-486.5386 3587.3328,-609.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge808" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1075.0448,-8173.0654C1078.9253,-8292.0458 1113.1364,-9349.2087 1131.7661,-10205.0235 1154.0931,-11230.6831 1100.23,-11489.3464 1167.7661,-12513.0235 1219.3743,-13295.2727 1279.2936,-13486.5984 1372.1997,-14265.0235 1377.486,-14309.3153 1541.2448,-15822.3918 1566.6973,-15859.0235 1637.8526,-15961.4315 2448.7869,-16325.7912 2563.3586,-16375.0235 2609.4498,-16394.8292 3368.9755,-16687.2056 3416.4602,-16671.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3416.4602,-16671.0235C3446.706,-16656.4121 3464.1691,-16670.5683 3488.1262,-16647.0235 3582.2886,-16554.4818 3568.1815,-16236.3953 3587.3328,-16367.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge822" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#f3ff00" stroke-dasharray="5,2" d="M1083.6436,-8150.7567C1097.1781,-8132.9453 1122.2647,-8096.6366 1131.7661,-8061.0235 1150.1047,-7992.2871 1123.7716,-2994.9294 1167.7661,-2939.0235 1169.7318,-2936.5256 1171.9453,-2934.2968 1174.3525,-2932.3097"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="1176.8011,-2934.8859 1183.2042,-2926.4449 1172.9347,-2929.0505 1176.8011,-2934.8859"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge904" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M1075.0895,-8173.0645C1079.4417,-8292.0359 1117.6175,-9349.1229 1131.7661,-10205.0235 1144.6658,-10985.3716 1129.3322,-16449.5157 1167.7661,-17229.0235 1185.1227,-17581.0466 1236.9521,-18008.1707 1249.3141,-18106.9484"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="1245.843,-18107.3977 1250.5633,-18116.8828 1252.7883,-18106.5243 1245.843,-18107.3977"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge449" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1123.8025,-8173.1117C1126.6055,-8174.5535 1129.2873,-8176.1826 1131.7661,-8178.0235 1211.6893,-8237.3785 1160.2432,-8328.364 1251.9829,-8367.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.9829,-8367.0235C1447.2572,-8449.3129 1573.7248,-8229.5209 1728.717,-8374.0235 1797.8814,-8438.507 1695.0811,-8734.0495 1764.717,-8798.0235 1819.653,-8848.4927 1861.5851,-8820.9755 1932.5662,-8798.0235 1951.3453,-8791.9512 1951.2283,-8781.4537 1968.5662,-8772.0235 2055.8361,-8724.5569 2080.4202,-8714.7193 2176.8962,-8691.0235 2210.5413,-8682.7598 3399.953,-8522.5638 3416.4602,-8553.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge459" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1083.6358,-8150.7546C1097.1601,-8132.9405 1122.2331,-8096.6282 1131.7661,-8061.0235 1161.1441,-7951.3006 1098.9348,-4062.3807 1167.7661,-3972.0235 1191.3506,-3941.0633 1236.6094,-3983.7784 1251.9829,-3948.0235"/>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1251.9829,-3948.0235C1267.3564,-3912.2686 1310.6642,-3953.3952 1336.1997,-3924.0235 1412.4506,-3836.3174 1296.6725,-3753.3536 1372.1997,-3665.0235 1396.1161,-3637.053 1421.9191,-3662.9861 1451.4485,-3641.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge494" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1075.0249,-8173.0659C1078.695,-8292.0511 1111.1378,-9349.2546 1131.7661,-10205.0235 1141.2788,-10599.6566 1132.0041,-11587.899 1167.7661,-11981.0235 1210.0276,-12445.5953 1285.2033,-12553.3292 1336.1997,-13017.0235 1366.4225,-13291.83 1308.9498,-13368.8926 1372.1997,-13638.0235 1413.2217,-13812.5738 1477.426,-13837.8138 1530.6973,-14009.0235 1554.6768,-14086.092 1547.5026,-14108.6262 1566.6973,-14187.0235 1720.0368,-14813.3118 1726.6593,-14983.3354 1968.5662,-15581.0235 2042.5871,-15763.9098 2051.8402,-15820.4212 2176.8962,-15973.0235 2191.574,-15990.9344 2211.9912,-16007.3744 2228.1015,-16018.9664"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2226.3474,-16022.0111 2236.5447,-16024.8861 2230.366,-16016.2795 2226.3474,-16022.0111"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge512" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M1075.0211,-8173.066C1078.6503,-8292.0522 1110.7502,-9349.264 1131.7661,-10205.0235 1132.9257,-10252.2421 1141.7215,-11865.6202 1167.7661,-11905.0235 1213.0518,-11973.5368 1290.8097,-11912.5793 1336.1997,-11981.0235 1427.4801,-12118.6664 1307.9831,-13314.8594 1372.1997,-13467.0235 1411.3646,-13559.8264 1461.3415,-13555.9753 1530.6973,-13629.0235 1636.3871,-13740.3401 1657.443,-13773.2327 1764.717,-13883.0235 1837.1735,-13957.1799 1884.4451,-13953.1896 1932.5662,-14045.0235 1978.5524,-14132.7832 1905.6062,-14188.5216 1968.5662,-14265.0235 2054.5095,-14369.4522 2151.1092,-14283.0252 2253.8123,-14371.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge546" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2253.8123,-11937.0235C2326.4853,-11931.014 2396.6645,-11873.3914 2428.7948,-11843.2307"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2431.328,-11845.6507 2436.1221,-11836.2026 2426.4824,-11840.5989 2431.328,-11845.6507"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1251.9829,-9763.0235C1290.8284,-9942.2781 1302.9868,-9986.6404 1336.1997,-10167.0235 1354.5381,-10266.6212 1324.4639,-10302.7078 1372.1997,-10392.0235 1417.4867,-10476.7572 1474.3393,-10461.2129 1530.6973,-10539.0235 1654.3547,-10709.7511 1667.21,-10768.3903 1728.717,-10970.0235 1757.7532,-11065.2102 1723.2452,-11100.5598 1764.717,-11191.0235 1813.0765,-11296.5114 1868.6942,-11294.1385 1932.5662,-11391.0235 2087.5356,-11626.0907 1973.217,-11960.2266 2253.8123,-11937.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge688" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M1127.0856,-8173.2124C1128.8004,-8174.6401 1130.3745,-8176.2374 1131.7661,-8178.0235 1178.5274,-8238.0388 1113.2656,-9493.9373 1167.7661,-9547.0235 1221.3909,-9599.2567 1264.9715,-9570.0554 1336.1997,-9547.0235 1354.9789,-9540.9512 1353.4205,-9527.0958 1372.1997,-9521.0235 1439.2261,-9499.3503 1460.2629,-9519.8978 1530.6973,-9521.0235 1725.3802,-9524.135 1773.9065,-9530.6915 1968.5662,-9535.0235 2181.1868,-9539.7552 2234.3702,-9541.0235 2447.0435,-9541.0235 2447.0435,-9541.0235 2447.0435,-9541.0235 2649.3109,-9541.0235 2774.1475,-9541.0235 2838.8223,-9478.8714 2929.166,-9565.0235 2972.8126,-9606.6451 2954.1295,-9774.7312 2965.166,-9834.0235 2984.5431,-9938.125 3017.0131,-10060.6207 3030.2053,-10108.9266"/>
<polygon fill="#00cbff" stroke="#00cbff" points="3026.899,-10110.1043 3032.9218,-10118.8207 3033.6492,-10108.2508 3026.899,-10110.1043"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge726" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1074.8163,-8173.2794C1076.7135,-8330.7138 1099.3666,-10094.6043 1167.7661,-10610.0235 1211.7401,-10941.3864 1295.1415,-11011.2867 1336.1997,-11343.0235 1348.2328,-11440.2466 1331.487,-13016.9191 1372.1997,-13106.0235 1411.629,-13192.319 1471.4408,-13174.9273 1530.6973,-13249.0235 1551.0803,-13274.5111 1541.182,-13292.6751 1566.6973,-13313.0235 1625.414,-13359.8501 1661.9129,-13326.7075 1728.717,-13361.0235 1746.7471,-13370.2852 1747.4002,-13378.4883 1764.717,-13389.0235 1849.9509,-13440.8777 1876.9264,-13443.5795 1968.5662,-13483.0235 2044.3469,-13515.6414 2071.7094,-13507.081 2140.8962,-13552.0235 2159.61,-13564.1796 2158.7576,-13574.0249 2176.8962,-13587.0235 2253.4664,-13641.8954 2354.9183,-13687.4584 2409.1021,-13709.9333"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2408.0728,-13713.2943 2418.6527,-13713.8582 2410.7337,-13706.8197 2408.0728,-13713.2943"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge778" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1075.0014,-8173.0665C1078.4231,-8292.058 1108.7782,-9349.3147 1131.7661,-10205.0235 1135.9329,-10360.1302 1123.8643,-11452.2012 1167.7661,-11601.0235 1208.426,-11738.8561 1295.4305,-11739.2233 1336.1997,-11877.0235 1377.6672,-12017.1838 1314.8511,-13057.578 1372.1997,-13192.0235 1483.8636,-13453.8035 2317.5797,-13937.3524 2527.3586,-13745.0235 2595.4276,-13682.6167 2531.5876,-13417.7334 2563.3586,-13331.0235 2608.8724,-13206.8069 2669.6132,-13202.8771 2735.2632,-13088.0235 2754.6118,-13054.1734 2747.2358,-13038.7299 2771.2632,-13008.0235 2798.7577,-12972.8862 2836.4363,-12988.4587 2850.2146,-12946.0235"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2850.2146,-12946.0235C2865.5057,-12899.7807 2908.5939,-12914.171 2929.166,-12870.0235 2979.1211,-12762.8205 2953.3793,-12456.7056 2965.166,-12339.0235 2985.2043,-12138.9554 3021.5758,-11898.2927 3032.7125,-11826.3341"/>
<polygon fill="#ff0066" stroke="#ff0066" points="3036.2,-11826.6845 3034.2769,-11816.2657 3029.283,-11825.6097 3036.2,-11826.6845"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1083.6094,-8150.7475C1097.0984,-8132.9238 1122.1248,-8096.599 1131.7661,-8061.0235 1166.9081,-7931.3528 1106.2592,-5762.4653 1167.7661,-5643.0235 1189.045,-5601.7016 1218.0213,-5612.7552 1251.9829,-5581.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1251.9829,-3644.0235C1262.0023,-3598.6374 1304.5024,-3616.0172 1336.1997,-3582.0235 1446.3534,-3463.8892 1448.7591,-3414.2201 1530.6973,-3275.0235 1547.6473,-3246.2287 1548.7111,-3237.1828 1566.6973,-3209.0235 1713.7667,-2978.7699 1805.1045,-2956.6837 1932.5662,-2715.0235 1955.3854,-2671.7595 1928.7221,-2639.395 1968.5662,-2611.0235 2030.9565,-2566.5977 2068.4628,-2586.1317 2140.8962,-2611.0235 2201.0678,-2631.7016 2225.7445,-2756.1235 2253.8123,-2699.0235"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M2253.8123,-2699.0235C2281.2836,-2642.771 2308.9904,-2639.7303 2330.7283,-2581.0235 2373.0716,-2466.6681 2288.1416,-2402.2665 2366.7283,-2309.0235 2369.534,-2305.6945 2372.7755,-2302.8018 2376.3131,-2300.289"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="2378.2411,-2303.2144 2385.0396,-2295.0884 2374.6575,-2297.2013 2378.2411,-2303.2144"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M1088.2423,-8150.9769C1101.4635,-8139.432 1121.0931,-8120.089 1131.7661,-8099.0235 1167.8514,-8027.8015 1129.2559,-7992.9641 1167.7661,-7923.0235 1217.8634,-7832.039 1287.9451,-7852.9986 1336.1997,-7761.0235 1382.4343,-7672.8988 1307.0791,-7615.2758 1372.1997,-7540.0235 1375.0672,-7536.7098 1378.37,-7533.8305 1381.9643,-7531.3292"/>
<polygon fill="#5cff00" stroke="#5cff00" points="1383.9489,-7534.2232 1390.8126,-7526.1522 1380.4139,-7528.1813 1383.9489,-7534.2232"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge406" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1129.4418,-8151.0148C1187.3082,-8136.8524 1278.0729,-8107.0982 1336.1997,-8051.0235 1363.3883,-8024.7948 1344.909,-8000.1459 1372.1997,-7974.0235 1508.6584,-7843.4066 1585.4904,-7870.6855 1764.717,-7811.0235 2272.6444,-7641.9419 2471.2337,-7780.2903 2929.166,-7503.0235 2949.0669,-7490.974 2944.7911,-7476.2529 2965.166,-7465.0235 2993.2872,-7449.5248 3013.3894,-7473.7797 3036.0425,-7451.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge416" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M1083.6438,-8150.7568C1097.1787,-8132.9454 1122.2657,-8096.6369 1131.7661,-8061.0235 1168.7329,-7922.4494 1160.2371,-3041.2459 1167.7661,-2898.0235 1185.318,-2564.1401 1236.588,-2159.5069 1249.1702,-2063.2776"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="1252.6753,-2063.4675 1250.508,-2053.0967 1245.735,-2062.5555 1252.6753,-2063.4675"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M1251.9829,-8367.0235C1335.73,-8402.3149 1361.0754,-8421.6028 1451.4485,-8412.0235"/>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M1451.4485,-8412.0235C1493.2794,-8407.5896 1540.1958,-8403.263 1577.6656,-8399.9632"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1578.3151,-8403.4199 1587.9715,-8399.0605 1577.7042,-8396.4466 1578.3151,-8403.4199"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1092.4934,-8150.9188C1104.7932,-8142.5372 1120.8408,-8130.0995 1131.7661,-8116.0235 1155.4243,-8085.5427 1146.3466,-8069.117 1167.7661,-8037.0235 1228.7676,-7945.623 1281.9804,-7951.6033 1336.1997,-7856.0235 1364.5148,-7806.1087 1345.698,-7782.9243 1372.1997,-7732.0235 1424.0957,-7632.3488 1480.683,-7635.6556 1530.6973,-7535.0235 1560.058,-7475.9477 1538.3439,-7450.5893 1566.6973,-7391.0235 1629.7359,-7258.5894 1669.7789,-7238.8243 1764.717,-7127.0235 1777.4221,-7112.0618 2234.1882,-6617.4373 2253.8123,-6617.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge303" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1098.2111,-8150.9913C1149.9977,-8125.4355 1274.1652,-8056.9531 1336.1997,-7961.0235 1373.8985,-7902.7264 1328.6358,-7863.0785 1372.1997,-7809.0235 1387.3719,-7790.1976 1741.9128,-7629.0596 1764.717,-7621.0235 1859.9459,-7587.4653 2548.5893,-7405.9624 2649.3109,-7413.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge358" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2649.3109,-3917.0235C2685.8181,-3916.9719 2726.057,-3916.9625 2760.8732,-3916.9694"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2761.0154,-3920.4694 2771.0163,-3916.9719 2761.0172,-3913.4694 2761.0154,-3920.4694"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1251.9829,-3948.0235C1269.0632,-3909.6246 1305.4847,-3933.7081 1336.1997,-3905.0235 1358.928,-3883.7977 1347.5641,-3864.0024 1372.1997,-3845.0235 1430.3063,-3800.259 1465.9298,-3833.4535 1530.6973,-3799.0235 1549.0876,-3789.2473 1548.2508,-3778.6933 1566.6973,-3769.0235 1632.8887,-3734.3254 1659.8672,-3753.0918 1728.717,-3724.0235 1745.7817,-3716.8188 1747.883,-3710.7519 1764.717,-3703.0235 1836.4469,-3670.0929 1872.4653,-3696.1849 1932.5662,-3645.0235 1958.3068,-3623.1115 1939.5525,-3595.3707 1968.5662,-3578.0235 1975.9282,-3573.6218 2322.4625,-3578.648 2330.7283,-3580.0235 2421.5221,-3595.1324 2468.3143,-3574.4149 2527.3586,-3645.0235 2600.2172,-3732.152 2486.1654,-3814.7111 2563.3586,-3898.0235 2589.9489,-3926.7216 2610.1877,-3917.0788 2649.3109,-3917.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge369" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2253.8123,-10149.0235C2284.5664,-10165.1946 2300.1727,-10146.4801 2330.7283,-10163.0235 2351.1866,-10174.1001 2346.9815,-10188.7231 2366.7283,-10201.0235 2373.2649,-10205.0952 2380.5166,-10208.5503 2387.9113,-10211.47"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2386.7174,-10214.76 2397.3115,-10214.888 2389.1095,-10208.1814 2386.7174,-10214.76"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1251.9829,-9687.0235C1303.5248,-9742.4451 1875.5062,-9665.3014 1932.5662,-9715.0235 2007.2632,-9780.1146 1916.3883,-9850.7978 1968.5662,-9935.0235 2018.2582,-10015.2366 2065.6843,-10002.0446 2140.8962,-10059.0235 2192.0501,-10097.7766 2197.0103,-10119.1561 2253.8123,-10149.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.6872,-8150.8581C1108.387,-8142.9217 1123.6462,-8131.0213 1131.7661,-8116.0235 1208.1124,-7975.0085 1130.717,-7913.0406 1167.7661,-7757.0235 1216.0493,-7553.6986 1292.104,-7522.2974 1336.1997,-7318.0235 1393.5988,-7052.1217 1304.8669,-6970.5851 1372.1997,-6707.0235 1516.5022,-6142.1787 1773.8716,-6081.9949 1932.5662,-5521.0235 1952.4061,-5450.891 1921.3585,-5250.554 1968.5662,-5195.0235 1994.3145,-5164.7357 2020.6117,-5191.4242 2054.7312,-5171.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge246" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1083.625,-8150.7517C1097.1346,-8132.9336 1122.1884,-8096.6162 1131.7661,-8061.0235 1154.7353,-7975.6654 1121.1861,-4954.1494 1167.7661,-4879.0235 1212.0582,-4807.5877 1265.2022,-4838.0148 1336.1997,-4793.0235 1445.5299,-4723.7406 1464.0825,-4693.9122 1566.6973,-4615.0235 1638.5863,-4559.7563 1657.9591,-4547.7316 1728.717,-4491.0235 1820.9941,-4417.0692 1845.9227,-4400.5046 1932.5662,-4320.0235 1949.3767,-4304.4086 1947.4295,-4291.9487 1968.5662,-4283.0235 2039.1248,-4253.2294 2085.3167,-4230.3251 2140.8962,-4283.0235 2195.479,-4334.7768 2130.7332,-4899.6379 2176.8962,-4959.0235 2198.8741,-4987.2965 2220.6195,-4969.5838 2253.8123,-4983.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-4983.0235C2346.3953,-5020.0501 2347.5981,-4861.7293 2447.0435,-4869.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge254" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1083.638,-8150.7552C1097.165,-8132.9418 1122.2417,-8096.6305 1131.7661,-8061.0235 1162.8258,-7944.9072 1102.1333,-3834.7213 1167.7661,-3734.0235 1212.6105,-3665.2206 1285.4791,-3722.6167 1336.1997,-3658.0235 1390.0886,-3589.3954 1343.3218,-3547.3636 1372.1997,-3465.0235 1421.7167,-3323.8345 1465.654,-3302.7664 1530.6973,-3168.0235 1548.1771,-3131.8124 1544.8865,-3118.8034 1566.6973,-3085.0235 1643.2164,-2966.5127 2285.413,-2298.8172 2366.7283,-2264.0235 2576.469,-2174.2783 2858.0452,-2213.3335 2978.0053,-2236.4394"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2977.5898,-2239.9246 2988.0766,-2238.4155 2978.9376,-2233.0555 2977.5898,-2239.9246"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1083.112,-8150.958C1096.1669,-8133.131 1120.9033,-8096.456 1131.7661,-8061.0235 1190.0564,-7870.8912 1137.4471,-7811.5656 1167.7661,-7615.0235 1188.3219,-7481.7713 1230.4202,-7325.0144 1246.0064,-7269.1199"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1249.4236,-7269.8964 1248.7558,-7259.3227 1242.6839,-7268.005 1249.4236,-7269.8964"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge334" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.9829,-3948.0235C1268.5835,-3909.4147 1307.7529,-3935.9588 1336.1997,-3905.0235 1364.8029,-3873.9182 1342.1765,-3846.7605 1372.1997,-3817.0235 1419.8107,-3769.8663 1890.6354,-3646.2961 1932.5662,-3594.0235 1995.3849,-3515.7112 1894.9271,-3439.2606 1968.5662,-3371.0235 2015.2255,-3327.787 2191.3003,-3335.2449 2253.8123,-3347.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge474" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1848.6416,-11633.0235C1870.2538,-11665.241 1907.5697,-11627.3548 1932.5662,-11657.0235 2028.1966,-11770.5288 1873.1544,-11875.3343 1968.5662,-11989.0235 1971.2494,-11992.2207 1974.3149,-11995.0225 1977.6534,-11997.4766"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1976.1003,-12000.6303 1986.4518,-12002.888 1979.7675,-11994.6678 1976.1003,-12000.6303"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.8723,-8173.3895C1077.0387,-8299.8181 1098.4277,-9444.7061 1167.7661,-9777.0235 1211.8949,-9988.519 1285.7956,-10022.9351 1336.1997,-10233.0235 1368.1471,-10366.1827 1335.8347,-10407.0023 1372.1997,-10539.0235 1428.4393,-10743.1983 1472.4223,-10784.3858 1566.6973,-10974.0235 1633.2858,-11107.9689 1674.7794,-11129.5025 1728.717,-11269.0235 1753.4386,-11332.971 1744.1524,-11353.6206 1764.717,-11419.0235 1795.3612,-11516.4829 1791.7277,-11548.1813 1848.6416,-11633.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge583" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1075.0122,-8173.0662C1078.5478,-8292.0548 1109.8609,-9349.2863 1131.7661,-10205.0235 1133.9674,-10291.0186 1131.9098,-11674.8294 1167.7661,-11753.0235 1209.7962,-11844.6813 1294.0528,-11813.4194 1336.1997,-11905.0235 1401.0081,-12045.8812 1309.2435,-13158.3284 1372.1997,-13300.0235 1420.6404,-13409.0485 1473.365,-13410.7131 1566.6973,-13485.0235 1802.6588,-13672.8941 1878.5241,-13737.8957 2176.8962,-13782.0235 2330.9813,-13804.8119 2393.3377,-13861.3954 2527.3586,-13782.0235 2784.2178,-13629.9026 2552.4557,-13214.4031 2850.2146,-13193.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge659" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1127.0904,-8173.2087C1128.8039,-8174.6375 1130.3763,-8176.2359 1131.7661,-8178.0235 1233.2755,-8308.5875 1064.38,-9536.9405 1167.7661,-9666.0235 1191.8812,-9696.1325 1223.8252,-9660.6562 1251.9829,-9687.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2649.3109,-9883.0235C2746.4806,-9926.3043 2815.45,-10042.7479 2840.1763,-10089.8436"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2837.0904,-10091.4961 2844.7753,-10098.7894 2843.3159,-10088.2956 2837.0904,-10091.4961"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.9829,-9687.0235C1265.7831,-9699.9462 1913.9602,-9690.6683 1932.5662,-9694.0235 1949.3074,-9697.0424 1952.2258,-9702.2932 1968.5662,-9707.0235 2043.904,-9728.833 2064.4058,-9727.6842 2140.8962,-9745.0235 2312.8897,-9784.012 2358.9769,-9782.5883 2527.3586,-9835.0235 2582.9727,-9852.3421 2596.1022,-9859.3235 2649.3109,-9883.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge677" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1074.8184,-8173.2617C1076.5965,-8317.1088 1096.5436,-9800.658 1167.7661,-10233.0235 1281.401,-10922.859 1586.2034,-11732.3919 1639.6518,-11871.2625"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1636.4427,-11872.6683 1643.3095,-11880.7366 1642.9729,-11870.1471 1636.4427,-11872.6683"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge627" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1127.0243,-8173.2609C1128.7557,-8174.6755 1130.35,-8176.2567 1131.7661,-8178.0235 1224.7417,-8294.0204 1069.3282,-8734.6245 1167.7661,-8846.0235 1251.7428,-8941.0573 1641.8514,-8858.623 1728.717,-8951.0235 1808.6217,-9036.0196 1688.2408,-9122.93 1764.717,-9211.0235 1815.5819,-9269.6151 1872.2937,-9210.162 1932.5662,-9259.0235 1959.13,-9280.5582 1941.2392,-9306.4658 1968.5662,-9327.0235 2011.9687,-9359.6747 2393.3375,-9418.9273 2447.0435,-9427.0235"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge637" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2447.0435,-11101.0235C2558.1739,-11220.3727 2520.9787,-11291.5492 2563.3586,-11449.0235 2591.5235,-11553.6779 2628.5331,-11677.9809 2643.0685,-11726.341"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2639.7328,-11727.4026 2645.9672,-11735.9689 2646.4356,-11725.3845 2639.7328,-11727.4026"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1251.9829,-9763.0235C1273.8163,-9860.25 1310.673,-10116.6389 1372.1997,-10195.0235 1484.3777,-10337.9375 1626.5003,-10244.8235 1728.717,-10395.0235 1795.3413,-10492.923 1701.2381,-10559.0558 1764.717,-10659.0235 1813.1392,-10735.2795 2385.4867,-11034.9142 2447.0435,-11101.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1077.8849,-8173.2617C1088.0629,-8209.5871 1119.7171,-8327.2708 1131.7661,-8427.0235 1140.257,-8497.3186 1134.9301,-9638.2916 1167.7661,-9701.0235 1189.3206,-9742.2023 1241.9294,-9717.6449 1251.9829,-9763.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge975" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M761.6242,-9546.1239C767.5029,-9645.5625 811.194,-10393.6445 831.457,-11001.0235 835.0328,-11108.2048 818.7098,-12835.5022 867.457,-12931.0235 896.3297,-12987.6002 952.9073,-12960.356 981.6013,-13017.0235 1054.8148,-13161.6118 955.5749,-15784.2947 1017.6013,-15934.0235 1045.4072,-16001.1456 1092.3729,-15989.9767 1131.7661,-16051.0235 1155.5732,-16087.9169 1143.329,-16106.5443 1167.7661,-16143.0235 1277.2536,-16306.4641 2250.3195,-17367.0235 2447.0435,-17367.0235 2447.0435,-17367.0235 2447.0435,-17367.0235 3416.4602,-17367.0235 3495.8409,-17367.0235 3699.889,-17337.7462 3773.6733,-17367.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge809" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-12651.0235C930.304,-12765.7146 968.1363,-12788.9792 981.6013,-12903.0235 1000.6239,-13064.139 970.6835,-15667.7213 1017.6013,-15823.0235 1053.1221,-15940.6007 1084.0271,-15965.1687 1167.7661,-16055.0235 1353.4057,-16254.2209 1934.6907,-16625.6123 2176.8962,-16750.0235 2433.2133,-16881.6832 2495.4158,-16925.7112 2771.2632,-17009.0235 2885.678,-17043.5794 2918.3499,-17035.2076 3036.0425,-17056.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge824" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#f3ff00" stroke-dasharray="5,2" d="M761.3339,-9523.8545C765.6924,-9391.5424 807.6456,-8109.694 831.457,-7073.0235 836.7648,-6841.9387 837.7767,-5222.2558 867.457,-4993.0235 894.8373,-4781.555 952.5736,-4738.2722 981.6013,-4527.0235 989.8795,-4466.7789 983.1225,-3483.1149 1017.6013,-3433.0235 1033.2054,-3410.3536 1068.4258,-3435.8237 1074.6837,-3409.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge836" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M761.1596,-9546.2501C763.0985,-9651.7062 780.7517,-10479.2935 867.457,-11143.0235 880.8206,-11245.322 908.2331,-11365.7737 919.5118,-11413.2766"/>
<polygon fill="#6eff00" stroke="#6eff00" points="916.1088,-11414.0952 921.8395,-11423.0064 922.9167,-11412.4665 916.1088,-11414.0952"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge852" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff58" stroke-dasharray="5,2" d="M924.5292,-12347.0235C931.6964,-12428.9427 967.9251,-12441.9366 981.6013,-12523.0235 1013.8913,-12714.4719 1011.2557,-14075.9749 1017.6013,-14270.0235 1034.233,-14778.6141 1067.0116,-15400.8763 1073.538,-15522.7584"/>
<polygon fill="#00ff58" stroke="#00ff58" points="1070.0551,-15523.1727 1074.0862,-15532.9707 1077.0451,-15522.7975 1070.0551,-15523.1727"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge862" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M761.6811,-9546.1222C768.0577,-9645.5458 815.2518,-10393.5226 831.457,-11001.0235 833.9773,-11095.5051 831.4087,-17718.6528 867.457,-17806.0235 874.1112,-17822.1514 887.6276,-17836.2168 899.8366,-17846.4562"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="897.9692,-17849.4422 907.9797,-17852.9121 902.318,-17843.9569 897.9692,-17849.4422"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge871" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M761.6616,-9546.1228C767.8671,-9645.5511 813.858,-10393.5614 831.457,-11001.0235 854.9087,-11810.5012 800.8972,-13837.9462 867.457,-14645.0235 894.5197,-14973.1744 949.0172,-15049.3748 981.6013,-15377.0235 999.7833,-15559.8515 971.7715,-16025.1014 1017.6013,-16203.0235 1097.0574,-16511.491 1200.0177,-16557.0653 1336.1997,-16845.0235 1352.8687,-16880.2704 1356.1956,-16889.4698 1372.1997,-16925.0235 1407.4124,-17003.2498 1414.6291,-17023.5405 1451.4485,-17101.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge883" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#009bff" stroke-dasharray="5,2" d="M924.5292,-8085.0235C950.9393,-8045.6824 975.1672,-8115.9387 1017.6013,-8137.0235 1024.329,-8140.3664 1031.6066,-8143.7351 1038.6409,-8146.8697"/>
<polygon fill="#009bff" stroke="#009bff" points="1037.4439,-8150.1664 1048.0079,-8150.9746 1040.2536,-8143.755 1037.4439,-8150.1664"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge906" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M761.6767,-9546.1223C768.0149,-9645.547 814.939,-10393.5311 831.457,-11001.0235 848.6596,-11633.6912 824.0513,-16065.6122 867.457,-16697.0235 902.5054,-17206.8624 818.645,-17366.3001 1017.6013,-17837.0235 1044.1454,-17899.8257 1185.1296,-18055.698 1234.7164,-18109.4508"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="1232.2427,-18111.9309 1241.6026,-18116.8952 1237.3814,-18107.1775 1232.2427,-18111.9309"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge919" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M761.6572,-9546.1229C767.8247,-9645.5524 813.5473,-10393.5705 831.457,-11001.0235 834.1603,-11092.7113 831.8662,-14218.482 867.457,-14303.0235 895.2766,-14369.1053 953.4146,-14351.0975 981.6013,-14417.0235 1052.9929,-14584.0015 930.1008,-15891.8944 1017.6013,-16051.0235 1046.9713,-16104.4359 1098.8714,-16075.7067 1131.7661,-16127.0235 1187.129,-16213.3913 1105.5366,-16273.4641 1167.7661,-16355.0235 1217.5838,-16420.3157 1283.9389,-16367.6699 1336.1997,-16431.0235 1380.3772,-16484.5781 1343.8902,-16519.6332 1372.1997,-16583.0235 1422.5243,-16695.7096 1475.9929,-16700.3974 1530.6973,-16811.0235 1553.8737,-16857.8922 1535.3602,-16881.1688 1566.6973,-16923.0235 1618.8618,-16992.696 1658.3038,-16981.8633 1728.717,-17033.0235 1932.7385,-17181.2597 1957.7275,-17256.2685 2176.8962,-17381.0235 2337.2992,-17472.328 2387.4874,-17477.033 2563.3586,-17533.0235 2800.4486,-17608.5036 2878.1037,-17569.2867 3106.9189,-17667.0235 3339.5027,-17766.37 3351.532,-17880.5746 3587.3328,-17972.0235"/>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M3587.3328,-17972.0235C3669.3447,-17983.5502 3706.1158,-18019.9276 3773.6733,-17972.0235"/>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M3773.6733,-17972.0235C3899.2754,-17882.9608 3939.1504,-17681.6501 3949.0468,-17616.0916"/>
<polygon fill="#b100ff" stroke="#b100ff" points="3952.5211,-17616.5199 3950.4741,-17606.1247 3945.5918,-17615.5275 3952.5211,-17616.5199"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge936" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M761.6588,-9546.1228C767.8398,-9645.5519 813.6578,-10393.5673 831.457,-11001.0235 837.0157,-11190.7304 822.8333,-14232.5558 867.457,-14417.0235 894.1019,-14527.1694 954.1999,-14535.0634 981.6013,-14645.0235 1021.4294,-14804.851 942.3091,-15980.5237 1017.6013,-16127.0235 1046.6391,-16183.5238 1098.8647,-16158.6823 1131.7661,-16213.0235 1182.627,-16297.0272 1109.8172,-16351.7431 1167.7661,-16431.0235 1217.366,-16498.8816 1288.0294,-16448.1433 1336.1997,-16517.0235 1411.6436,-16624.9031 1298.1134,-16702.2071 1372.1997,-16811.0235 1417.3039,-16877.2716 1481.39,-16833.8412 1530.6973,-16897.0235 1570.2234,-16947.6722 1537.8143,-16979.6356 1566.6973,-17037.0235 1618.1259,-17139.2076 1686.6167,-17130.6559 1728.717,-17237.0235 1769.1432,-17339.1614 1693.0712,-17646.7571 1764.717,-17730.0235 1789.6608,-17759.013 1816.2444,-17728.7009 1848.6416,-17749.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge451" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3225.8566,-8363.0235C3319.4701,-8437.479 3360.9081,-8447.0939 3416.4602,-8553.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.6837,-8047.0235C1633.0692,-7720.3987 1889.8682,-8028.0961 2527.3586,-8138.0235 2848.7672,-8193.4465 2970.5965,-8160.0026 3225.8566,-8363.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge462" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M924.5292,-6489.0235C930.8282,-6407.033 966.9106,-6393.9327 981.6013,-6313.0235 1044.2337,-5968.076 982.5364,-5873.8531 1017.6013,-5525.0235 1050.5337,-5197.4082 1099.4512,-5120.7003 1131.7661,-4793.0235 1141.1415,-4697.9565 1116.1919,-4014.4334 1167.7661,-3934.0235 1213.1449,-3863.273 1285.5681,-3915.1153 1336.1997,-3848.0235 1386.1322,-3781.8581 1316.5834,-3726.4884 1372.1997,-3665.0235 1396.8916,-3637.7351 1421.9191,-3662.9861 1451.4485,-3641.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge498" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1647.7072,-16187.0235C1692.2704,-16201.6615 2008.6509,-16083.7851 2054.7312,-16075.0235"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M924.5292,-12651.0235C930.266,-12765.7165 968.0877,-12788.985 981.6013,-12903.0235 990.5292,-12978.3641 984.6801,-15565.6707 1017.6013,-15634.0235 1055.0367,-15711.749 1098.6017,-15705.4586 1167.7661,-15757.0235 1240.236,-15811.0527 1263.1154,-15817.8284 1336.1997,-15871.0235 1337.5857,-15872.0323 1529.7585,-16021.5892 1530.6973,-16023.0235 1565.8824,-16076.7786 1522.1009,-16116.7767 1566.6973,-16163.0235 1592.7633,-16190.0542 1611.7616,-16176.1602 1647.7072,-16187.0235"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M761.6048,-9546.1246C767.3131,-9645.569 809.8059,-10393.6923 831.457,-11001.0235 837.5945,-11173.1828 821.3553,-12385.0382 867.457,-12551.0235 881.1518,-12600.3304 921.9558,-12599.9149 924.5292,-12651.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge515" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M761.5909,-9546.1251C767.1785,-9645.5739 808.8212,-10393.7283 831.457,-11001.0235 837.0875,-11152.0827 836.0481,-12213.1586 867.457,-12361.0235 895.0385,-12490.8695 954.9403,-12506.9854 981.6013,-12637.0235 1014.2638,-12796.3331 942.2172,-15419.9277 1017.6013,-15564.0235 1055.5891,-15636.6367 1097.0488,-15629.6132 1167.7661,-15671.0235 1178.3373,-15677.2137 1554.7428,-15856.3478 1566.6973,-15859.0235 1636.9674,-15874.7517 1662.6609,-15887.6916 1728.717,-15859.0235 2238.2583,-15637.8849 2415.5346,-14849.6871 2443.0855,-14710.9538"/>
<polygon fill="#65ff00" stroke="#65ff00" points="2446.5214,-14711.6205 2444.9981,-14701.1357 2439.6505,-14710.282 2446.5214,-14711.6205"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge547" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1074.6837,-11558.0235C1146.0307,-11544.1176 1675.1942,-11523.8395 1728.717,-11573.0235 1783.685,-11623.5355 1727.5624,-11842.2742 1764.717,-11907.0235 1787.7977,-11947.2462 1818.8574,-11933.4779 1848.6416,-11969.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M761.4566,-9546.4054C767.8944,-9695.0598 835.9171,-11253.153 867.457,-11454.0235 882.9925,-11552.9655 857.474,-11597.6295 924.5292,-11672.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1848.6416,-11969.0235C1873.6388,-11998.6916 1904.6923,-11966.0401 1932.5662,-11993.0235 1970.1331,-12029.3904 1930.8742,-12068.7862 1968.5662,-12105.0235 1997.2236,-12132.5749 2014.9779,-12129.0615 2054.7312,-12129.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M924.5292,-11672.0235C980.628,-11734.2621 992.5055,-11574.3776 1074.6837,-11558.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge597" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M924.5292,-12347.0235C926.7913,-12373.0428 964.7343,-12341.083 981.6013,-12361.0235 1016.5709,-12402.3651 1009.5593,-12793.4761 1017.6013,-12847.0235 1122.88,-13548.0146 1149.222,-13729.1542 1372.1997,-14402.0235 1508.0619,-14812.0086 1501.2593,-14948.7716 1764.717,-15291.0235 1835.4763,-15382.9453 1868.9712,-15394.548 1968.5662,-15454.0235 2215.2078,-15601.3115 2289.5621,-15620.0676 2563.3586,-15707.0235 2687.6751,-15746.5055 2733.1046,-15711.5897 2850.2146,-15769.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge691" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M1074.6837,-11558.0235C1100.3032,-11552.925 1108.3516,-11560.4428 1131.7661,-11572.0235 1150.1823,-11581.1321 1149.5387,-11591.5427 1167.7661,-11601.0235 1397.9853,-11720.7706 1558.7519,-11566.9315 1728.717,-11763.0235 1804.5481,-11850.5112 1705.7524,-11921.3861 1764.717,-12021.0235 1822.274,-12118.2822 1863.2062,-12132.1418 1968.5662,-12173.0235 2039.433,-12200.5212 2587.0501,-12284.6335 2649.3109,-12241.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge706" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M924.5292,-12081.0235C935.1616,-12131.0801 959.6208,-12134.8113 981.6013,-12181.0235 1000.639,-12221.0486 995.1069,-12235.8339 1017.6013,-12274.0235 1070.4767,-12363.7921 1089.4907,-12385.2691 1167.7661,-12454.0235 1234.399,-12512.5515 1284.6,-12488.8922 1336.1997,-12561.0235 1375.8374,-12616.4332 1324.5582,-12661.3237 1372.1997,-12710.0235 1377.7985,-12715.7466 1384.7629,-12719.9686 1392.2226,-12723.0727"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1391.2761,-12726.4493 1401.871,-12726.4357 1393.5801,-12719.8393 1391.2761,-12726.4493"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge727" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M924.5292,-12081.0235C936.667,-12130.7365 965.1485,-12132.5672 981.6013,-12181.0235 1019.5328,-12292.7384 976.8094,-12333.3211 1017.6013,-12444.0235 1108.3202,-12690.2192 1256.7244,-12690.9716 1336.1997,-12941.0235 1362.8828,-13024.976 1326.3906,-13657.7804 1372.1997,-13733.0235 1591.0741,-14092.5322 2258.611,-13812.3433 2414.3259,-13740.5973"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2416.2371,-13743.5688 2423.8322,-13736.1819 2413.2884,-13737.2201 2416.2371,-13743.5688"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge779" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M761.5636,-9546.1262C766.9116,-9645.5843 806.8687,-10393.8042 831.457,-11001.0235 836.3779,-11122.5453 838.5421,-11976.8893 867.457,-12095.0235 895.3479,-12208.9737 946.4871,-12221.0881 981.6013,-12333.0235 1011.5198,-12428.3964 977.8585,-12463.3086 1017.6013,-12555.0235 1050.6318,-12631.2484 1093.9127,-12629.0751 1131.7661,-12703.0235 1157.3321,-12752.9678 1137.2717,-12776.9264 1167.7661,-12824.0235 1221.4518,-12906.9383 1293.108,-12880.1409 1336.1997,-12969.0235 1417.7078,-13137.1451 1281.4732,-13645.6921 1372.1997,-13809.0235 1518.6854,-14072.7361 1782.3773,-13930.4022 1932.5662,-14192.0235 1988.6898,-14289.788 1908.6681,-14602.525 1968.5662,-14698.0235 2015.5001,-14772.8527 2090.8045,-14724.2704 2140.8962,-14797.0235 2199.0741,-14881.5208 2098.9031,-14958.3788 2176.8962,-15025.0235 2228.8744,-15069.4386 2270.9384,-15058.1837 2330.7283,-15025.0235 2475.0544,-14944.9784 2468.7659,-14864.3094 2527.3586,-14710.0235 2723.7268,-14192.9489 2656.5151,-14030.4953 2735.2632,-13483.0235 2754.6339,-13348.3543 2721.9009,-13305.8083 2771.2632,-13179.0235 2814.7988,-13067.2043 2887.0653,-13072.3908 2929.166,-12960.0235 3011.3747,-12740.6078 3032.4384,-11965.7093 3035.5909,-11826.5184"/>
<polygon fill="#ff0066" stroke="#ff0066" points="3039.0945,-11826.3876 3035.8152,-11816.3131 3032.0962,-11826.2337 3039.0945,-11826.3876"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M761.2227,-9523.8016C764.6352,-9377.243 801.862,-7841.3502 867.457,-7653.0235 896.4277,-7569.8471 944.8007,-7571.0443 981.6013,-7491.0235 1008.8047,-7431.8713 995.4121,-7410.2334 1017.6013,-7349.0235 1057.5842,-7238.7292 1104.4167,-7225.1089 1131.7661,-7111.0235 1151.7683,-7027.5865 1106.3925,-5626.9828 1167.7661,-5567.0235 1198.0375,-5537.4497 1315.2842,-5553.387 1389.2403,-5567.095"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1388.8991,-5570.5923 1399.375,-5569.0095 1390.1985,-5563.714 1388.8991,-5570.5923"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M761.2987,-9523.965C767.1675,-9329.6565 848.7165,-6637.9056 867.457,-6475.0235 897.4867,-6214.0231 951.9553,-6156.0678 981.6013,-5895.0235 1038.3016,-5395.7558 931.2357,-5260.0226 1017.6013,-4765.0235 1045.8699,-4603.0041 1102.9601,-4574.9482 1131.7661,-4413.0235 1149.9755,-4310.6647 1119.0816,-3569.886 1167.7661,-3478.0235 1211.2959,-3395.8875 1288.6342,-3433.8901 1336.1997,-3354.0235 1395.6671,-3254.1726 1314.2002,-3195.7341 1372.1997,-3095.0235 1416.8355,-3017.5177 1478.7238,-3043.8127 1530.6973,-2971.0235 1559.1206,-2931.2164 1542.9448,-2909.7823 1566.6973,-2867.0235 1622.2488,-2767.0209 1676.5458,-2768.8305 1728.717,-2667.0235 1756.4496,-2612.9062 1721.9833,-2578.2855 1764.717,-2535.0235 1791.9802,-2507.4233 1821.1482,-2538.3944 1848.6416,-2511.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M924.5292,-8085.0235C963.7333,-8026.6242 973.0234,-8011.4317 1017.6013,-7957.0235 1065.0779,-7899.0774 1087.3243,-7893.3286 1131.7661,-7833.0235 1150.6695,-7807.3726 1142.8318,-7790.8626 1167.7661,-7771.0235 1229.0735,-7722.2439 1283.6673,-7777.1474 1336.1997,-7719.0235 1390.6115,-7658.8202 1317.9729,-7600.3935 1372.1997,-7540.0235 1375.2651,-7536.6108 1378.7916,-7533.6602 1382.6174,-7531.1095"/>
<polygon fill="#5cff00" stroke="#5cff00" points="1384.4249,-7534.1083 1391.408,-7526.1404 1380.9802,-7528.0146 1384.4249,-7534.1083"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge408" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M3036.0425,-7451.0235C3247.1516,-7249.2782 3104.4519,-7087.5967 3225.8566,-6822.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M924.5292,-8085.0235C1000.6745,-7967.5932 1057.6497,-7971.4086 1167.7661,-7885.0235 1241.3209,-7827.3206 1265.107,-7819.7339 1336.1997,-7759.0235 1353.1694,-7744.532 1353.8117,-7736.667 1372.1997,-7724.0235 1603.5066,-7564.9778 1691.3341,-7560.0779 1968.5662,-7516.0235 1997.9051,-7511.3613 3014.5655,-7471.5478 3036.0425,-7451.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M924.5292,-11672.0235C1056.6704,-11800.2838 1610.0666,-11731.19 1728.717,-11872.0235 1799.2067,-11955.6921 1707.6143,-12269.7041 1764.717,-12363.0235 1866.3313,-12529.0853 2098.9922,-12614.9485 2202.5124,-12646.0844"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="2201.8327,-12649.5331 2212.4147,-12649.0137 2203.8184,-12642.8207 2201.8327,-12649.5331"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M761.2941,-9523.8535C765.1896,-9391.5297 802.8786,-8109.5735 831.457,-7073.0235 839.777,-6771.2544 829.9361,-6014.5665 867.457,-5715.0235 896.0029,-5487.1315 953.5531,-5438.9773 981.6013,-5211.0235 992.6358,-5121.3443 966.7721,-3659.7263 1017.6013,-3585.0235 1033.0832,-3562.27 1069.5418,-3588.06 1074.6837,-3561.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M761.0272,-9523.8533C761.8187,-9399.6123 771.5963,-8274.779 867.457,-7957.0235 897.0172,-7859.0386 939.3151,-7850.2261 981.6013,-7757.0235 1001.8106,-7712.4805 988.8154,-7692.5692 1017.6013,-7653.0235 1054.9867,-7601.6639 1094.3807,-7618.3831 1131.7661,-7567.0235 1160.552,-7527.4778 1141.4099,-7504.2284 1167.7661,-7463.0235 1223.7323,-7375.5266 1291.9724,-7395.0016 1336.1997,-7301.0235 1427.2955,-7107.4552 1281.8568,-7014.9443 1372.1997,-6821.0235 1553.2233,-6432.4571 2071.766,-6196.4059 2216.1153,-6136.9334"/>
<polygon fill="#5cff00" stroke="#5cff00" points="2217.5307,-6140.1361 2225.4642,-6133.1139 2214.8832,-6133.656 2217.5307,-6140.1361"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M761.9575,-9523.9421C767.4304,-9468.8959 798.4422,-9221.8236 924.5292,-9079.0235"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M924.5292,-9079.0235C977.6283,-9018.8859 1195.0016,-8870.5508 1251.9829,-8927.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1848.6416,-10645.0235C1896.5416,-10675.7871 1964.508,-10667.9247 2009.0954,-10657.566"/>
<polygon fill="#002eff" stroke="#002eff" points="2010.1919,-10660.9008 2019.0687,-10655.1169 2008.5225,-10654.1027 2010.1919,-10660.9008"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M924.5292,-10105.0235C1006.7565,-10225.1031 1106.4479,-10105.0235 1251.9829,-10105.0235 1251.9829,-10105.0235 1251.9829,-10105.0235 1451.4485,-10105.0235 1597.409,-10105.0235 1650.9468,-10157.5073 1728.717,-10281.0235 1800.7393,-10395.4106 1696.7813,-10466.1632 1764.717,-10583.0235 1788.0241,-10623.1154 1809.6216,-10619.963 1848.6416,-10645.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M761.7712,-9546.0985C766.6669,-9607.142 796.6213,-9906.9771 924.5292,-10105.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M924.5292,-8085.0235C967.1712,-8021.503 1489.5225,-8306.0891 1618.875,-8377.9062"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1617.3937,-8381.0872 1627.8342,-8382.8893 1620.7963,-8374.9698 1617.3937,-8381.0872"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M924.5292,-12081.0235C938.6537,-12146.6334 1294.1577,-12470.7107 1336.1997,-12523.0235 1376.9718,-12573.7562 1418.9231,-12638.247 1439.1137,-12670.2107"/>
<polygon fill="#ff008b" stroke="#ff008b" points="1436.1515,-12672.075 1444.4347,-12678.681 1442.079,-12668.3513 1436.1515,-12672.075"/>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M761.5119,-9546.1284C766.4081,-9645.6062 803.1861,-10393.9645 831.457,-11001.0235 847.9935,-11356.11 823.9494,-11447.2247 867.457,-11800.0235 883.0548,-11926.5041 898.0509,-11956.3658 924.5292,-12081.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M761.9091,-9546.1952C767.4254,-9608.5147 797.6812,-9912.3593 867.457,-9967.0235 907.3919,-9998.3096 931.0975,-9971.817 981.6013,-9967.0235 1008.0596,-9964.5123 1426.0536,-9869.1848 1451.4485,-9877.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M761.2168,-9523.8122C764.6965,-9370.7457 804.0575,-7698.5355 867.457,-7491.0235 896.241,-7396.8112 947.6075,-7393.4838 981.6013,-7301.0235 1015.4881,-7208.8544 998.7458,-7179.3974 1017.6013,-7083.0235 1061.7011,-6857.6222 1103.7179,-6806.9793 1131.7661,-6579.0235 1142.8208,-6489.179 1109.2846,-5019.1188 1167.7661,-4950.0235 1221.7998,-4886.1833 1325.8793,-4882.6157 1391.8328,-4887.8766"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1391.806,-4891.388 1402.0771,-4888.7888 1392.427,-4884.4155 1391.806,-4891.388"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-8085.0235C952.7986,-8042.3673 962.8301,-8032.6297 981.6013,-7985.0235 1007.0674,-7920.4384 977.9437,-7890.0062 1017.6013,-7833.0235 1052.4207,-7782.9927 1087.2258,-7798.6365 1131.7661,-7757.0235 1145.3851,-7744.2996 1329.5525,-7508.4358 1336.1997,-7491.0235 1374.7443,-7390.0564 1315.5719,-7098.0742 1372.1997,-7006.0235 1453.2505,-6874.2723 1821.8961,-6696.1711 1968.5662,-6647.0235 2089.436,-6606.5213 2127.2858,-6601.4991 2253.8123,-6617.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M762.1074,-9523.6206C775.5579,-9389.5239 903.6395,-8117.2393 924.5292,-8085.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge275" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M762.3623,-9523.6144C770.3787,-9457.75 810.8888,-9119.4086 831.457,-8842.0235 844.1405,-8670.9731 819.6222,-8235.7382 867.457,-8071.0235 896.0003,-7972.7375 940.5943,-7964.7959 981.6013,-7871.0235 1002.89,-7822.3419 985.6719,-7799.4926 1017.6013,-7757.0235 1054.2311,-7708.3025 1098.0888,-7731.8302 1131.7661,-7681.0235 1179.2515,-7609.3855 1117.6705,-7560.8611 1167.7661,-7491.0235 1217.861,-7421.187 1290.3805,-7468.7369 1336.1997,-7396.0235 1399.6068,-7295.3989 1309.6306,-6963.1713 1372.1997,-6862.0235 1424.9111,-6776.8116 1479.5511,-6797.4716 1566.6973,-6748.0235 1835.7798,-6595.3419 1888.1289,-6524.0664 2176.8962,-6413.0235 2414.9084,-6321.4981 2526.6956,-6427.7418 2735.2632,-6281.0235 2864.5029,-6190.109 2871.2132,-6130.0263 2929.166,-5983.0235 3183.8744,-5336.9313 3220.7902,-4465.5977 3225.2922,-4318.5186"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3228.8005,-4318.2784 3225.5903,-4308.1816 3221.8034,-4318.0766 3228.8005,-4318.2784"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge305" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M924.5292,-8085.0235C961.982,-8027.2643 1015.2403,-8081.7412 1074.6837,-8047.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1074.6837,-8047.0235C1112.7139,-8024.8122 1110.0338,-8004.3294 1131.7661,-7966.0235 1151.2059,-7931.7585 1143.1979,-7915.8197 1167.7661,-7885.0235 1226.0678,-7811.9425 1267.2968,-7822.2083 1336.1997,-7759.0235 1362.5464,-7734.8633 1732.0913,-7293.6325 1764.717,-7279.0235 1832.8026,-7248.5365 1864.3224,-7248.8923 1932.5662,-7279.0235 2006.2906,-7311.5746 1981.5789,-7379.2062 2054.7312,-7413.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge359" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M761.3062,-9523.9863C765.2673,-9395.7725 802.9078,-8175.7199 831.457,-7189.0235 835.617,-7045.2503 820.0385,-6030.8158 867.457,-5895.0235 895.3091,-5815.2637 953.7793,-5822.7938 981.6013,-5743.0235 1030.2855,-5603.438 987.6476,-4557.789 1017.6013,-4413.0235 1045.2491,-4279.4025 1102.8224,-4261.3698 1131.7661,-4128.0235 1168.2898,-3959.7558 1110.1223,-3516.2739 1167.7661,-3354.0235 1209.9431,-3235.3076 1283.4242,-3240.4224 1336.1997,-3126.0235 1365.8255,-3061.8052 1343.5012,-3035.6615 1372.1997,-2971.0235 1422.2793,-2858.2284 1469.8946,-2850.4188 1530.6973,-2743.0235 1549.9066,-2709.0942 1543.9346,-2694.6788 1566.6973,-2663.0235 1637.7426,-2564.2228 1857.7508,-2341.3124 1968.5662,-2291.0235 2081.7752,-2239.6483 2437.5247,-2178.0841 2527.3586,-2264.0235 2592.6169,-2326.4527 2515.7607,-2999.274 2563.3586,-3076.0235 2609.3658,-3150.2079 2685.2983,-3099.4449 2735.2632,-3171.0235 2820.5648,-3293.2247 2845.0311,-3787.1684 2849.4272,-3895.8185"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2845.9322,-3896.0169 2849.8203,-3905.8725 2852.9269,-3895.7434 2845.9322,-3896.0169"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge373" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1074.6837,-10219.0235C1187.132,-10250.303 1222.5686,-10216.3589 1336.1997,-10243.0235 1518.3281,-10285.7616 1612.7759,-10248.2075 1728.717,-10395.0235 1802.108,-10487.9583 1678.7943,-10577.5349 1764.717,-10659.0235 1858.5607,-10748.0242 1931.1236,-10721.088 2054.7312,-10683.0235"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2054.7312,-10683.0235C2140.9793,-10661.5439 2192.8638,-10766.7181 2253.8123,-10702.0235"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2253.8123,-10702.0235C2385.5917,-10562.1445 2432.4294,-10320.5166 2443.9565,-10247.518"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2447.4683,-10247.7039 2445.5109,-10237.2915 2440.5478,-10246.6519 2447.4683,-10247.7039"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M924.5292,-10105.0235C938.6988,-10126.963 959.1904,-10105.612 981.6013,-10119.0235 1002.1246,-10131.3054 1001.3569,-10141.4688 1017.6013,-10159.0235 1042.5999,-10186.0386 1040.8454,-10204.542 1074.6837,-10219.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2054.7312,-5171.0235C2129.5855,-5123.8386 2171.1551,-5204.6049 2253.8123,-5173.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-7743.0235C932.7257,-7716.7557 963.8189,-7740.0227 981.6013,-7719.0235 1026.4659,-7666.0431 988.1328,-7629.8833 1017.6013,-7567.0235 1053.4641,-7490.5241 1093.1236,-7490.157 1131.7661,-7415.0235 1156.0676,-7367.7737 1128.1443,-7336.4244 1167.7661,-7301.0235 1224.6509,-7250.1987 1286.631,-7326.0061 1336.1997,-7268.0235 1405.8494,-7186.5513 1341.6961,-6406.7772 1372.1997,-6304.0235 1459.9326,-6008.4886 1618.8168,-5997.0511 1728.717,-5709.0235 1759.0452,-5629.5393 1705.5751,-5582.1771 1764.717,-5521.0235 1817.89,-5466.0419 1881.3207,-5539.8059 1932.5662,-5483.0235 2021.9472,-5383.9853 1876.1791,-5281.2637 1968.5662,-5185.0235 1995.4343,-5157.0348 2021.91,-5191.7126 2054.7312,-5171.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M761.0986,-9523.9737C762.9067,-9379.6702 783.8014,-7867.621 867.457,-7691.0235 896.9664,-7628.7291 948.3709,-7646.415 981.6013,-7586.0235 1024.9313,-7507.2775 980.4312,-7468.8575 1017.6013,-7387.0235 1051.2338,-7312.9782 1104.0061,-7320.4645 1131.7661,-7244.0235 1161.5088,-7162.1228 1111.7841,-5742.7945 1167.7661,-5676.0235 1250.3898,-5577.4764 1323.3003,-5608.2418 1451.4485,-5619.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge247" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M761.1016,-9523.6934C762.985,-9372.2276 785.007,-7745.5185 867.457,-7273.0235 897.1129,-7103.075 946.5272,-7070.937 981.6013,-6902.0235 1010.9682,-6760.5958 999.6046,-6722.3424 1017.6013,-6579.0235 1063.2819,-6215.2413 1099.8043,-6127.2668 1131.7661,-5762.0235 1141.5263,-5650.4894 1128.2627,-4859.7833 1167.7661,-4755.0235 1218.4087,-4620.7237 1264.8839,-4600.3358 1372.1997,-4505.0235 1526.8443,-4367.6763 1570.7261,-4326.7643 1764.717,-4255.0235 1921.9936,-4196.8602 2018.4646,-4111.4401 2140.8962,-4226.0235 2229.1909,-4308.6582 2102.0584,-4674.0302 2176.8962,-4769.0235 2199.0573,-4797.1531 2230.1999,-4766.1007 2253.8123,-4793.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge257" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M761.2917,-9523.8534C765.1591,-9391.5288 802.5895,-8109.5655 831.457,-7073.0235 835.5725,-6925.2489 835.7434,-5887.4137 867.457,-5743.0235 895.0551,-5617.3714 954.4317,-5602.769 981.6013,-5477.0235 1023.3326,-5283.8844 943.9081,-3882.3634 1017.6013,-3699.0235 1045.5396,-3629.5165 1101.9243,-3643.7348 1131.7661,-3575.0235 1174.1123,-3477.5207 1115.3607,-3190.5096 1167.7661,-3098.0235 1212.9524,-3018.2779 1290.8619,-3058.6831 1336.1997,-2979.0235 1436.3206,-2803.1086 1276.4006,-2703.3289 1372.1997,-2525.0235 1414.5307,-2446.2352 1484.2794,-2477.4754 1530.6973,-2401.0235 1575.9823,-2326.4374 1526.6946,-2285.571 1566.6973,-2208.0235 1624.7712,-2095.4438 1659.9891,-2074.2895 1764.717,-2003.0235 1852.6564,-1943.1819 2548.4713,-1603.1749 2649.3109,-1637.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M924.5292,-7743.0235C932.7257,-7716.7557 964.1908,-7740.3321 981.6013,-7719.0235 1033.2214,-7655.8462 993.8969,-7617.0882 1017.6013,-7539.0235 1036.8861,-7475.5136 1026.1977,-7446.3503 1074.6837,-7401.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M761.4452,-9523.6551C767.605,-9378.4316 831.5573,-7889.2859 867.457,-7805.0235 882.1369,-7770.5675 913.3731,-7778.7762 924.5292,-7743.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge217" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M761.2605,-9523.8152C765.3311,-9370.5834 810.9711,-7690.0208 867.457,-7197.0235 899.2516,-6919.5267 941.3754,-6855.4241 981.6013,-6579.0235 1072.1083,-5957.1322 1075.0814,-5798.9046 1131.7661,-5173.0235 1151.2225,-4958.1974 1117.4406,-4898.7761 1167.7661,-4689.0235 1222.6286,-4460.3615 1243.5015,-4397.8305 1372.1997,-4201.0235 1440.7606,-4096.1793 1469.9037,-4076.5464 1566.6973,-3997.0235 1632.6278,-3942.8568 1670.63,-3956.5276 1728.717,-3894.0235 1751.7292,-3869.2615 1738.3924,-3848.2304 1764.717,-3827.0235 1794.9283,-3802.6856 1815.4933,-3823.1789 1848.6416,-3803.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge335" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M761.3126,-9523.7623C767.4239,-9325.9506 852.2654,-6587.9965 867.457,-6551.0235 881.6911,-6516.381 921.6834,-6526.368 924.5292,-6489.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-6489.0235C934.5104,-6358.0421 967.1862,-6329.5913 981.6013,-6199.0235 998.7502,-6043.6939 973.9147,-4943.0664 1017.6013,-4793.0235 1045.1417,-4698.4353 1103.8851,-4697.5119 1131.7661,-4603.0235 1166.2805,-4486.0549 1099.9287,-3607.3694 1167.7661,-3506.0235 1213.4494,-3437.7747 1268.1456,-3475.9963 1336.1997,-3430.0235 1365.6007,-3410.1622 1537.9025,-3229.754 1566.6973,-3209.0235 1647.3729,-3150.9418 1670.7234,-3137.3845 1764.717,-3105.0235 1923.5637,-3050.3344 2008.2216,-2964.9671 2140.8962,-3068.0235 2191.9743,-3107.6989 2141.9308,-3154.6128 2176.8962,-3209.0235 2200.6337,-3245.962 2222.021,-3240.7377 2253.8123,-3271.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge477" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-11283.0235C1674.6081,-11319.5196 1705.4939,-11306.0837 1728.717,-11345.0235 1780.8145,-11432.3788 1711.8799,-11484.1136 1764.717,-11571.0235 1788.8078,-11610.6495 1822.1399,-11594.9677 1848.6416,-11633.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M761.3535,-9546.2261C763.7851,-9606.7935 779.8108,-9900.4475 867.457,-10119.0235 872.8162,-10132.3884 1537.4239,-11133.4036 1647.7072,-11283.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge585" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-15277.0235C2677.1157,-15373.7979 2725.9059,-15420.1656 2929.166,-15565.0235 2979.7368,-15601.0639 3001.0633,-15706.334 3036.0425,-15655.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-12347.0235C926.8,-12373.042 964.5749,-12341.219 981.6013,-12361.0235 1039.6396,-12428.5316 984.8434,-12677.2425 1017.6013,-12760.0235 1047.9105,-12836.6163 1096.3955,-12831.6325 1131.7661,-12906.0235 1162.6925,-12971.0675 1145.4893,-12995.5333 1167.7661,-13064.0235 1226.5443,-13244.7374 1292.5908,-13272.0623 1336.1997,-13457.0235 1367.7686,-13590.9184 1320.9233,-13947.371 1372.1997,-14075.0235 1412.6829,-14175.8062 1482.3293,-14163.7785 1530.6973,-14261.0235 1563.737,-14327.4507 1532.8576,-14358.0002 1566.6973,-14424.0235 1815.1939,-14908.8564 1940.094,-15077.4845 2447.0435,-15277.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3036.0425,-15655.0235C3187.3997,-15415.646 3223.2061,-10735.9675 3225.7106,-10380.3805"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3229.2121,-10380.1674 3225.7818,-10370.1432 3222.2122,-10380.1186 3229.2121,-10380.1674"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge557" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1451.4485,-13985.0235C1469.9945,-14016.8101 1505.2319,-13982.4555 1530.6973,-14009.0235 1575.1537,-14055.4048 1522.1009,-14102.7767 1566.6973,-14149.0235 1592.7633,-14176.0542 1615.3815,-14153.9148 1647.7072,-14173.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-12347.0235C931.6964,-12428.9427 960.82,-12443.4606 981.6013,-12523.0235 1002.2189,-12601.9597 974.1756,-12633.9568 1017.6013,-12703.0235 1051.4146,-12756.8021 1097.9528,-12735.2449 1131.7661,-12789.0235 1175.1918,-12858.0902 1128.5716,-12897.4708 1167.7661,-12969.0235 1217.6647,-13060.1172 1293.4586,-13036.3603 1336.1997,-13131.0235 1374.1854,-13215.1545 1315.6007,-13888.1024 1372.1997,-13961.0235 1394.7644,-13990.0955 1432.9025,-13953.2369 1451.4485,-13985.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M761.5768,-9546.1256C767.0403,-9645.5792 807.8106,-10393.7668 831.457,-11001.0235 841.9069,-11269.3838 811.2177,-11946.4144 867.457,-12209.0235 881.3558,-12273.9235 918.7584,-12280.9033 924.5292,-12347.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge661" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.6837,-10219.0235C1098.6988,-10229.3011 1108.2014,-10221.7516 1131.7661,-10233.0235 1234.8693,-10282.3415 1249.0689,-10315.059 1336.1997,-10389.0235 1518.9675,-10544.1733 1617.7338,-10546.5188 1728.717,-10759.0235 1779.0557,-10855.4093 1682.3641,-10930.0152 1764.717,-11001.0235 1900.0233,-11117.6905 2181.8255,-10879.134 2366.7283,-10821.0235 2489.3928,-10782.473 2575.307,-10864.1717 2649.3109,-10759.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2649.3109,-10759.0235C2804.2096,-10517.9995 2569.6493,-10329.5869 2771.2632,-10126.0235 2777.5556,-10119.6702 2785.6297,-10115.4925 2794.2031,-10112.7998"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2795.1683,-10116.1664 2804.0264,-10110.3539 2793.477,-10109.3738 2795.1683,-10116.1664"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge678" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M924.5292,-11672.0235C1062.2069,-11849.0985 1154.3252,-11851.7186 1372.1997,-11905.0235 1447.2947,-11923.3962 1537.2507,-11913.4241 1593.4545,-11903.5519"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1594.3328,-11906.9496 1603.545,-11901.7166 1593.0801,-11900.0626 1594.3328,-11906.9496"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge628" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-9079.0235C1019.5334,-8983.3793 1406.4932,-9050.612 1530.6973,-9103.0235 1662.7818,-9158.7605 1642.8004,-9249.5962 1764.717,-9325.0235 1961.4361,-9446.7296 2023.8281,-9527.8834 2253.8123,-9503.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge639" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M924.5292,-10105.0235C938.6988,-10126.963 962.5403,-10101.1687 981.6013,-10119.0235 1020.3789,-10155.3472 989.7511,-10187.7744 1017.6013,-10233.0235 1075.471,-10327.0462 1670.6069,-10833.1493 1728.717,-10927.0235 1756.2372,-10971.481 1723.9038,-11006.3417 1764.717,-11039.0235 2002.4072,-11229.3575 2232.7386,-10884.6972 2447.0435,-11101.0235"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge743" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-12081.0235C935.7705,-12130.9469 963.6699,-12133.0946 981.6013,-12181.0235 1010.1889,-12257.4352 980.9068,-12288.1571 1017.6013,-12361.0235 1112.5083,-12549.4854 1250.5847,-12520.1627 1336.1997,-12713.0235 1401.2623,-12859.5869 1320.976,-12920.0692 1372.1997,-13072.0235 1425.0009,-13228.6574 1422.4567,-13308.2969 1566.6973,-13389.0235 1856.9897,-13551.4903 2288.1211,-13393.775 2412.3811,-13342.1217"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2413.9291,-13345.2677 2421.7923,-13338.167 2411.2173,-13338.8143 2413.9291,-13345.2677"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3482,-15726.0289 539.0902,-15726.0289 539.0902,-15704.0181 632.3482,-15704.0181 632.3482,-15726.0289"/>
<text text-anchor="middle" x="585.7192" y="-15711.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge976" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.6447,-15726.2845C593.2275,-15806.7458 633.307,-16302.7473 654.4731,-16707.0235 660.3791,-16819.8287 649.0169,-17617.946 690.4731,-17723.0235 725.5023,-17811.8107 770.9265,-17811.2246 831.457,-17885.0235 1080.7687,-18188.9847 1045.7773,-18365.9411 1372.1997,-18585.0235 1477.6684,-18655.8101 1520.6859,-18661.0235 1647.7072,-18661.0235 1647.7072,-18661.0235 1647.7072,-18661.0235 1848.6416,-18661.0235 2031.858,-18661.0235 2071.41,-18719.771 2253.8123,-18737.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-18737.0235C2429.3468,-18746.256 2473.5337,-18737.0235 2649.3109,-18737.0235 2649.3109,-18737.0235 2649.3109,-18737.0235 2850.2146,-18737.0235 3020.5493,-18737.0235 3055.5681,-18809.0556 3225.8566,-18813.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3225.8566,-18813.0235C3469.8512,-18807.4093 3530.1194,-18790.7189 3773.6733,-18775.0235"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge811" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3225.8566,-17170.0235C3317.9456,-17134.4853 3342.561,-17121.4626 3416.4602,-17056.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-16341.0235C778.0511,-16368.0112 805.054,-16337.0471 831.457,-16355.0235 855.9146,-16371.6754 847.1117,-16389.5404 867.457,-16411.0235 1056.0424,-16610.1551 1134.7487,-16628.7835 1372.1997,-16766.0235 1737.2123,-16976.9905 2832.535,-17321.8109 3225.8566,-17170.0235"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge825" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#f3ff00" stroke-dasharray="5,2" d="M1074.6837,-3409.0235C1082.0524,-3378.1274 1116.4088,-3393.8268 1131.7661,-3366.0235 1177.8077,-3282.6684 1106.0374,-3011.5319 1167.7661,-2939.0235 1169.7808,-2936.657 1172.0175,-2934.5355 1174.4273,-2932.635"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="1176.6948,-2935.3384 1183.217,-2926.989 1172.9116,-2929.4487 1176.6948,-2935.3384"/>
<path fill="none" stroke="#f3ff00" stroke-dasharray="5,2" d="M587.5626,-15703.6991C597.0418,-15644.83 640.3984,-15367.7058 654.4731,-15139.0235 669.3225,-14897.7558 633.4378,-6671.9226 690.4731,-6437.0235 722.974,-6303.169 797.76,-6294.5819 831.457,-6161.0235 853.6699,-6072.9826 818.8535,-4603.7197 867.457,-4527.0235 897.8099,-4479.1268 950.9456,-4517.7269 981.6013,-4470.0235 1043.9307,-4373.0327 952.1468,-3527.9333 1017.6013,-3433.0235 1033.2259,-3410.3677 1068.2991,-3435.7938 1074.6837,-3409.0235"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge853" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff58" stroke-dasharray="5,2" d="M924.5292,-15544.0235C953.118,-15517.3517 999.7485,-15521.9326 1033.4671,-15530.301"/>
<polygon fill="#00ff58" stroke="#00ff58" points="1032.9173,-15533.7772 1043.4828,-15532.9892 1034.7319,-15527.0165 1032.9173,-15533.7772"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge863" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M586.305,-15726.0385C590.9311,-15810.6297 623.1669,-16357.8408 690.4731,-16507.0235 729.7258,-16594.0261 796.5951,-16580.1705 831.457,-16669.0235 923.7891,-16904.3514 767.9695,-17573.6302 867.457,-17806.0235 874.3232,-17822.0623 887.8471,-17836.1246 900.007,-17846.3846"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="898.1116,-17849.3501 908.1089,-17852.8578 902.481,-17843.8813 898.1116,-17849.3501"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge872" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M924.5292,-16683.0235C963.1744,-16725.6574 973.8555,-16735.6417 1017.6013,-16773.0235 1065.8959,-16814.2923 1098.8647,-16804.6823 1131.7661,-16859.0235 1182.627,-16943.0272 1116.4439,-16993.3008 1167.7661,-17077.0235 1216.348,-17156.276 1262.0753,-17144.9278 1336.1997,-17201.0235 1352.3628,-17213.2554 1355.2347,-17217.9306 1372.1997,-17229.0235 1439.2778,-17272.8839 1473.5958,-17258.7862 1530.6973,-17315.0235 1553.9494,-17337.9238 1541.2975,-17358.5311 1566.6973,-17379.0235 1571.3939,-17382.8128 1576.6641,-17386.0295 1582.2036,-17388.76"/>
<polygon fill="#00ddff" stroke="#00ddff" points="1581.1613,-17392.1236 1591.7268,-17392.9112 1583.9585,-17385.7068 1581.1613,-17392.1236"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge892" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0058ff" stroke-dasharray="5,2" d="M587.5432,-15703.6979C596.9256,-15644.8227 639.8767,-15367.673 654.4731,-15139.0235 713.0582,-14221.3012 664.3846,-11920.2437 690.4731,-11001.0235 707.2257,-10410.755 751.4149,-9687.8043 759.6378,-9556.1127"/>
<polygon fill="#0058ff" stroke="#0058ff" points="763.1315,-9556.3219 760.2636,-9546.1226 756.1452,-9555.8842 763.1315,-9556.3219"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge907" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M586.733,-15726.2004C594.0126,-15806.0543 639.4924,-16298.2106 690.4731,-16697.0235 694.7002,-16730.0911 846.0136,-17858.4987 867.457,-17884.0235 884.6534,-17904.4929 905.3356,-17884.4139 924.5292,-17903.0235"/>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M924.5292,-17903.0235C965.853,-17958.1658 963.2687,-17984.6407 1017.6013,-18027.0235 1039.3011,-18043.9507 1049.7118,-18039.4557 1074.6837,-18051.0235"/>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M1074.6837,-18051.0235C1099.6557,-18062.5913 1108.0141,-18061.122 1131.7661,-18075.0235 1149.2599,-18085.2622 1149.7385,-18093.7569 1167.7661,-18103.0235 1175.9345,-18107.2223 1184.9199,-18110.829 1193.8861,-18113.8899"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="1192.9768,-18117.2739 1203.5681,-18116.9993 1195.1173,-18110.6092 1192.9768,-18117.2739"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge921" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M2054.7312,-18395.0235C2400.4601,-18470.8726 2514.1589,-18321.9014 2850.2146,-18433.0235"/>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M586.0092,-15726.2461C588.3104,-15807.8355 605.8096,-16310.1022 690.4731,-16431.0235 731.3005,-16489.3354 789.4148,-16449.5813 831.457,-16507.0235 882.2184,-16576.3787 847.7658,-16613.3628 867.457,-16697.0235 923.7448,-16936.1692 899.5956,-17013.5389 1017.6013,-17229.0235 1350.7333,-17837.3402 1386.4828,-18209.3622 2054.7312,-18395.0235"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge938" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M924.5292,-16683.0235C942.706,-16702.2613 958.7711,-16686.6344 981.6013,-16700.0235 1000.8506,-16711.3125 998.5341,-16723.4297 1017.6013,-16735.0235 1063.2943,-16762.807 1094.2453,-16734.9189 1131.7661,-16773.0235 1169.0457,-16810.8831 1139.521,-16842.0199 1167.7661,-16887.0235 1285.5864,-17074.7493 1371.6682,-17074.6463 1530.6973,-17229.0235 1546.933,-17244.7843 1549.5293,-17250.2837 1566.6973,-17265.0235 1634.4853,-17323.2239 1684.2855,-17306.51 1728.717,-17384.0235 1767.1606,-17451.0906 1713.4012,-17672.2084 1764.717,-17730.0235 1790.104,-17758.6257 1816.2444,-17728.7009 1848.6416,-17749.0235"/>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M586.5286,-15726.3213C592.1283,-15802.3669 626.7829,-16240.0355 690.4731,-16355.0235 730.9056,-16428.0212 784.9384,-16409.7453 831.457,-16479.0235 858.7242,-16519.6313 847.2478,-16538.4805 867.457,-16583.0235 888.6002,-16629.6248 889.1747,-16646.0266 924.5292,-16683.0235"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge453" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-16341.0235C776.0501,-16369.1786 801.7766,-16343.2192 831.457,-16355.0235 1190.0668,-16497.6478 1220.0098,-16647.4639 1566.6973,-16817.0235 1650.8207,-16858.167 1676.7,-16857.0463 1764.717,-16889.0235 1855.3081,-16921.9359 1873.6389,-16946.3266 1968.5662,-16963.0235 2561.8433,-17067.3758 2913.9685,-17215.9739 3308.7942,-16761.0235 3340.8537,-16724.0819 3328.1011,-16703 3344.7942,-16657.0235 3405.971,-16488.5292 3454.5182,-16456.1015 3488.1262,-16280.0235 3560.0698,-15903.0994 3585.6424,-9576.4948 3587.2509,-9159.5873"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3590.7514,-9159.4531 3587.2898,-9149.4397 3583.7514,-9159.4261 3590.7514,-9159.4531"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M632.4797,-15717.8292C640.8253,-15720.397 648.6894,-15724.5226 654.4731,-15731.0235 702.0388,-15784.4866 677.9971,-15980.5598 690.4731,-16051.0235 713.5985,-16181.6341 690.0131,-16228.9534 760.9651,-16341.0235"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1526.1202,-7037.0289 1376.7768,-7037.0289 1376.7768,-7015.0181 1526.1202,-7015.0181 1526.1202,-7037.0289"/>
<text text-anchor="middle" x="1451.4485" y="-7022.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge737" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M587.553,-15703.6985C596.9841,-15644.8264 640.1395,-15367.6897 654.4731,-15139.0235 732.6619,-13891.6683 610.3172,-10762.2538 690.4731,-9515.0235 739.4278,-8753.2872 568.4416,-8446.1899 1017.6013,-7829.0235 1146.4901,-7651.9242 1246.2899,-7652.7551 1336.1997,-7453.0235 1382.2791,-7350.6596 1340.9619,-7310.8469 1372.1997,-7203.0235 1389.4357,-7143.5302 1422.8253,-7078.1366 1440.2505,-7046.0468"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1443.363,-7047.6503 1445.1103,-7037.2005 1437.2278,-7044.2799 1443.363,-7047.6503"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge782" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M760.9651,-16037.0235C819.0556,-16046.9427 814.7352,-16089.6929 867.457,-16116.0235 1027.5988,-16196.0022 1713.1485,-16340.9745 1764.717,-16347.0235 1838.8087,-16355.7145 1858.4469,-16355.4752 1932.5662,-16347.0235 2113.0202,-16326.4466 2211.193,-16391.7656 2330.7283,-16255.0235 2387.4278,-16190.1622 2325.2098,-15944.5089 2366.7283,-15869.0235 2393.8251,-15819.7584 2720.9625,-15590.1459 2771.2632,-15565.0235 2804.0735,-15548.6366 2834.8762,-15574.3369 2850.2146,-15541.0235"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2850.2146,-15541.0235C2961.0525,-15302.79 2954.1768,-13441.5487 2965.166,-13179.0235 2988.2209,-12628.2563 3027.3095,-11953.8659 3034.7861,-11826.3579"/>
<polygon fill="#ff0066" stroke="#ff0066" points="3038.2829,-11826.5139 3035.3753,-11816.3258 3031.2949,-11826.1033 3038.2829,-11826.5139"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M587.5607,-15703.699C597.0305,-15644.8293 640.3479,-15367.7026 654.4731,-15139.0235 661.2052,-15030.0356 657.7186,-7381.1908 690.4731,-7277.0235 723.5325,-7171.8868 797.0723,-7177.7343 831.457,-7073.0235 873.2819,-6945.6552 856.7238,-6000.6528 867.457,-5867.0235 898.6799,-5478.295 944.762,-5385.26 981.6013,-4997.0235 1007.3401,-4725.7718 981.4213,-4655.0809 1017.6013,-4385.0235 1050.2897,-4141.0287 1097.3539,-4086.7812 1131.7661,-3843.0235 1147.1214,-3734.2548 1118.863,-3448.3846 1167.7661,-3350.0235 1212.1306,-3260.791 1288.3409,-3289.4316 1336.1997,-3202.0235 1386.9449,-3109.3436 1332.6246,-3064.9952 1372.1997,-2967.0235 1417.8777,-2853.9435 1469.1402,-2848.3055 1530.6973,-2743.0235 1549.5624,-2710.7583 1542.2608,-2695.3042 1566.6973,-2667.0235 1635.8507,-2586.9915 1668.7193,-2579.4279 1764.717,-2535.0235 1799.9277,-2518.7366 1821.8418,-2539.0739 1848.6416,-2511.0235"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1848.6416,-2511.0235C1876.2299,-2483.7483 1902.3549,-2511.3614 1932.5662,-2487.0235 1958.8908,-2465.8166 1945.1494,-2444.4032 1968.5662,-2420.0235 2065.9904,-2318.5931 2113.2656,-2277.8995 2253.8123,-2283.0235"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge409" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M587.5583,-15703.6989C597.0162,-15644.8284 640.2836,-15367.6987 654.4731,-15139.0235 666.5208,-14944.8666 644.3394,-8325.0043 690.4731,-8136.0235 723.0459,-8002.5937 785.497,-7990.4537 831.457,-7861.0235 857.3004,-7788.2447 828.7277,-7757.8418 867.457,-7691.0235 1008.1787,-7448.242 1205.8142,-7516.509 1336.1997,-7268.0235 1390.8128,-7163.9432 1298.4142,-7097.5167 1372.1997,-7006.0235 1695.2071,-6605.4976 2058.9893,-7296.061 2527.3586,-7083.0235 2650.4066,-7027.0552 2662.9245,-6975.2179 2735.2632,-6861.0235 2758.5385,-6824.281 2735.2933,-6794.476 2771.2632,-6770.0235 2939.4415,-6655.6953 3141.3082,-7006.9734 3225.8566,-6822.0235"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M587.5613,-15703.699C597.0339,-15644.8295 640.3629,-15367.7036 654.4731,-15139.0235 682.1666,-14690.206 635.995,-7491.3824 690.4731,-7045.0235 722.6126,-6781.6936 796.1268,-6727.9444 831.457,-6465.0235 905.7126,-5912.4273 791.3161,-5763.3631 867.457,-5211.0235 895.9872,-5004.0611 952.8581,-4961.9564 981.6013,-4755.0235 990.5483,-4690.6111 980.787,-3638.6305 1017.6013,-3585.0235 1033.1812,-3562.337 1069.6065,-3588.0722 1074.6837,-3561.0235"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1074.6837,-3561.0235C1080.7605,-3529.1272 1146.3294,-3008.4114 1167.7661,-2984.0235 1173.1468,-2977.9021 1179.9507,-2973.2469 1187.3492,-2969.7126"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="1189.0241,-2972.8103 1196.9762,-2965.8093 1186.3938,-2966.3233 1189.0241,-2972.8103"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.5598,-15703.6989C597.0252,-15644.8289 640.324,-15367.7012 654.4731,-15139.0235 667.3733,-14930.5309 648.3131,-7823.616 690.4731,-7619.0235 700.2494,-7571.5819 1348.8267,-6056.4497 1372.1997,-6014.0235 1431.9264,-5905.609 1468.7761,-5892.1998 1530.6973,-5785.0235 1549.3948,-5752.6609 1537.6209,-5732.5076 1566.6973,-5709.0235 1624.2367,-5662.5508 1677.5052,-5724.3887 1728.717,-5671.0235 1787.6221,-5609.6417 1723.0336,-5557.1856 1764.717,-5483.0235 1814.0286,-5395.2897 1882.6059,-5418.3896 1932.5662,-5331.0235 1971.7686,-5262.4698 1907.329,-5206.8879 1968.5662,-5157.0235 2027.9578,-5108.662 2064.4947,-5151.6374 2140.8962,-5157.0235 2191.457,-5160.5879 2206.4643,-5191.114 2253.8123,-5173.0235"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M587.5585,-15703.6989C597.0174,-15644.8285 640.289,-15367.699 654.4731,-15139.0235 678.7828,-14747.105 626.7018,-8458.4823 690.4731,-8071.0235 700.5903,-8009.5542 829.6457,-7588.5324 867.457,-7539.0235 934.6196,-7451.0831 993.8503,-7476.5899 1074.6837,-7401.0235"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge478" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.5268,-15726.2965C591.1157,-15780.6282 619.0122,-16013.804 760.9651,-16037.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-16037.0235C874.5804,-16055.6078 833.6202,-15640.0638 867.457,-15530.0235 887.0853,-15466.1907 885.3284,-15445.0901 924.5292,-15391.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-15391.0235C1028.9772,-15246.9663 1053.9263,-15209.7801 1167.7661,-15073.0235 1405.5061,-14787.4245 1520.706,-14760.9497 1728.717,-14453.0235 1749.1902,-14422.7163 1742.5202,-14408.0921 1764.717,-14379.0235 1824.8995,-14300.2097 1890.8437,-14321.9834 1932.5662,-14232.0235 2031.5482,-14018.6036 1885.3277,-12335.0618 1968.5662,-12115.0235 1981.5252,-12080.7668 2011.5958,-12050.1227 2032.5415,-12031.8055"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2034.9827,-12034.3242 2040.3391,-12025.1831 2030.4513,-12028.9888 2034.9827,-12034.3242"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge663" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-16037.0235C811.7534,-16045.891 818.856,-16065.8181 867.457,-16083.0235 1071.2569,-16155.1713 1128.52,-16152.9501 1336.1997,-16213.0235 1352.2711,-16217.6723 1355.9093,-16220.2126 1372.1997,-16224.0235 1457.5021,-16243.979 1479.542,-16247.153 1566.6973,-16256.0235 1744.5285,-16274.1229 1789.8516,-16268.4673 1968.5662,-16272.0235 2132.9098,-16275.2938 2232.3391,-16328.7015 2330.7283,-16197.0235 2384.6787,-16124.8196 2346.5745,-15880.8749 2366.7283,-15793.0235 2411.7868,-15596.6113 2482.0073,-15565.3683 2527.3586,-15369.0235 2754.067,-14387.5077 2669.7661,-14117.2499 2735.2632,-13112.0235 2816.3075,-11868.1826 2846.216,-10330.4216 2849.8329,-10131.5507"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2853.3373,-10131.3342 2850.018,-10121.2728 2846.3384,-10131.2081 2853.3373,-10131.3342"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge629" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-15544.0235C1255.2166,-15235.5093 1559.4035,-15660.5325 1932.5662,-15405.0235 1960.1359,-15386.1462 1946.4535,-15364.073 1968.5662,-15339.0235 2031.0117,-15268.2846 2069.0188,-15276.1551 2140.8962,-15215.0235 2356.1868,-15031.9193 2448.5553,-14981.4406 2527.3586,-14710.0235 2605.8811,-14439.5738 2485.4083,-9911.6387 2563.3586,-9641.0235 2577.047,-9593.5025 2611.9394,-9546.2567 2632.8172,-9520.9399"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2635.5479,-9523.1308 2639.3093,-9513.2262 2630.1922,-9518.6233 2635.5479,-9523.1308"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-16037.0235C874.6727,-16056.8765 841.6048,-15624.3174 924.5292,-15544.0235"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge641" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M760.9651,-16037.0235C1020.4308,-16079.4649 1081.665,-16109.1767 1336.1997,-16175.0235 1439.1303,-16201.6511 1461.3516,-16224.6699 1566.6973,-16239.0235 1638.0468,-16248.7451 1656.7527,-16241.552 1728.717,-16239.0235 2001.3731,-16229.4436 2180.5507,-16346.7949 2330.7283,-16119.0235 2383.129,-16039.5484 2312.2853,-15341.1138 2366.7283,-15263.0235 2410.9669,-15199.5698 2484.0787,-15260.1349 2527.3586,-15196.0235 2574.0971,-15126.7891 2554.8514,-12272.123 2563.3586,-12189.0235 2580.1443,-12025.0587 2627.5832,-11831.3619 2643.7976,-11768.1267"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2647.254,-11768.7397 2646.3671,-11758.1821 2640.4766,-11766.9885 2647.254,-11768.7397"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge745" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-15391.0235C1210.612,-14985.5775 1654.3845,-15321.9308 1932.5662,-14911.0235 2006.3659,-14802.0126 1882.7077,-14716.8138 1968.5662,-14617.0235 1994.4936,-14586.8889 2036.9027,-14628.5548 2054.7312,-14593.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2054.7312,-14593.0235C2075.7628,-14550.7916 2116.436,-14571.3665 2140.8962,-14531.0235 2199.0966,-14435.0318 2104.0917,-14366.4705 2176.8962,-14281.0235 2200.1211,-14253.7657 2239.9689,-14290.05 2253.8123,-14257.0235"/>
</g>
<!-- sourcefile~solarreflectionmanager.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge977" class="edge">
<title>sourcefile~solarreflectionmanager.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1253.3867,-18139.12C1261.4531,-18201.0341 1303.9477,-18503.0897 1372.1997,-18561.0235 1379.0005,-18566.7962 2640.3905,-18699.0235 2649.3109,-18699.0235 2649.3109,-18699.0235 2649.3109,-18699.0235 3036.0425,-18699.0235 3205.117,-18699.0235 3248.2034,-18682.4145 3416.4602,-18699.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-12967.0289 -.2403,-12967.0289 -.2403,-12945.0181 130.719,-12945.0181 130.719,-12967.0289"/>
<text text-anchor="middle" x="65.2394" y="-12952.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge978" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-77.0235C2779.1976,-121.7636 2832.15,-250.1119 3106.9189,-442.0235 3161.4857,-480.1355 3160.3247,-521.3774 3225.8566,-533.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3225.8566,-533.0235C3339.2525,-544.649 3580.4845,-604.308 3587.3328,-609.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3587.3328,-609.0235C3656.4641,-651.673 3754.1423,-866.6403 3773.6733,-913.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3773.6733,-913.0235C4130.079,-1759.433 3577.5931,-16604.3472 3951.8339,-17443.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M65.2554,-12944.9114C65.8278,-12560.7 82.3802,-2341.3691 223.8406,-2309.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-39.0235C2338.1848,-62.3039 2360.2229,-65.9381 2447.0435,-77.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3951.8339,-17443.0235C3978.9085,-17503.6979 4041.8621,-17553.4554 4077.7444,-17578.1627"/>
<polygon fill="#ff0000" stroke="#ff0000" points="4075.9976,-17581.2062 4086.2454,-17583.8959 4079.9116,-17575.4027 4075.9976,-17581.2062"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2309.0235C313.6143,-2288.4963 298.4255,-744.1795 317.2024,-654.0235 388.7486,-310.4993 410.0694,-1.0235 760.9651,-1.0235 760.9651,-1.0235 760.9651,-1.0235 1848.6416,-1.0235 2029.5077,-1.0235 2079.4614,9.084 2253.8123,-39.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge813" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.6837,-18621.0235C1186.8763,-18570.4486 1245.4366,-18613.1323 1336.1997,-18530.0235 1364.9554,-18503.6928 1343.4651,-18476.3773 1372.1997,-18450.0235 1566.6492,-18271.6853 1689.5848,-18356.8592 1932.5662,-18254.0235 2661.1003,-17945.69 2808.5959,-17794.4372 3524.1262,-17457.0235 3579.7062,-17430.8144 3602.4561,-17439.2865 3650.5393,-17401.0235 3671.4055,-17384.4189 3664.581,-17368.1543 3686.5393,-17353.0235 3692.2858,-17349.0637 3698.656,-17345.7257 3705.2613,-17342.9127"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3706.9771,-17346.0034 3715.0618,-17339.1559 3704.4715,-17339.4672 3706.9771,-17346.0034"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge818" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff4200" stroke-dasharray="5,2" d="M223.8406,-14821.0235C350.3825,-14846.6176 255.1446,-12612.2345 317.2024,-12499.0235 327.1777,-12480.8258 345.7511,-12467.1765 362.6895,-12457.8041"/>
<polygon fill="#ff4200" stroke="#ff4200" points="364.6068,-12460.7522 371.8665,-12453.0355 361.3791,-12454.5407 364.6068,-12460.7522"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge819" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#ff8500" stroke-dasharray="5,2" d="M223.8406,-14821.0235C283.1486,-14833.019 386.5519,-12772.9646 398.0384,-12540.3212"/>
<polygon fill="#ff8500" stroke="#ff8500" points="401.5445,-12540.2801 398.5409,-12530.12 394.553,-12539.9357 401.5445,-12540.2801"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge821" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ffc700" stroke-dasharray="5,2" d="M223.8406,-2309.0235C382.5406,-2269.5863 217.8358,-5121.1495 317.2024,-5251.0235 319.672,-5254.2513 322.5482,-5257.0748 325.716,-5259.5435"/>
<polygon fill="#ffc700" stroke="#ffc700" points="323.8266,-5262.4898 334.1252,-5264.9776 327.6258,-5256.6105 323.8266,-5262.4898"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge827" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#f3ff00" stroke-dasharray="5,2" d="M760.9651,-1948.0235C791.3143,-1957.9831 805.2822,-1943.7165 831.457,-1962.0235 1067.7156,-2127.2656 1028.1835,-2267.9627 1131.7661,-2537.0235 1183.6206,-2671.7181 1230.6053,-2839.175 1246.3756,-2897.1372"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="1243.038,-2898.203 1249.0287,-2906.9415 1249.795,-2896.3744 1243.038,-2898.203"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadaylightingdevices.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge835" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadaylightingdevices.f90</title>
<path fill="none" stroke="#b1ff00" stroke-dasharray="5,2" d="M65.4172,-12944.6789C67.8432,-12793.3266 95.3864,-11177.3238 166.4788,-11110.0235 306.4322,-10977.5351 311.289,-11185.8637 690.4731,-11371.0235 698.2726,-11374.8321 706.805,-11378.3562 715.1559,-11381.4847"/>
<polygon fill="#b1ff00" stroke="#b1ff00" points="714.2265,-11384.8701 724.8209,-11384.969 716.6006,-11378.285 714.2265,-11384.8701"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge839" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M399.0839,-12385.0235C478.3194,-12299.2055 549.2777,-12373.787 654.4731,-12323.0235 672.7285,-12314.2141 672.6325,-12304.6451 690.4731,-12295.0235 719.6027,-12279.3136 738.6419,-12295.4572 760.9651,-12271.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge841" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#2cff00" stroke-dasharray="5,2" d="M760.9651,-2119.0235C864.2958,-2193.658 804.0333,-2272.5427 831.457,-2397.0235 850.1361,-2481.8107 819.561,-2516.6098 867.457,-2589.0235 901.0796,-2639.8573 950.8847,-2612.3828 981.6013,-2665.0235 1036.8512,-2759.7084 996.5387,-3049.4403 1017.6013,-3157.0235 1049.2007,-3318.4264 1103.8721,-3346.9392 1131.7661,-3509.0235 1181.61,-3798.6525 1084.8622,-4549.0726 1167.7661,-4831.0235 1181.5789,-4878.0001 1215.3649,-4925.1618 1235.6975,-4950.6705"/>
<polygon fill="#2cff00" stroke="#2cff00" points="1233.2479,-4953.2056 1242.2736,-4958.7544 1238.6782,-4948.7883 1233.2479,-4953.2056"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadaylighting.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge843" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadaylighting.f90</title>
<path fill="none" stroke="#00ff16" stroke-dasharray="5,2" d="M924.5292,-18697.0235C1111.1642,-18673.7739 1174.6593,-18695.3451 1336.1997,-18599.0235 1382.7809,-18571.2486 1420.9928,-18518.4678 1439.4639,-18489.7811"/>
<polygon fill="#00ff16" stroke="#00ff16" points="1442.5954,-18491.376 1444.9548,-18481.0472 1436.6692,-18487.6503 1442.5954,-18491.376"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge854" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff58" stroke-dasharray="5,2" d="M223.8406,-14821.0235C322.5544,-14840.8707 299.3806,-16531.924 317.2024,-16631.0235 369.6437,-16922.6275 278.1266,-17091.6981 516.9653,-17267.0235 566.231,-17303.1882 607.8709,-17306.5611 654.4731,-17267.0235 729.3553,-17203.493 655.1619,-17140.6563 690.4731,-17049.0235 732.0977,-16941.0078 786.8075,-16936.8243 831.457,-16830.0235 859.7385,-16762.3747 838.6147,-16736.4351 867.457,-16669.0235 903.4009,-16585.0137 952.8682,-16584.7646 981.6013,-16498.0235 1030.7895,-16349.5314 996.1773,-15949.9764 1017.6013,-15795.0235 1029.5378,-15708.6906 1056.4157,-15608.2272 1068.5425,-15565.2666"/>
<polygon fill="#00ff58" stroke="#00ff58" points="1071.979,-15565.9784 1071.3545,-15555.402 1065.2471,-15564.0594 1071.979,-15565.9784"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge864" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M223.8406,-18393.0235C433.09,-18569.4263 689.8742,-18527.2404 831.457,-18293.0235 878.085,-18215.888 814.837,-17962.2026 867.457,-17889.0235 869.7048,-17885.8975 872.4309,-17883.1574 875.4587,-17880.7565"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="877.5848,-17883.5488 884.0572,-17875.1607 873.7667,-17877.6817 877.5848,-17883.5488"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge868" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#00ffdd" stroke-dasharray="5,2" d="M399.0839,-12157.0235C407.701,-12145.0771 824.3438,-11862.9221 831.457,-11850.0235 902.2814,-11721.595 783.0005,-11310.9279 867.457,-11191.0235 899.1486,-11146.0305 948.9511,-11187.3258 981.6013,-11143.0235 1079.0979,-11010.7328 936.8946,-10918.1768 1017.6013,-10775.0235 1018.9576,-10772.6178 1334.2783,-10539.0072 1336.1997,-10537.0235 1381.1436,-10490.623 1421.2787,-10425.1885 1440.1111,-10392.4106"/>
<polygon fill="#00ffdd" stroke="#00ffdd" points="1443.3645,-10393.7689 1445.2535,-10383.3438 1437.2756,-10390.3155 1443.3645,-10393.7689"/>
<path fill="none" stroke="#00ffdd" stroke-dasharray="5,2" d="M223.8406,-14821.0235C357.2116,-14848.6875 289.9063,-12504.4704 317.2024,-12371.0235 337.6099,-12271.2537 337.5932,-12238.1985 399.0839,-12157.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge873" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M65.3351,-12967.3693C67.6534,-13238.9822 112.3141,-18297.2062 223.8406,-18393.0235"/>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M223.8406,-18393.0235C311.2828,-18468.1489 254.7663,-18247.9343 317.2024,-18151.0235 445.4191,-17952.0107 506.8806,-17920.4873 690.4731,-17771.0235 951.9764,-17558.1321 1045.7348,-17522.4473 1372.1997,-17438.0235 1440.9426,-17420.2466 1521.812,-17411.6701 1578.0818,-17407.592"/>
<polygon fill="#00ddff" stroke="#00ddff" points="1578.5609,-17411.0672 1588.2939,-17406.8817 1578.0751,-17404.0841 1578.5609,-17411.0672"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge884" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#009bff" stroke-dasharray="5,2" d="M223.8406,-14821.0235C303.9442,-14837.6891 301.0622,-11957.2346 317.2024,-11877.0235 337.2912,-11777.189 346.8184,-11750.4238 399.0839,-11663.0235"/>
<path fill="none" stroke="#009bff" stroke-dasharray="5,2" d="M399.0839,-11663.0235C496.6478,-11499.8733 612.7264,-11554.0277 760.9651,-11435.0235"/>
<path fill="none" stroke="#009bff" stroke-dasharray="5,2" d="M65.5972,-12967.3219C70.5479,-13121.4407 126.7081,-14800.8151 223.8406,-14821.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge893" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0058ff" stroke-dasharray="5,2" d="M399.0839,-2841.0235C409.8091,-2876.3512 456.3842,-2827.4764 480.9653,-2855.0235 528.829,-2908.6623 501.6951,-3430.7749 516.9653,-3501.0235 552.6418,-3665.1486 622.4562,-3688.1455 654.4731,-3853.0235 688.576,-4028.6431 686.9129,-6894.1589 690.4731,-7073.0235 710.6656,-8087.4884 753.9893,-9336.5859 760.2141,-9513.7496"/>
<polygon fill="#0058ff" stroke="#0058ff" points="756.7201,-9513.9844 760.5698,-9523.855 763.7158,-9513.738 756.7201,-9513.9844"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge903" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M399.0839,-16531.0235C434.5224,-16544.5235 456.2866,-16535.8176 480.9653,-16507.0235 532.8273,-16446.5132 576.002,-15856.2721 584.2855,-15736.2549"/>
<polygon fill="#0016ff" stroke="#0016ff" points="587.7865,-15736.3574 584.9773,-15726.1418 580.8029,-15735.8796 587.7865,-15736.3574"/>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M223.8406,-14821.0235C407.7372,-14858.218 200.6197,-16360.0205 317.2024,-16507.0235 340.7667,-16536.7365 363.6453,-16517.5236 399.0839,-16531.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge908" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M760.9651,-18697.0235C778.4027,-18690.6032 1153.7985,-18244.8324 1236.1195,-18146.9061"/>
<polygon fill="#2c00ff" stroke="#2c00ff" points="1238.7997,-18149.1569 1242.5544,-18139.2497 1233.441,-18144.6531 1238.7997,-18149.1569"/>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M223.8406,-18393.0235C323.7403,-18478.0425 212.8907,-18593.4794 317.2024,-18673.0235 474.2632,-18792.7921 564.5655,-18717.9949 760.9651,-18697.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge922" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M1848.6416,-18889.0235C2174.0603,-18857.5771 3010.8578,-18843.6346 3308.7942,-18709.0235 3677.2203,-18542.5644 3701.4724,-18357.5861 3860.8074,-17986.0235 3918.2248,-17852.1284 3942.565,-17676.2089 3949.564,-17616.1601"/>
<polygon fill="#b100ff" stroke="#b100ff" points="3953.063,-17616.3651 3950.7053,-17606.036 3946.107,-17615.5809 3953.063,-17616.3651"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-11141.0289 180.0456,-11141.0289 180.0456,-11119.0181 267.6355,-11119.0181 267.6355,-11141.0289"/>
<text text-anchor="middle" x="223.8406" y="-11126.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge930" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#f300ff" stroke-dasharray="5,2" d="M66.2111,-12944.8363C78.5837,-12802.3883 205.2324,-11344.2618 222.009,-11151.1109"/>
<polygon fill="#f300ff" stroke="#f300ff" points="225.5005,-11151.3597 222.879,-11141.0943 218.5267,-11150.7539 225.5005,-11151.3597"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge942" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M760.9651,-18697.0235C832.3362,-18683.2124 852.6031,-18707.5696 924.5292,-18697.0235"/>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1074.6837,-18621.0235C1105.5141,-18606.8104 1310.7916,-18485.5391 1336.1997,-18463.0235 1355.6295,-18445.8056 1351.7593,-18433.0286 1372.1997,-18417.0235 1440.5722,-18363.4869 1650.476,-18294.6971 1728.717,-18257.0235 1820.5391,-18212.8106 1868.2941,-18231.1131 1932.5662,-18152.0235 1987.3607,-18084.5964 2037.5246,-17810.8443 2051.1224,-17731.6072"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="2054.6363,-17731.8204 2052.8596,-17721.3756 2047.735,-17730.6487 2054.6363,-17731.8204"/>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M924.5292,-18697.0235C998.5346,-18686.1725 1006.4951,-18651.762 1074.6837,-18621.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge954" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M399.0839,-5237.0235C405.7811,-5273.777 457.3177,-5227.1019 480.9653,-5256.0235 571.3074,-5366.5137 433.4544,-6424.2837 516.9653,-6540.0235 519.8335,-6543.9986 523.3995,-6547.3433 527.3877,-6550.1574"/>
<polygon fill="#ff0042" stroke="#ff0042" points="525.6763,-6553.211 536.0788,-6555.2204 529.1999,-6547.1624 525.6763,-6553.211"/>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M223.8406,-2309.0235C378.7146,-2270.5371 241.0313,-5039.7912 317.2024,-5180.0235 338.3669,-5218.9876 391.1348,-5193.4007 399.0839,-5237.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge454" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-39.0235C2309.1011,-52.4206 3091.6019,-522.4694 3142.9189,-547.0235 3295.7995,-620.1735 3400.5013,-563.9537 3488.1262,-709.0235 3546.8659,-806.2715 3585.0235,-8652.0587 3587.2315,-9116.5511"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3583.7319,-9116.6713 3587.2794,-9126.6545 3590.7319,-9116.638 3583.7319,-9116.6713"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge463" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M399.0839,-1549.0235C469.2691,-1470.2749 425.7132,-1395.9419 516.9653,-1343.0235 632.3677,-1276.1001 1132.8423,-1323.4607 1336.1997,-1533.0235 1382.7419,-1580.9859 1353.9801,-1614.7225 1372.1997,-1679.0235 1435.0594,-1900.8693 1481.6905,-1947.7121 1530.6973,-2173.0235 1559.6141,-2305.9702 1505.373,-2355.5725 1566.6973,-2477.0235 1611.2011,-2565.1622 1684.9177,-2540.5326 1728.717,-2629.0235 1763.5971,-2699.4941 1755.2061,-2902.9706 1764.717,-2981.0235 1792.0482,-3205.3201 1833.4532,-3476.1274 1845.3434,-3552.8553"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1841.8851,-3553.3945 1846.8784,-3562.7389 1848.8022,-3552.3202 1841.8851,-3553.3945"/>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M223.8406,-2309.0235C384.2458,-2270.9311 210.2473,-1698.4885 317.2024,-1573.0235 341.8044,-1544.1638 373.6045,-1577.1116 399.0839,-1549.0235"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-3853.0289 358.7923,-3853.0289 358.7923,-3831.0181 439.3754,-3831.0181 439.3754,-3853.0289"/>
<text text-anchor="middle" x="399.0839" y="-3838.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge472" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M223.8406,-2309.0235C387.1924,-2268.4304 209.9691,-3691.2829 317.2024,-3821.0235 325.0911,-3830.5679 336.6744,-3836.1021 348.6601,-3839.2327"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="348.247,-3842.7216 358.7503,-3841.3323 349.6731,-3835.8684 348.247,-3842.7216"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge502" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M760.9651,-18279.0235C990.3324,-18151.9707 1122.2258,-18299.5721 1336.1997,-18148.0235 1402.9657,-18100.736 1694.7004,-17599.4324 1728.717,-17525.0235 1730.9398,-17520.1614 2172.9493,-16055.6294 2176.8962,-16052.0235 2177.2613,-16051.69 2177.6314,-16051.3628 2178.0064,-16051.0417"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2180.2822,-16053.7235 2186.522,-16045.1611 2176.3045,-16047.9635 2180.2822,-16053.7235"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-18393.0235C481.9262,-18397.2294 503.7934,-18406.0121 585.7192,-18393.0235"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M585.7192,-18393.0235C621.316,-18387.38 628.9318,-18375.4523 654.4731,-18350.0235 675.7069,-18328.8833 665.7736,-18309.9855 690.4731,-18293.0235 716.8038,-18274.9413 731.1186,-18290.4013 760.9651,-18279.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge519" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M760.9651,-18279.0235C1002.2706,-18187.0354 1112.8939,-18326.7334 1336.1997,-18197.0235 1358.6484,-18183.9839 1354.3678,-18169.8914 1372.1997,-18151.0235 1517.0286,-17997.78 1628.6037,-18023.5937 1728.717,-17838.0235 1783.4794,-17736.5159 1729.047,-17690.7065 1764.717,-17581.0235 1930.1292,-17072.3925 2193.6607,-17036.014 2330.7283,-16519.0235 2366.5071,-16384.0731 2355.0206,-15402.1446 2366.7283,-15263.0235 2384.9564,-15046.4203 2429.7538,-14786.5905 2443.1796,-14711.3737"/>
<polygon fill="#65ff00" stroke="#65ff00" points="2446.6695,-14711.7414 2444.9914,-14701.2803 2439.7796,-14710.5046 2446.6695,-14711.7414"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge549" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-16531.0235C524.1635,-16563.6873 725.1203,-16302.3153 831.457,-16051.0235 874.5186,-15949.2616 835.9553,-15910.9358 867.457,-15805.0235 901.9337,-15689.1092 942.7456,-15672.5443 981.6013,-15558.0235 1005.0205,-15488.9994 983.0938,-15462.2265 1017.6013,-15398.0235 1295.5815,-14880.8278 1615.8206,-14939.4288 1932.5662,-14445.0235 2069.1003,-14231.9086 2076.2671,-14159.7328 2140.8962,-13915.0235 2169.7858,-13805.6371 2156.7405,-13774.3507 2176.8962,-13663.0235 2233.6442,-13349.5842 2289.6486,-13278.8985 2330.7283,-12963.0235 2379.4918,-12588.0646 2307.5534,-12486.4808 2366.7283,-12113.0235 2382.9694,-12010.5246 2422.8277,-11892.469 2439.5093,-11845.6698"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2442.8704,-11846.666 2442.9635,-11836.0716 2436.284,-11844.2956 2442.8704,-11846.666"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~dataheatbalfansys.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/dataheatbalfansys.f90.html" xlink:title="DataHeatBalFanSys.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1910.7864,-9779.0289 1786.4968,-9779.0289 1786.4968,-9757.0181 1910.7864,-9757.0181 1910.7864,-9779.0289"/>
<text text-anchor="middle" x="1848.6416" y="-9764.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalFanSys.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge554" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M399.0839,-1815.0235C438.381,-1773.1249 460.7989,-1774.0691 516.9653,-1762.0235 606.1332,-1742.9003 1274.1872,-1745.1576 1336.1997,-1812.0235 1371.0184,-1849.5672 1367.3805,-3604.0466 1372.1997,-3655.0235 1420.5754,-4166.7298 1225.5155,-4410.6038 1566.6973,-4795.0235 1616.5498,-4851.1938 1683.5549,-4783.0172 1728.717,-4843.0235 1768.3733,-4895.7142 1749.9932,-9526.7419 1764.717,-9591.0235 1778.6171,-9651.7086 1815.5525,-9716.1124 1835.4709,-9747.8852"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1832.7357,-9750.1059 1841.0618,-9756.6578 1838.6389,-9746.3437 1832.7357,-9750.1059"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M223.8406,-2309.0235C431.0482,-2259.8166 173.4604,-1996.1685 317.2024,-1839.0235 342.798,-1811.0413 371.3251,-1840.8612 399.0839,-1815.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge601" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M399.0839,-18393.0235C451.776,-18395.6987 464.2975,-18403.907 516.9653,-18407.0235 723.3844,-18419.2381 775.7144,-18402.2226 981.6013,-18383.0235 1048.4774,-18376.7873 1066.174,-18380.4793 1131.7661,-18366.0235 1225.276,-18345.4149 1253.6568,-18346.5567 1336.1997,-18298.0235 1354.9102,-18287.0222 1355.0704,-18278.3539 1372.1997,-18265.0235 1523.9277,-18146.9452 1631.466,-18185.8732 1728.717,-18020.0235 1803.3457,-17892.7534 1673.0154,-17805.6 1764.717,-17690.0235 1813.8656,-17628.079 1861.1347,-17664.9389 1932.5662,-17631.0235 1949.505,-17622.981 1951.6154,-17617.0408 1968.5662,-17609.0235 2041.8799,-17574.3478 2087.6289,-17610.1783 2140.8962,-17549.0235 2194.4813,-17487.504 2125.1558,-17432.1022 2176.8962,-17369.0235 2223.8589,-17311.7695 2266.4244,-17341.7458 2330.7283,-17305.0235 2348.0958,-17295.1054 2349.3916,-17287.9954 2366.7283,-17278.0235 2433.9294,-17239.3699 2458.6694,-17245.9664 2527.3586,-17210.0235 2714.5501,-17112.0722 2759.9619,-17082.5346 2929.166,-16956.0235 3123.1507,-16810.9844 3211.7764,-16786.9558 3308.7942,-16565.0235 3364.8825,-16436.7192 3307.581,-16387.0164 3344.7942,-16252.0235 3359.2531,-16199.5731 3388.7221,-16142.4185 3405.0065,-16113.0043"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="3408.1398,-16114.5727 3409.9828,-16104.1394 3402.0358,-16111.1461 3408.1398,-16114.5727"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge695" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M399.0839,-11663.0235C432.9453,-11617.1675 602.4362,-11662.2942 654.4731,-11639.0235 752.3688,-11595.2451 786.9647,-11572.5968 831.457,-11475.0235 883.0225,-11361.9387 837.9511,-10477.7569 867.457,-10357.0235 895.3077,-10243.0635 950.2994,-10232.0843 981.6013,-10119.0235 1027.5748,-9952.9701 996.5175,-9904.0287 1017.6013,-9733.0235 1071.4133,-9296.5678 900.8681,-9104.53 1167.7661,-8755.0235 1268.6939,-8622.8573 1380.021,-8593.6602 1530.6973,-8664.0235 1553.2808,-8674.5696 1546.2114,-8692.8262 1566.6973,-8707.0235 1629.4383,-8750.5047 1679.4035,-8705.755 1728.717,-8764.0235 1789.0424,-8835.3036 1698.4586,-8905.2221 1764.717,-8971.0235 1829.89,-9035.7469 1877.0284,-8997.4421 1968.5662,-9005.0235 2233.2659,-9026.9467 2298.3704,-8965.1288 2563.3586,-8947.0235 2639.583,-8941.8155 2658.8865,-8945.0554 2735.2632,-8947.0235 2821.5281,-8949.2465 2868.4685,-8895.6852 2929.166,-8957.0235 2963.4653,-8991.6849 2958.4569,-9785.724 2965.166,-9834.0235 2979.735,-9938.906 3014.9242,-10060.96 3029.5246,-10109.0371"/>
<polygon fill="#00cbff" stroke="#00cbff" points="3026.2653,-10110.3471 3032.5423,-10118.8823 3032.958,-10108.2956 3026.2653,-10110.3471"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge707" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M760.9651,-14859.0235C859.0962,-14831.7202 899.2015,-14856.9022 981.6013,-14797.0235 1211.4712,-14629.9805 1243.7316,-14533.7113 1336.1997,-14265.0235 1362.0174,-14190.0042 1439.2219,-12932.2667 1450.1553,-12752.375"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1453.6538,-12752.5042 1450.7662,-12742.3105 1446.6667,-12752.08 1453.6538,-12752.5042"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge729" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-18393.0235C320.861,-18476.2202 294.0314,-18237.8153 399.0839,-18165.0235"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-18165.0235C631.8556,-18003.734 631.999,-17890.3657 867.457,-17733.0235 1205.5836,-17507.0742 1428.0412,-17697.8423 1728.717,-17424.0235 1751.8055,-17402.9974 2163.0316,-16421.0047 2176.8962,-16393.0235 2239.0744,-16267.5381 2293.7194,-16253.0903 2330.7283,-16118.0235 2373.2584,-15962.8062 2357.9098,-14830.7203 2366.7283,-14670.0235 2387.077,-14299.2128 2433.9123,-13848.2662 2444.7678,-13746.2204"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2448.2522,-13746.5527 2445.8337,-13736.2376 2441.2917,-13745.8095 2448.2522,-13746.5527"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge738" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M399.0839,-4399.0235C573.1428,-4529.47 440.6173,-4670.3478 516.9653,-4874.0235 624.4443,-5160.7482 693.6095,-5213.5993 831.457,-5487.0235 1058.9782,-5938.3177 1168.1279,-6029.3851 1336.1997,-6506.0235 1402.3124,-6693.514 1438.6653,-6932.8508 1448.6141,-7004.7074"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1445.1668,-7005.3323 1449.9847,-7014.7683 1452.1028,-7004.3874 1445.1668,-7005.3323"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1120.6437,-14261.0289 1028.7237,-14261.0289 1028.7237,-14239.0181 1120.6437,-14239.0181 1120.6437,-14261.0289"/>
<text text-anchor="middle" x="1074.6837" y="-14246.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge740" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M223.8406,-14821.0235C248.8737,-14826.0866 914.0234,-14362.3335 1050.3928,-14267.017"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="1052.4079,-14269.8788 1058.5981,-14261.2804 1048.397,-14264.1418 1052.4079,-14269.8788"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge783" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M399.0839,-18165.0235C503.0415,-18082.7973 541.1701,-18079.804 654.4731,-18011.0235 670.502,-18001.2932 674.2144,-17998.3647 690.4731,-17989.0235 752.1955,-17953.5622 787.9099,-17969.3333 831.457,-17913.0235 872.6061,-17859.8145 821.4334,-17815.0773 867.457,-17766.0235 904.8044,-17726.2172 1284.5217,-17636.5949 1336.1997,-17619.0235 1512.1293,-17559.2043 1574.6368,-17578.8928 1728.717,-17475.0235 1840.6057,-17399.5966 1846.5328,-17353.9781 1932.5662,-17250.0235 2030.5545,-17131.6237 2050.1731,-17098.0781 2140.8962,-16974.0235 2320.0544,-16729.0431 2396.1944,-16684.7185 2527.3586,-16411.0235 2550.3211,-16363.1086 2538.5553,-16344.0118 2563.3586,-16297.0235 2621.1216,-16187.5955 2679.2425,-16188.3536 2735.2632,-16078.0235 2762.0182,-16025.3308 2746.2584,-16003.5689 2771.2632,-15950.0235 2823.8828,-15837.3438 2891.5972,-15837.5736 2929.166,-15719.0235 2971.7994,-15584.4919 2960.5301,-13320.0726 2965.166,-13179.0235 2983.2742,-12628.0715 3026.335,-11953.8295 3034.6421,-11826.3525"/>
<polygon fill="#ff0066" stroke="#ff0066" points="3038.1379,-11826.5299 3035.2976,-11816.3229 3031.1528,-11826.0733 3038.1379,-11826.5299"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2309.0235C284.3921,-2294.644 380.0343,-2781.7751 399.0839,-2841.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2841.0235C410.3846,-2876.1713 453.139,-2830.7589 480.9653,-2855.0235 521.0114,-2889.9438 495.1236,-2920.5875 516.9653,-2969.0235 628.4629,-3216.2795 705.4732,-3251.8251 831.457,-3492.0235 906.6774,-3635.4374 937.5975,-3668.1732 981.6013,-3824.0235 1016.2931,-3946.893 990.438,-3984.2734 1017.6013,-4109.0235 1053.764,-4275.1043 1100.9689,-4306.8646 1131.7661,-4474.0235 1143.6059,-4538.2867 1125.4166,-5011.2595 1167.7661,-5061.0235 1217.5013,-5119.4664 1285.6171,-5041.3125 1336.1997,-5099.0235 1394.5887,-5165.641 1335.8064,-5415.2604 1372.1997,-5496.0235 1384.4855,-5523.2878 1409.3575,-5547.2971 1427.9786,-5562.5889"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1426.0195,-5565.5025 1436.0267,-5568.9818 1430.3734,-5560.0213 1426.0195,-5565.5025"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643.4123,-6159.0289 528.0262,-6159.0289 528.0262,-6137.0181 643.4123,-6137.0181 643.4123,-6159.0289"/>
<text text-anchor="middle" x="585.7192" y="-6144.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M223.8406,-2309.0235C367.5952,-2273.3003 288.8519,-2823.6351 317.2024,-2969.0235 374.7167,-3263.9713 442.1516,-3327.0376 480.9653,-3625.0235 489.9287,-3693.8383 476.744,-6066.4721 516.9653,-6123.0235 519.1945,-6126.1577 521.8582,-6128.9002 524.8226,-6131.2998"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="523.0061,-6134.2945 533.2795,-6136.8845 526.8636,-6128.4533 523.0061,-6134.2945"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1251.9829,-411.0235C1450.871,-383.1636 2004.3849,-426.7235 2140.8962,-574.0235 2349.4387,-799.0472 2307.1103,-1635.0728 2366.7283,-1936.0235 2391.4711,-2060.9248 2428.198,-2209.3683 2441.7618,-2263.2161"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="2438.3806,-2264.122 2444.2239,-2272.9598 2445.1673,-2262.407 2438.3806,-2264.122"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M223.8406,-2309.0235C362.1778,-2275.8412 267.0786,-4734.885 317.2024,-4868.0235 357.802,-4975.8639 439.6091,-4961.471 480.9653,-5069.0235 537.8242,-5216.8928 442.8621,-5640.9986 516.9653,-5781.0235 598.9564,-5935.9532 726.5419,-5878.6008 831.457,-6019.0235 990.0814,-6231.3329 1083.4886,-6930.4591 1251.9829,-7135.0235"/>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M1251.9829,-7135.0235C1291.7249,-7174.1387 1310.8619,-7178.3503 1336.1997,-7228.0235 1371.4903,-7297.2086 1341.7106,-7327.5923 1372.1997,-7399.0235 1388.0907,-7436.2536 1416.6863,-7473.9663 1434.834,-7495.8876"/>
<polygon fill="#5cff00" stroke="#5cff00" points="1432.3343,-7498.3527 1441.4546,-7503.7444 1437.6872,-7493.842 1432.3343,-7498.3527"/>
</g>
<!-- sourcefile~datawater.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node46" class="node">
<title>sourcefile~datawater.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node46"><a xlink:href="../sourcefile/datawater.f90.html" xlink:title="DataWater.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1113.9217,-3763.0289 1035.4457,-3763.0289 1035.4457,-3741.0181 1113.9217,-3741.0181 1113.9217,-3763.0289"/>
<text text-anchor="middle" x="1074.6837" y="-3748.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataWater.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M399.0839,-2309.0235C515.2986,-2320.7344 557.4822,-2305.9408 654.4731,-2371.0235 788.4558,-2460.9282 763.5129,-2541.6144 867.457,-2665.0235 914.2571,-2720.5876 952.6964,-2715.3743 981.6013,-2782.0235 1051.7889,-2943.8629 986.2512,-3401.4279 1017.6013,-3575.0235 1028.1121,-3633.2252 1052.8066,-3698.7579 1066.0057,-3731.3321"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="1062.8165,-3732.7797 1069.8546,-3740.699 1069.2912,-3730.1191 1062.8165,-3732.7797"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M223.8406,-2309.0235C299.5878,-2290.897 322.0238,-2297.7117 399.0839,-2309.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge418" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M399.0839,-1929.0235C464.1126,-1877.5278 503.9841,-1914.8846 585.7192,-1929.0235"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M760.9651,-1948.0235C919.9727,-1967.5758 1104.9495,-2007.8004 1195.7842,-2028.7226"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="1195.0649,-2032.1486 1205.5964,-2030.9921 1196.6424,-2025.3286 1195.0649,-2032.1486"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M585.7192,-1929.0235C662.9162,-1942.3774 684.8761,-1929.3643 760.9651,-1948.0235"/>
</g>
<!-- sourcefile~datacostestimate.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node49" class="node">
<title>sourcefile~datacostestimate.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node49"><a xlink:href="../sourcefile/datacostestimate.f90.html" xlink:title="DataCostEstimate.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="456.2128,-685.0289 341.9549,-685.0289 341.9549,-663.0181 456.2128,-663.0181 456.2128,-685.0289"/>
<text text-anchor="middle" x="399.0839" y="-670.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataCostEstimate.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacostestimate.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge425" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacostestimate.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M223.8406,-2309.0235C397.741,-2265.809 206.4635,-839.8984 317.2024,-699.0235 321.4608,-693.6063 326.862,-689.3313 332.8526,-685.9624"/>
<polygon fill="#e700ff" stroke="#e700ff" points="334.4399,-689.0835 341.9868,-681.6474 331.4499,-682.7542 334.4399,-689.0835"/>
</g>
<!-- sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node50" class="node">
<title>sourcefile~dataairflownetwork.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node50"><a xlink:href="../sourcefile/dataairflownetwork.f90.html" xlink:title="DataAirflowNetwork.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2115.4381,-697.0289 1994.0243,-697.0289 1994.0243,-675.0181 2115.4381,-675.0181 2115.4381,-697.0289"/>
<text text-anchor="middle" x="2054.7312" y="-682.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirflowNetwork.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge427" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M585.7192,-601.0235C629.1655,-583.1707 643.7368,-610.3317 690.4731,-615.0235 1203.8006,-666.5554 1333.2263,-670.491 1848.6416,-693.0235"/>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M1848.6416,-693.0235C1893.5916,-692.4282 1944.0294,-690.7327 1983.7566,-689.1596"/>
<polygon fill="#ff008b" stroke="#ff008b" points="1984.0259,-692.6517 1993.8771,-688.7523 1983.7444,-685.6573 1984.0259,-692.6517"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node52" class="node">
<title>sourcefile~dataheatbalsurface.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node52"><a xlink:href="../sourcefile/dataheatbalsurface.f90.html" xlink:title="DataHeatBalSurface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1911.3757,-8483.0289 1785.9075,-8483.0289 1785.9075,-8461.0181 1911.3757,-8461.0181 1911.3757,-8483.0289"/>
<text text-anchor="middle" x="1848.6416" y="-8468.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalSurface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1549.0235C418.1919,-1530.3375 1318.9143,-1746.6397 1336.1997,-1767.0235 1376.3822,-1814.4088 1365.7068,-2263.2348 1372.1997,-2325.0235 1486.8272,-3415.8562 1631.5949,-3674.493 1728.717,-4767.0235 1797.9937,-5546.3191 1843.8541,-8187.3348 1848.2883,-8450.7993"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1844.7914,-8451.0193 1848.4586,-8460.9592 1851.7905,-8450.902 1844.7914,-8451.0193"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M585.7192,-15125.0235C866.3745,-15094.9446 1507.4751,-14746.3064 1728.717,-14571.0235 1841.3603,-14481.7799 1868.0461,-14448.4373 1932.5662,-14320.0235 2157.9893,-13871.3652 2110.9823,-13714.7837 2176.8962,-13217.0235 2204.5657,-13008.0725 2240.2761,-12755.3614 2250.7807,-12681.3461"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="2254.2537,-12681.7831 2252.1947,-12671.3903 2247.3232,-12680.7988 2254.2537,-12681.7831"/>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M399.0839,-15125.0235C473.5559,-15161.5539 502.9247,-15130.0834 585.7192,-15125.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M585.7192,-1929.0235C717.2565,-1956.3177 751.0947,-1997.3717 831.457,-2105.0235 860.7171,-2144.2197 849.5688,-2163.4987 867.457,-2209.0235 973.875,-2479.8534 1033.9431,-2533.9719 1131.7661,-2808.0235 1151.9206,-2864.4865 1124.8306,-2896.1808 1167.7661,-2938.0235 1173.3811,-2943.4956 1180.1926,-2947.6108 1187.4823,-2950.6947"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="1186.3229,-2953.9971 1196.9175,-2954.0738 1188.6831,-2947.407 1186.3229,-2953.9971"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M223.8406,-2309.0235C447.1882,-2255.9838 163.4415,-1971.4787 317.2024,-1801.0235 469.4285,-1632.2698 1179.381,-1549.5289 1336.1997,-1714.0235 1406.382,-1787.641 1344.6538,-1842.1138 1372.1997,-1940.0235 1422.3144,-2118.1521 1481.4995,-2146.6395 1530.6973,-2325.0235 1559.6078,-2429.849 1548.3995,-2459.8349 1566.6973,-2567.0235 1641.9536,-3007.8755 1830.3193,-4113.698 1968.5662,-4539.0235 2027.1444,-4719.2435 2098.707,-4744.2785 2140.8962,-4929.0235 2194.9512,-5165.7283 2095.4909,-5792.2785 2176.8962,-6021.0235 2188.5997,-6053.9096 2215.2605,-6084.7614 2233.8926,-6103.5094"/>
<polygon fill="#5cff00" stroke="#5cff00" points="2231.7231,-6106.2833 2241.3193,-6110.7739 2236.618,-6101.2792 2231.7231,-6106.2833"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node56" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node56"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1302.1359,-9621.0289 1201.83,-9621.0289 1201.83,-9599.0181 1302.1359,-9599.0181 1302.1359,-9621.0289"/>
<text text-anchor="middle" x="1251.9829" y="-9606.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M399.0839,-11891.0235C456.7152,-11812.7529 495.4876,-11813.1609 585.7192,-11777.0235"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M585.7192,-11777.0235C701.3994,-11730.6941 766.2543,-11748.2163 831.457,-11642.0235 895.1527,-11538.2852 823.8598,-10660.6812 867.457,-10547.0235 932.787,-10376.7087 1063.7761,-10402.2939 1131.7661,-10233.0235 1178.2451,-10117.3078 1108.3793,-9782.6758 1167.7661,-9673.0235 1178.9244,-9652.4207 1200.0562,-9636.6433 1218.3595,-9626.0304"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1220.2571,-9628.9812 1227.3325,-9621.0951 1216.8836,-9622.8477 1220.2571,-9628.9812"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M223.8406,-14821.0235C376.8176,-14852.8504 268.356,-12158.4451 317.2024,-12010.0235 337.2719,-11949.0415 361.0185,-11942.721 399.0839,-11891.0235"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node57" class="node">
<title>sourcefile~datazoneenergydemands.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node57"><a xlink:href="../sourcefile/datazoneenergydemands.f90.html" xlink:title="DataZoneEnergyDemands.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2330.6444,-3129.0289 2176.9801,-3129.0289 2176.9801,-3107.0181 2330.6444,-3107.0181 2330.6444,-3129.0289"/>
<text text-anchor="middle" x="2253.8123" y="-3114.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEnergyDemands.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M585.7192,-601.0235C743.093,-529.5735 2024.7214,-505.0587 2140.8962,-633.0235 2232.7701,-734.2212 2095.7556,-2983.0327 2176.8962,-3093.0235 2179.1989,-3096.1449 2181.9003,-3098.8838 2184.8875,-3101.2863"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="2183.1103,-3104.3069 2193.3849,-3106.8921 2186.965,-3098.4638 2183.1103,-3104.3069"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M399.0839,-12385.0235C442.1452,-12335.1175 462.9093,-12332.7441 516.9653,-12295.0235 550.9256,-12271.3258 810.6619,-12130.8347 831.457,-12095.0235 915.4704,-11950.345 791.9544,-11492.3201 867.457,-11343.0235 912.6299,-11253.7 1472.3678,-10808.5082 1566.6973,-10775.0235 1634.5574,-10750.9348 1666.5145,-10738.7452 1728.717,-10775.0235 1822.2279,-10829.5617 1745.4304,-11019.6755 1848.6416,-10987.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1848.6416,-10987.0235C1893.54,-10970.0296 1908.8615,-10960.7698 1932.5662,-10919.0235 1987.996,-10821.4058 1894.908,-10753.7357 1968.5662,-10669.0235 1978.1885,-10657.9572 1992.3873,-10651.6492 2006.495,-10648.0964"/>
<polygon fill="#002eff" stroke="#002eff" points="2007.6119,-10651.4387 2016.6848,-10645.9677 2006.1804,-10644.5866 2007.6119,-10651.4387"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M223.8406,-14821.0235C354.4962,-14847.8373 242.7032,-12532.6568 317.2024,-12422.0235 339.5081,-12388.899 372.5709,-12414.8873 399.0839,-12385.0235"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node60" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node60"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1324.5684,-4036.0289 1179.3974,-4036.0289 1179.3974,-4014.0181 1324.5684,-4014.0181 1324.5684,-4036.0289"/>
<text text-anchor="middle" x="1251.9829" y="-4021.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M760.9651,-2119.0235C854.7483,-2186.2346 942.1806,-2480.5863 981.6013,-2589.0235 1070.8144,-2834.4281 1092.598,-2898.8602 1131.7661,-3157.0235 1145.8291,-3249.7148 1110.1036,-3926.1014 1167.7661,-4000.0235 1170.2798,-4003.246 1173.19,-4006.0678 1176.3862,-4008.5375"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="1174.5517,-4011.5189 1184.857,-4013.9787 1178.3349,-4005.6293 1174.5517,-4011.5189"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M223.8406,-2309.0235C290.9308,-2292.9644 257.9105,-2220.2864 317.2024,-2185.0235 488.581,-2083.0989 596.0189,-2006.9877 760.9651,-2119.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M1451.4485,-5275.0235C1454.55,-5310.6558 1507.4178,-5261.8694 1530.6973,-5289.0235 1560.9694,-5324.3342 1564.8826,-6916.5482 1566.6973,-6963.0235 1589.1504,-7538.0667 1637.1498,-8242.004 1646.2139,-8372.6405"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1642.7408,-8373.1499 1646.9264,-8382.8828 1649.7239,-8372.664 1642.7408,-8373.1499"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M223.8406,-14821.0235C292.7782,-14835.366 254.4335,-14917.1147 317.2024,-14949.0235 382.0837,-14982.0062 409.06,-14960.2957 480.9653,-14949.0235 610.1031,-14928.7792 637.1456,-14900.9176 760.9651,-14859.0235"/>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M760.9651,-14859.0235C792.1768,-14848.0162 803.5988,-14852.891 831.457,-14835.0235 851.0398,-14822.4637 851.2251,-14813.6896 867.457,-14797.0235 1001.49,-14659.4062 1059.6502,-14633.0759 1131.7661,-14455.0235 1164.0308,-14375.3627 1120.5557,-14336.843 1167.7661,-14265.0235 1217.4193,-14189.4881 1292.8313,-14230.3344 1336.1997,-14151.0235 1374.5934,-14080.8101 1322.6071,-12773.8293 1372.1997,-12711.0235 1377.2233,-12704.6614 1383.934,-12700.0908 1391.3326,-12696.8293"/>
<polygon fill="#ff008b" stroke="#ff008b" points="1392.7661,-12700.0335 1400.9967,-12693.362 1390.4022,-12693.4447 1392.7661,-12700.0335"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-11777.0235C687.141,-11735.1223 756.1352,-11832.8277 831.457,-11753.0235 866.1468,-11716.2694 856.1798,-10893.2889 867.457,-10844.0235 904.771,-10681.015 907.1139,-10624.5489 1017.6013,-10499.0235 1044.8338,-10468.0846 1304.3526,-10335.1881 1336.1997,-10309.0235 1395.3483,-10260.4288 1396.7766,-10234.6051 1451.4485,-10181.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1451.4485,-10181.0235C1529.0539,-10105.6944 1577.2861,-10232.5902 1728.717,-10356.0235 1763.207,-10384.1367 1803.2201,-10416.8555 1827.2028,-10436.4774"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1825.0262,-10439.2187 1834.9819,-10442.8427 1829.4591,-10433.8012 1825.0262,-10439.2187"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1815.0235C492.6577,-1725.5222 853.6276,-1781.2936 981.6013,-1801.0235 1144.9451,-1826.2065 1237.3364,-1780.5795 1336.1997,-1913.0235 1370.2015,-1958.5746 1369.3029,-3902.2552 1372.1997,-3959.0235 1390.9458,-4326.3845 1438.0835,-4772.933 1449.1139,-4874.7002"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1445.6631,-4875.3432 1450.2246,-4884.9058 1452.622,-4874.5858 1445.6631,-4875.3432"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-6617.0235C2518.2445,-6637.567 2591.2697,-6687.7235 2626.9404,-6714.5011"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2625.1035,-6717.5014 2635.1806,-6720.773 2629.3431,-6711.9313 2625.1035,-6717.5014"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2309.0235C253.6919,-2302.0547 458.6765,-2387.9789 480.9653,-2409.0235 566.0533,-2489.3613 891.4105,-3225.5464 981.6013,-3556.0235 1014.1709,-3675.3648 985.7609,-3712.4856 1017.6013,-3832.0235 1051.8744,-3960.6945 1103.3377,-3978.9362 1131.7661,-4109.0235 1153.4645,-4208.3146 1102.7485,-4944.9066 1167.7661,-5023.0235 1216.8588,-5082.0071 1264.0216,-5034.9568 1336.1997,-5061.0235 1520.3513,-5127.5289 1590.0102,-5122.8382 1728.717,-5261.0235 1753.5012,-5285.7145 1738.1002,-5308.3201 1764.717,-5331.0235 1824.4434,-5381.9685 1880.1326,-5327.5996 1932.5662,-5386.0235 1984.1506,-5443.5013 1945.907,-5482.1912 1968.5662,-5556.0235 2028.1261,-5750.0926 2094.1583,-5781.4741 2140.8962,-5979.0235 2164.6051,-6079.2349 2124.3436,-6352.4647 2176.8962,-6441.0235 2250.0256,-6564.2571 2309.3614,-6577.2984 2447.0435,-6617.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge278" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M924.5292,-411.0235C947.1998,-403.9787 1055.6037,-273.1493 1074.6837,-259.0235"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1074.6837,-259.0235C1218.1323,-152.8217 1272.9651,-120.0235 1451.4485,-120.0235 1451.4485,-120.0235 1451.4485,-120.0235 1647.7072,-120.0235 1868.3614,-120.0235 1935.4585,-96.5025 2140.8962,-177.0235 2430.656,-290.5944 3016.8886,-893.1081 3106.9189,-1191.0235 3136.3026,-1288.2559 3138.6288,-2917.5389 3142.9189,-3019.0235 3164.5023,-3529.5887 3214.1817,-4153.504 3224.111,-4275.7034"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3220.6447,-4276.2597 3224.9456,-4285.9423 3227.6215,-4275.691 3220.6447,-4276.2597"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M223.8406,-2309.0235C394.4096,-2270.0074 206.2747,-872.342 317.2024,-737.0235 364.9087,-678.8275 414.6189,-729.5317 480.9653,-694.0235 535.8562,-664.6463 528.4391,-625.4163 585.7192,-601.0235"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M585.7192,-601.0235C659.3443,-569.1586 622.7881,-497.0905 690.4731,-454.0235 779.7069,-397.2454 823.5276,-442.4096 924.5292,-411.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge307" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-2309.0235C436.3667,-2314.4964 447.2294,-2314.235 480.9653,-2331.0235 499.1122,-2340.0542 500.6792,-2346.956 516.9653,-2359.0235 577.0569,-2403.5495 597.2229,-2407.899 654.4731,-2456.0235 733.0338,-2522.0615 939.7487,-2688.3158 981.6013,-2782.0235 1043.2208,-2919.9891 983.7662,-3313.7597 1017.6013,-3461.0235 1046.8673,-3588.4005 1104.0537,-3604.2995 1131.7661,-3732.0235 1146.5912,-3800.3512 1122.5656,-4936.6815 1167.7661,-4990.0235 1217.0816,-5048.2216 1262.111,-5004.8605 1336.1997,-5023.0235 1512.8788,-5066.3368 1574.8503,-5041.9846 1728.717,-5139.0235 1748.9474,-5151.7821 1747.7189,-5162.1975 1764.717,-5179.0235 1835.4012,-5248.9919 1861.3894,-5257.5564 1932.5662,-5327.0235 2030.0972,-5422.2118 2087.8204,-5426.5003 2140.8962,-5552.0235 2199.5699,-5690.7856 2111.6022,-6093.2508 2176.8962,-6229.0235 2225.8525,-6330.8234 2274.0863,-6333.3906 2366.7283,-6398.0235 2519.0481,-6504.2914 2629.5886,-6442.2914 2735.2632,-6595.0235 2805.1479,-6696.0282 2711.9395,-6761.4757 2771.2632,-6869.0235 2826.4987,-6969.1598 2947.0904,-7042.5125 3004.4779,-7073.176"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3002.9728,-7076.3389 3013.4524,-7077.8974 3006.232,-7070.1439 3002.9728,-7076.3389"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge314" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-4399.0235C648.1594,-4634.7434 794.1688,-4617.8449 981.6013,-4905.0235 1011.1052,-4950.2285 979.8221,-4982.4657 1017.6013,-5021.0235 1055.0275,-5059.221 1095.7247,-5019.5167 1131.7661,-5059.0235 1179.1388,-5110.9511 1127.7199,-5155.2572 1167.7661,-5213.0235 1228.4717,-5300.5907 1474.5408,-5425.5411 1566.6973,-5479.0235 1636.3274,-5519.4329 1685.9828,-5491.7956 1728.717,-5560.0235 1773.191,-5631.029 1747.8376,-8493.9577 1764.717,-8576.0235 1779.1232,-8646.0645 1817.741,-8722.3546 1837.1596,-8757.808"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1834.1755,-8759.6437 1842.0914,-8766.6856 1840.2947,-8756.2442 1834.1755,-8759.6437"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge362" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M924.5292,-411.0235C1063.8996,-369.115 1107.9741,-432.0446 1251.9829,-411.0235"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1251.9829,-411.0235C1645.0742,-361.5431 1782.7855,-308.5366 2140.8962,-478.0235 2237.5943,-523.7888 2277.4036,-533.2795 2330.7283,-626.0235 2389.9738,-729.0651 2335.3138,-776.3904 2366.7283,-891.0235 2415.1895,-1067.8615 2482.494,-1093.239 2527.3586,-1271.0235 2548.1133,-1353.2677 2519.7599,-1578.2635 2563.3586,-1651.0235 2610.4797,-1729.6618 2690.7525,-1684.8788 2735.2632,-1765.0235 2769.102,-1825.9528 2767.2094,-2949.4461 2771.2632,-3019.0235 2791.709,-3369.9476 2837.0529,-3796.3526 2847.8664,-3895.6549"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2844.4188,-3896.3263 2848.9847,-3905.8868 2851.3774,-3895.5657 2844.4188,-3896.3263"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge378" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1848.6416,-11177.0235C1929.7711,-11172.4788 1897.9631,-11079.246 1968.5662,-11039.0235 2080.536,-10975.2344 2168.7584,-11083.8333 2253.8123,-10987.0235"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M399.0839,-12385.0235C438.3847,-12340.7556 463.1381,-12347.6575 516.9653,-12323.0235 576.6683,-12295.7005 595.8509,-12298.5941 654.4731,-12269.0235 737.3733,-12227.2065 784.5591,-12238.1589 831.457,-12158.0235 915.0637,-12015.1633 772.5301,-11549.6258 867.457,-11414.0235 962.0502,-11278.8979 1402.4805,-11180.5045 1566.6973,-11165.0235 1638.3882,-11158.2651 1656.7978,-11161.4342 1728.717,-11165.0235 1782.2164,-11167.6935 1795.1415,-11179.6801 1848.6416,-11177.0235"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2253.8123,-10987.0235C2355.8351,-10869.8816 2429.3607,-10358.1037 2444.2618,-10247.251"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2447.7388,-10247.655 2445.5884,-10237.2807 2440.8,-10246.7316 2447.7388,-10247.655"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.6837,-1319.0235C1104.8681,-1325.8799 1314.6746,-1392.78 1336.1997,-1415.0235 1371.6782,-1451.686 1345.1957,-1480.7378 1372.1997,-1524.0235 1424.351,-1607.6189 1483.5808,-1592.4904 1530.6973,-1679.0235 1569.0858,-1749.5271 1539.1287,-1780.6284 1566.6973,-1856.0235 1624.888,-2015.1649 1863.0636,-2370.487 1932.5662,-2525.0235 2044.9138,-2774.8244 2090.9202,-2835.719 2140.8962,-3105.0235 2157.3825,-3193.8622 2127.5617,-4655.3253 2176.8962,-4731.0235 2218.113,-4794.2659 2285.7495,-4742.3989 2330.7283,-4803.0235 2397.3535,-4892.8243 2333.214,-4945.3469 2366.7283,-5052.0235 2383.4674,-5105.3046 2416.2769,-5162.6164 2434.3501,-5192.0506"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2431.6138,-5194.2779 2439.8699,-5200.9178 2437.5565,-5190.5786 2431.6138,-5194.2779"/>
</g>
<!-- sourcefile~dataairloop.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node73" class="node">
<title>sourcefile~dataairloop.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node73"><a xlink:href="../sourcefile/dataairloop.f90.html" xlink:title="DataAirLoop.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2297.6964,-5545.0289 2209.9281,-5545.0289 2209.9281,-5523.0181 2297.6964,-5523.0181 2297.6964,-5545.0289"/>
<text text-anchor="middle" x="2253.8123" y="-5530.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirLoop.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-1549.0235C753.3776,-1539.7243 1211.1134,-1525.0002 1336.1997,-1637.0235 1389.2058,-1684.4941 1350.299,-1725.3222 1372.1997,-1793.0235 1428.0173,-1965.5714 1484.4883,-1993.6578 1530.6973,-2169.0235 1565.8144,-2302.2952 1503.8538,-2354.3643 1566.6973,-2477.0235 1611.1687,-2563.8237 1677.7088,-2541.8963 1728.717,-2625.0235 1760.0723,-2676.1226 1747.1536,-2697.7016 1764.717,-2755.0235 1833.2654,-2978.7457 1886.2783,-3024.6593 1932.5662,-3254.0235 1975.5003,-3466.7695 1947.4502,-3525.0182 1968.5662,-3741.0235 1999.4069,-4056.5081 1986.5691,-4139.4503 2054.7312,-4449.0235"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2054.7312,-4449.0235C2058.958,-4467.9563 2127.964,-4448.5641 2140.8962,-4463.0235 2194.5907,-4523.0586 2166.143,-5107.2007 2176.8962,-5187.0235 2193.775,-5312.3164 2232.9036,-5459.3216 2247.8562,-5513.0312"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2244.516,-5514.083 2250.5872,-5522.7658 2251.2558,-5512.1921 2244.516,-5514.083"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2309.0235C382.9873,-2271.23 203.2074,-2070.3315 317.2024,-1953.0235 343.6311,-1925.8268 369.3539,-1952.5664 399.0839,-1929.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1929.0235C501.8447,-1847.648 1220.4644,-1848.4201 1336.1997,-1973.0235 1397.4532,-2038.9705 1332.3216,-5132.3344 1372.1997,-5213.0235 1392.0134,-5253.1145 1447.5706,-5230.472 1451.4485,-5275.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1451.4485,-5275.0235C1455.99,-5327.1297 1500.49,-5319.3246 1530.6973,-5362.0235 1578.6217,-5429.7661 1620.8484,-5519.4099 1638.6857,-5559.3242"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1635.5298,-5560.8416 1642.7771,-5568.5699 1641.931,-5558.0089 1635.5298,-5560.8416"/>
</g>
<!-- sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node75" class="node">
<title>sourcefile~dataairsystems.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node75"><a xlink:href="../sourcefile/dataairsystems.f90.html" xlink:title="DataAirSystems.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2306.095,-4689.0289 2201.5296,-4689.0289 2201.5296,-4667.0181 2306.095,-4667.0181 2306.095,-4689.0289"/>
<text text-anchor="middle" x="2253.8123" y="-4674.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirSystems.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1074.6837,-1319.0235C1188.2131,-1346.1182 1236.6664,-1282.0633 1336.1997,-1343.0235 1474.2615,-1427.581 1446.3833,-1512.8129 1530.6973,-1651.0235 1565.4841,-1708.0474 2122.7148,-2622.7484 2140.8962,-2687.0235 2198.0662,-2889.1314 2107.8527,-4378.6577 2176.8962,-4577.0235 2188.3707,-4609.9902 2215.0859,-4640.8229 2233.7927,-4659.5446"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2231.6424,-4662.3356 2241.2519,-4666.7976 2236.5224,-4657.3169 2231.6424,-4662.3356"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M585.7192,-1243.0235C803.723,-1214.0024 864.771,-1253.4146 1074.6837,-1319.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-2309.0235C343.5709,-2280.4425 244.8519,-2755.4363 317.2024,-2855.0235 365.5222,-2921.5335 437.27,-2871.388 480.9653,-2941.0235 512.6672,-2991.5455 513.5315,-3954.4778 516.9653,-4014.0235 535.7858,-4340.3887 574.1225,-4736.886 583.5762,-4832.5266"/>
<polygon fill="#00ffff" stroke="#00ffff" points="580.1126,-4833.0681 584.5826,-4842.6738 587.0784,-4832.3771 580.1126,-4833.0681"/>
</g>
<!-- sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node77" class="node">
<title>sourcefile~datazonecontrols.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node77"><a xlink:href="../sourcefile/datazonecontrols.f90.html" xlink:title="DataZoneControls.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="818.1891,-1521.0289 703.7411,-1521.0289 703.7411,-1499.0181 818.1891,-1499.0181 818.1891,-1521.0289"/>
<text text-anchor="middle" x="760.9651" y="-1506.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneControls.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M585.7192,-1549.0235C631.181,-1546.502 681.8218,-1534.1592 716.9282,-1524.0248"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="718.2483,-1527.2846 726.8505,-1521.0997 716.2689,-1520.5703 718.2483,-1527.2846"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M399.0839,-1549.0235C458.389,-1491.0283 502.8975,-1553.6172 585.7192,-1549.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge249" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2309.0235C341.771,-2281.4469 271.1105,-1335.0217 317.2024,-1223.0235 388.1188,-1050.7044 399.3781,-901.0235 585.7192,-901.0235 585.7192,-901.0235 585.7192,-901.0235 1251.9829,-901.0235 1729.3783,-901.0235 1824.3613,-1146.6554 2140.8962,-1504.0235 2234.3414,-1609.5231 2260.2528,-1635.9769 2330.7283,-1758.0235 2441.5034,-1949.8593 2459.7014,-2005.0861 2527.3586,-2216.0235 2531.488,-2228.8978 2733.6562,-3153.5991 2735.2632,-3167.0235 2745.5799,-3253.2091 2732.7147,-4651.2521 2771.2632,-4729.0235 2781.2771,-4749.2266 2801.1502,-4765.0286 2818.4518,-4775.7537"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2816.8046,-4778.8453 2827.1991,-4780.8958 2820.3521,-4772.8108 2816.8046,-4778.8453"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge262" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1074.6837,-259.0235C1311.7106,-102.8673 2117.7558,-303.3822 2330.7283,-491.0235 2708.8217,-824.1461 2758.8252,-979.7775 2929.166,-1454.0235 2982.7602,-1603.2352 3025.5657,-2115.9249 3034.377,-2227.4844"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3030.9137,-2228.0911 3035.1837,-2237.7874 3037.8923,-2227.5447 3030.9137,-2228.0911"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-4399.0235C555.945,-4591.4464 323.7832,-4008.9487 516.9653,-3853.0235 564.5217,-3814.6388 603.8281,-3818.8172 654.4731,-3853.0235 699.2385,-3883.2587 996.8604,-4705.1444 1017.6013,-4755.0235 1066.997,-4873.8136 1091.5988,-4898.804 1131.7661,-5021.0235 1153.712,-5087.7994 1117.8716,-5125.5141 1167.7661,-5175.0235 1222.2399,-5229.0768 1276.2951,-5165.0589 1336.1997,-5213.0235 1365.3754,-5236.384 1345.9017,-5262.465 1372.1997,-5289.0235 1427.304,-5344.6737 1461.4273,-5329.4844 1530.6973,-5366.0235 1620.3229,-5413.3 1671.2435,-5395.5693 1728.717,-5479.0235 1787.9006,-5564.9607 1736.6286,-5610.53 1764.717,-5711.0235 1817.3885,-5899.4688 1874.6456,-5931.1249 1932.5662,-6118.0235 1955.299,-6191.3781 1929.7048,-6220.7855 1968.5662,-6287.0235 2020.0972,-6374.8567 2096.1208,-6346.5617 2140.8962,-6438.0235 2200.31,-6559.3867 2094.2739,-6938.1004 2176.8962,-7045.0235 2182.2031,-7051.8912 2189.4315,-7056.8999 2197.344,-7060.547"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2196.2836,-7063.8895 2206.8729,-7064.2327 2198.8089,-7057.3609 2196.2836,-7063.8895"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2309.0235C307.9354,-2289.053 308.0851,-3776.0722 317.2024,-3862.0235 342.6686,-4102.1019 253.9997,-4206.0553 399.0839,-4399.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1074.6837,-7173.0235C1116.2563,-7199.9822 1169.1392,-7220.8694 1206.2904,-7233.6762"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1205.2596,-7237.0223 1215.8539,-7236.9145 1207.5047,-7230.3921 1205.2596,-7237.0223"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-2309.0235C374.5608,-2272.9557 220.5102,-4975.9116 317.2024,-5097.0235 364.1527,-5155.8312 434.2226,-5081.0507 480.9653,-5140.0235 575.0004,-5258.6624 425.7016,-6381.2398 516.9653,-6502.0235 555.5679,-6553.1124 610.6777,-6498.3096 654.4731,-6545.0235 700.7737,-6594.4095 660.947,-6632.1062 690.4731,-6693.0235 750.0652,-6815.972 960.0479,-7098.6852 1074.6837,-7173.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge221" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-2309.0235C450.2304,-2256.1458 152.7941,-1431.3961 317.2024,-1267.0235 401.9347,-1182.3096 467.0359,-1259.4636 585.7192,-1243.0235"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-1243.0235C1001.989,-1180.8091 1212.5838,-1029.4243 1530.6973,-1305.0235 1946.5078,-1665.2631 1990.912,-1852.7073 2140.8962,-2382.0235 2200.2467,-2591.4798 2144.7922,-3145.7011 2176.8962,-3361.0235 2192.2532,-3464.0228 2230.5351,-3583.017 2246.5686,-3630.2034"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2243.3332,-3631.5586 2249.889,-3639.8816 2249.9544,-3629.2869 2243.3332,-3631.5586"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge337" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-601.0235C655.1665,-571.9403 849.2381,-601.0235 924.5292,-601.0235 924.5292,-601.0235 924.5292,-601.0235 1451.4485,-601.0235 1528.3935,-601.0235 2088.6913,-609.4976 2140.8962,-666.0235 2234.0828,-766.923 2091.4338,-3030.5032 2176.8962,-3138.0235 2198.8066,-3165.5889 2236.7751,-3126.2071 2253.8123,-3157.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-3157.0235C2306.6799,-3252.649 2366.1576,-3235.5613 2447.0435,-3309.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge482" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-14821.0235C411.3429,-14859.9155 463.7926,-14852.6486 654.4731,-14835.0235 734.1487,-14827.6589 771.8683,-14855.424 831.457,-14802.0235 872.6072,-14765.1467 837.1711,-14729.2403 867.457,-14683.0235 903.9467,-14627.3397 945.8268,-14642.1694 981.6013,-14586.0235 1014.0475,-14535.1013 979.262,-14501.6703 1017.6013,-14455.0235 1053.6116,-14411.2105 1098.5273,-14443.9745 1131.7661,-14398.0235 1196.7859,-14308.137 1139.7244,-14258.3586 1167.7661,-14151.0235 1220.5898,-13948.8307 1294.7309,-13916.8469 1336.1997,-13712.0235 1360.1354,-13593.8003 1319.4178,-12735.4842 1372.1997,-12627.0235 1412.4391,-12544.3363 1485.6941,-12574.2177 1530.6973,-12494.0235 1583.0522,-12400.7288 1500.0659,-12339.7206 1566.6973,-12256.0235 1614.919,-12195.4511 1674.3544,-12247.1511 1728.717,-12192.0235 1760.4206,-12159.8738 1731.4851,-12127.5907 1764.717,-12097.0235 1817.2036,-12048.7455 1895.9075,-12028.3436 1958.0881,-12019.8218"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1958.8403,-12023.254 1968.3118,-12018.5063 1957.9469,-12016.3112 1958.8403,-12023.254"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node85" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node85"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-17719.0289 168.8556,-17719.0289 168.8556,-17697.0181 278.8255,-17697.0181 278.8255,-17719.0289"/>
<text text-anchor="middle" x="223.8406" y="-17704.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge473" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M65.6138,-12967.2415C73.7505,-13211.0325 211.8933,-17350.0599 223.117,-17686.3442"/>
<polygon fill="#ff0000" stroke="#ff0000" points="219.6306,-17686.8123 223.4623,-17696.69 226.6267,-17686.5788 219.6306,-17686.8123"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge587" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-18393.0235C921.928,-18339.7207 1051.2047,-18426.183 1336.1997,-18240.0235 1359.4282,-18224.8506 1351.3728,-18207.3543 1372.1997,-18189.0235 1432.0459,-18136.3502 1464.6935,-18149.7398 1530.6973,-18105.0235 1533.6833,-18103.0006 1726.9956,-17940.1929 1728.717,-17937.0235 1788.6001,-17826.7673 1709.6646,-17769.7695 1764.717,-17657.0235 1870.3887,-17440.6105 2400.6577,-17091.8356 2527.3586,-16887.0235 2553.5338,-16844.7114 2538.4773,-16824.1092 2563.3586,-16781.0235 2621.3032,-16680.6839 2662.8617,-16675.487 2735.2632,-16585.0235 2826.6789,-16470.8023 2848.4282,-16441.0265 2929.166,-16319.0235 3014.0629,-16190.7359 3064.3828,-16169.8608 3106.9189,-16022.0235 3190.7041,-15730.8225 3223.4137,-10749.5231 3225.7238,-10380.5939"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3229.2247,-10380.4418 3225.787,-10370.4201 3222.2248,-10380.3981 3229.2247,-10380.4418"/>
</g>
<!-- sourcefile~datadefineequip.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node87" class="node">
<title>sourcefile~datadefineequip.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node87"><a xlink:href="../sourcefile/datadefineequip.f90.html" xlink:title="Datadefineequip.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="977.5216,-17797.0289 871.5367,-17797.0289 871.5367,-17775.0181 977.5216,-17775.0181 977.5216,-17797.0289"/>
<text text-anchor="middle" x="924.5292" y="-17782.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Datadefineequip.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadefineequip.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge594" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadefineequip.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-18393.0235C283.3893,-18443.2247 321.198,-18393.0235 399.0839,-18393.0235"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-18393.0235C662.0818,-18393.0235 706.1429,-18220.247 831.457,-17989.0235 863.096,-17930.6449 835.0216,-17901.9634 867.457,-17844.0235 876.1476,-17828.4995 890.0995,-17814.2128 902.0331,-17803.7031"/>
<polygon fill="#00ffff" stroke="#00ffff" points="904.5093,-17806.1928 909.8829,-17797.0617 899.988,-17800.8488 904.5093,-17806.1928"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge560" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-15125.0235C563.4793,-15181.4396 1616.7999,-14434.0017 1728.717,-14301.0235 1752.0109,-14273.3461 1735.9299,-14249.931 1764.717,-14228.0235 1766.5392,-14226.6368 1768.4468,-14225.3592 1770.4228,-14224.1825"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1772.1026,-14227.2556 1779.4732,-14219.6448 1768.9652,-14220.9981 1772.1026,-14227.2556"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-14821.0235C329.0478,-14842.8458 257.0978,-14954.9605 317.2024,-15044.0235 345.8373,-15086.4547 353.1258,-15102.4799 399.0839,-15125.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge666" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-12385.0235C436.8172,-12341.7982 598.7717,-12360.7923 654.4731,-12347.0235 735.3843,-12327.0231 763.5988,-12333.4166 831.457,-12285.0235 919.0849,-12222.5317 938.0144,-12193.431 981.6013,-12095.0235 1021.0153,-12006.0373 987.8489,-11971.6885 1017.6013,-11879.0235 1063.9135,-11734.7827 1064.0718,-11683.4667 1167.7661,-11573.0235 1307.549,-11424.1429 1376.9663,-11420.5672 1566.6973,-11345.0235 1722.1765,-11283.1175 1772.8813,-11306.0923 1932.5662,-11256.0235 2113.6115,-11199.2572 2154.6627,-11172.7393 2330.7283,-11102.0235 2346.8127,-11095.5633 2350.4022,-11092.8462 2366.7283,-11087.0235 2436.909,-11061.9938 2478.9332,-11095.6522 2527.3586,-11039.0235 2604.8933,-10948.3545 2480.1448,-10858.5101 2563.3586,-10773.0235 2590.3557,-10745.2892 2628.3855,-10791.5836 2649.3109,-10759.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge681" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-14821.0235C740.4099,-14753.3787 736.5097,-14546.1254 1017.6013,-14341.0235 1065.8699,-14305.8037 1101.8043,-14321.7205 1131.7661,-14270.0235 1187.3503,-14174.1167 1148.8641,-13382.25 1167.7661,-13273.0235 1210.0568,-13028.6439 1285.5309,-12983.8044 1336.1997,-12741.0235 1351.8123,-12666.2154 1333.8263,-12465.1104 1372.1997,-12399.0235 1415.7713,-12323.9842 1487.4891,-12360.2727 1530.6973,-12285.0235 1572.6042,-12212.0405 1510.2302,-11970.4269 1566.6973,-11908.0235 1573.6228,-11900.3699 1583.0607,-11895.7558 1593.05,-11893.077"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1594.0592,-11896.4428 1603.1504,-11891.0023 1592.6507,-11889.586 1594.0592,-11896.4428"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-14821.0235C300.1032,-14836.842 321.5608,-14828.5329 399.0839,-14821.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge632" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-12157.0235C433.5037,-12111.5852 604.2118,-12159.9153 654.4731,-12133.0235 657.9119,-12131.1837 830.0582,-11918.664 831.457,-11915.0235 859.1912,-11842.8426 820.8667,-11281.7374 867.457,-11220.0235 899.7583,-11177.237 946.398,-11221.456 981.6013,-11181.0235 1036.892,-11117.5198 981.6975,-11071.1858 1017.6013,-10995.0235 1062.3176,-10900.1674 1083.2521,-10875.109 1167.7661,-10813.0235 1463.4871,-10595.7816 1650.709,-10736.9736 1932.5662,-10502.0235 2064.9317,-10391.6864 2084.3563,-10337.806 2140.8962,-10175.0235 2192.7845,-10025.6335 2104.4403,-9961.5935 2176.8962,-9821.0235 2218.5725,-9740.1686 2271.0883,-9754.7076 2330.7283,-9686.0235 2349.8831,-9663.9639 2344.5676,-9650.0613 2366.7283,-9631.0235 2435.8972,-9571.602 2536.9725,-9534.399 2597.6309,-9515.9869"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2598.788,-9519.2943 2607.3733,-9513.086 2596.7903,-9512.5854 2598.788,-9519.2943"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge644" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-15125.0235C736.021,-15115.8381 773.947,-15125.0235 924.5292,-15125.0235 924.5292,-15125.0235 924.5292,-15125.0235 1074.6837,-15125.0235 1218.6314,-15125.0235 1231.212,-15223.9819 1372.1997,-15253.0235 1527.5912,-15285.0322 1573.0969,-15265.9018 1728.717,-15235.0235 2006.6704,-15179.8718 2126.9154,-15221.8993 2330.7283,-15025.0235 2357.6104,-14999.0564 2348.2524,-14981.5132 2366.7283,-14949.0235 2429.9944,-14837.7703 2489.1684,-14832.1766 2527.3586,-14710.0235 2569.1553,-14576.3351 2548.933,-12328.3485 2563.3586,-12189.0235 2580.3335,-12025.0782 2627.6499,-11831.3687 2643.8152,-11768.1285"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2647.2719,-11768.7401 2646.3768,-11758.1831 2640.4931,-11766.9941 2647.2719,-11768.7401"/>
</g>
<!-- sourcefile~dataphotovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node93" class="node">
<title>sourcefile~dataphotovoltaics.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node93"><a xlink:href="../sourcefile/dataphotovoltaics.f90.html" xlink:title="DataPhotovoltaics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="981.6736,-10875.0289 867.3848,-10875.0289 867.3848,-10853.0181 981.6736,-10853.0181 981.6736,-10875.0289"/>
<text text-anchor="middle" x="924.5292" y="-10860.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPhotovoltaics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge657" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-11891.0235C434.4216,-11846.1493 598.3719,-11872.7521 654.4731,-11862.0235 734.5236,-11846.715 780.2917,-11877.4628 831.457,-11814.0235 880.2797,-11753.4888 856.796,-11192.0589 867.457,-11115.0235 879.4044,-11028.6929 906.2706,-10928.2283 918.3913,-10885.2669"/>
<polygon fill="#0000ff" stroke="#0000ff" points="921.8278,-10885.9785 921.2018,-10875.4022 915.0957,-10884.0605 921.8278,-10885.9785"/>
</g>
<!-- sourcefile~datagenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node94" class="node">
<title>sourcefile~datagenerators.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node94"><a xlink:href="../sourcefile/datagenerators.f90.html" xlink:title="DataGenerators.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="813.1838,-14793.0289 708.7464,-14793.0289 708.7464,-14771.0181 813.1838,-14771.0181 813.1838,-14793.0289"/>
<text text-anchor="middle" x="760.9651" y="-14778.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGenerators.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datagenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge676" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datagenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-14821.0235C480.4504,-14804.8981 502.9133,-14825.8949 585.7192,-14821.0235"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge748" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-16531.0235C452.1989,-16551.2571 602.3551,-16567.702 654.4731,-16545.0235 760.2934,-16498.9772 777.0174,-16456.7806 831.457,-16355.0235 864.2066,-16293.809 849.8827,-16270.1867 867.457,-16203.0235 914.0403,-16024.9974 944.4366,-15985.2514 981.6013,-15805.0235 1007.0301,-15681.7084 947.022,-15628.2914 1017.6013,-15524.0235 1279.7935,-15136.683 1684.6943,-15400.6807 1932.5662,-15004.0235 1978.3377,-14930.7776 1913.1922,-14683.3086 1968.5662,-14617.0235 1994.0527,-14586.515 2037.0099,-14628.6084 2054.7312,-14593.0235"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node96" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node96"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-17719.0289 340.6161,-17719.0289 340.6161,-17697.0181 457.5516,-17697.0181 457.5516,-17719.0289"/>
<text text-anchor="middle" x="399.0839" y="-17704.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge846" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-14821.0235C379.7678,-14852.561 220.4791,-17556.7203 317.2024,-17683.0235 321.1165,-17688.1346 326.05,-17692.2319 331.546,-17695.512"/>
<polygon fill="#ff0000" stroke="#ff0000" points="330.0694,-17698.6868 340.5797,-17700.0223 333.1962,-17692.4239 330.0694,-17698.6868"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node97" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node97"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-16581.0289 323.0941,-16581.0289 323.0941,-16559.0181 475.0737,-16559.0181 475.0737,-16581.0289"/>
<text text-anchor="middle" x="399.0839" y="-16566.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge848" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-14821.0235C411.8694,-14859.0538 198.9362,-16393.9796 317.2024,-16545.0235 319.708,-16548.2235 322.6124,-16551.0251 325.802,-16553.4769"/>
<polygon fill="#00ff00" stroke="#00ff00" points="323.9421,-16556.442 334.2529,-16558.8787 327.7121,-16550.5439 323.9421,-16556.442"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node98" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node98"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-16622.0289 317.3208,-16622.0289 317.3208,-16600.0181 480.847,-16600.0181 480.847,-16622.0289"/>
<text text-anchor="middle" x="399.0839" y="-16607.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge850" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-14821.0235C416.7632,-14860.0436 192.486,-16437.749 317.2024,-16590.0235 318.2195,-16591.2653 319.2991,-16592.4393 320.4341,-16593.5491"/>
<polygon fill="#0000ff" stroke="#0000ff" points="318.6192,-16596.5731 328.652,-16599.9782 322.9324,-16591.0598 318.6192,-16596.5731"/>
</g>
<!-- sourcefile~datadelight.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node99" class="node">
<title>sourcefile~datadelight.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node99"><a xlink:href="../sourcefile/datadelight.f90.html" xlink:title="DataDElight.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3629.875,-18022.0289 3544.7905,-18022.0289 3544.7905,-18000.0181 3629.875,-18000.0181 3629.875,-18022.0289"/>
<text text-anchor="middle" x="3587.3328" y="-18007.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataDElight.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadelight.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge915" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadelight.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-18697.0235C793.2826,-18690.7697 986.4365,-18834.4269 1017.6013,-18845.0235 1214.4344,-18911.9507 1458.6758,-18924.6751 1848.6416,-18889.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1848.6416,-18889.0235C2215.7105,-18842.5452 2279.3112,-18661.0235 2649.3109,-18661.0235 2649.3109,-18661.0235 2649.3109,-18661.0235 3225.8566,-18661.0235 3520.7818,-18661.0235 3577.1856,-18143.5984 3585.9185,-18032.0518"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3589.4123,-18032.2631 3586.6573,-18022.0327 3582.4313,-18031.7482 3589.4123,-18032.2631"/>
</g>
<!-- sourcefile~tarcogcomplexfenestration.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node100" class="node">
<title>sourcefile~tarcogcomplexfenestration.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node100"><a xlink:href="../sourcefile/tarcogcomplexfenestration.f90.html" xlink:title="TarcogComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="479.4092,-18443.0289 318.7586,-18443.0289 318.7586,-18421.0181 479.4092,-18421.0181 479.4092,-18443.0289"/>
<text text-anchor="middle" x="399.0839" y="-18428.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">TarcogComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~tarcogcomplexfenestration.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge932" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~tarcogcomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-18393.0235C247.3916,-18412.8777 278.876,-18423.2148 308.6585,-18428.424"/>
<polygon fill="#ff0000" stroke="#ff0000" points="308.2571,-18431.9039 318.6795,-18430.0004 309.3449,-18424.9889 308.2571,-18431.9039"/>
</g>
<!-- sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge979" class="edge">
<title>sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M4007.2084,-17595.0235C4015.5162,-17595.0235 4024.1807,-17595.0235 4032.7628,-17595.0235"/>
<polygon fill="#ff0000" stroke="#ff0000" points="4032.7734,-17598.5236 4042.7733,-17595.0235 4032.7733,-17591.5236 4032.7734,-17598.5236"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge980" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.0121,-11118.7435C226.7974,-10935.2199 262.8077,-8548.529 281.2024,-6624.0235 281.9507,-6545.7338 293.5862,-1061.6701 317.2024,-987.0235 364.1905,-838.502 403.6637,-805.9312 516.9653,-699.0235 569.0535,-649.8748 602.4068,-664.1953 654.4731,-615.0235 674.9092,-595.7235 669.0458,-581.2167 690.4731,-563.0235 799.6264,-470.3456 863.8758,-506.5363 981.6013,-425.0235 1028.9127,-392.2652 1117.8339,-273.6286 1167.7661,-245.0235 1416.5574,-102.4963 2162.5964,-40.9547 2447.0435,-77.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge814" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.0282,-11141.1437C226.7875,-11304.8171 259.3648,-13242.9839 281.2024,-14807.0235 282.3353,-14888.1607 278.4517,-17656.729 317.2024,-17728.0235 368.1384,-17821.7367 427.0466,-17803.654 516.9653,-17861.0235 929.8411,-18124.4445 1043.4234,-18342.2299 1530.6973,-18293.0235 1712.0635,-18274.7086 1765.4902,-18283.9262 1932.5662,-18211.0235 2150.1166,-18116.0966 2159.2566,-18015.3267 2366.7283,-17900.0235 2921.7419,-17591.5724 3087.1123,-17562.4741 3686.5393,-17353.0235 3697.6855,-17349.1288 3709.7821,-17345.3698 3721.3148,-17342.0014"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3722.6183,-17345.2688 3731.2664,-17339.1483 3720.689,-17338.5399 3722.6183,-17345.2688"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge817" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff4200" stroke-dasharray="5,2" d="M224.0071,-11141.0666C225.8709,-11259.2036 244.149,-12287.6018 317.2024,-12399.0235 325.2077,-12411.2333 337.8566,-12420.1944 350.8402,-12426.6742"/>
<polygon fill="#ff4200" stroke="#ff4200" points="349.7395,-12430.0182 360.2919,-12430.965 352.6331,-12423.6443 349.7395,-12430.0182"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge829" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#f3ff00" stroke-dasharray="5,2" d="M399.0839,-2423.0235C472.4352,-2335.1691 546.5847,-2417.8282 654.4731,-2456.0235 902.9413,-2543.9876 931.9939,-2636.0783 1131.7661,-2808.0235 1168.2079,-2839.3892 1209.2503,-2877.5923 1232.7218,-2899.7287"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="1230.5839,-2902.524 1240.2549,-2906.851 1235.393,-2897.4376 1230.5839,-2902.524"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadaylightingdevices.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge834" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadaylightingdevices.f90</title>
<path fill="none" stroke="#b1ff00" stroke-dasharray="5,2" d="M585.7192,-11397.0235C618.2017,-11358.6015 681.8429,-11369.4003 722.8347,-11381.8627"/>
<polygon fill="#b1ff00" stroke="#b1ff00" points="721.8912,-11385.2356 732.4822,-11384.9526 724.0264,-11378.5692 721.8912,-11385.2356"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge837" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M224.0552,-11141.0855C226.2199,-11247.6004 245.5455,-12089.2074 317.2024,-12171.0235 350.5033,-12209.0457 727.4609,-12308.8667 760.9651,-12271.0235"/>
<path fill="none" stroke="#6eff00" stroke-dasharray="5,2" d="M760.9651,-12271.0235C785.7184,-12243.93 812.4925,-12259.4422 831.457,-12228.0235 897.0441,-12119.3645 847.7032,-11783.3959 867.457,-11658.0235 879.4466,-11581.929 905.5436,-11494.0099 917.8512,-11454.781"/>
<polygon fill="#6eff00" stroke="#6eff00" points="921.248,-11455.6481 920.9338,-11445.0579 914.5753,-11453.5326 921.248,-11455.6481"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge840" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#2cff00" stroke-dasharray="5,2" d="M585.7192,-3487.0235C712.2902,-3442.0032 753.1643,-3553.8572 831.457,-3663.0235 848.1741,-3686.3327 973.904,-4129.3915 981.6013,-4157.0235 999.0728,-4219.7432 999.5485,-4236.4687 1017.6013,-4299.0235 1063.2042,-4457.0418 1090.1987,-4491.896 1131.7661,-4651.0235 1152.3858,-4729.9591 1138.1832,-4754.9916 1167.7661,-4831.0235 1185.6127,-4876.8915 1218.2388,-4924.7873 1237.2177,-4950.6519"/>
<polygon fill="#2cff00" stroke="#2cff00" points="1234.536,-4952.9109 1243.315,-4958.8422 1240.151,-4948.7309 1234.536,-4952.9109"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadaylighting.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge842" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadaylighting.f90</title>
<path fill="none" stroke="#00ff16" stroke-dasharray="5,2" d="M224.032,-11141.1436C226.8463,-11304.8163 260.0483,-13242.9745 281.2024,-14807.0235 282.3836,-14894.3546 281.5675,-17871.2848 317.2024,-17951.0235 363.1037,-18053.7348 590.9523,-18240.5625 690.4731,-18293.0235 928.4532,-18418.4713 1254.4409,-18455.7795 1389.2302,-18466.2222"/>
<polygon fill="#00ff16" stroke="#00ff16" points="1389.1363,-18469.7249 1399.3706,-18466.9847 1389.6613,-18462.7446 1389.1363,-18469.7249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge855" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff58" stroke-dasharray="5,2" d="M399.0839,-14783.0235C408.1928,-14819.8361 450.5719,-14784.3436 480.9653,-14807.0235 734.5905,-14996.2811 645.6058,-15179.3552 867.457,-15405.0235 921.357,-15459.8508 1000.1207,-15505.4646 1043.3679,-15528.2885"/>
<polygon fill="#00ff58" stroke="#00ff58" points="1041.8047,-15531.4206 1052.2902,-15532.9391 1045.0403,-15525.2132 1041.8047,-15531.4206"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge865" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M399.0839,-17669.0235C420.2047,-17699.8387 448.174,-17670.1239 480.9653,-17688.0235 500.5525,-17698.7154 500.5671,-17707.8883 516.9653,-17723.0235 592.3013,-17792.557 601.6976,-17823.7466 690.4731,-17875.0235 719.1318,-17891.5768 728.8268,-17891.1203 760.9651,-17899.0235"/>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M760.9651,-17899.0235C806.521,-17909.9339 859.6096,-17893.1973 892.6494,-17879.3239"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="894.4632,-17882.3512 902.229,-17875.144 891.6637,-17875.9354 894.4632,-17882.3512"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge874" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M585.7192,-17253.0235C600.2746,-17269.5653 959.6478,-17275.1444 981.6013,-17277.0235 1086.2666,-17285.9824 1353.303,-17291.5728 1451.4485,-17329.0235"/>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M223.8715,-11141.0791C224.5131,-11360.0504 235.7792,-14760.4617 317.2024,-14949.0235 357.7885,-15043.014 440.7294,-15016.8826 480.9653,-15111.0235 527.2162,-15219.2377 448.0162,-17133.6534 516.9653,-17229.0235 535.9278,-17255.2523 564.9012,-17228.2418 585.7192,-17253.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge885" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#009bff" stroke-dasharray="5,2" d="M585.7192,-11397.0235C637.1727,-11336.1616 698.8167,-11484.9155 760.9651,-11435.0235"/>
<path fill="none" stroke="#009bff" stroke-dasharray="5,2" d="M924.5292,-9953.0235C928.0638,-9914.5434 1013.5963,-8603.4575 1017.6013,-8565.0235 1032.876,-8418.4421 1061.1486,-8243.2213 1071.1029,-8183.3122"/>
<polygon fill="#009bff" stroke="#009bff" points="1074.5958,-8183.6444 1072.7909,-8173.2044 1067.6915,-8182.4913 1074.5958,-8183.6444"/>
<path fill="none" stroke="#009bff" stroke-dasharray="5,2" d="M760.9651,-11435.0235C786.2681,-11414.7105 811.3939,-11441.5251 831.457,-11416.0235 879.5989,-11354.8321 838.2262,-10087.1871 867.457,-10015.0235 881.518,-9980.3104 921.1033,-9990.3193 924.5292,-9953.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge894" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0058ff" stroke-dasharray="5,2" d="M585.7192,-11397.0235C710.9648,-11248.8762 755.094,-9754.567 760.4056,-9556.6328"/>
<polygon fill="#0058ff" stroke="#0058ff" points="763.9114,-9556.4573 760.6772,-9546.3682 756.9138,-9556.2721 763.9114,-9556.4573"/>
<path fill="none" stroke="#0058ff" stroke-dasharray="5,2" d="M399.0839,-11511.0235C464.8331,-11506.34 458.9289,-11452.2752 516.9653,-11421.0235 545.4619,-11405.6785 564.8237,-11421.7399 585.7192,-11397.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge900" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M399.0839,-14783.0235C408.1928,-14819.8361 456.6265,-14777.9416 480.9653,-14807.0235 528.5935,-14863.9332 508.5674,-15065.29 516.9653,-15139.0235 541.6269,-15355.5513 573.7211,-15617.5767 583.062,-15693.4747"/>
<polygon fill="#0016ff" stroke="#0016ff" points="579.6203,-15694.1634 584.3166,-15703.6605 586.5678,-15693.3076 579.6203,-15694.1634"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge909" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M760.9651,-17899.0235C796.3236,-17907.4917 902.7252,-17873.9284 924.5292,-17903.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge923" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M224.0354,-11141.1436C226.8983,-11304.8156 260.6537,-13242.9665 281.2024,-14807.0235 282.433,-14900.6874 283.7593,-18091.5249 317.2024,-18179.0235 365.3025,-18304.87 421.697,-18311.7612 516.9653,-18407.0235 535.192,-18425.2491 845.0308,-18698.3172 867.457,-18711.0235 913.9772,-18737.3811 936.684,-18720.0186 981.6013,-18749.0235 1001.4179,-18761.8199 997.3656,-18775.9008 1017.6013,-18788.0235 1076.7531,-18823.4598 1099.3678,-18818.2864 1167.7661,-18827.0235 1242.0221,-18836.5089 1261.5844,-18833.0636 1336.1997,-18827.0235 1414.6941,-18820.6695 2658.5172,-18616.6813 2735.2632,-18599.0235 2871.2462,-18567.7365 2903.5648,-18552.8405 3036.0425,-18509.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge944" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M224.016,-11141.1267C228.2969,-11412.0478 309.5772,-16551.4986 317.2024,-16702.0235 328.1131,-16917.4052 277.7683,-17490.7236 399.0839,-17669.0235"/>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M399.0839,-17669.0235C401.1233,-17672.021 650.999,-17721.9868 654.4731,-17723.0235 751.8248,-17752.0729 771.2037,-17773.5194 867.457,-17806.0235 978.0244,-17843.3614 1258.7423,-17923.6979 1372.1997,-17951.0235 1457.8289,-17971.6468 1479.0291,-17980.5396 1566.6973,-17989.0235 1638.3712,-17995.9596 1667.4675,-18026.8885 1728.717,-17989.0235 1830.1424,-17926.3215 1747.5925,-17685.7169 1848.6416,-17749.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge955" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M223.9712,-11118.7706C226.041,-10943.2717 252.8804,-8765.1693 317.2024,-8128.0235 381.4902,-7491.2163 550.4374,-6722.1108 580.9582,-6586.0788"/>
<polygon fill="#ff0042" stroke="#ff0042" points="584.4174,-6586.6487 583.1986,-6576.1242 577.5882,-6585.1116 584.4174,-6586.6487"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge455" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3416.4602,-8553.0235C3523.4819,-8757.0981 3572.0787,-9037.3417 3584.2016,-9116.4543"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3580.7838,-9117.2639 3585.7282,-9126.6343 3587.7064,-9116.2257 3580.7838,-9117.2639"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-5083.0235C431.196,-5064.8058 453.139,-5072.7589 480.9653,-5097.0235 521.0114,-5131.9438 477.6729,-5175.2573 516.9653,-5211.0235 673.1748,-5353.2142 814.3097,-5182.0541 981.6013,-5311.0235 1009.6215,-5332.625 999.5796,-5351.5773 1017.6013,-5382.0235 1063.3982,-5459.3935 1096.2593,-5466.4236 1131.7661,-5549.0235 1161.7515,-5618.7789 1113.5739,-5662.8432 1167.7661,-5716.0235 1222.212,-5769.4528 1262.4826,-5729.4065 1336.1997,-5749.0235 1514.1996,-5796.3914 1560.9988,-5805.877 1728.717,-5882.0235 1938.4005,-5977.2228 1973.5768,-6033.8974 2176.8962,-6142.0235 2420.4455,-6271.5439 2510.7887,-6252.702 2735.2632,-6413.0235 2925.959,-6549.22 2999.1463,-6578.9383 3106.9189,-6787.0235 3198.5377,-6963.9192 3323.9386,-8376.5984 3416.4602,-8553.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge464" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M224.0026,-11118.7434C226.6354,-10935.2182 260.7346,-8548.5081 281.2024,-6624.0235 281.825,-6565.483 286.7078,-2458.9981 317.2024,-2409.0235 360.024,-2338.8473 427.3636,-2385.3552 480.9653,-2323.0235 512.8574,-2285.9373 486.923,-2257.6234 516.9653,-2219.0235 665.8047,-2027.7874 782.7867,-2062.9109 1017.6013,-2003.0235 1155.4154,-1967.8752 1227.086,-1881.7967 1336.1997,-1973.0235 1405.4901,-2030.9552 1346.3188,-2086.4937 1372.1997,-2173.0235 1435.337,-2384.1157 1475.7181,-2428.3521 1566.6973,-2629.0235 1635.3196,-2780.3828 1676.2117,-2808.3471 1728.717,-2966.0235 1802.909,-3188.8259 1837.7652,-3473.6772 1846.4289,-3552.8105"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1842.9711,-3553.3921 1847.5186,-3562.9614 1849.9311,-3552.6449 1842.9711,-3553.3921"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge471" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M223.9855,-11118.7814C227.8973,-10815.4872 309.7345,-4476.166 317.2024,-4385.0235 333.9779,-4180.2853 380.5221,-3935.5152 394.8385,-3863.1473"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="398.3297,-3863.5365 396.85,-3853.0455 391.4645,-3862.1694 398.3297,-3863.5365"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge503" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-14935.0235C401.5323,-14971.8621 456.9138,-14921.0128 480.9653,-14949.0235 555.2424,-15035.5273 437.2663,-16919.4879 516.9653,-17001.0235 661.7957,-17149.1912 796.1457,-17055.4124 981.6013,-16963.0235 1450.8761,-16729.2438 1566.9999,-16640.8333 1932.5662,-16265.0235 1952.1658,-16244.8746 1948.8715,-16233.0795 1968.5662,-16213.0235 2001.6221,-16179.361 2015.6601,-16177.468 2054.7312,-16151.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge520" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M585.7192,-17253.0235C605.7514,-17276.9229 624.882,-17257.1835 654.4731,-17267.0235 671.2634,-17272.6068 673.5682,-17278.7977 690.4731,-17284.0235 737.5707,-17298.5826 1517.5553,-17420.1224 1566.6973,-17424.0235 1638.4802,-17429.722 1673.1486,-17469.821 1728.717,-17424.0235 1793.3573,-17370.7494 1734.829,-17317.2744 1764.717,-17239.0235 1827.8556,-17073.7183 1871.5478,-17045.0091 1968.5662,-16897.0235 2006.3742,-16839.3535 2308.5481,-16458.3176 2330.7283,-16393.0235 2371.133,-16274.0796 2355.9942,-15388.1833 2366.7283,-15263.0235 2385.3022,-15046.4496 2429.8608,-14786.5995 2443.2044,-14711.3758"/>
<polygon fill="#65ff00" stroke="#65ff00" points="2446.6945,-14711.7407 2445.0049,-14701.2815 2439.8033,-14710.5115 2446.6945,-14711.7407"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge550" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-14591.0235C631.7032,-14775.3188 1443.8858,-14549.3762 1728.717,-14466.0235 1826.527,-14437.4005 1869.5675,-14441.1311 1932.5662,-14361.0235 1962.9551,-14322.3817 2132.0044,-13549.3723 2140.8962,-13501.0235 2163.9095,-13375.8898 2151.3023,-13341.655 2176.8962,-13217.0235 2226.8373,-12973.832 2288.4323,-12924.6605 2330.7283,-12680.0235 2373.7468,-12431.2075 2324.5848,-12361.9892 2366.7283,-12113.0235 2384.0488,-12010.7014 2423.3005,-11892.5465 2439.6646,-11845.6952"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2443.0282,-11846.6807 2443.0508,-11836.0859 2436.4262,-11844.3542 2443.0282,-11846.6807"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge603" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M224.011,-11141.1414C228.1717,-11412.4031 307.2022,-16557.2997 317.2024,-16631.0235 381.3683,-17104.0714 180.3931,-17418.8285 585.7192,-17671.0235"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M585.7192,-17671.0235C642.2523,-17701.2605 1667.3413,-17530.5512 1728.717,-17512.0235 1926.516,-17452.3134 1970.7468,-17414.2364 2140.8962,-17297.0235 2158.0478,-17285.2081 2160.2203,-17279.5011 2176.8962,-17267.0235 2242.7762,-17217.7298 2262.9141,-17210.6203 2330.7283,-17164.0235 2356.7934,-17146.1135 2534.314,-17012.5362 2563.3586,-17000.0235 2682.8161,-16948.56 2744.685,-17018.0636 2850.2146,-16942.0235"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M2850.2146,-16942.0235C3090.4443,-16748.51 3170.2398,-16696.6327 3308.7942,-16421.0235 3343.2878,-16352.4096 3320.8795,-16325.0013 3344.7942,-16252.0235 3361.7367,-16200.3219 3390.2029,-16142.865 3405.6686,-16113.2039"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="3408.8164,-16114.7379 3410.3797,-16104.259 3402.6229,-16111.4759 3408.8164,-16114.7379"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge696" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M585.7192,-11397.0235C619.2768,-11357.3298 639.8685,-11437.1544 690.4731,-11449.0235 751.4771,-11463.3318 786.5668,-11492.7395 831.457,-11449.0235 885.5255,-11396.3693 839.0944,-10160.9622 867.457,-10091.0235 895.6072,-10021.6087 953.3555,-10036.3994 981.6013,-9967.0235 1033.1585,-9840.3916 973.6482,-8866.4913 1017.6013,-8737.0235 1054.2548,-8629.0573 1066.2531,-8580.9399 1167.7661,-8529.0235 1403.155,-8408.6396 1572.656,-8513.6103 1728.717,-8727.0235 1786.6828,-8806.2916 1689.8349,-8881.493 1764.717,-8945.0235 1821.6021,-8993.2852 1858.2615,-8951.6506 1932.5662,-8945.0235 1984.1594,-8940.422 2820.5381,-8737.5695 2850.2146,-8780.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge708" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M585.7192,-14375.0235C690.5976,-14311.8155 1038.2087,-14380.0282 1131.7661,-14301.0235 1383.5293,-14088.4216 1443.1025,-12924.5704 1450.5819,-12752.3287"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1454.0827,-12752.3824 1451.0087,-12742.2434 1447.0889,-12752.0864 1454.0827,-12752.3824"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge730" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.9821,-11141.1558C226.8009,-11361.6116 271.2754,-14783.4595 317.2024,-14873.0235 338.0308,-14913.6418 395.9914,-14889.4812 399.0839,-14935.0235"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-14935.0235C401.5851,-14971.8586 456.9091,-14921.0168 480.9653,-14949.0235 553.8814,-15033.9138 437.1313,-16884.6038 516.9653,-16963.0235 560.5643,-17005.8501 595.2037,-16977.9272 654.4731,-16963.0235 705.8166,-16950.1128 2303.6103,-16101.4928 2330.7283,-16056.0235 2370.1826,-15989.8695 2362.465,-14746.9314 2366.7283,-14670.0235 2387.2831,-14299.2241 2433.9613,-13848.2689 2444.7766,-13746.2208"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2448.261,-13746.552 2445.8384,-13736.2379 2441.3003,-13745.8115 2448.261,-13746.552"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1316.8034,-8786.0289 1187.1624,-8786.0289 1187.1624,-8764.0181 1316.8034,-8764.0181 1316.8034,-8786.0289"/>
<text text-anchor="middle" x="1251.9829" y="-8771.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge734" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M399.0839,-11511.0235C495.0715,-11504.186 764.3493,-11555.994 831.457,-11487.0235 881.1443,-11435.957 834.771,-10268.3341 867.457,-10205.0235 896.596,-10148.5835 952.3247,-10175.3922 981.6013,-10119.0235 1037.5563,-10011.2886 971.3263,-9139.2572 1017.6013,-9027.0235 1062.2898,-8918.6378 1176.1697,-8828.3552 1226.9193,-8792.1001"/>
<polygon fill="#6500ff" stroke="#6500ff" points="1229.1896,-8794.7821 1235.3492,-8786.1617 1225.1583,-8789.0594 1229.1896,-8794.7821"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge736" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M223.963,-11118.8467C227.0744,-10835.2912 288.7067,-5251.0724 317.2024,-5223.0235 369.0732,-5171.9661 421.5493,-5180.9857 480.9653,-5223.0235 520.21,-5250.7897 495.1588,-5282.1797 516.9653,-5325.0235 565.896,-5421.1589 605.8334,-5428.7406 654.4731,-5525.0235 676.5283,-5568.682 670.7092,-5584.2811 690.4731,-5629.0235 756.9306,-5779.4726 788.7863,-5809.5852 867.457,-5954.0235 1098.9629,-6379.0646 1382.1653,-6898.8614 1440.5993,-7006.111"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1437.5485,-7007.8272 1445.4063,-7014.9338 1443.6953,-7004.4781 1437.5485,-7007.8272"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge739" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M924.5292,-14289.0235C965.6153,-14291.0617 1011.124,-14276.7856 1041.1533,-14264.9366"/>
<polygon fill="#ff00cb" stroke="#ff00cb" points="1042.7764,-14268.0547 1050.715,-14261.0383 1040.1337,-14261.5726 1042.7764,-14268.0547"/>
<path fill="none" stroke="#ff00cb" stroke-dasharray="5,2" d="M585.7192,-14375.0235C631.3078,-14345.8932 639.0899,-14329.9544 690.4731,-14313.0235 789.7908,-14280.2981 820.0873,-14283.8425 924.5292,-14289.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge785" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M399.0839,-16493.0235C403.1075,-16530.7322 457.5105,-16487.2241 480.9653,-16517.0235 584.1657,-16648.1398 415.6998,-17134.4073 516.9653,-17267.0235 599.5936,-17375.2325 1618.4008,-17528.8167 1728.717,-17449.0235 1765.639,-17422.3174 1742.8715,-17393.0137 1764.717,-17353.0235 1831.7177,-17230.3732 2058.5014,-16961.9096 2140.8962,-16849.0235 2226.5234,-16731.7088 2251.9236,-16705.0259 2330.7283,-16583.0235 2402.4394,-16472.003 2893.7645,-15682.3608 2929.166,-15555.0235 2964.527,-15427.8323 2960.7649,-13310.9653 2965.166,-13179.0235 2983.5437,-12628.0804 3026.3881,-11953.8312 3034.65,-11826.3528"/>
<polygon fill="#ff0066" stroke="#ff0066" points="3038.1458,-11826.529 3035.3019,-11816.323 3031.1605,-11826.0749 3038.1458,-11826.529"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M223.9604,-11141.3115C226.5322,-11380.2412 270.949,-15343.8295 399.0839,-16493.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-5007.0235C951.808,-5023.287 964.3952,-5023.3292 981.6013,-5050.0235 1021.3254,-5111.653 979.3781,-5148.4521 1017.6013,-5211.0235 1052.0122,-5267.3542 1093.6236,-5252.1496 1131.7661,-5306.0235 1158.3375,-5343.5539 1134.0109,-5371.796 1167.7661,-5403.0235 1196.3355,-5429.4535 1217.7878,-5408.4371 1251.9829,-5427.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-4854.0235C421.5861,-4833.5775 898.2336,-4991.7614 924.5292,-5007.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M223.92,-11119.0178C225.5159,-10900.9484 251.3386,-7510.6292 317.2024,-7080.0235 374.5609,-6705.0237 538.9233,-6268.2444 577.5307,-6168.8511"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="580.8638,-6169.9376 581.2388,-6159.3494 574.3427,-6167.3927 580.8638,-6169.9376"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M224.0066,-11118.7435C226.7027,-10935.2189 261.5967,-8548.5171 281.2024,-6624.0235 281.8687,-6558.6222 283.1591,-1970.87 317.2024,-1915.0235 359.9925,-1844.8282 422.3776,-1886.6938 480.9653,-1829.0235 504.7778,-1805.584 498.0554,-1790.5709 516.9653,-1763.0235 570.4132,-1685.1626 611.333,-1685.0349 654.4731,-1601.0235 684.6079,-1542.3388 644.5056,-1504.3414 690.4731,-1457.0235 761.4511,-1383.9605 1057.6339,-1402.884 1131.7661,-1333.0235 1167.3633,-1299.4775 1127.922,-1257.395 1167.7661,-1229.0235 1228.7457,-1185.6022 1262.635,-1215.1612 1336.1997,-1229.0235 1886.612,-1332.7419 2044.9629,-1521.3085 2330.7283,-2003.0235 2384.8237,-2094.2123 2425.6228,-2215.2449 2440.6994,-2263.1906"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="2437.3659,-2264.2577 2443.6734,-2272.7703 2444.0511,-2262.1822 2437.3659,-2264.2577"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M585.7192,-7325.0235C704.7699,-7181.6838 817.9224,-7276.0659 981.6013,-7187.0235 999.4069,-7177.3372 998.7891,-7166.571 1017.6013,-7159.0235 1066.1935,-7139.5282 1218.8337,-7094.4969 1251.9829,-7135.0235"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node44"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-3812.0289 354.6193,-3812.0289 354.6193,-3790.0181 443.5485,-3790.0181 443.5485,-3812.0289"/>
<text text-anchor="middle" x="399.0839" y="-3797.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M223.9858,-11118.6535C228.0766,-10798.4466 317.2024,-3822.0235 317.2024,-3822.0235 324.0773,-3813.2788 334.0593,-3807.8714 344.7057,-3804.5917"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="345.7333,-3807.943 354.5997,-3802.1432 344.0517,-3801.148 345.7333,-3807.943"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M223.9972,-11118.7434C226.5427,-10935.2172 259.5476,-8548.4951 281.2024,-6624.0235 281.778,-6572.8715 290.5295,-2984.6746 317.2024,-2941.0235 360.0672,-2870.8738 427.3636,-2917.3552 480.9653,-2855.0235 512.8574,-2817.9373 477.1212,-2779.395 516.9653,-2751.0235 559.5783,-2720.6804 948.4844,-2786.5285 981.6013,-2827.0235 1034.2766,-2891.4344 1002.7023,-3493.161 1017.6013,-3575.0235 1028.1914,-3633.2108 1052.8517,-3698.7497 1066.0249,-3731.3286"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="1062.834,-3732.7722 1069.8659,-3740.6969 1069.3107,-3730.1167 1062.834,-3732.7722"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge411" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M224.0101,-11118.7435C226.7628,-10935.2195 262.3648,-8548.5247 281.2024,-6624.0235 282.632,-6477.9715 282.8381,-1507.9824 317.2024,-1366.0235 395.3585,-1043.1607 506.8593,-996.612 654.4731,-699.0235 670.7256,-666.2586 662.0216,-648.0059 690.4731,-625.0235 804.2295,-533.1342 1823.3925,-328.5953 1968.5662,-311.0235 2044.6023,-301.8201 2065.9259,-295.3502 2140.8962,-311.0235 2231.0294,-329.8667 2252.1726,-345.9812 2330.7283,-394.0235 2570.2754,-540.5235 3185.8693,-941.5665 3308.7942,-1194.0235 3350.4165,-1279.5053 3342.511,-2809.9743 3344.7942,-2905.0235 3371.1404,-4001.8014 3410.4466,-5353.3379 3415.839,-5537.8101"/>
<polygon fill="#002eff" stroke="#002eff" points="3412.3416,-5537.9559 3416.1326,-5547.8493 3419.3386,-5537.7512 3412.3416,-5537.9559"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge419" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M399.0839,-2423.0235C528.5636,-2268.3481 678.942,-2417.0411 831.457,-2285.0235 859.1104,-2261.0867 845.0671,-2239.9435 867.457,-2211.0235 921.1382,-2141.6861 938.2483,-2120.3391 1017.6013,-2083.0235 1065.2269,-2060.6277 1123.4985,-2050.3686 1170.0245,-2045.713"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="1170.4358,-2049.1899 1180.0675,-2044.7761 1169.7856,-2042.2202 1170.4358,-2049.1899"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacostestimate.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge424" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacostestimate.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M224.0133,-11118.7435C226.8177,-10935.2201 263.0687,-8548.5315 281.2024,-6624.0235 281.9728,-6542.2617 280.8623,-810.2695 317.2024,-737.0235 327.385,-716.4999 347.7916,-700.7726 365.6843,-690.1649"/>
<polygon fill="#e700ff" stroke="#e700ff" points="367.7329,-693.029 374.7445,-685.0861 364.3101,-686.9229 367.7329,-693.029"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge426" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M585.7192,-1357.0235C604.8575,-1333.0314 666.424,-1286.09 690.4731,-1267.0235 837.4864,-1150.4693 1199.0027,-841.1385 1372.1997,-769.0235 1570.1547,-686.5999 1634.268,-688.1449 1848.6416,-693.0235"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node51" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node51"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-5171.0289 334.8633,-5171.0289 334.8633,-5149.0181 463.3044,-5149.0181 463.3044,-5171.0289"/>
<text text-anchor="middle" x="399.0839" y="-5156.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9713,-11118.7824C227.2927,-10833.5945 293.0066,-5217.1784 317.2024,-5185.0235 319.8164,-5181.5496 322.902,-5178.5432 326.3174,-5175.9428"/>
<polygon fill="#ff0000" stroke="#ff0000" points="328.2258,-5178.8771 334.8181,-5170.583 324.4924,-5172.9558 328.2258,-5178.8771"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M585.7192,-14375.0235C625.3404,-14350.5585 643.9095,-14376.579 690.4731,-14377.0235 753.1298,-14377.6216 768.8197,-14378.6911 831.457,-14377.0235 1322.5993,-14363.9482 1605.0065,-14645.2152 1932.5662,-14279.0235 1969.1098,-14238.17 1958.9611,-13840.9882 1968.5662,-13787.0235 2017.2594,-13513.4481 2091.5798,-13459.4873 2140.8962,-13186.0235 2159.2118,-13084.4624 2129.1434,-12814.5101 2176.8962,-12723.0235 2187.2071,-12703.2696 2206.678,-12687.4181 2223.4487,-12676.5565"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="2225.7289,-12679.2631 2232.4126,-12671.0425 2222.0613,-12673.3008 2225.7289,-12679.2631"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M399.0839,-2423.0235C447.7732,-2364.631 919.94,-2737.5462 981.6013,-2782.0235 1069.151,-2845.1745 1071.5671,-2889.0463 1167.7661,-2938.0235 1173.9012,-2941.147 1180.5289,-2943.8246 1187.2778,-2946.1157"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="1186.6211,-2949.5767 1197.2094,-2949.2031 1188.6991,-2942.8923 1186.6211,-2949.5767"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M399.0839,-3639.0235C526.5845,-3492.6315 695.0613,-3562.8815 831.457,-3701.0235 874.9145,-3745.0374 853.3304,-3916.8054 867.457,-3977.0235 903.0936,-4128.9323 940.8445,-4158.4076 981.6013,-4309.0235 1002.9117,-4387.7755 991.7573,-4411.6408 1017.6013,-4489.0235 1054.7649,-4600.2995 1098.8776,-4614.4099 1131.7661,-4727.0235 1150.3419,-4790.629 1127.7237,-4970.2285 1167.7661,-5023.0235 1223.3804,-5096.3496 1861.3871,-5282.6864 1932.5662,-5341.0235 2060.9545,-5446.2484 2084.8573,-5494.769 2140.8962,-5651.0235 2196.6724,-5806.5452 2116.5463,-5867.2189 2176.8962,-6021.0235 2189.7169,-6053.6977 2216.3512,-6084.8047 2234.6517,-6103.6504"/>
<polygon fill="#5cff00" stroke="#5cff00" points="2232.3825,-6106.3316 2241.92,-6110.9452 2237.3412,-6101.3909 2232.3825,-6106.3316"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M924.5292,-10371.0235C934.1594,-10334.83 963.7717,-10341.9601 981.6013,-10309.0235 1012.5962,-10251.7668 1000.1287,-10229.7429 1017.6013,-10167.0235 1079.1845,-9945.9661 1035.9657,-9860.8732 1167.7661,-9673.0235 1181.5193,-9653.4217 1203.2819,-9637.3703 1221.2389,-9626.3756"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1223.3734,-9629.1808 1230.2197,-9621.0951 1219.8254,-9623.1466 1223.3734,-9629.1808"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M585.7192,-11625.0235C691.3571,-11654.7342 756.5248,-11681.1936 831.457,-11601.0235 922.9981,-11503.0836 791.6192,-10505.5705 867.457,-10395.0235 883.0234,-10372.3328 916.6072,-10397.3754 924.5292,-10371.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M585.7192,-11625.0235C589.151,-11625.8068 829.2526,-11565.7677 831.457,-11563.0235 915.4133,-11458.5087 816.8689,-10481.172 867.457,-10357.0235 895.7231,-10287.6558 951.8837,-10301.7819 981.6013,-10233.0235 1069.9927,-10028.5102 922.5309,-9934.5187 1017.6013,-9733.0235 1056.9273,-9649.6749 1095.988,-9647.8286 1167.7661,-9590.0235 1202.9672,-9561.675 1231.7254,-9573.4264 1251.9829,-9533.0235"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M1251.9829,-9533.0235C1354.8293,-9326.0154 1214.7689,-9196.2727 1372.1997,-9027.0235 1375.3808,-9023.6036 1379.0248,-9020.6488 1382.9637,-9018.0963"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="1384.9198,-9021.0148 1391.9925,-9013.1263 1381.5442,-9014.8825 1384.9198,-9021.0148"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M399.0839,-11511.0235C496.1491,-11516.1213 490.8071,-11604.0632 585.7192,-11625.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M399.0839,-12024.0235C479.0542,-12089.8398 770.8632,-11934.0201 831.457,-11850.0235 907.3971,-11744.7536 814.4718,-11385.5191 867.457,-11267.0235 877.1477,-11245.3515 1149.4274,-10978.0992 1167.7661,-10963.0235 1332.0043,-10828.008 1363.1047,-10760.2889 1566.6973,-10699.0235 1635.6517,-10678.2737 1673.2172,-10653.1429 1728.717,-10699.0235 1794.2865,-10753.2285 1699.1476,-10832.8186 1764.717,-10887.0235 1822.2137,-10934.5549 1875.6811,-10935.2852 1932.5662,-10887.0235 2007.4483,-10823.493 1903.3695,-10742.4596 1968.5662,-10669.0235 1978.3022,-10658.0571 1992.5311,-10651.7755 2006.6314,-10648.2162"/>
<polygon fill="#002eff" stroke="#002eff" points="2007.7432,-10651.5591 2016.8098,-10646.0775 2006.3037,-10644.7087 2007.7432,-10651.5591"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M224.4556,-11141.265C229.1605,-11225.2676 260.7959,-11755.7488 317.2024,-11905.0235 339.8955,-11965.0786 351.6459,-11980.7657 399.0839,-12024.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M399.0839,-2955.0235C415.5545,-2939.7025 725.553,-3019.2581 831.457,-3095.0235 918.425,-3157.2417 943.5681,-3183.0835 981.6013,-3283.0235 1008.2754,-3353.1152 970.9776,-3898.2819 1017.6013,-3957.0235 1053.3459,-4002.0585 1117.055,-4018.456 1169.0371,-4023.9222"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="1168.9839,-4027.4323 1179.2654,-4024.875 1169.6332,-4020.4625 1168.9839,-4027.4323"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M223.9985,-11118.7434C226.5647,-10935.2175 259.8299,-8548.4983 281.2024,-6624.0235 285.8876,-6202.1417 273.099,-3246.6199 317.2024,-2827.0235 336.3535,-2644.8209 281.395,-2563.4297 399.0839,-2423.0235"/>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M399.0839,-2423.0235C439.919,-2374.3061 464.2963,-2377.6166 516.9653,-2342.0235 656.0158,-2248.0548 700.8483,-2238.4109 831.457,-2133.0235 848.8238,-2119.0103 848.4254,-2109.6757 867.457,-2098.0235 927.5618,-2061.2242 949.2512,-2064.2003 1017.6013,-2047.0235 1155.3526,-2012.4057 1235.2143,-1922.1448 1336.1997,-2022.0235 1400.7261,-2085.8428 1330.3598,-5208.4879 1372.1997,-5289.0235 1412.2031,-5366.0242 1490.2305,-5326.2653 1530.6973,-5403.0235 1571.1257,-5479.7089 1563.2469,-6876.4025 1566.6973,-6963.0235 1589.602,-7538.0489 1637.237,-8242.0005 1646.2265,-8372.64"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1642.7531,-8373.1472 1646.9331,-8382.8826 1649.7365,-8372.6654 1642.7531,-8373.1472"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M924.5292,-14289.0235C1016.5757,-14279.9603 1066.5113,-14335.5713 1131.7661,-14270.0235 1196.7628,-14204.735 1147.3994,-13946.8698 1167.7661,-13857.0235 1214.8848,-13649.1625 1292.7615,-13616.6846 1336.1997,-13408.0235 1352.0044,-13332.1035 1323.3369,-12771.2403 1372.1997,-12711.0235 1377.3075,-12704.7288 1384.065,-12700.1956 1391.4853,-12696.9515"/>
<polygon fill="#ff008b" stroke="#ff008b" points="1392.9233,-12700.1546 1401.1646,-12693.4964 1390.5699,-12693.562 1392.9233,-12700.1546"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node63" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node63"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1336.4171,-5707.0289 1167.5488,-5707.0289 1167.5488,-5685.0181 1336.4171,-5685.0181 1336.4171,-5707.0289"/>
<text text-anchor="middle" x="1251.9829" y="-5692.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-5083.0235C630.8837,-4964.4671 797.4624,-4960.9592 981.6013,-5145.0235 1027.6487,-5191.0523 990.3954,-5227.8724 1017.6013,-5287.0235 1054.4075,-5367.0475 1095.2217,-5368.8796 1131.7661,-5449.0235 1159.4941,-5509.8324 1137.5945,-5535.3893 1167.7661,-5595.0235 1184.2532,-5627.6103 1213.0176,-5658.9074 1232.2793,-5677.8035"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1230.0068,-5680.4739 1239.6426,-5684.8787 1234.8568,-5675.4263 1230.0068,-5680.4739"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9812,-11118.7039C227.554,-10831.523 298.1516,-5175.8151 317.2024,-5140.0235 338.0364,-5100.8817 360.5168,-5104.9032 399.0839,-5083.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-10371.0235C935.3738,-10335.1751 962.3892,-10341.1733 981.6013,-10309.0235 1006.6922,-10267.0361 983.0125,-10239.6083 1017.6013,-10205.0235 1133.2689,-10089.3694 1607.3618,-9905.3524 1728.717,-10015.0235 1787.5465,-10068.1889 1730.7273,-10298.3844 1764.717,-10370.0235 1777.8798,-10397.7663 1804.1386,-10421.6635 1823.7968,-10436.7976"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1821.9153,-10439.7603 1832.0265,-10442.9247 1826.0956,-10434.1455 1821.9153,-10439.7603"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9845,-11118.7432C226.3256,-10935.2146 256.769,-8548.4618 281.2024,-6624.0235 283.2077,-6466.0791 275.3961,-3933.3478 317.2024,-3781.0235 336.484,-3710.7697 348.7255,-3691.6676 399.0839,-3639.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3487.0235C607.167,-3481.1317 822.5662,-3480.6937 831.457,-3486.0235 952.905,-3558.8288 942.2335,-3631.0073 981.6013,-3767.0235 1042.8048,-3978.4822 932.9329,-4057.8194 1017.6013,-4261.0235 1047.3049,-4332.3121 1084.4251,-4331.0055 1131.7661,-4392.0235 1229.997,-4518.6336 1251.6991,-4552.8652 1336.1997,-4689.0235 1377.6129,-4755.7537 1421.362,-4838.0949 1440.9247,-4875.6387"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1437.8566,-4877.3251 1445.5708,-4884.5874 1444.0691,-4874.0995 1437.8566,-4877.3251"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-3639.0235C431.9802,-3604.634 449.9729,-3606.1383 480.9653,-3570.0235 500.9702,-3546.7123 493.068,-3530.3243 516.9653,-3511.0235 542.1443,-3490.6877 554.125,-3494.0469 585.7192,-3487.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-6617.0235C2339.1164,-6626.9565 2364.5289,-6593.2158 2447.0435,-6617.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9882,-11118.6555C227.7359,-10830.2378 301.7347,-5149.6053 317.2024,-5069.0235 336.4776,-4968.6059 325.6523,-4925.1785 399.0839,-4854.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-4854.0235C537.0939,-4720.2921 643.8762,-4816.2586 831.457,-4858.0235 899.7096,-4873.2199 925.3184,-4863.5316 981.6013,-4905.0235 1040.2635,-4948.2695 1113.8446,-5125.9935 1167.7661,-5175.0235 1244.7357,-5245.0107 1280.6443,-5239.6256 1372.1997,-5289.0235 1529.4866,-5373.8863 1624.7796,-5329.6349 1728.717,-5475.0235 1790.4225,-5561.3376 1736.4929,-5608.7441 1764.717,-5711.0235 1796.6356,-5826.6909 1894.3269,-6116.7564 1968.5662,-6211.0235 1997.7562,-6248.0883 2029.3511,-6233.2528 2054.7312,-6273.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2054.7312,-6273.0235C2078.0749,-6304.0128 2113.7933,-6259.262 2140.8962,-6287.0235 2222.6974,-6370.8123 2121.9593,-6444.612 2176.8962,-6548.0235 2198.4418,-6588.5801 2208.1961,-6611.7119 2253.8123,-6617.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge279" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M224.0091,-11118.7435C226.7457,-10935.2194 262.146,-8548.5226 281.2024,-6624.0235 281.9023,-6553.3447 289.278,-1599.9559 317.2024,-1535.0235 365.8525,-1421.8976 419.8526,-1418.7428 516.9653,-1343.0235 573.8109,-1298.7007 615.0718,-1317.3846 654.4731,-1257.0235 715.113,-1164.1259 631.5845,-1104.041 690.4731,-1010.0235 924.8329,-635.8611 1127.8107,-589.9883 1566.6973,-542.0235 1820.3925,-514.2978 1903.3955,-444.6247 2140.8962,-538.0235 2706.8275,-760.5799 2883.3432,-941.4942 3106.9189,-1507.0235 3137.8104,-1585.1626 3139.1975,-2935.0822 3142.9189,-3019.0235 3165.5525,-3529.5432 3214.3963,-4153.4948 3224.1439,-4275.702"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3220.6767,-4276.2525 3224.963,-4285.9415 3227.6544,-4275.6943 3220.6767,-4276.2525"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge308" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-5311.0235C708.637,-5365.2292 727.8704,-5401.485 831.457,-5487.0235 990.3121,-5618.2009 1014.4482,-5668.4152 1167.7661,-5806.0235 1240.8471,-5871.6163 1265.2553,-5881.1256 1336.1997,-5949.0235 1617.7889,-6218.521 1710.7013,-6271.5593 1932.5662,-6592.0235 2050.4942,-6762.3601 2052.5073,-6821.6497 2140.8962,-7009.0235 2157.7039,-7044.6536 2146.3117,-7065.1924 2176.8962,-7090.0235 2231.1826,-7134.0977 2265.2912,-7098.3754 2330.7283,-7123.0235 2392.5909,-7146.3253 2788.6568,-7437.1188 2850.2146,-7413.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2850.2146,-7413.0235C2968.8504,-7346.2599 3017.8777,-7171.1099 3031.6808,-7110.2363"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3035.1471,-7110.7677 3033.8571,-7100.2517 3028.3077,-7109.2769 3035.1471,-7110.7677"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge315" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.2437,-11118.8381C232.0683,-10904.0394 353.7479,-7663.7993 585.7192,-7325.0235"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-7325.0235C704.1478,-7139.5868 802.2862,-7128.3167 1017.6013,-7083.0235 1157.1501,-7053.6683 1222.2857,-7035.2378 1336.1997,-7121.0235 1364.7792,-7142.5459 1344.8499,-7169.9587 1372.1997,-7193.0235 1400.3326,-7216.7487 1432.9045,-7185.2357 1451.4485,-7217.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge364" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-1357.0235C611.5013,-1324.9558 633.2541,-1330.277 654.4731,-1295.0235 688.2709,-1238.8717 654.5758,-1206.8568 690.4731,-1152.0235 763.905,-1039.8559 1050.1471,-847.3631 1167.7661,-783.0235 1551.6897,-573.0108 1783.5424,-380.4351 2140.8962,-633.0235 2386.5267,-806.6425 2228.6338,-1003.8012 2366.7283,-1271.0235 2423.6363,-1381.1445 2482.0564,-1383.6421 2527.3586,-1499.0235 2570.9591,-1610.0708 2538.3888,-1648.3659 2563.3586,-1765.0235 2619.8105,-2028.7637 2689.5363,-2081.2139 2735.2632,-2347.0235 2785.9713,-2641.7886 2750.1625,-2720.6738 2771.2632,-3019.0235 2796.0623,-3369.6669 2838.1206,-3796.2838 2848.0628,-3895.6422"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2844.609,-3896.2793 2849.0896,-3905.88 2851.5741,-3895.5806 2844.609,-3896.2793"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M224.0084,-11118.7435C226.7335,-10935.2192 261.99,-8548.521 281.2024,-6624.0235 281.8922,-6554.9279 281.2483,-1708.0318 317.2024,-1649.0235 359.9782,-1578.8194 423.2174,-1621.5346 480.9653,-1563.0235 553.1162,-1489.9191 520.4062,-1436.2965 585.7192,-1357.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge379" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M399.0839,-12024.0235C545.2825,-12157.3394 726.429,-12085.7026 831.457,-11918.0235 894.9449,-11816.6641 806.8982,-11484.1597 867.457,-11381.0235 961.2647,-11221.262 1389.0579,-10979.6338 1566.6973,-10927.0235 1635.7417,-10906.5751 1667.6693,-10888.8339 1728.717,-10927.0235 1759.724,-10946.4205 1733.71,-10981.6265 1764.717,-11001.0235 1827.9612,-11040.5871 1863.1445,-11028.3316 1932.5662,-11001.0235 2114.0777,-10929.6232 2120.0627,-10843.9936 2253.8123,-10702.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2955.0235C425.7607,-2929.5005 448.5185,-2951.4088 480.9653,-2969.0235 501.6965,-2980.278 499.2872,-2992.4053 516.9653,-3008.0235 612.1657,-3092.1304 920.5115,-3229.6453 981.6013,-3341.0235 1052.3451,-3470.0028 929.0046,-3884.5885 1017.6013,-4002.0235 1082.3777,-4087.8846 1834.4523,-4273.9579 1932.5662,-4318.0235 2029.4382,-4361.5313 2083.6234,-4345.5979 2140.8962,-4435.0235 2194.762,-4519.1293 2136.8757,-4791.5158 2176.8962,-4883.0235 2217.332,-4975.4806 2266.9977,-4971.7817 2330.7283,-5050.0235 2370.7572,-5099.167 2413.0156,-5160.8655 2433.8461,-5192.0335"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2431.1439,-5194.2908 2439.5966,-5200.6785 2436.9723,-5190.4138 2431.1439,-5194.2908"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.9874,-11118.7433C226.3751,-10935.2152 257.4027,-8548.4698 281.2024,-6624.0235 282.2326,-6540.7183 286.3408,-3702.4081 317.2024,-3625.0235 382.2712,-3461.8652 410.0645,-3335.0235 585.7192,-3335.0235 585.7192,-3335.0235 585.7192,-3335.0235 760.9651,-3335.0235 868.6274,-3335.0235 920.7307,-3346.2207 981.6013,-3435.0235 1061.6369,-3551.7857 952.4072,-3945.3699 1017.6013,-4071.0235 1171.3539,-4367.3626 1406.7193,-4224.8523 1728.717,-4313.0235 1880.14,-4354.487 2020.4623,-4295.8119 2054.7312,-4449.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-3639.0235C436.1372,-3600.2883 801.5128,-3808.5633 831.457,-3853.0235 891.7059,-3942.4789 844.8207,-4231.5731 867.457,-4337.0235 898.6225,-4482.2064 931.9481,-4511.0809 981.6013,-4651.0235 997.9572,-4697.121 1000.2457,-4709.293 1017.6013,-4755.0235 1064.7031,-4879.1326 1090.1857,-4904.9572 1131.7661,-5031.0235 1152.4299,-5093.6734 1132.5837,-5119.2185 1167.7661,-5175.0235 1279.3754,-5352.0538 1372.1344,-5338.4433 1530.6973,-5475.0235 1565.4753,-5504.98 1605.0556,-5540.8907 1628.1204,-5562.0051"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1625.8191,-5564.6436 1635.555,-5568.8224 1630.55,-5559.4843 1625.8191,-5564.6436"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-2955.0235C458.4017,-2897.0413 503.2425,-2963.8629 585.7192,-2955.0235"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M585.7192,-2955.0235C762.1677,-2936.1129 853.6413,-2780.0686 981.6013,-2903.0235 1053.9259,-2972.5191 945.2767,-3735.5279 1017.6013,-3805.0235 1054.1883,-3840.1794 1093.7347,-3838.6114 1131.7661,-3805.0235 1180.2751,-3762.1823 1138.5111,-3573.7525 1167.7661,-3516.0235 1224.2491,-3404.5653 1256.0825,-3369.176 1372.1997,-3323.0235 1540.864,-3255.9854 2041.7473,-3446.9997 2140.8962,-3599.0235 2200.2988,-3690.1047 2140.2413,-4474.6474 2176.8962,-4577.0235 2188.6628,-4609.8871 2215.3087,-4640.7442 2233.9202,-4659.4996"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2231.7454,-4662.2688 2241.3378,-4666.7672 2236.6444,-4657.2687 2231.7454,-4662.2688"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-4854.0235C438.3801,-4818.3181 503.8376,-4828.3221 545.8649,-4840.1483"/>
<polygon fill="#00ffff" stroke="#00ffff" points="544.9129,-4843.5165 555.4954,-4843.005 546.9037,-4836.8056 544.9129,-4843.5165"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M224.0036,-11118.7434C226.6523,-10935.2184 260.951,-8548.5104 281.2024,-6624.0235 282.4678,-6503.776 287.8995,-2411.6529 317.2024,-2295.0235 318.6553,-2289.2406 513.3072,-1919.7321 516.9653,-1915.0235 567.4532,-1850.0374 610.0515,-1860.298 654.4731,-1791.0235 683.3829,-1745.9394 671.984,-1726.2878 690.4731,-1676.0235 710.0899,-1622.6937 737.3204,-1561.5504 751.5107,-1530.474"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="754.8032,-1531.6909 755.7933,-1521.1424 748.4411,-1528.7711 754.8032,-1531.6909"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge251" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-2955.0235C775.3362,-2939.1754 884.8674,-2954.169 981.6013,-3118.0235 1021.9842,-3186.4268 960.0361,-3777.2876 1017.6013,-3832.0235 1233.7864,-4037.5831 1083.0857,-3641.0765 1167.7661,-3560.0235 1290.5475,-3442.5016 1792.1008,-3458.3358 1932.5662,-3554.0235 2114.7117,-3678.1046 2087.9302,-3790.0896 2140.8962,-4004.0235 2159.4529,-4078.9753 2127.7328,-4638.4829 2176.8962,-4698.0235 2199.3164,-4725.1759 2235.0716,-4687.2124 2253.8123,-4717.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-4717.0235C2272.648,-4746.2218 2300.6656,-4713.6005 2330.7283,-4731.0235 2400.1288,-4771.2451 2367.1698,-4861.6465 2447.0435,-4869.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-4869.0235C2582.9234,-4881.5731 2741.1095,-4832.2639 2812.2014,-4806.6172"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2813.4537,-4809.886 2821.6433,-4803.1643 2811.0495,-4803.3118 2813.4537,-4809.886"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge263" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.0074,-11118.7435C226.7163,-10935.2191 261.7706,-8548.5188 281.2024,-6624.0235 281.8787,-6557.0389 291.3547,-1862.8239 317.2024,-1801.0235 365.6787,-1685.1192 408.4288,-1664.2973 516.9653,-1601.0235 571.7421,-1569.0902 610.7347,-1608.9275 654.4731,-1563.0235 704.7536,-1510.2536 646.267,-1460.977 690.4731,-1403.0235 790.3481,-1272.0892 868.8498,-1299.676 1017.6013,-1229.0235 1067.3203,-1205.4085 1086.5682,-1212.4369 1131.7661,-1181.0235 1195.853,-1136.4819 1310.8196,-973.2268 1372.1997,-925.0235 1450.3042,-863.6862 1474.2472,-851.2942 1566.6973,-815.0235 1719.3165,-755.1469 1772.3584,-733.2195 1932.5662,-768.0235 2032.0102,-789.627 2053.1779,-811.4354 2140.8962,-863.0235 2324.8566,-971.2127 2405.0909,-973.1038 2527.3586,-1148.0235 2559.9915,-1194.709 2533.8451,-1222.306 2563.3586,-1271.0235 2680.2661,-1464.0005 2823.6048,-1423.6136 2929.166,-1623.0235 2987.0952,-1732.4544 3025.645,-2131.7444 3034.2285,-2228.0279"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3030.743,-2228.3482 3035.1064,-2238.0028 3037.7161,-2227.7344 3030.743,-2228.3482"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5311.0235C630.0693,-5326.495 643.6055,-5300.1415 690.4731,-5297.0235 752.9944,-5292.8641 773.6411,-5272.8671 831.457,-5297.0235 919.0735,-5333.631 931.4637,-5368.3825 981.6013,-5449.0235 1007.4277,-5490.5625 992.8409,-5510.8404 1017.6013,-5553.0235 1056.1894,-5618.7642 1088.2461,-5618.4384 1131.7661,-5681.0235 1151.2891,-5709.099 1142.7349,-5725.725 1167.7661,-5749.0235 1296.8026,-5869.1274 1388.5587,-5804.7547 1530.6973,-5909.0235 1749.0517,-6069.2021 1784.6694,-6140.1703 1932.5662,-6367.0235 1947.5567,-6390.0169 2132.9088,-6788.763 2140.8962,-6815.0235 2171.0048,-6914.0127 2109.7754,-6966.2823 2176.8962,-7045.0235 2182.4611,-7051.5518 2189.7505,-7056.388 2197.6243,-7059.9679"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2196.4783,-7063.2773 2207.0676,-7063.6194 2199.0029,-7056.7484 2196.4783,-7063.2773"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-5083.0235C431.196,-5064.8058 454.0471,-5071.7553 480.9653,-5097.0235 531.5827,-5144.5381 481.583,-5189.2921 516.9653,-5249.0235 537.9359,-5284.4254 548.0708,-5294.4209 585.7192,-5311.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M226.3116,-11141.1949C240.6628,-11204.6633 315.557,-11516.8288 399.0839,-11511.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-11511.0235C621.6351,-11495.5558 572.3155,-7695.2511 690.4731,-7506.0235 802.0021,-7327.4115 1072.5944,-7271.0227 1192.7746,-7254.4338"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1193.4431,-7257.8757 1202.8918,-7253.0827 1192.5165,-7250.9373 1193.4431,-7257.8757"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge223" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.9917,-11118.7433C226.4494,-10935.2161 258.3533,-8548.4813 281.2024,-6624.0235 285.5136,-6260.916 278.7029,-3717.11 317.2024,-3356.0235 336.4874,-3175.1489 269.0051,-3082.1732 399.0839,-2955.0235"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-2955.0235C428.4783,-2926.2909 454.9283,-2943.8302 480.9653,-2912.0235 517.0457,-2867.948 471.3813,-2823.1782 516.9653,-2789.0235 565.8742,-2752.3777 593.6611,-2782.9501 654.4731,-2789.0235 672.9214,-2790.866 969.5801,-2840.909 981.6013,-2855.0235 1047.7166,-2932.6516 944.0989,-3701.35 1017.6013,-3772.0235 1054.1768,-3807.1913 1094.6739,-3806.6458 1131.7661,-3772.0235 1216.7667,-3692.6831 1111.7634,-3351.9239 1167.7661,-3250.0235 1212.5381,-3168.558 1275.7098,-3196.6077 1336.1997,-3126.0235 1358.708,-3099.7591 1352.8527,-3085.6964 1372.1997,-3057.0235 1446.6997,-2946.6122 1445.7536,-2884.8226 1566.6973,-2829.0235 1632.0826,-2798.857 1659.8193,-2808.0864 1728.717,-2829.0235 1939.6597,-2893.1263 2023.7433,-2918.2585 2140.8962,-3105.0235 2201.9508,-3202.3566 2154.1278,-3248.4048 2176.8962,-3361.0235 2197.5325,-3463.0962 2232.8479,-3582.611 2247.3285,-3630.0701"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2244.0366,-3631.2734 2250.3163,-3639.8066 2250.7286,-3629.2198 2244.0366,-3631.2734"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge338" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.0061,-11118.7435C226.6946,-10935.2188 261.4921,-8548.516 281.2024,-6624.0235 281.8628,-6559.5388 276.8903,-2031.3589 317.2024,-1981.0235 363.9089,-1922.7038 428.0122,-1995.7363 480.9653,-1943.0235 530.1674,-1894.0448 477.8003,-1848.3459 516.9653,-1791.0235 558.8703,-1729.691 614.4125,-1758.5763 654.4731,-1696.0235 704.5983,-1617.7554 620.3435,-1551.0174 690.4731,-1490.0235 788.1246,-1405.0932 852.1843,-1483.5926 981.6013,-1484.0235 1048.3423,-1484.2457 1065.451,-1477.4924 1131.7661,-1485.0235 1312.2674,-1505.5221 1361.5533,-1507.7573 1530.6973,-1574.0235 1723.1366,-1649.4162 1766.6085,-1684.8366 1932.5662,-1808.0235 2034.1577,-1883.4328 2088.5749,-1886.8286 2140.8962,-2002.0235 2193.1206,-2117.0047 2097.4739,-3039.8392 2176.8962,-3138.0235 2199.0417,-3165.4004 2236.8289,-3126.1774 2253.8123,-3157.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge484" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-13965.0235C488.9285,-14054.6111 410.3226,-14156.2826 516.9653,-14225.0235 568.3331,-14258.1347 605.2487,-14261.2443 654.4731,-14225.0235 681.0947,-14205.4346 823.2886,-13689.0502 831.457,-13657.0235 851.6197,-13577.9699 836.1837,-13552.3759 867.457,-13477.0235 1011.1241,-13130.8616 1205.4905,-13127.2832 1336.1997,-12776.0235 1381.6489,-12653.8864 1315.6587,-12602.4383 1372.1997,-12485.0235 1415.9024,-12394.2692 1487.0135,-12413.7869 1530.6973,-12323.0235 1587.405,-12205.1995 1486.6672,-12134.4327 1566.6973,-12031.0235 1614.083,-11969.7949 1666.1859,-12012.6766 1728.717,-11967.0235 1749.124,-11952.1247 1741.884,-11933.8436 1764.717,-11923.0235 1832.1304,-11891.0777 1868.418,-11884.9431 1932.5662,-11923.0235 1961.2982,-11940.0798 1942.5203,-11968.0937 1968.5662,-11989.0235 1973.4266,-11992.9293 1978.874,-11996.2248 1984.6057,-11999.0055"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1983.2345,-12002.2257 1993.8035,-12002.9651 1986.0024,-11995.7962 1983.2345,-12002.2257"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge588" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-16493.0235C403.2862,-16530.7127 457.5526,-16487.191 480.9653,-16517.0235 535.6935,-16586.7581 464.1024,-17242.8645 516.9653,-17314.0235 693.7984,-17552.0593 873.5696,-17423.8832 1167.7661,-17461.0235 1415.1914,-17492.2592 1500.3852,-17575.3207 1728.717,-17475.0235 1734.2253,-17472.6039 2327.3416,-16856.996 2330.7283,-16852.0235 2352.4487,-16820.1329 2336.1969,-16796.6164 2366.7283,-16773.0235 2395.3994,-16750.8681 2424.6995,-16787.5479 2447.0435,-16759.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadefineequip.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge593" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadefineequip.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-17671.0235C680.1583,-17726.9104 731.975,-17648.7049 831.457,-17695.0235 849.4949,-17703.4219 886.7555,-17743.3239 908.2587,-17767.4152"/>
<polygon fill="#00ffff" stroke="#00ffff" points="905.6465,-17769.7447 914.8965,-17774.9108 910.887,-17765.1039 905.6465,-17769.7447"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge561" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-14375.0235C609.295,-14361.1626 804.1606,-14362.71 831.457,-14361.0235 898.2084,-14356.8992 914.9911,-14357.0089 981.6013,-14351.0235 1048.498,-14345.0123 1065.726,-14346.2713 1131.7661,-14334.0235 1276.0967,-14307.256 1304.6651,-14252.5876 1451.4485,-14251.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge667" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-10111.0235C2564.6228,-10043.7558 2520.7595,-9840.3107 2649.3109,-9883.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-11511.0235C476.3197,-11515.0079 446.4087,-11607.3533 516.9653,-11639.0235 644.4883,-11696.2638 731.0167,-11739.2362 831.457,-11642.0235 875.4722,-11599.4227 839.4473,-10594.4994 867.457,-10540.0235 905.8927,-10465.2703 949.9984,-10474.9753 1017.6013,-10425.0235 1083.5105,-10376.3232 1089.7115,-10342.9878 1167.7661,-10318.0235 1239.0675,-10295.2191 1261.3958,-10315.1433 1336.1997,-10318.0235 1511.3377,-10324.767 1594.1196,-10243.7635 1728.717,-10356.0235 1770.8246,-10391.143 1720.6505,-10441.3959 1764.717,-10474.0235 1824.6713,-10518.4148 1866.1621,-10508.0176 1932.5662,-10474.0235 2097.8843,-10389.3926 2015.4885,-10226.8932 2176.8962,-10135.0235 2281.6542,-10075.3976 2342.4174,-10170.8805 2447.0435,-10111.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge683" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-13965.0235C407.4529,-13972.8912 1332.1584,-12612.7757 1336.1997,-12602.0235 1360.3666,-12537.7255 1328.1205,-12347.7046 1372.1997,-12295.0235 1395.8157,-12266.7989 1432.1921,-12302.3849 1451.4485,-12271.0235"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.1091,-11141.2899C228.6838,-11331.1313 291.5435,-13857.7908 399.0839,-13965.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge633" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-11511.0235C452.3901,-11513.8231 463.8332,-11528.8886 516.9653,-11534.0235 586.5972,-11540.753 783.2672,-11570.7346 831.457,-11520.0235 880.7296,-11468.1731 828.9902,-10293.3274 867.457,-10233.0235 897.9519,-10185.2171 950.2508,-10223.2732 981.6013,-10176.0235 1050.7909,-10071.7449 982.0993,-9734.027 1017.6013,-9614.0235 1108.9716,-9305.1747 1094.2646,-9144.7754 1372.1997,-8982.0235 1440.859,-8941.8183 1672.8085,-8958.4127 1728.717,-9015.0235 1802.6555,-9089.8908 1695.1403,-9170.0863 1764.717,-9249.0235 1816.0217,-9307.2304 1872.2937,-9248.162 1932.5662,-9297.0235 1959.13,-9318.5582 1941.9283,-9343.5804 1968.5662,-9365.0235 1999.5329,-9389.9513 2019.4698,-9370.6669 2054.7312,-9389.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2054.7312,-9389.0235C2099.9508,-9412.5642 2203.0377,-9507.597 2253.8123,-9503.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-9503.0235C2345.7245,-9494.7445 2356.5382,-9408.9899 2447.0435,-9427.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge646" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-14591.0235C495.4963,-14673.4928 481.4161,-14447.2551 585.7192,-14375.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.9596,-11141.2158C226.2304,-11352.7905 260.8797,-14493.9131 317.2024,-14567.0235 340.346,-14597.0654 370.2656,-14566.373 399.0839,-14591.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-14375.0235C708.121,-14290.2584 2264.3147,-12474.2772 2330.7283,-12341.0235 2363.6286,-12275.0116 2313.3867,-12229.9615 2366.7283,-12179.0235 2392.9331,-12153.9995 2425.9818,-12194.5074 2447.0435,-12165.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge656" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M224.4589,-11141.1308C228.5108,-11210.6114 253.1248,-11585.4662 317.2024,-11677.0235 449.6778,-11866.3111 681.2374,-11928.5615 831.457,-11753.0235 877.6215,-11699.0784 857.5512,-11185.3308 867.457,-11115.0235 879.6163,-11028.7225 906.3715,-10928.2424 918.4274,-10885.272"/>
<polygon fill="#0000ff" stroke="#0000ff" points="921.8643,-10885.9804 921.2222,-10875.405 915.1293,-10884.0726 921.8643,-10885.9804"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datagenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge675" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datagenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-14821.0235C631.1722,-14818.3495 681.8144,-14806.0283 716.9234,-14795.9405"/>
<polygon fill="#ff0000" stroke="#ff0000" points="718.2359,-14799.203 726.8465,-14793.0298 716.2656,-14792.486 718.2359,-14799.203"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-14783.0235C401.6255,-14793.2951 575.1561,-14821.6449 585.7192,-14821.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8511,-11141.0696C224.0852,-11353.1316 229.0744,-14549.3851 317.2024,-14721.0235 338.0523,-14761.6308 388.1195,-14738.7126 399.0839,-14783.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge749" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-14257.0235C2286.3407,-14179.4193 2309.3784,-14165.4157 2330.7283,-14084.0235 2373.6591,-13920.3578 2341.1031,-13872.2745 2366.7283,-13705.0235 2387.7797,-13567.6248 2427.3633,-13405.0335 2441.6931,-13348.025"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2445.1521,-13348.6226 2444.2094,-13338.0698 2438.3655,-13346.9072 2445.1521,-13348.6226"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-14591.0235C553.9582,-14727.836 646.0382,-14670.7898 831.457,-14762.0235 950.4849,-14820.5901 942.0275,-14935.0235 1074.6837,-14935.0235 1074.6837,-14935.0235 1074.6837,-14935.0235 1251.9829,-14935.0235 1586.8011,-14935.0235 1655.8019,-14800.4506 1932.5662,-14612.0235 1935.8422,-14609.7931 2138.8633,-14420.4257 2140.8962,-14417.0235 2172.9683,-14363.3494 2133.6597,-14326.1913 2176.8962,-14281.0235 2201.6589,-14255.1547 2239.9689,-14290.05 2253.8123,-14257.0235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge844" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.0274,-11141.1437C226.7746,-11304.8173 259.214,-13242.986 281.2024,-14807.0235 281.7639,-14846.9671 293.2342,-17651.0652 317.2024,-17683.0235 321.065,-17688.1737 325.9644,-17692.2968 331.4392,-17695.5929"/>
<polygon fill="#ff0000" stroke="#ff0000" points="329.9431,-17698.7581 340.4499,-17700.1206 333.086,-17692.5033 329.9431,-17698.7581"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge847" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M224.0089,-11141.0885C228.1179,-11411.0444 306.1825,-16530.4022 317.2024,-16545.0235 319.5311,-16548.1133 322.2329,-16550.8333 325.2078,-16553.2266"/>
<polygon fill="#00ff00" stroke="#00ff00" points="323.3839,-16556.2168 333.6517,-16558.8288 327.2538,-16550.3838 323.3839,-16556.2168"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge849" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M224.008,-11141.181C228.0957,-11413.3932 305.7612,-16575.5351 317.2024,-16590.0235 318.1688,-16591.2472 319.1959,-16592.4056 320.2772,-16593.5018"/>
<polygon fill="#0000ff" stroke="#0000ff" points="318.1572,-16596.2888 328.1282,-16599.8709 322.5673,-16590.8527 318.1572,-16596.2888"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~tarcogcomplexfenestration.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge931" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~tarcogcomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.0383,-11141.1435C226.9437,-11304.8151 261.1824,-13242.9596 281.2024,-14807.0235 281.8424,-14857.0219 287.2516,-18366.9835 317.2024,-18407.0235 319.5199,-18410.1217 322.2128,-18412.8484 325.1807,-18415.247"/>
<polygon fill="#ff0000" stroke="#ff0000" points="323.3469,-18418.2308 333.6103,-18420.8599 327.2265,-18412.4042 323.3469,-18418.2308"/>
</g>
<!-- sourcefile~windowcomplexmanager.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge981" class="edge">
<title>sourcefile~windowcomplexmanager.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2074.8555,-17698.929C2149.1253,-17658.1649 2405.6634,-17519.0235 2447.0435,-17519.0235 2447.0435,-17519.0235 2447.0435,-17519.0235 3587.3328,-17519.0235 3752.8172,-17519.0235 3884.3479,-17291.9251 3951.8339,-17443.0235"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-6615.0289 166.6166,-6615.0289 166.6166,-6593.0181 281.0645,-6593.0181 281.0645,-6615.0289"/>
<text text-anchor="middle" x="223.8406" y="-6600.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge982" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9977,-6615.3036C226.5509,-6798.8297 259.6536,-9185.5507 281.2024,-11110.0235 281.7817,-11161.7588 290.2278,-14790.8732 317.2024,-14835.0235 360.0634,-14905.1756 438.0568,-14850.9005 480.9653,-14921.0235 528.3344,-14998.4363 488.6321,-18101.8041 516.9653,-18188.0235 549.6206,-18287.3953 601.9757,-18288.5518 654.4731,-18379.0235 673.8384,-18412.3968 665.9611,-18428.225 690.4731,-18458.0235 739.4398,-18517.5507 775.5261,-18505.9862 831.457,-18559.0235 850.0422,-18576.6471 846.8844,-18588.7668 867.457,-18604.0235 1083.9169,-18764.5501 1785.2434,-18851.0235 2054.7312,-18851.0235 2054.7312,-18851.0235 2054.7312,-18851.0235 2447.0435,-18851.0235 2626.2306,-18851.0235 2671.1401,-18857.3769 2850.2146,-18851.0235"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge820" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ffc700" stroke-dasharray="5,2" d="M225.3029,-6592.9418C240.8325,-6475.2582 375.2368,-5456.7374 396.3093,-5297.0489"/>
<polygon fill="#ffc700" stroke="#ffc700" points="399.7891,-5297.4317 397.6275,-5287.0597 392.8493,-5296.5159 399.7891,-5297.4317"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge823" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#f3ff00" stroke-dasharray="5,2" d="M223.9081,-6592.6761C225.3552,-6352.8197 250.2699,-2389.8856 317.2024,-2295.0235 405.7881,-2169.4729 509.6819,-2167.5855 654.4731,-2219.0235 930.3501,-2317.0306 974.9956,-2425.7656 1131.7661,-2673.0235 1181.689,-2751.7617 1225.8926,-2854.2081 1243.6733,-2897.3951"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="1240.5017,-2898.8866 1247.521,-2906.8226 1246.9827,-2896.2415 1240.5017,-2898.8866"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge882" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#009bff" stroke-dasharray="5,2" d="M224.3536,-6615.1136C230.556,-6742.9532 296.0732,-7933.0235 585.7192,-7933.0235 585.7192,-7933.0235 585.7192,-7933.0235 760.9651,-7933.0235 902.7695,-7933.0235 1023.2961,-8087.5508 1061.8141,-8142.7303"/>
<polygon fill="#009bff" stroke="#009bff" points="1058.9301,-8144.7133 1067.4741,-8150.9784 1064.7018,-8140.7526 1058.9301,-8144.7133"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge897" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0058ff" stroke-dasharray="5,2" d="M224.3001,-6615.1515C229.0141,-6728.1916 269.3901,-7670.069 317.2024,-7947.0235 430.5215,-8603.4282 704.4861,-9378.588 753.4211,-9514.2636"/>
<polygon fill="#0058ff" stroke="#0058ff" points="750.2011,-9515.6512 756.894,-9523.8643 756.7836,-9513.27 750.2011,-9515.6512"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge918" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M223.9949,-6615.3037C226.5031,-6798.8303 259.0417,-9185.5577 281.2024,-11110.0235 282.3203,-11207.1056 279.6192,-14515.5044 317.2024,-14605.0235 357.0763,-14699.9988 441.0566,-14674.0628 480.9653,-14769.0235 551.204,-14936.1527 472.3246,-17856.3168 516.9653,-18032.0235 557.5748,-18191.8631 586.8816,-18231.7012 690.4731,-18360.0235 809.7813,-18507.8145 839.1471,-18569.9797 1017.6013,-18635.0235 1228.8905,-18712.0352 2324.9462,-18561.9443 2330.7283,-18561.0235 2512.8179,-18532.0253 2557.246,-18517.059 2735.2632,-18469.0235 2786.9508,-18455.0763 2797.4932,-18423.7177 2850.2146,-18433.0235"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge958" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M224.2346,-6592.8545C228.7373,-6466.5239 271.1636,-5310.0252 317.2024,-5256.0235 341.4396,-5227.5942 392.3866,-5200.2701 399.0839,-5237.0235"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge457" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.985,-6615.3038C226.3342,-6798.8323 256.8794,-9185.5838 281.2024,-11110.0235 285.2314,-11428.8009 269.2277,-13663.851 317.2024,-13979.0235 356.7019,-14238.5179 579.9597,-14859.3386 654.4731,-15111.0235 749.6895,-15432.6369 711.3955,-15538.1293 867.457,-15835.0235 1237.5137,-16539.0261 1593.1266,-16627.3561 2366.7283,-16812.0235 2497.2897,-16843.19 2875.7307,-16799.9261 2929.166,-16776.0235 3140.032,-16681.6994 3191.1308,-16619.8119 3308.7942,-16421.0235 3341.7383,-16365.3656 3297.7747,-16324.4339 3344.7942,-16280.0235 3368.3876,-16257.7393 3405.5133,-16296.5752 3416.4602,-16266.0235"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.913,-6592.9012C225.2014,-6400.2157 244.1295,-3766.8198 317.2024,-3625.0235 368.3079,-3525.8545 411.2506,-3508.6699 516.9653,-3473.0235 574.8763,-3453.4963 600.6031,-3444.1616 654.4731,-3473.0235 779.6399,-3540.084 774.2358,-3609.0637 831.457,-3739.0235 1082.3657,-4308.8827 944.1233,-4517.9224 1167.7661,-5099.0235 1224.6476,-5246.8213 1278.8849,-5265.3933 1336.1997,-5413.0235 1359.7631,-5473.7176 1327.4991,-5507.6857 1372.1997,-5555.0235 1376.8581,-5559.9568 1382.4797,-5563.9212 1388.5532,-5567.1062"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1387.1607,-5570.3176 1397.7155,-5571.2371 1390.0378,-5563.9362 1387.1607,-5570.3176"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge983" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.331,-6553.7403C599.0552,-6506.8036 639.8306,-6322.2684 654.4731,-6168.0235 675.6983,-5944.4375 634.3449,-4364.488 690.4731,-4147.0235 723.9118,-4017.4682 795.5942,-4009.9288 831.457,-3881.0235 909.007,-3602.2785 819.8357,-3516.4092 867.457,-3231.0235 898.1671,-3046.9836 946.6651,-3010.3082 981.6013,-2827.0235 1011.2125,-2671.6756 977.156,-2625.9089 1017.6013,-2473.0235 1020.2418,-2463.0423 1160.4039,-2140.2619 1167.7661,-2133.0235 1225.6957,-2076.0687 1289.6384,-2128.5947 1336.1997,-2062.0235 1383.1898,-1994.8393 1348.1745,-1403.4109 1372.1997,-1325.0235 1579.036,-650.1746 1951.2674,-276.4411 2649.3109,-381.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2649.3109,-381.0235C2914.2748,-376.7672 2963.2233,-497.6998 3225.8566,-533.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge815" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3587.3328,-1179.0235C3689.2977,-1373.4127 3770.1489,-16652.8584 3773.5612,-17306.4394"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3770.0631,-17306.8371 3773.6153,-17316.8187 3777.063,-17306.8006 3770.0631,-17306.8371"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.328,-6553.74C599.0408,-6506.8023 639.7769,-6322.2633 654.4731,-6168.0235 664.7242,-6060.4367 634.2197,-4315.3033 690.4731,-4223.0235 727.5249,-4162.2426 793.4582,-4207.2169 831.457,-4147.0235 874.3338,-4079.1031 844.0736,-3501.8663 867.457,-3425.0235 896.1358,-3330.7791 952.7996,-3329.2304 981.6013,-3235.0235 1026.2328,-3089.0395 952.6061,-2687.15 1017.6013,-2549.0235 1046.9525,-2486.647 1095.2537,-2502.4971 1131.7661,-2444.0235 1161.4833,-2396.4322 1132.7829,-2366.8895 1167.7661,-2323.0235 1221.3535,-2255.8295 1291.0601,-2301.1607 1336.1997,-2228.0235 1422.5535,-2088.1094 1315.4756,-1643.3456 1372.1997,-1489.0235 1412.054,-1380.597 1462.0347,-1375.922 1530.6973,-1283.0235 1730.5638,-1012.6097 1698.3628,-866.1744 1968.5662,-666.0235 2075.9392,-586.4879 2120.1901,-571.0235 2253.8123,-571.0235 2253.8123,-571.0235 2253.8123,-571.0235 2447.0435,-571.0235 2680.7684,-571.0235 2733.4669,-630.3173 2965.166,-661.0235 3080.8564,-676.3555 3400.9416,-631.4467 3488.1262,-709.0235 3647.6197,-850.9407 3488.1628,-989.9628 3587.3328,-1179.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge828" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#f3ff00" stroke-dasharray="5,2" d="M587.912,-6554.0157C597.1303,-6507.4343 633.2443,-6321.8537 654.4731,-6168.0235 665.1317,-6090.7884 653.3122,-5887.5649 690.4731,-5819.0235 728.88,-5748.184 795.6589,-5777.2164 831.457,-5705.0235 891.013,-5584.919 805.8519,-4618.0899 867.457,-4499.0235 896.6459,-4442.6093 952.2573,-4469.3571 981.6013,-4413.0235 1086.1766,-4212.2637 913.0174,-3595.7788 1017.6013,-3395.0235 1046.9512,-3338.6847 1100.694,-3364.4311 1131.7661,-3309.0235 1172.1733,-3236.9697 1113.8109,-3001.5801 1167.7661,-2939.0235 1169.796,-2936.67 1172.0454,-2934.5595 1174.4659,-2932.668"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="1176.7332,-2935.3733 1183.2837,-2927.0462 1172.97,-2929.4709 1176.7332,-2935.3733"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge860" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff58" stroke-dasharray="5,2" d="M760.9651,-11357.0235C762.4358,-11389.438 811.527,-11350.4178 831.457,-11376.0235 871.676,-11427.696 859.6557,-13668.01 867.457,-13733.0235 894.7173,-13960.1998 948.0236,-14008.6947 981.6013,-14235.0235 1058.6046,-14754.0598 1072.394,-15398.6578 1074.3861,-15522.8035"/>
<polygon fill="#00ff58" stroke="#00ff58" points="1070.8877,-15522.9436 1074.5397,-15532.8891 1077.8869,-15522.8369 1070.8877,-15522.9436"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge881" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M760.9651,-11357.0235C762.4295,-11389.4383 811.6248,-11350.3419 831.457,-11376.0235 911.4759,-11479.6438 805.2072,-15973.8492 867.457,-16089.0235 896.4361,-16142.6404 950.5466,-16112.5816 981.6013,-16165.0235 1029.1067,-16245.2456 962.7226,-16507.6533 1017.6013,-16583.0235 1033.8008,-16605.2718 1063.1908,-16582.017 1074.6837,-16607.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge889" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#009bff" stroke-dasharray="5,2" d="M924.5292,-7705.0235C934.5931,-7730.634 965.1602,-7706.9584 981.6013,-7729.0235 1025.9413,-7788.5309 994.877,-7990.3781 1017.6013,-8061.0235 1027.3982,-8091.48 1047.0142,-8123.026 1060.4923,-8142.5837"/>
<polygon fill="#009bff" stroke="#009bff" points="1057.748,-8144.7654 1066.3707,-8150.9218 1063.4692,-8140.732 1057.748,-8144.7654"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge898" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0058ff" stroke-dasharray="5,2" d="M586.9581,-6576.4024C594.3951,-6645.0748 633.4966,-7011.3117 654.4731,-7311.0235 654.9817,-7318.2893 749.0523,-9285.8464 759.9411,-9513.604"/>
<polygon fill="#0058ff" stroke="#0058ff" points="756.459,-9514.0653 760.4327,-9523.8867 763.451,-9513.7309 756.459,-9514.0653"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge928" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M3036.0425,-18509.0235C3348.1409,-18369.0588 3248.6158,-17924.4171 3587.3328,-17972.0235"/>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M2850.2146,-18433.0235C2884.4864,-18444.3383 2895.4273,-18439.2063 2929.166,-18452.0235 2979.4908,-18471.1418 2984.9317,-18525.9284 3036.0425,-18509.0235"/>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M587.139,-6576.3916C595.6303,-6645.0014 639.8208,-7010.936 654.4731,-7311.0235 723.2493,-8719.5904 597.0604,-12249.8758 690.4731,-13657.0235 723.2674,-14151.0284 791.7834,-14268.5234 831.457,-14762.0235 850.5753,-14999.8349 827.5518,-15599.8059 867.457,-15835.0235 904.9156,-16055.8193 939.9834,-16105.9535 1017.6013,-16316.0235 1076.2671,-16474.8003 1078.0864,-16522.4641 1167.7661,-16666.0235 1298.6503,-16875.5431 1415.2996,-16868.5916 1530.6973,-17087.0235 1559.7039,-17141.929 1535.6795,-17168.2286 1566.6973,-17222.0235 1617.562,-17310.2394 1685.3363,-17291.8965 1728.717,-17384.0235 1800.7995,-17537.104 1675.3766,-17619.33 1764.717,-17763.0235 1839.5546,-17883.3908 2715.6244,-18388.5889 2850.2146,-18433.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge946" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M760.9651,-11357.0235C762.4305,-11389.4382 811.6124,-11350.3515 831.457,-11376.0235 866.9813,-11421.9795 860.3879,-15500.3698 867.457,-15558.0235 902.2775,-15842.0097 920.2727,-15914.9738 1017.6013,-16184.0235 1068.8643,-16325.7321 1098.6879,-16354.0928 1167.7661,-16488.0235 1255.6763,-16658.4661 1262.9041,-16710.4375 1372.1997,-16868.0235 1433.1386,-16955.8872 1476.7106,-16956.725 1530.6973,-17049.0235 1554.9693,-17090.5203 1537.6621,-17112.7081 1566.6973,-17151.0235 1619.8751,-17221.1982 1685.1625,-17188.5031 1728.717,-17265.0235 1779.986,-17355.0972 1696.9465,-17651.6084 1764.717,-17730.0235 1789.7241,-17758.9584 1816.2451,-17728.6998 1848.6416,-17749.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge458" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3416.4602,-1217.0235C3560.9353,-1374.0133 3585.8786,-8670.7554 3587.2685,-9116.711"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3583.7692,-9116.9591 3587.3,-9126.9482 3590.7691,-9116.9375 3583.7692,-9116.9591"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.3232,-6553.7396C599.0168,-6506.8 639.6881,-6322.2548 654.4731,-6168.0235 664.1819,-6066.7459 645.739,-4428.4033 690.4731,-4337.0235 725.9033,-4264.6493 794.6051,-4294.6843 831.457,-4223.0235 893.3551,-4102.6589 827.4513,-3744.3238 867.457,-3615.0235 896.5747,-3520.9138 953.0456,-3519.3053 981.6013,-3425.0235 1030.7411,-3262.7797 948.9935,-2818.042 1017.6013,-2663.0235 1046.6214,-2597.453 1098.1679,-2612.3703 1131.7661,-2549.0235 1171.6282,-2473.8667 1108.6013,-2422.155 1167.7661,-2361.0235 1221.1358,-2305.8798 1286.8651,-2381.8049 1336.1997,-2323.0235 1390.2622,-2258.6089 1326.0764,-1637.3417 1372.1997,-1567.0235 1415.2605,-1501.3743 1469.4858,-1538.1886 1530.6973,-1489.0235 1550.666,-1472.9846 1546.5981,-1459.8987 1566.6973,-1444.0235 1949.1074,-1141.9793 2086.3668,-1086.7581 2563.3586,-987.0235 2806.21,-936.2455 3308.3757,-1104.7927 3308.7942,-1105.0235 3369.2558,-1138.37 3369.7031,-1166.2163 3416.4602,-1217.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge470" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M587.6577,-6553.6649C600.6929,-6477.4601 675.5061,-6042.8908 690.4731,-6019.0235 731.9805,-5952.8334 794.5999,-5982.9114 831.457,-5914.0235 904.2049,-5778.0538 838.1399,-5372.4187 867.457,-5221.0235 936.2448,-4865.8001 1061.6061,-4805.9784 1131.7661,-4451.0235 1144.781,-4385.1781 1129.6862,-3903.2948 1167.7661,-3848.0235 1214.3607,-3780.3936 1281.0812,-3832.9071 1336.1997,-3772.0235 1369.874,-3734.8271 1336.1839,-3699.9577 1372.1997,-3665.0235 1398.6159,-3639.4007 1421.7861,-3662.8062 1451.4485,-3641.0235"/>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1451.4485,-3641.0235C1477.2959,-3622.3571 1667.8824,-3596.2848 1775.3801,-3582.8308"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1776.0245,-3586.2777 1785.5154,-3581.5689 1775.1596,-3579.3313 1776.0245,-3586.2777"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge510" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M760.9651,-11357.0235C762.4411,-11389.4378 811.5467,-11350.4024 831.457,-11376.0235 876.1525,-11433.5388 852.8218,-13926.6687 867.457,-13998.0235 894.2107,-14128.462 954.2978,-14144.699 981.6013,-14275.0235 1000.1062,-14363.3503 965.8369,-15825.1013 1017.6013,-15899.0235 1104.758,-16023.4876 1204.0449,-15948.0388 1336.1997,-16023.0235 1353.8293,-16033.0266 1355.2347,-16039.9306 1372.1997,-16051.0235 1439.2778,-16094.8839 1473.5958,-16080.7862 1530.6973,-16137.0235 1553.9494,-16159.9238 1541.182,-16180.6751 1566.6973,-16201.0235 1596.0556,-16224.4368 1610.7014,-16218.6465 1647.7072,-16225.0235"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2054.7312,-16151.0235C2092.2775,-16122.4554 2103.1214,-16117.2888 2140.8962,-16089.0235 2157.1256,-16076.8797 2158.9892,-16070.521 2176.8962,-16061.0235 2184.4746,-16057.0042 2192.8164,-16053.4794 2201.1256,-16050.4421"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2202.5047,-16053.6689 2210.8174,-16047.1 2200.2226,-16047.0513 2202.5047,-16053.6689"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1647.7072,-16225.0235C1670.4252,-16228.5038 2036.4406,-16164.9404 2054.7312,-16151.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge529" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M924.5292,-13491.0235C929.3285,-13516.6962 961.9155,-13487.86 981.6013,-13505.0235 983.7352,-13506.884 1130.7516,-13881.3805 1131.7661,-13884.0235 1241.7018,-14170.417 1241.94,-14253.2835 1372.1997,-14531.0235 1432.2639,-14659.0925 1471.692,-14678.4632 1530.6973,-14807.0235 1550.7505,-14850.7154 1536.0931,-14871.9493 1566.6973,-14909.0235 1631.6295,-14987.6831 1666.2787,-14998.3137 1764.717,-15025.0235 1974.5931,-15081.9704 2100.3698,-15165.1219 2253.8123,-15011.0235"/>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M760.9651,-11357.0235C762.4416,-11389.4377 811.4856,-11350.45 831.457,-11376.0235 864.7165,-11418.6123 858.2509,-13267.7765 867.457,-13321.0235 881.0352,-13399.5581 908.673,-13412.917 924.5292,-13491.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge553" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M760.9651,-11129.0235C765.1628,-11161.852 811.4513,-11126.6587 831.457,-11153.0235 918.5022,-11267.737 775.8791,-11688.895 867.457,-11800.0235 1111.7392,-12096.4564 1432.652,-11627.2956 1728.717,-11872.0235 1781.2276,-11915.4288 1724.3447,-11966.1468 1764.717,-12021.0235 1868.8742,-12162.6007 1999.3876,-12247.2737 2140.8962,-12143.0235 2184.357,-12111.0057 2141.8561,-12068.0865 2176.8962,-12027.0235 2226.3969,-11969.0144 2269.6578,-11996.6936 2330.7283,-11951.0235 2373.14,-11919.3069 2412.7737,-11870.8281 2433.0111,-11844.1975"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2435.9129,-11846.1616 2439.1066,-11836.0596 2430.3102,-11841.9651 2435.9129,-11846.1616"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge609" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M760.9651,-11357.0235C762.4416,-11389.4377 811.506,-11350.4341 831.457,-11376.0235 904.1921,-11469.3146 839.2771,-13390.1343 867.457,-13505.0235 894.4526,-13615.0839 950.3326,-13624.1 981.6013,-13733.0235 1028.1666,-13895.2322 935.2061,-13963.7448 1017.6013,-14111.0235 1048.6169,-14166.4628 1101.5439,-14141.1478 1131.7661,-14197.0235 1189.0884,-14303.0025 1141.0114,-14620.5434 1167.7661,-14738.0235 1263.995,-15160.565 1377.8965,-15237.4952 1530.6973,-15643.0235 1547.6479,-15688.01 1529.3128,-15714.7991 1566.6973,-15745.0235 1855.7909,-15978.749 2891.473,-15796.5725 3225.8566,-15959.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge704" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M610.7675,-6576.1824C631.7717,-6585.2679 662.702,-6598.0185 690.4731,-6607.0235 920.636,-6681.6559 1588.6552,-6737.7228 1728.717,-6935.0235 1801.1587,-7037.0698 1718.3531,-7380.784 1764.717,-7497.0235 1797.0646,-7578.1225 2711.7629,-8640.1242 2771.2632,-8704.0235 2804.4543,-8739.6685 2818.6421,-8742.9373 2850.2146,-8780.0235"/>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M2850.2146,-8780.0235C2870.632,-8809.2317 2905.8032,-8767.1131 2929.166,-8794.0235 2967.0666,-8837.6792 2957.3958,-9776.7357 2965.166,-9834.0235 2979.398,-9938.9522 3014.7778,-10060.9801 3029.4769,-10109.0437"/>
<polygon fill="#00cbff" stroke="#00cbff" points="3026.2213,-10110.3635 3032.5157,-10118.886 3032.9098,-10108.2985 3026.2213,-10110.3635"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge733" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M760.9651,-11357.0235C762.4458,-11389.4375 811.4465,-11350.4806 831.457,-11376.0235 888.652,-11449.0313 848.9191,-12954.1513 867.457,-13045.0235 930.6161,-13354.6277 1018.5411,-13410.0253 1131.7661,-13705.0235 1148.3931,-13748.3436 1146.4165,-13761.8254 1167.7661,-13803.0235 1228.3958,-13920.0199 1288.175,-13924.3135 1336.1997,-14047.0235 1377.4325,-14152.3794 1312.5754,-14202.8729 1372.1997,-14299.0235 1400.0969,-14344.0107 1714.1663,-14553.3161 1764.717,-14569.0235 1835.9567,-14591.1596 1865.1746,-14601.0153 1932.5662,-14569.0235 1948.3708,-14561.5208 2322.3395,-14096.3762 2330.7283,-14081.0235 2395.3235,-13962.8051 2431.549,-13802.758 2443.015,-13746.0225"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2446.4715,-13746.5851 2444.9792,-13736.0959 2439.6046,-13745.2263 2446.4715,-13746.5851"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M587.1246,-6576.3924C595.5317,-6645.0063 639.3162,-7010.9611 654.4731,-7311.0235 660.0563,-7421.5538 644.416,-11194.3913 690.4731,-11295.0235 707.8369,-11332.9624 759.0665,-11315.3431 760.9651,-11357.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge735" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M924.5292,-7287.0235C1346.6233,-7677.0503 1051.2097,-7994.2634 1167.7661,-8557.0235 1183.4778,-8632.883 1222.6015,-8716.8545 1241.4732,-8754.6374"/>
<polygon fill="#6500ff" stroke="#6500ff" points="1238.3801,-8756.2766 1246.0161,-8763.6211 1244.6268,-8753.1178 1238.3801,-8756.2766"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M587.1041,-6576.4547C595.3341,-6643.2103 639.1991,-6982.7915 690.4731,-7073.0235 760.1105,-7195.5712 826.3527,-7185.8865 924.5292,-7287.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge788" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M760.9651,-11129.0235C765.1411,-11161.8548 811.7929,-11126.4029 831.457,-11153.0235 911.2415,-11261.033 771.1016,-12267.4968 867.457,-12361.0235 903.8595,-12396.3573 930.883,-12362.1498 981.6013,-12361.0235 1241.8364,-12355.2443 1306.4622,-12340.8027 1566.6973,-12335.0235 1638.6883,-12333.4248 1668.3382,-12295.7849 1728.717,-12335.0235 1761.7498,-12356.4906 1734.4399,-12390.8184 1764.717,-12416.0235 1836.3301,-12475.64 1876.0659,-12453.7866 1968.5662,-12465.0235 1977.9521,-12466.1637 2641.2067,-12464.1534 2649.3109,-12469.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M593.1993,-6553.7077C624.2096,-6506.5998 745.0827,-6321.0403 831.457,-6161.0235 841.7991,-6141.8639 1151.3028,-5467.2716 1167.7661,-5453.0235 1197.3866,-5427.3887 1215.818,-5411.9699 1251.9829,-5427.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M760.9651,-5615.0235C778.7206,-5500.0875 813.5285,-5477.9327 831.457,-5363.0235 848.2203,-5255.5831 826.0735,-4485.5812 867.457,-4385.0235 895.964,-4315.7545 953.0969,-4330.2936 981.6013,-4261.0235 1023.0656,-4160.2589 967.1927,-3377.6245 1017.6013,-3281.0235 1046.9897,-3224.7048 1100.3713,-3250.2489 1131.7661,-3195.0235 1204.6801,-3066.7634 1094.1477,-2992.8806 1167.7661,-2865.0235 1214.1505,-2784.4652 1288.7374,-2820.9515 1336.1997,-2741.0235 1396.6621,-2639.203 1312.212,-2579.1244 1372.1997,-2477.0235 1579.5534,-2124.1014 2201.6622,-2229.1914 2391.4574,-2270.7701"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="2390.9682,-2274.2467 2401.4891,-2272.9974 2392.4854,-2267.4131 2390.9682,-2274.2467"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M1074.6837,-7097.0235C1094.5151,-7100.5772 1239.1805,-7119.4668 1251.9829,-7135.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge415" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M588.2695,-6553.7342C598.7511,-6506.7736 638.702,-6322.1571 654.4731,-6168.0235 704.6707,-5677.4364 635.0393,-5549.0465 690.4731,-5059.0235 727.2249,-4734.1463 782.9671,-4660.3571 831.457,-4337.0235 854.1247,-4185.874 837.341,-4144.8668 867.457,-3995.0235 902.2043,-3822.1371 952.2245,-3788.903 981.6013,-3615.0235 997.1269,-3523.1288 980.0656,-2862.3274 1017.6013,-2777.0235 1046.4811,-2711.3911 1099.1612,-2726.8872 1131.7661,-2663.0235 1178.0147,-2572.4357 1106.0141,-2517.8429 1167.7661,-2437.0235 1217.6282,-2371.7653 1289.4813,-2428.5679 1336.1997,-2361.0235 1408.146,-2257.0053 1327.7227,-1911.4205 1372.1997,-1793.0235 1397.1383,-1726.6374 1507.155,-1578.5433 1566.6973,-1540.0235 2022.0495,-1245.4415 2229.9431,-1378.1415 2771.2632,-1345.0235 2841.3112,-1340.738 2863.7243,-1319.6763 2929.166,-1345.0235 3028.8394,-1383.6296 3057.2315,-1412.3855 3106.9189,-1507.0235 3416.3387,-2096.3647 3249.9276,-2328.0014 3308.7942,-2991.0235 3402.5792,-4047.3363 3415.0236,-5355.5365 3416.3256,-5537.6211"/>
<polygon fill="#002eff" stroke="#002eff" points="3412.8266,-5537.7929 3416.3947,-5547.7688 3419.8264,-5537.7452 3412.8266,-5537.7929"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge422" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M588.3405,-6553.7412C599.1023,-6506.8081 640.005,-6322.2848 654.4731,-6168.0235 702.5177,-5655.765 629.1888,-4363.8672 690.4731,-3853.0235 724.1849,-3572.0151 771.9189,-3508.7136 831.457,-3232.0235 848.3445,-3153.5426 850.0722,-3133.3958 867.457,-3055.0235 870.1236,-3043.0024 1067.4416,-2202.9819 1074.6837,-2193.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M587.6298,-6553.9015C601.3041,-6474.357 683.9429,-5994.6529 690.4731,-5981.0235 731.7156,-5894.9464 796.0669,-5907.6675 831.457,-5819.0235 899.5807,-5648.39 843.0679,-5175.1274 867.457,-4993.0235 897.9449,-4765.3832 952.087,-4716.7921 981.6013,-4489.0235 988.9449,-4432.3512 981.5508,-3505.3636 1017.6013,-3461.0235 1034.0802,-3440.7554 1067.8952,-3472.2478 1074.6837,-3447.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M924.5292,-7705.0235C934.5931,-7730.634 961.5621,-7710.1659 981.6013,-7729.0235 988.4603,-7735.4781 1129.422,-8023.9014 1131.7661,-8033.0235 1176.7754,-8208.1766 1093.2732,-8681.235 1167.7661,-8846.0235 1189.1581,-8893.3454 1214.8053,-8890.7632 1251.9829,-8927.0235"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M586.7351,-6576.1173C592.4268,-6636.1455 622.5663,-6927.8074 690.4731,-7156.0235 766.1215,-7410.2567 821.9936,-7460.3939 924.5292,-7705.0235"/>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M1251.9829,-8927.0235C1283.9998,-8959.2925 1331.2319,-8977.8629 1371.6986,-8988.4508"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="1371.0082,-8991.8857 1381.558,-8990.9102 1372.7024,-8985.0939 1371.0082,-8991.8857"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M586.5812,-6576.425C592.6635,-6655.8225 630.6236,-7134.3438 690.4731,-7520.0235 700.7751,-7586.4113 1124.8747,-9839.3148 1167.7661,-9891.0235 1339.4734,-10098.0293 1567.3409,-9902.8665 1728.717,-10118.0235 1824.1377,-10245.2445 1678.8073,-10340.1961 1764.717,-10474.0235 1821.1707,-10561.9652 1940.5338,-10610.0542 2007.1844,-10631.0168"/>
<polygon fill="#002eff" stroke="#002eff" points="2006.4297,-10634.4462 2017.0165,-10634.0324 2008.4823,-10627.7539 2006.4297,-10634.4462"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M1074.6837,-7097.0235C1189.5715,-7117.6107 1244.9326,-7048.2681 1336.1997,-7121.0235 1376.4234,-7153.0887 1350.8264,-7184.2335 1372.1997,-7231.0235 1429.0626,-7355.5064 1490.6937,-7364.1454 1530.6973,-7495.0235 1619.6812,-7786.1487 1504.2918,-7881.0679 1566.6973,-8179.0235 1582.2437,-8253.2502 1619.3806,-8335.8111 1637.4637,-8373.386"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1634.4982,-8375.2904 1642.025,-8382.7468 1640.7909,-8372.2241 1634.4982,-8375.2904"/>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M760.9651,-7059.0235C775.448,-7068.9464 1057.4337,-7093.7588 1074.6837,-7097.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M587.1231,-6576.3924C595.5212,-6645.0068 639.2624,-7010.9638 654.4731,-7311.0235 657.1678,-7364.1798 664.2014,-11096.7347 690.4731,-11143.0235 726.7021,-11206.8562 794.5483,-11165.5815 831.457,-11229.0235 896.8602,-11341.4443 797.3115,-12289.4991 867.457,-12399.0235 987.6399,-12586.6755 1267.9607,-12657.7642 1391.3405,-12680.625"/>
<polygon fill="#ff008b" stroke="#ff008b" points="1390.9033,-12684.1027 1401.3669,-12682.4402 1392.1504,-12677.2147 1390.9033,-12684.1027"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.121,-6576.1826C588.883,-6646.6504 607.5029,-7036.7422 690.4731,-7341.0235 712.4176,-7421.5015 960.7792,-7952.2479 981.6013,-8033.0235 1078.8916,-8410.4429 926.0023,-9471.3096 1167.7661,-9777.0235 1250.6902,-9881.8822 1324.4078,-9835.4014 1451.4485,-9877.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-6147.0235C774.0536,-6107.4059 811.5822,-6121.7094 831.457,-6085.0235 884.7207,-5986.7072 843.2349,-5945.1858 867.457,-5836.0235 870.584,-5821.9311 1157.4801,-4851.1513 1167.7661,-4841.0235 1195.4992,-4813.7171 1214.6391,-4827.9869 1251.9829,-4817.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.4107,-6566.4157C701.4732,-6567.9478 821.8425,-6569.6304 924.5292,-6565.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-6565.0235C1050.8825,-6558.1934 1963.3442,-6337.5008 2054.7312,-6425.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge285" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M588.2342,-6553.7306C598.5768,-6506.7554 638.0556,-6322.0895 654.4731,-6168.0235 675.2355,-5973.1855 633.0701,-5474.3677 690.4731,-5287.0235 725.3768,-5173.1095 796.7222,-5172.9891 831.457,-5059.0235 893.0493,-4856.9386 782.8674,-4302.612 867.457,-4109.0235 896.1653,-4043.323 952.9874,-4060.7652 981.6013,-3995.0235 1072.8258,-3785.4311 952.6685,-3186.1915 1017.6013,-2967.0235 1045.5863,-2872.5659 1099.0709,-2869.9559 1131.7661,-2777.0235 1171.0667,-2665.316 1096.93,-2607.92 1167.7661,-2513.0235 1216.893,-2447.21 1289.1773,-2504.3567 1336.1997,-2437.0235 1399.601,-2346.2367 1324.2676,-2039.8458 1372.1997,-1940.0235 1413.7873,-1853.4142 1461.9169,-1860.1053 1530.6973,-1793.0235 1637.3521,-1689.0026 1632.0292,-1620.7697 1764.717,-1553.0235 1960.055,-1453.2902 2885.5397,-1285.4601 3036.0425,-1521.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge310" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M635.5285,-6573.1854C652.9094,-6576.0126 672.5487,-6579.1838 690.4731,-6582.0235 819.7873,-6602.5102 852.7804,-6603.6351 981.6013,-6627.0235 1148.4796,-6657.3216 1611.4329,-6660.5052 1728.717,-6783.0235 1797.2304,-6854.5945 1698.8496,-6929.0102 1764.717,-7003.0235 1816.2991,-7060.9848 1881.0667,-6992.9889 1932.5662,-7051.0235 1999.4929,-7126.4431 1898.7305,-7202.2892 1968.5662,-7275.0235 2022.0179,-7330.6938 2572.6678,-7403.9631 2649.3109,-7413.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge318" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1451.4485,-7217.0235C1468.2933,-7248.5756 1507.1506,-7204.1007 1530.6973,-7231.0235 1594.5367,-7304.0165 1521.969,-8016.9838 1566.6973,-8103.0235 1608.5227,-8183.4793 1685.8064,-8147.1412 1728.717,-8227.0235 1784.1606,-8330.237 1691.5203,-8661.5399 1764.717,-8753.0235 1768.2194,-8757.4009 1772.4541,-8761.0359 1777.1375,-8764.0516"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1775.5295,-8767.161 1785.9909,-8768.8377 1778.8584,-8761.0032 1775.5295,-8767.161"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M760.9651,-7059.0235C807.3127,-7092.4005 960.5075,-7046.5796 1017.6013,-7045.0235 1159.148,-7041.1656 1224.8685,-6957.5266 1336.1997,-7045.0235 1389.4249,-7086.854 1325.6771,-7143.8467 1372.1997,-7193.0235 1397.4908,-7219.7575 1434.1165,-7184.559 1451.4485,-7217.0235"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M588.1081,-6576.298C602.584,-6643.5608 680.6239,-6991.2555 760.9651,-7059.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge367" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M760.9651,-5615.0235C778.6197,-5500.0719 813.7662,-5477.9695 831.457,-5363.0235 868.728,-5120.8553 797.0325,-4495.704 867.457,-4261.0235 895.3348,-4168.1245 953.3415,-4167.807 981.6013,-4075.0235 1038.6267,-3887.7962 951.863,-3379.3722 1017.6013,-3195.0235 1045.9794,-3115.4435 1100.3162,-3121.4403 1131.7661,-3043.0235 1182.0826,-2917.5649 1087.8257,-2850.0241 1167.7661,-2741.0235 1216.3357,-2674.7977 1288.1173,-2731.6039 1336.1997,-2665.0235 1426.4582,-2540.0414 1298.5997,-2455.4862 1372.1997,-2320.0235 1479.2533,-2122.9886 1561.7334,-2098.317 1764.717,-2003.0235 2076.7396,-1856.5401 2361.4552,-1841.8787 2527.3586,-2144.0235 2596.6664,-2270.2474 2507.8782,-2658.1402 2563.3586,-2791.0235 2607.2335,-2896.1098 2687.9131,-2877.4566 2735.2632,-2981.0235 2813.6546,-3152.4861 2844.0345,-3773.0047 2849.3424,-3895.8177"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2845.8466,-3895.993 2849.7669,-3905.8359 2852.8403,-3895.6966 2845.8466,-3895.993"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M588.1258,-6553.7183C598.0405,-6506.6948 636.0656,-6321.8645 654.4731,-6168.0235 661.6041,-6108.4263 650.863,-5674.1202 690.4731,-5629.0235 711.5522,-5605.0247 756.1714,-5646.6034 760.9651,-5615.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge385" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M587.0945,-6576.3939C595.3264,-6645.017 638.2652,-7011.016 654.4731,-7311.0235 681.3779,-7809.0281 634.2046,-9059.4771 690.4731,-9555.0235 733.0282,-9929.7973 706.9975,-10043.6746 867.457,-10385.0235 913.2439,-10482.4269 925.0592,-10520.0707 1017.6013,-10575.0235 1416.0804,-10811.646 1605.0283,-10795.0195 2054.7312,-10683.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-5173.0235C2309.8089,-5151.6285 2379.6376,-5177.7679 2418.1565,-5196.411"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2416.7377,-5199.6146 2427.2473,-5200.9557 2419.8679,-5193.3535 2416.7377,-5199.6146"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-6147.0235C774.3192,-6107.4947 813.1801,-6122.5311 831.457,-6085.0235 892.4949,-5959.7627 829.263,-5593.0277 867.457,-5459.0235 896.5751,-5356.8625 949.1677,-5350.1807 981.6013,-5249.0235 1021.5246,-5124.5068 939.4769,-5061.8798 1017.6013,-4957.0235 1050.6964,-4912.6042 1097.7676,-4950.7553 1131.7661,-4907.0235 1192.0391,-4829.4953 1092.884,-4752.554 1167.7661,-4689.0235 1255.6893,-4614.4289 1140.1296,-4433.9713 2054.7312,-4715.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2054.7312,-4715.0235C2261.791,-4794.9604 2046.4764,-5252.2417 2253.8123,-5173.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.0019,-6554.0065C594.0826,-6495.0972 630.2734,-6217.8489 690.4731,-6161.0235 713.7009,-6139.0977 750.8364,-6177.3167 760.9651,-6147.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.5835,-6556.8303C690.4007,-6545.3669 777.7956,-6519.4893 831.457,-6465.0235 867.5705,-6428.3687 1125.2858,-5631.061 1167.7661,-5602.0235 1272.0404,-5530.7466 1325.4305,-5610.48 1451.4485,-5619.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge253" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.2308,-6554.0028C595.6622,-6493.7597 638.3802,-6204.399 690.4731,-6133.0235 733.7429,-6073.7371 794.0949,-6110.1996 831.457,-6047.0235 876.6379,-5970.6267 841.4185,-5333.875 867.457,-5249.0235 895.9114,-5156.2995 944.8511,-5152.7833 981.6013,-5063.0235 1008.5622,-4997.1735 995.3442,-4974.6085 1017.6013,-4907.0235 1024.1558,-4887.1205 1155.7086,-4578.1614 1167.7661,-4561.0235 1436.3548,-4179.2669 1828.9275,-3818.8154 2140.8962,-4166.0235 2230.6147,-4265.8764 2094.1703,-4663.305 2176.8962,-4769.0235 2198.9648,-4797.2257 2229.9259,-4766.3434 2253.8123,-4793.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-4793.0235C2277.4613,-4818.4803 2297.912,-4795.6037 2330.7283,-4807.0235 2386.0551,-4826.2768 2388.7106,-4863.636 2447.0435,-4869.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge270" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M588.1396,-6553.7199C598.1086,-6506.7029 636.3182,-6321.8945 654.4731,-6168.0235 684.0607,-5917.2555 629.7866,-5846.1299 690.4731,-5601.0235 727.239,-5452.5303 797.0597,-5436.0832 831.457,-5287.0235 845.7048,-5225.2812 829.5906,-4197.8294 867.457,-4147.0235 899.4093,-4104.1528 949.6021,-4151.8592 981.6013,-4109.0235 1052.5273,-4014.0783 959.8904,-3146.5345 1017.6013,-3043.0235 1047.284,-2989.7843 1099.841,-3018.9491 1131.7661,-2967.0235 1202.3317,-2852.2498 1106.0039,-2785.7646 1167.7661,-2666.0235 1214.1267,-2576.1423 1291.0668,-2603.5274 1336.1997,-2513.0235 1414.0798,-2356.8524 1284.8897,-2273.1251 1372.1997,-2122.0235 1488.3787,-1920.9602 2022.9911,-1535.6146 2253.8123,-1561.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-6565.0235C1290.0646,-6588.0584 1392.0915,-6600.6975 1728.717,-6745.0235 1949.0198,-6839.4769 1961.2776,-6940.3176 2176.8962,-7045.0235 2185.1515,-7049.0323 2194.2052,-7052.6238 2203.1113,-7055.7496"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2202.079,-7059.0949 2212.6729,-7058.9565 2204.3049,-7052.4582 2202.079,-7059.0949"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M760.9651,-7059.0235C882.1385,-7144.6096 949.1931,-7093.9029 1074.6837,-7173.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge340" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.0801,-6553.7127C597.8144,-6506.6671 635.2269,-6321.7618 654.4731,-6168.0235 667.2924,-6065.6234 634.1774,-5791.5158 690.4731,-5705.0235 729.3043,-5645.3637 794.0688,-5689.598 831.457,-5629.0235 902.4531,-5513.9993 801.8848,-4531.2237 867.457,-4413.0235 897.023,-4359.728 951.8913,-4390.2388 981.6013,-4337.0235 1037.3155,-4237.2305 955.7942,-3405.1619 1017.6013,-3309.0235 1048.2704,-3261.319 1099.5318,-3298.6847 1131.7661,-3252.0235 1221.6526,-3121.9074 1076.9181,-3027.4701 1167.7661,-2898.0235 1215.4841,-2830.0315 1281.6293,-2879.6494 1336.1997,-2817.0235 1370.5492,-2777.6035 1344.6304,-2749.4506 1372.1997,-2705.0235 1423.9883,-2621.5678 1477.7333,-2633.7382 1530.6973,-2551.0235 1556.621,-2510.538 1527.4526,-2476.7897 1566.6973,-2449.0235 1625.4809,-2407.4332 1667.8688,-2410.5169 1728.717,-2449.0235 1760.2999,-2469.0101 1741.8365,-2495.4698 1764.717,-2525.0235 1898.0374,-2697.2274 2038.09,-2647.0356 2140.8962,-2839.0235 2210.96,-2969.8658 2121.5917,-3033.2917 2176.8962,-3171.0235 2197.7893,-3223.0561 2212.6687,-3232.9299 2253.8123,-3271.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge492" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-11129.0235C1087.5785,-11108.712 1551.6731,-11149.7002 1647.7072,-11283.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge592" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-13491.0235C929.7252,-13516.6188 964.7954,-13485.0315 981.6013,-13505.0235 1057.5632,-13595.3861 970.9822,-13926.5696 1017.6013,-14035.0235 1047.1849,-14103.8463 1101.9721,-14090.2915 1131.7661,-14159.0235 1217.9094,-14357.7478 1074.0971,-14449.7337 1167.7661,-14645.0235 1212.0236,-14737.2956 1286.567,-14712.5279 1336.1997,-14802.0235 1376.8249,-14875.2771 1342.3173,-14908.7705 1372.1997,-14987.0235 1421.2941,-15115.5867 1465.3155,-15131.9286 1530.6973,-15253.0235 1548.0735,-15285.2065 1537.8356,-15304.5583 1566.6973,-15327.0235 1697.7546,-15429.0352 1770.2985,-15367.6451 1932.5662,-15403.0235 2055.4446,-15429.814 2968.8305,-15761.3221 3036.0425,-15655.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge564" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.1242,-6576.3924C595.5292,-6645.0064 639.3031,-7010.9617 654.4731,-7311.0235 657.2405,-7365.7614 658.366,-11212.6047 690.4731,-11257.0235 709.8611,-11283.8459 758.6237,-11248.0106 760.9651,-11281.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-11281.0235C763.9169,-11322.6426 813.7633,-11305.2374 831.457,-11343.0235 895.5611,-11479.9221 819.8867,-12559.5396 867.457,-12703.0235 895.1744,-12786.6259 940.5516,-12787.097 981.6013,-12865.0235 1007.9539,-12915.0498 1320.7568,-13764.6305 1336.1997,-13819.0235 1358.4819,-13897.506 1339.218,-13924.4031 1372.1997,-13999.0235 1431.1166,-14132.3215 1447.4049,-14179.3044 1566.6973,-14263.0235 1597.4344,-14284.5948 1610.278,-14283.9976 1647.7072,-14287.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-14287.0235C1704.1482,-14290.5858 1711.5281,-14256.2387 1764.717,-14237.0235 1775.5549,-14233.1082 1787.3321,-14229.3198 1798.5424,-14225.9264"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1799.6218,-14229.2569 1808.2101,-14223.0527 1797.6273,-14222.5471 1799.6218,-14229.2569"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge673" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.3222,-6576.0912C596.8469,-6609.9614 627.093,-6713.2832 690.4731,-6769.0235 919.5781,-6970.5122 1087.1209,-6825.8233 1336.1997,-7002.0235 1356.8272,-7016.6155 1353.9645,-7028.5336 1372.1997,-7046.0235 1435.7729,-7106.9985 1484.2001,-7090.207 1530.6973,-7165.0235 1576.5253,-7238.7634 1549.1389,-7271.9972 1566.6973,-7357.0235 1632.8563,-7677.3985 1679.714,-7751.5797 1728.717,-8075.0235 1743.9435,-8175.5253 1707.134,-8447.2581 1764.717,-8531.0235 1922.6073,-8760.7045 2098.6033,-8646.7488 2330.7283,-8801.0235 2409.7166,-8853.5207 2607.2854,-9000.0002 2649.3109,-9085.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge686" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M760.9651,-11129.0235C765.1663,-11161.8516 811.7009,-11126.4712 831.457,-11153.0235 896.5009,-11240.4426 798.958,-12048.2847 867.457,-12133.0235 923.3984,-12202.2274 1433.6912,-12300.7086 1451.4485,-12271.0235"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1451.4485,-12271.0235C1470.1663,-12239.3377 1507.1953,-12275.3432 1530.6973,-12247.0235 1624.9165,-12133.49 1472.7774,-12030.8048 1566.6973,-11917.0235 1573.6557,-11908.5935 1583.3945,-11902.9506 1593.7149,-11899.1873"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1594.7687,-11902.525 1603.2932,-11896.2335 1592.7059,-11895.8359 1594.7687,-11902.525"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge636" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.5292,-7287.0235C1029.861,-7432.9009 931.6038,-7522.9747 1017.6013,-7681.0235 1052.6313,-7745.4027 1103.1967,-7732.5286 1131.7661,-7800.0235 1174.8889,-7901.9007 1095.7912,-8711.0108 1167.7661,-8795.0235 1250.3571,-8891.4278 1641.5777,-8810.7099 1728.717,-8903.0235 1811.818,-8991.0589 1683.0548,-9083.6519 1764.717,-9173.0235 1816.3116,-9229.4889 1862.5655,-9180.1975 1932.5662,-9211.0235 1950.3938,-9218.8742 1951.3816,-9226.8502 1968.5662,-9236.0235 2121.0872,-9317.4407 2170.57,-9312.9023 2330.7283,-9378.0235 2382.6925,-9399.1524 2392.0294,-9416.0617 2447.0435,-9427.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge654" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M587.1224,-6576.3925C595.517,-6645.007 639.2411,-7010.9649 654.4731,-7311.0235 659.7897,-7415.7545 638.7047,-10994.8265 690.4731,-11086.0235 708.5899,-11117.9386 756.3345,-11092.6182 760.9651,-11129.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2447.0435,-11747.0235C2485.701,-11748.2892 2528.5366,-11748.4657 2564.799,-11748.2561"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2564.8678,-11751.7558 2574.8436,-11748.1873 2564.8198,-11744.7559 2564.8678,-11751.7558"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M924.5292,-11129.0235C1192.0176,-11094.4289 1275.7072,-11070.1208 1530.6973,-11158.0235 1626.0813,-11190.9053 1659.4785,-11195.6386 1728.717,-11269.0235 1753.8165,-11295.6261 1738.867,-11317.1497 1764.717,-11343.0235 1962.5274,-11541.0156 2106.8188,-11451.1118 2330.7283,-11619.0235 2392.2259,-11665.1411 2370.216,-11744.5081 2447.0435,-11747.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M760.9651,-11129.0235C765.5514,-11165.0806 888.2059,-11130.3522 924.5292,-11129.0235"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge756" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-11281.0235C763.9301,-11322.6417 813.7959,-11305.2221 831.457,-11343.0235 899.9095,-11489.5376 800.6427,-12650.7552 867.457,-12798.0235 895.9362,-12860.7956 948.789,-12842.4038 981.6013,-12903.0235 1027.9297,-12988.6137 995.2125,-13024.3095 1017.6013,-13119.0235 1069.7063,-13339.4492 1086.7645,-13394.5025 1167.7661,-13606.0235 1231.6595,-13772.8696 1287.3248,-13799.177 1336.1997,-13971.0235 1354.2059,-14034.334 1327.1023,-14217.0791 1372.1997,-14265.0235 1432.4323,-14329.0586 1479.1535,-14292.9899 1566.6973,-14301.0235 1731.4798,-14316.1451 1820.4157,-14353.696 1932.5662,-14232.0235 1977.2771,-14183.5165 1937.0187,-14145.961 1968.5662,-14088.0235 2081.2177,-13881.1369 2212.2737,-13904.6431 2330.7283,-13701.0235 2402.04,-13578.441 2434.3581,-13407.3637 2443.8874,-13348.1661"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2447.3654,-13348.5778 2445.4502,-13338.1575 2440.4492,-13347.4978 2447.3654,-13348.5778"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge789" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3587.5871,-9149.2021C3595.0211,-9475.9375 3763.0075,-16859.2424 3773.1907,-17306.8105"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3769.692,-17306.9104 3773.4186,-17316.8282 3776.6902,-17306.7512 3769.692,-17306.9104"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge790" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2054.7312,-3119.0235C2073.4322,-3079.6132 2116.2613,-3108.0237 2140.8962,-3072.0235 2211.2549,-2969.205 2105.7841,-2896.3223 2176.8962,-2794.0235 2220.9997,-2730.5782 2281.6638,-2772.7153 2330.7283,-2713.0235 2445.5834,-2573.2909 2365.14,-2484.2956 2447.0435,-2323.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-2323.0235C2463.4035,-2290.1931 2501.9862,-2330.5137 2527.3586,-2304.0235 2586.2046,-2242.5851 2538.6943,-2197.4434 2563.3586,-2116.0235 2632.3005,-1888.4387 2634.734,-1817.7222 2771.2632,-1623.0235 2900.4887,-1438.7403 2951.4385,-1397.3231 3142.9189,-1279.0235 3315.155,-1172.6134 3489.808,-1001.6051 3587.3328,-1179.0235"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge943" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1849.4581,-3585.2972C1856.9623,-3689.521 1914.0781,-4496.0129 1932.5662,-5151.0235 2001.6228,-7597.6178 1896.3965,-13718.5191 1968.5662,-16165.0235 1986.9621,-16788.6327 2042.8898,-17552.2472 2053.1165,-17688.6685"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="2049.6518,-17689.2702 2053.8922,-17698.9794 2056.6321,-17688.745 2049.6518,-17689.2702"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge430" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-2323.0235C2464.9865,-2291.0308 2497.1876,-2324.8849 2527.3586,-2304.0235 2790.1265,-2122.336 2809.1281,-2004.0779 2929.166,-1708.0235 2963.2669,-1623.919 2895.5653,-1565.266 2965.166,-1507.0235 3013.4823,-1466.5921 3057.7484,-1467.6355 3106.9189,-1507.0235 3598.855,-1901.0884 3324.8395,-2267.4099 3416.4602,-2891.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3416.4602,-2891.0235C3523.4401,-3551.5461 3582.9135,-8740.1331 3587.0959,-9116.4781"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3583.5975,-9116.6546 3587.2081,-9126.6152 3590.5971,-9116.577 3583.5975,-9116.6546"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge532" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1849.3512,-3585.3009C1855.8892,-3689.5579 1905.9987,-4496.2909 1932.5662,-5151.0235 1955.7846,-5723.2206 1932.7998,-5867.4735 1968.5662,-6439.0235 2072.3143,-8096.9306 2231.5189,-8500.8386 2330.7283,-10159.0235 2336.045,-10247.8871 2327.1893,-11681.2634 2366.7283,-11761.0235 2376.9781,-11781.7001 2397.3953,-11797.8293 2415.078,-11808.7236"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2413.6072,-11811.9178 2424.0073,-11813.9399 2417.1381,-11805.8736 2413.6072,-11811.9178"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge602" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1911.5004,-3583.5683C1919.5576,-3587.2357 1926.9415,-3592.2327 1932.5662,-3599.0235 1982.5819,-3659.4092 1951.3168,-3873.5352 1968.5662,-3950.0235 2018.8912,-4173.1777 2094.8465,-4210.948 2140.8962,-4435.0235 2166.0883,-4557.6065 2110.1562,-4891.1604 2176.8962,-4997.0235 2218.6691,-5063.2836 2266.1807,-5038.6504 2330.7283,-5083.0235 2347.8913,-5094.8222 2349.2604,-5101.681 2366.7283,-5113.0235 2433.4536,-5156.3506 2483.6249,-5125.564 2527.3586,-5192.0235 2571.0851,-5258.4721 2512.0064,-5846.2751 2563.3586,-5907.0235 2613.8725,-5966.7801 2662.9896,-5915.0397 2735.2632,-5945.0235 2829.7487,-5984.2222 2869.5413,-5985.9034 2929.166,-6069.0235 3229.3962,-6487.5604 3113.1345,-7862.8016 3142.9189,-8377.0235 3188.786,-9168.9074 3264.7133,-9362.0382 3308.7942,-10154.0235 3379.2364,-11419.635 3413.6733,-15731.179 3416.2976,-16071.6533"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="3412.798,-16071.7346 3416.3747,-16081.7075 3419.7978,-16071.6809 3412.798,-16071.7346"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge760" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1849.5084,-3585.0633C1855.8044,-3663.9261 1896.321,-4149.7802 1968.5662,-4539.0235 2026.5628,-4851.4984 2096.0798,-4918.3877 2140.8962,-5233.0235 2155.15,-5333.0926 2138.558,-6048.4971 2176.8962,-6142.0235 2264.6593,-6356.122 2409.2166,-6328.0688 2527.3586,-6527.0235 2552.3327,-6569.0805 2530.6725,-6594.6352 2563.3586,-6631.0235 2619.798,-6693.8555 2688.4162,-6641.7481 2735.2632,-6712.0235 2784.0633,-6785.2288 2717.2806,-7433.5516 2771.2632,-7503.0235 2793.7661,-7531.9833 2845.5158,-7490.6508 2850.2146,-7527.0235"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1863.8717,-3562.9116C1883.532,-3547.6073 1917.0541,-3518.0412 1932.5662,-3484.0235 1964.181,-3414.6926 1919.3515,-3201.1973 1968.5662,-3143.0235 1994.2417,-3112.674 2037.6888,-3154.9385 2054.7312,-3119.0235"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M2054.7312,-3119.0235C2071.7736,-3083.1085 2115.3531,-3125.4846 2140.8962,-3095.0235 2247.626,-2967.7448 2072.1395,-2851.931 2176.8962,-2723.0235 2199.4805,-2695.2326 2239.4466,-2731.8262 2253.8123,-2699.0235"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge391" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1860.9043,-3562.9868C1879.2606,-3545.7842 1913.734,-3510.724 1932.5662,-3474.0235 1962.0935,-3416.4801 1932.1256,-3386.4576 1968.5662,-3333.0235 1995.148,-3294.0457 2024.2763,-3307.0563 2054.7312,-3271.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M2054.7312,-3271.0235C2085.1861,-3234.9907 2117.1589,-3249.796 2140.8962,-3209.0235 2178.4562,-3144.5085 2126.3123,-2929.9253 2176.8962,-2875.0235 2306.5788,-2734.2713 2872.0618,-2716.3368 3036.0425,-2815.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M3036.0425,-2815.0235C3143.079,-2867.8531 3112.0464,-2969.0372 3225.8566,-3005.0235"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1911.4818,-3584.7101C1919.3398,-3588.229 1926.6715,-3592.8806 1932.5662,-3599.0235 1977.6455,-3646.0008 1947.3341,-3679.4751 1968.5662,-3741.0235 2030.3637,-3920.1651 2096.8388,-3946.7151 2140.8962,-4131.0235 2175.8712,-4277.3364 2108.3932,-4673.0905 2176.8962,-4807.0235 2216.8847,-4885.2065 2269.6589,-4867.9189 2330.7283,-4931.0235 2431.7282,-5035.3894 2479.3033,-5054.9691 2527.3586,-5192.0235 2573.2965,-5323.0387 2541.5126,-6303.9176 2563.3586,-6441.0235 2579.9656,-6545.249 2623.2227,-6664.5694 2641.2454,-6711.5224"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2638.0012,-6712.8371 2644.8791,-6720.8959 2644.5279,-6710.3069 2638.0012,-6712.8371"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge321" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2054.7312,-3271.0235C2080.3927,-3240.6621 2106.8411,-3274.5156 2140.8962,-3295.0235 2160.826,-3307.0252 2156.4379,-3321.9469 2176.8962,-3333.0235 2207.4518,-3349.5669 2219.6665,-3340.5897 2253.8123,-3347.0235"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge483" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1849.4442,-3585.2976C1856.8221,-3689.5251 1913.0227,-4496.0436 1932.5662,-5151.0235 2006.0829,-7614.8678 1880.0652,-8233.672 1968.5662,-10697.0235 1987.5134,-11224.4034 2042.1081,-11868.8074 2052.8746,-11992.83"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2049.3975,-11993.2461 2053.7524,-12002.9046 2056.3711,-11992.6385 2049.3975,-11993.2461"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge568" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1848.8463,-3585.2803C1850.6484,-3673.5888 1866.2737,-4263.8609 1968.5662,-4729.0235 2019.4103,-4960.2314 2097.4611,-5000.31 2140.8962,-5233.0235 2159.442,-5332.3868 2133.3351,-6050.8126 2176.8962,-6142.0235 2181.3389,-6151.3257 2730.6359,-6621.8118 2735.2632,-6631.0235 2780.4929,-6721.0644 2749.6965,-6984.5961 2771.2632,-7083.0235 2814.8383,-7281.8947 2885.433,-7314.1869 2929.166,-7513.0235 3181.1782,-8658.8226 2881.612,-9000.3083 3142.9189,-10144.0235 3159.8609,-10218.1767 3197.3838,-10300.7733 3215.573,-10338.3714"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3212.6177,-10340.295 3220.1575,-10347.7383 3218.9051,-10337.2178 3212.6177,-10340.295"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge792" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.2484,-3841.6063C454.7143,-3839.2311 471.0329,-3833.5627 480.9653,-3821.0235 542.7936,-3742.9686 467.835,-2115.6348 516.9653,-2029.0235 552.5308,-1966.3256 617.5407,-2004.926 654.4731,-1943.0235 718.5926,-1835.5529 663.2492,-1503.1713 690.4731,-1381.0235 776.9088,-993.2055 800.861,-882.0364 1017.6013,-549.0235 1340.9269,-52.2467 1760.5666,-154.0284 2330.7283,-316.0235 2441.6719,-347.545 2459.6285,-380.6037 2563.3586,-431.0235 2741.3661,-517.547 2773.9501,-571.9406 2965.166,-623.0235 3190.3739,-683.1872 3304.9962,-518.7957 3488.1262,-663.0235 3672.3496,-808.1124 3613.1192,-933.531 3650.5393,-1165.0235 3720.6539,-1598.7744 3771.4615,-16662.506 3773.603,-17306.749"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3770.1037,-17306.9915 3773.6369,-17316.9798 3777.1036,-17306.9682 3770.1037,-17306.9915"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge957" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M401.3046,-3853.0466C412.5031,-3909.2177 462.9513,-4169.3604 480.9653,-4385.0235 490.7566,-4502.2434 468.6768,-6394.7641 516.9653,-6502.0235 525.5213,-6521.0281 542.8584,-6536.8503 557.9817,-6547.885"/>
<polygon fill="#ff0042" stroke="#ff0042" points="556.3332,-6551.0007 566.547,-6553.8166 560.3185,-6545.2459 556.3332,-6551.0007"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge434" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.2336,-3841.5946C454.6971,-3839.2175 471.018,-3833.5509 480.9653,-3821.0235 536.324,-3751.3068 489.6056,-2303.7374 516.9653,-2219.0235 550.1179,-2116.373 603.6193,-2114.1556 654.4731,-2019.0235 669.5303,-1990.8562 852.6818,-1513.3398 867.457,-1485.0235 923.5856,-1377.4548 921.3707,-1330.9228 1017.6013,-1257.0235 1060.0148,-1224.4525 1095.3579,-1258.1926 1131.7661,-1219.0235 1176.0929,-1171.3355 1135.3545,-1133.4903 1167.7661,-1077.0235 1231.1978,-966.5143 1269.5461,-951.5093 1372.1997,-876.0235 1614.3633,-697.95 1676.9973,-630.1053 1968.5662,-557.0235 2042.8591,-538.402 2064.7317,-548.9506 2140.8962,-557.0235 2497.2037,-594.7894 2583.2611,-632.5834 2929.166,-726.0235 2977.4193,-739.0583 2986.8369,-752.2432 3036.0425,-761.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3036.0425,-761.0235C3264.8155,-785.0692 3370.4024,-815.3966 3488.1262,-1013.0235 3544.1445,-1107.0632 3584.8237,-8662.1115 3587.2209,-9116.6555"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3583.7217,-9116.835 3587.2743,-9126.8164 3590.7216,-9116.7981 3583.7217,-9116.835"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge466" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M439.5824,-3841.4668C454.9073,-3839.042 471.0324,-3833.3746 480.9653,-3821.0235 552.87,-3731.6135 434.4323,-2868.7276 516.9653,-2789.0235 778.8753,-2536.0907 1008.4495,-2630.4307 1336.1997,-2789.0235 1589.2526,-2911.4716 1602.6487,-3033.7546 1728.717,-3285.0235 1756.5642,-3340.5261 1741.6965,-3362.3516 1764.717,-3420.0235 1784.8986,-3470.583 1817.8254,-3525.6359 1835.8514,-3554.2451"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1833.031,-3556.3323 1841.3534,-3562.8889 1838.9362,-3552.5735 1833.031,-3556.3323"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge714" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M401.3559,-3853.0425C412.805,-3909.1934 464.2841,-4169.2532 480.9653,-4385.0235 489.2601,-4492.3156 478.3609,-12032.574 516.9653,-12133.0235 592.2244,-12328.8493 753.2076,-12290.3734 831.457,-12485.0235 916.0541,-12695.4638 798.2576,-13289.0299 867.457,-13505.0235 925.0268,-13684.7173 1262.5307,-14039.3082 1336.1997,-14213.0235 1365.1652,-14281.3257 1331.3041,-14314.1224 1372.1997,-14376.0235 1461.4508,-14511.117 1921.0581,-14722.3882 2054.7312,-14631.0235"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2054.7312,-14631.0235C2089.3725,-14611.5219 2114.6512,-14636.8819 2140.8962,-14607.0235 2215.0082,-14522.708 2113.3237,-14449.5449 2176.8962,-14357.0235 2221.2546,-14292.4658 2284.2364,-14334.0622 2330.7283,-14271.0235 2394.7215,-14184.2547 2435.3371,-13835.9104 2444.8751,-13746.1869"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2448.3671,-13746.4447 2445.9277,-13736.1345 2441.4052,-13745.7156 2448.3671,-13746.4447"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge763" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M585.7192,-11053.0235C637.7048,-11158.0629 604.3383,-11215.5466 690.4731,-11295.0235 739.12,-11339.9101 792.0009,-11289.8771 831.457,-11343.0235 900.3797,-11435.8607 787.4278,-12299.5704 867.457,-12383.0235 1133.1749,-12660.1096 1349.7562,-12387.6124 1728.717,-12449.0235 1936.8662,-12482.7543 2438.5783,-12671.5663 2649.3109,-12679.0235"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2649.3109,-12679.0235C2738.5893,-12680.4944 2761.7862,-12691.4015 2850.2146,-12679.0235"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M2253.8123,-2017.0235C2342.8623,-2091.2389 2411.9831,-2215.2028 2436.9487,-2263.6984"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="2433.95,-2265.5235 2441.5972,-2272.8563 2440.1919,-2262.3551 2433.95,-2265.5235"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M439.6027,-3841.4831C454.9307,-3839.0608 471.0527,-3833.3908 480.9653,-3821.0235 560.155,-3722.2242 472.2891,-2800.4986 516.9653,-2682.0235 547.5709,-2600.8618 947.1242,-2133.5892 1017.6013,-2083.0235 1464.6495,-1762.2767 1831.1457,-1664.7685 2253.8123,-2017.0235"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge393" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M585.7192,-2233.0235C618.8152,-2167.3837 641.337,-2159.7004 690.4731,-2105.0235 750.1291,-2038.6406 791.9572,-2042.0565 831.457,-1962.0235 882.6974,-1858.2022 832.1872,-1814.2981 867.457,-1704.0235 900.8939,-1599.4799 945.1081,-1588.5399 981.6013,-1485.0235 1008.7265,-1408.0805 965.9793,-1368.1992 1017.6013,-1305.0235 1052.429,-1262.401 1091.9916,-1295.0713 1131.7661,-1257.0235 1158.7744,-1231.1877 1142.8412,-1208.8747 1167.7661,-1181.0235 1226.4376,-1115.4638 1275.2695,-1140.4895 1336.1997,-1077.0235 1358.8015,-1053.4811 1344.1115,-1029.641 1372.1997,-1013.0235 1748.0239,-790.679 3074.2645,-977.6804 3308.7942,-1346.0235 3332.0592,-1382.5627 3343.7096,-2861.72 3344.7942,-2905.0235 3372.2648,-4001.7738 3410.6046,-5353.334 3415.8556,-5537.8097"/>
<polygon fill="#002eff" stroke="#002eff" points="3412.3582,-5537.9528 3416.1415,-5547.849 3419.3553,-5537.7534 3412.3582,-5537.9528"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M439.6512,-3841.5218C454.9866,-3839.1054 471.101,-3833.4294 480.9653,-3821.0235 533.2936,-3755.2125 485.5536,-2386.0148 516.9653,-2308.0235 533.8594,-2266.0777 563.7975,-2272.5747 585.7192,-2233.0235"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M401.355,-3853.0425C412.7998,-3909.1938 464.261,-4169.255 480.9653,-4385.0235 496.8446,-4590.1344 470.8764,-11590.528 516.9653,-11791.0235 589.4014,-12106.1337 750.3421,-12134.035 831.457,-12447.0235 848.1564,-12511.4595 819.0604,-12999.322 867.457,-13045.0235 1145.764,-13307.8319 1365.0738,-13166.5501 1728.717,-13047.0235 1788.4492,-13027.39 2139.7281,-12750.5667 2231.7524,-12677.5659"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="2234.1744,-12680.1121 2239.8302,-12671.1531 2229.822,-12674.6297 2234.1744,-12680.1121"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M401.3337,-3853.0442C412.6743,-3909.2036 463.7072,-4169.2986 480.9653,-4385.0235 495.7378,-4569.6786 501.2073,-10888.1797 585.7192,-11053.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M585.7192,-11053.0235C635.7828,-11150.6745 754.7515,-11107.4986 831.457,-11029.0235 906.536,-10952.2125 803.4559,-10633.2827 867.457,-10547.0235 1050.5353,-10300.275 1229.2195,-10292.7475 1530.6973,-10352.0235 1623.998,-10370.3681 1658.4403,-10368.9709 1728.717,-10433.0235 1754.2815,-10456.3238 1747.958,-10471.765 1764.717,-10502.0235 1800.4218,-10566.4886 1785.7572,-10606.603 1848.6416,-10645.0235"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.3303,-3853.0445C412.6547,-3909.2052 463.6206,-4169.3056 480.9653,-4385.0235 510.6568,-4754.2978 453.7072,-7353.9982 516.9653,-7719.0235 625.0283,-8342.5911 805.373,-8457.1932 981.6013,-9065.0235 1081.8098,-9410.653 895.2354,-9618.0161 1167.7661,-9853.0235 1263.5906,-9935.6545 1330.9465,-9838.4297 1451.4485,-9877.0235"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-6427.0235C2276.4034,-6459.0154 2301.1162,-6444.3922 2330.7283,-6470.0235 2350.6231,-6487.2439 2345.0678,-6502.0846 2366.7283,-6517.0235 2397.3969,-6538.1751 2422.4584,-6513.0319 2447.0435,-6541.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.3405,-3839.8646C454.0796,-3837.148 469.8514,-3831.6973 480.9653,-3821.0235 521.1254,-3782.454 472.2924,-3734.2616 516.9653,-3701.0235 629.1051,-3617.5881 711.0863,-3629.9764 831.457,-3701.0235 950.372,-3771.2114 934.2748,-3843.3033 981.6013,-3973.0235 1009.8622,-4050.4854 976.0789,-4083.7852 1017.6013,-4155.0235 1030.725,-4177.5393 1709.8297,-4749.0664 1728.717,-4767.0235 1823.9145,-4857.5324 1873.3239,-4863.7854 1932.5662,-4981.0235 1974.0891,-5063.1958 1922.9844,-5105.0314 1968.5662,-5185.0235 2018.5505,-5272.7417 2096.9658,-5242.1223 2140.8962,-5333.0235 2185.3616,-5425.0317 2153.9349,-6152.4471 2176.8962,-6252.0235 2195.986,-6334.8098 2204.8055,-6357.6237 2253.8123,-6427.0235"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge289" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2850.2146,-7069.0235C2860.7313,-7074.1527 2918.3904,-7079.8512 2966.7296,-7083.8491"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2966.6318,-7087.3527 2976.8829,-7084.6756 2967.1998,-7080.3757 2966.6318,-7087.3527"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M439.2432,-3833.4874C461.9387,-3829.098 490.9025,-3824.2188 516.9653,-3822.0235 656.9212,-3810.2351 734.938,-3750.9907 831.457,-3853.0235 878.206,-3902.4431 844.6741,-4092.9244 867.457,-4157.0235 899.1825,-4246.2822 949.5289,-4247.8889 981.6013,-4337.0235 1024.8275,-4457.1565 965.8334,-4505.3165 1017.6013,-4622.0235 1049.1882,-4693.234 1100.738,-4683.5678 1131.7661,-4755.0235 1189.8261,-4888.7315 1087.1658,-4959.5642 1167.7661,-5081.0235 1215.1677,-5152.4546 1268.5132,-5122.4132 1336.1997,-5175.0235 1354.5681,-5189.3006 1352.4057,-5200.7993 1372.1997,-5213.0235 1434.8229,-5251.6979 1465.329,-5227.1951 1530.6973,-5261.0235 1548.6993,-5270.3397 1549.1466,-5278.8827 1566.6973,-5289.0235 1634.0212,-5327.9234 1670.1994,-5303.824 1728.717,-5355.0235 1865.9349,-5475.0811 1853.4545,-5546.7557 1932.5662,-5711.0235 1964.5153,-5777.3628 2136.4654,-6265.485 2176.8962,-6327.0235 2242.4416,-6426.7879 2270.7162,-6446.0954 2366.7283,-6517.0235 2515.7769,-6627.1319 2629.5752,-6559.8085 2735.2632,-6712.0235 2805.8168,-6813.637 2717.3277,-6876.6948 2771.2632,-6988.0235 2793.1817,-7033.2657 2805.0303,-7046.9861 2850.2146,-7069.0235"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge345" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M439.6312,-3841.5059C454.9636,-3839.0871 471.0811,-3833.4136 480.9653,-3821.0235 527.165,-3763.1113 490.9536,-2557.3893 516.9653,-2488.0235 559.475,-2374.6626 603.1138,-2361.8454 690.4731,-2278.0235 747.2331,-2223.562 788.0237,-2236.6077 831.457,-2171.0235 867.4062,-2116.7403 840.2536,-2088.1757 867.457,-2029.0235 904.2576,-1949.0027 941.6651,-1945.5264 981.6013,-1867.0235 1004.1609,-1822.678 988.5135,-1801.3888 1017.6013,-1761.0235 1066.5897,-1693.0421 1096.8034,-1691.5839 1167.7661,-1647.0235 1238.9485,-1602.3252 1286.5747,-1628.8632 1336.1997,-1561.0235 1393.9191,-1482.1185 1310.1158,-1419.5425 1372.1997,-1344.0235 1589.274,-1079.9741 1844.3482,-1149.0159 2140.8962,-1319.0235 2388.5439,-1460.9971 2421.4572,-1566.9372 2527.3586,-1832.0235 2579.3075,-1962.0589 2529.1745,-2009.232 2563.3586,-2145.0235 2588.5818,-2245.2189 2627.8263,-2259.9605 2649.3109,-2361.0235"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2649.3109,-2361.0235C2690.2113,-2539.0916 2707.0641,-2582.5078 2735.2632,-2763.0235 2806.3122,-3217.8413 2842.1426,-3780.7387 2848.9906,-3895.8772"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2845.4971,-3896.0923 2849.5785,-3905.8694 2852.485,-3895.681 2845.4971,-3896.0923"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge382" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M401.3246,-3853.0449C412.6208,-3909.208 463.4708,-4169.3177 480.9653,-4385.0235 494.2328,-4548.6097 471.5184,-7181.318 516.9653,-7339.0235 599.6308,-7625.8808 702.4102,-7663.2661 867.457,-7912.0235 915.551,-7984.5105 950.4962,-7989.784 981.6013,-8071.0235 998.6467,-8115.5421 1132.2769,-9745.1964 1167.7661,-9777.0235 1260.5689,-9860.2503 1611.1582,-9818.4841 1728.717,-9777.0235 1748.093,-9770.19 1745.3411,-9754.857 1764.717,-9748.0235 1835.0695,-9723.2116 1876.3531,-9698.9808 1932.5662,-9748.0235 2021.4669,-9825.5843 1897.5679,-9916.799 1968.5662,-10011.0235 2018.9411,-10077.8779 2065.8424,-10049.9552 2140.8962,-10087.0235 2192.2292,-10112.3763 2202.2502,-10124.14 2253.8123,-10149.0235"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge228" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.2409,-3841.1842C454.5134,-3838.7161 470.6918,-3833.0927 480.9653,-3821.0235 538.2409,-3753.7367 451.7162,-3484.61 516.9653,-3425.0235 562.0937,-3383.8116 597.4815,-3402.9567 654.4731,-3425.0235 837.8772,-3496.0364 850.0374,-3576.8359 981.6013,-3723.0235 999.6787,-3743.1103 993.4907,-3759.8191 1017.6013,-3772.0235 1062.872,-3794.9387 1094.653,-3806.6235 1131.7661,-3772.0235 1215.3551,-3694.0948 1114.3627,-3360.0585 1167.7661,-3259.0235 1212.3391,-3174.695 1270.2588,-3194.9427 1336.1997,-3126.0235 1457.3722,-2999.3782 1410.6881,-2885.9169 1566.6973,-2806.0235 1711.9496,-2731.6388 1774.8964,-2794.9334 1932.5662,-2837.0235 2028.5485,-2862.6461 2078.3458,-2840.8448 2140.8962,-2918.0235 2203.2797,-2994.9962 2116.4702,-3059.5048 2176.8962,-3138.0235 2280.9887,-3273.2833 2410.8087,-3170.3377 2527.3586,-3295.0235 2709.5064,-3489.8863 2682.9171,-3596.472 2735.2632,-3858.0235 2754.2716,-3953.0004 2727.4565,-4642.6354 2771.2632,-4729.0235 2781.4612,-4749.1343 2801.3335,-4764.9367 2818.5886,-4775.6851"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2816.919,-4778.7639 2827.3082,-4780.8411 2820.482,-4772.7385 2816.919,-4778.7639"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge267" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2850.2146,-1637.0235C2894.3559,-1692.2014 2904.4411,-1708.8289 2929.166,-1775.0235 2958.0179,-1852.2671 2947.4371,-1876.4959 2965.166,-1957.0235 2987.6424,-2059.1153 3018.3596,-2180.2966 3030.644,-2228.1263"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3027.2838,-2229.1129 3033.1665,-2237.9244 3034.0627,-2227.3676 3027.2838,-2229.1129"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-2233.0235C610.2611,-2184.8095 640.6188,-2192.0338 690.4731,-2171.0235 750.2751,-2145.8209 787.9105,-2181.1394 831.457,-2133.0235 897.3524,-2060.2137 835.6569,-2007.9332 867.457,-1915.0235 901.9835,-1814.1483 937.2461,-1800.9797 981.6013,-1704.0235 1000.3851,-1662.964 997.0593,-1649.2322 1017.6013,-1609.0235 1072.8038,-1500.971 1095.1905,-1478.2626 1167.7661,-1381.0235 1237.2762,-1287.8918 1278.801,-1282.0708 1336.1997,-1181.0235 1360.3586,-1138.4931 1334.9566,-1108.7323 1372.1997,-1077.0235 1534.624,-938.7354 2146.4972,-1021.4867 2330.7283,-1129.0235 2446.2936,-1196.4797 2460.5857,-1241.0621 2527.3586,-1357.0235 2551.7666,-1399.4116 2531.1029,-1424.2531 2563.3586,-1461.0235 2619.6951,-1525.2451 2663.0674,-1501.351 2735.2632,-1547.0235 2790.0974,-1581.7128 2809.6815,-1586.3559 2850.2146,-1637.0235"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge571" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.362,-3853.042C412.8411,-3909.1906 464.4432,-4169.241 480.9653,-4385.0235 505.0353,-4699.3827 473.5881,-15422.7424 516.9653,-15735.0235 556.3338,-16018.4448 483.6789,-16157.2517 690.4731,-16355.0235 703.9571,-16367.9191 999.0649,-16428.8986 1017.6013,-16431.0235 1458.2244,-16481.5347 1411.4068,-16911.6867 2330.7283,-16410.0235 2351.1419,-16398.884 2548.5045,-16079.9165 2563.3586,-16062.0235 2583.3034,-16037.9985 2937.5373,-15683.5716 2965.166,-15669.0235 2993.5773,-15654.0633 3018.1504,-15681.6858 3036.0425,-15655.0235"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge614" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.2913,-3853.0477C412.4253,-3909.2242 462.6079,-4169.3894 480.9653,-4385.0235 497.7736,-4582.4608 469.7142,-5975.5882 516.9653,-6168.0235 558.2719,-6336.2492 579.6791,-6383.8665 690.4731,-6517.0235 920.0433,-6792.9307 1130.1845,-6708.1103 1336.1997,-7002.0235 1367.6714,-7046.9229 1337.2026,-7077.8143 1372.1997,-7120.0235 1422.9538,-7181.2369 1487.2328,-7136.436 1530.6973,-7203.0235 1594.8595,-7301.3201 1538.9097,-7615.9759 1566.6973,-7730.0235 1609.4831,-7905.6279 1686.2427,-7927.3435 1728.717,-8103.0235 1757.8134,-8223.3704 1699.866,-8553.5516 1764.717,-8659.0235 1810.0808,-8732.8018 1870.1587,-8697.9701 1932.5662,-8758.0235 1953.8864,-8778.5395 1948.2394,-8792.5229 1968.5662,-8814.0235 2149.0338,-9004.9129 2293.5669,-8947.8282 2447.0435,-9161.0235"/>
</g>
<!-- sourcefile~plantpipeheattransfer.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge794" class="edge">
<title>sourcefile~plantpipeheattransfer.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2267.4727,-16047.1224C2282.8853,-16059.6658 2308.681,-16080.7223 2330.7283,-16099.0235 2473.0985,-16217.2037 2464.2816,-16367.0235 2649.3109,-16367.0235 2649.3109,-16367.0235 2649.3109,-16367.0235 3225.8566,-16367.0235 3386.5127,-16367.0235 3564.2028,-16208.0412 3587.3328,-16367.0235"/>
</g>
<!-- sourcefile~plantwateruse.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge795" class="edge">
<title>sourcefile~plantwateruse.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2479.4136,-14701.134C2607.1771,-14746.7238 3080.5602,-14932.3455 3308.7942,-15253.0235 3604.7249,-15668.8182 3512.9821,-15862.1154 3587.3328,-16367.0235"/>
</g>
<!-- sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge796" class="edge">
<title>sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2451.7246,-11836.3717C2477.9136,-11899.4588 2606.6211,-12204.1243 2649.3109,-12203.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2649.3109,-12203.0235C2750.5373,-12200.4133 2706.1227,-12088.9999 2735.2632,-11992.0235 2885.5113,-11492.0134 2844.9442,-11348.0897 2965.166,-10840.0235 3003.8687,-10676.4632 3091.8933,-10028.5163 3225.8566,-10130.0235"/>
</g>
<!-- sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge771" class="edge">
<title>sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2649.3109,-12203.0235C2767.6072,-12199.9731 2705.5968,-12340.4669 2735.2632,-12455.0235 2757.9055,-12542.4567 2711.2428,-12587.5343 2771.2632,-12655.0235 2795.6355,-12682.4287 2814.0114,-12684.8868 2850.2146,-12679.0235"/>
</g>
<!-- sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge296" class="edge">
<title>sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2487.2627,-11836.0524C2550.257,-11850.6026 2671.5636,-11867.1524 2735.2632,-11800.0235 2775.6308,-11757.4827 2762.9219,-10803.0725 2771.2632,-10745.0235 2811.4012,-10465.6937 2891.9272,-10409.7546 2929.166,-10130.0235 3008.1435,-9536.7594 2901.1634,-8032.0894 2965.166,-7437.0235 2978.6751,-7311.4221 3015.9592,-7163.9617 3030.3096,-7110.0827"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3033.7186,-7110.8829 3032.9337,-7100.3171 3026.9585,-7109.0663 3033.7186,-7110.8829"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge797" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1855.7355,-9757.0033C1872.6839,-9730.0082 1915.3934,-9657.8907 1932.5662,-9591.0235 1956.5651,-9497.5767 2137.4341,-6220.4406 2140.8962,-6124.0235 2143.9457,-6039.1001 2139.4768,-3141.3194 2176.8962,-3065.0235 2264.443,-2886.5213 2375.2946,-2915.1017 2527.3586,-2787.0235 2791.5933,-2564.4679 2903.8663,-2548.5241 3106.9189,-2269.0235 3262.5007,-2054.8663 3477.5478,-938.1578 3587.3328,-1179.0235"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge947" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1873.974,-9779.1329C1893.9343,-9789.4118 1920.3624,-9806.7755 1932.5662,-9831.0235 1972.1157,-9909.6059 1965.866,-16077.0913 1968.5662,-16165.0235 1987.7151,-16788.61 2043.0296,-17552.243 2053.136,-17688.6679"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="2049.6707,-17689.2661 2053.9025,-17698.9791 2056.6515,-17688.7471 2049.6707,-17689.2661"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge506" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1873.8628,-9779.1894C1893.757,-9789.502 1920.1503,-9806.8834 1932.5662,-9831.0235 1971.962,-9907.6205 1952.4076,-11296.4184 1968.5662,-11381.0235 2009.9914,-11597.9225 2101.0442,-11629.83 2140.8962,-11847.0235 2161.5813,-11959.757 2127.3907,-15869.6508 2176.8962,-15973.0235 2186.5465,-15993.1742 2206.1014,-16009.0537 2223.0781,-16019.8296"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2221.2826,-16022.834 2231.6547,-16024.9951 2224.8941,-16016.8375 2221.2826,-16022.834"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge524" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M1873.8375,-9779.2025C1893.7166,-9789.5228 1920.102,-9806.9083 1932.5662,-9831.0235 2000.036,-9961.5615 1919.9471,-11014.3565 1968.5662,-11153.0235 2010.5939,-11272.8914 2099.3885,-11260.9745 2140.8962,-11381.0235 2211.3466,-11584.7806 2095.1202,-13121.542 2176.8962,-13321.0235 2214.5576,-13412.8933 2289.5354,-13392.6821 2330.7283,-13483.0235 2356.3969,-13539.3182 2433.0281,-14510.3131 2445.36,-14668.3607"/>
<polygon fill="#65ff00" stroke="#65ff00" points="2441.8971,-14668.9738 2446.1632,-14678.6717 2448.876,-14668.4301 2441.8971,-14668.9738"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge540" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1911.1151,-9777.3533C1919.3303,-9781.041 1926.8626,-9786.1007 1932.5662,-9793.0235 1985.0957,-9856.7819 1921.7536,-10094.9568 1968.5662,-10163.0235 2017.072,-10233.5524 2071.4468,-10198.9843 2140.8962,-10249.0235 2165.1085,-10266.4688 2318.9399,-10411.6081 2330.7283,-10439.0235 2388.7739,-10574.0163 2301.1511,-11629.5245 2366.7283,-11761.0235 2377.0273,-11781.6756 2397.4439,-11797.8051 2415.1141,-11808.7057"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2413.6372,-11811.8966 2424.0359,-11813.9256 2417.1721,-11805.8547 2413.6372,-11811.8966"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge719" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1873.8152,-9779.2141C1893.681,-9789.5413 1920.0594,-9806.9304 1932.5662,-9831.0235 1992.4887,-9946.4587 1930.8195,-10876.5599 1968.5662,-11001.0235 2010.5363,-11139.4136 2099.3203,-11138.5145 2140.8962,-11277.0235 2186.7821,-11429.891 2147.5289,-12556.1429 2176.8962,-12713.0235 2214.0891,-12911.7082 2278.9533,-12945.6309 2330.7283,-13141.0235 2354.5347,-13230.866 2349.067,-13255.7739 2366.7283,-13347.0235 2393.1418,-13483.4929 2429.4082,-13646.6591 2442.278,-13703.9206"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2438.9186,-13704.9349 2444.5301,-13713.9216 2445.7476,-13703.397 2438.9186,-13704.9349"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge772" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1910.9635,-9764.8684C1970.2553,-9761.4535 2061.8849,-9755.1019 2140.8962,-9745.0235 2368.527,-9715.9878 2424.9779,-9703.3304 2649.3109,-9655.0235"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1856.182,-9756.6487C1873.7176,-9729.4483 1916.9323,-9657.9179 1932.5662,-9591.0235 1988.0012,-9353.8268 1958.4396,-7642.4013 1968.5662,-7399.0235 2016.3053,-6251.6814 2092.4154,-5968.3345 2140.8962,-4821.0235 2143.2796,-4764.6205 2146.6789,-2836.7088 2176.8962,-2789.0235 2217.7146,-2724.609 2287.6443,-2775.9452 2330.7283,-2713.0235 2381.6512,-2638.6534 2310.1265,-2379.1682 2366.7283,-2309.0235 2369.3362,-2305.7916 2372.3558,-2302.9693 2375.6634,-2300.5053"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="2377.7491,-2303.3305 2384.408,-2295.0898 2374.0635,-2297.3793 2377.7491,-2303.3305"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge400" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1856.7377,-9756.6801C1897.538,-9698.7301 2081.0135,-9428.5886 2140.8962,-9175.0235 2160.2958,-9092.8789 2124.663,-3164.3241 2176.8962,-3098.0235 2198.6873,-3070.3637 2228.4963,-3103.4983 2253.8123,-3079.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M2253.8123,-3079.0235C2273.1728,-3060.3082 2708.5826,-3026.6627 2735.2632,-3023.0235 2786.5008,-3016.0348 2798.5028,-3005.1951 2850.2146,-3005.0235"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge488" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1873.8759,-9779.1827C1893.7779,-9789.4913 1920.1753,-9806.8706 1932.5662,-9831.0235 1975.7361,-9915.1728 1959.1993,-11438.9118 1968.5662,-11533.0235 1986.4372,-11712.5791 2034.0917,-11925.8032 2049.7027,-11992.8027"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2046.3865,-11993.9917 2052.0784,-12002.9278 2053.2015,-11992.3927 2046.3865,-11993.9917"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge576" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1911.0669,-9770.6388C1919.184,-9773.4682 1926.7,-9777.7308 1932.5662,-9784.0235 2025.0389,-9883.2198 1886.003,-9979.4389 1968.5662,-10087.0235 1983.0672,-10105.9192 2343.682,-10240.0072 2366.7283,-10246.0235 2647.9313,-10319.4328 2993.9731,-10346.3982 3146.8575,-10355.2114"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3146.9051,-10358.7196 3157.0869,-10355.7905 3147.3008,-10351.7308 3146.9051,-10358.7196"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge670" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1910.9906,-9776.1231C2093.3527,-9799.9265 2615.08,-9868.8773 2649.3109,-9883.0235"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge798" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3428.3338,-16104.1033C3464.198,-16138.6979 3570.0181,-16249.4412 3587.3328,-16367.0235"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge442" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3419.275,-16081.7562C3430.632,-16035.677 3473.1875,-15856.9126 3488.1262,-15707.0235 3557.9759,-15006.1793 3585.3917,-9542.3963 3587.2326,-9159.1992"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3590.7327,-9159.1607 3587.2806,-9149.1441 3583.7328,-9159.1272 3590.7327,-9159.1607"/>
</g>
<!-- sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge803" class="edge">
<title>sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3069.3487,-10118.9669C3110.5244,-10107.5592 3180.6801,-10095.7922 3225.8566,-10130.0235"/>
</g>
<!-- sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge444" class="edge">
<title>sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3042.2337,-10118.8829C3097.3426,-10019.7192 3503.4521,-9288.9595 3576.1944,-9158.0661"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3579.3904,-9159.5203 3581.1887,-9149.0791 3573.2717,-9156.1199 3579.3904,-9159.5203"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge804" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1501.3554,-12731.7642C1512.3289,-12734.2626 1522.9669,-12738.8792 1530.6973,-12747.0235 1605.8597,-12826.2107 1503.7105,-12900.8458 1566.6973,-12990.0235 1590.2135,-13023.3182 1612.6994,-13012.1427 1647.7072,-13033.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-13033.0235C1686.5552,-13056.1948 2010.2362,-13032.8826 2054.7312,-13041.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2054.7312,-13041.0235C2249.8524,-13037.6267 2773.0435,-13077.1114 2929.166,-12960.0235 3101.1983,-12831.0037 3064.9592,-12720.9277 3106.9189,-12510.0235 3118.6878,-12450.869 3099.9185,-10381.3168 3142.9189,-10339.0235 3195.4789,-10287.3279 3237.3756,-10320.7379 3308.7942,-10339.0235 3361.6544,-10352.5575 3362.8834,-10387.6842 3416.4602,-10398.0235"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge941" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1848.6416,-17749.0235C1905.432,-17784.0462 1986.5031,-17748.9565 2028.0057,-17726.1766"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="2029.9721,-17729.0855 2036.9538,-17721.1164 2026.5263,-17722.9924 2029.9721,-17729.0855"/>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1452.1342,-12742.2673C1458.5024,-12846.2098 1508.3868,-13650.4376 1566.6973,-14301.0235 1627.7401,-14982.0955 1686.1925,-15148.545 1728.717,-15831.0235 1731.9981,-15883.6809 1731.3966,-17689.1174 1764.717,-17730.0235 1788.87,-17759.6751 1816.0901,-17728.949 1848.6416,-17749.0235"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge446" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1501.326,-12734.0154C1511.7996,-12736.4969 1522.2257,-12740.5407 1530.6973,-12747.0235 1559.1098,-12768.7659 1536.5518,-12799.7556 1566.6973,-12819.0235 1640.8867,-12866.4427 1676.678,-12823.69 1764.717,-12825.0235 2282.2669,-12832.8626 2516.9167,-13118.0248 2929.166,-12805.0235 3146.6072,-12639.9307 3064.4471,-12486.7131 3106.9189,-12217.0235 3172.9947,-11797.4526 3057.4049,-10722.0681 3142.9189,-10306.0235 3224.845,-9907.4351 3351.0388,-9841.1575 3488.1262,-9458.0235 3527.923,-9346.7989 3567.0152,-9210.645 3581.4726,-9159.1224"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3584.9273,-9159.7641 3584.2477,-9149.1911 3578.1855,-9157.8803 3584.9273,-9159.7641"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge518" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M1457.7089,-12742.1558C1472.74,-12769.3854 1511.073,-12841.8898 1530.6973,-12907.0235 1559.2796,-13001.8894 1543.246,-13030.7607 1566.6973,-13127.0235 1594.1429,-13239.6823 1608.1853,-13266.013 1647.7072,-13375.0235"/>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M1647.7072,-13375.0235C1660.5062,-13410.3262 1694.115,-13384.4362 1728.717,-13399.0235 1824.3692,-13439.3479 1858.1811,-13440.62 1932.5662,-13513.0235 2070.3222,-13647.1099 2264.5058,-14100.5505 2330.7283,-14281.0235 2383.9954,-14426.19 2427.9648,-14607.6171 2442.1905,-14668.7815"/>
<polygon fill="#65ff00" stroke="#65ff00" points="2438.8359,-14669.8107 2444.4961,-14678.7669 2445.6565,-14668.2358 2438.8359,-14669.8107"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge543" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1499.2682,-12719.9453C1509.7435,-12717.0785 1520.6894,-12713.738 1530.6973,-12710.0235 1826.7497,-12600.1408 1915.2161,-12566.9075 2140.8962,-12346.0235 2234.1575,-12254.7442 2263.8424,-12234.0764 2330.7283,-12122.0235 2388.2404,-12025.6742 2427.5812,-11895.7751 2441.4844,-11845.8024"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2444.8654,-11846.7073 2444.1312,-11836.1379 2438.114,-11844.8583 2444.8654,-11846.7073"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge600" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1647.7072,-13033.0235C1679.6893,-13050.6921 1692.8493,-13040.0564 1728.717,-13047.0235 1858.3849,-13072.2109 2327.2466,-13178.565 2330.7283,-13180.0235 2426.684,-13220.2194 2464.1403,-13224.3999 2527.3586,-13307.0235 2620.934,-13429.3223 3335.8652,-15822.643 3410.2156,-16072.0601"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="3406.8924,-16073.164 3413.1027,-16081.7478 3413.6008,-16071.1647 3406.8924,-16073.164"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge722" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1457.3368,-12742.277C1471.5418,-12769.7758 1508.1792,-12842.8328 1530.6973,-12907.0235 1551.9643,-12967.6479 1527.5252,-12996.1005 1566.6973,-13047.0235 1745.0926,-13278.9345 1935.2231,-13160.9222 2140.8962,-13369.0235 2164.3839,-13392.7885 2155.477,-13409.3786 2176.8962,-13435.0235 2233.19,-13502.4229 2270.7553,-13494.8759 2330.7283,-13559.0235 2375.1586,-13606.5466 2416.0781,-13672.0038 2435.3859,-13704.7077"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2432.6,-13706.8778 2440.6642,-13713.7495 2438.6454,-13703.3488 2432.6,-13706.8778"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge776" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1501.258,-12735.5137C1511.508,-12737.9297 1521.8586,-12741.5681 1530.6973,-12747.0235 1552.7891,-12760.659 1543.8362,-12780.7212 1566.6973,-12793.0235 1644.4496,-12834.8647 1676.4932,-12805.4651 1764.717,-12809.0235 2250.2131,-12828.6056 2370.312,-12755.0719 2850.2146,-12679.0235"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1501.1838,-12728.0004C1512.5768,-12724.8444 1523.4538,-12719.356 1530.6973,-12710.0235 1567.6233,-12662.448 1563.007,-8434.1346 1566.6973,-8374.0235 1605.3763,-7743.9778 1689.3268,-7593.0251 1728.717,-6963.0235 1734.6265,-6868.5083 1730.4991,-3642.3251 1764.717,-3554.0235 1805.1904,-3449.5796 1885.5717,-3467.7002 1932.5662,-3366.0235 1981.6946,-3259.7296 1902.2521,-3201.5349 1968.5662,-3105.0235 2018.0947,-3032.9413 2091.8113,-3082.4085 2140.8962,-3010.0235 2213.0464,-2903.6244 2094.4172,-2821.632 2176.8962,-2723.0235 2199.8716,-2695.5551 2238.02,-2731.1637 2253.8123,-2699.0235"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge403" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1501.0081,-12726.4182C1511.9921,-12723.2491 1522.722,-12718.1507 1530.6973,-12710.0235 1577.8094,-12662.0142 1525.3773,-12616.0999 1566.6973,-12563.0235 1616.7772,-12498.6947 1686.3921,-12546.7 1728.717,-12477.0235 1786.7654,-12381.4627 1690.5703,-8535.7119 1764.717,-8452.0235 1790.068,-8423.4102 2408.8153,-8363.0235 2447.0435,-8363.0235 2447.0435,-8363.0235 2447.0435,-8363.0235 2649.3109,-8363.0235 2828.5038,-8363.0235 2860.5087,-8513.0508 3036.0425,-8477.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M3036.0425,-8477.0235C3060.4032,-8469.6655 3300.3074,-8133.0143 3308.7942,-8109.0235 3397.9849,-7856.8948 3414.7054,-5812.4215 3416.3203,-5580.4295"/>
<polygon fill="#002eff" stroke="#002eff" points="3419.8213,-5580.2707 3416.3894,-5570.2471 3412.8215,-5580.2231 3419.8213,-5580.2707"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M1501.1833,-12728C1512.5763,-12724.844 1523.4534,-12719.3557 1530.6973,-12710.0235 1603.7871,-12615.863 1495.5194,-8514.6374 1566.6973,-8419.0235 1570.103,-8414.4485 1574.3339,-8410.6857 1579.0619,-8407.5941"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1580.9183,-8410.5689 1588.0387,-8402.7235 1577.5799,-8404.4162 1580.9183,-8410.5689"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-12121.0235C1655.8645,-12076.4244 1708.4459,-12099.5785 1728.717,-12059.0235 1822.9106,-11870.5772 1691.7142,-8464.647 1764.717,-8267.0235 1804.9284,-8158.1687 1870.3047,-8164.9513 1932.5662,-8067.0235 2050.5975,-7881.3783 2086.7129,-7831.2363 2140.8962,-7618.0235 2156.4716,-7556.7339 2136.3532,-7098.5546 2176.8962,-7050.0235 2199.4717,-7023.0001 2232.3229,-7058.9184 2253.8123,-7031.0235"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge277" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1501.2056,-12727.1041C1512.3178,-12723.9301 1523.057,-12718.6574 1530.6973,-12710.0235 1608.2979,-12622.33 1514.5793,-12553.884 1566.6973,-12449.0235 1612.0195,-12357.836 1689.3083,-12380.9182 1728.717,-12287.0235 1770.3006,-12187.9472 1699.6233,-8504.511 1764.717,-8419.0235 1811.7218,-8357.2921 1861.0874,-8401.2063 1932.5662,-8371.0235 2213.2806,-8252.4883 2290.1261,-8221.2614 2527.3586,-8030.0235 2903.8871,-7726.4963 3010.9149,-7583.0337 3106.9189,-7109.0235 3165.6393,-6819.0976 3219.6916,-4561.5734 3225.3659,-4318.2603"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3228.866,-4318.291 3225.5994,-4308.2124 3221.8679,-4318.1283 3228.866,-4318.291"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge300" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1501.3103,-12727.196C1512.42,-12724.0197 1523.1318,-12718.723 1530.6973,-12710.0235 1574.6141,-12659.5242 1545.3071,-12474.4374 1566.6973,-12411.0235 1612.1598,-12276.2439 1690.7485,-12272.1029 1728.717,-12135.0235 1756.5534,-12034.5248 1717.5751,-8474.0423 1764.717,-8381.0235 1837.9689,-8236.4854 2840.4595,-7638.6268 2929.166,-7503.0235 3015.0367,-7371.7553 3031.9656,-7175.116 3035.2592,-7110.465"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3038.7639,-7110.4372 3035.717,-7100.2899 3031.771,-7110.1225 3038.7639,-7110.4372"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge313" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1647.7072,-12577.0235C1670.4321,-12537.7908 1708.4397,-12555.5754 1728.717,-12515.0235 1820.0076,-12332.4547 1672.5773,-9023.1653 1764.717,-8841.0235 1775.1996,-8820.3016 1796.0495,-8804.5964 1814.344,-8794.0494"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1816.2317,-8797.0066 1823.3353,-8789.1461 1812.8802,-8790.8611 1816.2317,-8797.0066"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1501.005,-12724.6914C1511.613,-12721.5639 1522.1773,-12716.9173 1530.6973,-12710.0235 1558.2016,-12687.769 1544.0836,-12666.2334 1566.6973,-12639.0235 1595.6762,-12604.1545 1624.9822,-12616.2562 1647.7072,-12577.0235"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge356" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2649.3109,-4373.0235C2779.774,-4240.4598 2832.8042,-4008.9316 2846.4445,-3938.1673"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2849.905,-3938.7029 2848.3014,-3928.2301 2843.0241,-3937.4171 2849.905,-3938.7029"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1647.7072,-12045.0235C1654.9594,-12001.0767 1708.3395,-12025.6301 1728.717,-11986.0235 1779.3616,-11887.5888 1754.621,-8111.2611 1764.717,-8001.0235 1804.1006,-7570.9974 1887.4907,-7473.4903 1932.5662,-7044.0235 1979.5916,-6595.9781 1904.5565,-6476.9594 1968.5662,-6031.0235 2012.6197,-5724.1158 2095.4448,-5661.7273 2140.8962,-5355.0235 2154.0375,-5266.3471 2126.6473,-4623.2613 2176.8962,-4549.0235 2281.2907,-4394.791 2383.6255,-4435.8278 2563.3586,-4387.0235 2600.7105,-4376.8811 2622.1622,-4400.6094 2649.3109,-4373.0235"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1501.2708,-12727.6266C1512.52,-12724.4578 1523.3068,-12719.0569 1530.6973,-12710.0235 1615.6987,-12606.1257 1503.6881,-12225.5556 1566.6973,-12107.0235 1587.9786,-12066.9894 1640.3584,-12089.763 1647.7072,-12045.0235"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge377" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1647.7072,-12577.0235C1670.4355,-12537.7928 1693.8973,-12544.0616 1728.717,-12515.0235 1920.0712,-12355.4431 2001.2975,-12341.4079 2140.8962,-12135.0235 2271.2829,-11942.2584 2282.8364,-11874.7633 2330.7283,-11647.0235 2368.5382,-11467.2263 2350.4227,-11004.0284 2366.7283,-10821.0235 2386.831,-10595.4007 2430.6787,-10324.0776 2443.4724,-10247.2241"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2446.9305,-10247.7651 2445.1282,-10237.3247 2440.0264,-10246.6103 2446.9305,-10247.7651"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1501.1971,-12728.0106C1512.5899,-12724.8545 1523.4635,-12719.3635 1530.6973,-12710.0235 1555.2545,-12678.3163 1565.3751,-6975.1067 1566.6973,-6935.0235 1584.6098,-6391.9917 1635.9633,-5728.0608 1645.9959,-5601.4314"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1649.5086,-5601.4088 1646.8124,-5591.1628 1642.5306,-5600.8539 1649.5086,-5601.4088"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge243" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-12121.0235C1655.8538,-12076.4224 1708.4556,-12099.5833 1728.717,-12059.0235 1778.274,-11959.8194 1695.11,-8153.3497 1764.717,-8067.0235 1812.7277,-8007.481 1883.1386,-8087.3952 1932.5662,-8029.0235 1977.8752,-7975.5157 1956.5005,-7468.0917 1968.5662,-7399.0235 2014.8428,-7134.1196 2096.2097,-7084.2002 2140.8962,-6819.0235 2155.6453,-6731.5007 2118.5105,-6087.8732 2176.8962,-6021.0235 2199.7531,-5994.8532 2229.9067,-6032.2395 2253.8123,-6007.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1501.2172,-12727.5826C1512.4674,-12724.4146 1523.2682,-12719.0251 1530.6973,-12710.0235 1605.4151,-12619.4903 1511.1555,-12286.4359 1566.6973,-12183.0235 1588.15,-12143.081 1639.5612,-12165.6247 1647.7072,-12121.0235"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge261" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1647.7072,-12045.0235C1654.9266,-12001.0712 1708.3383,-12025.6294 1728.717,-11986.0235 1779.0089,-11888.282 1746.2356,-8137.3799 1764.717,-8029.0235 1803.563,-7801.271 1891.5511,-7764.3954 1932.5662,-7537.0235 2033.4389,-6977.8235 1875.0192,-6819.4956 1968.5662,-6259.0235 2010.8779,-6005.5193 2097.806,-5960.3965 2140.8962,-5707.0235 2150.6728,-5649.5368 2141.1574,-4704.0999 2176.8962,-4658.0235 2284.9493,-4518.7156 2832.0196,-4553.145 2929.166,-4406.0235 2978.3114,-4331.5962 2958.4775,-2889.9615 2965.166,-2801.0235 2980.7788,-2593.4199 3020.3212,-2344.232 3032.4498,-2270.5371"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3035.9726,-2270.687 3034.1532,-2260.2496 3029.0666,-2269.5435 3035.9726,-2270.687"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge331" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1501.3125,-12727.6606C1512.5609,-12724.4912 1523.337,-12719.0814 1530.6973,-12710.0235 1578.3417,-12651.3901 1530.7994,-12097.5006 1566.6973,-12031.0235 1609.1496,-11952.4086 1688.0152,-11991.5588 1728.717,-11912.0235 1781.0957,-11809.6707 1757.6663,-7887.7837 1764.717,-7773.0235 1813.5473,-6978.2401 1871.0999,-6783.318 1968.5662,-5993.0235 2040.1215,-5412.8247 2085.0876,-5270.9481 2140.8962,-4689.0235 2147.2826,-4622.4316 2138.3724,-4142.7152 2176.8962,-4088.0235 2229.7198,-4013.0306 2278.7754,-4033.0727 2366.7283,-4007.0235 2401.4704,-3996.7338 2418.4697,-4015.3043 2447.0435,-3993.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-3993.0235C2499.0178,-3953.3863 2505.1057,-3932.6721 2563.3586,-3903.0235 2571.5972,-3898.8304 2580.6478,-3895.2361 2589.6883,-3892.1888"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2590.9795,-3895.4512 2599.4553,-3889.0943 2588.8652,-3888.7781 2590.9795,-3895.4512"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge487" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-12577.0235C1670.4321,-12537.7908 1698.5208,-12548.8438 1728.717,-12515.0235 1763.231,-12476.3672 1938.32,-12157.1031 1968.5662,-12115.0235 1990.4396,-12084.5923 2019.2873,-12052.0731 2037.426,-12032.3946"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2040.0248,-12034.7395 2044.2671,-12025.0311 2034.8965,-12029.975 2040.0248,-12034.7395"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge579" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2850.2146,-13193.0235C2870.8392,-13192.0504 3031.9167,-13213.2547 3036.0425,-13193.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2054.7312,-13041.0235C2354.7316,-13099.8141 2441.9191,-13054.9664 2735.2632,-13141.0235 2789.0693,-13156.8084 2794.2032,-13195.6662 2850.2146,-13193.0235"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge559" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-13375.0235C1761.8673,-13689.9042 1830.1484,-14094.9829 1845.3817,-14190.9726"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1841.9311,-14191.5606 1846.9412,-14200.8959 1848.8462,-14190.4738 1841.9311,-14191.5606"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge680" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1501.3603,-12727.6993C1512.6078,-12724.5292 1523.3715,-12719.1093 1530.6973,-12710.0235 1586.0594,-12641.3606 1512.7297,-11986.7879 1566.6973,-11917.0235 1573.4545,-11908.2884 1583.2096,-11902.5261 1593.625,-11898.7444"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1594.7595,-11902.0577 1603.3086,-11895.7997 1592.7229,-11895.3605 1594.7595,-11902.0577"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge623" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1501.1686,-12725.3954C1557.355,-12718.1907 1651.0939,-12703.6064 1728.717,-12679.0235 1823.6527,-12648.9578 1846.4459,-12636.0238 1932.5662,-12586.0235 2137.5994,-12466.9841 2199.8248,-12428.6931 2330.7283,-12231.0235 2352.256,-12198.5158 2337.394,-12176.7081 2366.7283,-12151.0235 2394.7576,-12126.4815 2430.5939,-12160.4506 2447.0435,-12127.0235"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge643" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1485.039,-12742.1156C1592.6713,-12775.4006 1934.0079,-12863.1827 2140.8962,-12713.0235 2170.1729,-12691.7746 2159.96,-12671.9892 2176.8962,-12640.0235 2241.7365,-12517.6428 2266.8555,-12491.9119 2330.7283,-12369.0235 2347.9654,-12335.86 2342.708,-12321.6585 2366.7283,-12293.0235 2422.9899,-12225.953 2483.8635,-12254.9972 2527.3586,-12179.0235 2573.4605,-12098.4966 2501.0291,-11831.7622 2563.3586,-11763.0235 2564.4101,-11761.8639 2565.5163,-11760.7718 2566.6712,-11759.7436"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2568.8271,-11762.505 2574.9345,-11753.8476 2564.7613,-11756.8068 2568.8271,-11762.505"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge747" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-13033.0235C1892.3984,-13175.9773 1994.2371,-13117.3119 2253.8123,-13231.0235"/>
</g>
<!-- sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge805" class="edge">
<title>sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2472.9344,-13713.941C2574.9336,-13668.7495 2951.019,-13487.3701 3106.9189,-13207.0235 3259.5246,-12932.6009 3228.9166,-10146.183 3416.4602,-10398.0235"/>
</g>
<!-- sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge694" class="edge">
<title>sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M2450.0502,-13714.0018C2462.2056,-13668.9243 2507.9838,-13494.021 2527.3586,-13347.0235 2537.2746,-13271.7909 2510.5319,-12719.4993 2563.3586,-12665.0235 2607.8908,-12619.1012 2829.9995,-12701.7138 2850.2146,-12641.0235"/>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M2850.2146,-12641.0235C2855.5341,-12624.7261 2956.5609,-10189.851 2965.166,-10175.0235 2972.4661,-10162.4447 2984.8431,-10152.8351 2997.2303,-10145.7911"/>
<polygon fill="#00cbff" stroke="#00cbff" points="2998.941,-10148.8463 3006.1795,-10141.1097 2995.6963,-10142.6437 2998.941,-10148.8463"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge806" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1316.6625,-8775.2735C1355.698,-8775.3622 1406.4315,-8775.3676 1451.4485,-8775.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3225.8566,-10130.0235C3256.9868,-10150.7206 3276.8885,-10124.543 3308.7942,-10144.0235 3422.4409,-10213.4122 3445.0854,-10258.0162 3488.1262,-10384.0235 3595.5816,-10698.6123 3539.2134,-16038.09 3587.3328,-16367.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1451.4485,-8775.0235C1574.7723,-8774.081 1635.659,-8683.0923 1728.717,-8764.0235 1815.7461,-8839.7114 1677.688,-8945.3356 1764.717,-9021.0235 1821.007,-9069.978 1858.5777,-9030.5531 1932.5662,-9021.0235 2043.9012,-9006.6838 2067.4755,-8982.0881 2176.8962,-8957.0235 2340.6763,-8919.507 2797.3404,-8776.8439 2929.166,-8881.0235 3376.8105,-9234.7896 2835.2895,-9714.0987 3225.8566,-10130.0235"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge447" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1264.0653,-8763.8874C1315.1279,-8716.7322 1511.4895,-8534.4361 1530.6973,-8502.0235 1560.8249,-8451.1838 1520.0428,-8410.2961 1566.6973,-8374.0235 1712.2398,-8260.868 3076.4623,-8255.0042 3225.8566,-8363.0235"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge698" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M2850.2146,-8971.0235C2878.4481,-8994.4313 2906.7109,-8966.0266 2929.166,-8995.0235 2987.2476,-9070.0259 2951.5336,-9754.146 2965.166,-9848.0235 2979.6056,-9947.4594 3014.4378,-10062.746 3029.2226,-10109.1237"/>
<polygon fill="#00cbff" stroke="#00cbff" points="3025.9754,-10110.4588 3032.3711,-10118.9055 3032.6388,-10108.3141 3025.9754,-10110.4588"/>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M1451.4485,-8775.0235C1513.1884,-8774.2372 1683.9143,-8750.5364 1728.717,-8793.0235 1827.44,-8886.6439 1673.6808,-8995.9126 1764.717,-9097.0235 1815.8958,-9153.866 1866.5842,-9096.336 1932.5662,-9135.0235 1953.1986,-9147.121 1946.7175,-9165.2929 1968.5662,-9175.0235 2038.5322,-9206.1837 2065.0547,-9185.7129 2140.8962,-9175.0235 2303.3068,-9152.1328 2723.9505,-8866.3405 2850.2146,-8971.0235"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge724" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1253.5674,-8786.4824C1263.4973,-8858.8968 1317.3405,-9260.551 1336.1997,-9590.0235 1346.236,-9765.359 1328.7324,-12580.8652 1372.1997,-12751.0235 1409.3284,-12896.3688 1464.017,-12914.6451 1530.6973,-13049.0235 1547.6686,-13083.2252 1540.4539,-13099.2915 1566.6973,-13127.0235 1635.1676,-13199.3778 1675.7644,-13187.1822 1764.717,-13232.0235 1775.0611,-13237.238 2133.516,-13403.0948 2140.8962,-13412.0235 2181.0056,-13460.5487 2133.4036,-13503.506 2176.8962,-13549.0235 2201.6356,-13574.9146 2225.332,-13551.315 2253.8123,-13573.0235"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2253.8123,-13573.0235C2281.2259,-13594.3733 2300.6656,-13569.6005 2330.7283,-13587.0235 2380.3865,-13615.8033 2418.5323,-13674.0512 2436.2164,-13704.8618"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2433.294,-13706.8071 2441.2277,-13713.829 2439.4045,-13703.3922 2433.294,-13706.8071"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1258.0702,-8763.6452C1274.6134,-8732.0126 1320.2263,-8639.8903 1336.1997,-8557.0235 1351.7215,-8476.4998 1323.3113,-5670.8636 1372.1997,-5605.0235 1376.4181,-5599.3425 1381.929,-5594.9206 1388.0823,-5591.484"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1389.8842,-5594.5064 1397.4816,-5587.122 1386.9375,-5588.1568 1389.8842,-5594.5064"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge669" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1451.4485,-8775.0235C1516.9486,-8775.0235 1687.474,-8824.1386 1728.717,-8875.0235 1802.1724,-8965.6513 1688.2408,-9046.93 1764.717,-9135.0235 1815.5819,-9193.6151 1863.9835,-9146.738 1932.5662,-9183.0235 1950.9757,-9192.7635 1948.9828,-9205.9334 1968.5662,-9213.0235 2203.7079,-9298.1566 2308.8213,-9025.4476 2527.3586,-9147.0235 2680.4889,-9232.2124 2672.1848,-9318.5391 2735.2632,-9482.0235 2779.9752,-9597.9066 2834.5059,-9992.2337 2847.3917,-10088.6309"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2843.9356,-10089.1929 2848.7233,-10098.6442 2850.8745,-10088.2701 2843.9356,-10089.1929"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge684" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1253.4221,-8786.492C1262.464,-8858.9647 1311.8298,-9260.9127 1336.1997,-9590.0235 1362.5481,-9945.8527 1331.8772,-10037.5059 1372.1997,-10392.0235 1381.0794,-10470.0943 1610.4335,-11693.4045 1643.6995,-11870.6742"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1640.2805,-11871.4319 1645.5651,-11880.6146 1647.1604,-11870.1406 1640.2805,-11871.4319"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge810" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3587.3328,-16367.0235C3642.3962,-16746.7489 3745.2707,-17204.1558 3768.7963,-17306.8764"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3765.3962,-17307.7084 3771.0458,-17316.6713 3772.2186,-17306.1416 3765.3962,-17307.7084"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1523.3274,-7037.1123C1525.91,-7038.5709 1528.3802,-7040.2016 1530.6973,-7042.0235 1560.394,-7065.3744 1546.09,-7087.3612 1566.6973,-7119.0235 1626.4998,-7210.9077 1685.9182,-7204.0913 1728.717,-7305.0235 1801.8568,-7477.5084 1699.965,-7549.2179 1764.717,-7725.0235 1873.6405,-8020.757 1933.1119,-8102.2942 2176.8962,-8302.0235 2460.4287,-8534.318 2639.3681,-8415.5941 2929.166,-8640.0235 3029.0998,-8717.4157 3048.4351,-8749.9701 3106.9189,-8862.0235 3383.934,-9392.7765 3397.8067,-9562.1802 3488.1262,-10154.0235 3696.4409,-11519.0625 3389.1712,-15000.4737 3587.3328,-16367.0235"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge599" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1512.1987,-7037.0543C1519.2227,-7040.5317 1525.6606,-7045.0801 1530.6973,-7051.0235 1604.4108,-7138.0075 1498.928,-7213.3326 1566.6973,-7305.0235 1613.9726,-7368.9864 1684.9763,-7314.5935 1728.717,-7381.0235 1796.6396,-7484.179 1683.1246,-8399.3024 1764.717,-8492.0235 1821.4199,-8556.4602 2443.7123,-8595.773 2527.3586,-8615.0235 2709.1101,-8656.8521 2802.2298,-8599.3837 2929.166,-8736.0235 3176.7682,-9002.5536 3056.5236,-9174.7383 3106.9189,-9535.0235 3116.309,-9602.1548 3099.1306,-10092.2803 3142.9189,-10144.0235 3191.7765,-10201.757 3261.1254,-10123.3047 3308.7942,-10182.0235 3408.6107,-10304.9783 3416.0375,-15688.0755 3416.4401,-16071.515"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="3412.94,-16071.6054 3416.4502,-16081.6018 3419.94,-16071.5983 3412.94,-16071.6054"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M1464.2891,-7037.1995C1482.9354,-7054.3446 1516.7948,-7089.1532 1530.6973,-7127.0235 1602.5841,-7322.8432 1537.6107,-7858.4635 1566.6973,-8065.0235 1583.391,-8183.5748 1624.7432,-8321.5696 1640.9951,-8373.1623"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1637.7004,-8374.3514 1644.0642,-8382.8221 1644.3718,-8372.2317 1637.7004,-8374.3514"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-6949.0235C1680.5241,-6930.7714 1694.2668,-6939.966 1728.717,-6925.0235 1976.9341,-6817.3617 1987.5242,-6664.9135 2253.8123,-6617.0235"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge306" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1495.2085,-7037.0869C1507.0291,-7040.8051 1519.6105,-7045.454 1530.6973,-7051.0235 1548.3335,-7059.8832 1549.6034,-7067.1579 1566.6973,-7077.0235 1721.0348,-7166.0977 1818.5875,-7104.0449 1932.5662,-7241.0235 1975.8658,-7293.0606 1921.4953,-7340.3712 1968.5662,-7389.0235 1996.2078,-7417.5939 2018.7202,-7396.1849 2054.7312,-7413.0235"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge312" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1463.6482,-7037.046C1481.7919,-7054.2577 1515.3884,-7089.4587 1530.6973,-7127.0235 1586.3772,-7263.6502 1541.8812,-7311.5887 1566.6973,-7457.0235 1619.9734,-7769.2492 1681.7468,-7837.7871 1728.717,-8151.0235 1746.0914,-8266.8904 1721.169,-8568.255 1764.717,-8677.0235 1778.2573,-8710.8427 1807.5912,-8741.7928 1827.7275,-8760.2796"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1825.4135,-8762.9056 1835.2017,-8766.9604 1830.0784,-8757.6866 1825.4135,-8762.9056"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge360" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1454.8424,-7014.9647C1481.3264,-6928.1488 1655.7828,-6346.757 1728.717,-5861.0235 1747.1679,-5738.1432 1705.2016,-5412.1011 1764.717,-5303.0235 1809.1407,-5221.6056 1887.9299,-5260.325 1932.5662,-5179.0235 1987.8848,-5078.2649 1940.9236,-4774.5956 1968.5662,-4663.0235 2014.1381,-4479.0837 2079.0987,-4452.1651 2140.8962,-4273.0235 2162.1283,-4211.4751 2133.0186,-4179.1251 2176.8962,-4131.0235 2288.2442,-4008.9564 2381.4155,-4084.4788 2527.3586,-4007.0235 2586.8608,-3975.4444 2581.9859,-3919.2796 2649.3109,-3917.0235"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge376" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1512.7663,-7037.1002C1519.6103,-7040.5759 1525.8482,-7045.1115 1530.6973,-7051.0235 1624.2611,-7165.0977 1480.9221,-7260.983 1566.6973,-7381.0235 1612.9389,-7445.7376 1685.0409,-7390.551 1728.717,-7457.0235 1800.8691,-7566.8348 1702.6175,-8523.2302 1764.717,-8639.0235 1807.9362,-8719.6116 1872.0705,-8689.4479 1932.5662,-8758.0235 2062.3098,-8905.0959 2048.7617,-8973.8909 2140.8962,-9147.0235 2151.4951,-9166.9401 2324.6616,-9484.2934 2330.7283,-9506.0235 2367.7793,-9638.7366 2317.5514,-9996.31 2366.7283,-10125.0235 2379.4479,-10158.3154 2407.3734,-10189.2329 2426.6947,-10207.8711"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2424.4422,-10210.5572 2434.1286,-10214.8497 2429.2333,-10205.4536 2424.4422,-10210.5572"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge248" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2649.3109,-5893.0235C2825.1231,-5750.5163 2847.325,-4955.6934 2849.8977,-4813.7256"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2853.4037,-4813.3863 2850.0711,-4803.3293 2846.4047,-4813.2695 2853.4037,-4813.3863"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1496.1677,-7014.9587C1507.7458,-7011.2827 1519.9668,-7006.6552 1530.6973,-7001.0235 1548.6454,-6991.6038 1548.6672,-6982.2852 1566.6973,-6973.0235 1600.0993,-6955.8655 1615.2359,-6967.8839 1647.7072,-6949.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-6949.0235C1697.1674,-6920.2953 1697.7171,-6897.0925 1728.717,-6849.0235 1969.6069,-6475.496 1849.7082,-6255.8536 2176.8962,-5955.0235 2294.2227,-5847.1488 2368.2374,-5869.9199 2527.3586,-5879.0235 2581.8266,-5882.1397 2606.9284,-5927.3773 2649.3109,-5893.0235"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge260" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1458.6106,-7014.8834C1495.4831,-6956.8549 1664.6519,-6682.2514 1728.717,-6431.0235 1759.9692,-6308.47 1716.2308,-5979.8359 1764.717,-5863.0235 1807.9132,-5758.9559 1889.0394,-5776.9532 1932.5662,-5673.0235 2021.3728,-5460.9783 1903.755,-5377.5893 1968.5662,-5157.0235 2013.4457,-5004.2892 2095.6664,-4995.6545 2140.8962,-4843.0235 2156.2179,-4791.3196 2137.3756,-4395.7137 2176.8962,-4359.0235 2286.6834,-4257.0991 2733.6377,-4486.1066 2850.2146,-4392.0235"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge558" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1453.9827,-7037.1935C1465.5788,-7088.9091 1513.7426,-7310.4132 1530.6973,-7495.0235 1577.0812,-8000.0722 1536.6046,-9270.7428 1566.6973,-9777.0235 1608.2667,-10476.3885 1678.049,-10646.2588 1728.717,-11345.0235 1772.186,-11944.5052 1840.2573,-13961.0893 1847.9309,-14190.6832"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1844.4357,-14190.8902 1848.2674,-14200.7678 1851.4318,-14190.6566 1844.4357,-14190.8902"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge812" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1075.0884,-14261.1576C1079.7098,-14387.0942 1123.182,-15540.0183 1167.7661,-15595.0235 1216.78,-15655.494 1271.8026,-15599.2966 1336.1997,-15643.0235 1394.8686,-15682.8609 1501.7256,-15831.2957 1530.6973,-15896.0235 1565.9881,-15974.8695 1508.8449,-16022.8735 1566.6973,-16087.0235 1745.0261,-16284.7648 1900.7528,-16142.9847 2140.8962,-16258.0235 2233.345,-16302.3104 2271.6955,-16305.2189 2330.7283,-16389.0235 2366.4885,-16439.7897 2320.235,-16482.8607 2366.7283,-16524.0235 2410.8187,-16563.059 3360.937,-16690.6426 3416.4602,-16671.0235"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge826" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#f3ff00" stroke-dasharray="5,2" d="M1115.8677,-14239.018C1122.1582,-14235.5475 1127.8494,-14230.9939 1131.7661,-14225.0235 1217.7471,-14093.9583 1071.0655,-3062.392 1167.7661,-2939.0235 1169.9042,-2936.2958 1172.3379,-2933.8887 1174.9968,-2931.7667"/>
<polygon fill="#f3ff00" stroke="#f3ff00" points="1177.0801,-2934.5876 1183.5788,-2926.22 1173.2804,-2928.7086 1177.0801,-2934.5876"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge481" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1115.2012,-14238.915C1121.6421,-14235.4504 1127.5576,-14230.9254 1131.7661,-14225.0235 1189.2388,-14144.4257 1153.2092,-13878.9378 1167.7661,-13781.0235 1219.5365,-13432.7998 1283.1929,-13355.0612 1336.1997,-13007.0235 1363.6084,-12827.0609 1311.8772,-12770.7762 1372.1997,-12599.0235 1414.3131,-12479.1166 1478.9224,-12477.0863 1530.6973,-12361.0235 1556.871,-12302.3503 1526.9397,-12271.4907 1566.6973,-12221.0235 1617.1469,-12156.9842 1680.0243,-12200.4087 1728.717,-12135.0235 1777.4457,-12069.5902 1701.6245,-12006.7471 1764.717,-11955.0235 1822.4081,-11907.7282 1863.2444,-11927.4627 1932.5662,-11955.0235 1953.017,-11963.1543 1949.4631,-11978.0957 1968.5662,-11989.0235 1975.8544,-11993.1927 1983.8939,-11996.7146 1992.045,-11999.6769"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1991.0326,-12003.0291 2001.6267,-12002.9027 1993.2661,-11996.3949 1991.0326,-12003.0291"/>
</g>
<!-- sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge816" class="edge">
<title>sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3036.4062,-11793.8259C3040.8222,-11659.4542 3084.9823,-10359.9764 3142.9189,-10306.0235 3236.7863,-10218.6105 3343.2977,-10292.67 3416.4602,-10398.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3416.4602,-10398.0235C3614.6034,-10664.0974 3539.0023,-16038.8159 3587.3328,-16367.0235"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge428" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1455.2425,-5568.9345C1469.3348,-5527.8771 1520.2508,-5380.6967 1566.6973,-5261.0235 1634.6087,-5086.0442 1683.8429,-5053.2761 1728.717,-4871.0235 1771.7093,-4696.4141 1732.8453,-4645.0009 1764.717,-4468.0235 1814.782,-4190.0225 1860.5547,-4128.1634 1932.5662,-3855.0235 1949.1642,-3792.067 1938.515,-3770.7811 1968.5662,-3713.0235 2022.7233,-3608.9349 2096.4269,-3621.6049 2140.8962,-3513.0235 2163.8125,-3457.0686 2135.2356,-3013.8471 2176.8962,-2970.0235 2280.6951,-2860.8355 2699.5619,-2891.0235 2850.2146,-2891.0235 2850.2146,-2891.0235 2850.2146,-2891.0235 3036.0425,-2891.0235 3205.117,-2891.0235 3389.4287,-2724.1238 3416.4602,-2891.0235"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M1452.2188,-5591.0687C1464.8511,-5772.1929 1628.8336,-8123.41 1646.2181,-8372.6727"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1642.7466,-8373.2043 1646.9339,-8382.9365 1649.7296,-8372.7172 1642.7466,-8373.2043"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1466.4945,-5568.8937C1513.1482,-5533.5564 1656.5586,-5418.5691 1728.717,-5289.0235 1759.5616,-5233.6485 1742.5467,-5210.4058 1764.717,-5151.0235 1836.174,-4959.629 1811.1958,-4869.3022 1968.5662,-4739.0235 1999.188,-4713.6733 2016.309,-4704.8225 2054.7312,-4715.0235"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1505.3366,-5580.0235C1521.0834,-5580.0235 1538.7524,-5580.0235 1556.1451,-5580.0235"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1556.3371,-5583.5236 1566.3371,-5580.0235 1556.3371,-5576.5236 1556.3371,-5583.5236"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge891" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0058ff" stroke-dasharray="5,2" d="M588.2562,-6159.3141C598.6856,-6206.2801 638.4592,-6390.915 654.4731,-6545.0235 719.3121,-7168.9938 756.6014,-9277.3999 760.6051,-9513.4759"/>
<polygon fill="#0058ff" stroke="#0058ff" points="757.1113,-9513.8755 760.7794,-9523.8151 764.1103,-9513.7575 757.1113,-9513.8755"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge429" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M638.1773,-6136.8976C644.5569,-6133.4461 650.2873,-6128.9303 654.4731,-6123.0235 707.14,-6048.7041 672.9817,-2933.4172 690.4731,-2844.0235 813.0567,-2217.5335 1155.2851,-2173.2214 1336.1997,-1561.0235 1372.4201,-1438.4572 1300.0327,-1092.505 1372.1997,-987.0235 1567.8004,-701.1277 2585.7831,-865.3703 2929.166,-911.0235 3097.9797,-933.4675 3148.0305,-906.838 3308.7942,-963.0235 3361.3446,-981.3894 3385.1552,-980.9925 3416.4602,-1027.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3416.4602,-1027.0235C3466.4881,-1095.0709 3471.3803,-1120.2418 3488.1262,-1203.0235 3572.8246,-1621.7203 3586.5274,-8678.8736 3587.2967,-9116.7556"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3583.7968,-9116.8393 3587.3142,-9126.8332 3590.7968,-9116.8271 3583.7968,-9116.8393"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge461" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M637.7343,-6137.0019C644.2635,-6133.5383 650.1544,-6128.9914 654.4731,-6123.0235 692.5326,-6070.4303 676.0796,-5018.3275 690.4731,-4955.0235 798.0002,-4482.1107 1005.6857,-4425.3314 1131.7661,-3957.0235 1150.7713,-3886.4314 1118.3384,-3683.8877 1167.7661,-3630.0235 1252.8791,-3537.271 1603.3957,-3539.1145 1728.717,-3551.0235 1749.6601,-3553.0137 1772.3865,-3556.9169 1792.3669,-3560.951"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1791.7344,-3564.3943 1802.2369,-3562.9984 1793.1562,-3557.5402 1791.7344,-3564.3943"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge499" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M760.9651,-11243.0235C762.7752,-11276.0698 811.9759,-11240.2688 831.457,-11267.0235 868.0549,-11317.2857 859.8473,-13443.3163 867.457,-13505.0235 894.7723,-13726.5213 953.8879,-13772.5752 981.6013,-13994.0235 994.2216,-14094.8677 961.3825,-15738.3579 1017.6013,-15823.0235 1052.1111,-15874.9953 1489.0095,-16004.611 1530.6973,-16051.0235 1565.6361,-16089.9222 1529.3032,-16126.4789 1566.6973,-16163.0235 1593.5533,-16189.2694 1611.504,-16177.0522 1647.7072,-16187.0235"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge516" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M588.3721,-6159.3029C599.2586,-6206.2246 640.5852,-6390.7089 654.4731,-6545.0235 660.0556,-6607.0526 659.7688,-10974.8385 690.4731,-11029.0235 726.6585,-11092.8809 794.8053,-11051.4326 831.457,-11115.0235 919.5892,-11267.9331 768.1393,-12557.131 867.457,-12703.0235 898.4268,-12748.5164 946.2447,-12708.8496 981.6013,-12751.0235 1028.1504,-12806.5479 1000.1167,-12839.7095 1017.6013,-12910.0235 1148.172,-13435.1118 1212.2726,-13558.3277 1336.1997,-14085.0235 1354.8855,-14164.4391 1336.4155,-14191.7058 1372.1997,-14265.0235 1489.4895,-14505.3367 1563.0772,-14545.3855 1764.717,-14721.0235 1955.2767,-14887.0101 2076.1529,-15190.7502 2253.8123,-15011.0235"/>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M2253.8123,-15011.0235C2284.7366,-14979.853 2303.9037,-14983.7849 2330.7283,-14949.0235 2390.8066,-14871.1694 2427.8872,-14757.3609 2441.3274,-14710.9218"/>
<polygon fill="#65ff00" stroke="#65ff00" points="2444.7501,-14711.6802 2444.1037,-14701.1051 2438.0143,-14709.7752 2444.7501,-14711.6802"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge531" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M760.9651,-11015.0235C764.4,-11056.6055 813.1501,-11039.5306 831.457,-11077.0235 890.9403,-11198.8465 828.8428,-11556.0695 867.457,-11686.0235 882.0327,-11735.0772 884.7663,-11753.8113 924.5292,-11786.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M924.5292,-11786.0235C963.2301,-11817.3755 1322.4093,-11764.3017 1372.1997,-11763.0235 1442.6199,-11761.2157 1460.5084,-11757.0416 1530.6973,-11763.0235 1619.6714,-11770.6065 1661.1305,-11738.663 1728.717,-11797.0235 1767.6511,-11830.6429 1734.6024,-11865.3194 1764.717,-11907.0235 1791.8659,-11944.6204 1818.7607,-11933.5592 1848.6416,-11969.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M588.366,-6159.3035C599.2287,-6206.2273 640.4741,-6390.7189 654.4731,-6545.0235 730.8141,-7386.4944 642.0827,-9503.4836 690.4731,-10347.0235 707.5709,-10645.0709 736.3875,-10717.4995 760.9651,-11015.0235"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge596" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M760.9651,-11243.0235C762.7155,-11276.073 811.9202,-11240.3094 831.457,-11267.0235 889.7785,-11346.7709 852.1746,-12947.4146 867.457,-13045.0235 885.4847,-13160.1662 1129.2611,-13940.0226 1167.7661,-14050.0235 1206.9483,-14161.9589 1488.5967,-14950.7763 1566.6973,-15040.0235 1959.9374,-15489.3877 2216.6572,-15407.0271 2735.2632,-15703.0235 2786.4277,-15732.2258 2798.6868,-15740.4672 2850.2146,-15769.0235"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M588.3733,-6159.3028C599.2648,-6206.224 640.608,-6390.7068 654.4731,-6545.0235 660.259,-6609.4188 658.6062,-11143.7676 690.4731,-11200.0235 708.5611,-11231.9549 759.0071,-11206.3772 760.9651,-11243.0235"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M2850.2146,-15769.0235C2882.1253,-15784.8885 2895.7568,-15770.6212 2929.166,-15783.0235 2933.6577,-15784.6909 3221.6097,-15956.8056 3225.8566,-15959.0235"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge690" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M760.9651,-6451.0235C780.045,-6466.6459 957.6976,-6468.9642 981.6013,-6475.0235 1336.1331,-6564.8929 1482.6592,-6549.4227 1728.717,-6820.0235 1923.8674,-7034.6391 1828.0261,-7173.2677 1968.5662,-7427.0235 2323.4171,-8067.7341 2694.0793,-8072.364 2929.166,-8766.0235 3018.6118,-9029.947 3033.8776,-9955.9226 3035.8025,-10108.6272"/>
<polygon fill="#00cbff" stroke="#00cbff" points="3032.3067,-10109.005 3035.9269,-10118.9621 3039.3062,-10108.9207 3032.3067,-10109.005"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge711" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M760.9651,-11015.0235C764.4353,-11056.6026 813.8351,-11039.2038 831.457,-11077.0235 868.7272,-11157.0116 817.7981,-12592.0773 867.457,-12665.0235 898.4268,-12710.5164 945.1704,-12671.7741 981.6013,-12713.0235 1020.7213,-12757.3177 987.265,-12790.3081 1017.6013,-12841.0235 1053.7714,-12901.4916 1099.7399,-12888.2622 1131.7661,-12951.0235 1183.9901,-13053.3662 1114.2081,-13105.3725 1167.7661,-13207.0235 1215.0477,-13296.7621 1292.6976,-13269.3931 1336.1997,-13361.0235 1397.1017,-13489.304 1313.0833,-13869.9104 1372.1997,-13999.0235 1484.4862,-14244.2627 1682.9984,-14334.3293 1932.5662,-14232.0235 2189.0123,-14126.898 2386.1276,-13825.3936 2435.213,-13744.9511"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2438.2852,-13746.6343 2440.4593,-13736.2649 2432.2933,-13743.0153 2438.2852,-13746.6343"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge758" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2649.3109,-12469.0235C2733.9233,-12520.1339 2692.1397,-12595.7698 2771.2632,-12655.0235 2800.619,-12677.0074 2813.8938,-12684.1076 2850.2146,-12679.0235"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M924.5292,-11786.0235C928.3858,-11789.6425 1012.3737,-11805.2222 1017.6013,-11806.0235 1174.4738,-11830.0707 1613.1041,-11763.2996 1728.717,-11872.0235 1804.7301,-11943.5072 1703.0435,-12019.8554 1764.717,-12104.0235 1824.4787,-12185.5824 1876.0378,-12164.2584 1968.5662,-12205.0235 2265.5311,-12335.857 2371.5453,-12301.2385 2649.3109,-12469.0235"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M638.1276,-6136.8622C644.5143,-6133.4158 650.2599,-6128.9108 654.4731,-6123.0235 711.9065,-6042.7707 654.9515,-4439.0959 690.4731,-4347.0235 724.8287,-4257.9735 785.2284,-4268.5287 831.457,-4185.0235 942.5989,-3984.2622 941.4867,-3916.9626 981.6013,-3691.0235 1006.4252,-3551.2068 970.898,-3187.127 1017.6013,-3053.0235 1046.5707,-2969.8411 1098.3174,-2972.508 1131.7661,-2891.0235 1168.7243,-2800.9897 1116.8405,-2757.9607 1167.7661,-2675.0235 1216.407,-2595.8072 1280.8543,-2625.7098 1336.1997,-2551.0235 1364.8221,-2512.3988 1346.9624,-2489.9404 1372.1997,-2449.0235 1522.2548,-2205.741 1563.4891,-2036.7958 1848.6416,-2017.0235"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge387" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M638.1512,-6136.879C644.5345,-6133.4302 650.2729,-6128.9201 654.4731,-6123.0235 691.0614,-6071.6591 682.9518,-3915.6369 690.4731,-3853.0235 724.2282,-3572.0203 771.9189,-3508.7136 831.457,-3232.0235 848.3445,-3153.5426 850.2597,-3133.4371 867.457,-3055.0235 914.8959,-2838.7196 939.5057,-2787.4304 981.6013,-2570.0235 1001.7708,-2465.856 972.2354,-2429.9381 1017.6013,-2334.0235 1050.0529,-2265.413 1090.0252,-2270.4128 1131.7661,-2207.0235 1152.7641,-2175.1352 1140.0516,-2155.2853 1167.7661,-2129.0235 1226.2459,-2073.6091 1289.3558,-2127.5696 1336.1997,-2062.0235 1431.5412,-1928.6175 1285.6058,-1464.2667 1372.1997,-1325.0235 1416.7591,-1253.3718 1813.6466,-1057.6246 1968.5662,-1022.0235 2277.2502,-951.0867 3148.7353,-1233.7124 3308.7942,-1507.0235 3348.0559,-1574.0655 3342.7456,-2827.3581 3344.7942,-2905.0235 3373.7222,-4001.7364 3410.8094,-5353.3288 3415.8772,-5537.8092"/>
<polygon fill="#002eff" stroke="#002eff" points="3412.3796,-5537.9487 3416.153,-5547.8487 3419.377,-5537.7564 3412.3796,-5537.9487"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge417" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M638.1601,-6136.8853C644.5421,-6133.4356 650.2778,-6128.9236 654.4731,-6123.0235 695.3,-6065.6076 682.9495,-3657.0722 690.4731,-3587.0235 732.7978,-3192.9613 760.1285,-3094.5428 867.457,-2713.0235 907.6692,-2570.0818 941.712,-2542.0557 981.6013,-2399.0235 1003.7517,-2319.5983 965.4951,-2280.9294 1017.6013,-2217.0235 1034.9926,-2195.6938 1058.1289,-2215.0087 1074.6837,-2193.0235"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.2077,-6159.2554C594.5439,-6213.1821 628.9941,-6450.5464 690.4731,-6636.0235 788.4107,-6931.4926 909.3847,-6970.2389 981.6013,-7273.0235 1075.4031,-7666.3087 922.3495,-7789.087 1017.6013,-8182.0235 1045.9025,-8298.7727 1104.1269,-8310.1158 1131.7661,-8427.0235 1148.0569,-8495.93 1124.3139,-9645.1183 1167.7661,-9701.0235 1215.5349,-9762.4823 1270.1544,-9707.8282 1336.1997,-9749.0235 1401.1512,-9789.5366 1378.5456,-9853.6745 1451.4485,-9877.0235"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M643.6054,-6155.3698C658.8444,-6157.2593 675.2733,-6159.2566 690.4731,-6161.0235 977.2132,-6194.3558 1051.8839,-6181.0692 1336.1997,-6231.0235 1513.0842,-6262.1021 1555.6087,-6279.1956 1728.717,-6327.0235 1836.2462,-6356.7326 1861.5227,-6369.6094 1968.5662,-6401.0235 2006.7108,-6412.2178 2024.7395,-6398.9308 2054.7312,-6425.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2054.7312,-6425.0235C2089.2786,-6442.6798 2111.3835,-6413.8388 2140.8962,-6439.0235 2179.7048,-6472.1408 2148.9671,-6505.3289 2176.8962,-6548.0235 2202.0369,-6586.4553 2208.1961,-6611.7119 2253.8123,-6617.0235"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge274" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M3036.0425,-1521.0235C3117.869,-1666.4511 3133.7172,-2852.4099 3142.9189,-3019.0235 3171.0986,-3529.2671 3215.53,-4153.4383 3224.3177,-4275.6934"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3220.8461,-4276.2141 3225.0551,-4285.937 3227.828,-4275.7114 3220.8461,-4276.2141"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M638.1487,-6136.8772C644.5323,-6133.4287 650.2715,-6128.9191 654.4731,-6123.0235 725.5462,-6023.2976 615.2042,-4015.6218 690.4731,-3919.0235 730.3604,-3867.8331 790.1044,-3931.0376 831.457,-3881.0235 865.8198,-3839.4633 857.0656,-3449.9392 867.457,-3397.0235 899.1487,-3235.6416 950.3656,-3206.4943 981.6013,-3045.0235 1025.9367,-2815.8345 942.5033,-2742.0518 1017.6013,-2521.0235 1056.3975,-2406.8387 1090.4769,-2387.5961 1167.7661,-2295.0235 1234.3327,-2215.2939 1292.6564,-2227.3204 1336.1997,-2133.0235 1391.8257,-2012.5607 1310.4716,-1654.4763 1372.1997,-1537.0235 1616.8406,-1071.5347 2010.0723,-1186.4515 2527.3586,-1281.0235 2715.1774,-1315.3611 2763.9715,-1337.2857 2929.166,-1433.0235 2942.4751,-1440.7367 3028.4993,-1507.6173 3036.0425,-1521.0235"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge286" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M643.4411,-6156.7026C647.4229,-6158.6952 651.1622,-6161.1075 654.4731,-6164.0235 756.5731,-6253.9464 652.9769,-6368.2644 760.9651,-6451.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M760.9651,-6451.0235C772.5116,-6459.8724 1003.1266,-6400.4752 1017.6013,-6399.0235 1068.088,-6393.9601 1081.7766,-6390.3296 1131.7661,-6399.0235 1334.0899,-6434.2105 1369.7583,-6496.816 1566.6973,-6555.0235 1637.6269,-6575.9876 1670.7381,-6547.1002 1728.717,-6593.0235 1888.241,-6719.3775 1846.3389,-6818.6921 1932.5662,-7003.0235 1949.4309,-7039.0759 1941.6725,-7055.6819 1968.5662,-7085.0235 2039.8829,-7162.8319 2078.2324,-7161.5312 2176.8962,-7199.0235 2292.0493,-7242.7818 2336.9722,-7205.7124 2447.0435,-7261.0235"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge341" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M638.1367,-6136.8687C644.5221,-6133.4213 650.2649,-6128.9144 654.4731,-6123.0235 717.0691,-6035.4001 634.4191,-4276.9694 690.4731,-4185.0235 727.527,-4124.2439 792.3782,-4168.5214 831.457,-4109.0235 882.6403,-4031.0965 838.7099,-3779.7137 867.457,-3691.0235 897.8318,-3597.312 952.4927,-3595.136 981.6013,-3501.0235 1061.8499,-3241.5675 954.2938,-3155.1246 1017.6013,-2891.0235 1020.0318,-2880.8844 1161.6173,-2555.4437 1167.7661,-2547.0235 1226.5353,-2466.5448 1287.7349,-2486.0971 1336.1997,-2399.0235 1383.3189,-2314.3675 1334.6727,-2273.3465 1372.1997,-2184.0235 1429.0653,-2048.6701 1452.6471,-2009.4723 1566.6973,-1917.0235 1774.4583,-1748.6129 1887.9272,-1650.2279 2140.8962,-1737.0235 2160.0689,-1743.6018 2160.0956,-1753.6831 2176.8962,-1765.0235 2234.447,-1803.8702 2407.83,-1864.7219 2447.0435,-1922.0235"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge372" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M586.4906,-6159.2699C590.0668,-6203.4293 608.5428,-6367.3111 690.4731,-6465.0235 736.2096,-6519.5701 788.1246,-6484.5483 831.457,-6541.0235 873.7184,-6596.1028 832.2601,-6633.1826 867.457,-6693.0235 903.2131,-6753.8151 1297.9307,-7061.7816 1336.1997,-7121.0235 1364.1119,-7164.2327 1350.8264,-7184.2335 1372.1997,-7231.0235 1429.0626,-7355.5064 1491.6623,-7363.8532 1530.6973,-7495.0235 1591.0819,-7697.9359 1537.0125,-8237.4082 1566.6973,-8447.0235 1608.5646,-8742.6644 1669.1726,-8806.4301 1728.717,-9099.0235 1749,-9198.6914 1711.8799,-9238.1136 1764.717,-9325.0235 1812.8985,-9404.2755 1865.3812,-9385.082 1932.5662,-9449.0235 1950.869,-9466.4427 1952.2111,-9473.7639 1968.5662,-9493.0235 2126.1588,-9678.6039 2226.609,-9683.9446 2330.7283,-9904.0235 2373.2871,-9993.981 2326.4546,-10034.02 2366.7283,-10125.0235 2381.1663,-10157.6481 2408.7211,-10188.7672 2427.4864,-10207.6291"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2425.338,-10210.4246 2434.9267,-10214.931 2430.2411,-10205.4286 2425.338,-10210.4246"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M633.7538,-6136.8642C641.3976,-6133.4134 648.6809,-6128.9062 654.4731,-6123.0235 688.7907,-6088.1696 664.859,-6060.6937 690.4731,-6019.0235 713.3806,-5981.7566 1208.2888,-5464.9276 1251.9829,-5467.0235"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge226" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M637.7125,-6136.986C644.2446,-6133.5247 650.1422,-6128.9826 654.4731,-6123.0235 721.8626,-6030.3001 664.3122,-5203.6236 690.4731,-5092.0235 725.1097,-4944.2673 777.4036,-4922.8326 831.457,-4781.0235 930.2978,-4521.7148 932.297,-4449.0949 1017.6013,-4185.0235 1066.8598,-4032.537 1099.2787,-3999.941 1131.7661,-3843.0235 1150.6228,-3751.9437 1126.6397,-3509.4485 1167.7661,-3426.0235 1222.2134,-3315.5772 1269.395,-3306.8032 1372.1997,-3239.0235 1451.4124,-3186.7982 1473.9507,-3171.0288 1566.6973,-3151.0235 1637.0872,-3135.8405 1656.7781,-3147.8535 1728.717,-3151.0235 1917.6852,-3159.3503 2011.6612,-3118.9054 2140.8962,-3257.0235 2174.3154,-3292.7398 2156.7033,-3316.4731 2176.8962,-3361.0235 2233.9126,-3486.8153 2263.8237,-3510.2004 2330.7283,-3631.0235 2514.5752,-3963.0332 2623.6145,-4020.305 2735.2632,-4383.0235 2780.7472,-4530.7896 2697.0741,-4593.3784 2771.2632,-4729.0235 2782.1549,-4748.9376 2802.2162,-4764.8197 2819.3902,-4775.6561"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2817.67,-4778.7057 2828.044,-4780.8575 2821.2761,-4772.706 2817.67,-4778.7057"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge256" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M638.1404,-6136.8713C644.5253,-6133.4236 650.2669,-6128.9158 654.4731,-6123.0235 719.4911,-6031.9423 654.4092,-4214.9599 690.4731,-4109.0235 724.3604,-4009.4809 794.2036,-4017.3559 831.457,-3919.0235 897.5179,-3744.6522 788.7143,-3670.0471 867.457,-3501.0235 897.7348,-3436.0314 952.5868,-3452.5894 981.6013,-3387.0235 1050.2022,-3232.0019 948.9935,-2780.042 1017.6013,-2625.0235 1046.6214,-2559.453 1094.3748,-2572.208 1131.7661,-2511.0235 1159.0311,-2466.4091 1132.9385,-2438.0218 1167.7661,-2399.0235 1222.4708,-2337.7678 1288.4181,-2389.82 1336.1997,-2323.0235 1385.2921,-2254.3946 1334.7755,-2020.6504 1372.1997,-1945.0235 1513.5301,-1659.4227 1659.6994,-1625.4034 1968.5662,-1547.0235 2091.5952,-1515.8029 2133.601,-1520.2787 2253.8123,-1561.0235"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2253.8123,-1561.0235C2428.5897,-1599.6423 2480.9305,-1576.3062 2649.3109,-1637.0235"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M586.8447,-6159.3238C592.051,-6207.8363 616.7661,-6402.2758 690.4731,-6541.0235 735.2516,-6625.3153 783.6427,-6620.416 831.457,-6703.0235 855.96,-6745.3567 841.9532,-6765.2857 867.457,-6807.0235 889.5965,-6843.2554 1106.6973,-7048.7531 1131.7661,-7083.0235 1151.4933,-7109.9917 1148.8413,-7121.4864 1167.7661,-7149.0235 1188.231,-7178.8016 1216.0434,-7210.0603 1234.0052,-7229.2972"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1231.6422,-7231.8929 1241.0498,-7236.7662 1236.7345,-7227.0899 1231.6422,-7231.8929"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge218" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M637.532,-6136.8525C644.0891,-6133.4096 650.0417,-6128.9082 654.4731,-6123.0235 689.4464,-6076.5814 680.2902,-5658.2625 690.4731,-5601.0235 739.7677,-5323.9361 774.2101,-5258.5652 867.457,-4993.0235 911.4379,-4867.7781 947.0482,-4845.1906 981.6013,-4717.0235 1012.6552,-4601.8361 985.7839,-4566.0024 1017.6013,-4451.0235 1051.9126,-4327.0325 1100.2798,-4309.7618 1131.7661,-4185.0235 1153.7715,-4097.8457 1123.6659,-3860.3777 1167.7661,-3782.0235 1213.3601,-3701.0152 1263.4968,-3715.9498 1336.1997,-3658.0235 1352.7136,-3644.866 1353.2506,-3636.338 1372.1997,-3627.0235 1597.5967,-3516.2282 1682.8295,-3527.359 1932.5662,-3554.0235 2026.7574,-3564.0803 2051.0427,-3569.0323 2140.8962,-3599.0235 2170.0945,-3608.7693 2201.8067,-3623.7962 2224.1687,-3635.1946"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2222.6544,-3638.3517 2233.1454,-3639.8316 2225.867,-3632.1325 2222.6544,-3638.3517"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge320" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M638.1117,-6136.8508C644.5007,-6133.406 650.2511,-6128.9045 654.4731,-6123.0235 704.6409,-6053.1436 670.482,-4658.6916 690.4731,-4575.0235 724.2431,-4433.6873 772.3353,-4412.7674 831.457,-4280.0235 902.4893,-4120.5373 942.7569,-4087.2368 981.6013,-3917.0235 1044.5926,-3641.0008 957.7806,-3557.7507 1017.6013,-3281.0235 1047.3061,-3143.6107 1086.3144,-3119.0604 1131.7661,-2986.0235 1149.9057,-2932.9292 1140.6183,-2914.1259 1167.7661,-2865.0235 1175.8891,-2850.3315 1551.4023,-2417.9446 1566.6973,-2411.0235 1632.3019,-2381.337 1660.729,-2387.2981 1728.717,-2411.0235 1956.1676,-2490.3957 2034.0141,-2547.1302 2140.8962,-2763.0235 2221.6619,-2926.1636 2110.7582,-3001.4254 2176.8962,-3171.0235 2197.2678,-3223.2625 2213.0371,-3232.5358 2253.8123,-3271.0235"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge566" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.3729,-6159.3028C599.2628,-6206.2242 640.6006,-6390.7075 654.4731,-6545.0235 660.1912,-6608.6301 658.9937,-11087.4579 690.4731,-11143.0235 726.6521,-11206.8845 794.7691,-11165.4535 831.457,-11229.0235 915.4564,-11374.5711 814.7857,-12581.4436 867.457,-12741.0235 895.0632,-12824.6627 948.6679,-12821.335 981.6013,-12903.0235 1020.9459,-13000.6145 997.745,-13033.6904 1017.6013,-13137.0235 1073.5523,-13428.1944 1086.7121,-13501.8196 1167.7661,-13787.0235 1231.5243,-14011.3686 1264.7327,-14062.0138 1336.1997,-14284.0235 1353.0012,-14336.2167 1350.076,-14351.8542 1372.1997,-14402.0235 1510.3689,-14715.3465 1499.0808,-14848.9231 1764.717,-15065.0235 2011.054,-15265.4237 2147.6452,-15171.1801 2447.0435,-15277.0235"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge556" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-11015.0235C764.353,-11056.6094 813.7337,-11039.2512 831.457,-11077.0235 892.0826,-11206.23 837.6927,-12221.4389 867.457,-12361.0235 895.1401,-12490.8479 937.5287,-12511.8104 981.6013,-12637.0235 1000.5129,-12690.7524 990.4415,-12709.9556 1017.6013,-12760.0235 1054.7465,-12828.499 1097.2923,-12823.165 1131.7661,-12893.0235 1166.1356,-12962.6707 1137.964,-12992.303 1167.7661,-13064.0235 1220.17,-13190.1365 1293.4774,-13191.3106 1336.1997,-13321.0235 1358.4805,-13388.6723 1328.1687,-13905.0408 1372.1997,-13961.0235 1394.9507,-13989.9499 1433.0365,-13953.1591 1451.4485,-13985.0235"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge660" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-6451.0235C786.3178,-6470.4531 803.4907,-6449.5913 831.457,-6465.0235 851.8261,-6476.2635 848.3252,-6489.7869 867.457,-6503.0235 912.7148,-6534.3357 931.5894,-6528.0554 981.6013,-6551.0235 1141.67,-6624.5354 1202.8094,-6612.9887 1336.1997,-6728.0235 1591.4787,-6948.1743 1641.6402,-7051.3682 1728.717,-7377.0235 1744.7265,-7436.8968 1724.8499,-8444.5712 1764.717,-8492.0235 1813.7361,-8550.3691 1860.5481,-8502.1141 1932.5662,-8527.0235 2072.0013,-8575.2509 2434.8532,-8707.0853 2527.3586,-8822.0235 2568.7207,-8873.4159 2535.5432,-8906.2046 2563.3586,-8966.0235 2590.8674,-9025.1828 2621.7338,-9025.8961 2649.3109,-9085.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2649.3109,-9085.0235C2671.1784,-9132.7428 2712.4512,-9118.7485 2735.2632,-9166.0235 2776.6471,-9251.7864 2760.0692,-9498.4582 2771.2632,-9593.0235 2794.1132,-9786.0569 2833.9591,-10017.7911 2846.3953,-10088.5049"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2843.0246,-10089.544 2848.2098,-10098.7833 2849.918,-10088.3271 2843.0246,-10089.544"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge679" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M760.9651,-11015.0235C764.347,-11056.6099 813.5956,-11039.3163 831.457,-11077.0235 879.9089,-11179.3101 786.0235,-12016.4188 867.457,-12095.0235 903.9575,-12130.256 931.4244,-12102.4996 981.6013,-12095.0235 989.6192,-12093.8289 1452.1477,-11952.0257 1601.6458,-11906.1591"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1602.9123,-11909.4316 1611.4458,-11903.1523 1600.859,-11902.7396 1602.9123,-11909.4316"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge611" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-6451.0235C785.5821,-6471.3772 807.6653,-6443.711 831.457,-6465.0235 871.0332,-6500.4755 834.3681,-6537.4515 867.457,-6579.0235 1018.0158,-6768.1811 1197.2133,-6657.2072 1336.1997,-6855.0235 1385.8609,-6925.7051 1326.5675,-6972.6762 1372.1997,-7046.0235 1418.7323,-7120.818 1484.2001,-7090.207 1530.6973,-7165.0235 1576.5253,-7238.7634 1549.1389,-7271.9972 1566.6973,-7357.0235 1632.8563,-7677.3985 1680.8546,-7751.409 1728.717,-8075.0235 1745.048,-8185.4428 1711.8786,-8477.7015 1764.717,-8576.0235 1801.7573,-8644.9482 2275.8183,-8939.2787 2330.7283,-8995.0235 2393.9467,-9059.2031 2394.6252,-9087.7574 2447.0435,-9161.0235"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge640" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M588.3555,-6159.3044C599.1769,-6206.232 640.2819,-6390.7365 654.4731,-6545.0235 685.108,-6878.086 645.0517,-9223.6537 690.4731,-9555.0235 731.949,-9857.6084 727.5684,-9947.5294 867.457,-10219.0235 903.9139,-10289.7786 950.6393,-10283.6972 981.6013,-10357.0235 1039.336,-10493.7544 940.8365,-10561.9967 1017.6013,-10689.0235 1020.8343,-10694.3732 1759.4399,-11187.6735 1764.717,-11191.0235 2012.2758,-11348.1788 2083.668,-11372.0857 2330.7283,-11530.0235 2442.6603,-11601.5781 2572.5684,-11692.646 2625.2658,-11729.9364"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2623.435,-11732.9287 2633.618,-11735.8542 2627.4819,-11727.2171 2623.435,-11732.9287"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge744" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.9651,-11015.0235C764.4,-11056.6055 813.6103,-11039.3094 831.457,-11077.0235 880.9614,-11181.6375 837.5564,-12006.2168 867.457,-12118.0235 895.4074,-12222.5379 939.3873,-12233.412 981.6013,-12333.0235 1001.838,-12380.7755 995.9231,-12396.9084 1017.6013,-12444.0235 1131.0517,-12690.5947 1245.4444,-12709.2271 1336.1997,-12965.0235 1376.5323,-13078.7021 1325.6567,-13122.7433 1372.1997,-13234.0235 1426.6554,-13364.2221 1439.9758,-13422.9046 1566.6973,-13485.0235 1873.0299,-13635.1879 2021.2099,-13554.5067 2330.7283,-13411.0235 2368.0004,-13393.7453 2405.5255,-13363.8647 2427.5071,-13344.7917"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2429.9544,-13347.3 2435.1378,-13338.0597 2425.3234,-13342.0508 2429.9544,-13347.3"/>
</g>
<!-- sourcefile~radiantsystemlowtemp.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge431" class="edge">
<title>sourcefile~radiantsystemlowtemp.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2456.7082,-2272.8908C2472.3343,-2254.6737 2503.7757,-2217.1052 2527.3586,-2183.0235 2647.5711,-2009.2946 2642.4525,-1942.4767 2771.2632,-1775.0235 2832.5661,-1695.33 2880.1894,-1700.8323 2929.166,-1613.0235 2961.3009,-1555.4097 2923.2952,-1520.0023 2965.166,-1469.0235 3072.3314,-1338.5471 3185.9446,-1422.8531 3308.7942,-1307.0235 3333.1053,-1284.1016 3319.1803,-1262.4798 3344.7942,-1241.0235 3370.5437,-1219.4536 3392.4536,-1193.5292 3416.4602,-1217.0235"/>
</g>
<!-- sourcefile~exteriorenergyusemanager.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge433" class="edge">
<title>sourcefile~exteriorenergyusemanager.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1481.0029,-7526.1024C1645.3443,-7587.5606 2463.7192,-7891.6818 3142.9189,-8109.0235 3179.4668,-8120.7187 3211.9344,-8097.2647 3225.8566,-8133.0235"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge953" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M443.5515,-3802.1562C457.6879,-3804.8876 471.9711,-3810.6133 480.9653,-3822.0235 521.312,-3873.2079 510.886,-6103.1333 516.9653,-6168.0235 530.5426,-6312.9462 567.4745,-6484.5749 580.8228,-6543.7405"/>
<polygon fill="#ff0042" stroke="#ff0042" points="577.4666,-6544.7664 583.0972,-6553.7413 584.2923,-6543.2141 577.4666,-6544.7664"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge436" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M407.7244,-3789.963C425.5278,-3766.409 465.8893,-3708.8729 480.9653,-3653.0235 504.6867,-3565.1469 468.9858,-2092.3731 516.9653,-2015.0235 553.329,-1956.4003 616.4443,-2000.5804 654.4731,-1943.0235 710.1415,-1858.7691 650.7445,-1582.8643 690.4731,-1490.0235 797.5652,-1239.7631 1332.6399,-773.0061 1566.6973,-634.0235 1729.833,-537.154 1780.9012,-517.9312 1968.5662,-490.0235 2358.5269,-432.0324 2803.2609,-648.8796 3142.9189,-699.0235 3173.102,-703.4795 3397.9896,-698.7396 3416.4602,-723.0235"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M443.4779,-3805.9492C456.484,-3809.0223 470.1116,-3813.993 480.9653,-3822.0235 505.6592,-3840.2941 496.4059,-3858.2 516.9653,-3881.0235 568.4304,-3938.156 610.0129,-3923.2855 654.4731,-3986.0235 831.4677,-4235.7815 768.3747,-4351.3879 867.457,-4641.0235 931.3506,-4827.7961 934.9944,-4879.7403 1017.6013,-5059.0235 1060.4329,-5151.9817 1089.7469,-5165.6953 1131.7661,-5259.0235 1152.1921,-5304.3913 1138.3817,-5324.8736 1167.7661,-5365.0235 1195.2163,-5402.5306 1210.4198,-5406.2197 1251.9829,-5427.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.9829,-5427.0235C1287.6947,-5443.1227 1307.954,-5425.8815 1336.1997,-5453.0235 1370.8637,-5486.333 1337.6381,-5521.6078 1372.1997,-5555.0235 1376.8281,-5559.4985 1382.251,-5563.173 1388.0507,-5566.1901"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1386.8597,-5569.4923 1397.4147,-5570.4107 1389.7362,-5563.1106 1386.8597,-5569.4923"/>
</g>
<!-- sourcefile~datashadowingcombinations.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_node45" class="node">
<title>sourcefile~datashadowingcombinations.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~EfferentGraph_node45"><a xlink:href="../sourcefile/datashadowingcombinations.f90.html" xlink:title="DataShadowingCombinations.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1932.4908,-17721.0289 1764.7924,-17721.0289 1764.7924,-17699.0181 1932.4908,-17699.0181 1932.4908,-17721.0289"/>
<text text-anchor="middle" x="1848.6416" y="-17706.8735" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataShadowingCombinations.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datashadowingcombinations.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge939" class="edge">
<title>sourcefile~datashadowingcombinations.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1932.7634,-17710.0235C1945.0239,-17710.0235 1957.6545,-17710.0235 1969.9284,-17710.0235"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="1970.1387,-17713.5236 1980.1386,-17710.0235 1970.1386,-17706.5236 1970.1387,-17713.5236"/>
</g>
<!-- sourcefile~datashadowingcombinations.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge437" class="edge">
<title>sourcefile~datashadowingcombinations.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1896.4728,-17698.9783C1970.0669,-17681.1063 2106.2166,-17644.2822 2140.8962,-17609.0235 2175.1955,-17574.1515 2143.9151,-17541.1447 2176.8962,-17505.0235 2549.0685,-17097.4178 2908.3098,-17373.8483 3308.7942,-16994.0235 3434.7541,-16874.5615 3446.0004,-16815.4352 3488.1262,-16647.0235 3537.137,-16451.087 3584.243,-9595.1889 3587.1871,-9159.6928"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3590.6889,-9159.4172 3587.2566,-9149.3938 3583.6891,-9159.3699 3590.6889,-9159.4172"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge439" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.9829,-3112.0235C1264.6972,-3075.2389 1311.7216,-3118.2821 1336.1997,-3088.0235 1411.1422,-2995.3834 1295.3144,-2644.0576 1372.1997,-2553.0235 1418.9407,-2497.6811 1482.569,-2569.1638 1530.6973,-2515.0235 1621.0912,-2413.3379 1504.165,-2331.857 1566.6973,-2211.0235 1650.6003,-2048.8944 2024.0282,-1760.8079 2176.8962,-1661.0235 2421.9136,-1501.0889 3213.4393,-1006.3221 3416.4602,-1217.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1114.1459,-3741.5973C1121.0252,-3738.0532 1127.3725,-3733.3244 1131.7661,-3727.0235 1208.2936,-3617.2755 1078.2489,-3225.4607 1167.7661,-3126.0235 1193.1526,-3097.8238 1239.6208,-3147.8966 1251.9829,-3112.0235"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge525" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M1074.8973,-3763.504C1077.8261,-3921.1151 1110.2252,-5670.486 1131.7661,-7083.0235 1140.8954,-7681.674 1131.713,-9179.3899 1167.7661,-9777.0235 1209.9189,-10475.7674 1292.2129,-10644.3926 1336.1997,-11343.0235 1342.9524,-11450.2742 1334.1248,-13176.5317 1372.1997,-13277.0235 1410.6808,-13378.5875 1475.7395,-13369.3449 1530.6973,-13463.0235 1553.966,-13502.6863 1537.941,-13524.1398 1566.6973,-13560.0235 1620.3573,-13626.9835 1676.3759,-13597.0275 1728.717,-13665.0235 1760.0946,-13705.7859 1733.2729,-13734.3125 1764.717,-13775.0235 1818.9418,-13845.2287 1883.5055,-13809.1171 1932.5662,-13883.0235 1983.9691,-13960.4584 1926.1476,-14006.3247 1968.5662,-14089.0235 2018.53,-14186.4326 2067.8661,-14183.4667 2140.8962,-14265.0235 2157.7516,-14283.8468 2158.9647,-14291.2224 2176.8962,-14309.0235 2208.057,-14339.9577 2221.411,-14341.3912 2253.8123,-14371.0235"/>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M2253.8123,-14371.0235C2345.8766,-14467.7651 2415.0204,-14615.6854 2438.4177,-14669.5243"/>
<polygon fill="#65ff00" stroke="#65ff00" points="2435.3214,-14671.1845 2442.4805,-14678.9946 2441.7544,-14668.4247 2435.3214,-14671.1845"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge539" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1074.8939,-3763.5041C1077.7761,-3921.1158 1109.6806,-5670.4944 1131.7661,-7083.0235 1132.3192,-7118.3977 1145.8663,-9602.2379 1167.7661,-9630.0235 1215.5914,-9690.7022 1265.9673,-9640.8277 1336.1997,-9673.0235 1449.7922,-9725.0964 1455.5146,-9776.9861 1566.6973,-9834.0235 1634.6164,-9868.8665 1682.1619,-9830.5283 1728.717,-9891.0235 1790.305,-9971.0529 1709.4634,-10259.4965 1764.717,-10344.0235 1811.0318,-10414.8758 1887.022,-10362.6735 1932.5662,-10434.0235 2007.2997,-10551.1019 1934.0001,-10923.4961 1968.5662,-11058.0235 2012.8106,-11230.2183 2091.551,-11248.2205 2140.8962,-11419.0235 2159.8999,-11484.8024 2134.5559,-11671.2155 2176.8962,-11725.0235 2225.9655,-11787.383 2317.9845,-11810.8569 2380.8636,-11819.6922"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2380.7107,-11823.2021 2391.0817,-11821.0359 2381.6234,-11816.2619 2380.7107,-11823.2021"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge353" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1251.9829,-3112.0235C1264.6972,-3075.2389 1311.1234,-3117.7882 1336.1997,-3088.0235 1432.6819,-2973.5024 1276.6624,-2868.334 1372.1997,-2753.0235 1419.158,-2696.3464 1481.2276,-2759.5224 1530.6973,-2705.0235 1585.5315,-2644.6148 1523.5356,-2594.2555 1566.6973,-2525.0235 1590.6836,-2486.5491 1615.3215,-2494.7536 1647.7072,-2463.0235"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1647.7072,-2463.0235C1788.9046,-2324.6843 1785.1767,-2228.7987 1968.5662,-2155.0235 2087.5158,-2107.1716 2480.2262,-2143.3563 2527.3586,-2193.0235 2587.6908,-2256.6003 2526.7931,-2901.3684 2563.3586,-2981.0235 2607.1563,-3076.4333 2686.6687,-3049.9652 2735.2632,-3143.0235 2806.8521,-3280.1159 2842.0303,-3785.6321 2848.9348,-3895.7533"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2845.4531,-3896.1596 2849.562,-3905.9252 2852.4399,-3895.7288 2845.4531,-3896.1596"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge239" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-2463.0235C1766.9346,-2346.5976 1808.3289,-2314.7859 1968.5662,-2269.0235 2087.9731,-2234.9219 2437.825,-2177.9731 2527.3586,-2264.0235 2600.0759,-2333.9117 2508.6531,-3086.2918 2563.3586,-3171.0235 2609.6962,-3242.7943 2689.4731,-3184.9022 2735.2632,-3257.0235 2822.9548,-3395.1416 2698.5028,-4582.489 2771.2632,-4729.0235 2781.2913,-4749.2195 2801.1644,-4765.0216 2818.4623,-4775.7484"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2816.8134,-4778.8391 2827.2076,-4780.8917 2820.3621,-4772.8052 2816.8134,-4778.8391"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1074.7737,-3763.0612C1076.4755,-3968.6333 1102.4858,-6978.7695 1167.7661,-7149.0235 1180.5322,-7182.3181 1209.6272,-7212.2309 1230.0279,-7230.2506"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1227.7658,-7232.9214 1237.6339,-7236.7779 1232.3246,-7227.6094 1227.7658,-7232.9214"/>
</g>
<!-- sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge448" class="edge">
<title>sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3416.9969,-5570.2643C3426.9668,-5779.0894 3572.6643,-8830.7862 3586.3096,-9116.5922"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3582.8272,-9117.0463 3586.8002,-9126.868 3589.8192,-9116.7124 3582.8272,-9117.0463"/>
</g>
<!-- sourcefile~pollutionanalysismodule.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge450" class="edge">
<title>sourcefile~pollutionanalysismodule.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1319.1148,-2030.9834C1325.6859,-2027.4727 1331.6063,-2022.9185 1336.1997,-2017.0235 1395.2568,-1941.2326 1334.0713,-1241.2178 1372.1997,-1153.0235 1412.1715,-1060.5653 1469.7161,-1071.1956 1530.6973,-991.0235 1549.9877,-965.6623 1540.2664,-946.8201 1566.6973,-929.0235 1640.426,-879.38 1676.4322,-911.3287 1764.717,-901.0235 1947.444,-879.6944 1993.1229,-871.4769 2176.8962,-863.0235 2245.1938,-859.8819 2262.5505,-857.9034 2330.7283,-863.0235 2391.5596,-867.5919 3379.5113,-978.4838 3416.4602,-1027.0235"/>
</g>
<!-- sourcefile~datacostestimate.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge452" class="edge">
<title>sourcefile~datacostestimate.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3416.4602,-723.0235C3453.4978,-774.3186 3471.2648,-785.0427 3488.1262,-846.0235 3547.6832,-1061.4161 3585.0544,-8663.3055 3587.2321,-9116.8813"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3583.7326,-9117.0235 3587.2805,-9127.0066 3590.7325,-9116.9899 3583.7326,-9117.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M402.6234,-663.0019C430.024,-578.6805 611.2366,-39.0235 760.9651,-39.0235 760.9651,-39.0235 760.9651,-39.0235 1848.6416,-39.0235 1981.4233,-39.0235 2013.8477,-62.4277 2140.8962,-101.0235 2324.0291,-156.657 2405.6286,-143.3261 2527.3586,-291.0235 2558.4678,-328.7689 2527.0481,-362.251 2563.3586,-395.0235 2625.3498,-450.9742 2862.7471,-430.4082 2929.166,-481.0235 2955.7419,-501.276 2940.0821,-524.95 2965.166,-547.0235 3045.9765,-618.1358 3353.4454,-635.7514 3416.4602,-723.0235"/>
</g>
<!-- sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge456" class="edge">
<title>sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2115.6565,-687.6097C2270.2974,-692.2997 2690.2774,-709.1862 3036.0425,-761.0235"/>
</g>
<!-- sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2055.4004,-697.2833C2061.6732,-803.0633 2110.599,-1633.448 2140.8962,-2307.0235 2150.6686,-2524.2844 2127.8294,-3073.1504 2176.8962,-3285.0235 2214.8653,-3448.9759 2287.9674,-3468.2551 2330.7283,-3631.0235 2373.3834,-3793.3894 2340.6897,-3841.1799 2366.7283,-4007.0235 2418.3902,-4336.0669 2487.9544,-4408.2883 2527.3586,-4739.0235 2572.1141,-5114.6736 2505.2638,-6067.204 2563.3586,-6441.0235 2579.566,-6545.3119 2623.049,-6664.5967 2641.1887,-6711.5313"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2637.9496,-6712.8587 2644.8468,-6720.901 2644.4703,-6710.3129 2637.9496,-6712.8587"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge952" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0042" stroke-dasharray="5,2" d="M423.2921,-5171.152C442.7401,-5181.5415 468.7529,-5199.0505 480.9653,-5223.0235 547.4138,-5353.4614 431.3514,-6421.2813 516.9653,-6540.0235 519.8321,-6543.9996 523.3971,-6547.345 527.3847,-6550.1596"/>
<polygon fill="#ff0042" stroke="#ff0042" points="525.6726,-6553.2127 536.0749,-6555.2232 529.1968,-6547.1646 525.6726,-6553.2127"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5197.0235C640.4745,-5169.2848 638.3931,-5139.5082 690.4731,-5107.0235 763.1072,-5061.7184 788.6708,-5064.5047 867.457,-5031.0235 892.7821,-5020.2613 902.5005,-4990.5335 924.5292,-5007.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M432.8306,-5171.0904C478.6983,-5185.3833 558.166,-5207.2763 585.7192,-5197.0235"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge940" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1853.1718,-8483.2104C1868.2167,-8521.0354 1916.4747,-8647.9386 1932.5662,-8758.0235 1992.0846,-9165.2014 1956.1051,-15753.7074 1968.5662,-16165.0235 1987.4584,-16788.6178 2042.982,-17552.2445 2053.1294,-17688.6681"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="2049.6643,-17689.2675 2053.899,-17698.9792 2056.6449,-17688.7464 2049.6643,-17689.2675"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1849.224,-8460.8484C1855.741,-8335.8983 1915.7495,-7187.6924 1968.5662,-6259.0235 1969.9479,-6234.7281 2165.747,-2782.6539 2176.8962,-2761.0235 2197.0132,-2721.995 2236.1982,-2739.2437 2253.8123,-2699.0235"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge390" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1849.0758,-8460.8679C1853.798,-8340.6653 1896.8435,-7272.7266 1968.5662,-6411.0235 2027.5251,-5702.6678 2095.2724,-5530.363 2140.8962,-4821.0235 2144.0278,-4772.3361 2143.5973,-3100.6809 2176.8962,-3065.0235 2228.1603,-3010.1286 2775.105,-3005.0235 2850.2146,-3005.0235"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge489" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1853.1138,-8483.2191C1867.9752,-8521.0715 1915.7208,-8648.0514 1932.5662,-8758.0235 1997.8193,-9184.0179 1950.4934,-10266.4395 1968.5662,-10697.0235 1990.6965,-11224.2795 2042.747,-11868.7825 2052.9708,-11992.8263"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2049.4917,-11993.225 2053.8038,-12002.9026 2056.4679,-11992.6482 2049.4917,-11993.225"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge664" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1911.2876,-8466.2799C2008.1684,-8460.4115 2197.0948,-8461.2155 2330.7283,-8539.0235 2388.4023,-8572.6042 2489.4862,-8711.0723 2527.3586,-8766.0235 2546.5418,-8793.8574 2545.4227,-8804.3701 2563.3586,-8833.0235 2632.5917,-8943.6264 2690.8646,-8948.3248 2735.2632,-9071.0235 2774.827,-9180.3611 2758.4757,-9477.4533 2771.2632,-9593.0235 2792.6403,-9786.2256 2833.4767,-10017.8464 2846.2769,-10088.5185"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2842.9122,-10089.5786 2848.1458,-10098.7906 2849.7992,-10088.3256 2842.9122,-10089.5786"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge642" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2253.8123,-9199.0235C2275.0294,-9250.9248 2308.1187,-9247.7134 2330.7283,-9299.0235 2360.7544,-9367.1648 2430.0295,-9886.5298 2447.0435,-9959.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1854.0024,-8483.1787C1867.3902,-8511.0698 1903.3156,-8586.114 1932.5662,-8649.0235 1934.2909,-8652.7329 2173.6686,-9182.5104 2176.8962,-9185.0235 2204.3122,-9206.3703 2240.6641,-9166.8606 2253.8123,-9199.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2447.0435,-9959.0235C2470.2552,-10057.9251 2506.2328,-10073.6555 2527.3586,-10173.0235 2582.9128,-10434.3295 2543.6149,-10506.6079 2563.3586,-10773.0235 2591.7157,-11155.6647 2637.0024,-11621.8998 2647.2182,-11725.8304"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2643.7532,-11726.3589 2648.2165,-11735.9678 2650.7195,-11725.6728 2643.7532,-11726.3589"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge523" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M2255.5125,-12671.3408C2264.4823,-12731.3774 2306.7959,-13018.7519 2330.7283,-13255.0235 2352.7343,-13472.2766 2349.482,-13527.3409 2366.7283,-13745.0235 2396.0587,-14115.2321 2436.0493,-14566.6375 2445.1492,-14668.8011"/>
<polygon fill="#65ff00" stroke="#65ff00" points="2441.666,-14669.1459 2446.0402,-14678.7956 2448.6383,-14668.5243 2441.666,-14669.1459"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge533" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2258.9635,-12648.6582C2273.0292,-12617.0939 2312.2682,-12525.3882 2330.7283,-12445.0235 2363.9556,-12300.3702 2338.6996,-12258.7734 2366.7283,-12113.0235 2386.3263,-12011.1131 2424.2982,-11892.7269 2439.9924,-11845.7545"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2443.3626,-11846.7133 2443.2352,-11836.1193 2436.7282,-11844.4805 2443.3626,-11846.7133"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge713" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2297.5686,-12664.8162C2310.1765,-12668.4097 2322.6837,-12674.5598 2330.7283,-12685.0235 2375.6268,-12743.4234 2357.0442,-13273.9986 2366.7283,-13347.0235 2385.0018,-13484.8192 2426.304,-13647.1649 2441.3901,-13704.0653"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2438.0817,-13705.2424 2444.0432,-13714.0009 2444.8448,-13703.4365 2438.0817,-13705.2424"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge762" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2447.0435,-12679.0235C2536.5276,-12687.6257 2559.4241,-12680.3564 2649.3109,-12679.0235"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2297.5506,-12664.379C2336.7117,-12668.2656 2395.7056,-12674.0883 2447.0435,-12679.0235"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M2254.9735,-12648.7944C2263.3152,-12567.5119 2314.2459,-12060.7339 2330.7283,-11647.0235 2333.3098,-11582.2272 2328.1868,-2361.175 2366.7283,-2309.0235 2369.0337,-2305.9039 2371.7255,-2303.1625 2374.6985,-2300.7545"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="2376.7672,-2303.582 2383.153,-2295.1279 2372.8889,-2297.7546 2376.7672,-2303.582"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge392" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M2447.0435,-12679.0235C2483.1111,-12682.4907 2492.3036,-12683.8562 2527.3586,-12693.0235 2638.5622,-12722.1045 2657.9671,-12759.6346 2771.2632,-12779.0235 2840.4366,-12790.8615 2875.2859,-12823.9905 2929.166,-12779.0235 2963.5009,-12750.3684 2957.0451,-12625.0014 2965.166,-12581.0235 3027.2434,-12244.8516 3071.6997,-12165.0599 3106.9189,-11825.0235 3185.1885,-11069.342 3092.8956,-10874.0989 3142.9189,-10116.0235 3186.8499,-9450.2748 3260.187,-9289.4472 3308.7942,-8624.0235 3401.64,-7352.9812 3414.9881,-5779.3692 3416.3314,-5580.0942"/>
<polygon fill="#002eff" stroke="#002eff" points="3419.8315,-5580.0774 3416.3966,-5570.0549 3412.8316,-5580.0319 3419.8315,-5580.0774"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge344" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2270.0767,-12648.9958C2286.5619,-12637.3203 2312.2096,-12617.7445 2330.7283,-12597.0235 2437.9545,-12477.0452 2456.8343,-12437.656 2527.3586,-12293.0235 2548.7964,-12249.0586 2546.1261,-12234.8005 2563.3586,-12189.0235 2634.7085,-11999.4884 2695.8523,-11965.6718 2735.2632,-11767.0235 2775.2058,-11565.6951 2753.3789,-4582.4953 2771.2632,-4378.0235 2786.245,-4206.7365 2830.459,-4003.4046 2845.2963,-3938.2298"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2848.7407,-3938.8679 2847.5651,-3928.3385 2841.9179,-3937.3029 2848.7407,-3938.8679"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge381" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2255.701,-12648.7232C2265.631,-12588.7731 2312.0474,-12301.7682 2330.7283,-12065.0235 2374.2383,-11513.6171 2321.6704,-11372.3056 2366.7283,-10821.0235 2385.1806,-10595.2597 2430.1799,-10324.035 2443.3593,-10247.2144"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2446.8153,-10247.7688 2445.066,-10237.3194 2439.9172,-10246.579 2446.8153,-10247.7688"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge570" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2297.7411,-12666.334C2308.744,-12668.677 2320.3613,-12671.8268 2330.7283,-12676.0235 2380.0339,-12695.9832 2691.7442,-12901.4369 2735.2632,-12932.0235 2751.8467,-12943.679 2752.0905,-12953.4452 2771.2632,-12960.0235 2837.6437,-12982.7992 2873.0923,-13002.2234 2929.166,-12960.0235 3157.1836,-12788.4222 3064.4322,-12625.2183 3106.9189,-12343.0235 3115.0219,-12289.2042 3110.0592,-10427.4102 3142.9189,-10384.0235 3145.2825,-10380.9027 3148.023,-10378.1582 3151.0392,-10375.7455"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3153.1749,-10378.5298 3159.5981,-10370.104 3149.3225,-10372.6852 3153.1749,-10378.5298"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge613" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2258.1947,-12648.9577C2270.5902,-12617.4257 2306.5659,-12524.2761 2330.7283,-12445.0235 2349.7153,-12382.7459 2334.6762,-12359.6952 2366.7283,-12303.0235 2416.6437,-12214.7673 2488.0818,-12234.501 2527.3586,-12141.0235 2581.1655,-12012.9651 2524.4242,-9774.3586 2563.3586,-9641.0235 2577.2203,-9593.5528 2612.05,-9546.2888 2632.8701,-9520.9553"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2635.5996,-9523.1474 2639.3432,-9513.236 2630.2359,-9518.6496 2635.5996,-9523.1474"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge750" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2297.6051,-12665.6787C2309.9074,-12669.3286 2322.231,-12675.2938 2330.7283,-12685.0235 2341.3316,-12697.1648 2425.087,-13195.577 2443.4802,-13305.655"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2440.0823,-13306.5568 2445.1813,-13315.8439 2446.9867,-13305.404 2440.0823,-13306.5568"/>
</g>
<!-- sourcefile~datasurfacelists.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~datasurfacelists.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1306.8459,-2954.9831C1317.8797,-2951.7319 1328.4503,-2946.4555 1336.1997,-2938.0235 1404.1341,-2864.1051 1333.5018,-2807.6598 1372.1997,-2715.0235 1428.6519,-2579.8862 1452.8436,-2541.1446 1566.6973,-2449.0235 1810.9327,-2251.4081 1947.5756,-2212.8673 2253.8123,-2283.0235"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M2253.8123,-2283.0235C2289.8152,-2284.3361 2329.6161,-2284.7234 2363.6928,-2284.7308"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="2364.0772,-2288.2305 2374.0741,-2284.7215 2364.0709,-2281.2305 2364.0772,-2288.2305"/>
</g>
<!-- sourcefile~datasurfacelists.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge394" class="edge">
<title>sourcefile~datasurfacelists.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1306.9975,-2955.6258C1318.161,-2952.3616 1328.7488,-2946.9179 1336.1997,-2938.0235 1411.5792,-2848.0405 1329.8422,-2520.4989 1372.1997,-2411.0235 1413.1259,-2305.2476 1483.0286,-2313.9371 1530.6973,-2211.0235 1564.9867,-2136.9949 1530.0842,-2103.9308 1566.6973,-2031.0235 1686.4399,-1792.5812 1735.5585,-1715.0252 1968.5662,-1585.0235 2109.9011,-1506.1687 2169.2064,-1536.8081 2330.7283,-1547.0235 2598.3023,-1563.9461 2725.1278,-1449.0965 2929.166,-1623.0235 3142.772,-1805.1063 3046.0215,-1955.0287 3106.9189,-2229.0235 3144.77,-2399.3261 3059.685,-2951.8946 3225.8566,-3005.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M3225.8566,-3005.0235C3355.1315,-3042.4699 3410.3846,-5294.3162 3415.9825,-5537.7535"/>
<polygon fill="#002eff" stroke="#002eff" points="3412.4846,-5537.8932 3416.2116,-5547.8108 3419.4828,-5537.7337 3412.4846,-5537.8932"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge766" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2268.8592,-6133.2055C2284.8089,-6145.3153 2310.4454,-6165.5244 2330.7283,-6185.0235 2342.935,-6196.7586 2728.9243,-6625.3221 2735.2632,-6641.0235 2771.1493,-6729.9143 2712.5865,-7427.2183 2771.2632,-7503.0235 2793.7119,-7532.0253 2845.5259,-7490.6495 2850.2146,-7527.0235"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2850.2146,-7527.0235C2854.7804,-7562.3667 2906.1248,-7513.8372 2929.166,-7541.0235 2959.0439,-7576.2765 2963.1722,-10821.8555 2965.166,-10868.0235 2981.0254,-11235.2586 3023.8722,-11681.9028 3033.9155,-11783.6947"/>
<polygon fill="#ff0066" stroke="#ff0066" points="3030.4579,-11784.2968 3034.927,-11793.9029 3037.4238,-11783.6064 3030.4579,-11784.2968"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M2255.8472,-6110.8669C2266.3162,-6052.8675 2314.2516,-5779.811 2330.7283,-5554.0235 2334.0087,-5509.0708 2339.8091,-2345.1741 2366.7283,-2309.0235 2369.045,-2305.9123 2371.7457,-2303.1775 2374.7256,-2300.7746"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="2376.7947,-2303.6023 2383.1942,-2295.1585 2372.9259,-2297.7685 2376.7947,-2303.6023"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge397" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M2447.0435,-6199.0235C2480.6509,-6215.1012 2491.9995,-6211.2894 2527.3586,-6223.0235 2620.7336,-6254.0104 2651.2136,-6247.8889 2735.2632,-6299.0235 2835.205,-6359.8267 2847.7966,-6392.9734 2929.166,-6477.0235 2946.7492,-6495.186 3213.1368,-6843.8696 3225.8566,-6822.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M3225.8566,-6822.0235C3334.8814,-6586.6937 3403.8034,-5726.9349 3414.8836,-5580.3462"/>
<polygon fill="#002eff" stroke="#002eff" points="3418.3993,-5580.266 3415.6561,-5570.0325 3411.4188,-5579.7431 3418.3993,-5580.266"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M2296.3415,-6133.094C2307.8144,-6136.8123 2320.0112,-6141.4594 2330.7283,-6147.0235 2348.4785,-6156.2392 2348.9208,-6164.9188 2366.7283,-6174.0235 2400.0148,-6191.0424 2414.3331,-6180.9218 2447.0435,-6199.0235"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2256.4787,-6133.3566C2269.2341,-6185.5406 2328.3669,-6405.9032 2447.0435,-6541.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-6541.0235C2476.8015,-6574.9048 2498.0891,-6568.7193 2527.3586,-6603.0235 2549.0463,-6628.4418 2541.3562,-6643.8772 2563.3586,-6669.0235 2579.6469,-6687.6391 2602.3649,-6703.9936 2620.3544,-6715.3714"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2618.9197,-6718.5978 2629.2717,-6720.8532 2622.5856,-6712.6345 2618.9197,-6718.5978"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge291" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2649.3109,-6427.0235C2673.1194,-6458.745 2709.2513,-6421.0823 2735.2632,-6451.0235 2814.9487,-6542.7464 2711.041,-6616.4955 2771.2632,-6722.0235 2793.3769,-6760.7736 2828.0858,-6745.282 2850.2146,-6784.0235"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge348" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2256.9517,-6110.7485C2278.4223,-6034.2215 2407.4192,-5583.6359 2563.3586,-5237.0235 2627.6778,-5094.0589 2690.8631,-5079.3713 2735.2632,-4929.0235 2804.7694,-4693.6611 2742.5109,-4621.7444 2771.2632,-4378.0235 2791.4077,-4207.2667 2832.2438,-4003.5879 2845.759,-3938.2773"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2849.211,-3938.8681 2847.8211,-3928.3648 2842.3577,-3937.4424 2849.211,-3938.8681"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge374" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2255.0233,-6133.0341C2263.3963,-6209.7233 2312.8792,-6672.1521 2330.7283,-7050.0235 2334.7588,-7135.3509 2338.0995,-10044.5412 2366.7283,-10125.0235 2378.6724,-10158.6014 2406.7862,-10189.4495 2426.3612,-10207.9941"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2424.1731,-10210.7369 2433.9014,-10214.9335 2428.9134,-10205.5863 2424.1731,-10210.7369"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge231" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2319.422,-6126.0443C2356.969,-6127.2583 2404.8545,-6126.9658 2447.0435,-6121.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-6121.0235C2549.2265,-6106.6311 2587.0428,-6089.3108 2649.3109,-6007.0235"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge259" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2447.0435,-6121.0235C2521.2309,-6110.5743 2711.6527,-6038.1949 2735.2632,-6021.0235 2802.3373,-5972.2419 2785.141,-5925.4435 2850.2146,-5874.0235"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge574" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2649.3109,-6427.0235C2673.1194,-6458.745 2708.935,-6421.36 2735.2632,-6451.0235 2804.82,-6529.3919 2711.0051,-6598.2988 2771.2632,-6684.0235 2817.2183,-6749.4006 2861.6765,-6727.231 2929.166,-6770.0235 3011.8253,-6822.4345 3062.1381,-6812.9939 3106.9189,-6900.0235 3148.1501,-6980.1547 3125.9322,-10055.5223 3142.9189,-10144.0235 3157.2568,-10218.7239 3196.0436,-10301.0549 3215.0558,-10338.4801"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3212.1664,-10340.5142 3219.857,-10347.8015 3218.3894,-10337.3088 3212.1664,-10340.5142"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-6199.0235C2480.6509,-6215.1012 2502.2679,-6195.4842 2527.3586,-6223.0235 2582.3041,-6283.331 2507.87,-6343.2154 2563.3586,-6403.0235 2590.3345,-6432.0993 2625.7115,-6395.1462 2649.3109,-6427.0235"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge617" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2254.807,-6133.0471C2261.7187,-6209.8243 2303.1183,-6672.7397 2330.7283,-7050.0235 2349.1577,-7301.8575 2342.1081,-7365.7192 2366.7283,-7617.0235 2431.5128,-8278.2965 2450.279,-8444.2777 2563.3586,-9099.0235 2588.7508,-9246.0474 2629.817,-9420.9897 2644.1656,-9480.7804"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2640.8508,-9481.9654 2646.5955,-9490.8675 2647.6561,-9480.3259 2640.8508,-9481.9654"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge934" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1277.3872,-9621.1168C1297.4073,-9631.3862 1323.9224,-9648.7449 1336.1997,-9673.0235 1364.9815,-9729.9398 1368.0806,-14201.3769 1372.1997,-14265.0235 1375.0806,-14309.5366 1549.2798,-15817.9584 1566.6973,-15859.0235 1611.3657,-15964.3384 1689.3614,-15951.6101 1728.717,-16059.0235 1760.6618,-16146.2104 1705.9812,-17658.106 1764.717,-17730.0235 1788.9083,-17759.6439 1816.221,-17728.7384 1848.6416,-17749.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge460" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1253.5798,-9598.5653C1263.5854,-9526.1552 1317.8106,-9124.5226 1336.1997,-8795.0235 1342.7288,-8678.0346 1320.421,-4682.133 1372.1997,-4577.0235 1411.7239,-4496.7905 1485.9996,-4530.4936 1530.6973,-4453.0235 1588.1172,-4353.503 1531.8623,-4306.5128 1566.6973,-4197.0235 1614.3087,-4047.3767 1664.5324,-4026.346 1728.717,-3883.0235 1747.0019,-3842.194 1748.5832,-3830.7498 1764.717,-3789.0235 1792.3232,-3717.6267 1825.4636,-3633.0591 1840.505,-3594.7378"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1843.851,-3595.7923 1844.2478,-3585.2049 1837.3352,-3593.234 1843.851,-3595.7923"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge495" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1277.3748,-9621.1231C1297.3876,-9631.3962 1323.8988,-9648.7568 1336.1997,-9673.0235 1382.4201,-9764.205 1317.3163,-13266.7786 1372.1997,-13353.0235 1414.1422,-13418.9328 1485.65,-13365.196 1530.6973,-13429.0235 1618.3179,-13553.1734 1499.0473,-13632.9572 1566.6973,-13769.0235 1610.6546,-13857.436 1670.5598,-13841.2316 1728.717,-13921.0235 1750.7317,-13951.2277 1744.3425,-13965.6895 1764.717,-13997.0235 1827.0532,-14092.8902 1890.9105,-14085.5293 1932.5662,-14192.0235 1974.2004,-14298.4627 1951.2086,-15107.057 1968.5662,-15220.0235 2021.3014,-15563.2347 1987.4081,-15682.0439 2176.8962,-15973.0235 2189.215,-15991.9403 2209.021,-16007.9711 2225.4494,-16019.1278"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2223.8724,-16022.2779 2234.1598,-16024.8118 2227.6979,-16016.4157 2223.8724,-16022.2779"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge513" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M1277.3714,-9621.1248C1297.3822,-9631.3989 1323.8923,-9648.7601 1336.1997,-9673.0235 1423.9143,-9845.9485 1307.4949,-12980.239 1372.1997,-13163.0235 1410.0474,-13269.9396 1475.8531,-13263.748 1530.6973,-13363.0235 1553.944,-13405.1032 1541.0643,-13424.3533 1566.6973,-13465.0235 1620.9926,-13551.1704 1658.7495,-13553.0383 1728.717,-13627.0235 1822.1145,-13725.7841 1852.4521,-13745.2124 1932.5662,-13855.0235 1995.7537,-13941.6337 2092.936,-14204.3552 2176.8962,-14271.0235 2204.9407,-14293.2921 2234.6772,-14264.7541 2253.8123,-14295.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge535" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1451.4485,-9649.0235C1492.9165,-9665.7651 1501.781,-9676.9101 1530.6973,-9711.0235 1552.3025,-9736.5119 1542.9367,-9753.5314 1566.6973,-9777.0235 1624.6702,-9834.3414 1683.8435,-9794.9606 1728.717,-9863.0235 1781.8636,-9943.6347 1707.2896,-10218.4039 1764.717,-10296.0235 1812.4908,-10360.595 1884.0075,-10299.0401 1932.5662,-10363.0235 1977.6964,-10422.4895 1955.5406,-10623.5165 1968.5662,-10697.0235 2024.0189,-11009.9599 2080.391,-11079.0246 2140.8962,-11391.0235 2162.7705,-11503.8193 2115.4804,-11549.918 2176.8962,-11647.0235 2231.3271,-11733.085 2344.1554,-11786.5249 2405.3661,-11810.3842"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2404.1394,-11813.6622 2414.73,-11813.9599 2406.6366,-11807.1228 2404.1394,-11813.6622"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge595" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M2850.2146,-15579.0235C2934.9875,-15662.1659 3117.876,-15909.6342 3225.8566,-15959.0235"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M3225.8566,-15959.0235C3294.4204,-15989.3045 3363.5881,-16045.9537 3396.5642,-16074.9351"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="3394.3464,-16077.6465 3404.1459,-16081.6742 3398.997,-16072.4146 3394.3464,-16077.6465"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1277.3704,-9621.1254C1297.3804,-9631.3998 1323.8902,-9648.7611 1336.1997,-9673.0235 1422.4964,-9843.1171 1272.1937,-12943.6112 1372.1997,-13106.0235 1413.7852,-13173.5595 1483.6323,-13124.185 1530.6973,-13188.0235 1584.5523,-13261.0719 1511.4341,-13317.0344 1566.6973,-13389.0235 1615.1298,-13452.1147 1663.2277,-13419.8865 1728.717,-13465.0235 1951.7615,-13618.7519 1991.5178,-13688.0426 2140.8962,-13914.0235 2242.1617,-14067.2188 2247.1208,-14117.5204 2330.7283,-14281.0235 2418.9256,-14453.5026 2457.5824,-14489.3053 2527.3586,-14670.0235 2674.315,-15050.6361 2486.5671,-15262.7731 2771.2632,-15555.0235 2796.8545,-15581.2939 2824.7106,-15552.6682 2850.2146,-15579.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge689" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M1451.4485,-9117.0235C1568.3111,-8997.5487 1604.7168,-9276.7427 1764.717,-9325.0235 1836.1359,-9346.5745 1859.1927,-9338.4934 1932.5662,-9325.0235 2210.7098,-9273.962 2265.0647,-9204.7263 2527.3586,-9099.0235 2670.5275,-9041.3274 2716.6518,-8893.6468 2850.2146,-8971.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge716" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1277.3692,-9621.1259C1297.3787,-9631.4007 1323.8881,-9648.7622 1336.1997,-9673.0235 1421.0786,-9840.2858 1275.418,-12888.355 1372.1997,-13049.0235 1413.5534,-13117.6753 1481.39,-13071.8412 1530.6973,-13135.0235 1570.2234,-13185.6722 1522.1009,-13228.7767 1566.6973,-13275.0235 1618.8293,-13329.0849 1661.9129,-13288.7075 1728.717,-13323.0235 1746.7471,-13332.2852 1746.6432,-13341.8474 1764.717,-13351.0235 1833.9012,-13386.1485 1861.2271,-13368.5119 1932.5662,-13399.0235 2031.2211,-13441.218 2052.0609,-13460.8451 2140.8962,-13521.0235 2157.678,-13532.3917 2158.9334,-13539.6319 2176.8962,-13549.0235 2208.6309,-13565.6155 2225.5072,-13551.0871 2253.8123,-13573.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge768" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1451.4485,-9535.0235C1493.5251,-9520.9161 1814.8586,-9548.2455 1848.6416,-9577.0235"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2649.3109,-9655.0235C2696.4198,-9647.33 2834.8624,-9533.8268 2850.2146,-9579.0235"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1293.0005,-9598.9251C1306.8393,-9594.8961 1322.2973,-9590.0818 1336.1997,-9585.0235 1388.6691,-9565.933 1396.0604,-9542.0693 1451.4485,-9535.0235"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1848.6416,-9577.0235C1910.2435,-9603.8186 1904.9529,-9647.4337 1968.5662,-9669.0235 2047.6051,-9695.8487 2291.7409,-9713.4192 2649.3109,-9655.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1253.5809,-9598.5654C1263.593,-9526.1556 1317.8508,-9124.5248 1336.1997,-8795.0235 1349.6123,-8554.1662 1313.8175,-4687.0826 1372.1997,-4453.0235 1409.0766,-4305.1811 1484.569,-4294.2456 1530.6973,-4149.0235 1566.8135,-4035.3217 1512.0404,-3989.0665 1566.6973,-3883.0235 1611.9333,-3795.2584 1686.3864,-3820.2263 1728.717,-3731.0235 1778.5667,-3625.9759 1706.7889,-3309.8418 1764.717,-3209.0235 1809.6438,-3130.8327 1885.0969,-3171.6974 1932.5662,-3095.0235 1995.3646,-2993.5896 1889.9437,-2918.7509 1968.5662,-2829.0235 2020.8857,-2769.3141 2077.4375,-2829.7261 2140.8962,-2782.0235 2165.4506,-2763.5658 2152.68,-2741.9226 2176.8962,-2723.0235 2205.1269,-2700.9914 2238.0302,-2731.1687 2253.8123,-2699.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge398" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1253.5795,-9598.5653C1263.5835,-9526.1551 1317.8002,-9124.522 1336.1997,-8795.0235 1339.4421,-8736.959 1341.3825,-4657.3418 1372.1997,-4608.0235 1413.9087,-4541.2746 1483.9202,-4592.3241 1530.6973,-4529.0235 1588.7982,-4450.399 1532.0228,-4403.4304 1566.6973,-4312.0235 1614.7216,-4185.4243 1676.5892,-4178.9891 1728.717,-4054.0235 1755.7776,-3989.1516 1739.5827,-3965.6658 1764.717,-3900.0235 1820.1838,-3755.1631 1863.707,-3733.0182 1932.5662,-3594.0235 1950.0546,-3558.7226 1948.5579,-3546.9598 1968.5662,-3513.0235 2033.0785,-3403.6032 2094.8927,-3403.4225 2140.8962,-3285.0235 2171.7766,-3205.5469 2116.8497,-2963.5589 2176.8962,-2903.0235 2244.4747,-2834.8949 2949.9928,-2772.5523 3036.0425,-2815.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M1275.6371,-9621.2335C1295.153,-9631.777 1321.8803,-9649.462 1336.1997,-9673.0235 1387.201,-9756.9421 1327.8076,-9803.429 1372.1997,-9891.0235 1417.7344,-9980.8726 1471.5629,-9971.4797 1530.6973,-10053.0235 1642.5005,-10207.1956 1668.9585,-10252.1978 1728.717,-10433.0235 1760.6324,-10529.5973 1737.9944,-10560.8859 1764.717,-10659.0235 1818.4002,-10856.1725 1883.8233,-10888.5954 1932.5662,-11087.0235 1967.9723,-11231.159 1920.0387,-11278.7604 1968.5662,-11419.0235 2015.8492,-11555.6896 2098.1737,-11556.8638 2140.8962,-11695.0235 2197.6669,-11878.613 2111.6809,-12378.2613 2176.8962,-12559.0235 2188.7424,-12591.8585 2215.3694,-12622.7224 2233.9549,-12641.4871"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="2231.7735,-12644.2504 2241.3613,-12648.7588 2236.6777,-12639.2554 2231.7735,-12644.2504"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M1276.6028,-9598.9353C1296.4355,-9588.5704 1323.097,-9571.075 1336.1997,-9547.0235 1391.6132,-9445.3061 1300.527,-9118.0186 1372.1997,-9027.0235 1374.7383,-9023.8006 1377.6907,-9020.9852 1380.9338,-9018.5266"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="1382.9242,-9021.4094 1389.5237,-9013.121 1379.196,-9015.4849 1382.9242,-9021.4094"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1302.3697,-9614.2295C1343.7011,-9618.9933 1403.0715,-9628.8922 1451.4485,-9649.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1451.4485,-9649.0235C1572.3947,-9699.3532 1649.5422,-9644.6569 1728.717,-9749.0235 1794.7055,-9836.0081 1704.3973,-10148.0162 1764.717,-10239.0235 1811.0257,-10308.8916 1883.1505,-10257.3173 1932.5662,-10325.0235 1990.4592,-10404.3447 1927.1849,-10453.9671 1968.5662,-10543.0235 1984.0858,-10576.4232 2013.801,-10607.4775 2033.9443,-10626.1019"/>
<polygon fill="#002eff" stroke="#002eff" points="2031.6367,-10628.734 2041.4044,-10632.838 2036.328,-10623.5385 2031.6367,-10628.734"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M1253.3905,-9598.5625C1262.7508,-9523.2897 1317.3092,-9099.1202 1372.1997,-8982.0235 1419.3111,-8881.5217 1488.2647,-8891.5885 1530.6973,-8789.0235 1562.2784,-8712.6879 1514.4812,-8483.039 1566.6973,-8419.0235 1570.2442,-8414.6751 1574.5313,-8411.0674 1579.2596,-8408.0763"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1580.9965,-8411.1168 1588.1822,-8403.3312 1577.7097,-8404.9364 1580.9965,-8411.1168"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1451.4485,-9877.0235C1511.8673,-9895.3493 1687.4632,-9891.2283 1728.717,-9939.0235 1800.0572,-10021.6757 1696.2927,-10343.9418 1764.717,-10429.0235 1767.885,-10432.9627 1771.6458,-10436.3003 1775.792,-10439.1262"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1774.3546,-10442.3352 1784.7774,-10444.2369 1777.8154,-10436.2505 1774.3546,-10442.3352"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1271.1822,-9621.1283C1289.5323,-9632.4398 1317.1466,-9651.3606 1336.1997,-9673.0235 1404.9734,-9751.2174 1351.9459,-9846.3096 1451.4485,-9877.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1253.5761,-9598.5651C1263.5586,-9526.1537 1317.6678,-9124.5146 1336.1997,-8795.0235 1342.1727,-8688.8255 1328.019,-5062.7797 1372.1997,-4966.0235 1382.6185,-4943.2063 1404.4925,-4924.8042 1422.625,-4912.6044"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1424.6377,-4915.4714 1431.1592,-4907.1215 1420.8541,-4909.5821 1424.6377,-4915.4714"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1451.4485,-8678.0235C1563.5315,-8210.6666 1543.5029,-8069.696 1764.717,-7643.0235 1889.7942,-7401.7776 2032.233,-7410.0942 2140.8962,-7161.0235 2181.0415,-7069.0052 2117.1866,-7018.7314 2176.8962,-6938.0235 2272.5259,-6808.7636 2466.683,-6759.4681 2573.9198,-6741.5659"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2574.7084,-6744.9839 2584.02,-6739.9299 2573.589,-6738.074 2574.7084,-6744.9839"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge272" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M3036.0425,-4715.0235C3116.8621,-4567.725 3193.288,-4379.5769 3217.7541,-4317.735"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3221.061,-4318.8896 3221.4694,-4308.3026 3214.548,-4316.3241 3221.061,-4318.8896"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1253.5408,-9598.563C1263.3077,-9526.139 1316.3297,-9124.4366 1336.1997,-8795.0235 1343.0714,-8681.1019 1335.607,-6849.1268 1372.1997,-6741.0235 1410.2628,-6628.5765 1474.0921,-6630.3738 1530.6973,-6526.0235 1532.5645,-6522.5813 1727.8069,-6001.8323 1728.717,-5998.0235 1762.4936,-5856.6752 1714.394,-5809.3606 1764.717,-5673.0235 1810.6765,-5548.5085 1889.6488,-5551.6195 1932.5662,-5426.0235 2016.51,-5180.3652 1880.7229,-5087.3146 1968.5662,-4843.0235 2012.6344,-4720.4702 2090.3655,-4726.0567 2140.8962,-4606.0235 2177.9773,-4517.9393 2103.8792,-4455.6867 2176.8962,-4394.0235 2229.1313,-4349.9108 2263.9115,-4379.5338 2330.7283,-4394.0235 2372.8017,-4403.1474 3015.3335,-4752.7669 3036.0425,-4715.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge293" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1276.5301,-9598.8954C1296.3183,-9588.5062 1322.9555,-9570.9973 1336.1997,-9547.0235 1384.0676,-9460.3761 1317.156,-9185.2993 1372.1997,-9103.0235 1416.1884,-9037.272 1481.7611,-9084.1807 1530.6973,-9022.0235 1573.1077,-8968.1551 1546.4443,-8937.5236 1566.6973,-8872.0235 1626.4133,-8678.8959 1676.4001,-8642.2854 1728.717,-8447.0235 1754.813,-8349.6258 1711.6428,-8308.7582 1764.717,-8223.0235 1823.3743,-8128.2702 1876.9886,-8140.5247 1968.5662,-8077.0235 1999.2892,-8055.7197 2498.6456,-7725.9676 2527.3586,-7702.0235 2544.9796,-7687.3292 2544.4266,-7677.985 2563.3586,-7665.0235 2631.8502,-7618.132 2675.8113,-7649.9492 2735.2632,-7592.0235 2762.8992,-7565.0969 2742.2336,-7538.4414 2771.2632,-7513.0235 2798.8559,-7488.8637 2825.683,-7516.2862 2850.2146,-7489.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge311" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1275.0408,-9598.892C1294.4545,-9588.2907 1321.3621,-9570.4785 1336.1997,-9547.0235 1379.3494,-9478.813 1352.0652,-9447.1847 1372.1997,-9369.0235 1401.4881,-9255.3276 1360.8083,-9191.6487 1451.4485,-9117.0235"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1451.4485,-9117.0235C1485.9729,-9088.5992 1496.5603,-9083.9119 1530.6973,-9055.0235 1638.2835,-8963.9787 1656.228,-8930.9906 1764.717,-8841.0235 1784.3024,-8824.7819 1807.4952,-8807.5118 1824.5309,-8795.1689"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1826.7569,-8797.8791 1832.8265,-8789.1951 1822.6663,-8792.1986 1826.7569,-8797.8791"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge350" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1253.5515,-9598.5637C1263.3842,-9526.1436 1316.7375,-9124.4609 1336.1997,-8795.0235 1344.0376,-8662.3509 1327.5528,-6528.2038 1372.1997,-6403.0235 1410.3004,-6296.1973 1487.8386,-6308.0313 1530.6973,-6203.0235 1588.453,-6061.5164 1517.1398,-6005.6059 1566.6973,-5861.0235 1610.9673,-5731.8669 1686.0564,-5729.7206 1728.717,-5600.0235 1791.2695,-5409.8509 1729.1347,-5348.0319 1764.717,-5151.0235 1823.5247,-4825.4236 1845.0853,-4741.9863 1968.5662,-4435.0235 2029.5827,-4283.3417 2081.9625,-4262.5267 2140.8962,-4110.0235 2164.2099,-4049.6946 2129.5919,-4013.1303 2176.8962,-3969.0235 2202.3097,-3945.3279 2223.1105,-3971.2939 2253.8123,-3955.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge370" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1451.4485,-9535.0235C1503.5228,-9515.1512 1895.6884,-9635.2303 1932.5662,-9677.0235 1998.1199,-9751.3148 1902.4443,-9823.2374 1968.5662,-9897.0235 2021.6266,-9956.2342 2072.2469,-9904.9163 2140.8962,-9945.0235 2166.6634,-9960.0775 2312.8551,-10111.1254 2330.7283,-10135.0235 2350.7401,-10161.7811 2340.8865,-10179.8423 2366.7283,-10201.0235 2371.359,-10204.8191 2376.5665,-10208.0401 2382.0472,-10210.7733"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2380.9131,-10214.0982 2391.4754,-10214.9278 2383.7358,-10207.6925 2380.9131,-10214.0982"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1451.4485,-8678.0235C1500.6584,-8484.4205 2067.3011,-5244.559 2253.8123,-5173.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1252.6323,-9598.753C1257.8993,-9509.7404 1295.3976,-8919.4201 1372.1997,-8761.0235 1394.4521,-8715.1303 1439.5539,-8727.6207 1451.4485,-8678.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge233" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1253.5295,-9598.5623C1263.2276,-9526.1342 1315.9022,-9124.4105 1336.1997,-8795.0235 1348.4281,-8596.5819 1315.8106,-7196.6773 1372.1997,-7006.0235 1393.5204,-6933.9374 1695.7806,-6498.597 1728.717,-6431.0235 1749.0474,-6389.3131 1740.8716,-6372.8291 1764.717,-6333.0235 1906.2981,-6096.6802 1937.534,-6006.4386 2176.8962,-5870.0235 2207.1559,-5852.7782 2222.6467,-5870.5721 2253.8123,-5855.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge255" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2850.2146,-4392.0235C2997.2485,-4267.5708 2909.9075,-3492.9728 2965.166,-2801.0235 2981.7391,-2593.4944 3020.6253,-2344.2556 3032.522,-2270.5427"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3036.0448,-2270.6842 3034.1921,-2260.2526 3029.1352,-2269.5627 3036.0448,-2270.6842"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1253.542,-9598.5631C1263.3166,-9526.1396 1316.3767,-9124.4394 1336.1997,-8795.0235 1350.1375,-8563.408 1325.7316,-6934.3574 1372.1997,-6707.0235 1409.6692,-6523.713 1464.6881,-6492.0935 1530.6973,-6317.0235 1642.2734,-6021.1006 1659.1245,-5943.1339 1764.717,-5645.0235 1838.2163,-5437.5194 1886.58,-5394.3033 1932.5662,-5179.0235 1977.0712,-4970.6778 1891.3396,-4899.5801 1968.5662,-4701.0235 2013.4619,-4585.5924 2091.6717,-4595.6762 2140.8962,-4482.0235 2183.2399,-4384.2578 2096.1009,-4314.4729 2176.8962,-4245.0235 2228.7442,-4200.4565 2262.6697,-4238.5074 2330.7283,-4245.0235 2419.3314,-4253.5066 2441.302,-4260.2918 2527.3586,-4283.0235 2600.5718,-4302.3626 2792.4153,-4440.9461 2850.2146,-4392.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge325" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1253.577,-9598.5651C1263.5653,-9526.154 1317.7034,-9124.5166 1336.1997,-8795.0235 1342.3014,-8686.3289 1341.8549,-4980.5746 1372.1997,-4876.0235 1383.7204,-4836.3298 1741.4578,-4278.1896 1764.717,-4244.0235 1850.1321,-4118.5549 1850.6855,-4065.6387 1968.5662,-3970.0235 2165.1478,-3810.5726 2274.9193,-3841.494 2527.3586,-3860.0235 2545.9081,-3861.3851 2565.9177,-3863.8966 2584.2583,-3866.6204"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2583.8418,-3870.0973 2594.256,-3868.1495 2584.9002,-3863.1778 2583.8418,-3870.0973"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge475" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1276.7212,-9621.0479C1296.6261,-9631.3739 1323.3272,-9648.8481 1336.1997,-9673.0235 1411.3878,-9814.2315 1306.9544,-10245.9551 1372.1997,-10392.0235 1412.638,-10482.555 1487.6227,-10459.7163 1530.6973,-10549.0235 1594.7914,-10681.9109 1502.9147,-10745.9863 1566.6973,-10879.0235 1610.7199,-10970.8455 1681.0335,-10951.0482 1728.717,-11041.0235 1768.5543,-11116.1935 1738.192,-11148.1906 1764.717,-11229.0235 1791.7368,-11311.3638 1818.0914,-11323.9268 1848.6416,-11405.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge575" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1277.3627,-9621.1293C1297.3682,-9631.406 1323.8756,-9648.7686 1336.1997,-9673.0235 1413.6659,-9825.4833 1322.2315,-12587.4748 1372.1997,-12751.0235 1418.195,-12901.5684 1433.5892,-12962.9904 1566.6973,-13047.0235 1809.4368,-13200.2687 2563.7738,-13211.9507 2850.2146,-13193.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge555" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1277.3761,-9621.1225C1297.3896,-9631.3952 1323.9012,-9648.7556 1336.1997,-9673.0235 1383.3654,-9766.0925 1351.696,-13326.7198 1372.1997,-13429.0235 1408.9673,-13612.4761 1464.322,-13644.092 1530.6973,-13819.0235 1547.7518,-13863.9707 1541.3877,-13880.1513 1566.6973,-13921.0235 1641.4203,-14041.6933 1773.4971,-14152.9158 1826.1033,-14194.6243"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1824.1024,-14197.5033 1834.1266,-14200.9334 1828.4293,-14192.0008 1824.1024,-14197.5033"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge618" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1266.9433,-9598.9396C1283.8218,-9586.4097 1312.0687,-9565.3651 1336.1997,-9547.0235 1439.2461,-9468.6995 1444.1965,-9410.8179 1566.6973,-9369.0235 1634.8488,-9345.7718 1670.3005,-9326.9192 1728.717,-9369.0235 1769.763,-9398.6078 1726.7252,-9443.6076 1764.717,-9477.0235 1834.0437,-9538.0001 1876.6718,-9508.0927 1968.5662,-9517.0235 2094.8996,-9529.3012 2129.105,-9526.6664 2253.8123,-9503.0235"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge638" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1848.6416,-9577.0235C1876.2414,-9604.4641 1904.4905,-9575.0701 1932.5662,-9602.0235 1968.1541,-9636.1889 1939.3504,-9667.2716 1968.5662,-9707.0235 2086.8379,-9867.948 2220.459,-9806.5134 2330.7283,-9973.0235 2369.0604,-10030.9062 2323.7174,-10070.5275 2366.7283,-10125.0235 2416.2629,-10187.7853 2483.3028,-10139.3017 2527.3586,-10206.0235 2562.1422,-10258.7027 2558.5837,-10710.0775 2563.3586,-10773.0235 2592.3812,-11155.6148 2637.1582,-11621.8881 2647.2456,-11725.8284"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2643.7799,-11726.3522 2648.2311,-11735.9667 2650.7471,-11725.6749 2643.7799,-11726.3522"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge741" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1275.9315,-9621.0596C1295.6314,-9631.4943 1322.4636,-9649.1173 1336.1997,-9673.0235 1405.9619,-9794.4366 1334.5989,-9851.1381 1372.1997,-9986.0235 1474.4421,-10352.7978 1632.0255,-10396.7469 1728.717,-10765.0235 1776.9686,-10948.803 1692.2564,-11015.3745 1764.717,-11191.0235 1808.9713,-11298.2984 1887.0436,-11284.2807 1932.5662,-11391.0235 1990.7893,-11527.5472 1919.4608,-11582.9617 1968.5662,-11723.0235 2015.7902,-11857.7193 2098.3075,-11857.7911 2140.8962,-11994.0235 2201.2158,-12186.9731 2116.4918,-12710.1004 2176.8962,-12903.0235 2231.831,-13078.4772 2379.2597,-13252.2574 2429.7794,-13308.3316"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2427.1924,-13310.6891 2436.5074,-13315.737 2432.3735,-13305.9819 2427.1924,-13310.6891"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge544" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2256.0916,-3129.1467C2267.1315,-3183.6503 2315.1476,-3428.0897 2330.7283,-3631.0235 2339.3723,-3743.6099 2317.4909,-11659.4061 2366.7283,-11761.0235 2376.7912,-11781.7917 2397.2105,-11797.9198 2414.941,-11808.7908"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2413.4934,-11811.9975 2423.8986,-11813.9931 2417.009,-11805.9443 2413.4934,-11811.9975"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M2258.3044,-3106.6572C2271.9937,-3071.4446 2313.3138,-2960.7791 2330.7283,-2865.0235 2341.8052,-2804.1154 2328.4382,-2357.6688 2366.7283,-2309.0235 2369.2475,-2305.823 2372.171,-2303.0232 2375.381,-2300.5747"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="2377.3117,-2303.4948 2383.8827,-2295.1838 2373.5631,-2297.5831 2377.3117,-2303.4948"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge404" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M3036.0425,-4259.0235C3058.3534,-4398.1666 3091.4929,-2962.5383 3225.8566,-3005.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M2330.9578,-3111.5849C2436.1882,-3107.2556 2624.2968,-3116.0561 2735.2632,-3219.0235 3087.9731,-3546.3083 2959.863,-3783.9274 3036.0425,-4259.0235"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge332" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-3309.0235C2535.8816,-3385.7247 2624.0441,-3763.5053 2644.7578,-3857.0442"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2641.3812,-3857.9866 2646.945,-3867.0029 2648.2183,-3856.4849 2641.3812,-3857.9866"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2303.7047,-3129.0323C2313.2285,-3132.5313 2322.7138,-3137.0945 2330.7283,-3143.0235 2403.1511,-3196.6009 2378.8552,-3250.1511 2447.0435,-3309.0235"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge580" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3036.0425,-4259.0235C3041.3079,-4291.8617 3087.4541,-4256.0571 3106.9189,-4283.0235 3154.5629,-4349.0289 3127.7725,-10064.0407 3142.9189,-10144.0235 3157.0717,-10218.7592 3195.9483,-10301.0731 3215.019,-10338.4871"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3212.1346,-10340.5293 3219.8357,-10347.8056 3218.353,-10337.315 3212.1346,-10340.5293"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge468" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1457.1365,-8990.8684C1472.6014,-8959.8647 1515.2858,-8869.6314 1530.6973,-8789.0235 1565.4255,-8607.3814 1494.0779,-7295.1009 1566.6973,-7125.0235 1606.6838,-7031.3734 1689.2128,-7056.8781 1728.717,-6963.0235 1797.129,-6800.4897 1731.1099,-3962.1362 1764.717,-3789.0235 1779.2355,-3714.2379 1818.479,-3631.9483 1837.7142,-3594.55"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1841.051,-3595.7208 1842.5718,-3585.2357 1834.8443,-3592.4839 1841.051,-3595.7208"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge508" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1647.7072,-9763.0235C1665.6664,-9827.5197 1707.0047,-9826.6921 1728.717,-9890.0235 1784.7388,-10053.4297 1688.6838,-10121.9141 1764.717,-10277.0235 1809.6775,-10368.7437 1890.7393,-10340.8326 1932.5662,-10434.0235 1998.1484,-10580.1418 1892.384,-11734.1411 1968.5662,-11875.0235 2012.8394,-11956.8973 2097.2765,-11911.7997 2140.8962,-11994.0235 2244.4956,-12189.3098 2081.3803,-15773.6589 2176.8962,-15973.0235 2186.5497,-15993.1727 2206.1046,-16009.0521 2223.0805,-16019.8285"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2221.2846,-16022.8326 2231.6566,-16024.9942 2224.8964,-16016.8363 2221.2846,-16022.8326"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1464.1832,-9013.239C1482.6943,-9030.4346 1516.3834,-9065.3067 1530.6973,-9103.0235 1577.9337,-9227.4911 1504.1795,-9583.4864 1566.6973,-9701.0235 1587.9885,-9741.0523 1635.2707,-9719.4235 1647.7072,-9763.0235"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge527" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M1464.0763,-9013.2803C1482.451,-9030.5285 1515.9682,-9065.4669 1530.6973,-9103.0235 1601.8498,-9284.4501 1496.0768,-9358.3892 1566.6973,-9540.0235 1609.2881,-9649.5663 1685.8774,-9639.5777 1728.717,-9749.0235 1762.3772,-9835.0177 1717.9959,-10083.3672 1764.717,-10163.0235 1810.3411,-10240.8095 1889.243,-10197.9329 1932.5662,-10277.0235 2001.0254,-10402.0025 1931.0575,-11421.548 1968.5662,-11559.0235 2010.2632,-11711.8502 2099.7418,-11718.0498 2140.8962,-11871.0235 2239.9854,-12239.3446 2090.4645,-13215.5283 2176.8962,-13587.0235 2213.5656,-13744.6335 2284.0247,-13762.0903 2330.7283,-13917.0235 2417.8724,-14206.1129 2441.3989,-14576.5653 2446.0655,-14668.6098"/>
<polygon fill="#65ff00" stroke="#65ff00" points="2442.5825,-14669.0459 2446.5643,-14678.864 2449.5742,-14668.7058 2442.5825,-14669.0459"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge545" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2253.8123,-11177.0235C2263.1388,-11208.7254 2349.6116,-11732.7567 2366.7283,-11761.0235 2378.8392,-11781.0238 2399.6183,-11797.3279 2417.0065,-11808.4742"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2415.3726,-11811.578 2425.7265,-11813.8251 2419.0338,-11805.6117 2415.3726,-11811.578"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1463.2343,-9013.2254C1480.8374,-9030.6716 1513.7374,-9066.1747 1530.6973,-9103.0235 1564.8075,-9177.1349 1528.1989,-9211.0939 1566.6973,-9283.0235 1614.7491,-9372.8026 1686.778,-9352.2314 1728.717,-9445.0235 1780.6239,-9559.87 1685.6761,-9912.8574 1764.717,-10011.0235 1789.0473,-10041.2409 1836.5602,-9998.1576 1848.6416,-10035.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1848.6416,-10035.0235C1859.9621,-10071.1045 1906.6466,-10021.4887 1932.5662,-10049.0235 1984.9464,-10104.668 1930.1992,-10324.9329 1968.5662,-10391.0235 2015.9391,-10472.6277 2094.7912,-10432.6963 2140.8962,-10515.0235 2193.8115,-10609.5115 2150.8412,-10895.9086 2176.8962,-11001.0235 2197.4345,-11083.8818 2229.7189,-11095.1282 2253.8123,-11177.0235"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge725" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1463.5471,-9013.0878C1481.5589,-9030.3542 1514.9853,-9065.6255 1530.6973,-9103.0235 1578.4419,-9216.6665 1528.3664,-9260.8697 1566.6973,-9378.0235 1613.2124,-9520.1915 1684.6765,-9530.0696 1728.717,-9673.0235 1778.1429,-9833.4579 1699.8329,-9894.194 1764.717,-10049.0235 1809.5685,-10156.0501 1891.252,-10140.5824 1932.5662,-10249.0235 1980.3731,-10374.507 1936.3168,-11326.6717 1968.5662,-11457.0235 2010.3992,-11626.1124 2099.5317,-11639.8194 2140.8962,-11809.0235 2160.4803,-11889.1331 2123.2967,-13230.3483 2176.8962,-13293.0235 2199.4793,-13319.4305 2243.6031,-13273.8106 2253.8123,-13307.0235"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge777" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1848.6416,-9311.0235C1876.5534,-9337.9676 1902.4299,-9310.5928 1932.5662,-9335.0235 1959.13,-9356.5582 1944.5532,-9378.6769 1968.5662,-9403.0235 2195.1123,-9632.7174 2330.4536,-9704.1407 2649.3109,-9655.0235"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1457.1563,-8990.8721C1472.6717,-8959.8781 1515.4733,-8869.667 1530.6973,-8789.0235 1574.4001,-8557.523 1547.0018,-6903.7883 1566.6973,-6669.0235 1606.8705,-6190.1687 1688.9307,-6078.9106 1728.717,-5600.0235 1734.1063,-5535.156 1725.1276,-3308.6909 1764.717,-3257.0235 1811.9086,-3195.4348 1880.9418,-3266.9471 1932.5662,-3209.0235 1997.9041,-3135.7131 1922.3525,-3077.6708 1968.5662,-2991.0235 2018.0359,-2898.2714 2084.0071,-2917.4194 2140.8962,-2829.0235 2167.8222,-2787.1852 2141.2788,-2757.7634 2176.8962,-2723.0235 2202.5319,-2698.0195 2238.0675,-2731.187 2253.8123,-2699.0235"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge405" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1461.7252,-8990.7738C1477.8977,-8972.668 1509.6136,-8935.4923 1530.6973,-8900.0235 1642.972,-8711.1451 1648.7127,-8651.6695 1728.717,-8447.0235 1746.5266,-8401.4679 1730.5533,-8378.0283 1764.717,-8343.0235 1964.7166,-8138.0999 2750.1102,-8117.6539 3036.0425,-8133.0235"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M1513.3996,-8990.9467C1520.0515,-8987.4649 1526.0692,-8982.9278 1530.6973,-8977.0235 1607.3542,-8879.2292 1489.7352,-8516.5778 1566.6973,-8419.0235 1570.1729,-8414.6179 1574.41,-8410.9701 1579.1047,-8407.952"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1580.8377,-8410.9941 1587.9837,-8403.172 1577.5195,-8404.8305 1580.8377,-8410.9941"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-9763.0235C1666.785,-9831.5372 1707.7368,-9833.0682 1728.717,-9901.0235 1763.4103,-10013.3956 1691.2551,-10337.1842 1764.717,-10429.0235 1767.8746,-10432.971 1771.6277,-10436.3148 1775.7684,-10439.1451"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1774.3245,-10442.3507 1784.7454,-10444.2626 1777.7912,-10436.2694 1774.3245,-10442.3507"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1463.6457,-8990.8651C1481.7863,-8973.4478 1515.3786,-8937.8531 1530.6973,-8900.0235 1585.9071,-8763.6827 1520.439,-8710.6556 1566.6973,-8571.0235 1589.0631,-8503.5116 1620.0555,-8498.5482 1647.7072,-8433.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-7031.0235C2276.9656,-7000.9744 2302.9723,-7019.8814 2330.7283,-6994.0235 2354.3243,-6972.0411 2340.3345,-6949.5538 2366.7283,-6931.0235 2396.3833,-6910.2035 2416.8381,-6937.0368 2447.0435,-6917.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-8433.0235C1662.0856,-8398.9517 1704.2371,-8441.7428 1728.717,-8414.0235 1778.572,-8357.5715 1740.3987,-8148.3044 1764.717,-8077.0235 1816.2622,-7925.9365 2090.8563,-7616.6157 2140.8962,-7465.0235 2169.9127,-7377.1203 2116.7273,-7120.37 2176.8962,-7050.0235 2199.7841,-7023.2642 2232.3203,-7058.9164 2253.8123,-7031.0235"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge283" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2850.2146,-4715.0235C2932.5064,-4722.0379 2996.3142,-4787.4307 3036.0425,-4715.0235"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1457.0461,-8990.8506C1472.2798,-8959.8015 1514.4281,-8869.4627 1530.6973,-8789.0235 1567.648,-8606.3288 1517.0237,-8130.6767 1566.6973,-7951.0235 1606.977,-7805.3449 1688.3093,-7797.6667 1728.717,-7652.0235 1776.5898,-7479.4737 1734.2081,-7023.473 1764.717,-6847.0235 1808.0437,-6596.4424 1887.2941,-6550.2605 1932.5662,-6300.0235 1979.8884,-6038.4544 1903.9629,-5960.8688 1968.5662,-5703.0235 2013.1449,-5525.1002 2097.5683,-5506.2556 2140.8962,-5328.0235 2161.3641,-5243.8277 2114.2286,-4608.8619 2176.8962,-4549.0235 2226.3443,-4501.8078 2263.1744,-4538.4925 2330.7283,-4549.0235 2570.2198,-4586.3579 2608.7063,-4694.4378 2850.2146,-4715.0235"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge301" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2850.2146,-7489.0235C2881.6554,-7457.3682 2903.7655,-7463.7032 2929.166,-7427.0235 3001.4452,-7322.6484 3026.636,-7167.0119 3033.6938,-7110.5025"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3037.2036,-7110.626 3034.9038,-7100.2838 3030.2522,-7109.8028 3037.2036,-7110.626"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1647.7072,-8433.0235C1661.771,-8398.8207 1704.0519,-8441.5781 1728.717,-8414.0235 1817.9889,-8314.2939 1693.173,-8228.1469 1764.717,-8115.0235 1875.8882,-7939.2428 2382.585,-7729.8767 2563.3586,-7627.0235 2654.9525,-7574.9101 2674.1322,-7553.8992 2771.2632,-7513.0235 2805.0668,-7498.7979 2824.3698,-7515.0446 2850.2146,-7489.0235"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge357" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1457.0978,-8990.8609C1472.4635,-8959.838 1514.918,-8869.5602 1530.6973,-8789.0235 1580.7112,-8533.7538 1526.2934,-7875.9895 1566.6973,-7619.0235 1607.008,-7362.6499 1686.6216,-7314.1101 1728.717,-7058.0235 1786.8077,-6704.6308 1712.0508,-6607.2652 1764.717,-6253.0235 1808.9735,-5955.3473 1882.8186,-5893.8314 1932.5662,-5597.0235 1965,-5403.5138 1936.1835,-5350.5418 1968.5662,-5157.0235 2019.6668,-4851.6468 2068.8106,-4783.1379 2140.8962,-4482.0235 2157.967,-4410.7158 2137.9428,-4383.143 2176.8962,-4321.0235 2282.519,-4152.5856 2380.0265,-4176.5178 2527.3586,-4043.0235 2585.1119,-3990.6946 2571.3913,-3918.5363 2649.3109,-3917.0235"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge384" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1848.6416,-9463.0235C1883.0459,-9509.7453 1908.9903,-9510.0069 1932.5662,-9563.0235 1979.6095,-9668.8128 1899.0155,-9728.4646 1968.5662,-9821.0235 2074.4925,-9961.9917 2217.2364,-9848.0716 2330.7283,-9983.0235 2372.6337,-10032.8527 2337.821,-10066.685 2366.7283,-10125.0235 2382.5684,-10156.9909 2409.7809,-10188.2705 2428.0872,-10207.3475"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2425.8313,-10210.0463 2435.3284,-10214.7427 2430.8329,-10205.1489 2425.8313,-10210.0463"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge244" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1456.8616,-8990.8112C1471.6237,-8959.6613 1512.6787,-8869.0889 1530.6973,-8789.0235 1571.3454,-8608.4038 1525.1828,-8554.4461 1566.6973,-8374.0235 1611.8402,-8177.8313 1686.2458,-8147.8114 1728.717,-7951.0235 1785.6371,-7687.2878 1717.5552,-7610.6778 1764.717,-7345.0235 1863.6026,-6788.0185 1982.1778,-6672.0165 2140.8962,-6129.0235 2158.4388,-6069.0086 2134.3913,-6038.8804 2176.8962,-5993.0235 2237.6179,-5927.5133 2279.6997,-5947.1413 2366.7283,-5927.0235 2428.3523,-5912.7783 2602.1324,-5935.1499 2649.3109,-5893.0235"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge269" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1457.052,-8990.8518C1472.3007,-8959.8057 1514.4839,-8869.4739 1530.6973,-8789.0235 1606.8017,-8411.3946 1505.6121,-8303.3708 1566.6973,-7923.0235 1608.46,-7662.9871 1685.8609,-7612.8819 1728.717,-7353.0235 1780.8534,-7036.8941 1718.8562,-6950.1241 1764.717,-6633.0235 1810.1395,-6318.9537 1877.7395,-6251.5889 1932.5662,-5939.0235 1957.7509,-5795.4459 1940.3127,-5756.0289 1968.5662,-5613.0235 2022.2591,-5341.2561 2093.7252,-5286.9985 2140.8962,-5014.0235 2151.8721,-4950.5073 2131.3562,-4480.6402 2176.8962,-4435.0235 2282.8245,-4328.9172 2737.411,-4490.7893 2850.2146,-4392.0235"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge582" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-10835.0235C2683.5647,-10947.5241 2833.8569,-11020.5157 3036.0425,-10854.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1461.8683,-9013.0659C1478.2369,-9030.8611 1510.2168,-9067.4934 1530.6973,-9103.0235 1552.2121,-9140.3479 1538.2212,-9160.6953 1566.6973,-9193.0235 1621.1442,-9254.8361 1684.7467,-9213.3681 1728.717,-9283.0235 1797.1763,-9391.4731 1684.3401,-9759.0858 1764.717,-9859.0235 1813.3444,-9919.485 1882.6297,-9847.6386 1932.5662,-9907.0235 1981.1806,-9964.8363 1932.7606,-10178.513 1968.5662,-10245.0235 2015.6094,-10332.4086 2078.624,-10309.7488 2140.8962,-10387.0235 2162.8479,-10414.2637 2158.6773,-10427.1576 2176.8962,-10457.0235 2230.6647,-10545.1648 2358.9116,-10781.2397 2447.0435,-10835.0235"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge624" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1848.6416,-9311.0235C1875.1865,-9339.3152 1898.2749,-9316.8808 1932.5662,-9335.0235 1950.9757,-9344.7635 1950.1232,-9355.3469 1968.5662,-9365.0235 2003.7684,-9383.4933 2019.4698,-9370.6669 2054.7312,-9389.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1524.6265,-9008.885C1588.1094,-9018.8453 1677.6158,-9043.2499 1728.717,-9103.0235 1782.8649,-9166.3608 1708.3617,-9225.6421 1764.717,-9287.0235 1790.9543,-9315.6007 1822.0967,-9282.7318 1848.6416,-9311.0235"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge652" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1848.6416,-9463.0235C2051.0454,-9742.9543 2368.115,-9622.7218 2447.0435,-9959.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1465.4035,-9013.1557C1516.16,-9053.8789 1690.0028,-9195.4718 1728.717,-9255.0235 1756.2943,-9297.4439 1740.0177,-9318.8653 1764.717,-9363.0235 1793.0414,-9413.6626 1815.6204,-9415.3141 1848.6416,-9463.0235"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge754" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1848.6416,-10035.0235C1859.9621,-10071.1045 1907.4342,-10020.768 1932.5662,-10049.0235 1987.4969,-10110.7813 1945.0459,-10712.7883 1968.5662,-10792.0235 2011.7759,-10937.5888 2098.1796,-10941.3128 2140.8962,-11087.0235 2194.9567,-11271.4292 2151.8602,-11760.4948 2176.8962,-11951.0235 2217.774,-12262.1111 2270.3344,-12332.129 2330.7283,-12640.0235 2381.9811,-12901.3162 2431.0895,-13221.1805 2443.8493,-13305.7159"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2440.3954,-13306.2849 2445.345,-13315.6525 2447.3174,-13305.2429 2440.3954,-13306.2849"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge500" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2056.6514,-10655.0415C2067.6316,-10718.6538 2122.6164,-11045.5086 2140.8962,-11315.0235 2149.6522,-11444.1197 2121.0661,-15856.2953 2176.8962,-15973.0235 2186.5364,-15993.179 2206.0915,-16009.0584 2223.0707,-16019.8331"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2221.2764,-16022.8382 2231.6488,-16024.9979 2224.8872,-16016.8413 2221.2764,-16022.8382"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge517" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M2056.6058,-10655.0447C2067.3327,-10718.6749 2121.1448,-11045.6125 2140.8962,-11315.0235 2148.7374,-11421.9773 2121.7745,-13153.0333 2176.8962,-13245.0235 2217.1571,-13312.213 2288.2485,-13265.2144 2330.7283,-13331.0235 2331.9168,-13332.8648 2430.5344,-14495.3411 2445.2225,-14668.5478"/>
<polygon fill="#65ff00" stroke="#65ff00" points="2441.7509,-14669.0309 2446.0834,-14678.6994 2448.7258,-14668.4394 2441.7509,-14669.0309"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge548" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2253.8123,-11633.0235C2260.9399,-11668.1174 2305.0197,-11632.0945 2330.7283,-11657.0235 2365.8434,-11691.0738 2338.4831,-11721.0897 2366.7283,-11761.0235 2380.493,-11780.4844 2401.7859,-11797.074 2418.9896,-11808.4836"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2417.2428,-11811.5211 2427.5517,-11813.9656 2421.0173,-11805.6258 2417.2428,-11811.5211"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2064.3828,-10655.3376C2082.9837,-10677.8853 2123.4931,-10730.7638 2140.8962,-10783.0235 2198.4119,-10955.7363 2153.2708,-11010.5253 2176.8962,-11191.0235 2202.7745,-11388.7338 2214.1246,-11437.6165 2253.8123,-11633.0235"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge693" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M2092.5447,-10641.8728C2109.6268,-10638.926 2128.675,-10632.5423 2140.8962,-10619.0235 2200.2909,-10553.3225 2138.3575,-10502.7675 2176.8962,-10423.0235 2232.6538,-10307.6507 2254.5356,-10267.9314 2366.7283,-10206.0235 2466.884,-10150.7576 2804.8256,-10135.5761 2958.6428,-10131.4893"/>
<polygon fill="#00cbff" stroke="#00cbff" points="2959.042,-10134.9803 2968.9489,-10131.2248 2958.8623,-10127.9826 2959.042,-10134.9803"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge728" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2058.6214,-10655.2015C2072.8359,-10696.6426 2122.1104,-10845.6848 2140.8962,-10973.0235 2204.3774,-11403.3272 2121.2741,-11519.6336 2176.8962,-11951.0235 2217.0196,-12262.2093 2288.4148,-12329.1279 2330.7283,-12640.0235 2373.1587,-12951.7786 2325.9048,-13035.0539 2366.7283,-13347.0235 2384.7639,-13484.8505 2426.2133,-13647.1769 2441.3642,-13704.0687"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2438.0575,-13705.2511 2444.029,-13714.0028 2444.8185,-13703.4374 2438.0575,-13705.2511"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge781" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2078.0348,-10655.2097C2097.7131,-10665.8461 2125.1343,-10683.6789 2140.8962,-10707.0235 2177.3291,-10760.9833 2137.2528,-10797.3765 2176.8962,-10849.0235 2224.5897,-10911.158 2265.3781,-10891.8411 2330.7283,-10935.0235 2422.8843,-10995.9189 2463.7725,-10996.703 2527.3586,-11087.0235 2699.5246,-11331.5754 2682.7689,-11432.5899 2735.2632,-11727.0235 2753.375,-11828.6102 2708.2224,-12573.3304 2771.2632,-12655.0235 2793.6689,-12684.0586 2814.0114,-12684.8868 2850.2146,-12679.0235"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2850.2146,-12679.0235C2886.4376,-12673.2834 2905.8044,-12683.2952 2929.166,-12655.0235 2977.5633,-12596.4543 2955.9356,-12390.4386 2965.166,-12315.0235 2988.4157,-12125.0675 3022.3458,-11896.159 3032.834,-11826.2881"/>
<polygon fill="#ff0066" stroke="#ff0066" points="3036.3352,-11826.5411 3034.3618,-11816.1317 3029.4131,-11825.4998 3036.3352,-11826.5411"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M2055.6088,-10632.9055C2063.4237,-10533.3082 2121.2556,-9784.0101 2140.8962,-9175.0235 2146.3673,-9005.3865 2133.7251,-3229.1664 2176.8962,-3065.0235 2212.6168,-2929.209 2290.3465,-2923.5257 2330.7283,-2789.0235 2361.4865,-2686.575 2300.1408,-2392.7367 2366.7283,-2309.0235 2369.2638,-2305.8359 2372.2001,-2303.0462 2375.4198,-2300.6054"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="2377.3506,-2303.5256 2383.94,-2295.2292 2373.6151,-2297.6056 2377.3506,-2303.5256"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge410" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M2055.8223,-10632.7603C2064.4475,-10543.1193 2121.7914,-9935.8603 2140.8962,-9441.0235 2142.5956,-9397.007 2149.6408,-3132.6282 2176.8962,-3098.0235 2198.6839,-3070.361 2228.4963,-3103.4983 2253.8123,-3079.0235"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M2058.6647,-10655.1952C2073.0304,-10696.6144 2122.7658,-10845.5898 2140.8962,-10973.0235 2225.94,-11570.7717 2099.7752,-11732.2016 2176.8962,-12331.0235 2192.1454,-12449.4288 2231.7625,-12587.5098 2247.3636,-12639.1439"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="2244.0469,-12640.2669 2250.3108,-12648.8118 2250.7427,-12638.2257 2244.0469,-12640.2669"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge361" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2253.8123,-4563.0235C2306.748,-4444.897 2431.7193,-4550.2542 2527.3586,-4463.0235 2554.9732,-4437.8368 2533.4905,-4409.492 2563.3586,-4387.0235 2594.2887,-4363.7562 2624.3158,-4402.5748 2649.3109,-4373.0235"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge375" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2092.5719,-10638.3844C2108.4846,-10634.7128 2126.5846,-10628.7243 2140.8962,-10619.0235 2293.7974,-10515.3829 2404.6582,-10311.1383 2437.2037,-10246.2877"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2440.4459,-10247.6275 2441.7491,-10237.1131 2434.1734,-10244.5199 2440.4459,-10247.6275"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2055.814,-10632.7599C2064.375,-10543.1164 2121.3157,-9935.8417 2140.8962,-9441.0235 2143.4983,-9375.2675 2138.0163,-4756.1175 2176.8962,-4703.0235 2180.965,-4697.4672 2186.298,-4693.1224 2192.2615,-4689.7286"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2193.84,-4692.8538 2201.376,-4685.4067 2190.8408,-4686.5288 2193.84,-4692.8538"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge219" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2055.8186,-10632.7601C2064.4147,-10543.118 2121.5761,-9935.852 2140.8962,-9441.0235 2152.8175,-9135.694 2136.4059,-4243.891 2176.8962,-3941.0235 2190.6956,-3837.804 2229.8528,-3718.9336 2246.3444,-3671.8119"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2249.7277,-3672.7424 2249.763,-3662.1476 2243.1284,-3670.408 2249.7277,-3672.7424"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge336" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2055.8143,-10632.7599C2064.3777,-10543.1165 2121.3334,-9935.8424 2140.8962,-9441.0235 2146.145,-9308.2624 2132.0794,-4783.1016 2176.8962,-4658.0235 2195.2211,-4606.8813 2222.4951,-4607.4145 2253.8123,-4563.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-4563.0235C2412.5707,-4337.9892 2421.3239,-4261.1914 2527.3586,-4007.0235 2546.1913,-3961.8812 2527.9148,-3936.7315 2563.3586,-3903.0235 2569.3632,-3897.3131 2576.5951,-3892.8969 2584.2828,-3889.4835"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2585.7648,-3892.6632 2593.8342,-3885.7977 2583.2446,-3886.1326 2585.7648,-3892.6632"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge586" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2072.7221,-10655.1513C2096.3537,-10669.6462 2139.2684,-10695.5512 2176.8962,-10716.0235 2259.7693,-10761.1127 2279.0154,-10776.2755 2366.7283,-10811.0235 2401.3646,-10824.7449 2412.4198,-10821.2699 2447.0435,-10835.0235"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge630" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2092.7606,-10642.5072C2110.1089,-10639.7268 2129.3202,-10633.2998 2140.8962,-10619.0235 2208.8244,-10535.2502 2118.9102,-10225.9621 2176.8962,-10135.0235 2219.0089,-10068.9789 2280.4393,-10109.0767 2330.7283,-10049.0235 2362.1318,-10011.5226 2343.0658,-9987.8322 2366.7283,-9945.0235 2421.8817,-9845.2435 2472.2052,-9844.8035 2527.3586,-9745.0235 2551.0211,-9702.2149 2542.3686,-9685.204 2563.3586,-9641.0235 2584.706,-9596.091 2617.1291,-9547.5063 2635.4438,-9521.3477"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2638.3786,-9523.2595 2641.2923,-9513.0732 2632.6623,-9519.2192 2638.3786,-9523.2595"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge746" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-11633.0235C2267.7881,-11701.8353 2311.7455,-11703.4214 2330.7283,-11771.0235 2386.1613,-11968.4333 2349.8277,-12488.6762 2366.7283,-12693.0235 2386.6883,-12934.3633 2430.9958,-13225.0421 2443.6239,-13305.4906"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2440.2352,-13306.4712 2445.2506,-13315.8038 2447.1497,-13305.3805 2440.2352,-13306.4712"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge784" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1254.6243,-4036.2829C1276.2872,-4127.7136 1427.3957,-4748.2252 1566.6973,-4871.0235 1622.1801,-4919.9332 1665.6839,-4870.3283 1728.717,-4909.0235 1848.5649,-4982.5964 1876.0297,-5022.2597 1932.5662,-5151.0235 1983.1851,-5266.3099 1932.9967,-5311.2425 1968.5662,-5432.0235 2018.7913,-5602.5698 2096.8352,-5620.7817 2140.8962,-5793.0235 2176.6387,-5932.7464 2124.3053,-6306.7321 2176.8962,-6441.0235 2216.0148,-6540.9132 2267.0423,-6540.6968 2330.7283,-6627.0235 2566.3194,-6946.3684 2633.0806,-7039.5616 2735.2632,-7423.0235 2768.5918,-7548.0962 2753.8824,-7583.7586 2771.2632,-7712.0235 2836.2844,-8191.8618 2889.802,-8307.4025 2929.166,-8790.0235 3004.256,-9710.6604 2922.3124,-9945.324 2965.166,-10868.0235 2982.2193,-11235.2051 3024.1584,-11681.89 3033.9669,-11783.6924"/>
<polygon fill="#ff0066" stroke="#ff0066" points="3030.5078,-11784.2851 3034.9545,-11793.9016 3037.4753,-11783.6111 3030.5078,-11784.2851"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1314.6176,-4013.9466C1322.5651,-4010.4849 1330.0527,-4005.9532 1336.1997,-4000.0235 1372.3114,-3965.1885 1351.5617,-3938.7576 1372.1997,-3893.0235 1502.6271,-3603.9949 1592.3644,-3561.3045 1728.717,-3275.0235 1747.9542,-3234.634 1740.0344,-3218.335 1764.717,-3181.0235 1821.9193,-3094.5539 1884.378,-3110.8222 1932.5662,-3019.0235 1978.2088,-2932.0741 1906.2012,-2876.8791 1968.5662,-2801.0235 2031.3547,-2724.6527 2083.3741,-2755.094 2176.8962,-2723.0235 2210.7703,-2711.4075 2237.9806,-2731.1443 2253.8123,-2699.0235"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M1253.3565,-4036.2398C1262.7307,-4113.3865 1317.4729,-4573.5566 1336.1997,-4950.0235 1341.9699,-5066.0233 1341.6763,-9018.963 1372.1997,-9131.0235 1455.5347,-9436.9715 1628.5663,-9448.1603 1728.717,-9749.0235 1771.131,-9876.4395 1729.5092,-9919.4311 1764.717,-10049.0235 1813.6566,-10229.1597 1888.1728,-10252.7134 1932.5662,-10434.0235 1987.6612,-10659.041 1919.4972,-10727.6155 1968.5662,-10954.0235 2014.8969,-11167.797 2097.6613,-11200.6024 2140.8962,-11415.0235 2219.5836,-11805.2689 2125.9753,-11915.1942 2176.8962,-12310.0235 2193.2378,-12436.7318 2232.8545,-12585.3702 2247.8906,-12639.2244"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="2244.5543,-12640.2894 2250.6326,-12648.9672 2251.2925,-12638.3929 2244.5543,-12640.2894"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1253.3199,-4036.2417C1262.4506,-4113.401 1315.8611,-4573.6403 1336.1997,-4950.0235 1348.7678,-5182.6074 1330.8984,-6816.7912 1372.1997,-7046.0235 1409.7243,-7254.294 1491.6804,-7287.0274 1530.6973,-7495.0235 1577.5092,-7744.5747 1544.3577,-8384.1043 1566.6973,-8637.0235 1610.6402,-9134.5272 1672.8565,-9252.7167 1728.717,-9749.0235 1751.2568,-9949.2841 1724.7025,-10003.511 1764.717,-10201.0235 1782.7133,-10289.8534 1822.2942,-10390.845 1839.9002,-10433.3981"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1836.6986,-10434.8142 1843.7826,-10442.6925 1843.1577,-10432.1161 1836.6986,-10434.8142"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1254.6782,-4036.0922C1266.0071,-4082.9357 1310.3725,-4269.6083 1336.1997,-4425.0235 1357.7803,-4554.8852 1336.9083,-4592.1996 1372.1997,-4719.0235 1388.8048,-4778.696 1422.4703,-4844.0113 1440.1007,-4876.0428"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1437.0956,-4877.8404 1445.0208,-4884.8719 1443.2103,-4874.4329 1437.0956,-4877.8404"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge363" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1312.1879,-4013.8741C1320.8617,-4010.4303 1329.2042,-4005.9229 1336.1997,-4000.0235 1363.8539,-3976.7021 1344.3393,-3950.0982 1372.1997,-3927.0235 1428.5035,-3880.3913 1468.0528,-3920.7111 1530.6973,-3883.0235 1550.6322,-3871.0304 1546.5241,-3856.6113 1566.6973,-3845.0235 1630.8322,-3808.1832 1659.1629,-3832.1774 1728.717,-3807.0235 1745.5393,-3800.9398 1748.0461,-3795.5105 1764.717,-3789.0235 1837.0257,-3760.8868 1874.977,-3793.0206 1932.5662,-3741.0235 1964.5421,-3712.1525 1934.0881,-3676.855 1968.5662,-3651.0235 2097.5797,-3554.3646 2181.7437,-3569.4521 2330.7283,-3631.0235 2444.7655,-3678.152 2454.849,-3727.184 2527.3586,-3827.0235 2548.1493,-3855.6505 2535.3987,-3876.3441 2563.3586,-3898.0235 2594.2766,-3921.9965 2610.1916,-3916.471 2649.3109,-3917.0235"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge222" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1848.6416,-3803.0235C1880.0951,-3780.3138 1902.2785,-3803.2662 1932.5662,-3779.0235 1958.6522,-3758.1438 1941.8203,-3733.0511 1968.5662,-3713.0235 2033.1227,-3664.683 2127.6475,-3652.4843 2189.9342,-3650.1735"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2190.1342,-3653.6692 2200.0263,-3649.875 2189.9272,-3646.6723 2190.1342,-3653.6692"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1292.052,-4013.9064C1306.0983,-4009.8043 1321.9268,-4004.9495 1336.1997,-4000.0235 1513.4986,-3938.8325 1557.4469,-3921.4812 1728.717,-3845.0235 1745.0518,-3837.7314 1748.0461,-3833.5105 1764.717,-3827.0235 1800.8713,-3812.9551 1815.9681,-3823.9399 1848.6416,-3803.0235"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge465" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M1649.1758,-8382.9177C1658.6008,-8311.057 1710.7611,-7904.3462 1728.717,-7571.0235 1740.0197,-7361.2071 1724.861,-3995.3295 1764.717,-3789.0235 1779.1673,-3714.2247 1818.4439,-3631.9415 1837.7007,-3594.5474"/>
<polygon fill="#ff6600" stroke="#ff6600" points="1841.0376,-3595.7185 1842.564,-3585.2342 1834.8326,-3592.4783 1841.0376,-3595.7185"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge505" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1707.2926,-8402.7857C1715.6334,-8406.5175 1723.2197,-8411.7396 1728.717,-8419.0235 1784.5537,-8493.0058 1741.2255,-9997.3616 1764.717,-10087.0235 1804.8233,-10240.0998 1892.1411,-10248.0311 1932.5662,-10401.0235 1972.261,-10551.2525 1895.931,-11661.6606 1968.5662,-11799.0235 2012.6741,-11882.4377 2097.4929,-11839.2405 2140.8962,-11923.0235 2244.3972,-12122.8148 2079.6922,-15770.094 2176.8962,-15973.0235 2186.5481,-15993.1734 2206.1031,-16009.0529 2223.0793,-16019.829"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2221.2836,-16022.8333 2231.6556,-16024.9947 2224.8953,-16016.8369 2221.2836,-16022.8333"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge522" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M1707.2895,-8402.7881C1715.6307,-8406.5196 1723.2178,-8411.741 1728.717,-8419.0235 1783.3004,-8491.3074 1707.4027,-9978.8853 1764.717,-10049.0235 1813.1157,-10108.2511 1883.9293,-10027.9914 1932.5662,-10087.0235 1974.7654,-10138.242 1957.1548,-11215.6485 1968.5662,-11281.0235 2011.0127,-11524.1962 2099.3916,-11565.6883 2140.8962,-11809.0235 2170.9257,-11985.0812 2113.4091,-13249.088 2176.8962,-13416.0235 2214.4245,-13514.7016 2289.1083,-13500.0003 2330.7283,-13597.0235 2374.6761,-13699.4733 2435.3046,-14525.5481 2445.5463,-14668.868"/>
<polygon fill="#65ff00" stroke="#65ff00" points="2442.0649,-14669.2555 2446.2661,-14678.9817 2449.0472,-14668.7584 2442.0649,-14669.2555"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge551" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1848.6416,-9845.0235C1860.5547,-9889.8416 1909.8759,-9866.5793 1932.5662,-9907.0235 2021.6343,-10065.7832 1878.5043,-10156.8254 1968.5662,-10315.0235 2015.2491,-10397.0244 2092.5328,-10358.0024 2140.8962,-10439.0235 2204.5278,-10545.6226 2148.5521,-10595.156 2176.8962,-10716.0235 2224.8651,-10920.5763 2289.8551,-10956.9355 2330.7283,-11163.0235 2356.6272,-11293.6095 2305.364,-11642.88 2366.7283,-11761.0235 2377.3656,-11781.5034 2397.7785,-11797.6348 2415.3621,-11808.5794"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2413.8435,-11811.7476 2424.2326,-11813.8255 2417.4069,-11805.7224 2413.8435,-11811.7476"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge604" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1848.6416,-8855.0235C1972.7419,-8941.1221 2027.1728,-8786.9417 2176.8962,-8767.0235 2259.7519,-8756.001 2868.6959,-8708.318 2929.166,-8766.0235 2960.1073,-8795.5502 2958.4598,-9492.7835 2965.166,-9535.0235 2988.5457,-9682.2843 3066.1948,-10054.173 3142.9189,-10182.0235 3195.1514,-10269.0619 3267.7933,-10246.1642 3308.7942,-10339.0235 3371.0489,-10480.0187 3413.3411,-15697.7775 3416.2949,-16071.8916"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="3412.7953,-16071.9764 3416.374,-16081.9485 3419.7951,-16071.9213 3412.7953,-16071.9764"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1707.2918,-8403.2828C1715.5241,-8406.9625 1723.0763,-8412.0383 1728.717,-8419.0235 1786.4566,-8490.5257 1706.2372,-8760.1255 1764.717,-8831.0235 1789.4028,-8860.9512 1817.9203,-8831.3328 1848.6416,-8855.0235"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge731" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1848.6416,-9921.0235C1851.5965,-9939.6988 1920.134,-9920.7778 1932.5662,-9935.0235 1977.0779,-9986.0282 1948.9585,-11088.2291 1968.5662,-11153.0235 2010.4525,-11291.439 2099.4076,-11290.4883 2140.8962,-11429.0235 2189.1077,-11590.0069 2140.5665,-12776.9499 2176.8962,-12941.0235 2213.8062,-13107.7177 2274.1924,-13131.9242 2330.7283,-13293.0235 2384.9563,-13447.5465 2428.7582,-13640.5709 2442.5243,-13703.8627"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2439.1433,-13704.7874 2444.6749,-13713.8236 2445.9856,-13703.3101 2439.1433,-13704.7874"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge786" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1848.6416,-8855.0235C2000.9113,-8999.9765 2592.0873,-9031.0817 2735.2632,-9185.0235 2859.4925,-9318.5941 2792.2506,-9406.0663 2850.2146,-9579.0235"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1649.1681,-8382.9173C1658.545,-8311.0539 1710.4573,-7904.3297 1728.717,-7571.0235 1767.3025,-6866.7009 1688.1925,-5098.239 1764.717,-4397.0235 1804.2717,-4034.5732 1875.8318,-3954.1846 1932.5662,-3594.0235 1944.2856,-3519.6259 1930.7036,-3322.1294 1968.5662,-3257.0235 2016.0021,-3175.4559 2094.3159,-3215.0827 2140.8962,-3133.0235 2187.1397,-3051.5578 2113.8616,-2782.3181 2176.8962,-2713.0235 2200.2773,-2687.3205 2238.4725,-2730.2007 2253.8123,-2699.0235"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge412" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1649.4146,-8382.7718C1659.4029,-8316.3665 1710.45,-7968.8046 1728.717,-7683.0235 1764.6129,-7121.446 1689.4287,-5708.6878 1764.717,-5151.0235 1853.6784,-4492.0832 2039.159,-4360.1126 2140.8962,-3703.0235 2152.439,-3628.4723 2124.2452,-3079.0511 2176.8962,-3025.0235 2281.3701,-2917.8182 2700.6309,-2999.3235 2850.2146,-3005.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M2850.2146,-3005.0235C3017.1583,-3003.3617 3066.6726,-2954.6902 3225.8566,-3005.0235"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1707.3013,-8402.7791C1715.6411,-8406.5117 1723.2247,-8411.7358 1728.717,-8419.0235 1788.3136,-8498.101 1747.9404,-10103.4349 1764.717,-10201.0235 1780.0729,-10290.3477 1821.0535,-10391.0772 1839.4629,-10433.48"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1836.3038,-10434.9911 1843.5293,-10442.7399 1842.7131,-10432.1766 1836.3038,-10434.9911"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1707.3298,-8384.7949C1715.5575,-8381.1114 1723.0982,-8376.0264 1728.717,-8369.0235 1790.6674,-8291.8143 1734.2256,-8019.2009 1764.717,-7925.0235 1818.5188,-7758.8486 1877.0105,-7737.7726 1968.5662,-7589.0235 2044.3689,-7465.8681 2092.7249,-7449.3791 2140.8962,-7313.0235 2185.0406,-7188.067 2098.4749,-7123.8549 2176.8962,-7017.0235 2231.7063,-6942.3572 2278.2132,-6958.3051 2366.7283,-6931.0235 2401.3548,-6920.3511 2416.3015,-6936.2024 2447.0435,-6917.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-6917.0235C2484.635,-6892.1164 2501.1951,-6891.7517 2527.3586,-6855.0235 2556.47,-6814.1572 2525.4766,-6780.9246 2563.3586,-6748.0235 2566.8038,-6745.0314 2570.625,-6742.5214 2574.6866,-6740.4215"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2576.1079,-6743.6202 2583.9093,-6736.4516 2573.3403,-6737.1906 2576.1079,-6743.6202"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge280" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1650.831,-8382.972C1663.2445,-8338.528 1709.3459,-8168.3422 1728.717,-8025.0235 1749.1046,-7874.1847 1722.4562,-7487.2494 1764.717,-7341.0235 1807.137,-7194.2467 1889.8162,-7187.7045 1932.5662,-7041.0235 2011.0399,-6771.7692 1922.6355,-6687.6937 1968.5662,-6411.0235 2015.2647,-6129.7279 2097.7701,-6074.8889 2140.8962,-5793.0235 2150.4377,-5730.662 2131.5852,-4701.9201 2176.8962,-4658.0235 2226.0013,-4610.4513 2267.0093,-4633.2379 2330.7283,-4658.0235 2350.9569,-4665.8921 2346.701,-4682.6557 2366.7283,-4691.0235 2565.2445,-4773.9675 2636.0063,-4694.9433 2850.2146,-4715.0235"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge309" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1707.0774,-8384.588C1715.3366,-8380.9303 1722.9532,-8375.9075 1728.717,-8369.0235 1812.6614,-8268.7658 1699.0895,-8190.1221 1764.717,-8077.0235 1932.3735,-7788.0945 2068.3185,-7777.1577 2366.7283,-7627.0235 2400.0089,-7610.2796 2412.7297,-7617.5328 2447.0435,-7603.0235"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge316" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1707.1694,-8403.3826C1715.417,-8407.0499 1723.006,-8412.0956 1728.717,-8419.0235 1823.6876,-8534.2292 1669.1822,-8638.2853 1764.717,-8753.0235 1768.1552,-8757.1528 1772.2437,-8760.6184 1776.7375,-8763.5249"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1775.3559,-8766.7574 1785.8142,-8768.4527 1778.6957,-8760.6055 1775.3559,-8766.7574"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge365" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1652.5804,-8382.7082C1667.4072,-8347.6426 1711.9782,-8237.3552 1728.717,-8141.0235 1808.808,-7680.1009 1681.9542,-7549.4739 1764.717,-7089.0235 1806.4843,-6856.6518 1889.9016,-6817.2321 1932.5662,-6585.0235 2001.5372,-6209.6382 1888.1239,-6100.1189 1968.5662,-5727.0235 2011.7861,-5526.5672 2097.5137,-5499.4447 2140.8962,-5299.0235 2160.3309,-5209.2379 2132.1385,-4553.2476 2176.8962,-4473.0235 2222.7631,-4390.8113 2454.5844,-4294.7439 2527.3586,-4235.0235 2653.5263,-4131.4871 2787.2246,-3986.9301 2833.3971,-3935.8251"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2836.1884,-3937.9557 2840.2782,-3928.1821 2830.9861,-3933.272 2836.1884,-3937.9557"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge380" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1848.6416,-8931.0235C1907.2925,-9036.6698 1912.6999,-9067.8786 1968.5662,-9175.0235 2122.5408,-9470.3283 2228.1376,-9514.1825 2330.7283,-9831.0235 2371.2803,-9956.2645 2315.8495,-10003.6105 2366.7283,-10125.0235 2380.5786,-10158.0747 2408.478,-10189.2559 2427.4618,-10207.9996"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2425.1104,-10210.5943 2434.7407,-10215.0111 2429.9667,-10205.5528 2425.1104,-10210.5943"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge252" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1707.1181,-8385.1277C1715.4799,-8381.412 1723.1183,-8376.2298 1728.717,-8369.0235 1778.2681,-8305.2442 1742.2997,-7720.6159 1764.717,-7643.0235 1806.9086,-7496.9875 1887.4794,-7490.1917 1932.5662,-7345.0235 1985.7719,-7173.7141 1911.5031,-7113.087 1968.5662,-6943.0235 2014.5694,-6805.9213 2097.2057,-6804.8801 2140.8962,-6667.0235 2162.6152,-6598.4937 2129.3204,-6074.9177 2176.8962,-6021.0235 2199.8913,-5994.9745 2228.8215,-6031.1645 2253.8123,-6007.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-6007.0235C2262.0163,-5999.0602 2640.5306,-5900.3466 2649.3109,-5893.0235"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge264" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1652.5627,-8382.7051C1667.3385,-8347.6306 1711.7782,-8237.3202 1728.717,-8141.0235 1764.8551,-7935.5798 1714.7972,-7405.5602 1764.717,-7203.0235 1806.1945,-7034.7393 1890.6249,-7019.1928 1932.5662,-6851.0235 2020.8419,-6497.0699 1900.8651,-6389.4818 1968.5662,-6031.0235 2012.5005,-5798.4037 2097.7858,-5759.7974 2140.8962,-5527.0235 2150.7974,-5473.5625 2140.4066,-4589.3301 2176.8962,-4549.0235 2229.6525,-4490.7489 2449.7357,-4513.4267 2527.3586,-4501.0235 2620.1148,-4486.2023 2647.5869,-4496.7316 2735.2632,-4463.0235 2791.3126,-4441.4747 2806.4402,-4433.1293 2850.2146,-4392.0235"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge339" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1649.0831,-8382.8494C1657.729,-8312.237 1704.9543,-7920.6098 1728.717,-7600.0235 1754.2714,-7255.2655 1735.7031,-7167.5076 1764.717,-6823.0235 1827.324,-6079.6887 1853.9214,-5894.1279 1968.5662,-5157.0235 1978.1418,-5095.4571 2137.312,-4103.1401 2176.8962,-4055.0235 2279.75,-3929.9996 2480.3688,-3893.2427 2583.9468,-3882.4684"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2584.3579,-3885.9449 2593.9642,-3881.4762 2583.6679,-3878.979 2584.3579,-3885.9449"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge589" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1707.2673,-8402.8048C1715.6112,-8406.5343 1723.205,-8411.7507 1728.717,-8419.0235 1823.0429,-8543.4796 1667.0571,-9702.1662 1764.717,-9824.0235 1788.7626,-9854.0268 1838.5186,-9807.9302 1848.6416,-9845.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3036.0425,-10854.0235C3120.1441,-10796.2004 3200.9859,-10467.0587 3221.0963,-10380.095"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3224.5649,-10380.6275 3223.3859,-10370.0985 3217.7416,-10379.0647 3224.5649,-10380.6275"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1848.6416,-9845.0235C1858.8555,-9882.4498 1907.2076,-9839.6638 1932.5662,-9869.0235 2011.699,-9960.6422 1916.6698,-10029.6491 1968.5662,-10139.0235 1971.1541,-10144.4777 2558.042,-10770.1637 2563.3586,-10773.0235 2657.2142,-10823.5082 2948.2243,-10914.4019 3036.0425,-10854.0235"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge562" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1707.3648,-8402.7315C1715.6969,-8406.4698 1723.2616,-8411.7082 1728.717,-8419.0235 1758.3108,-8458.7061 1763.5357,-11933.5351 1764.717,-11983.0235 1786.5571,-12897.9203 1839.5921,-14023.1536 1847.6171,-14190.7509"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1844.1227,-14190.9519 1848.0981,-14200.7726 1851.1146,-14190.6163 1844.1227,-14190.9519"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge634" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2054.7312,-9161.0235C2110.9426,-9186.1318 2280.0828,-9150.021 2330.7283,-9185.0235 2428.898,-9252.8714 2329.5851,-9405.9481 2447.0435,-9427.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-9427.0235C2510.8862,-9436.6478 2580.4674,-9467.3202 2619.1078,-9486.3288"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2617.7324,-9489.5541 2628.2427,-9490.8903 2620.8597,-9483.2915 2617.7324,-9489.5541"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1707.3364,-8403.2469C1715.5632,-8406.9311 1723.1019,-8412.0176 1728.717,-8419.0235 1791.4571,-8497.303 1715.9905,-8781.3324 1764.717,-8869.0235 1787.2417,-8909.5602 1827.417,-8889.7912 1848.6416,-8931.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1848.6416,-8931.0235C1897.1282,-9025.2166 1884.7203,-9072.2689 1968.5662,-9137.0235 2000.0288,-9161.3223 2019.6086,-9142.4028 2054.7312,-9161.0235"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge649" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2054.7312,-9161.0235C2089.0095,-9179.1966 2103.0001,-9166.7079 2140.8962,-9175.0235 2157.1161,-9178.5827 2160.7108,-9181.3106 2176.8962,-9185.0235 2193.8297,-9188.908 2244.3381,-9184.4608 2253.8123,-9199.0235"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge752" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1707.2712,-8402.8019C1715.6146,-8406.5317 1723.2072,-8411.749 1728.717,-8419.0235 1777.0342,-8482.8158 1727.7801,-9788.0329 1764.717,-9859.0235 1786.122,-9900.1625 1841.4289,-9875.2135 1848.6416,-9921.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1848.6416,-9921.0235C1851.5824,-9939.701 1920.0087,-9920.8882 1932.5662,-9935.0235 1988.8602,-9998.3909 1933.0971,-10620.0404 1968.5662,-10697.0235 2012.5545,-10792.4972 2096.9822,-10763.5156 2140.8962,-10859.0235 2177.5109,-10938.656 2167.364,-11559.8965 2176.8962,-11647.0235 2220.2681,-12043.4513 2267.707,-12137.2413 2330.7283,-12531.0235 2379.8823,-12838.1577 2431.5436,-13213.3435 2444.148,-13305.725"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2440.7004,-13306.3471 2445.5183,-13315.783 2447.6363,-13305.4021 2440.7004,-13306.3471"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge869" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#00ddff" stroke-dasharray="5,2" d="M1501.5833,-12693.1712C1512.8265,-12696.3447 1523.5323,-12701.8103 1530.6973,-12711.0235 1560.7796,-12749.7056 1564.7468,-16190.0598 1566.6973,-16239.0235 1585.1482,-16702.206 1635.259,-17267.301 1645.7608,-17382.8137"/>
<polygon fill="#00ddff" stroke="#00ddff" points="1642.2811,-17383.1969 1646.6755,-17392.8374 1649.2521,-17382.5607 1642.2811,-17383.1969"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge496" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1501.8856,-12694.3093C1512.709,-12697.5023 1523.1464,-12702.6916 1530.6973,-12711.0235 1597.8197,-12785.0889 1508.4742,-12851.7758 1566.6973,-12933.0235 1614.1843,-12999.2895 1679.8259,-12953.7865 1728.717,-13019.0235 1997.6043,-13377.8083 1874.4797,-13562.4419 1932.5662,-14007.0235 1969.3601,-14288.6366 1938.5216,-14362.6106 1968.5662,-14645.0235 1972.5163,-14682.154 2158.3405,-15940.6204 2176.8962,-15973.0235 2188.0419,-15992.4867 2207.6887,-16008.4225 2224.3355,-16019.3975"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2222.8738,-16022.6129 2233.202,-16024.9752 2226.6012,-16016.6878 2222.8738,-16022.6129"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge552" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1647.7072,-12463.0235C1672.4011,-12434.7339 1695.315,-12456.1815 1728.717,-12439.0235 1746.7471,-12429.7618 1746.7386,-12420.3851 1764.717,-12411.0235 1919.8987,-12330.2189 2015.444,-12416.9762 2140.8962,-12295.0235 2176.5717,-12260.3433 2151.168,-12231.6089 2176.8962,-12189.0235 2228.2399,-12104.0397 2271.3537,-12106.6042 2330.7283,-12027.0235 2376.9588,-11965.0599 2418.9646,-11883.0861 2437.3061,-11845.4736"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2440.6383,-11846.6218 2441.8356,-11836.0948 2434.3349,-11843.5775 2440.6383,-11846.6218"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge732" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1501.6715,-12695.0293C1512.3736,-12698.2072 1522.8111,-12703.2092 1530.6973,-12711.0235 1573.5878,-12753.5232 1529.5046,-12794.4575 1566.6973,-12842.0235 1617.5699,-12907.085 1659.8702,-12887.404 1728.717,-12933.0235 1776.9922,-12965.0117 2098.6989,-13212.3609 2140.8962,-13252.0235 2158.5659,-13268.6317 2155.7936,-13281.0766 2176.8962,-13293.0235 2192.0148,-13301.5826 2248.7186,-13290.4137 2253.8123,-13307.0235"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge787" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1501.5527,-12690.2454C1639.5118,-12690.8439 2036.6065,-12692.4825 2366.7283,-12693.0235 2438.1195,-12693.1405 2456.0839,-12697.1013 2527.3586,-12693.0235 2581.8266,-12689.9073 2594.7599,-12679.8324 2649.3109,-12679.0235"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1451.9391,-12678.8226C1457.5082,-12551.1879 1509.0182,-11357.8333 1530.6973,-10392.0235 1539.3175,-10007.9883 1525.7312,-7316.9648 1566.6973,-6935.0235 1604.7355,-6580.3798 1690.1551,-6503.6106 1728.717,-6149.0235 1744.8936,-6000.2761 1714.1146,-3596.8315 1764.717,-3456.0235 1805.0085,-3343.9073 1882.1434,-3354.9633 1932.5662,-3247.0235 1967.0956,-3173.1065 1926.7769,-3137.0924 1968.5662,-3067.0235 2019.5458,-2981.5449 2090.7812,-3010.0119 2140.8962,-2924.0235 2186.5945,-2845.6136 2116.8642,-2791.0867 2176.8962,-2723.0235 2200.5839,-2696.1669 2238.0353,-2731.1712 2253.8123,-2699.0235"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge414" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1458.018,-12678.9101C1473.7353,-12651.7081 1513.4766,-12579.1658 1530.6973,-12513.0235 1553.5187,-12425.3695 1509.3496,-12177.1327 1566.6973,-12107.0235 1614.2478,-12048.8916 1683.4895,-12118.9806 1728.717,-12059.0235 1790.4131,-11977.2344 1698.2529,-8448.9875 1764.717,-8371.0235 1813.7614,-8313.4934 3037.6097,-8177.2112 3106.9189,-8147.0235 3125.5025,-8138.9294 3124.8596,-8128.228 3142.9189,-8119.0235 3177.1078,-8101.5981 3203.1721,-8125.9741 3225.8566,-8095.0235"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M1501.552,-12683.1709C1521.7471,-12680.7229 1545.289,-12678.2645 1566.6973,-12677.0235 1630.3906,-12673.3313 2077.2424,-12679.3443 2140.8962,-12675.0235 2160.2073,-12673.7127 2181.2573,-12671.2116 2199.8938,-12668.622"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="2200.5688,-12672.0612 2209.9728,-12667.1812 2199.5781,-12665.1316 2200.5688,-12672.0612"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M1451.9052,-12678.8217C1457.0946,-12551.1778 1505.2367,-11357.7411 1530.6973,-10392.0235 1532.1419,-10337.2279 1533.7491,-8462.8307 1566.6973,-8419.0235 1570.1255,-8414.4653 1574.3721,-8410.7143 1579.1106,-8407.6305"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1580.9687,-8410.6047 1588.1007,-8402.7699 1577.6395,-8404.447 1580.9687,-8410.6047"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge366" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1451.9069,-12678.8218C1457.116,-12551.1784 1505.4331,-11357.7462 1530.6973,-10392.0235 1542.4268,-9943.6611 1513.6469,-8819.3909 1566.6973,-8374.0235 1605.8524,-8045.3095 1686.9256,-7975.4128 1728.717,-7647.0235 1788.3382,-7178.5309 1696.9231,-7052.4034 1764.717,-6585.0235 1807.3,-6291.4514 1886.7118,-6232.1025 1932.5662,-5939.0235 1976.6042,-5657.5536 1910.4176,-5577.9202 1968.5662,-5299.0235 2013.5516,-5083.2606 2093.9651,-5049.3716 2140.8962,-4834.0235 2163.8617,-4728.6443 2119.3588,-4441.2465 2176.8962,-4350.0235 2218.9165,-4283.4022 2265.0881,-4305.5606 2330.7283,-4262.0235 2333.5908,-4260.1249 2525.1685,-4114.6696 2527.3586,-4112.0235 2592.5343,-4033.2771 2547.0917,-3917.3123 2649.3109,-3917.0235"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge371" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1501.7855,-12682.8503C1512.6124,-12679.1232 1523.0766,-12673.4983 1530.6973,-12665.0235 1584.6655,-12605.0069 1512.2042,-12546.564 1566.6973,-12487.0235 1592.0499,-12459.3226 1620.9744,-12489.395 1647.7072,-12463.0235"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1647.7072,-12463.0235C1674.4399,-12436.6521 1699.938,-12463.1453 1728.717,-12439.0235 1756.1364,-12416.0414 1742.9251,-12395.398 1764.717,-12367.0235 1900.7212,-12189.9371 2045.0311,-12235.6832 2140.8962,-12034.0235 2224.0678,-11859.0657 2101.3819,-11341.4201 2176.8962,-11163.0235 2215.6003,-11071.5882 2287.1605,-11090.2439 2330.7283,-11001.0235 2347.8799,-10965.8995 2427.9887,-10369.1639 2444.1844,-10247.554"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2447.6987,-10247.6775 2445.5479,-10237.3033 2440.7598,-10246.7544 2447.6987,-10247.6775"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1451.9158,-12678.822C1457.2239,-12551.1811 1506.4193,-11357.7715 1530.6973,-10392.0235 1543.4263,-9885.6759 1524.1558,-8617.7414 1566.6973,-8113.0235 1606.5409,-7640.3137 1688.1454,-7530.6714 1728.717,-7058.0235 1764.9669,-6635.7232 1702.1647,-5570.2356 1764.717,-5151.0235 1858.5856,-4521.9368 2184.5834,-3799.9289 2244.3589,-3671.1771"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2247.5674,-3672.5781 2248.6197,-3662.0357 2241.2227,-3669.6209 2247.5674,-3672.5781"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge591" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3036.0425,-13193.0235C3048.7446,-13132.7891 3090.1282,-13133.2485 3106.9189,-13074.0235 3178.0564,-12823.1042 3112.0844,-10986.0028 3142.9189,-10727.0235 3158.8885,-10592.8949 3202.9602,-10436.0247 3219.4866,-10380.1192"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3222.9047,-10380.9042 3222.4081,-10370.321 3216.1966,-10378.904 3222.9047,-10380.9042"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1494.2875,-12701.1192C1506.1045,-12704.2496 1518.9143,-12707.7075 1530.6973,-12711.0235 1975.6244,-12836.2352 2088.4984,-12862.9724 2527.3586,-13008.0235 2528.2509,-13008.3184 3035.8486,-13193.943 3036.0425,-13193.0235"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge635" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-12127.0235C2508.4413,-12012.076 2508.2843,-11973.9374 2527.3586,-11845.0235 2563.2074,-11602.7397 2494.4802,-9876.0604 2563.3586,-9641.0235 2577.2662,-9593.5662 2612.0793,-9546.2974 2632.8842,-9520.9594"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2635.6133,-9523.1518 2639.3522,-9513.2386 2630.2474,-9518.6565 2635.6133,-9523.1518"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1501.7878,-12681.7734C1512.3594,-12678.0833 1522.711,-12672.745 1530.6973,-12665.0235 1565.2589,-12631.6078 1533.0804,-12597.3894 1566.6973,-12563.0235 1662.0837,-12465.5119 2023.6739,-12415.7804 2140.8962,-12346.0235 2254.8542,-12278.2092 2250.4368,-12214.7534 2366.7283,-12151.0235 2399.3992,-12133.1192 2429.491,-12159.8848 2447.0435,-12127.0235"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge742" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1501.8026,-12696.6382C1512.1332,-12699.7598 1522.3793,-12704.3327 1530.6973,-12711.0235 1557.957,-12732.9509 1542.2739,-12755.9755 1566.6973,-12781.0235 1696.0719,-12913.7071 1804.6744,-12846.91 1932.5662,-12981.0235 1957.8068,-13007.4921 1942.8352,-13029.0313 1968.5662,-13055.0235 2028.7871,-13115.8559 2068.7343,-13094.9823 2140.8962,-13141.0235 2194.9981,-13175.5419 2195.741,-13203.7059 2253.8123,-13231.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-13231.0235C2284.9583,-13246.4263 2298.6848,-13231.5869 2330.7283,-13245.0235 2368.3077,-13260.7815 2405.7441,-13290.2706 2427.6238,-13309.2574"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2425.4055,-13311.9679 2435.2156,-13315.9696 2430.0421,-13306.7237 2425.4055,-13311.9679"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M1252.7409,-5707.2978C1259.6094,-5809.8871 1311.4113,-6592.5394 1336.1997,-7228.0235 1342.9619,-7401.3822 1339.4985,-8618.6427 1372.1997,-8789.0235 1386.3393,-8862.6941 1423.1877,-8944.4218 1441.2154,-8981.6047"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="1438.2152,-8983.4356 1445.7665,-8990.8672 1444.4978,-8980.3486 1438.2152,-8983.4356"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge250" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1317.4698,-5684.9742C1444.906,-5663.1804 1715.0366,-5615.4325 1728.717,-5600.0235 1795.1738,-5525.1697 1709.55,-5234.5472 1764.717,-5151.0235 1821.1099,-5065.6439 1869.2179,-5068.513 1968.5662,-5044.0235 2042.9313,-5025.6924 2065.5821,-5030.0955 2140.8962,-5044.0235 2321.755,-5077.4701 2358.5426,-5119.0186 2527.3586,-5192.0235 2582.6232,-5215.9228 2595.0713,-5277.1658 2649.3109,-5251.0235"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1860.6126,-10465.06C1894.832,-10496.6077 1993.2993,-10587.3876 2035.3351,-10626.1417"/>
<polygon fill="#002eff" stroke="#002eff" points="2033.0025,-10628.7516 2042.7271,-10632.9566 2037.7472,-10623.605 2033.0025,-10628.7516"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge538" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1466.2005,-4907.1598C1482.9298,-4920.1987 1510.5006,-4942.9602 1530.6973,-4966.0235 1634.7294,-5084.8216 1682.1175,-5110.1456 1728.717,-5261.0235 1765.8272,-5381.1771 1687.2204,-9688.9865 1764.717,-9788.0235 1812.1741,-9848.6714 1882.5948,-9772.43 1932.5662,-9831.0235 1988.9001,-9897.0775 1920.366,-10147.8197 1968.5662,-10220.0235 2016.6553,-10292.0609 2081.0038,-10248.4548 2140.8962,-10311.0235 2157.94,-10328.8289 2324.912,-10688.0716 2330.7283,-10712.0235 2358.2487,-10825.3541 2314.3127,-11656.8419 2366.7283,-11761.0235 2377.1003,-11781.6391 2397.5162,-11797.7689 2415.1676,-11808.6789"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2413.6817,-11811.8649 2424.0784,-11813.9044 2417.2227,-11805.8266 2413.6817,-11811.8649"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge692" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M1647.7072,-4857.0235C1782.4629,-4890.2773 1849.8364,-4873.5753 1932.5662,-4985.0235 1986.3993,-5057.544 1924.2353,-5106.3342 1968.5662,-5185.0235 2018.6936,-5274.0021 2096.8108,-5244.9017 2140.8962,-5337.0235 2218.1947,-5498.5481 2099.1409,-5980.7184 2176.8962,-6142.0235 2201.6354,-6193.3453 2520.3002,-6441.715 2563.3586,-6479.0235 2639.5523,-6545.0425 2687.5659,-6538.2037 2735.2632,-6627.0235 2795.6666,-6739.5041 2746.9894,-6786.6791 2771.2632,-6912.0235 2823.771,-7183.1625 2888.7524,-7239.82 2929.166,-7513.0235 2992.815,-7943.3024 2947.77,-8056.4105 2965.166,-8491.0235 2991.7014,-9153.9715 3028.6326,-9967.5529 3035.0676,-10108.6797"/>
<polygon fill="#00cbff" stroke="#00cbff" points="3031.5849,-10109.1393 3035.5371,-10118.9693 3038.5776,-10108.8201 3031.5849,-10109.1393"/>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M1475.3655,-4884.926C1512.3764,-4869.1836 1585.728,-4843.6833 1647.7072,-4857.0235"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge718" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1471.7324,-4907.124C1490.9296,-4918.9042 1518.5611,-4939.4783 1530.6973,-4966.0235 1611.1113,-5141.9122 1498.8917,-8265.9002 1566.6973,-8447.0235 1605.6061,-8550.9573 1688.9062,-8533.4319 1728.717,-8637.0235 1780.4734,-8771.6984 1687.7713,-9812.9768 1764.717,-9935.0235 1809.4205,-10005.9294 1887.852,-9950.1244 1932.5662,-10021.0235 2008.7008,-10141.7434 1908.0314,-11175.7745 1968.5662,-11305.0235 2011.8826,-11397.5094 2097.9697,-11364.356 2140.8962,-11457.0235 2183.7775,-11549.5935 2110.7703,-13215.336 2176.8962,-13293.0235 2199.4179,-13319.4829 2243.6308,-13273.8021 2253.8123,-13307.0235"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2253.8123,-13307.0235C2263.9497,-13340.2584 2304.9582,-13297.7163 2330.7283,-13321.0235 2389.5544,-13374.2276 2432.3335,-13628.292 2443.9118,-13703.8087"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2440.493,-13704.61 2445.4462,-13713.9757 2447.4146,-13703.5653 2440.493,-13704.61"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge770" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1500.9013,-4900.1118C1564.6346,-4908.2374 1673.7604,-4932.4037 1728.717,-5004.0235 1817.7258,-5120.0201 1681.7407,-5210.6379 1764.717,-5331.0235 1812.2865,-5400.0393 1885.4878,-5347.6718 1932.5662,-5417.0235 1979.7098,-5486.4714 1945.7438,-5712.2481 1968.5662,-5793.0235 2015.9269,-5960.6482 2095.3414,-5976.8991 2140.8962,-6145.0235 2197.5412,-6354.077 2108.9582,-6425.3626 2176.8962,-6631.0235 2226.3884,-6780.8453 2260.4782,-6814.3746 2366.7283,-6931.0235 2427.4599,-6997.699 2483.7302,-6976.0899 2527.3586,-7055.0235 2567.5353,-7127.712 2549.6696,-7345.1065 2563.3586,-7427.0235 2617.5131,-7751.0919 2687.759,-7820.9137 2735.2632,-8146.0235 2756.1151,-8288.7302 2720.3638,-8659.0819 2771.2632,-8794.0235 2811.3562,-8900.316 2891.0076,-8888.0213 2929.166,-8995.0235 2964.1241,-9093.0515 2960.2391,-10764.0654 2965.166,-10868.0235 2982.5673,-11235.1888 3024.2418,-11681.8861 3033.9819,-11783.6917"/>
<polygon fill="#ff0066" stroke="#ff0066" points="3030.5224,-11784.2817 3034.9625,-11793.9013 3037.4903,-11783.6124 3030.5224,-11784.2817"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-5275.0235C1681.4674,-5402.3067 1710.0181,-5429.6736 1728.717,-5560.0235 1799.5451,-6053.763 1711.8574,-9553.0385 1764.717,-10049.0235 1780.6206,-10198.2479 1826.4908,-10373.746 1842.8003,-10433.1659"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1839.4474,-10434.1733 1845.4877,-10442.8776 1846.1939,-10432.3063 1839.4474,-10434.1733"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-4857.0235C1684.3057,-4865.4282 1701.5708,-4855.0779 1728.717,-4881.0235 1764.077,-4914.8195 1738.6485,-4943.636 1764.717,-4985.0235 1820.635,-5073.801 1883.0898,-5058.5013 1932.5662,-5151.0235 1972.272,-5225.2746 1927.9224,-5263.2816 1968.5662,-5337.0235 2019.3076,-5429.0861 2096.9877,-5403.5131 2140.8962,-5499.0235 2214.3018,-5658.6962 2128.8356,-6119.9853 2176.8962,-6289.0235 2196.099,-6356.5634 2213.4556,-6369.5629 2253.8123,-6427.0235"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge295" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1647.7072,-4781.0235C1672.5382,-4769.0239 2042.608,-4801.9676 2140.8962,-4929.0235 2204.8496,-5011.6952 2126.2133,-5777.613 2176.8962,-5869.0235 2268.1958,-6033.6893 2394.2078,-5973.9021 2527.3586,-6107.0235 2643.6344,-6223.2735 2676.6615,-6259.4007 2735.2632,-6413.0235 2778.5683,-6526.5468 2723.9265,-6572.1213 2771.2632,-6684.0235 2793.3246,-6736.1759 2822.1287,-6734.8527 2850.2146,-6784.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2850.2146,-6784.0235C2876.9495,-6833.9417 2898.3967,-6836.4858 2929.166,-6884.0235 2970.8299,-6948.3931 3009.8285,-7030.8527 3026.9378,-7068.5567"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3023.8707,-7070.2701 3031.1671,-7077.9521 3030.2538,-7067.3967 3023.8707,-7070.2701"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1470.8108,-4907.1762C1489.5851,-4919.1318 1517.1565,-4939.9596 1530.6973,-4966.0235 1597.2888,-5094.2022 1539.2399,-5147.2128 1566.6973,-5289.0235 1586.6273,-5391.9573 1624.8364,-5511.5982 1640.6185,-5559.0711"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1637.3851,-5560.4378 1643.8791,-5568.8091 1644.0229,-5558.2152 1637.3851,-5560.4378"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge237" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2649.3109,-5251.0235C2737.2807,-5211.9663 2823.29,-4897.4347 2844.9904,-4812.8843"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2848.3973,-4813.6882 2847.4681,-4803.1342 2841.6129,-4811.9642 2848.3973,-4813.6882"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-4781.0235C1683.2115,-4760.9987 1695.7963,-4762.0604 1728.717,-4738.0235 1830.9732,-4663.3617 1864.7396,-4645.9359 1932.5662,-4539.0235 1958.769,-4497.7209 1928.7221,-4463.395 1968.5662,-4435.0235 2030.9565,-4390.5977 2085.0339,-4382.625 2140.8962,-4435.0235 2232.1716,-4520.6391 2101.4249,-4897.1971 2176.8962,-4997.0235 2276.5378,-5128.82 2389.038,-5030.6568 2527.3586,-5121.0235 2593.6807,-5164.3526 2576.9052,-5283.1705 2649.3109,-5251.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1496.1677,-4884.9587C1507.7458,-4881.2827 1519.9668,-4876.6552 1530.6973,-4871.0235 1548.6454,-4861.6038 1550.6489,-4855.4055 1566.6973,-4843.0235 1602.594,-4815.3278 1606.8849,-4800.7508 1647.7072,-4781.0235"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge220" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1456.6939,-4884.9702C1508.9402,-4774.9014 1934.59,-3878.7819 1968.5662,-3827.0235 2000.7608,-3777.979 2006.9852,-3761.1143 2054.7312,-3727.0235"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge328" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1500.9981,-4888.0931C1511.8532,-4884.3932 1522.5275,-4878.9703 1530.6973,-4871.0235 1565.7591,-4836.9184 1534.8872,-4804.1801 1566.6973,-4767.0235 1619.7156,-4705.094 1677.8025,-4744.6938 1728.717,-4681.0235 1766.6945,-4633.5315 1739.4519,-4604.3358 1764.717,-4549.0235 1832.5369,-4400.5473 2044.385,-4036.3413 2176.8962,-3941.0235 2299.022,-3853.1762 2485.9662,-3858.3325 2584.0572,-3868.6978"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2583.806,-3872.1913 2594.1306,-3869.814 2584.5769,-3865.2339 2583.806,-3872.1913"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge479" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1468.1663,-4907.0507C1485.8728,-4919.4933 1513.5832,-4941.2553 1530.6973,-4966.0235 1530.6973,-4966.0235 1647.7072,-5275.0235 1647.7072,-5275.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1647.7072,-5275.0235C1681.4674,-5402.3067 1710.0044,-5429.6755 1728.717,-5560.0235 1745.987,-5680.3221 1700.9074,-9831.5908 1764.717,-9935.0235 1808.727,-10006.3619 1888.0519,-9949.9987 1932.5662,-10021.0235 1979.99,-10096.6906 1957.7862,-11539.3764 1968.5662,-11628.0235 1985.7753,-11769.539 2031.745,-11935.4009 2048.5059,-11993.0382"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2045.1951,-11994.1866 2051.367,-12002.7981 2051.9125,-11992.2173 2045.1951,-11994.1866"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge759" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2653.6817,-6743.2019C2668.2396,-6780.9913 2715.2884,-6907.7209 2735.2632,-7017.0235 2777.2285,-7246.6583 2709.6124,-7315.8737 2771.2632,-7541.0235 2812.5175,-7691.6852 2892.1949,-7703.254 2929.166,-7855.0235 2968.7863,-8017.6681 2957.8491,-10700.7827 2965.166,-10868.0235 2981.2324,-11235.2496 3023.9219,-11681.9007 3033.9244,-11783.6944"/>
<polygon fill="#ff0066" stroke="#ff0066" points="3030.4665,-11784.2948 3034.9318,-11793.9027 3037.4327,-11783.6072 3030.4665,-11784.2948"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge388" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M2682.8931,-6720.9598C2722.6358,-6708.0297 2790.9088,-6686.3283 2850.2146,-6670.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M2850.2146,-6670.0235C2883.4583,-6660.8839 3016.326,-6730.8535 3106.9189,-6770.0235 3159.8736,-6792.9197 3195.8714,-6871.3116 3225.8566,-6822.0235"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge227" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2653.6037,-6720.8726C2668.1179,-6682.6059 2715.5492,-6552.8209 2735.2632,-6441.0235 2780.1915,-6186.237 2753.7261,-6118.1459 2771.2632,-5860.0235 2799.9281,-5438.1139 2839.9805,-4922.8459 2848.5574,-4813.167"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2852.0567,-4813.3113 2849.3478,-4803.0686 2845.0781,-4812.765 2852.0567,-4813.3113"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge567" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2679.7838,-6743.1356C2766.1868,-6776.5138 3012.594,-6885.0978 3106.9189,-7069.0235 3145.9,-7145.0333 3126.7914,-10060.1372 3142.9189,-10144.0235 3157.2796,-10218.7195 3196.0553,-10301.0527 3215.0603,-10338.4792"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3212.1703,-10340.5123 3219.8597,-10347.801 3218.3939,-10337.308 3212.1703,-10340.5123"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge389" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M3227.5626,-4308.3191C3244.9418,-4423.3885 3389.7333,-5382.0627 3413.241,-5537.709"/>
<polygon fill="#002eff" stroke="#002eff" points="3409.8199,-5538.4945 3414.7741,-5547.8597 3416.7414,-5537.4491 3409.8199,-5538.4945"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge396" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M3044.7818,-7077.9677C3072.8807,-7042.1741 3162.7465,-6925.7609 3225.8566,-6822.0235"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge573" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3038.3113,-7100.0408C3048.6924,-7151.0465 3091.806,-7369.4771 3106.9189,-7551.0235 3130.8225,-7838.1692 3088.2113,-9861.1258 3142.9189,-10144.0235 3157.3609,-10218.7039 3196.0971,-10301.0446 3215.0764,-10338.4761"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3212.1843,-10340.5057 3219.869,-10347.7992 3218.4099,-10337.3053 3212.1843,-10340.5057"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge497" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1873.9043,-8789.1682C1893.8232,-8799.4681 1920.2295,-8816.8429 1932.5662,-8841.0235 1987.1088,-8947.9305 1941.9991,-10883.9842 1968.5662,-11001.0235 2009.2583,-11180.29 2100.9962,-11197.5791 2140.8962,-11377.0235 2168.6075,-11501.6504 2121.8032,-15857.8517 2176.8962,-15973.0235 2186.5375,-15993.1785 2206.0925,-16009.0579 2223.0715,-16019.8328"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2221.2771,-16022.8378 2231.6494,-16024.9976 2224.8879,-16016.8409 2221.2771,-16022.8378"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge536" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1873.2098,-8789.1163C1892.9942,-8799.4841 1919.5745,-8816.9811 1932.5662,-8841.0235 1992.0598,-8951.1223 1947.9173,-9279.5939 1968.5662,-9403.0235 2026.3555,-9748.4614 1979.0525,-9874.0169 2176.8962,-10163.0235 2224.9662,-10233.2433 2291.5344,-10201.4895 2330.7283,-10277.0235 2406.6946,-10423.4252 2293.3401,-11613.3126 2366.7283,-11761.0235 2376.9966,-11781.6909 2397.4136,-11797.8202 2415.0915,-11808.7169"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2413.6185,-11811.9099 2424.0181,-11813.9345 2417.1509,-11805.8665 2413.6185,-11811.9099"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge717" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1873.887,-8789.177C1893.7956,-8799.4822 1920.1965,-8816.8597 1932.5662,-8841.0235 1979.56,-8932.8248 1941.3016,-10597.5622 1968.5662,-10697.0235 2009.6255,-10846.8079 2099.6839,-10851.2812 2140.8962,-11001.0235 2165.6537,-11090.978 2117.4748,-12608.0941 2176.8962,-12680.0235 2221.431,-12733.9327 2285.2495,-12659.9084 2330.7283,-12713.0235 2376.6186,-12766.6192 2357.3688,-13277.0891 2366.7283,-13347.0235 2385.1667,-13484.7972 2426.3669,-13647.1565 2441.4081,-13704.0629"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2438.0985,-13705.2364 2444.0531,-13713.9996 2444.863,-13703.4358 2438.0985,-13705.2364"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge769" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1911.5038,-8778.9012C2074.0065,-8784.7562 2510.9375,-8823.901 2735.2632,-9071.0235 2890.8517,-9242.4235 2778.3809,-9358.9652 2850.2146,-9579.0235"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2850.2146,-9579.0235C3032.9809,-10124.375 2930.1782,-10293.9262 2965.166,-10868.0235 2987.5262,-11234.9202 3025.4306,-11681.8217 3034.1956,-11783.6802"/>
<polygon fill="#ff0066" stroke="#ff0066" points="3030.7302,-11784.2329 3035.0766,-11793.8951 3037.7043,-11783.6313 3030.7302,-11784.2329"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge399" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M1860.1557,-8766.9538C1917.9028,-8712.6494 2183.6428,-8477.0235 2447.0435,-8477.0235 2447.0435,-8477.0235 2447.0435,-8477.0235 2649.3109,-8477.0235 2821.1916,-8477.0235 2867.216,-8509.2816 3036.0425,-8477.0235"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1853.0531,-8766.8184C1867.7225,-8728.9358 1914.9316,-8601.8718 1932.5662,-8492.0235 2009.6067,-8012.1268 1915.7645,-7882.1881 1968.5662,-7399.0235 2013.8538,-6984.6166 2094.6886,-6891.3288 2140.8962,-6477.0235 2188.3702,-6051.3638 2121.5411,-5938.7302 2176.8962,-5514.0235 2196.976,-5359.9635 2107.7268,-5225.9077 2253.8123,-5173.0235"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge236" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2649.3109,-6007.0235C2684.6749,-5960.2901 2712.098,-5960.8566 2735.2632,-5907.0235 2824.6703,-5699.2525 2846.4894,-4949.4104 2849.7455,-4813.2942"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2853.2445,-4813.3737 2849.9772,-4803.2953 2846.2464,-4813.2115 2853.2445,-4813.3737"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1852.5267,-8767.0018C1865.7134,-8729.1921 1909.2354,-8601.0691 1932.5662,-8492.0235 2075.3186,-7824.8123 2080.4119,-7650.649 2140.8962,-6971.0235 2145.1796,-6922.8945 2145.6649,-6138.8928 2176.8962,-6102.0235 2290.3272,-5968.1158 2390.8289,-6053.1381 2563.3586,-6021.0235 2582.3841,-6017.4821 2637.6334,-6022.4554 2649.3109,-6007.0235"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge327" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1853.1168,-8766.8284C1867.9876,-8728.9774 1915.7593,-8602.0015 1932.5662,-8492.0235 1949.4799,-8381.3461 1921.5942,-6578.6561 1968.5662,-6477.0235 2011.412,-6384.3186 2097.9391,-6417.6768 2140.8962,-6325.0235 2182.4064,-6235.4913 2159.3663,-4646.141 2176.8962,-4549.0235 2182.5635,-4517.6263 2342.3931,-4027.656 2366.7283,-4007.0235 2394.3657,-3983.5913 2416.9706,-4013.2354 2447.0435,-3993.0235"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge407" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M2852.3849,-3928.0294C2863.2794,-3982.2718 2913.5258,-4220.6463 2965.166,-4273.0235 2988.5155,-4296.7062 3002.9036,-4299.8311 3036.0425,-4297.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M3036.0425,-4297.0235C3069.1814,-4294.2159 3086.2948,-4299.114 3106.9189,-4273.0235 3282.4256,-4050.9994 2956.0102,-2919.6992 3225.8566,-3005.0235"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge273" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M3036.0425,-4297.0235C3067.3138,-4294.3742 3101.5873,-4293.696 3132.3015,-4293.889"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3132.539,-4297.3913 3142.5717,-4293.9863 3132.6053,-4290.3916 3132.539,-4297.3913"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge584" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2851.3182,-3928.1408C2858.4511,-4000.0708 2898.7008,-4407.0948 2929.166,-4739.0235 3011.9834,-5641.3481 3062.552,-5864.9932 3106.9189,-6770.0235 3116.0975,-6957.2538 3107.6234,-9959.9212 3142.9189,-10144.0235 3157.2409,-10218.727 3196.0354,-10301.0565 3215.0526,-10338.4807"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3212.1636,-10340.5155 3219.8552,-10347.8018 3218.3863,-10337.3093 3212.1636,-10340.5155"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge413" class="edge">
<title>sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M2527.2773,-10225.8442C2679.0202,-10224.8047 2996.4674,-10219.0228 3036.0425,-10189.0235"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M3036.0425,-10189.0235C3063.0552,-10165.2949 3088.1854,-10180.7121 3106.9189,-10150.0235 3143.6665,-10089.8249 3131.4962,-8950.6207 3142.9189,-8881.0235 3183.7195,-8632.432 3266.708,-8587.4006 3308.7942,-8339.0235 3406.0514,-7765.0474 3415.612,-5807.0602 3416.3966,-5580.4619"/>
<polygon fill="#002eff" stroke="#002eff" points="3419.8973,-5580.2404 3416.43,-5570.229 3412.8973,-5580.2174 3419.8973,-5580.2404"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge590" class="edge">
<title>sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3036.0425,-10189.0235C3062.546,-10168.9329 3082.4497,-10190.4996 3106.9189,-10213.0235 3136.5029,-10240.2555 3118.1008,-10264.3873 3142.9189,-10296.0235 3157.7451,-10314.9227 3179.5174,-10331.1721 3197.0345,-10342.4326"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3195.4079,-10345.5427 3205.7476,-10347.854 3199.106,-10339.5993 3195.4079,-10345.5427"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2493.6923,-5216.4841C2506.5757,-5220.0854 2519.2336,-5226.3236 2527.3586,-5237.0235 2567.8282,-5290.3183 2552.7933,-6374.944 2563.3586,-6441.0235 2580.0217,-6545.24 2623.2471,-6664.5655 2641.2534,-6711.5211"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2638.0084,-6712.834 2644.8836,-6720.8952 2644.536,-6710.3061 2638.0084,-6712.834"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge288" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2850.2146,-6083.0235C2988.7544,-6235.2071 3028.75,-6936.2662 3035.0851,-7067.7421"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3031.5902,-7067.9337 3035.5549,-7077.7587 3038.5825,-7067.6057 3031.5902,-7067.9337"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2493.9749,-5216.7079C2506.7083,-5220.3306 2519.2117,-5226.5245 2527.3586,-5237.0235 2623.9366,-5361.4843 2476.1567,-5813.8229 2563.3586,-5945.0235 2641.6713,-6062.8496 2754.9747,-5978.4041 2850.2146,-6083.0235"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge346" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2457.405,-5200.7777C2500.749,-5152.9573 2668.3687,-4960.1058 2735.2632,-4767.0235 2792.1029,-4602.9631 2748.5918,-4550.1647 2771.2632,-4378.0235 2793.7645,-4207.1742 2833.2168,-4002.7771 2846.0519,-3937.8673"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2849.4894,-3938.5262 2848.0038,-3928.036 2842.6234,-3937.1629 2849.4894,-3938.5262"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge229" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2490.2121,-5223.056C2545.2312,-5236.6988 2634.97,-5257.3907 2649.3109,-5251.0235"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge266" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2493.9859,-5219.8595C2505.8395,-5223.5624 2517.8785,-5229.0104 2527.3586,-5237.0235 2769.7642,-5441.9169 2683.5193,-6144.1242 2850.2146,-5874.0235"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2850.2146,-5874.0235C3035.8941,-5727.3029 2918.2714,-5048.4239 2929.166,-4812.0235 2970.3189,-3919.0503 2900.1459,-3692.5767 2965.166,-2801.0235 2980.3089,-2593.3851 3020.1724,-2344.221 3032.4145,-2270.5345"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3035.9373,-2270.6884 3034.1341,-2260.2482 3029.0331,-2269.5342 3035.9373,-2270.6884"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge322" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2449.6659,-5200.7605C2461.2464,-5150.4877 2508.0793,-4941.4201 2527.3586,-4767.0235 2532.6374,-4719.2728 2533.7257,-3940.8373 2563.3586,-3903.0235 2568.9304,-3895.9136 2576.403,-3890.7435 2584.6261,-3886.9989"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2586.078,-3890.1909 2594.1677,-3883.3493 2583.5772,-3883.6528 2586.078,-3890.1909"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge615" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2493.8283,-5216.3819C2506.7172,-5219.9791 2519.3441,-5226.2406 2527.3586,-5237.0235 2559.3574,-5280.0753 2557.4846,-9045.7049 2563.3586,-9099.0235 2579.7311,-9247.6351 2626.656,-9422.188 2643.337,-9481.2815"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2639.982,-9482.2795 2646.0856,-9490.9396 2646.7146,-9480.3635 2639.982,-9482.2795"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge650" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2493.847,-5216.368C2506.7367,-5219.9646 2519.3593,-5226.2293 2527.3586,-5237.0235 2573.1394,-5298.7995 2559.7261,-10696.2188 2563.3586,-10773.0235 2581.4854,-11156.2855 2634.6068,-11622.0452 2646.7975,-11725.856"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2643.3444,-11726.4603 2647.9919,-11735.9814 2650.2962,-11725.6402 2643.3444,-11726.4603"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2254.3914,-5545.4683C2258.4132,-5620.5646 2284.4902,-6042.6415 2366.7283,-6135.0235 2416.4435,-6190.871 2478.9411,-6128.0473 2527.3586,-6185.0235 2564.5597,-6228.8005 2551.1888,-6384.8787 2563.3586,-6441.0235 2585.6691,-6543.9518 2625.5549,-6663.5958 2641.9574,-6711.0703"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2638.7534,-6712.5128 2645.3435,-6720.8087 2645.3651,-6710.2138 2638.7534,-6712.5128"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge302" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2263.6256,-5545.1396C2302.1377,-5589.2468 2444.8699,-5757.3025 2527.3586,-5917.0235 2549.8035,-5960.4829 2526.7539,-5988.5799 2563.3586,-6021.0235 2660.9716,-6107.5401 2760.628,-5988.2203 2850.2146,-6083.0235"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2254.6379,-5522.9875C2258.4706,-5479.7467 2278.3147,-5320.1565 2366.7283,-5237.0235 2373.5256,-5230.6321 2381.9327,-5225.8738 2390.7226,-5222.3315"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2392.08,-5225.5644 2400.3527,-5218.9453 2389.7579,-5218.9607 2392.08,-5225.5644"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge245" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-5251.0235C2466.3028,-5210.4103 2608.2296,-5269.2629 2649.3109,-5251.0235"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge333" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2255.2873,-5523.0124C2261.2024,-5483.2598 2286.8728,-5345.7752 2366.7283,-5275.0235 2394.6132,-5250.3175 2431.0804,-5284.6856 2447.0435,-5251.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-5251.0235C2462.7604,-5217.8804 2504.2145,-5260.4811 2527.3586,-5232.0235 2620.5646,-5117.4194 2473.0906,-4019.9556 2563.3586,-3903.0235 2568.8785,-3895.8732 2576.3227,-3890.6811 2584.533,-3886.9265"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2585.9827,-3890.1192 2594.0664,-3883.2705 2583.4762,-3883.5833 2585.9827,-3890.1192"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge626" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2255.7651,-5545.1866C2265.824,-5603.2178 2312.0411,-5876.4083 2330.7283,-6102.0235 2352.2551,-6361.9229 2305.4572,-7021.5339 2366.7283,-7275.0235 2405.805,-7436.6912 2488.8042,-7451.2305 2527.3586,-7613.0235 2603.928,-7934.3456 2524.7414,-8770.9695 2563.3586,-9099.0235 2580.8378,-9247.509 2627.0624,-9422.1417 2643.4489,-9481.2687"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2640.0869,-9482.2425 2646.1478,-9490.9325 2646.8289,-9480.3596 2640.0869,-9482.2425"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1665.7587,-5568.9327C1683.3448,-5557.4948 1710.0817,-5538.3594 1728.717,-5517.0235 1749.6782,-5493.0248 1748.4379,-5482.4151 1764.717,-5455.0235 1801.3917,-5393.3143 1809.9635,-5377.4971 1848.6416,-5317.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1848.6416,-5317.0235C1869.5446,-5284.3414 1906.6882,-5321.9265 1932.5662,-5293.0235 1996.3162,-5221.8213 1895.5492,-5142.6867 1968.5662,-5081.0235 2027.0824,-5031.6063 2075.2802,-5041.5173 2140.8962,-5081.0235 2170.1923,-5098.6621 2150.5918,-5127.1727 2176.8962,-5149.0235 2204.4423,-5171.9058 2220.2373,-5185.4776 2253.8123,-5173.0235"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge294" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2649.3109,-4753.0235C2711.5712,-4756.038 2885.9249,-4727.1277 2929.166,-4772.0235 2975.0488,-4819.6622 2962.0899,-5895.9537 2965.166,-5962.0235 2985.9694,-6408.8466 3025.9912,-6954.4313 3034.4487,-7067.7958"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3030.9701,-7068.2138 3035.2063,-7077.9249 3037.9506,-7067.6916 3030.9701,-7068.2138"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2447.0435,-4753.0235C2536.8432,-4748.8501 2559.5602,-4747.9028 2649.3109,-4753.0235"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge351" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2447.0435,-4753.0235C2653.5639,-4738.2326 2644.5582,-4573.1473 2735.2632,-4387.0235 2813.8712,-4225.7225 2841.3303,-4006.372 2848.2688,-3938.1496"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2851.7521,-3938.4901 2849.2421,-3928.1969 2844.7854,-3937.8088 2851.7521,-3938.4901"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2295.8759,-4689.0927C2307.4642,-4692.8336 2319.8364,-4697.4925 2330.7283,-4703.0235 2348.3259,-4711.9597 2349.0252,-4720.2981 2366.7283,-4729.0235 2400.1451,-4745.4938 2409.8283,-4754.753 2447.0435,-4753.0235"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2275.0724,-4689.1164C2293.1899,-4699.8034 2318.2209,-4717.7636 2330.7283,-4741.0235 2404.9968,-4879.1401 2313.5434,-4944.4994 2366.7283,-5092.0235 2380.977,-5131.5465 2410.9901,-5170.7499 2430.0209,-5193.114"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2427.5205,-5195.5727 2436.7211,-5200.8263 2432.8049,-5190.9818 2427.5205,-5195.5727"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge234" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2649.3109,-4753.0235C2705.419,-4755.7401 2768.8509,-4769.9762 2809.1602,-4780.4672"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2808.3289,-4783.8676 2818.8917,-4783.0444 2810.121,-4777.1009 2808.3289,-4783.8676"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge326" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2274.0675,-4666.8175C2327.0576,-4636.2344 2469.6608,-4545.5027 2527.3586,-4425.0235 2577.5812,-4320.1536 2490.3991,-3993.5602 2563.3586,-3903.0235 2568.9557,-3896.078 2576.3639,-3890.9902 2584.4896,-3887.2763"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2585.8409,-3890.5065 2593.9104,-3883.6411 2583.3209,-3883.9758 2585.8409,-3890.5065"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge619" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2273.5783,-4689.1621C2291.2031,-4700.114 2316.3715,-4718.4471 2330.7283,-4741.0235 2365.6655,-4795.9635 2343.5586,-4822.178 2366.7283,-4883.0235 2421.8097,-5027.672 2489.9201,-5041.8386 2527.3586,-5192.0235 2579.8624,-5402.6428 2539.6001,-8883.2629 2563.3586,-9099.0235 2579.7231,-9247.6359 2626.653,-9422.1884 2643.3362,-9481.2816"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2639.9812,-9482.2798 2646.0851,-9490.9397 2646.7138,-9480.3635 2639.9812,-9482.2798"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge896" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0058ff" stroke-dasharray="5,2" d="M588.0304,-4865.2514C598.2252,-4915.3643 639.3377,-5123.7321 654.4731,-5297.0235 688.82,-5690.2742 680.8242,-6678.3937 690.4731,-7073.0235 715.275,-8087.3861 754.663,-9336.5709 760.288,-9513.748"/>
<polygon fill="#0058ff" stroke="#0058ff" points="756.7932,-9513.9704 760.6091,-9523.8542 763.7896,-9513.748 756.7932,-9513.9704"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M595.962,-4842.8713C678.6838,-4754.1986 1246.8475,-4171.2656 1728.717,-4349.0235 1954.7311,-4432.3983 2029.053,-4487.6581 2140.8962,-4701.0235 2214.1127,-4840.6998 2092.0939,-4921.0623 2176.8962,-5054.0235 2205.3006,-5098.5585 2346.3981,-5166.5888 2412.6173,-5196.7331"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2411.2682,-5199.9642 2421.8218,-5200.8984 2414.1542,-5193.5868 2411.2682,-5199.9642"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M654.4446,-4856.9787C744.8441,-4864.8613 901.5757,-4893.0965 981.6013,-4993.0235 1022.2998,-5043.8432 986.6039,-5077.7682 1017.6013,-5135.0235 1053.2664,-5200.9005 1093.5239,-5194.6084 1131.7661,-5259.0235 1157.1654,-5301.8059 1131.7201,-5330.7286 1167.7661,-5365.0235 1224.16,-5418.6777 1275.407,-5364.4099 1336.1997,-5413.0235 1362.2954,-5433.8912 1347.1231,-5456.9417 1372.1997,-5479.0235 1441.8524,-5540.3578 1479.0762,-5524.4304 1566.6973,-5555.0235 1577.5525,-5558.8136 1589.326,-5562.6185 1600.4466,-5566.0762"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1599.4246,-5569.4237 1610.0116,-5569.0164 1601.4814,-5562.7326 1599.4246,-5569.4237"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.9829,-1547.0235C1286.69,-1564.6354 1308.0787,-1544.1169 1336.1997,-1571.0235 1372.7575,-1606.0025 1348.1226,-1634.523 1372.1997,-1679.0235 1426.171,-1778.7762 1486.9494,-1774.383 1530.6973,-1879.0235 1581.475,-2000.4788 1524.4962,-2048.3285 1566.6973,-2173.0235 1612.2958,-2307.7571 1665.8773,-2321.4165 1728.717,-2449.0235 1782.0909,-2557.4085 1897.9182,-2837.2842 1932.5662,-2953.0235 1955.9635,-3031.1808 1924.3874,-3064.4361 1968.5662,-3133.0235 2019.662,-3212.3497 2096.8936,-3173.5537 2140.8962,-3257.0235 2221.2316,-3409.4136 2100.7589,-4652.4933 2176.8962,-4807.0235 2215.7082,-4885.7972 2281.8145,-4858.0913 2330.7283,-4931.0235 2361.9803,-4977.6214 2346.0628,-4999.8604 2366.7283,-5052.0235 2387.2985,-5103.946 2418.5609,-5161.8064 2435.3714,-5191.6884"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2432.5046,-5193.7284 2440.482,-5200.7007 2438.5937,-5190.2755 2432.5046,-5193.7284"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge323" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1251.9829,-1547.0235C1307.7365,-1577.7283 1474.7264,-1582.7167 1530.6973,-1613.0235 1612.9537,-1657.5633 2102.4314,-2107.7571 2140.8962,-2193.0235 2230.3261,-2391.266 2103.095,-2966.448 2176.8962,-3171.0235 2195.9236,-3223.767 2213.4265,-3232.1274 2253.8123,-3271.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-3271.0235C2278.9703,-3294.9901 2296.6186,-3278.4012 2330.7283,-3285.0235 2382.5453,-3295.0837 2407.9691,-3273.5354 2447.0435,-3309.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M818.3306,-1499.6509C914.745,-1485.2637 1112.4103,-1469.0785 1251.9829,-1547.0235"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge780" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2850.6127,-4803.0466C2855.6081,-4941.8242 2906.3268,-6363.6639 2929.166,-7513.0235 2958.7921,-9003.9261 2900.8945,-9378.2123 2965.166,-10868.0235 2981.0088,-11235.2594 3023.8683,-11681.903 3033.9147,-11783.6948"/>
<polygon fill="#ff0066" stroke="#ff0066" points="3030.4572,-11784.297 3034.9267,-11793.9029 3037.423,-11783.6064 3030.4572,-11784.297"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge276" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2881.6291,-4790.2648C2926.2187,-4785.812 3005.8054,-4770.1324 3036.0425,-4715.0235"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge304" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2851.0115,-4803.0505C2858.2728,-4903.3874 2913.8815,-5668.8123 2965.166,-6289.0235 2990.7562,-6598.4996 3025.4633,-6974.9799 3034.0569,-7067.6585"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3030.5841,-7068.1147 3034.9934,-7077.7485 3037.5542,-7067.4678 3030.5841,-7068.1147"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge258" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2863.1018,-4780.8709C2881.7991,-4763.7554 2915.6839,-4728.9844 2929.166,-4691.0235 2964.3135,-4592.0606 2957.4674,-2905.76 2965.166,-2801.0235 2980.4278,-2593.3938 3020.2101,-2344.2237 3032.4234,-2270.5352"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3035.9462,-2270.6881 3034.1389,-2260.2485 3029.0416,-2269.5366 3035.9462,-2270.6881"/>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge281" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M3037.0637,-2260.0423C3051.0683,-2411.1442 3204.6989,-4068.7425 3223.8917,-4275.8235"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3220.4262,-4276.3589 3224.8342,-4285.9931 3227.3963,-4275.7128 3220.4262,-4276.3589"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge767" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2850.2146,-9009.0235C2909.7071,-9251.4195 2908.1409,-9316.3206 2929.166,-9565.0235 2977.9682,-10142.2964 2935.309,-10289.4613 2965.166,-10868.0235 2984.1098,-11235.1125 3024.6116,-11681.8678 3034.0484,-11783.6884"/>
<polygon fill="#ff0066" stroke="#ff0066" points="3030.587,-11784.2666 3034.998,-11793.8995 3037.5569,-11783.6183 3030.587,-11784.2666"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2256.5387,-7081.15C2268.1618,-7128.1968 2315.3325,-7315.2592 2366.7283,-7465.0235 2428.7794,-7645.8369 2479.1657,-7679.0336 2527.3586,-7864.0235 2559.2118,-7986.293 2539.3633,-8021.9724 2563.3586,-8146.0235 2620.8428,-8443.2048 2667.3527,-8510.0501 2735.2632,-8805.0235 2753.5672,-8884.528 2716.4605,-8924.5862 2771.2632,-8985.0235 2795.8989,-9012.1922 2841.4727,-8973.4057 2850.2146,-9009.0235"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge292" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2447.0435,-7069.0235C2620.4594,-7023.913 2687.3189,-6994.3709 2850.2146,-7069.0235"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge349" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2300.5104,-7059.8263C2362.5962,-7043.7048 2471.0202,-7006.1307 2527.3586,-6931.0235 2567.4617,-6877.5603 2514.8863,-6831.0344 2563.3586,-6785.0235 2619.7835,-6731.464 2685.2551,-6811.6186 2735.2632,-6752.0235 2777.6572,-6701.5021 2765.1786,-4443.6943 2771.2632,-4378.0235 2787.1261,-4206.8159 2830.7636,-4003.432 2845.3753,-3938.2369"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2848.8209,-3938.8677 2847.6087,-3928.3425 2841.9927,-3937.3263 2848.8209,-3938.8677"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge368" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2254.229,-7081.2505C2258.7191,-7202.2246 2298.6096,-8277.0959 2330.7283,-9147.0235 2334.7403,-9255.6897 2329.0026,-10023.0372 2366.7283,-10125.0235 2379.0927,-10158.449 2407.1044,-10189.334 2426.5419,-10207.9286"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2424.3186,-10210.6406 2434.0245,-10214.8889 2429.0863,-10205.5152 2424.3186,-10210.6406"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge232" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2300.5521,-7076.9657C2340.3621,-7081.1972 2398.6368,-7083.3741 2447.0435,-7069.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2447.0435,-7069.0235C2501.6966,-7052.8211 2495.2703,-7016.1386 2527.3586,-6969.0235 2545.512,-6942.3691 2541.6538,-6929.8751 2563.3586,-6906.0235 2626.2411,-6836.9214 2690.6189,-6867.0979 2735.2632,-6785.0235 2784.4109,-6694.6699 2765.4709,-5962.7159 2771.2632,-5860.0235 2795.0778,-5437.8123 2838.8987,-4922.7787 2848.3764,-4813.1557"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2851.8746,-4813.3275 2849.2512,-4803.0626 2844.9007,-4812.723 2851.8746,-4813.3275"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge514" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M1253.1218,-7259.1652C1261.7574,-7344.2306 1317.0979,-7899.8508 1336.1997,-8353.0235 1346.4899,-8597.1483 1323.6999,-12511.5438 1372.1997,-12751.0235 1408.8479,-12931.9829 1482.14,-12956.8899 1530.6973,-13135.0235 1560.683,-13245.0269 1497.995,-13298.0295 1566.6973,-13389.0235 1614.1784,-13451.9108 1663.6046,-13416.6429 1728.717,-13461.0235 1833.8527,-13532.684 1849.8011,-13565.3867 1932.5662,-13662.0235 1950.3785,-13682.8213 1951.6657,-13690.4781 1968.5662,-13712.0235 2041.4001,-13804.8754 2094.5717,-13805.4865 2140.8962,-13914.0235 2172.1964,-13987.3589 2126.4854,-14209.2455 2176.8962,-14271.0235 2199.5364,-14298.7689 2236.4415,-14263.7083 2253.8123,-14295.0235"/>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M2253.8123,-14295.0235C2274.3001,-14333.8586 2305.4237,-14321.1405 2330.7283,-14357.0235 2403.5312,-14460.2614 2434.5305,-14613.3468 2443.8245,-14668.9083"/>
<polygon fill="#65ff00" stroke="#65ff00" points="2440.397,-14669.6388 2445.4429,-14678.9549 2447.3079,-14668.5255 2440.397,-14669.6388"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge537" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1253.0287,-7259.1697C1260.9723,-7344.268 1312.1356,-7900.0872 1336.1997,-8353.0235 1339.7265,-8419.4044 1332.8041,-9495.4805 1372.1997,-9549.0235 1471.5367,-9684.0335 1625.0381,-9540.3185 1728.717,-9672.0235 1780.7732,-9738.1512 1731.2177,-9971.8192 1764.717,-10049.0235 1809.5678,-10152.3888 1884.5637,-10137.0837 1932.5662,-10239.0235 1976.271,-10331.8369 1919.9003,-10376.7125 1968.5662,-10467.0235 2017.7168,-10558.234 2094.5685,-10531.3473 2140.8962,-10624.0235 2216.1567,-10774.5782 2134.666,-10838.0896 2176.8962,-11001.0235 2198.3142,-11083.6588 2229.7189,-11095.1282 2253.8123,-11177.0235"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge352" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1252.6553,-7236.7454C1258.7629,-7134.1227 1305.13,-6351.2315 1336.1997,-5716.0235 1340.7636,-5622.7161 1337.1684,-4962.6256 1372.1997,-4876.0235 1468.6935,-4637.4784 1970.5941,-4202.9276 2140.8962,-4010.0235 2156.9453,-3991.8445 2155.7936,-3980.9704 2176.8962,-3969.0235 2207.1335,-3951.9053 2223.7208,-3972.3966 2253.8123,-3955.0235"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2253.8123,-3955.0235C2292.1775,-3933.1824 2605.1644,-3916.8988 2649.3109,-3917.0235"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge235" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2253.8123,-5855.0235C2557.7432,-5752.1352 2361.5644,-5393.0164 2649.3109,-5251.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1252.9884,-7236.7637C1258.7845,-7174.5628 1290.5671,-6867.2283 1372.1997,-6631.0235 1515.8976,-6215.2323 1562.9793,-6011.4075 1968.5662,-5841.0235 2039.1795,-5811.3594 2064.4507,-5836.3025 2140.8962,-5841.0235 2191.3692,-5844.1405 2204.1979,-5864.8037 2253.8123,-5855.0235"/>
</g>
<!-- sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge238" class="edge">
<title>sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2256.5706,-3662.041C2267.7968,-3706.2723 2312.0645,-3874.914 2366.7283,-4007.0235 2439.4336,-4182.7353 2448.8405,-4235.2135 2563.3586,-4387.0235 2626.5812,-4470.8339 2684.3596,-4457.208 2735.2632,-4549.0235 2774.8216,-4620.3757 2728.8047,-4659.3581 2771.2632,-4729.0235 2783.2312,-4748.6605 2803.6559,-4764.7111 2820.7324,-4775.6965"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2818.9448,-4778.7061 2829.2946,-4780.9716 2822.6166,-4772.7464 2818.9448,-4778.7061"/>
</g>
<!-- sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge342" class="edge">
<title>sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2704.4745,-3888.732C2728.8814,-3893.47 2757.7997,-3899.0837 2783.4166,-3904.0565"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2782.9414,-3907.5295 2793.4252,-3905.9994 2784.2754,-3900.6578 2782.9414,-3907.5295"/>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge501" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2055.9982,-12025.2496C2065.1048,-12106.5114 2120.7932,-12613.1704 2140.8962,-13027.0235 2144.8669,-13108.7666 2141.4187,-15899.2737 2176.8962,-15973.0235 2186.5817,-15993.1573 2206.1362,-16009.0369 2223.1039,-16019.8172"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2221.3041,-16022.819 2231.6751,-16024.9853 2224.9186,-16016.8244 2221.3041,-16022.819"/>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge631" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2062.6448,-12003.0144C2081.9595,-11976.1867 2133.1361,-11905.3568 2176.8962,-11847.0235 2244.191,-11757.318 2278.5245,-11746.2728 2330.7283,-11647.0235 2462.9365,-11395.6706 2479.5156,-11318.967 2527.3586,-11039.0235 2553.5348,-10885.8594 2518.959,-9789.9299 2563.3586,-9641.0235 2577.4894,-9593.6322 2612.2218,-9546.3395 2632.9524,-9520.9795"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2635.6801,-9523.1734 2639.396,-9513.2516 2630.3038,-9518.6906 2635.6801,-9523.1734"/>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge645" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2253.8123,-11861.0235C2334.763,-11802.8036 2347.3844,-11743.7606 2447.0435,-11747.0235"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2119.1892,-12002.9042C2127.1678,-11999.445 2134.6865,-11994.9252 2140.8962,-11989.0235 2176.3513,-11955.3273 2141.7811,-11919.0738 2176.8962,-11885.0235 2202.6048,-11860.0945 2224.7399,-11881.9324 2253.8123,-11861.0235"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge856" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff58" stroke-dasharray="5,2" d="M259.5587,-17719.1103C340.8594,-17741.9134 541.4127,-17784.0557 654.4731,-17685.0235 953.0494,-17423.494 900.9945,-17242.6724 981.6013,-16854.0235 1029.4206,-16623.461 987.3569,-16028.5424 1017.6013,-15795.0235 1028.7957,-15708.5913 1056.0621,-15608.1799 1068.4162,-15565.2496"/>
<polygon fill="#00ff58" stroke="#00ff58" points="1071.8511,-15565.972 1071.283,-15555.3924 1065.1296,-15564.0171 1071.8511,-15565.972"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge866" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#00ff9b" stroke-dasharray="5,2" d="M241.1314,-17719.0413C300.5969,-17756.1627 503.34,-17876.3829 690.4731,-17913.0235 751.965,-17925.0636 771.4861,-17931.1812 831.457,-17913.0235 849.8615,-17907.4511 850.5855,-17898.25 867.457,-17889.0235 873.6424,-17885.641 880.3772,-17882.3604 886.981,-17879.3491"/>
<polygon fill="#00ff9b" stroke="#00ff9b" points="888.7515,-17882.3933 896.4831,-17875.1495 885.9217,-17875.9907 888.7515,-17882.3933"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge901" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M227.5905,-17696.6735C253.564,-17617.592 407.8254,-17140.2826 480.9653,-16740.0235 553.8714,-16341.0444 579.8072,-15844.7444 584.7838,-15736.4995"/>
<polygon fill="#0016ff" stroke="#0016ff" points="588.2925,-15736.3834 585.2456,-15726.2362 581.2996,-15736.0687 588.2925,-15736.3834"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge910" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#2c00ff" stroke-dasharray="5,2" d="M224.225,-17719.2974C226.7224,-17785.0352 242.9561,-18118.0498 317.2024,-18179.0235 581.0601,-18395.7129 764.8782,-17907.5113 1074.6837,-18051.0235"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge945" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M224.5827,-17719.2419C230.5162,-17807.6477 271.2158,-18390.303 317.2024,-18452.0235 375.1669,-18529.8201 422.0294,-18520.0394 516.9653,-18540.0235 653.8774,-18568.8437 692.2775,-18540.3266 831.457,-18526.0235 965.7108,-18512.2267 1000.2435,-18511.2927 1131.7661,-18481.0235 1223.9246,-18459.8138 1264.9022,-18484.15 1336.1997,-18422.0235 1365.9012,-18396.1426 1342.6683,-18367.0984 1372.1997,-18341.0235 1427.3734,-18292.3076 1464.7379,-18325.6845 1530.6973,-18293.0235 1548.3842,-18284.2655 1548.9839,-18275.728 1566.6973,-18267.0235 1634.1009,-18233.9006 1661.1945,-18251.9033 1728.717,-18219.0235 1828.6775,-18170.3482 1866.3329,-18163.3237 1932.5662,-18074.0235 2015.3846,-17962.362 2044.3434,-17791.0485 2052.2324,-17731.3883"/>
<polygon fill="#ff00c7" stroke="#ff00c7" points="2055.7271,-17731.6493 2053.5039,-17721.2903 2048.7819,-17730.7747 2055.7271,-17731.6493"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge485" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.2313,-17696.889C227.955,-17593.1518 258.3367,-16797.6139 317.2024,-16712.0235 363.2164,-16645.1194 437.3133,-16699.4921 480.9653,-16631.0235 571.7831,-16488.575 439.9559,-15261.3864 516.9653,-15111.0235 596.87,-14955.0076 706.2195,-14995.6665 831.457,-14873.0235 994.8937,-14712.9727 1046.2919,-14667.2073 1131.7661,-14455.0235 1164.5334,-14373.6811 1119.1317,-14333.9959 1167.7661,-14261.0235 1217.3517,-14186.6238 1292.6861,-14229.13 1336.1997,-14151.0235 1376.2543,-14079.1259 1321.4087,-12734.7839 1372.1997,-12670.0235 1417.2438,-12612.5907 1480.7998,-12680.294 1530.6973,-12627.0235 1585.8745,-12568.1164 1530.4978,-12521.1634 1566.6973,-12449.0235 1625.8464,-12331.1484 1667.1432,-12316.7506 1764.717,-12228.0235 1812.1513,-12184.89 1969.4756,-12073.6881 2030.3672,-12031.0304"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2032.4406,-12033.8514 2038.6269,-12025.2502 2028.4271,-12028.1162 2032.4406,-12033.8514"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge647" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M224.1879,-17696.827C227.4643,-17594.1962 254.2251,-16818.83 317.2024,-16740.0235 365.0465,-16680.1538 434.9336,-16747.2977 480.9653,-16686.0235 547.1455,-16597.929 470.519,-15794.9394 516.9653,-15695.0235 605.6288,-15504.2895 671.236,-15452.773 867.457,-15377.0235 914.7837,-15358.7534 931.1556,-15371.6533 981.6013,-15377.0235 1246.1108,-15405.1817 1302.1877,-15474.8653 1566.6973,-15503.0235 1638.3015,-15510.6461 1657.1512,-15510.9979 1728.717,-15503.0235 1821.0235,-15492.738 1850.2676,-15500.0725 1932.5662,-15457.0235 1951.799,-15446.9632 1951.9599,-15438 1968.5662,-15424.0235 2042.5874,-15361.7244 2065.407,-15351.5355 2140.8962,-15291.0235 2337.2955,-15133.5903 2444.7981,-15114.8083 2527.3586,-14877.0235 2576.3442,-14735.9389 2548.0434,-12337.5829 2563.3586,-12189.0235 2580.2608,-12025.0707 2627.6243,-11831.3661 2643.8084,-11768.1278"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2647.265,-11768.7399 2646.3731,-11758.1827 2640.4868,-11766.9919 2647.265,-11768.7399"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge845" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M278.8078,-17708.0235C295.1003,-17708.0235 313.1505,-17708.0235 330.2066,-17708.0235"/>
<polygon fill="#ff0000" stroke="#ff0000" points="330.6733,-17711.5236 340.6733,-17708.0235 330.6733,-17704.5236 330.6733,-17711.5236"/>
</g>
<!-- sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge598" class="edge">
<title>sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M3226.2329,-10370.3452C3235.2516,-10641.6587 3403.4546,-15701.7708 3415.7511,-16071.6907"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="3412.259,-16071.9913 3416.0894,-16081.8695 3419.2552,-16071.7587 3412.259,-16071.9913"/>
</g>
<!-- sourcefile~datadefineequip.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge606" class="edge">
<title>sourcefile~datadefineequip.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M1074.6837,-17823.0235C1217.6813,-17851.4693 1617.5393,-17969.3473 1728.717,-17875.0235 1803.5992,-17811.493 1704.2057,-17734.3658 1764.717,-17657.0235 1876.8868,-17513.6544 2026.3243,-17636.4803 2140.8962,-17495.0235 2192.245,-17431.6255 2122.316,-17375.6618 2176.8962,-17315.0235 2224.8109,-17261.7907 2267.2589,-17300.2076 2330.7283,-17267.0235 2348.6911,-17257.6319 2349.7324,-17250.069 2366.7283,-17239.0235 2434.6282,-17194.8958 2467.404,-17207.4578 2527.3586,-17153.0235 2548.7142,-17133.6343 2542.0927,-17118.511 2563.3586,-17099.0235 2670.5107,-17000.8326 2732.6929,-17027.5319 2850.2146,-16942.0235"/>
</g>
<!-- sourcefile~datadefineequip.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge577" class="edge">
<title>sourcefile~datadefineequip.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M966.0082,-17797.0295C1006.587,-17807.6688 1063.8349,-17822.291 1074.6837,-17823.0235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.6837,-17823.0235C1219.7918,-17832.8218 1619.5586,-17895.1318 1728.717,-17799.0235 1802.4216,-17734.1305 1713.4644,-17664.7888 1764.717,-17581.0235 1813.124,-17501.909 1863.6602,-17519.1066 1932.5662,-17457.0235 2034.5443,-17365.143 2075.7735,-17349.8564 2140.8962,-17229.0235 2171.7854,-17171.7097 2132.1217,-17134.2914 2176.8962,-17087.0235 2226.1498,-17035.0271 2275.3523,-17084.4443 2330.7283,-17039.0235 2356.5628,-17017.8334 2348.1939,-17000.825 2366.7283,-16973.0235 2429.9689,-16878.1627 2469.4788,-16871.2471 2527.3586,-16773.0235 2548.8118,-16736.6169 2542.5041,-16721.7763 2563.3586,-16685.0235 2626.165,-16574.3377 2663.3649,-16561.0312 2735.2632,-16456.0235 2911.8392,-16198.1335 3017.7774,-16158.59 3106.9189,-15859.0235 3190.8344,-15577.0197 3223.4088,-10740.7259 3225.7227,-10380.2422"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3229.2234,-10380.1159 3225.7874,-10370.0937 3222.2236,-10380.0712 3229.2234,-10380.1159"/>
</g>
<!-- sourcefile~hvacmixercomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge581" class="edge">
<title>sourcefile~hvacmixercomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1849.0525,-14223.3819C1851.6531,-14284.7644 1869.1,-14582.0202 1968.5662,-14797.0235 1984.3287,-14831.0954 2143.1446,-15046.5865 2176.8962,-15063.0235 2486.9271,-15214.0083 2729.4492,-15154.144 2929.166,-14873.0235 3208.0128,-14480.52 3224.8799,-10698.1387 3225.806,-10380.2756"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3229.3063,-10380.101 3225.8334,-10370.0915 3222.3064,-10380.082 3229.3063,-10380.101"/>
</g>
<!-- sourcefile~photovoltaics.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge699" class="edge">
<title>sourcefile~photovoltaics.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M2896.6275,-10115.0188C2915.4667,-10117.0464 2937.7425,-10119.4438 2958.8952,-10121.7204"/>
<polygon fill="#00cbff" stroke="#00cbff" points="2958.5254,-10125.2007 2968.8425,-10122.791 2959.2745,-10118.2409 2958.5254,-10125.2007"/>
</g>
<!-- sourcefile~windturbine.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge700" class="edge">
<title>sourcefile~windturbine.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M1656.4145,-11903.1261C1673.6019,-11925.7173 1711.6953,-11979.2858 1728.717,-12031.0235 1751.9093,-12101.5166 1720.163,-12303.6762 1764.717,-12363.0235 1823.5479,-12441.388 1872.4414,-12427.9946 1968.5662,-12447.0235 2140.8609,-12481.1311 2622.8919,-12390.0106 2735.2632,-12255.0235 2947.7625,-11999.7566 2897.6225,-11103.6625 2929.166,-10773.0235 2935.4877,-10706.7596 2931.3652,-10232.3678 2965.166,-10175.0235 2972.5511,-10162.4944 2984.9469,-10152.8958 2997.3253,-10145.8467"/>
<polygon fill="#00cbff" stroke="#00cbff" points="2999.0333,-10148.9031 3006.2638,-10141.159 2995.7822,-10142.7039 2999.0333,-10148.9031"/>
</g>
<!-- sourcefile~photovoltaicthermalcollectors.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge658" class="edge">
<title>sourcefile~photovoltaicthermalcollectors.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2652.9695,-9513.0955C2676.908,-9585.5413 2811.2078,-9991.9762 2843.3178,-10089.1516"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2840.0261,-10090.3456 2846.487,-10098.7425 2846.6727,-10088.1493 2840.0261,-10090.3456"/>
</g>
<!-- sourcefile~hvactranspiredcollector.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge662" class="edge">
<title>sourcefile~hvactranspiredcollector.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2652.0785,-11735.9376C2664.5192,-11685.5447 2715.5163,-11472.8582 2735.2632,-11295.0235 2748.5386,-11175.4696 2730.7377,-10326.2801 2771.2632,-10213.0235 2783.4053,-10179.0898 2811.1988,-10147.3482 2830.3436,-10128.308"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2832.9482,-10130.6581 2837.7006,-10121.1889 2828.0804,-10125.6276 2832.9482,-10130.6581"/>
</g>
<!-- sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge672" class="edge">
<title>sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M926.1355,-10852.6339C931.6764,-10817.8466 953.3196,-10712.2454 1017.6013,-10661.0235 1212.5309,-10505.6968 1318.755,-10572.4901 1566.6973,-10547.0235 1638.3292,-10539.6661 1672.169,-10502.4412 1728.717,-10547.0235 1782.5566,-10589.4705 1710.8775,-10654.5766 1764.717,-10697.0235 1823.2997,-10743.2099 1869.2159,-10736.417 1932.5662,-10697.0235 1963.2862,-10677.9206 1944.9229,-10651.403 1968.5662,-10624.0235 2029.3996,-10553.5769 2092.4892,-10584.5232 2140.8962,-10505.0235 2206.3783,-10397.4813 2100.5951,-10324.1803 2176.8962,-10224.0235 2255.7646,-10120.4969 2334.078,-10175.6515 2447.0435,-10111.0235"/>
</g>
<!-- sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge625" class="edge">
<title>sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M926.4614,-10852.9868C935.4679,-10802.6269 974.7047,-10595.0359 1017.6013,-10547.0235 1054.2738,-10505.9775 1082.2839,-10523.1308 1131.7661,-10499.0235 1225.2889,-10453.4601 1251.8534,-10445.9188 1336.1997,-10385.0235 1353.7977,-10372.3183 1351.9711,-10359.8921 1372.1997,-10352.0235 1437.8511,-10326.4862 1461.5773,-10338.4333 1530.6973,-10352.0235 1623.998,-10370.3681 1651.287,-10377.8316 1728.717,-10433.0235 1748.4638,-10447.0989 1742.6258,-10464.0222 1764.717,-10474.0235 1832.6764,-10504.7907 1871.5561,-10516.9522 1932.5662,-10474.0235 2195.5466,-10288.9818 2025.5173,-10076.7197 2176.8962,-9793.0235 2200.691,-9748.4302 2397.1949,-9418.6638 2447.0435,-9427.0235"/>
</g>
<!-- sourcefile~datagenerators.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge723" class="edge">
<title>sourcefile~datagenerators.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M777.7287,-14793.1616C793.6023,-14804.4979 817.0858,-14823.4364 831.457,-14845.0235 858.5627,-14885.7393 832.8618,-14914.4452 867.457,-14949.0235 1023.3564,-15104.8465 1131.0709,-15030.3538 1336.1997,-15111.0235 1440.4533,-15152.0227 1457.0933,-15189.856 1566.6973,-15213.0235 1733.0778,-15248.1922 1815.0075,-15223.9026 1932.5662,-15101.0235 1957.5737,-15074.8842 1946.3038,-15056.5372 1968.5662,-15028.0235 2033.4947,-14944.863 2280.8932,-14814.0173 2330.7283,-14721.0235 2425.8169,-14543.5853 2444.0279,-13873.8776 2446.6589,-13746.1439"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2450.1593,-13746.1547 2446.8563,-13736.0879 2443.1606,-13746.0173 2450.1593,-13746.1547"/>
</g>
<!-- sourcefile~datagenerators.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge682" class="edge">
<title>sourcefile~datagenerators.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M770.4447,-14770.9194C802.3113,-14733.3307 907.7141,-14606.8644 981.6013,-14493.0235 999.7922,-14464.9961 995.764,-14452.3134 1017.6013,-14427.0235 1059.1185,-14378.9423 1098.8647,-14395.3648 1131.7661,-14341.0235 1182.627,-14257.0198 1150.2198,-14219.6443 1167.7661,-14123.0235 1236.5788,-13744.0977 1288.3785,-13655.1663 1336.1997,-13273.0235 1354.8243,-13124.193 1319.1157,-12739.307 1372.1997,-12599.0235 1412.3397,-12492.9467 1489.4357,-12504.6691 1530.6973,-12399.0235 1569.7731,-12298.9742 1499.7446,-12001.0124 1566.6973,-11917.0235 1573.5812,-11908.3879 1583.3888,-11902.6668 1593.815,-11898.8936"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1594.9492,-11902.207 1603.4978,-11895.9482 1592.912,-11895.51 1594.9492,-11902.207"/>
</g>
<!-- sourcefile~plantsolarcollectors.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge764" class="edge">
<title>sourcefile~plantsolarcollectors.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M2455.3768,-13315.9614C2491.3487,-13268.4125 2637.5428,-13077.2323 2771.2632,-12932.0235 2837.4592,-12860.1404 2886.2019,-12866.7913 2929.166,-12779.0235 3015.4752,-12602.71 3033.0285,-11952.6579 3035.6484,-11826.3622"/>
<polygon fill="#ff0066" stroke="#ff0066" points="3039.1529,-11826.163 3035.8517,-11816.0956 3032.1543,-11826.0243 3039.1529,-11826.163"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge851" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff58" stroke-dasharray="5,2" d="M456.7162,-17696.9114C465.4588,-17693.4623 473.903,-17688.9434 480.9653,-17683.0235 610.9798,-17574.0397 577.5944,-17494.2547 654.4731,-17343.0235 800.3112,-17056.1396 900.6348,-17008.4967 981.6013,-16697.0235 1032.0705,-16502.8719 991.2475,-15993.8889 1017.6013,-15795.0235 1029.051,-15708.6247 1056.1838,-15608.1958 1068.4597,-15565.2553"/>
<polygon fill="#00ff58" stroke="#00ff58" points="1071.8951,-15565.9741 1071.3076,-15555.3956 1065.17,-15564.0316 1071.8951,-15565.9741"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge902" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#0016ff" stroke-dasharray="5,2" d="M457.4887,-17699.9456C466.5803,-17696.1772 474.9409,-17690.7655 480.9653,-17683.0235 506.5152,-17650.1896 514.7949,-16976.5705 516.9653,-16935.0235 542.3231,-16449.6257 577.3642,-15855.8378 584.4431,-15736.4953"/>
<polygon fill="#0016ff" stroke="#0016ff" points="587.9571,-15736.3628 585.0559,-15726.1729 580.9694,-15735.9479 587.9571,-15736.3628"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge933" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M1451.4485,-18279.0235C1505.7776,-18266.146 1514.2227,-18248.0998 1566.6973,-18229.0235 1601.9888,-18216.1939 1611.9168,-18216.3877 1647.7072,-18205.0235"/>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M412.1693,-17719.201C433.5604,-17737.3017 477.5856,-17773.8419 516.9653,-17802.0235 591.4107,-17855.2995 610.8953,-17867.7709 690.4731,-17913.0235 772.0324,-17959.4028 1360.1539,-18300.6628 1451.4485,-18279.0235"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge857" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff58" stroke-dasharray="5,2" d="M468.7641,-16581.1656C473.296,-16583.8367 477.4453,-16587.0837 480.9653,-16591.0235 558.1039,-16677.3605 429.6244,-16773.0235 516.9653,-16849.0235 563.0693,-16889.141 604.6899,-16884.4723 654.4731,-16849.0235 694.3172,-16820.652 655.7984,-16779.5222 690.4731,-16745.0235 737.3966,-16698.3383 787.8104,-16746.7859 831.457,-16697.0235 885.2536,-16635.689 845.4577,-16595.5858 867.457,-16517.0235 907.4976,-16374.0336 949.4375,-16347.9885 981.6013,-16203.0235 1021.0318,-16025.3074 989.3523,-15974.8561 1017.6013,-15795.0235 1031.1261,-15708.9252 1057.1723,-15608.3389 1068.8128,-15565.3065"/>
<polygon fill="#00ff58" stroke="#00ff58" points="1072.2533,-15565.9931 1071.5075,-15555.4246 1065.4999,-15564.1515 1072.2533,-15565.9931"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge861" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff58" stroke-dasharray="5,2" d="M421.9442,-16622.0501C441.1027,-16632.5843 467.4316,-16650.3567 480.9653,-16674.0235 513.0924,-16730.2049 468.4564,-16920.1823 516.9653,-16963.0235 562.773,-17003.4791 601.9208,-16994.2203 654.4731,-16963.0235 683.2051,-16945.9672 671.3936,-16924.4537 690.4731,-16897.0235 744.9754,-16818.6672 787.1938,-16819.587 831.457,-16735.0235 861.6504,-16677.3401 844.2546,-16653.8566 867.457,-16593.0235 906.5724,-16490.4692 952.1891,-16479.77 981.6013,-16374.0235 1050.6914,-16125.6226 980.8938,-16050.2274 1017.6013,-15795.0235 1030.0095,-15708.7572 1056.6404,-15608.2589 1068.6228,-15565.2779"/>
<polygon fill="#00ff58" stroke="#00ff58" points="1072.0604,-15565.9826 1071.3999,-15555.4084 1065.322,-15564.0865 1072.0604,-15565.9826"/>
</g>
<!-- sourcefile~datadelight.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge920" class="edge">
<title>sourcefile~datadelight.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#b100ff" stroke-dasharray="5,2" d="M3630.0042,-18011.5186C3670.4633,-18009.9568 3731.209,-18002.1344 3773.6733,-17972.0235"/>
</g>
<!-- sourcefile~tarcogcomplexfenestration.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~EfferentGraph_edge937" class="edge">
<title>sourcefile~tarcogcomplexfenestration.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff00c7" stroke-dasharray="5,2" d="M409.0417,-18443.313C427.7628,-18463.5783 470.5247,-18505.4609 516.9653,-18521.0235 574.9128,-18540.4421 593.5489,-18525.8437 654.4731,-18521.0235 809.1085,-18508.7892 1219.1318,-18472.7923 1336.1997,-18371.0235 1362.0076,-18348.5884 1345.8038,-18324.7638 1372.1997,-18303.0235 1400.6065,-18279.627 1415.725,-18287.8652 1451.4485,-18279.0235"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefiledaylightingmanagerf90EfferentGraph = svgPanZoom('#sourcefiledaylightingmanagerf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~daylightingmanager.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefiledaylightingmanagerf90AfferentGraph" width="641pt" height="109pt"
 viewBox="0.00 0.00 641.00 108.59" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph" class="graph" transform="scale(.4918 .4918) rotate(0) translate(4 216.7985)">
<title>sourcefile~~daylightingmanager.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-216.7985 1299.384,-216.7985 1299.384,4 -4,4"/>
<!-- sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~daylightingmanager.f90</title>
<polygon fill="none" stroke="#000000" points="122.4908,-145.8039 -.1639,-145.8039 -.1639,-123.793 122.4908,-123.793 122.4908,-145.8039"/>
<text text-anchor="middle" x="61.1635" y="-131.6485" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">DaylightingManager.f90</text>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="705.7215,-126.8039 539.34,-126.8039 539.34,-104.793 705.7215,-104.793 705.7215,-126.8039"/>
<text text-anchor="middle" x="622.5308" y="-112.6485" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M97.7654,-145.8465C131.5085,-155.4187 183.1703,-168.5338 229.1188,-173.7985"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M229.1188,-173.7985C250.5764,-176.2571 398.0075,-136.3715 419.5481,-134.7985"/>
</g>
<!-- sourcefile~solarshading.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~solarshading.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/solarshading.f90.html" xlink:title="SolarShading.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465.609,-184.8039 373.4872,-184.8039 373.4872,-162.793 465.609,-162.793 465.609,-184.8039"/>
<text text-anchor="middle" x="419.5481" y="-170.6485" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SolarShading.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M229.1188,-173.7985C273.8531,-178.9241 324.8877,-178.5959 362.8573,-177.1662"/>
<polygon fill="#ff0000" stroke="#ff0000" points="363.3577,-180.6485 373.2042,-176.7373 363.0678,-173.6545 363.3577,-180.6485"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1295.195,-185.8039 1198.9527,-185.8039 1198.9527,-163.793 1295.195,-163.793 1295.195,-185.8039"/>
<text text-anchor="middle" x="1247.0739" y="-171.6485" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M229.1188,-173.7985C277.0931,-179.2953 288.0032,-187.7463 335.9106,-193.7985 462.5703,-209.7994 494.8645,-212.7985 622.5308,-212.7985 622.5308,-212.7985 622.5308,-212.7985 807.1282,-212.7985 896.7567,-212.7985 918.5136,-200.6195 1007.3591,-188.7985 1049.9707,-183.129 1060.1653,-177.5933 1103.0614,-174.7985"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~windowequivalentlayer.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/windowequivalentlayer.f90.html" xlink:title="WindowEquivalentLayer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="299.7031,-126.8039 158.5344,-126.8039 158.5344,-104.793 299.7031,-104.793 299.7031,-126.8039"/>
<text text-anchor="middle" x="229.1188" y="-112.6485" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowEquivalentLayer.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M122.7501,-127.8315C131.0942,-126.8875 139.7564,-125.9076 148.3731,-124.9329"/>
<polygon fill="#ff0000" stroke="#ff0000" points="148.9026,-128.3954 158.4458,-123.7934 148.1157,-121.4397 148.9026,-128.3954"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="872.1335,-108.8039 742.1228,-108.8039 742.1228,-86.793 872.1335,-86.793 872.1335,-108.8039"/>
<text text-anchor="middle" x="807.1282" y="-94.6485" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M705.9184,-107.6674C714.64,-106.817 723.4687,-105.9561 732.0892,-105.1155"/>
<polygon fill="#ff0000" stroke="#ff0000" points="732.4811,-108.594 742.0942,-104.1399 731.8017,-101.627 732.4811,-108.594"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1162.9666,-145.8039 1043.1562,-145.8039 1043.1562,-123.793 1162.9666,-123.793 1162.9666,-145.8039"/>
<text text-anchor="middle" x="1103.0614" y="-131.6485" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M705.9584,-119.0972C798.5098,-122.7566 946.2027,-128.5964 1032.9941,-132.028"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1032.8792,-135.5261 1043.0097,-132.4241 1033.1559,-128.5316 1032.8792,-135.5261"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M458.2054,-162.7526C491.1146,-153.3492 538.5554,-139.7935 574.0116,-129.6623"/>
<polygon fill="#7fff00" stroke="#7fff00" points="575.0187,-133.0147 583.6723,-126.9019 573.0954,-126.284 575.0187,-133.0147"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M957.8698,-174.7985C1022.2761,-170.8124 1038.6683,-178.9939 1103.0614,-174.7985"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1103.0614,-174.7985C1131.1439,-172.9688 1162.3722,-172.7481 1188.5511,-173.0752"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1188.6373,-176.5768 1198.6902,-173.2319 1188.7455,-169.5777 1188.6373,-176.5768"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M465.6307,-176.7769C506.8579,-178.7876 568.8841,-180.1997 622.5308,-174.7985"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M622.5308,-174.7985C682.8499,-168.7254 746.7513,-135.1237 781.295,-114.3656"/>
<polygon fill="#7fff00" stroke="#7fff00" points="783.5372,-117.0963 790.2322,-108.8849 779.8778,-111.129 783.5372,-117.0963"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M957.8698,-174.7985C995.6702,-172.2072 1037.1999,-159.7322 1066.1241,-149.3936"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1067.6182,-152.5737 1075.8024,-145.8455 1065.2087,-146.0014 1067.6182,-152.5737"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M622.5308,-174.7985C770.8206,-159.8683 809.1792,-184.9913 957.8698,-174.7985"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M287.3902,-126.8403C325.0514,-132.6834 375.1451,-138.0411 419.5481,-134.7985"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M419.5481,-134.7985C455.3715,-132.1824 494.6908,-128.6546 529.1048,-125.3492"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="529.5281,-128.8246 539.1446,-124.3779 528.854,-121.8572 529.5281,-128.8246"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M264.6908,-126.8808C285.4475,-133.325 312.1455,-141.575 335.9106,-148.7985 347.692,-152.3795 360.42,-156.2057 372.3068,-159.7607"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="371.4713,-163.1639 382.0547,-162.6718 373.4744,-156.4566 371.4713,-163.1639"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M239.3271,-104.6364C256.9544,-86.2284 295.1477,-50.0279 335.9106,-34.7985 455.5029,9.8823 496.5181,4.6832 622.5308,-15.7985"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M622.5308,-15.7985C682.985,-25.4732 746.8372,-60.0896 781.336,-81.1287"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="779.9191,-84.3688 790.2608,-86.6708 783.6119,-78.422 779.9191,-84.3688"/>
</g>
<!-- sourcefile~windowmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~windowmanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/windowmanager.f90.html" xlink:title="WindowManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="473.2738,-65.8039 365.8224,-65.8039 365.8224,-43.793 473.2738,-43.793 473.2738,-65.8039"/>
<text text-anchor="middle" x="419.5481" y="-51.6485" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M256.0408,-104.7544C277.461,-96.2016 308.3152,-84.4011 335.9106,-75.7985 344.2183,-73.2087 353.0651,-70.7123 361.778,-68.4004"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="362.721,-71.7717 371.5223,-65.8736 360.9639,-64.9959 362.721,-71.7717"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~heatbalanceintradexchange.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/heatbalanceintradexchange.f90.html" xlink:title="HeatBalanceIntRadExchange.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="503.3232,-106.8039 335.773,-106.8039 335.773,-84.793 503.3232,-84.793 503.3232,-106.8039"/>
<text text-anchor="middle" x="419.5481" y="-92.6485" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceIntRadExchange.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M299.757,-108.3796C308.2017,-107.4927 316.9233,-106.5767 325.6304,-105.6623"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="326.248,-109.1167 335.8276,-104.5913 325.5167,-102.155 326.248,-109.1167"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M842.1443,-86.713C882.6312,-75.624 950.9405,-62.2699 1007.3591,-77.7985 1035.3665,-85.5072 1063.4558,-103.794 1081.8883,-117.5913"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1079.8228,-120.4182 1089.8805,-123.7489 1084.095,-114.8731 1079.8228,-120.4182"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1007.3485,-108.8039 908.391,-108.8039 908.391,-86.793 1007.3485,-86.793 1007.3485,-108.8039"/>
<text text-anchor="middle" x="957.8698" y="-94.6485" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M872.3689,-97.7985C880.8543,-97.7985 889.5141,-97.7985 897.9076,-97.7985"/>
<polygon fill="#ff0000" stroke="#ff0000" points="897.9841,-101.2986 907.9841,-97.7985 897.984,-94.2986 897.9841,-101.2986"/>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1142.7947,-145.8345C1159.6539,-150.5173 1179.4892,-156.0266 1197.3093,-160.9762"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1196.3984,-164.3556 1206.9703,-163.6596 1198.2718,-157.6109 1196.3984,-164.3556"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~daylightingmanager.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1288.7824,-144.8039 1205.3653,-144.8039 1205.3653,-122.793 1288.7824,-122.793 1288.7824,-144.8039"/>
<text text-anchor="middle" x="1247.0739" y="-130.6485" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1162.8845,-134.3831C1173.5491,-134.309 1184.581,-134.2324 1195.0073,-134.16"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1195.2204,-137.6587 1205.1958,-134.0893 1195.1717,-130.6589 1195.2204,-137.6587"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1001.432,-108.8997C1016.7192,-112.7954 1034.063,-117.2152 1050.0397,-121.2867"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1049.2256,-124.691 1059.7802,-123.7689 1050.9542,-117.9078 1049.2256,-124.691"/>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M466.1722,-65.826C478.2753,-68.874 491.2597,-72.3084 503.1855,-75.7985 529.7948,-83.5856 559.3428,-93.479 582.3808,-101.4783"/>
<polygon fill="#ff0000" stroke="#ff0000" points="581.2332,-104.7847 591.8281,-104.7789 583.542,-98.1764 581.2332,-104.7847"/>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M459.6299,-43.702C509.4917,-30.4932 591.8041,-10.8043 622.5308,-15.7985"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~daylightingmanager.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M503.2808,-104.0487C511.8365,-104.8917 520.5659,-105.7518 529.2157,-106.6041"/>
<polygon fill="#00ffff" stroke="#00ffff" points="529.0229,-110.102 539.3179,-107.5995 529.7093,-103.1357 529.0229,-110.102"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefiledaylightingmanagerf90AfferentGraph = svgPanZoom('#sourcefiledaylightingmanagerf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/daylightingmanager.html">DaylightingManager</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html#src">DaylightingManager.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">DaylightingManager</span>
<a name="ln-2"></a>
<a name="ln-3"></a>          <span class="c">! MODULE INFORMATION</span>
<a name="ln-4"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-5"></a>          <span class="c">!       DATE WRITTEN   July 1997, December 1998</span>
<a name="ln-6"></a>          <span class="c">!       MODIFIED       Oct 2004; LKL -- Efficiencies and code restructure</span>
<a name="ln-7"></a>          <span class="c">!                      Aug 2012: BG -- Added availability schedule</span>
<a name="ln-8"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9"></a>
<a name="ln-10"></a>          <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-11"></a>          <span class="c">! Manages the daylighting calculations for each thermal zone that has an associated</span>
<a name="ln-12"></a>          <span class="c">! Daylighting:Controls object.</span>
<a name="ln-13"></a>
<a name="ln-14"></a>          <span class="c">! Includes calculation of interior daylight illuminance and glare</span>
<a name="ln-15"></a>          <span class="c">! from each of the windows in a zone, control of window shading devices</span>
<a name="ln-16"></a>          <span class="c">! to reduce glare, and control of overhead electric lighting in response</span>
<a name="ln-17"></a>          <span class="c">! to interior daylight illuminance level at one or two user-specified</span>
<a name="ln-18"></a>          <span class="c">! reference points at which sensors are located.</span>
<a name="ln-19"></a>
<a name="ln-20"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-21"></a>          <span class="c">!</span>
<a name="ln-22"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-23"></a>          <span class="c">! &quot;Daylighting Calculation in DOE-2,&quot; F.C.Winkelmann, LBL-11353, May 1983</span>
<a name="ln-24"></a>          <span class="c">! &quot;Daylighting Simulation in the DOE-2 Building Energy Analysis Program,&quot;</span>
<a name="ln-25"></a>          <span class="c">! F.C. Winkelmann and S. Selkowitz, Energy and Buildings 8(1985)271-286</span>
<a name="ln-26"></a>
<a name="ln-27"></a>          <span class="c">! OTHER NOTES:</span>
<a name="ln-28"></a>          <span class="c">! This module was created from DOE-2.1E subroutines.</span>
<a name="ln-29"></a>
<a name="ln-30"></a>          <span class="c">! Correspondence between DOE-2.1E and EnergyPlus subroutine names:</span>
<a name="ln-31"></a>
<a name="ln-32"></a>          <span class="c">! DOE-2.1E    EnergyPlus                      In Module           Called from Module</span>
<a name="ln-33"></a>          <span class="c">!</span>
<a name="ln-34"></a>          <span class="c">! DAVREF      DayltgAveInteriorReflectance    DaylightingManager DaylightingManager</span>
<a name="ln-35"></a>          <span class="c">! DCOF        CalcDayltgCoefficients          DaylightingManager DaylightingManager</span>
<a name="ln-36"></a>          <span class="c">! DCROSS      DayltgCrossProduct              DaylightingManager DaylightingManager</span>
<a name="ln-37"></a>          <span class="c">! DEXTIL      DayltgCurrentExtHorizIllum      WeatherManager     WeatherManager</span>
<a name="ln-38"></a>          <span class="c">! DGLARE      DayltgGlare                     DaylightingManager DaylightingManager</span>
<a name="ln-39"></a>          <span class="c">! DHILL       DayltgExtHorizIllum             DaylightingManager DaylightingManager</span>
<a name="ln-40"></a>          <span class="c">! DHITSH      DayltgHitObstruction            DaylightingManager DaylightingManager</span>
<a name="ln-41"></a>          <span class="c">! DINTIL      DayltgInteriorIllum             DaylightingManager HeatBalanceSurfaceManager</span>
<a name="ln-42"></a>          <span class="c">! DLTSYS      DayltgElecLightingControl       DaylightingManager HeatBalanceSurfaceManager</span>
<a name="ln-43"></a>          <span class="c">! DNSOL       not used</span>
<a name="ln-44"></a>          <span class="c">! DPFAC       DayltgPositionFactor            DaylightingManager DaylightingManager</span>
<a name="ln-45"></a>          <span class="c">! DPIERC      DayltgPierceSurface             DaylightingManager DaylightingManager</span>
<a name="ln-46"></a>          <span class="c">! DREFLT      DayltgInterReflectedIllum       DaylightingManager DaylightingManager</span>
<a name="ln-47"></a>          <span class="c">! DSKYLU      DayltgSkyLuminance              DaylightingManager DaylightingManager</span>
<a name="ln-48"></a>          <span class="c">! DTHLIM      DayltgAzimuthLimits             DaylightingManager DaylightingManager</span>
<a name="ln-49"></a>          <span class="c">! DLUMEF      DayltgLuminousEfficacy          WeatherManager     WeatherManager</span>
<a name="ln-50"></a>
<a name="ln-51"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-52"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-53"></a><span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-54"></a><span class="k">USE </span><span class="n">DataHeatBalance</span>
<a name="ln-55"></a><span class="k">USE </span><span class="n">DataSurfaces</span>
<a name="ln-56"></a><span class="k">USE </span><span class="n">DataEnvironment</span>
<a name="ln-57"></a><span class="k">USE </span><span class="n">DataDaylighting</span>
<a name="ln-58"></a><span class="k">USE </span><span class="n">DataDaylightingDevices</span>
<a name="ln-59"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-60"></a>
<a name="ln-61"></a><span class="k">USE </span><span class="n">ScheduleManager</span>
<a name="ln-62"></a><span class="c">!USE Vectors</span>
<a name="ln-63"></a>
<a name="ln-64"></a><span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-65"></a>
<a name="ln-66"></a><span class="k">PRIVATE</span>
<a name="ln-67"></a>
<a name="ln-68"></a>          <span class="c">! MODULE PARAMETER DEFINITIONS: na</span>
<a name="ln-69"></a>
<a name="ln-70"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-71"></a><span class="kt">INTEGER</span><span class="p">,</span><span class="k">PUBLIC</span>    <span class="kd">::</span> <span class="n">TotWindowsWithDayl</span>       <span class="o">=</span><span class="mi">0</span>    <span class="c">! Total number of exterior windows in all daylit zones</span>
<a name="ln-72"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OutputFileDFS</span>  <span class="o">=</span><span class="mi">0</span> <span class="c">! Unit number for daylight factors</span>
<a name="ln-73"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DaylIllum</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">)</span>  <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Daylight illuminance at reference points (lux)</span>
<a name="ln-74"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PHSUN</span>                    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Solar altitude (radians)</span>
<a name="ln-75"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SPHSUN</span>                   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sine of solar altitude</span>
<a name="ln-76"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CPHSUN</span>                   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Cosine of solar altitude</span>
<a name="ln-77"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">THSUN</span>                    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Solar azimuth (rad) in Absolute Coordinate System (azimuth=0 along east)</span>
<a name="ln-78"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PHSUNHR</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>              <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Hourly values of PHSUN</span>
<a name="ln-79"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SPHSUNHR</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>             <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Hourly values of the sine of PHSUN</span>
<a name="ln-80"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CPHSUNHR</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>             <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Hourly values of the cosine of PHSUN</span>
<a name="ln-81"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">THSUNHR</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>              <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Hourly values of THSUN</span>
<a name="ln-82"></a>
<a name="ln-83"></a><span class="c">! In the following I,J,K arrays:</span>
<a name="ln-84"></a><span class="c">! I = 1 for clear sky, 2 for clear turbid, 3 for intermediate, 4 for overcast;</span>
<a name="ln-85"></a><span class="c">! J = 1 for bare window, 2 - 12 for shaded;</span>
<a name="ln-86"></a><span class="c">! K = sun position index.</span>
<a name="ln-87"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EINTSK</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">)</span>  <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sky-related portion of internally reflected illuminance</span>
<a name="ln-88"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EINTSU</span><span class="p">(</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">)</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sun-related portion of internally reflected illuminance,</span>
<a name="ln-89"></a>                                               <span class="c">! excluding entering beam</span>
<a name="ln-90"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EINTSUdisk</span><span class="p">(</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sun-related portion of internally reflected illuminance</span>
<a name="ln-91"></a>                                               <span class="c">! due to entering beam</span>
<a name="ln-92"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WLUMSK</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">)</span>  <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sky-related window luminance</span>
<a name="ln-93"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WLUMSU</span><span class="p">(</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">)</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sun-related window luminance, excluding view of solar disk</span>
<a name="ln-94"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WLUMSUdisk</span><span class="p">(</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sun-related window luminance, due to view of solar disk</span>
<a name="ln-95"></a>
<a name="ln-96"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GILSK</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">24</span><span class="p">)</span>                 <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Horizontal illuminance from sky, by sky type, for each hour of the day</span>
<a name="ln-97"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GILSU</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>                   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Horizontal illuminance from sun for each hour of the day</span>
<a name="ln-98"></a>
<a name="ln-99"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EDIRSK</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">)</span>   <span class="c">! Sky-related component of direct illuminance</span>
<a name="ln-100"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EDIRSU</span><span class="p">(</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">)</span>     <span class="c">! Sun-related component of direct illuminance (excluding beam solar at ref pt)</span>
<a name="ln-101"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EDIRSUdisk</span><span class="p">(</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">)</span> <span class="c">! Sun-related component of direct illuminance due to beam solar at ref pt</span>
<a name="ln-102"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AVWLSK</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">)</span>   <span class="c">! Sky-related average window luminance</span>
<a name="ln-103"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AVWLSU</span><span class="p">(</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">)</span>     <span class="c">! Sun-related average window luminance, excluding view of solar disk</span>
<a name="ln-104"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AVWLSUdisk</span><span class="p">(</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">)</span> <span class="c">! Sun-related average window luminance due to view of solar disk</span>
<a name="ln-105"></a>
<a name="ln-106"></a><span class="c">!! Allocatable daylight factor arrays  -- are in the ZoneDaylight Structure</span>
<a name="ln-107"></a>
<a name="ln-108"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">TDDTransVisBeam</span><span class="p">(:,:)</span>
<a name="ln-109"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">TDDFluxInc</span><span class="p">(:,:,:)</span>
<a name="ln-110"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">TDDFluxTrans</span><span class="p">(:,:,:)</span>
<a name="ln-111"></a>
<a name="ln-112"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">MapErrIndex</span>
<a name="ln-113"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">RefErrIndex</span>
<a name="ln-114"></a>
<a name="ln-115"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckTDDZone</span>
<a name="ln-116"></a>
<a name="ln-117"></a>
<a name="ln-118"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">2500</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mapLine</span>   <span class="c">! character variable to hold map outputs</span>
<a name="ln-119"></a>
<a name="ln-120"></a><span class="k">PUBLIC </span><span class="n">DayltgInteriorIllum</span>
<a name="ln-121"></a><span class="k">PUBLIC </span><span class="n">DayltgInteriorTDDIllum</span>
<a name="ln-122"></a><span class="k">PUBLIC </span><span class="n">DayltgElecLightingControl</span>
<a name="ln-123"></a><span class="k">PUBLIC </span><span class="n">CalcDayltgCoefficients</span>
<a name="ln-124"></a><span class="k">PUBLIC </span><span class="n">ProfileAngle</span>
<a name="ln-125"></a><span class="k">PUBLIC </span><span class="n">CloseReportIllumMaps</span>
<a name="ln-126"></a><span class="k">PUBLIC </span><span class="n">CloseDFSFile</span>
<a name="ln-127"></a><span class="k">PUBLIC </span><span class="n">DayltgInterReflIllFrIntWins</span>
<a name="ln-128"></a><span class="k">PUBLIC </span><span class="n">DayltgGlareWithIntWins</span>
<a name="ln-129"></a><span class="k">PUBLIC </span><span class="n">ReportIllumMap</span>
<a name="ln-130"></a>
<a name="ln-131"></a><span class="k">PUBLIC </span><span class="n">DayltgInteriorMapIllum</span>
<a name="ln-132"></a>
<a name="ln-133"></a><span class="k">PRIVATE </span><span class="n">DayltgAveInteriorReflectance</span>
<a name="ln-134"></a><span class="k">PRIVATE </span><span class="n">GetDaylightingParametersDetaild</span>
<a name="ln-135"></a><span class="k">PRIVATE </span><span class="n">DayltgGlare</span>
<a name="ln-136"></a><span class="k">PRIVATE </span><span class="n">DayltgExtHorizIllum</span>
<a name="ln-137"></a><span class="k">PRIVATE </span><span class="n">DayltgPierceSurface</span>
<a name="ln-138"></a><span class="k">PRIVATE </span><span class="n">DayltgHitObstruction</span>
<a name="ln-139"></a><span class="k">PRIVATE </span><span class="n">DayltgHitInteriorObstruction</span>
<a name="ln-140"></a><span class="k">PRIVATE </span><span class="n">DayltgInterReflectedIllum</span>
<a name="ln-141"></a><span class="k">PRIVATE </span><span class="n">DayltgSkyLuminance</span>
<a name="ln-142"></a><span class="k">PRIVATE </span><span class="n">DayltgCrossProduct</span>
<a name="ln-143"></a><span class="k">PRIVATE </span><span class="n">DayltgSetupAdjZoneListsAndPointers</span>
<a name="ln-144"></a><span class="k">PRIVATE </span><span class="n">CheckForGeometricTransform</span>
<a name="ln-145"></a><span class="k">PRIVATE </span><span class="n">CalcDayltgCoeffsRefMapPoints</span>
<a name="ln-146"></a><span class="k">PRIVATE </span><span class="n">CalcDayltgCoeffsRefPoints</span>
<a name="ln-147"></a><span class="k">PRIVATE </span><span class="n">CalcDayltgCoeffsMapPoints</span>
<a name="ln-148"></a><span class="k">PRIVATE </span><span class="n">FigureDayltgCoeffsAtPointsSetupForWindow</span>
<a name="ln-149"></a><span class="k">PRIVATE </span><span class="n">FigureDayltgCoeffsAtPointsForWindowElements</span>
<a name="ln-150"></a><span class="k">PRIVATE </span><span class="n">FigureDayltgCoeffsAtPointsForSunPosition</span>
<a name="ln-151"></a><span class="k">PRIVATE </span><span class="n">FigureRefPointDayltgFactorsToAddIllums</span>
<a name="ln-152"></a><span class="k">PRIVATE </span><span class="n">FigureMapPointDayltgFactorsToAddIllums</span>
<a name="ln-153"></a><span class="k">PRIVATE </span><span class="n">DayltgInterReflectedIllumComplexFenestration</span>
<a name="ln-154"></a><span class="k">PRIVATE </span><span class="n">ComplexFenestrationLuminances</span>
<a name="ln-155"></a><span class="k">PRIVATE </span><span class="n">InitializeCFSDaylighting</span>
<a name="ln-156"></a><span class="k">PRIVATE </span><span class="n">CalcObstrMultiplier</span>
<a name="ln-157"></a>
<a name="ln-158"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE DaylightingModule</span>
<a name="ln-159"></a><span class="k">CONTAINS</span>
<a name="ln-160"></a>
<a name="ln-161"></a>          <span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-162"></a>
<a name="ln-163"></a><span class="k">SUBROUTINE </span><span class="n">DayltgAveInteriorReflectance</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-164"></a>
<a name="ln-165"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-166"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-167"></a>          <span class="c">!       DATE WRITTEN   July 1997</span>
<a name="ln-168"></a>          <span class="c">!       MODIFIED       Mar 2004, FCW: add calculation of following SurfaceWindow variables:</span>
<a name="ln-169"></a>          <span class="c">!                        ZoneAreaMinusThisSurf, ZoneAreaReflProdMinusThisSurf, RhoCeilingWall,</span>
<a name="ln-170"></a>          <span class="c">!                        RhoFloorWall, FractionUpgoing. Add calculation of ZoneDaylight%FloorVisRefl.</span>
<a name="ln-171"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-172"></a>
<a name="ln-173"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-174"></a>          <span class="c">! Called by CalcDayltgCoefficients for each daylit zone. Determines total</span>
<a name="ln-175"></a>          <span class="c">! area and area-weighted average visible reflectance of</span>
<a name="ln-176"></a>          <span class="c">! all inside faces of the surfaces of a zone.  In addition, finds</span>
<a name="ln-177"></a>          <span class="c">! area and average reflectance of interzone, underground and exterior</span>
<a name="ln-178"></a>          <span class="c">! heat-transfer surfaces in the following categories: floor (tilt &gt; 170 deg),</span>
<a name="ln-179"></a>          <span class="c">! ceiling (tilt &lt; 10 deg), and wall (10 &lt; tilt &lt; 170 deg).</span>
<a name="ln-180"></a>          <span class="c">! The window reflectance values used here assume the windows have no shading</span>
<a name="ln-181"></a>          <span class="c">! devices. This information is used in the calculation of the</span>
<a name="ln-182"></a>          <span class="c">! internally-reflected daylighting component.</span>
<a name="ln-183"></a>
<a name="ln-184"></a>          <span class="c">! Finds total number of exterior windows in the space.</span>
<a name="ln-185"></a>
<a name="ln-186"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-187"></a>          <span class="c">! na</span>
<a name="ln-188"></a>
<a name="ln-189"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-190"></a>          <span class="c">! Based on DOE-2.1E subroutine DAVREF</span>
<a name="ln-191"></a>
<a name="ln-192"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-193"></a>          <span class="c">! na</span>
<a name="ln-194"></a>
<a name="ln-195"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-196"></a>
<a name="ln-197"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-198"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ZoneNum</span>        <span class="c">! Zone number</span>
<a name="ln-199"></a>
<a name="ln-200"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-201"></a>          <span class="c">! na</span>
<a name="ln-202"></a>
<a name="ln-203"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-204"></a>          <span class="c">! na</span>
<a name="ln-205"></a>
<a name="ln-206"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-207"></a>          <span class="c">! na</span>
<a name="ln-208"></a>
<a name="ln-209"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-210"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IType</span>          <span class="c">! Surface type/class</span>
<a name="ln-211"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AREA</span>           <span class="c">! Inside surface area (m2)</span>
<a name="ln-212"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AInsTot</span>        <span class="c">! Total inside surface area of a zone (m2)</span>
<a name="ln-213"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ARHTOT</span>         <span class="c">! Sum over surfaces of AREA*(inside visible reflectance) (m2)</span>
<a name="ln-214"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ISurf</span>          <span class="c">! Surface number</span>
<a name="ln-215"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IWin</span>           <span class="c">! Window number</span>
<a name="ln-216"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ITILT</span>          <span class="c">! Surface tilt category (1 = floor, 2 = wall, 3 = ceiling)</span>
<a name="ln-217"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IT</span>             <span class="c">! Tilt index</span>
<a name="ln-218"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AR</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>          <span class="c">! Inside surface area sum for floor/wall/ceiling (m2)</span>
<a name="ln-219"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ARH</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>         <span class="c">! Inside surface area*reflectance sum for floor/wall/ceiling (m2)</span>
<a name="ln-220"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>          <span class="c">! Zone inside surface floor/wall/ceiling area without a selected</span>
<a name="ln-221"></a>                              <span class="c">!  floor/wall/ceiling (m2)</span>
<a name="ln-222"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ARHP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>        <span class="c">! Zone inside surface floor/wall/ceiling area*reflectance without</span>
<a name="ln-223"></a>                              <span class="c">!  a selected floor/wall/ceiling (m2)</span>
<a name="ln-224"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ATWL</span>           <span class="c">! Opaque surface area (m2)</span>
<a name="ln-225"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ARHTWL</span>         <span class="c">! ATWL times inside visible reflectance of surface (m2)</span>
<a name="ln-226"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IWinDr</span>         <span class="c">! Window/door surface number</span>
<a name="ln-227"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ETA</span>            <span class="c">! Ratio of floor-to-window-center height and average floor-to-ceiling height</span>
<a name="ln-228"></a>
<a name="ln-229"></a>
<a name="ln-230"></a>
<a name="ln-231"></a>          <span class="c">! FLOW:</span>
<a name="ln-232"></a>
<a name="ln-233"></a>  <span class="c">! Total inside surface area, including windows</span>
<a name="ln-234"></a>  <span class="n">AInsTOT</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-235"></a>  <span class="c">! Sum of products of inside surface area * vis reflectance</span>
<a name="ln-236"></a>  <span class="n">ARHTOT</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-237"></a>  <span class="c">! Area sum and area * reflectance sum for different orientations</span>
<a name="ln-238"></a>  <span class="n">AR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-239"></a>  <span class="n">ARH</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-240"></a>  <span class="c">! Loop over surfaces</span>
<a name="ln-241"></a>  <span class="k">DO </span><span class="n">ISurf</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-242"></a>    <span class="n">IType</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="k">Class</span>
<a name="ln-243"></a>    <span class="c">! Error if window has multiplier &gt; 1 since this causes incorrect illuminance calc</span>
<a name="ln-244"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IType</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-245"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-246"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;DayltgAveInteriorReflectance: Multiplier &gt; 1.0 for window &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-247"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; in Zone=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-248"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...not allowed since it is in a zone with daylighting.&#39;</span><span class="p">)</span>
<a name="ln-249"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Progrem terminates due to preceding conditions.&#39;</span><span class="p">)</span>
<a name="ln-250"></a>      <span class="k">ELSE</span>
<a name="ln-251"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;DayltgAveInteriorReflectance: Multiplier &gt; 1.0 for window &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-252"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; in Zone=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-253"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...an adjacent Zone has daylighting. Simulation cannot proceed.&#39;</span><span class="p">)</span>
<a name="ln-254"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Progrem terminates due to preceding conditions.&#39;</span><span class="p">)</span>
<a name="ln-255"></a>      <span class="n">ENDIF</span>
<a name="ln-256"></a>    <span class="n">ENDIF</span>
<a name="ln-257"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IType</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">IType</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">IType</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span> <span class="p">&amp;</span>
<a name="ln-258"></a>      <span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">IType</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">IType</span> <span class="o">==</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-259"></a><span class="k">      </span><span class="n">AREA</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-260"></a>      <span class="c">! In following, FrameArea and DividerArea can be non-zero only for exterior windows</span>
<a name="ln-261"></a>      <span class="n">AInsTOT</span> <span class="o">=</span> <span class="n">AInsTOT</span> <span class="o">+</span> <span class="n">AREA</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">FrameArea</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">+</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ProjCorrFrIn</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-262"></a>            <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">DividerArea</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">+</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ProjCorrDivIn</span><span class="p">)</span>
<a name="ln-263"></a>      <span class="n">ARHTOT</span> <span class="o">=</span> <span class="n">ARHTOT</span> <span class="o">+</span> <span class="n">AREA</span> <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">ReflectVisDiffBack</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-264"></a>                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">FrameArea</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">+</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ProjCorrFrIn</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-265"></a>                 <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">FrameSolAbsorp</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-266"></a>                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">DividerArea</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">+</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ProjCorrDivIn</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-267"></a>                 <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">DividerSolAbsorp</span><span class="p">)</span>
<a name="ln-268"></a>      <span class="n">ITILT</span> <span class="o">=</span> <span class="mi">3</span> <span class="c">! Ceiling</span>
<a name="ln-269"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">17</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="n">ITILT</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! Wall</span>
<a name="ln-270"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">17</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="n">ITILT</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! Floor</span>
<a name="ln-271"></a>      <span class="n">AR</span><span class="p">(</span><span class="n">ITILT</span><span class="p">)</span> <span class="o">=</span> <span class="n">AR</span><span class="p">(</span><span class="n">ITILT</span><span class="p">)</span> <span class="o">+</span> <span class="n">AREA</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-272"></a>                     <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">FrameArea</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">+</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ProjCorrFrIn</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-273"></a>                     <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">DividerArea</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">+</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ProjCorrDivIn</span><span class="p">)</span>
<a name="ln-274"></a>      <span class="n">ARH</span><span class="p">(</span><span class="n">ITILT</span><span class="p">)</span> <span class="o">=</span> <span class="n">ARH</span><span class="p">(</span><span class="n">ITILT</span><span class="p">)</span> <span class="o">+</span> <span class="n">AREA</span><span class="o">*</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">ReflectVisDiffBack</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-275"></a>                     <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">FrameArea</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">+</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ProjCorrFrIn</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-276"></a>                     <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">FrameSolAbsorp</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-277"></a>                     <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">DividerArea</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">+</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ProjCorrDivIn</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-278"></a>                     <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">DividerSolAbsorp</span><span class="p">)</span>
<a name="ln-279"></a>
<a name="ln-280"></a>    <span class="k">END IF</span>
<a name="ln-281"></a><span class="k">  END DO</span>
<a name="ln-282"></a>
<a name="ln-283"></a>  <span class="c">! Average inside surface reflectance of zone</span>
<a name="ln-284"></a>  <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span>  <span class="o">=</span> <span class="n">ARHTOT</span> <span class="o">/</span> <span class="n">AInsTOT</span>
<a name="ln-285"></a>  <span class="c">! Total inside surface area of zone</span>
<a name="ln-286"></a>  <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotInsSurfArea</span> <span class="o">=</span> <span class="n">AInsTOT</span>
<a name="ln-287"></a>  <span class="c">! Average floor visible reflectance</span>
<a name="ln-288"></a>  <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorVisRefl</span> <span class="o">=</span> <span class="n">ARH</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">AR</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.d-6</span><span class="p">)</span>
<a name="ln-289"></a>
<a name="ln-290"></a>  <span class="k">DO </span><span class="n">ISurf</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-291"></a>    <span class="n">IType</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="k">Class</span>
<a name="ln-292"></a><span class="k">    IF</span><span class="p">(</span><span class="n">IType</span> <span class="o">==</span> <span class="n">SurfaceClass_Wall</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">IType</span> <span class="o">==</span> <span class="n">SurfaceClass_Floor</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">IType</span> <span class="o">==</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-293"></a>      <span class="c">! Remove this surface from the zone inside surface area and area*reflectivity</span>
<a name="ln-294"></a>      <span class="c">! The resulting areas are AP(ITILT). The resulting area*reflectivity is ARHP(ITILT).</span>
<a name="ln-295"></a>      <span class="c">! Initialize gross area of surface (including subsurfaces)</span>
<a name="ln-296"></a>      <span class="n">ATWL</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Area</span> <span class="c">! This is the surface area less subsurfaces</span>
<a name="ln-297"></a>      <span class="c">! Area * reflectance for this surface, excluding attached windows and doors</span>
<a name="ln-298"></a>      <span class="n">ARHTWL</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">ReflectVisDiffBack</span>
<a name="ln-299"></a>      <span class="c">! Tilt index</span>
<a name="ln-300"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="mf">5.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">13</span><span class="mf">5.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-301"></a><span class="k">        </span><span class="n">ITILT</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! Wall</span>
<a name="ln-302"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;=</span> <span class="mi">13</span><span class="mf">5.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-303"></a><span class="k">        </span><span class="n">ITILT</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! Floor</span>
<a name="ln-304"></a>      <span class="k">ELSE</span>
<a name="ln-305"></a><span class="k">        </span><span class="n">ITILT</span> <span class="o">=</span> <span class="mi">3</span> <span class="c">! Ceiling</span>
<a name="ln-306"></a>      <span class="k">END IF</span>
<a name="ln-307"></a>      <span class="c">! Loop over windows and doors on this wall</span>
<a name="ln-308"></a>      <span class="k">DO </span><span class="n">IWinDr</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-309"></a>        <span class="k">IF</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWinDr</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWinDr</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-310"></a>              <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWinDr</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">ISurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-311"></a><span class="k">          </span><span class="n">ATWL</span>   <span class="o">=</span> <span class="n">ATWL</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWinDr</span><span class="p">)%</span><span class="n">Area</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-312"></a>                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWinDr</span><span class="p">)%</span><span class="n">FrameArea</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">+</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWinDr</span><span class="p">)%</span><span class="n">ProjCorrFrIn</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-313"></a>                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWinDr</span><span class="p">)%</span><span class="n">DividerArea</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">+</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWinDr</span><span class="p">)%</span><span class="n">ProjCorrDivIn</span><span class="p">)</span>
<a name="ln-314"></a>          <span class="n">ARHTWL</span> <span class="o">=</span> <span class="n">ARHTWL</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWinDr</span><span class="p">)%</span><span class="n">Area</span><span class="o">*</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWinDr</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">ReflectVisDiffBack</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-315"></a>                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWinDr</span><span class="p">)%</span><span class="n">FrameArea</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">+</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWinDr</span><span class="p">)%</span><span class="n">ProjCorrFrIn</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-316"></a>                    <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWinDr</span><span class="p">)%</span><span class="n">FrameSolAbsorp</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-317"></a>                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWinDr</span><span class="p">)%</span><span class="n">DividerArea</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">+</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWinDr</span><span class="p">)%</span><span class="n">ProjCorrDivIn</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-318"></a>                    <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWinDr</span><span class="p">)%</span><span class="n">DividerSolAbsorp</span><span class="p">)</span>
<a name="ln-319"></a>        <span class="k">END IF</span>
<a name="ln-320"></a><span class="k">      END DO</span>
<a name="ln-321"></a>      <span class="c">! Inside surface area of floor, walls and ceilings, minus surface ISurf and its subsurfaces</span>
<a name="ln-322"></a>      <span class="k">DO </span><span class="n">IT</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-323"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">IT</span> <span class="o">==</span> <span class="n">ITILT</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-324"></a><span class="k">          </span><span class="n">AP</span><span class="p">(</span><span class="n">IT</span><span class="p">)</span> <span class="o">=</span> <span class="n">AR</span><span class="p">(</span><span class="n">IT</span><span class="p">)</span> <span class="o">-</span> <span class="n">ATWL</span>
<a name="ln-325"></a>          <span class="n">ARHP</span><span class="p">(</span><span class="n">IT</span><span class="p">)</span> <span class="o">=</span> <span class="n">ARH</span><span class="p">(</span><span class="n">IT</span><span class="p">)</span> <span class="o">-</span> <span class="n">ARHTWL</span>
<a name="ln-326"></a>        <span class="k">ELSE</span>
<a name="ln-327"></a><span class="k">          </span><span class="n">AP</span><span class="p">(</span><span class="n">IT</span><span class="p">)</span> <span class="o">=</span> <span class="n">AR</span><span class="p">(</span><span class="n">IT</span><span class="p">)</span>
<a name="ln-328"></a>          <span class="n">ARHP</span><span class="p">(</span><span class="n">IT</span><span class="p">)</span> <span class="o">=</span> <span class="n">ARH</span><span class="p">(</span><span class="n">IT</span><span class="p">)</span>
<a name="ln-329"></a>        <span class="k">END IF</span>
<a name="ln-330"></a><span class="k">      END DO</span>
<a name="ln-331"></a><span class="k">      </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ZoneAreaMinusThisSurf</span> <span class="o">=</span> <span class="n">AP</span>
<a name="ln-332"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ZoneAreaReflProdMinusThisSurf</span> <span class="o">=</span> <span class="n">ARHP</span>
<a name="ln-333"></a>    <span class="k">END IF</span>
<a name="ln-334"></a><span class="k">  END DO</span> <span class="c">! End of loop over opaque surfaces in zone</span>
<a name="ln-335"></a>
<a name="ln-336"></a>  <span class="k">DO </span><span class="n">IWin</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-337"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-338"></a><span class="k">      </span><span class="n">ISurf</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">BaseSurf</span>
<a name="ln-339"></a>      <span class="c">! Ratio of floor-to-window-center height and average floor-to-ceiling height</span>
<a name="ln-340"></a>      <span class="n">ETA</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WinCenter</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">OriginZ</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-341"></a>              <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span> <span class="o">/</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Volume</span><span class="p">))</span>
<a name="ln-342"></a>      <span class="n">AP</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ZoneAreaMinusThisSurf</span>
<a name="ln-343"></a>      <span class="n">ARHP</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ZoneAreaReflProdMinusThisSurf</span>
<a name="ln-344"></a>      <span class="c">! Average reflectance seen by light moving up (RhoCeilingWall) and down (RhoFloorWall)</span>
<a name="ln-345"></a>      <span class="c">! across horizontal plane through center of window</span>
<a name="ln-346"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">RhoCeilingWall</span> <span class="o">=</span> <span class="p">(</span><span class="n">ARHP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">ETA</span><span class="p">)</span> <span class="o">+</span> <span class="n">ARHP</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">AP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">ETA</span><span class="p">)</span> <span class="o">+</span> <span class="n">AP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0d-5</span><span class="p">)</span>
<a name="ln-347"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">RhoFloorWall</span>   <span class="o">=</span> <span class="p">(</span><span class="n">ARHP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">ETA</span> <span class="o">+</span> <span class="n">ARHP</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">AP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">ETA</span> <span class="o">+</span> <span class="n">AP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.d-9</span><span class="p">)</span>
<a name="ln-348"></a>
<a name="ln-349"></a>      <span class="c">! Angle factor for windows with diffusing shades. SurfaceWindow(IWin)%FractionUpgoing is</span>
<a name="ln-350"></a>      <span class="c">! fraction of light from the shade that goes up toward ceiling and upper part of walls.</span>
<a name="ln-351"></a>      <span class="c">! 1 - SurfaceWindow(IWin)%FractionUpgoing is fraction that goes down toward floor and lower part of walls.</span>
<a name="ln-352"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Tilt</span><span class="o">/</span><span class="mi">18</span><span class="mf">0.0d0</span>
<a name="ln-353"></a>
<a name="ln-354"></a>      <span class="c">! Daylighting shelf simplication:  All light goes up to the ceiling regardless of orientation of shelf</span>
<a name="ln-355"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Shelf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-356"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Shelf</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Shelf</span><span class="p">)%</span><span class="n">InSurf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-357"></a>      <span class="k">END IF</span>
<a name="ln-358"></a><span class="k">    END IF</span>
<a name="ln-359"></a><span class="k">  END DO</span>
<a name="ln-360"></a>
<a name="ln-361"></a><span class="k">  RETURN</span>
<a name="ln-362"></a>
<a name="ln-363"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgAveInteriorReflectance</span>
<a name="ln-364"></a>
<a name="ln-365"></a>
<a name="ln-366"></a><span class="k">SUBROUTINE </span><span class="n">CalcDayltgCoefficients</span>
<a name="ln-367"></a>
<a name="ln-368"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-369"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-370"></a>          <span class="c">!       DATE WRITTEN   July 1997</span>
<a name="ln-371"></a>          <span class="c">!       MODIFIED       FW, Jan 2002: add variable slat angle blinds</span>
<a name="ln-372"></a>          <span class="c">!                      FW, Mar 2002: add triangular windows</span>
<a name="ln-373"></a>          <span class="c">!                      FW, Oct 2002: remove warning on window discretization relative to</span>
<a name="ln-374"></a>          <span class="c">!                                    reference point distance to window plane</span>
<a name="ln-375"></a>          <span class="c">!                      FW, Jan 2003: add between-glass shades and blinds</span>
<a name="ln-376"></a>          <span class="c">!                      FW, Apr 2003: initialize shading type to &#39;NOSHADE&#39; in window loop</span>
<a name="ln-377"></a>          <span class="c">!                      PE, May 2003: add light pipes (tubular daylighting devices)</span>
<a name="ln-378"></a>          <span class="c">!                      FW, Jul 2003: account for possible non-zero transmittance of</span>
<a name="ln-379"></a>          <span class="c">!                                    shading surfaces (previously all shading surfaces were</span>
<a name="ln-380"></a>          <span class="c">!                                    assumed to be opaque)</span>
<a name="ln-381"></a>          <span class="c">!                      PE, Aug 2003: add daylighting shelves</span>
<a name="ln-382"></a>          <span class="c">!                      FW, Sep 2003: write the bare-window overcast sky daylight factors to the eio file</span>
<a name="ln-383"></a>          <span class="c">!                      FW, Nov 2003: add exterior beam and sky solar diffuse reflection from obstructions;</span>
<a name="ln-384"></a>          <span class="c">!                                    add beam solar and sky solar reflection from ground with obstructions.</span>
<a name="ln-385"></a>          <span class="c">!                      FW, Nov 2003: change expression for NDIVX, NDIVY (no. of window elements in X,Y) to</span>
<a name="ln-386"></a>          <span class="c">!                                    round up to nearest integer rather than down</span>
<a name="ln-387"></a>          <span class="c">!                      FW, Nov 2003: add specular reflection of beam solar from obstructions</span>
<a name="ln-388"></a>          <span class="c">!                      RJH, Jan 2004: add alternative daylighting analysis using DElight</span>
<a name="ln-389"></a>          <span class="c">!                                     All modifications demarked with RJH (Rob Hitchcock)</span>
<a name="ln-390"></a>          <span class="c">!                      FW, Feb 2004: add daylighting through interior windows</span>
<a name="ln-391"></a>          <span class="c">!                      FW, Apr 2004: add light well efficiency that multiplies glazing transmittance</span>
<a name="ln-392"></a>          <span class="c">!                      FW, Apr 2004: add diffusing glazing</span>
<a name="ln-393"></a>          <span class="c">!                      RJH, Jul 2004: add error handling for warnings/errors returned from DElight</span>
<a name="ln-394"></a>          <span class="c">!                      LKL, Oct 2004: Separate &quot;map&quot; and &quot;ref&quot; point calculations -- move some input routines to</span>
<a name="ln-395"></a>          <span class="c">!                                     separate routines.</span>
<a name="ln-396"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-397"></a>
<a name="ln-398"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-399"></a>          <span class="c">! Calculates daylighting factors for later use in the time-step loop.</span>
<a name="ln-400"></a>
<a name="ln-401"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-402"></a>
<a name="ln-403"></a>          <span class="c">! For each combination of exterior window and reference point in a zone,</span>
<a name="ln-404"></a>          <span class="c">! calculates daylighting factors (interior illuminance / exterior illuminance)</span>
<a name="ln-405"></a>          <span class="c">! and glare factors for clear and overcast skies and for windows with and</span>
<a name="ln-406"></a>          <span class="c">! without shading devices. These factors are calculated for each hourly</span>
<a name="ln-407"></a>          <span class="c">! sun position for design days and for selected days throughout the year.</span>
<a name="ln-408"></a>
<a name="ln-409"></a>          <span class="c">! If a target zone has one or more interior windows, also calculates daylighting</span>
<a name="ln-410"></a>          <span class="c">! factors for the target zone that are associated with exterior windows in adjacent</span>
<a name="ln-411"></a>          <span class="c">! zones that share interior windows with the target zone.</span>
<a name="ln-412"></a>
<a name="ln-413"></a>          <span class="c">! The daylight illuminance at a reference point from a window is determined</span>
<a name="ln-414"></a>          <span class="c">! by dividing the window into rectangular elements and calculating the illuminance</span>
<a name="ln-415"></a>          <span class="c">! reaching the reference point directly from each element. The illumination</span>
<a name="ln-416"></a>          <span class="c">! from an element can come from the sky or ground if the window is unshaded, or from</span>
<a name="ln-417"></a>          <span class="c">! a shading device illuminated by solar radiation. Also considered are the</span>
<a name="ln-418"></a>          <span class="c">! illuminance contribution from interreflection among the zone&#39;s interior surfaces</span>
<a name="ln-419"></a>          <span class="c">! and sunlight striking the reference point.</span>
<a name="ln-420"></a>
<a name="ln-421"></a>          <span class="c">! In calculating sky-related interior illuminance and luminance quantities,</span>
<a name="ln-422"></a>          <span class="c">! the sky luminance for the different sky types are determined from distributions</span>
<a name="ln-423"></a>          <span class="c">! in which the zenith luminance is normalized to 1.0 cd/m2. Similarly, sun-related</span>
<a name="ln-424"></a>          <span class="c">! illuminance and luminance quantities are based on beam normal solar illuminance</span>
<a name="ln-425"></a>          <span class="c">! normalized to 1.0 lux.</span>
<a name="ln-426"></a>          <span class="c">!</span>
<a name="ln-427"></a>          <span class="c">! The daylight and glare factors calculated in this subroutine are used in DayltgInteriorIllum</span>
<a name="ln-428"></a>          <span class="c">! to get the daylight illuminance and glare at each time step.</span>
<a name="ln-429"></a>          <span class="c">! Based on this information and user-input lighting setpoint and type of lighting</span>
<a name="ln-430"></a>          <span class="c">! control system, DayltgElecLightingControl then determines how much the overhead eletric lighting</span>
<a name="ln-431"></a>          <span class="c">! can be reduced.</span>
<a name="ln-432"></a>
<a name="ln-433"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-434"></a>          <span class="c">! Based on DOE-2.1E subroutine DCOF.</span>
<a name="ln-435"></a>
<a name="ln-436"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-437"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>                <span class="n">ONLY</span><span class="p">:</span> <span class="n">POLYF</span><span class="p">,</span> <span class="n">InterpProfAng</span><span class="p">,</span> <span class="n">BlindBeamBeamTrans</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-438"></a>  <span class="k">USE </span><span class="n">DaylightingDevices</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindTDDPipe</span><span class="p">,</span> <span class="n">TransTDD</span>
<a name="ln-439"></a>  <span class="k">USE </span><span class="n">SolarReflectionManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolReflRecSurf</span>
<a name="ln-440"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">DetailedSolarTimestepIntegration</span>
<a name="ln-441"></a>
<a name="ln-442"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-443"></a>
<a name="ln-444"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-445"></a>          <span class="c">! na</span>
<a name="ln-446"></a>
<a name="ln-447"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-448"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">fmtA</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span>
<a name="ln-449"></a>
<a name="ln-450"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-451"></a>          <span class="c">! na</span>
<a name="ln-452"></a>
<a name="ln-453"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-454"></a>          <span class="c">! na</span>
<a name="ln-455"></a>
<a name="ln-456"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-457"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ZoneNum</span>                      <span class="c">! Zone number</span>
<a name="ln-458"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">IHR</span>                          <span class="c">! Hour of day counter</span>
<a name="ln-459"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">IWin</span>                         <span class="c">! Window counter</span>
<a name="ln-460"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">Loop</span>             <span class="c">! DO loop indices</span>
<a name="ln-461"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>     <span class="kd">::</span> <span class="n">FirstTime</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-462"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>     <span class="kd">::</span> <span class="n">FirstTimeDaylFacCalc</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-463"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">DaylFac1</span> <span class="c">! sky daylight factor at ref pt 1</span>
<a name="ln-464"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">DaylFac2</span> <span class="c">! sky daylight factor at ref pt 2</span>
<a name="ln-465"></a>
<a name="ln-466"></a>  <span class="c">! added for output all daylight factors</span>
<a name="ln-467"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">EXTERNAL</span> <span class="kd">::</span> <span class="n">GetNewUnitNumber</span>  <span class="c">! External  function to &quot;get&quot; a unit number</span>
<a name="ln-468"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">write_stat</span>
<a name="ln-469"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">DFClrSky1</span><span class="p">,</span><span class="n">DFClrTbSky1</span><span class="p">,</span><span class="n">DFIntSky1</span><span class="p">,</span><span class="n">DFOcSky1</span><span class="p">,</span><span class="n">DFClrSky2</span><span class="p">,</span><span class="n">DFClrTbSky2</span><span class="p">,</span><span class="n">DFIntSky2</span><span class="p">,</span><span class="n">DFOcSky2</span>
<a name="ln-470"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">SlatAngle</span>
<a name="ln-471"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ISA</span><span class="p">,</span> <span class="n">ICtrl</span>
<a name="ln-472"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ISlatAngle</span>
<a name="ln-473"></a>
<a name="ln-474"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>     <span class="kd">::</span> <span class="n">CreateDFSReportFile</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-475"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>     <span class="kd">::</span> <span class="n">doSkyReporting</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-476"></a>
<a name="ln-477"></a>          <span class="c">! FLOW:</span>
<a name="ln-478"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FirstTime</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-479"></a><span class="k">    CALL </span><span class="n">GetDaylightingParametersInput</span>
<a name="ln-480"></a>    <span class="k">CALL </span><span class="n">CheckTDDsAndLightShelvesInDaylitZones</span>
<a name="ln-481"></a>    <span class="n">FirstTime</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-482"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">CheckTDDZone</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">CheckTDDZone</span><span class="p">)</span>
<a name="ln-483"></a>  <span class="k">END IF</span>  <span class="c">! End of check if FirstTime</span>
<a name="ln-484"></a>
<a name="ln-485"></a>  <span class="c">! Find the total number of exterior windows associated with all Daylighting:Detailed zones.</span>
<a name="ln-486"></a>  <span class="c">! An exterior window is associated with such a zone if (1) it is an exterior window in the zone, or</span>
<a name="ln-487"></a>  <span class="c">! (2) it is an exterior window in an adjacent zone that shares an interior window with the zone.</span>
<a name="ln-488"></a>  <span class="c">! Note that exterior windows in category (2) may be counted more than once if an adjacent zone</span>
<a name="ln-489"></a>  <span class="c">! is adjacent to more than one daylit zone with which the adjacent zone shares interior windows.</span>
<a name="ln-490"></a>  <span class="c">! If there are no interior windows in a building, than TotWindowsWithDayl is just the total number of</span>
<a name="ln-491"></a>  <span class="c">! exterior windows in Daylighting:Detailed zones. Note that it is possible for a</span>
<a name="ln-492"></a>  <span class="c">! Daylighting:Detailed zone to have zero exterior windows of its own, but it may have an interior</span>
<a name="ln-493"></a>  <span class="c">! through which daylight passes from adjacent zones with exterior windows.</span>
<a name="ln-494"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginSimFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-495"></a><span class="k">    </span><span class="n">TotWindowsWithDayl</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-496"></a>    <span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-497"></a>      <span class="n">TotWindowsWithDayl</span> <span class="o">=</span> <span class="n">TotWindowsWithDayl</span> <span class="o">+</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span>
<a name="ln-498"></a>    <span class="k">END DO</span>
<a name="ln-499"></a><span class="k">  END IF</span>
<a name="ln-500"></a>
<a name="ln-501"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">TotWindowsWithDayl</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-502"></a>
<a name="ln-503"></a>  <span class="c">!-----------------------------------------!</span>
<a name="ln-504"></a>  <span class="c">! Detailed daylighting factor calculation !</span>
<a name="ln-505"></a>  <span class="c">!-----------------------------------------!</span>
<a name="ln-506"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">KickoffSizing</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">KickoffSimulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-507"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">WarmUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-508"></a><span class="k">      CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Calculating Detailed Daylighting Factors, Start Date=&#39;</span><span class="o">//</span><span class="n">CurMnDy</span><span class="p">)</span>
<a name="ln-509"></a>    <span class="k">ELSE</span>
<a name="ln-510"></a><span class="k">      CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Updating Detailed Daylighting Factors, Start Date=&#39;</span><span class="o">//</span><span class="n">CurMnDy</span><span class="p">)</span>
<a name="ln-511"></a>    <span class="k">END IF</span>
<a name="ln-512"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-513"></a>
<a name="ln-514"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">BeginSimFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-515"></a>
<a name="ln-516"></a>  <span class="c">! Find minimum solid angle subtended by an interior window in Daylighting:Detailed zones.</span>
<a name="ln-517"></a>  <span class="c">! Used in calculating daylighting through interior windows.</span>
<a name="ln-518"></a>    <span class="k">CALL </span><span class="n">CalcMinIntWinSolidAngs</span>
<a name="ln-519"></a>
<a name="ln-520"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TDDTransVisBeam</span><span class="p">(</span><span class="n">NumOfTDDPipes</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-521"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TDDFluxInc</span><span class="p">(</span><span class="n">NumOfTDDPipes</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-522"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TDDFluxTrans</span><span class="p">(</span><span class="n">NumOfTDDPipes</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-523"></a>
<a name="ln-524"></a>    <span class="c">! Warning if detailed daylighting has been requested for a zone with no associated exterior windows.</span>
<a name="ln-525"></a>    <span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-526"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-527"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Detailed daylighting will not be done for zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-528"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;because it has no associated exterior windows.&#39;</span><span class="p">)</span>
<a name="ln-529"></a>      <span class="k">END IF</span>
<a name="ln-530"></a><span class="k">    END DO</span>
<a name="ln-531"></a>
<a name="ln-532"></a>    <span class="c">! Find area and reflectance quantities used in calculating inter-reflected illuminance.</span>
<a name="ln-533"></a>    <span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-534"></a>      <span class="c">!TH 9/10/2009. Need to calculate for zones without daylighting controls (TotalDaylRefPoints = 0)</span>
<a name="ln-535"></a>      <span class="c">! but with adjacent zones having daylighting controls.</span>
<a name="ln-536"></a>      <span class="k">IF</span><span class="p">((</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-537"></a>        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AdjZoneHasDayltgCtrl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-538"></a><span class="k">        CALL </span><span class="n">DayltgAveInteriorReflectance</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-539"></a>      <span class="n">ENDIF</span>
<a name="ln-540"></a>    <span class="k">END DO</span>
<a name="ln-541"></a>
<a name="ln-542"></a><span class="k">  END IF</span>
<a name="ln-543"></a>
<a name="ln-544"></a>  <span class="c">! Zero daylighting factor arrays</span>
<a name="ln-545"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-546"></a><span class="k">    </span><span class="n">TDDTransVisBeam</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-547"></a>    <span class="n">TDDFluxInc</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-548"></a>    <span class="n">TDDFluxTrans</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-549"></a>  <span class="k">ELSE</span>
<a name="ln-550"></a><span class="k">    </span><span class="n">TDDTransVisBeam</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NumOfTDDPipes</span><span class="p">,</span> <span class="n">HourOfDay</span><span class="p">)</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-551"></a>    <span class="n">TDDFluxInc</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NumOfTDDPipes</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="n">HourOfDay</span><span class="p">)</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-552"></a>    <span class="n">TDDFluxTrans</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NumOfTDDPipes</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="n">HourOfDay</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-553"></a>  <span class="n">ENDIF</span>
<a name="ln-554"></a>
<a name="ln-555"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-556"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">BeginDayFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-557"></a>      <span class="c">! Calculate hourly sun angles, clear sky zenith luminance, and exterior horizontal illuminance</span>
<a name="ln-558"></a>      <span class="n">PHSUN</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-559"></a>      <span class="n">SPHSUN</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-560"></a>      <span class="n">CPHSUN</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-561"></a>      <span class="n">THSUN</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-562"></a>
<a name="ln-563"></a>      <span class="n">PHSUNHR</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-564"></a>      <span class="n">SPHSUNHR</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-565"></a>      <span class="n">CPHSUNHR</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-566"></a>      <span class="n">THSUNHR</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-567"></a>      <span class="n">GILSK</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-568"></a>      <span class="n">GILSU</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-569"></a>      <span class="k">DO </span><span class="n">IHR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-570"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SUNCOSHR</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SunIsUpValue</span><span class="p">)</span> <span class="k">CYCLE</span> <span class="c">! Skip if sun is below horizon</span>
<a name="ln-571"></a>        <span class="n">PHSUN</span> <span class="o">=</span> <span class="n">PIOVR2</span> <span class="o">-</span> <span class="nb">ACOS</span><span class="p">(</span><span class="n">SUNCOSHR</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">IHR</span><span class="p">))</span>
<a name="ln-572"></a>        <span class="n">PHSUNHR</span><span class="p">(</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">PHSUN</span>
<a name="ln-573"></a>        <span class="n">SPHSUNHR</span><span class="p">(</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">PHSUN</span><span class="p">)</span>
<a name="ln-574"></a>        <span class="n">CPHSUNHR</span><span class="p">(</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">PHSUN</span><span class="p">)</span>
<a name="ln-575"></a>        <span class="n">THSUNHR</span><span class="p">(</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">ATAN2</span><span class="p">(</span><span class="n">SUNCOSHR</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">IHR</span><span class="p">),</span><span class="n">SUNCOSHR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">))</span>
<a name="ln-576"></a>        <span class="c">! Get exterior horizontal illuminance from sky and sun</span>
<a name="ln-577"></a>        <span class="n">THSUN</span><span class="o">=</span><span class="n">THSUNHR</span><span class="p">(</span><span class="n">IHR</span><span class="p">)</span>
<a name="ln-578"></a>        <span class="n">SPHSUN</span> <span class="o">=</span> <span class="n">SPHSUNHR</span><span class="p">(</span><span class="n">IHR</span><span class="p">)</span>
<a name="ln-579"></a>        <span class="n">CPHSUN</span> <span class="o">=</span> <span class="n">CPHSUNHR</span><span class="p">(</span><span class="n">IHR</span><span class="p">)</span>
<a name="ln-580"></a>        <span class="k">CALL </span><span class="n">DayltgExtHorizIllum</span><span class="p">(</span><span class="n">GILSK</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">),</span><span class="n">GILSU</span><span class="p">(</span><span class="n">IHR</span><span class="p">))</span>
<a name="ln-581"></a>      <span class="k">END DO</span>
<a name="ln-582"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-583"></a>  <span class="k">ELSE</span> <span class="c">!timestep integrated calculations</span>
<a name="ln-584"></a>    <span class="n">PHSUN</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-585"></a>    <span class="n">SPHSUN</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-586"></a>    <span class="n">CPHSUN</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-587"></a>    <span class="n">THSUN</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-588"></a>
<a name="ln-589"></a>    <span class="n">PHSUNHR</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-590"></a>    <span class="n">SPHSUNHR</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-591"></a>    <span class="n">CPHSUNHR</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-592"></a>    <span class="n">THSUNHR</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-593"></a>    <span class="n">GILSK</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-594"></a>    <span class="n">GILSU</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-595"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="n">SUNCOSHR</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SunIsUpValue</span><span class="p">))</span> <span class="k">THEN</span>  <span class="c">! Skip if sun is below horizon</span>
<a name="ln-596"></a>      <span class="n">PHSUN</span> <span class="o">=</span> <span class="n">PIOVR2</span> <span class="o">-</span> <span class="nb">ACOS</span><span class="p">(</span><span class="n">SUNCOSHR</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span>
<a name="ln-597"></a>      <span class="n">PHSUNHR</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">=</span> <span class="n">PHSUN</span>
<a name="ln-598"></a>      <span class="n">SPHSUNHR</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">PHSUN</span><span class="p">)</span>
<a name="ln-599"></a>      <span class="n">CPHSUNHR</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">PHSUN</span><span class="p">)</span>
<a name="ln-600"></a>      <span class="n">THSUNHR</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">=</span> <span class="n">ATAN2</span><span class="p">(</span><span class="n">SUNCOSHR</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">),</span><span class="n">SUNCOSHR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span>
<a name="ln-601"></a>      <span class="c">! Get exterior horizontal illuminance from sky and sun</span>
<a name="ln-602"></a>      <span class="n">THSUN</span><span class="o">=</span><span class="n">THSUNHR</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span>
<a name="ln-603"></a>      <span class="n">SPHSUN</span> <span class="o">=</span> <span class="n">SPHSUNHR</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span>
<a name="ln-604"></a>      <span class="n">CPHSUN</span> <span class="o">=</span> <span class="n">CPHSUNHR</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span>
<a name="ln-605"></a>      <span class="k">CALL </span><span class="n">DayltgExtHorizIllum</span><span class="p">(</span><span class="n">GILSK</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">),</span><span class="n">GILSU</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">))</span>
<a name="ln-606"></a>    <span class="n">ENDIF</span>
<a name="ln-607"></a>
<a name="ln-608"></a>  <span class="n">ENDIF</span>
<a name="ln-609"></a>
<a name="ln-610"></a>  <span class="c">!           -----------</span>
<a name="ln-611"></a>  <span class="c">! ---------- ZONE LOOP ----------</span>
<a name="ln-612"></a>  <span class="c">!           -----------</span>
<a name="ln-613"></a>
<a name="ln-614"></a>  <span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-615"></a>    <span class="c">! Skip zones that are not Daylighting:Detailed zones.</span>
<a name="ln-616"></a>    <span class="c">! TotalDaylRefPoints = 0 means zone has (1) no daylighting or</span>
<a name="ln-617"></a>    <span class="c">! (3) Daylighting:DElight</span>
<a name="ln-618"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-619"></a>
<a name="ln-620"></a>    <span class="c">! Skip zones with no exterior windows in the zone or in adjacent zone with which an interior window is shared</span>
<a name="ln-621"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-622"></a>
<a name="ln-623"></a><span class="k">    CALL </span><span class="n">CalcDayltgCoeffsRefMapPoints</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-624"></a>
<a name="ln-625"></a>  <span class="k">END DO</span> <span class="c">! End of zone loop, ZoneNum</span>
<a name="ln-626"></a>
<a name="ln-627"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">doSkyReporting</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-628"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">KickOffSizing</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">KickOffSimulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-629"></a><span class="k">  IF</span><span class="p">(</span><span class="n">FirstTimeDaylFacCalc</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TotWindowsWithDayl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-630"></a>    <span class="c">! Write the bare-window four sky daylight factors at noon time to the eio file; this is done only</span>
<a name="ln-631"></a>    <span class="c">! for first time that daylight factors are calculated and so is insensitive to possible variation</span>
<a name="ln-632"></a>    <span class="c">! due to change in ground reflectance from month to month, or change in storm window status.</span>
<a name="ln-633"></a>    <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">700</span><span class="p">)</span>
<a name="ln-634"></a>    <span class="mi">700</span> <span class="k">Format</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-635"></a>    <span class="s1">&#39;! &lt;Sky Daylight Factors&gt;, MonthAndDay, Zone Name, Window Name, Daylight Fac: Ref Pt #1, Daylight Fac: Ref Pt #2&#39;</span><span class="p">)</span>
<a name="ln-636"></a>    <span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfZones</span>
<a name="ln-637"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-638"></a><span class="k">      DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span>
<a name="ln-639"></a>        <span class="n">IWin</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-640"></a>        <span class="c">! For this report, do not include ext wins in zone adjacent to ZoneNum since the inter-reflected</span>
<a name="ln-641"></a>        <span class="c">! component will not be calculated for these windows until the time-step loop.</span>
<a name="ln-642"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-643"></a>            <span class="c">! clear sky</span>
<a name="ln-644"></a>            <span class="n">DaylFac1</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-645"></a>            <span class="n">DaylFac2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-646"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">DaylFac2</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-647"></a>            <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="s1">&#39; Clear Sky Daylight Factors,&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-648"></a>              <span class="nb">trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-649"></a>              <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DaylFac1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DaylFac2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-650"></a>
<a name="ln-651"></a>            <span class="c">! clear Turbid sky</span>
<a name="ln-652"></a>            <span class="n">DaylFac1</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-653"></a>            <span class="n">DaylFac2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-654"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">DaylFac2</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-655"></a>            <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="s1">&#39; Clear Turbid Sky Daylight Factors,&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-656"></a>              <span class="nb">trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-657"></a>              <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DaylFac1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DaylFac2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-658"></a>
<a name="ln-659"></a>            <span class="c">! Intermediate sky</span>
<a name="ln-660"></a>            <span class="n">DaylFac1</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-661"></a>            <span class="n">DaylFac2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-662"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">DaylFac2</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-663"></a>            <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="s1">&#39; Intermediate Sky Daylight Factors,&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-664"></a>              <span class="nb">trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-665"></a>              <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DaylFac1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DaylFac2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-666"></a>
<a name="ln-667"></a>            <span class="c">! Overcast sky</span>
<a name="ln-668"></a>            <span class="n">DaylFac1</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-669"></a>            <span class="n">DaylFac2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-670"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">DaylFac2</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-671"></a>            <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="s1">&#39; Overcast Sky Daylight Factors,&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-672"></a>              <span class="nb">trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-673"></a>              <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DaylFac1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DaylFac2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-674"></a>        <span class="k">END IF</span>
<a name="ln-675"></a><span class="k">      END DO</span>
<a name="ln-676"></a><span class="k">    END DO</span>
<a name="ln-677"></a><span class="k">    </span><span class="n">FirstTimeDaylFacCalc</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-678"></a>    <span class="n">doSkyReporting</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-679"></a>  <span class="k">END IF</span>
<a name="ln-680"></a><span class="k">  END IF</span>
<a name="ln-681"></a><span class="k">  END IF</span>
<a name="ln-682"></a>
<a name="ln-683"></a>
<a name="ln-684"></a>  <span class="c">! TH 7/2010 report all daylight factors for the two reference points of daylight zones ...</span>
<a name="ln-685"></a>
<a name="ln-686"></a>  <span class="c">! Skip if no daylight windows</span>
<a name="ln-687"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">TotWindowsWithDayl</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-688"></a>
<a name="ln-689"></a>  <span class="c">! Skip if no request of reporting</span>
<a name="ln-690"></a>  <span class="k">IF</span><span class="p">((.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DFSReportSizingDays</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DFSReportAllShadowCalculationDays</span><span class="p">))</span> <span class="k">RETURN</span>
<a name="ln-691"></a>
<a name="ln-692"></a>  <span class="c">! Skip duplicate calls</span>
<a name="ln-693"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">KickOffSizing</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-694"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">DoingSizing</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-695"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">KickOffSimulation</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-696"></a>
<a name="ln-697"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">DFSReportSizingDays</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-698"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DoWeathSim</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DoDesDaySim</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-699"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">KindOfSim</span> <span class="o">==</span> <span class="n">ksRunPeriodWeather</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-700"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-701"></a>  <span class="n">ENDIF</span>
<a name="ln-702"></a>
<a name="ln-703"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DFSReportAllShadowCalculationDays</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-704"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">KindOfSim</span> <span class="o">/=</span> <span class="n">ksRunPeriodWeather</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-705"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-706"></a>
<a name="ln-707"></a>  <span class="c">! open a new file eplusout.dfs for saving the daylight factors</span>
<a name="ln-708"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CreateDFSReportFile</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-709"></a><span class="k">    </span><span class="n">OutputFileDFS</span> <span class="o">=</span> <span class="n">GetNewUnitNumber</span><span class="p">()</span>
<a name="ln-710"></a>    <span class="k">OPEN</span><span class="p">(</span><span class="n">OutputFileDFS</span><span class="p">,</span><span class="k">FILE</span><span class="o">=</span><span class="s1">&#39;eplusout.dfs&#39;</span><span class="p">,</span> <span class="n">Action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">write_stat</span><span class="p">)</span>
<a name="ln-711"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">write_stat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-712"></a><span class="k">     CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CalcDayltgCoefficients: Could not open file &quot;eplusout.dfs&quot; for output (write).&#39;</span><span class="p">)</span>
<a name="ln-713"></a>    <span class="k">ELSE</span>
<a name="ln-714"></a><span class="k">      Write</span><span class="p">(</span><span class="n">OutputFileDFS</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="s1">&#39;This file contains daylight factors for all exterior windows of daylight zones.&#39;</span>
<a name="ln-715"></a>      <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileDFS</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="s1">&#39;If only one reference point the last 4 columns in the data will be zero.&#39;</span>
<a name="ln-716"></a>      <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileDFS</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="s1">&#39;MonthAndDay,Zone Name,Window Name,Window State&#39;</span>
<a name="ln-717"></a>      <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileDFS</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="s1">&#39;Hour,Daylight Factor for Clear Sky at Reference point 1,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-718"></a>          <span class="s1">&#39;Daylight Factor for Clear Turbid Sky at Reference point 1,Daylight Factor for Intermediate Sky at Reference point 1,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-719"></a>          <span class="s1">&#39;Daylight Factor for Overcast Sky at Reference point 1,Daylight Factor for Clear Sky at Reference point 2,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-720"></a>          <span class="s1">&#39;Daylight Factor for Clear Turbid Sky at Reference point 2,Daylight Factor for Intermediate Sky at Reference point 2,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-721"></a>          <span class="s1">&#39;Daylight Factor for Overcast Sky at Reference point 2&#39;</span>
<a name="ln-722"></a>    <span class="n">ENDIF</span>
<a name="ln-723"></a>    <span class="n">CreateDFSReportFile</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-724"></a>  <span class="n">ENDIF</span>
<a name="ln-725"></a>
<a name="ln-726"></a>    <span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfZones</span>
<a name="ln-727"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-728"></a>
<a name="ln-729"></a><span class="k">      DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span>
<a name="ln-730"></a>        <span class="n">IWin</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-731"></a>        <span class="n">ICtrl</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span>
<a name="ln-732"></a>
<a name="ln-733"></a>        <span class="c">! For this report, do not include ext wins in zone adjacent to ZoneNum since the inter-reflected</span>
<a name="ln-734"></a>        <span class="c">! component will not be calculated for these windows until the time-step loop.</span>
<a name="ln-735"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-736"></a>
<a name="ln-737"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-738"></a>            <span class="c">! variable slat angle - MaxSlatangle sets</span>
<a name="ln-739"></a>            <span class="n">ISA</span> <span class="o">=</span> <span class="n">MaxSlatAngs</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-740"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">ICtrl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-741"></a>            <span class="c">! window shade or blind with fixed slat angle</span>
<a name="ln-742"></a>            <span class="n">ISA</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-743"></a>          <span class="k">ELSE</span>
<a name="ln-744"></a>            <span class="c">! base window</span>
<a name="ln-745"></a>            <span class="n">ISA</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-746"></a>          <span class="n">ENDIF</span>
<a name="ln-747"></a>
<a name="ln-748"></a>          <span class="c">! loop over each slat angle</span>
<a name="ln-749"></a>          <span class="k">DO </span><span class="n">ISlatAngle</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ISA</span>
<a name="ln-750"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ISlatAngle</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-751"></a>              <span class="c">! base window without shades, screens, or blinds</span>
<a name="ln-752"></a>              <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileDFS</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,Base Window&#39;</span>
<a name="ln-753"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">ISlatAngle</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ISA</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-754"></a>              <span class="c">! window shade or blind with fixed slat angle</span>
<a name="ln-755"></a>              <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileDFS</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span>
<a name="ln-756"></a>            <span class="k">ELSE</span>
<a name="ln-757"></a>              <span class="c">! blind with variable slat angle</span>
<a name="ln-758"></a>              <span class="n">SlatAngle</span> <span class="o">=</span> <span class="mi">18</span><span class="mf">0.d0</span><span class="o">/</span><span class="kt">real</span><span class="p">((</span><span class="n">MaxSlatAngs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span><span class="n">r64</span><span class="p">)</span> <span class="o">*</span> <span class="kt">real</span><span class="p">((</span><span class="n">ISlatAngle</span> <span class="o">-</span> <span class="mi">2</span><span class="p">),</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-759"></a>              <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileDFS</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-760"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SlatAngle</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-761"></a>            <span class="n">ENDIF</span>
<a name="ln-762"></a>
<a name="ln-763"></a>            <span class="k">DO </span><span class="n">IHR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">24</span>
<a name="ln-764"></a>              <span class="c">! daylight reference point 1</span>
<a name="ln-765"></a>              <span class="n">DFClrSky1</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ISlatAngle</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span>     <span class="c">! clear sky</span>
<a name="ln-766"></a>              <span class="n">DFClrTbSky1</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ISlatAngle</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span>   <span class="c">! clear Turbid sky</span>
<a name="ln-767"></a>              <span class="n">DFIntSky1</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">ISlatAngle</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span>     <span class="c">! Intermediate sky</span>
<a name="ln-768"></a>              <span class="n">DFOcSky1</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">ISlatAngle</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span>      <span class="c">! Overcast sky</span>
<a name="ln-769"></a>
<a name="ln-770"></a>              <span class="c">! daylight reference point 2</span>
<a name="ln-771"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-772"></a><span class="k">                </span><span class="n">DFClrSky2</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ISlatAngle</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span>
<a name="ln-773"></a>                <span class="n">DFClrTbSky2</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ISlatAngle</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span>
<a name="ln-774"></a>                <span class="n">DFIntSky2</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">ISlatAngle</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span>
<a name="ln-775"></a>                <span class="n">DFOcSky2</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">ISlatAngle</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span>
<a name="ln-776"></a>              <span class="k">ELSE</span>
<a name="ln-777"></a><span class="k">                </span><span class="n">DFClrSky2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-778"></a>                <span class="n">DFClrTbSky2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-779"></a>                <span class="n">DFIntSky2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-780"></a>                <span class="n">DFOcSky2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-781"></a>              <span class="n">ENDIF</span>
<a name="ln-782"></a>
<a name="ln-783"></a>              <span class="c">! write daylight factors - 4 sky types for each daylight ref point</span>
<a name="ln-784"></a>              <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileDFS</span><span class="p">,</span><span class="n">fmtA</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IHR</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-785"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DFClrSky1</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DFClrTbSky1</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-786"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DFIntSky1</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DFOcSky1</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-787"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DFClrSky2</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DFClrTbSky2</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-788"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DFIntSky2</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DFOcSky2</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-789"></a>            <span class="k">END DO</span> <span class="c">! hour loop</span>
<a name="ln-790"></a>          <span class="k">END DO</span>
<a name="ln-791"></a><span class="k">        END IF</span>
<a name="ln-792"></a><span class="k">      END DO</span> <span class="c">! exterior windows in zone loop</span>
<a name="ln-793"></a>    <span class="k">END DO</span> <span class="c">! zone loop</span>
<a name="ln-794"></a>
<a name="ln-795"></a>  <span class="k">RETURN</span>
<a name="ln-796"></a>
<a name="ln-797"></a><span class="k">END SUBROUTINE </span><span class="n">CalcDayltgCoefficients</span>
<a name="ln-798"></a>
<a name="ln-799"></a><span class="k">SUBROUTINE </span><span class="n">CalcDayltgCoeffsRefMapPoints</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-800"></a>
<a name="ln-801"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-802"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-803"></a>          <span class="c">!       DATE WRITTEN   October 2004</span>
<a name="ln-804"></a>          <span class="c">!       MODIFIED       May 2006 (RR): added exterior window screens</span>
<a name="ln-805"></a>          <span class="c">!                      April 2012 (LKL); change to allow multiple maps per zone</span>
<a name="ln-806"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-807"></a>
<a name="ln-808"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-809"></a>          <span class="c">! This subroutine does the daylighting coefficient calculation for the</span>
<a name="ln-810"></a>          <span class="c">! daylighting and illuminance map reference points.</span>
<a name="ln-811"></a>
<a name="ln-812"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-813"></a>          <span class="c">! na</span>
<a name="ln-814"></a>
<a name="ln-815"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-816"></a>          <span class="c">! na</span>
<a name="ln-817"></a>
<a name="ln-818"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-819"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">POLYF</span><span class="p">,</span> <span class="n">InterpProfAng</span><span class="p">,</span> <span class="n">BlindBeamBeamTrans</span><span class="p">,</span> <span class="n">SafeDivide</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-820"></a>  <span class="k">USE </span><span class="n">DaylightingDevices</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindTDDPipe</span><span class="p">,</span> <span class="n">TransTDD</span>
<a name="ln-821"></a>  <span class="k">USE </span><span class="n">SolarReflectionManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolReflRecSurf</span>
<a name="ln-822"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-823"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DetailedSkyDiffuseAlgorithm</span>
<a name="ln-824"></a>
<a name="ln-825"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-826"></a>
<a name="ln-827"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-828"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneNum</span>
<a name="ln-829"></a>
<a name="ln-830"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-831"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">tmpDFCalc</span> <span class="o">=</span> <span class="mf">0.05d0</span> <span class="c">! cut off illuminance (lux) for exterior horizontal in calculating</span>
<a name="ln-832"></a>                                             <span class="c">! the daylighting and glare factors</span>
<a name="ln-833"></a>
<a name="ln-834"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-835"></a>          <span class="c">! na</span>
<a name="ln-836"></a>
<a name="ln-837"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-838"></a>          <span class="c">! na</span>
<a name="ln-839"></a>
<a name="ln-840"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-841"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IWin</span>         <span class="c">! Window counter</span>
<a name="ln-842"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">PipeNum</span>      <span class="c">! TDD pipe object number</span>
<a name="ln-843"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">loopwin</span>      <span class="c">! loop index for exterior windows associated with a daylit zone</span>
<a name="ln-844"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>     <span class="kd">::</span> <span class="n">VeryFirstTime</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-845"></a>  <span class="kt">INTEGER </span><span class="n">TZoneNum</span>
<a name="ln-846"></a>  <span class="kt">LOGICAL </span><span class="n">ErrorsFound</span>
<a name="ln-847"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MapNum</span>
<a name="ln-848"></a>
<a name="ln-849"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">VeryFirstTime</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-850"></a>    <span class="c">! make sure all necessary surfaces match to pipes</span>
<a name="ln-851"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-852"></a>    <span class="k">DO </span><span class="n">TZoneNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-853"></a>      <span class="k">DO </span><span class="n">loopwin</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">TZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span>
<a name="ln-854"></a>        <span class="n">IWin</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">TZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">loopwin</span><span class="p">)</span>
<a name="ln-855"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">/=</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-856"></a>        <span class="c">! Look up the TDD:DOME object</span>
<a name="ln-857"></a>        <span class="n">PipeNum</span> <span class="o">=</span> <span class="n">FindTDDPipe</span><span class="p">(</span><span class="n">IWin</span><span class="p">)</span>
<a name="ln-858"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PipeNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-859"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetTDDInput: Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-860"></a>             <span class="s1">&#39;, TDD:Dome object does not reference a valid Diffuser object.&#39;</span><span class="p">)</span>
<a name="ln-861"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...needs DaylightingDevice:Tubular of same name as Surface.&#39;</span><span class="p">)</span>
<a name="ln-862"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-863"></a>        <span class="n">ENDIF</span>
<a name="ln-864"></a>      <span class="n">ENDDO</span>
<a name="ln-865"></a>    <span class="n">ENDDO</span>
<a name="ln-866"></a>
<a name="ln-867"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-868"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Not all TubularDaylightDome objects have corresponding DaylightingDevice:Tubular objects.&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-869"></a>        <span class="s1">&#39; Program terminates.&#39;</span><span class="p">)</span>
<a name="ln-870"></a>    <span class="n">ENDIF</span>
<a name="ln-871"></a>    <span class="n">VeryFirstTime</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-872"></a>  <span class="n">ENDIF</span>
<a name="ln-873"></a>
<a name="ln-874"></a>  <span class="c">!Calc for daylighting reference points</span>
<a name="ln-875"></a>  <span class="k">CALL </span><span class="n">CalcDayltgCoeffsRefPoints</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-876"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DoingSizing</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">KickOffSimulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-877"></a>    <span class="c">!Calc for illuminance map</span>
<a name="ln-878"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TotIllumMaps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-879"></a><span class="k">      DO </span><span class="n">MapNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotIllumMaps</span>
<a name="ln-880"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">/=</span> <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-881"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WarmUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-882"></a><span class="k">          CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Calculating Daylighting Coefficients (Map Points), Zone=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-883"></a>        <span class="k">ELSE</span>
<a name="ln-884"></a><span class="k">          CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Updating Daylighting Coefficients (Map Points), Zone=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-885"></a>        <span class="k">END IF</span>
<a name="ln-886"></a><span class="k">      </span><span class="n">ENDDO</span>
<a name="ln-887"></a>      <span class="k">CALL </span><span class="n">CalcDayltgCoeffsMapPoints</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-888"></a>    <span class="n">ENDIF</span>
<a name="ln-889"></a>  <span class="n">ENDIF</span>
<a name="ln-890"></a>
<a name="ln-891"></a>  <span class="k">RETURN</span>
<a name="ln-892"></a>
<a name="ln-893"></a><span class="k">END SUBROUTINE </span><span class="n">CalcDayltgCoeffsRefMapPoints</span>
<a name="ln-894"></a>
<a name="ln-895"></a><span class="k">SUBROUTINE </span><span class="n">CalcDayltgCoeffsRefPoints</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-896"></a>
<a name="ln-897"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-898"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-899"></a>          <span class="c">!       DATE WRITTEN   April 2012</span>
<a name="ln-900"></a>          <span class="c">!       MODIFIED       November 2012 (B. Griffith), refactor for detailed timestep integration and remove duplicate code</span>
<a name="ln-901"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-902"></a>
<a name="ln-903"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-904"></a>          <span class="c">! Provides calculations for Daylighting Coefficients for daylighting reference points</span>
<a name="ln-905"></a>
<a name="ln-906"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-907"></a>          <span class="c">! April 2012 change: Was previously part of CalcDayltgCoeffsRefMapPoints -- broken out to allow multiple</span>
<a name="ln-908"></a>          <span class="c">! maps per zone</span>
<a name="ln-909"></a>
<a name="ln-910"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-911"></a>          <span class="c">! na</span>
<a name="ln-912"></a>
<a name="ln-913"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-914"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">POLYF</span><span class="p">,</span> <span class="n">InterpProfAng</span><span class="p">,</span> <span class="n">BlindBeamBeamTrans</span><span class="p">,</span> <span class="n">SafeDivide</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-915"></a>  <span class="k">USE </span><span class="n">DaylightingDevices</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindTDDPipe</span><span class="p">,</span> <span class="n">TransTDD</span>
<a name="ln-916"></a>  <span class="k">USE </span><span class="n">SolarReflectionManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolReflRecSurf</span>
<a name="ln-917"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-918"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DetailedSkyDiffuseAlgorithm</span><span class="p">,</span> <span class="n">DetailedSolarTimestepIntegration</span>
<a name="ln-919"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SunIsUp</span>
<a name="ln-920"></a>
<a name="ln-921"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-922"></a>
<a name="ln-923"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-924"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneNum</span>
<a name="ln-925"></a>
<a name="ln-926"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-927"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">tmpDFCalc</span> <span class="o">=</span> <span class="mf">0.05d0</span> <span class="c">! cut off illuminance (lux) for exterior horizontal in calculating</span>
<a name="ln-928"></a>                                             <span class="c">! the daylighting and glare factors</span>
<a name="ln-929"></a>
<a name="ln-930"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-931"></a>          <span class="c">! na</span>
<a name="ln-932"></a>
<a name="ln-933"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-934"></a>          <span class="c">! na</span>
<a name="ln-935"></a>
<a name="ln-936"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-937"></a>
<a name="ln-938"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W2</span>             <span class="c">! Second vertex of window</span>
<a name="ln-939"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W3</span>             <span class="c">! Third vertex of window</span>
<a name="ln-940"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W21</span>            <span class="c">! Vector from window vertex 2 to window vertex 1</span>
<a name="ln-941"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W23</span>            <span class="c">! Vector from window vertex 2 to window vertex 3</span>
<a name="ln-942"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RREF</span>           <span class="c">! Location of a reference point in absolute coordinate system</span>
<a name="ln-943"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RREF2</span>          <span class="c">! Location of virtual reference point in absolute coordinate system</span>
<a name="ln-944"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RWIN</span>           <span class="c">! Center of a window element in absolute coordinate system</span>
<a name="ln-945"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RWIN2</span>          <span class="c">! Center of a window element for TDD:DOME (if exists) in abs coord sys</span>
<a name="ln-946"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RAY</span>            <span class="c">! Unit vector along ray from reference point to window element</span>
<a name="ln-947"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WNORM2</span>         <span class="c">! Unit vector normal to TDD:DOME (if exists)</span>
<a name="ln-948"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VIEWVC</span>         <span class="c">! View vector in absolute coordinate system</span>
<a name="ln-949"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">U2</span>             <span class="c">! Second vertex of window for TDD:DOME (if exists)</span>
<a name="ln-950"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">U21</span>            <span class="c">! Vector from window vertex 2 to window vertex 1 for TDD:DOME (if exists)</span>
<a name="ln-951"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">U23</span>            <span class="c">! Vector from window vertex 2 to window vertex 3 for TDD:DOME (if exists)</span>
<a name="ln-952"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZF</span>             <span class="c">! Fraction of zone controlled by each reference point</span>
<a name="ln-953"></a>
<a name="ln-954"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VIEWVC2</span>        <span class="c">! Virtual view vector in absolute coordinate system</span>
<a name="ln-955"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHR</span>                          <span class="c">! Hour of day counter</span>
<a name="ln-956"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NRF</span>                          <span class="c">! Number of daylighting reference points in a zone</span>
<a name="ln-957"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IL</span>                           <span class="c">! Reference point counter</span>
<a name="ln-958"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AZVIEW</span>                       <span class="c">! Azimuth of view vector in absolute coord system for</span>
<a name="ln-959"></a>                                            <span class="c">!  glare calculation (radians)</span>
<a name="ln-960"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IConst</span>                       <span class="c">! Construction counter</span>
<a name="ln-961"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ICtrl</span>                        <span class="c">! Window control counter</span>
<a name="ln-962"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IWin</span>                         <span class="c">! Window counter</span>
<a name="ln-963"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IWin2</span>                        <span class="c">! Secondary window counter (for TDD:DOME object, if exists)</span>
<a name="ln-964"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">InShelfSurf</span>                  <span class="c">! Inside daylighting shelf surface number</span>
<a name="ln-965"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ShType</span>                       <span class="c">! Window shading type</span>
<a name="ln-966"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">BlNum</span>                        <span class="c">! Window Blind Number</span>
<a name="ln-967"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">LSHCAL</span>                       <span class="c">! Interior shade calculation flag: 0=not yet</span>
<a name="ln-968"></a>                                            <span class="c">!  calculated, 1=already calculated</span>
<a name="ln-969"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NWX</span>                          <span class="c">! Number of window elements in x direction for dayltg calc</span>
<a name="ln-970"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NWY</span>                          <span class="c">! Number of window elements in y direction for dayltg calc</span>
<a name="ln-971"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NWYlim</span>                       <span class="c">! For triangle, largest NWY for a given IX</span>
<a name="ln-972"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IX</span>                           <span class="c">! Counter for window elements in the x direction</span>
<a name="ln-973"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IY</span>                           <span class="c">! Counter for window elements in the y direction</span>
<a name="ln-974"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">COSB</span>                         <span class="c">! Cosine of angle between window outward normal and ray from</span>
<a name="ln-975"></a>                                            <span class="c">!  reference point to window element</span>
<a name="ln-976"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PHRAY</span>                        <span class="c">! Altitude of ray from reference point to window element (radians)</span>
<a name="ln-977"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">THRAY</span>                        <span class="c">! Azimuth of ray from reference point to window element (radians)</span>
<a name="ln-978"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DOMEGA</span>                       <span class="c">! Solid angle subtended by window element wrt reference point (steradians)</span>
<a name="ln-979"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVISB</span>                        <span class="c">! Visible transmittance of window for COSB angle of incidence (times light well</span>
<a name="ln-980"></a>                                            <span class="c">!   efficiency, if appropriate)</span>
<a name="ln-981"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ISunPos</span>                      <span class="c">! Sun position counter; used to avoid calculating various</span>
<a name="ln-982"></a>                                            <span class="c">!  quantities that do not depend on sun position.</span>
<a name="ln-983"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObTrans</span>                      <span class="c">! Product of solar transmittances of exterior obstructions hit by ray</span>
<a name="ln-984"></a>                                            <span class="c">! from reference point through a window element</span>
<a name="ln-985"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">loopwin</span>                      <span class="c">! loop index for exterior windows associated with a daylit zone</span>
<a name="ln-986"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">Rectangle</span>                    <span class="c">! True if window is rectangular</span>
<a name="ln-987"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">Triangle</span>                     <span class="c">! True if window is triangular</span>
<a name="ln-988"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DWX</span>                          <span class="c">! Horizontal dimension of window element (m)</span>
<a name="ln-989"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DWY</span>                          <span class="c">! Vertical dimension of window element (m)</span>
<a name="ln-990"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DAXY</span>                         <span class="c">! Area of window element</span>
<a name="ln-991"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyObstructionMult</span>           <span class="c">! Ratio of obstructed to unobstructed sky diffuse at a ground point</span>
<a name="ln-992"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ExtWinType</span>                   <span class="c">! Exterior window type (InZoneExtWin, AdjZoneExtWin, NotInOrAdjZoneExtWin)</span>
<a name="ln-993"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>     <span class="kd">::</span> <span class="n">refFirstTime</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-994"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">BRef</span>
<a name="ln-995"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ILB</span>
<a name="ln-996"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHitIntObs</span>                   <span class="c">! = 1 if interior obstruction hit, = 0 otherwise</span>
<a name="ln-997"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHitExtObs</span>                   <span class="c">! 1 if ray from ref pt to ext win hits an exterior obstruction</span>
<a name="ln-998"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVISIntWin</span>    <span class="c">! Visible transmittance of int win at COSBIntWin for light from ext win</span>
<a name="ln-999"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVISIntWinDisk</span>    <span class="c">! Visible transmittance of int win at COSBIntWin for sun</span>
<a name="ln-1000"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MySunIsUpFlag</span>   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1001"></a>
<a name="ln-1002"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">WinEl</span>                        <span class="c">! Current window element</span>
<a name="ln-1003"></a>
<a name="ln-1004"></a>
<a name="ln-1005"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">refFirstTime</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">ANY</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1006"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">RefErrIndex</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">%</span><span class="n">TotalDaylRefPoints</span><span class="p">)))</span>
<a name="ln-1007"></a>    <span class="n">RefErrIndex</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1008"></a>    <span class="n">refFirstTime</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1009"></a>  <span class="n">ENDIF</span>
<a name="ln-1010"></a>
<a name="ln-1011"></a>  <span class="c">! Azimuth of view vector in absolute coord sys</span>
<a name="ln-1012"></a>  <span class="n">AZVIEW</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ViewAzimuthForGlare</span> <span class="o">+</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">RelNorth</span> <span class="o">+</span> <span class="n">BuildingAzimuth</span> <span class="o">+</span> <span class="n">BuildingRotationAppendixG</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1013"></a>               <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-1014"></a>  <span class="c">! View vector components in absolute coord sys</span>
<a name="ln-1015"></a>  <span class="n">VIEWVC</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">AZVIEW</span><span class="p">)</span>
<a name="ln-1016"></a>  <span class="n">VIEWVC</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">AZVIEW</span><span class="p">)</span>
<a name="ln-1017"></a>  <span class="n">VIEWVC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1018"></a>
<a name="ln-1019"></a>
<a name="ln-1020"></a>  <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllumAtRefPt</span>        <span class="o">=</span><span class="mf">0.d0</span> <span class="c">! Daylight illuminance at reference points (lux)</span>
<a name="ln-1021"></a>  <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">GlareIndexAtRefPt</span>       <span class="o">=</span><span class="mf">0.d0</span> <span class="c">! Glare index at reference points</span>
<a name="ln-1022"></a>  <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPt</span>         <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1023"></a>  <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span>      <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1024"></a>  <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span>     <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1025"></a>  <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span>   <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1026"></a>  <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span> <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1027"></a>
<a name="ln-1028"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1029"></a>
<a name="ln-1030"></a><span class="k">    </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span>        <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1031"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span>     <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1032"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span>       <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1033"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span>        <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1034"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span>    <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1035"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span>     <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1036"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span> <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1037"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span>       <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1038"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span>   <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1039"></a>  <span class="k">ELSE</span>
<a name="ln-1040"></a>
<a name="ln-1041"></a><span class="k">    </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1042"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1043"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1044"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1045"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1046"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1047"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-1048"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1049"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1050"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1051"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-1052"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1053"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1054"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1055"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-1056"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1057"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1058"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1059"></a>  <span class="n">ENDIF</span>
<a name="ln-1060"></a>
<a name="ln-1061"></a>  <span class="n">NRF</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span>
<a name="ln-1062"></a>  <span class="n">ZF</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1063"></a>  <span class="n">ZF</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NRF</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FracZoneDaylit</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NRF</span><span class="p">)</span>
<a name="ln-1064"></a>  <span class="n">BRef</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1065"></a>
<a name="ln-1066"></a>  <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NRF</span>
<a name="ln-1067"></a>    <span class="c">! Reference point in absolute coordinate system</span>
<a name="ln-1068"></a>    <span class="n">RREF</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="c">! (x, y, z)</span>
<a name="ln-1069"></a>
<a name="ln-1070"></a>    <span class="c">!           -------------</span>
<a name="ln-1071"></a>    <span class="c">! ---------- WINDOW LOOP ----------</span>
<a name="ln-1072"></a>    <span class="c">!           -------------</span>
<a name="ln-1073"></a>    <span class="k">DO </span><span class="n">loopwin</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span>
<a name="ln-1074"></a>
<a name="ln-1075"></a>     <span class="k">CALL </span><span class="n">FigureDayltgCoeffsAtPointsSetupForWindow</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="n">IL</span><span class="p">,</span> <span class="n">loopwin</span><span class="p">,</span> <span class="n">CalledForRefPoint</span><span class="p">,</span> <span class="n">RREF</span><span class="p">,</span> <span class="n">VIEWVC</span><span class="p">,</span> <span class="n">IWIN</span><span class="p">,</span> <span class="n">IWIN2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1076"></a>                                                 <span class="n">NWX</span><span class="p">,</span> <span class="n">NWY</span><span class="p">,</span>   <span class="n">W2</span><span class="p">,</span><span class="n">W3</span><span class="p">,</span> <span class="n">W21</span><span class="p">,</span> <span class="n">W23</span><span class="p">,</span> <span class="n">LSHCAL</span><span class="p">,</span> <span class="n">InShelfSurf</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1077"></a>                                                  <span class="n">ICtrl</span><span class="p">,</span> <span class="n">ShType</span><span class="p">,</span> <span class="n">BlNum</span><span class="p">,</span> <span class="n">WNORM2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1078"></a>                                                 <span class="n">ExtWinType</span><span class="p">,</span> <span class="n">IConst</span><span class="p">,</span>  <span class="n">RREF2</span><span class="p">,</span> <span class="n">DWX</span><span class="p">,</span> <span class="n">DWY</span><span class="p">,</span><span class="n">DAXY</span><span class="p">,</span><span class="n">U2</span><span class="p">,</span> <span class="n">U23</span><span class="p">,</span><span class="n">U21</span> <span class="p">,</span><span class="n">VIEWVC2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1079"></a>                                                 <span class="n">Rectangle</span><span class="p">,</span> <span class="n">Triangle</span><span class="p">)</span>
<a name="ln-1080"></a>        <span class="c">!           ---------------------</span>
<a name="ln-1081"></a>        <span class="c">! ---------- WINDOW ELEMENT LOOP ----------</span>
<a name="ln-1082"></a>        <span class="c">!           ---------------------</span>
<a name="ln-1083"></a>
<a name="ln-1084"></a>        <span class="n">WinEl</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1085"></a>
<a name="ln-1086"></a>        <span class="k">DO </span><span class="n">IX</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NWX</span>
<a name="ln-1087"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Rectangle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1088"></a><span class="k">            </span><span class="n">NWYlim</span> <span class="o">=</span> <span class="n">NWY</span>
<a name="ln-1089"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Triangle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1090"></a><span class="k">            </span><span class="n">NWYlim</span> <span class="o">=</span> <span class="n">NWY</span> <span class="o">-</span> <span class="n">IX</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1091"></a>          <span class="k">END IF</span>
<a name="ln-1092"></a>
<a name="ln-1093"></a><span class="k">          DO </span><span class="n">IY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NWYlim</span>
<a name="ln-1094"></a>
<a name="ln-1095"></a>            <span class="n">WinEl</span> <span class="o">=</span> <span class="n">WinEl</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1096"></a>
<a name="ln-1097"></a>            <span class="k">CALL </span><span class="n">FigureDayltgCoeffsAtPointsForWindowElements</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="n">IL</span><span class="p">,</span> <span class="n">loopwin</span><span class="p">,</span> <span class="n">CalledForRefPoint</span><span class="p">,</span> <span class="n">WinEl</span><span class="p">,</span> <span class="n">IWIN</span><span class="p">,</span> <span class="n">IWIN2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1098"></a>                                                 <span class="n">IX</span><span class="p">,</span>  <span class="n">IY</span><span class="p">,</span> <span class="n">SkyObstructionMult</span><span class="p">,</span><span class="n">W2</span><span class="p">,</span> <span class="n">W21</span><span class="p">,</span> <span class="n">W23</span><span class="p">,</span><span class="n">RREF</span><span class="p">,</span> <span class="n">NWYlim</span><span class="p">,</span><span class="n">VIEWVC2</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1099"></a>                                                 <span class="n">DWX</span><span class="p">,</span> <span class="n">DWY</span><span class="p">,</span><span class="n">DAXY</span> <span class="p">,</span><span class="n">U2</span><span class="p">,</span> <span class="n">U23</span><span class="p">,</span><span class="n">U21</span><span class="p">,</span><span class="n">RWIN</span><span class="p">,</span> <span class="n">RWIN2</span><span class="p">,</span> <span class="n">RAY</span><span class="p">,</span> <span class="n">PHRAY</span><span class="p">,</span> <span class="n">LSHCAL</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-1100"></a>                                                 <span class="n">COSB</span><span class="p">,</span> <span class="n">ObTrans</span><span class="p">,</span><span class="n">TVISB</span><span class="p">,</span> <span class="n">DOMEGA</span><span class="p">,</span> <span class="n">THRAY</span><span class="p">,</span> <span class="n">IHitIntObs</span><span class="p">,</span> <span class="n">IHitExtObs</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-1101"></a>                                                 <span class="n">WNORM2</span><span class="p">,</span> <span class="n">ExtWinType</span><span class="p">,</span> <span class="n">IConst</span><span class="p">,</span> <span class="n">RREF2</span><span class="p">,</span><span class="n">Triangle</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1102"></a>                                                 <span class="n">TVISIntWin</span><span class="p">,</span> <span class="n">TVISIntWinDisk</span><span class="p">)</span>
<a name="ln-1103"></a>
<a name="ln-1104"></a>          <span class="c">!           -------------------</span>
<a name="ln-1105"></a>          <span class="c">! ---------- SUN POSITION LOOP ----------</span>
<a name="ln-1106"></a>          <span class="c">!           -------------------</span>
<a name="ln-1107"></a>
<a name="ln-1108"></a>          <span class="c">! Sun position counter. Used to avoid calculating various quantities</span>
<a name="ln-1109"></a>          <span class="c">! that do not depend on sun position.</span>
<a name="ln-1110"></a>
<a name="ln-1111"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1112"></a><span class="k">            </span><span class="n">ISunPos</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1113"></a>            <span class="k">DO </span><span class="n">IHR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-1114"></a>
<a name="ln-1115"></a>              <span class="k">CALL </span><span class="n">FigureDayltgCoeffsAtPointsForSunPosition</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="n">IL</span><span class="p">,</span> <span class="n">IX</span><span class="p">,</span> <span class="n">NWX</span><span class="p">,</span><span class="n">IY</span><span class="p">,</span> <span class="n">NWYlim</span><span class="p">,</span> <span class="n">WinEl</span><span class="p">,</span><span class="n">IWIN</span><span class="p">,</span> <span class="n">IWIN2</span><span class="p">,</span> <span class="n">IHR</span><span class="p">,</span> <span class="n">IsunPos</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1116"></a>                                                            <span class="n">SkyObstructionMult</span><span class="p">,</span><span class="n">RWIN2</span><span class="p">,</span> <span class="n">RAY</span><span class="p">,</span> <span class="n">PHRAY</span> <span class="p">,</span> <span class="n">LSHCAL</span><span class="p">,</span><span class="n">InShelfSurf</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1117"></a>                                                            <span class="n">COSB</span><span class="p">,</span> <span class="n">ObTrans</span><span class="p">,</span><span class="n">TVISB</span><span class="p">,</span> <span class="n">DOMEGA</span><span class="p">,</span> <span class="n">ICtrl</span><span class="p">,</span> <span class="n">ShType</span><span class="p">,</span> <span class="n">BlNum</span><span class="p">,</span> <span class="n">THRAY</span><span class="p">,</span> <span class="n">WNORM2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1118"></a>                                                            <span class="n">ExtWinType</span><span class="p">,</span><span class="n">IConst</span><span class="p">,</span><span class="n">AZVIEW</span> <span class="p">,</span> <span class="n">RREF2</span> <span class="p">,</span> <span class="n">loopwin</span><span class="p">,</span> <span class="n">IHitIntObs</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1119"></a>                                                            <span class="n">IHitExtObs</span><span class="p">,</span><span class="n">CalledForRefPoint</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1120"></a>                                                            <span class="n">TVISIntWin</span><span class="p">,</span> <span class="n">TVISIntWinDisk</span><span class="p">)</span>
<a name="ln-1121"></a>
<a name="ln-1122"></a>            <span class="k">END DO</span> <span class="c">! End of hourly sun position loop, IHR</span>
<a name="ln-1123"></a>          <span class="k">ELSE</span> <span class="c">!timestep integrated</span>
<a name="ln-1124"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MySunIsUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1125"></a><span class="k">               </span><span class="n">ISunPos</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1126"></a>               <span class="n">MySunIsUpFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1127"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MySunIsUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1128"></a><span class="k">               </span><span class="n">ISunPos</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1129"></a>            <span class="n">ELSEIF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MySunIsUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1130"></a><span class="k">              </span><span class="n">MySunIsUpFlag</span> <span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1131"></a>              <span class="n">ISunPos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-1132"></a>            <span class="n">ELSEIF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MySunIsUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1133"></a><span class="k">              </span><span class="n">ISunPos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-1134"></a>            <span class="n">ENDIF</span>
<a name="ln-1135"></a>
<a name="ln-1136"></a>
<a name="ln-1137"></a>            <span class="k">CALL </span><span class="n">FigureDayltgCoeffsAtPointsForSunPosition</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="n">IL</span><span class="p">,</span> <span class="n">IX</span><span class="p">,</span> <span class="n">NWX</span><span class="p">,</span> <span class="n">IY</span><span class="p">,</span> <span class="n">NWYlim</span><span class="p">,</span> <span class="n">WinEl</span><span class="p">,</span> <span class="n">IWIN</span><span class="p">,</span> <span class="n">IWIN2</span><span class="p">,</span> <span class="n">HourOfDay</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1138"></a>                                                          <span class="n">ISunPos</span><span class="p">,</span> <span class="n">SkyObstructionMult</span><span class="p">,</span><span class="n">RWIN2</span><span class="p">,</span> <span class="n">RAY</span><span class="p">,</span> <span class="n">PHRAY</span><span class="p">,</span> <span class="n">LSHCAL</span><span class="p">,</span> <span class="n">InShelfSurf</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1139"></a>                                                          <span class="n">COSB</span><span class="p">,</span><span class="n">ObTrans</span><span class="p">,</span><span class="n">TVISB</span> <span class="p">,</span> <span class="n">DOMEGA</span><span class="p">,</span> <span class="n">ICtrl</span><span class="p">,</span> <span class="n">ShType</span><span class="p">,</span> <span class="n">BlNum</span><span class="p">,</span> <span class="n">THRAY</span><span class="p">,</span> <span class="n">WNORM2</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1140"></a>                                                          <span class="n">ExtWinType</span><span class="p">,</span><span class="n">IConst</span><span class="p">,</span><span class="n">AZVIEW</span><span class="p">,</span> <span class="n">RREF2</span><span class="p">,</span> <span class="n">loopwin</span><span class="p">,</span> <span class="n">IHitIntObs</span><span class="p">,</span><span class="n">IHitExtObs</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1141"></a>                                                          <span class="n">CalledForRefPoint</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1142"></a>                                                          <span class="n">TVISIntWin</span><span class="p">,</span> <span class="n">TVISIntWinDisk</span><span class="p">)</span>
<a name="ln-1143"></a>          <span class="n">ENDIF</span>
<a name="ln-1144"></a>
<a name="ln-1145"></a>        <span class="k">END DO</span> <span class="c">! End of window Y-element loop, IY</span>
<a name="ln-1146"></a>      <span class="k">END DO</span> <span class="c">! End of window X-element loop, IX</span>
<a name="ln-1147"></a>
<a name="ln-1148"></a>      <span class="c">! Loop again over hourly sun positions and calculate daylight factors by adding</span>
<a name="ln-1149"></a>      <span class="c">! direct and inter-reflected illum components, then dividing by exterior horiz illum.</span>
<a name="ln-1150"></a>      <span class="c">! Also calculate corresponding glare factors.</span>
<a name="ln-1151"></a>
<a name="ln-1152"></a>      <span class="n">ILB</span><span class="o">=</span><span class="n">BRef</span><span class="o">+</span><span class="n">IL</span>
<a name="ln-1153"></a>
<a name="ln-1154"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1155"></a><span class="k">        </span><span class="n">ISunPos</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1156"></a>        <span class="k">DO </span><span class="n">IHR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-1157"></a>          <span class="k">CALL </span><span class="n">FigureRefPointDayltgFactorsToAddIllums</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span> <span class="n">IHR</span><span class="p">,</span> <span class="n">iSunPos</span><span class="p">,</span> <span class="n">iWin</span><span class="p">,</span> <span class="n">loopWin</span><span class="p">,</span> <span class="n">NWX</span> <span class="p">,</span> <span class="n">NWY</span> <span class="p">,</span> <span class="n">ICtrl</span> <span class="p">)</span>
<a name="ln-1158"></a>
<a name="ln-1159"></a>        <span class="k">END DO</span> <span class="c">! End of sun position loop, IHR</span>
<a name="ln-1160"></a>      <span class="k">ELSE</span>
<a name="ln-1161"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MySunIsUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1162"></a><span class="k">           </span><span class="n">ISunPos</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1163"></a>           <span class="n">MySunIsUpFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1164"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MySunIsUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1165"></a><span class="k">           </span><span class="n">ISunPos</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1166"></a>        <span class="n">ELSEIF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MySunIsUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1167"></a><span class="k">          </span><span class="n">MySunIsUpFlag</span> <span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1168"></a>          <span class="n">ISunPos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-1169"></a>        <span class="n">ELSEIF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MySunIsUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1170"></a><span class="k">          </span><span class="n">ISunPos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-1171"></a>        <span class="n">ENDIF</span>
<a name="ln-1172"></a>        <span class="k">CALL </span><span class="n">FigureRefPointDayltgFactorsToAddIllums</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span> <span class="n">HourOfDay</span><span class="p">,</span> <span class="n">iSunPos</span><span class="p">,</span> <span class="n">iWin</span><span class="p">,</span> <span class="n">loopWin</span><span class="p">,</span> <span class="n">NWX</span> <span class="p">,</span> <span class="n">NWY</span> <span class="p">,</span> <span class="n">ICtrl</span> <span class="p">)</span>
<a name="ln-1173"></a>      <span class="n">ENDIF</span>
<a name="ln-1174"></a>    <span class="k">END DO</span> <span class="c">! End of window loop, loopwin - IWin</span>
<a name="ln-1175"></a>
<a name="ln-1176"></a>  <span class="k">END DO</span> <span class="c">! End of reference point loop, IL</span>
<a name="ln-1177"></a>
<a name="ln-1178"></a>  <span class="k">RETURN</span>
<a name="ln-1179"></a>
<a name="ln-1180"></a><span class="k">END SUBROUTINE </span><span class="n">CalcDayltgCoeffsRefPoints</span>
<a name="ln-1181"></a>
<a name="ln-1182"></a><span class="k">SUBROUTINE </span><span class="n">CalcDayltgCoeffsMapPoints</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-1183"></a>
<a name="ln-1184"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1185"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-1186"></a>          <span class="c">!       DATE WRITTEN   April 2012</span>
<a name="ln-1187"></a>          <span class="c">!       MODIFIED      November 2012 (B. Griffith), refactor for detailed timestep integration and remove duplicate code</span>
<a name="ln-1188"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1189"></a>
<a name="ln-1190"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1191"></a>          <span class="c">! Provides calculations for Daylighting Coefficients for map illuminance points</span>
<a name="ln-1192"></a>
<a name="ln-1193"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1194"></a>          <span class="c">! Was previously part of CalcDayltgCoeffsRefMapPoints -- broken out to all multiple</span>
<a name="ln-1195"></a>          <span class="c">! maps per zone</span>
<a name="ln-1196"></a>
<a name="ln-1197"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1198"></a>          <span class="c">! na</span>
<a name="ln-1199"></a>
<a name="ln-1200"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1201"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">POLYF</span><span class="p">,</span> <span class="n">InterpProfAng</span><span class="p">,</span> <span class="n">BlindBeamBeamTrans</span><span class="p">,</span> <span class="n">SafeDivide</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-1202"></a>  <span class="k">USE </span><span class="n">DaylightingDevices</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindTDDPipe</span><span class="p">,</span> <span class="n">TransTDD</span>
<a name="ln-1203"></a>  <span class="k">USE </span><span class="n">SolarReflectionManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolReflRecSurf</span>
<a name="ln-1204"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-1205"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DetailedSkyDiffuseAlgorithm</span><span class="p">,</span> <span class="n">DetailedSolarTimestepIntegration</span>
<a name="ln-1206"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">SunIsUp</span>
<a name="ln-1207"></a>
<a name="ln-1208"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1209"></a>
<a name="ln-1210"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1211"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneNum</span>
<a name="ln-1212"></a>
<a name="ln-1213"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1214"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">tmpDFCalc</span> <span class="o">=</span> <span class="mf">0.05d0</span> <span class="c">! cut off illuminance (lux) for exterior horizontal in calculating</span>
<a name="ln-1215"></a>                                             <span class="c">! the daylighting and glare factors</span>
<a name="ln-1216"></a>
<a name="ln-1217"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1218"></a>          <span class="c">! na</span>
<a name="ln-1219"></a>
<a name="ln-1220"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1221"></a>          <span class="c">! na</span>
<a name="ln-1222"></a>
<a name="ln-1223"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1224"></a>
<a name="ln-1225"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W2</span>             <span class="c">! Second vertex of window</span>
<a name="ln-1226"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W3</span>             <span class="c">! Third vertex of window</span>
<a name="ln-1227"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">U2</span>             <span class="c">! Second vertex of window for TDD:DOME (if exists)</span>
<a name="ln-1228"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RREF</span>           <span class="c">! Location of a reference point in absolute coordinate system</span>
<a name="ln-1229"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RREF2</span>          <span class="c">! Location of virtual reference point in absolute coordinate system</span>
<a name="ln-1230"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RWIN</span>           <span class="c">! Center of a window element in absolute coordinate system</span>
<a name="ln-1231"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RWIN2</span>          <span class="c">! Center of a window element for TDD:DOME (if exists) in abs coord sys</span>
<a name="ln-1232"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RAY</span>            <span class="c">! Unit vector along ray from reference point to window element</span>
<a name="ln-1233"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W21</span>            <span class="c">! Vector from window vertex 2 to window vertex 1</span>
<a name="ln-1234"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W23</span>            <span class="c">! Vector from window vertex 2 to window vertex 3</span>
<a name="ln-1235"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">U21</span>            <span class="c">! Vector from window vertex 2 to window vertex 1 for TDD:DOME (if exists)</span>
<a name="ln-1236"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">U23</span>            <span class="c">! Vector from window vertex 2 to window vertex 3 for TDD:DOME (if exists)</span>
<a name="ln-1237"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WNORM2</span>         <span class="c">! Unit vector normal to TDD:DOME (if exists)</span>
<a name="ln-1238"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VIEWVC</span>         <span class="c">! View vector in absolute coordinate system</span>
<a name="ln-1239"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VIEWVC2</span>        <span class="c">! Virtual view vector in absolute coordinate system</span>
<a name="ln-1240"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZF</span>             <span class="c">! Fraction of zone controlled by each reference point</span>
<a name="ln-1241"></a>                                            <span class="c">!  In the following four variables, I=1 for clear sky, 2 for overcast.</span>
<a name="ln-1242"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHR</span>                          <span class="c">! Hour of day counter</span>
<a name="ln-1243"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NRF</span>                          <span class="c">! Number of daylighting reference points in a zone</span>
<a name="ln-1244"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IL</span>                           <span class="c">! Reference point counter</span>
<a name="ln-1245"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AZVIEW</span>                       <span class="c">! Azimuth of view vector in absolute coord system for</span>
<a name="ln-1246"></a>                                            <span class="c">!  glare calculation (radians)</span>
<a name="ln-1247"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IConst</span>                       <span class="c">! Construction counter</span>
<a name="ln-1248"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ICtrl</span>                        <span class="c">! Window control counter</span>
<a name="ln-1249"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IWin</span>                         <span class="c">! Window counter</span>
<a name="ln-1250"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IWin2</span>                        <span class="c">! Secondary window counter (for TDD:DOME object, if exists)</span>
<a name="ln-1251"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">InShelfSurf</span>                  <span class="c">! Inside daylighting shelf surface number</span>
<a name="ln-1252"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ShType</span>                       <span class="c">! Window shading type</span>
<a name="ln-1253"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">BlNum</span>                        <span class="c">! Window Blind Number</span>
<a name="ln-1254"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">LSHCAL</span>                       <span class="c">! Interior shade calculation flag: 0=not yet</span>
<a name="ln-1255"></a>                                            <span class="c">!  calculated, 1=already calculated</span>
<a name="ln-1256"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NWX</span>                          <span class="c">! Number of window elements in x direction for dayltg calc</span>
<a name="ln-1257"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NWY</span>                          <span class="c">! Number of window elements in y direction for dayltg calc</span>
<a name="ln-1258"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NWYlim</span>                       <span class="c">! For triangle, largest NWY for a given IX</span>
<a name="ln-1259"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DWX</span>                          <span class="c">! Horizontal dimension of window element (m)</span>
<a name="ln-1260"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DWY</span>                          <span class="c">! Vertical dimension of window element (m)</span>
<a name="ln-1261"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IX</span>                           <span class="c">! Counter for window elements in the x direction</span>
<a name="ln-1262"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IY</span>                           <span class="c">! Counter for window elements in the y direction</span>
<a name="ln-1263"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">COSB</span>                         <span class="c">! Cosine of angle between window outward normal and ray from</span>
<a name="ln-1264"></a>                                            <span class="c">!  reference point to window element</span>
<a name="ln-1265"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PHRAY</span>                        <span class="c">! Altitude of ray from reference point to window element (radians)</span>
<a name="ln-1266"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">THRAY</span>                        <span class="c">! Azimuth of ray from reference point to window element (radians)</span>
<a name="ln-1267"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DOMEGA</span>                       <span class="c">! Solid angle subtended by window element wrt reference point (steradians)</span>
<a name="ln-1268"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVISB</span>                        <span class="c">! Visible transmittance of window for COSB angle of incidence (times light well</span>
<a name="ln-1269"></a>                                            <span class="c">!   efficiency, if appropriate)</span>
<a name="ln-1270"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ISunPos</span>                      <span class="c">! Sun position counter; used to avoid calculating various</span>
<a name="ln-1271"></a>                                            <span class="c">!  quantities that do not depend on sun position.</span>
<a name="ln-1272"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObTrans</span>                      <span class="c">! Product of solar transmittances of exterior obstructions hit by ray</span>
<a name="ln-1273"></a>                                            <span class="c">! from reference point through a window element</span>
<a name="ln-1274"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">loopwin</span>                      <span class="c">! loop index for exterior windows associated with a daylit zone</span>
<a name="ln-1275"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">Rectangle</span>                    <span class="c">! True if window is rectangular</span>
<a name="ln-1276"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">Triangle</span>                     <span class="c">! True if window is triangular</span>
<a name="ln-1277"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DAXY</span>                         <span class="c">! Area of window element</span>
<a name="ln-1278"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyObstructionMult</span>           <span class="c">! Ratio of obstructed to unobstructed sky diffuse at a ground point</span>
<a name="ln-1279"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ExtWinType</span>                   <span class="c">! Exterior window type (InZoneExtWin, AdjZoneExtWin, NotInOrAdjZoneExtWin)</span>
<a name="ln-1280"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ILB</span>
<a name="ln-1281"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">MapNum</span>                       <span class="c">! Loop for map number</span>
<a name="ln-1282"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHitIntObs</span>                   <span class="c">! = 1 if interior obstruction hit, = 0 otherwise</span>
<a name="ln-1283"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHitExtObs</span>                   <span class="c">! 1 if ray from ref pt to ext win hits an exterior obstruction</span>
<a name="ln-1284"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVISIntWin</span>    <span class="c">! Visible transmittance of int win at COSBIntWin for light from ext win</span>
<a name="ln-1285"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVISIntWinDisk</span>    <span class="c">! Visible transmittance of int win at COSBIntWin for sun</span>
<a name="ln-1286"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">MapWindowSolidAngAtRefPt</span>
<a name="ln-1287"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">MapWindowSolidAngAtRefPtWtd</span>
<a name="ln-1288"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>     <span class="kd">::</span> <span class="n">mapFirstTime</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1289"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MySunIsUpFlag</span>   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1290"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WinEl</span>                          <span class="c">! window elements counter</span>
<a name="ln-1291"></a>
<a name="ln-1292"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">mapFirstTime</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TotIllumMaps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1293"></a><span class="k">    </span><span class="n">IL</span><span class="o">=-</span><span class="mi">999</span>
<a name="ln-1294"></a>    <span class="k">DO </span><span class="n">MapNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotIllumMaps</span>
<a name="ln-1295"></a>      <span class="n">IL</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">TotalMapRefPoints</span><span class="p">)</span>
<a name="ln-1296"></a>    <span class="n">ENDDO</span>
<a name="ln-1297"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MapErrIndex</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="n">IL</span><span class="p">))</span>
<a name="ln-1298"></a>    <span class="n">MapErrIndex</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1299"></a>    <span class="n">mapFirstTime</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1300"></a>  <span class="n">ENDIF</span>
<a name="ln-1301"></a>
<a name="ln-1302"></a>  <span class="c">! Azimuth of view vector in absolute coord sys</span>
<a name="ln-1303"></a>  <span class="n">AZVIEW</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ViewAzimuthForGlare</span> <span class="o">+</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">RelNorth</span> <span class="o">+</span> <span class="n">BuildingAzimuth</span> <span class="o">+</span> <span class="n">BuildingRotationAppendixG</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1304"></a>               <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-1305"></a>  <span class="c">! View vector components in absolute coord sys</span>
<a name="ln-1306"></a>  <span class="n">VIEWVC</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">AZVIEW</span><span class="p">)</span>
<a name="ln-1307"></a>  <span class="n">VIEWVC</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">AZVIEW</span><span class="p">)</span>
<a name="ln-1308"></a>  <span class="n">VIEWVC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1309"></a>
<a name="ln-1310"></a>  <span class="k">DO </span><span class="n">MapNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotIllumMaps</span>
<a name="ln-1311"></a>
<a name="ln-1312"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">/=</span> <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1313"></a>
<a name="ln-1314"></a><span class="k">    </span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllumAtMapPt</span>        <span class="o">=</span><span class="mf">0.d0</span> <span class="c">! Daylight illuminance at reference points (lux)</span>
<a name="ln-1315"></a>    <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">GlareIndexAtMapPt</span>       <span class="o">=</span><span class="mf">0.d0</span> <span class="c">! Glare index at reference points</span>
<a name="ln-1316"></a>    <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SolidAngAtMapPt</span>         <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1317"></a>    <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SolidAngAtMapPtWtd</span>      <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1318"></a>    <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">IllumFromWinAtMapPt</span>     <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1319"></a>    <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtMapPt</span>   <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1320"></a>    <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtMapPt</span> <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1321"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1322"></a><span class="k">      </span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span>           <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1323"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span>        <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1324"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span>          <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1325"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span>           <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1326"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span>       <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1327"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span>        <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1328"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span>    <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1329"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span>          <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1330"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span>      <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1331"></a>    <span class="k">ELSE</span>
<a name="ln-1332"></a><span class="k">      </span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1333"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1334"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1335"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1336"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1337"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1338"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-1339"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1340"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1341"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1342"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-1343"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1344"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1345"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1346"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-1347"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1348"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxRefPoints</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1349"></a>                 <span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1350"></a>    <span class="n">ENDIF</span>
<a name="ln-1351"></a>    <span class="n">NRF</span> <span class="o">=</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">TotalMapRefPoints</span>
<a name="ln-1352"></a>    <span class="n">ZF</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1353"></a>
<a name="ln-1354"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MapWindowSolidAngAtRefPt</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="n">NRF</span><span class="p">))</span>
<a name="ln-1355"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MapWindowSolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="p">,</span><span class="n">NRF</span><span class="p">))</span>
<a name="ln-1356"></a>
<a name="ln-1357"></a>    <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NRF</span>
<a name="ln-1358"></a>
<a name="ln-1359"></a>      <span class="n">RREF</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="c">! (x, y, z)</span>
<a name="ln-1360"></a>
<a name="ln-1361"></a>      <span class="c">!           -------------</span>
<a name="ln-1362"></a>      <span class="c">! ---------- WINDOW LOOP ----------</span>
<a name="ln-1363"></a>      <span class="c">!           -------------</span>
<a name="ln-1364"></a>
<a name="ln-1365"></a>      <span class="n">MapWindowSolidAngAtRefPt</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1366"></a>      <span class="n">MapWindowSolidAngAtRefPtWtd</span><span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-1367"></a>
<a name="ln-1368"></a>      <span class="k">DO </span><span class="n">loopwin</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span>
<a name="ln-1369"></a>
<a name="ln-1370"></a>        <span class="k">CALL </span><span class="n">FigureDayltgCoeffsAtPointsSetupForWindow</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="n">IL</span><span class="p">,</span> <span class="n">loopwin</span><span class="p">,</span> <span class="n">CalledForMapPoint</span><span class="p">,</span><span class="n">RREF</span><span class="p">,</span> <span class="n">VIEWVC</span><span class="p">,</span> <span class="n">IWIN</span><span class="p">,</span> <span class="n">IWIN2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1371"></a>                                                     <span class="n">NWX</span><span class="p">,</span> <span class="n">NWY</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span><span class="n">W3</span><span class="p">,</span> <span class="n">W21</span><span class="p">,</span> <span class="n">W23</span><span class="p">,</span> <span class="n">LSHCAL</span><span class="p">,</span> <span class="n">InShelfSurf</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1372"></a>                                                     <span class="n">ICtrl</span> <span class="p">,</span> <span class="n">ShType</span><span class="p">,</span> <span class="n">BlNum</span><span class="p">,</span> <span class="n">WNORM2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1373"></a>                                                     <span class="n">ExtWinType</span><span class="p">,</span> <span class="n">IConst</span><span class="p">,</span>  <span class="n">RREF2</span><span class="p">,</span> <span class="n">DWX</span><span class="p">,</span> <span class="n">DWY</span><span class="p">,</span> <span class="n">DAXY</span><span class="p">,</span> <span class="n">U2</span><span class="p">,</span> <span class="n">U23</span><span class="p">,</span><span class="n">U21</span><span class="p">,</span><span class="n">VIEWVC2</span><span class="p">,&amp;</span>
<a name="ln-1374"></a>                                                     <span class="n">Rectangle</span><span class="p">,</span> <span class="n">Triangle</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1375"></a>                                                     <span class="n">MapNum</span> <span class="o">=</span> <span class="n">MapNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1376"></a>                                                     <span class="n">MapWindowSolidAngAtRefPt</span> <span class="o">=</span> <span class="n">MapWindowSolidAngAtRefPt</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1377"></a>                                                     <span class="n">MapWindowSolidAngAtRefPtWtd</span> <span class="o">=</span> <span class="n">MapWindowSolidAngAtRefPtWtd</span><span class="p">)</span>
<a name="ln-1378"></a>        <span class="c">!           ---------------------</span>
<a name="ln-1379"></a>        <span class="c">! ---------- WINDOW ELEMENT LOOP ----------</span>
<a name="ln-1380"></a>        <span class="c">!           ---------------------</span>
<a name="ln-1381"></a>        <span class="n">WinEl</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1382"></a>
<a name="ln-1383"></a>        <span class="k">DO </span><span class="n">IX</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NWX</span>
<a name="ln-1384"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Rectangle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1385"></a><span class="k">            </span><span class="n">NWYlim</span> <span class="o">=</span> <span class="n">NWY</span>
<a name="ln-1386"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Triangle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1387"></a><span class="k">            </span><span class="n">NWYlim</span> <span class="o">=</span> <span class="n">NWY</span> <span class="o">-</span> <span class="n">IX</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1388"></a>          <span class="k">END IF</span>
<a name="ln-1389"></a>
<a name="ln-1390"></a><span class="k">          DO </span><span class="n">IY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NWYlim</span>
<a name="ln-1391"></a>
<a name="ln-1392"></a>            <span class="n">WinEl</span> <span class="o">=</span> <span class="n">WinEl</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1393"></a>
<a name="ln-1394"></a>            <span class="k">CALL </span><span class="n">FigureDayltgCoeffsAtPointsForWindowElements</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="n">IL</span><span class="p">,</span> <span class="n">loopwin</span><span class="p">,</span> <span class="n">CalledForMapPoint</span><span class="p">,</span> <span class="n">WinEl</span><span class="p">,</span> <span class="n">IWIN</span><span class="p">,</span> <span class="n">IWIN2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1395"></a>                                                     <span class="n">IX</span><span class="p">,</span>  <span class="n">IY</span><span class="p">,</span>   <span class="n">SkyObstructionMult</span><span class="p">,</span><span class="n">W2</span><span class="p">,</span><span class="n">W21</span><span class="p">,</span> <span class="n">W23</span><span class="p">,</span> <span class="n">RREF</span><span class="p">,</span> <span class="n">NWYlim</span><span class="p">,</span><span class="n">VIEWVC2</span><span class="p">,&amp;</span>
<a name="ln-1396"></a>                                                     <span class="n">DWX</span><span class="p">,</span> <span class="n">DWY</span><span class="p">,</span><span class="n">DAXY</span> <span class="p">,</span><span class="n">U2</span><span class="p">,</span> <span class="n">U23</span><span class="p">,</span><span class="n">U21</span><span class="p">,</span><span class="n">RWIN</span><span class="p">,</span> <span class="n">RWIN2</span><span class="p">,</span> <span class="n">RAY</span><span class="p">,</span> <span class="n">PHRAY</span><span class="p">,</span> <span class="n">LSHCAL</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1397"></a>                                                     <span class="n">COSB</span><span class="p">,</span> <span class="n">ObTrans</span><span class="p">,</span><span class="n">TVISB</span><span class="p">,</span> <span class="n">DOMEGA</span><span class="p">,</span> <span class="n">THRAY</span><span class="p">,</span> <span class="n">IHitIntObs</span><span class="p">,</span> <span class="n">IHitExtObs</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1398"></a>                                                     <span class="n">WNORM2</span><span class="p">,</span> <span class="n">ExtWinType</span><span class="p">,</span> <span class="n">IConst</span><span class="p">,</span><span class="n">RREF2</span> <span class="p">,</span> <span class="n">Triangle</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1399"></a>                                                     <span class="n">TVISIntWin</span><span class="p">,</span> <span class="n">TVISIntWinDisk</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1400"></a>                                                     <span class="n">MapNum</span> <span class="o">=</span><span class="n">MapNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1401"></a>                                                     <span class="n">MapWindowSolidAngAtRefPt</span> <span class="o">=</span> <span class="n">MapWindowSolidAngAtRefPt</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1402"></a>                                                     <span class="n">MapWindowSolidAngAtRefPtWtd</span> <span class="o">=</span> <span class="n">MapWindowSolidAngAtRefPtWtd</span><span class="p">)</span>
<a name="ln-1403"></a>            <span class="c">!           -------------------</span>
<a name="ln-1404"></a>            <span class="c">! ---------- SUN POSITION LOOP ----------</span>
<a name="ln-1405"></a>            <span class="c">!           -------------------</span>
<a name="ln-1406"></a>
<a name="ln-1407"></a>            <span class="c">! Sun position counter. Used to avoid calculating various quantities</span>
<a name="ln-1408"></a>            <span class="c">! that do not depend on sun position.</span>
<a name="ln-1409"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1410"></a><span class="k">              </span><span class="n">ISunPos</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1411"></a>              <span class="k">DO </span><span class="n">IHR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-1412"></a>                <span class="k">CALL </span><span class="n">FigureDayltgCoeffsAtPointsForSunPosition</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="n">IL</span><span class="p">,</span> <span class="n">IX</span><span class="p">,</span> <span class="n">NWX</span><span class="p">,</span> <span class="n">IY</span><span class="p">,</span> <span class="n">NWYlim</span><span class="p">,</span> <span class="n">WinEl</span><span class="p">,</span> <span class="n">IWIN</span><span class="p">,</span> <span class="n">IWIN2</span><span class="p">,</span> <span class="n">IHR</span><span class="p">,</span> <span class="n">IsunPos</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1413"></a>                                                              <span class="n">SkyObstructionMult</span><span class="p">,</span><span class="n">RWIN2</span><span class="p">,</span> <span class="n">RAY</span><span class="p">,</span> <span class="n">PHRAY</span><span class="p">,</span> <span class="n">LSHCAL</span><span class="p">,</span> <span class="n">InShelfSurf</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1414"></a>                                                              <span class="n">COSB</span><span class="p">,</span> <span class="n">ObTrans</span><span class="p">,</span><span class="n">TVISB</span><span class="p">,</span> <span class="n">DOMEGA</span><span class="p">,</span> <span class="n">ICtrl</span> <span class="p">,</span> <span class="n">ShType</span><span class="p">,</span> <span class="n">BlNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1415"></a>                                                              <span class="n">THRAY</span> <span class="p">,</span> <span class="n">WNORM2</span><span class="p">,</span> <span class="n">ExtWinType</span><span class="p">,</span> <span class="n">IConst</span><span class="p">,</span><span class="n">AZVIEW</span><span class="p">,</span> <span class="n">RREF2</span><span class="p">,</span> <span class="n">loopwin</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1416"></a>                                                              <span class="n">IHitIntObs</span><span class="p">,</span><span class="n">IHitExtObs</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1417"></a>                                                              <span class="n">CalledForMapPoint</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1418"></a>                                                     <span class="n">TVISIntWin</span><span class="p">,</span> <span class="n">TVISIntWinDisk</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1419"></a>                                                              <span class="n">MapNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1420"></a>                                                              <span class="n">MapWindowSolidAngAtRefPtWtd</span> <span class="o">=</span> <span class="n">MapWindowSolidAngAtRefPtWtd</span> <span class="p">)</span>
<a name="ln-1421"></a>              <span class="n">ENDDO</span> <span class="c">! End of hourly sun position loop, IHR</span>
<a name="ln-1422"></a>            <span class="k">ELSE</span>
<a name="ln-1423"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MySunIsUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1424"></a><span class="k">                 </span><span class="n">ISunPos</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1425"></a>                 <span class="n">MySunIsUpFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1426"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MySunIsUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1427"></a><span class="k">                 </span><span class="n">ISunPos</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1428"></a>              <span class="n">ELSEIF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MySunIsUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1429"></a><span class="k">                </span><span class="n">MySunIsUpFlag</span> <span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1430"></a>                <span class="n">ISunPos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-1431"></a>              <span class="n">ELSEIF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MySunIsUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1432"></a><span class="k">                </span><span class="n">ISunPos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-1433"></a>              <span class="n">ENDIF</span>
<a name="ln-1434"></a>              <span class="k">CALL </span><span class="n">FigureDayltgCoeffsAtPointsForSunPosition</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="n">IL</span><span class="p">,</span> <span class="n">IX</span><span class="p">,</span> <span class="n">NWX</span><span class="p">,</span> <span class="n">IY</span><span class="p">,</span> <span class="n">NWYlim</span><span class="p">,</span> <span class="n">WinEl</span><span class="p">,</span> <span class="n">IWIN</span><span class="p">,</span> <span class="n">IWIN2</span><span class="p">,</span> <span class="n">HourOfDay</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1435"></a>                                                            <span class="n">ISunPos</span><span class="p">,</span><span class="n">SkyObstructionMult</span><span class="p">,</span><span class="n">RWIN2</span><span class="p">,</span> <span class="n">RAY</span><span class="p">,</span> <span class="n">PHRAY</span><span class="p">,</span> <span class="n">LSHCAL</span><span class="p">,</span> <span class="n">InShelfSurf</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1436"></a>                                                            <span class="n">COSB</span><span class="p">,</span><span class="n">ObTrans</span><span class="p">,</span><span class="n">TVISB</span><span class="p">,</span> <span class="n">DOMEGA</span><span class="p">,</span> <span class="n">ICtrl</span><span class="p">,</span> <span class="n">ShType</span><span class="p">,</span> <span class="n">BlNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1437"></a>                                                            <span class="n">THRAY</span><span class="p">,</span> <span class="n">WNORM2</span><span class="p">,</span> <span class="n">ExtWinType</span><span class="p">,</span> <span class="n">IConst</span><span class="p">,</span><span class="n">AZVIEW</span><span class="p">,</span> <span class="n">RREF2</span><span class="p">,</span> <span class="n">loopwin</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1438"></a>                                                            <span class="n">IHitIntObs</span><span class="p">,</span> <span class="n">IHitExtObs</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1439"></a>                                                            <span class="n">CalledForMapPoint</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1440"></a>                                                            <span class="n">TVISIntWin</span><span class="p">,</span> <span class="n">TVISIntWinDisk</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1441"></a>                                                            <span class="n">MapNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1442"></a>                                                            <span class="n">MapWindowSolidAngAtRefPtWtd</span> <span class="o">=</span> <span class="n">MapWindowSolidAngAtRefPtWtd</span>  <span class="p">)</span>
<a name="ln-1443"></a>
<a name="ln-1444"></a>            <span class="n">ENDIF</span>
<a name="ln-1445"></a>          <span class="k">END DO</span> <span class="c">! End of window Y-element loop, IY</span>
<a name="ln-1446"></a>        <span class="k">END DO</span> <span class="c">! End of window X-element loop, IX</span>
<a name="ln-1447"></a>
<a name="ln-1448"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1449"></a>          <span class="c">! Loop again over hourly sun positions and calculate daylight factors by adding</span>
<a name="ln-1450"></a>          <span class="c">! direct and inter-reflected illum components, then dividing by exterior horiz illum.</span>
<a name="ln-1451"></a>          <span class="c">! Also calculate corresponding glare factors.</span>
<a name="ln-1452"></a>          <span class="n">ILB</span><span class="o">=</span><span class="n">IL</span>
<a name="ln-1453"></a>          <span class="k">DO </span><span class="n">IHR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-1454"></a>            <span class="k">CALL </span><span class="n">FigureMapPointDayltgFactorsToAddIllums</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">ILB</span><span class="p">,</span> <span class="n">IHR</span><span class="p">,</span>  <span class="n">iWin</span><span class="p">,</span> <span class="n">loopWin</span><span class="p">,</span> <span class="n">NWX</span> <span class="p">,</span> <span class="n">NWY</span> <span class="p">,</span> <span class="n">ICtrl</span> <span class="p">)</span>
<a name="ln-1455"></a>          <span class="k">END DO</span> <span class="c">! End of sun position loop, IHR</span>
<a name="ln-1456"></a>        <span class="k">ELSE</span>
<a name="ln-1457"></a><span class="k">          </span><span class="n">ILB</span><span class="o">=</span><span class="n">IL</span>
<a name="ln-1458"></a>          <span class="k">CALL </span><span class="n">FigureMapPointDayltgFactorsToAddIllums</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">ILB</span><span class="p">,</span> <span class="n">HourOfDay</span><span class="p">,</span>  <span class="n">iWin</span><span class="p">,</span> <span class="n">loopWin</span><span class="p">,</span> <span class="n">NWX</span> <span class="p">,</span> <span class="n">NWY</span> <span class="p">,</span> <span class="n">ICtrl</span> <span class="p">)</span>
<a name="ln-1459"></a>
<a name="ln-1460"></a>        <span class="n">ENDIF</span>
<a name="ln-1461"></a>
<a name="ln-1462"></a>      <span class="k">END DO</span> <span class="c">! End of window loop, loopwin - IWin</span>
<a name="ln-1463"></a>
<a name="ln-1464"></a>    <span class="k">END DO</span> <span class="c">! End of reference point loop, IL</span>
<a name="ln-1465"></a>
<a name="ln-1466"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">MapWindowSolidAngAtRefPt</span><span class="p">)</span>
<a name="ln-1467"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">MapWindowSolidAngAtRefPtWtd</span><span class="p">)</span>
<a name="ln-1468"></a>
<a name="ln-1469"></a>  <span class="k">END DO</span>  <span class="c">! MapNum</span>
<a name="ln-1470"></a>
<a name="ln-1471"></a>  <span class="k">RETURN</span>
<a name="ln-1472"></a>
<a name="ln-1473"></a><span class="k">END SUBROUTINE </span><span class="n">CalcDayltgCoeffsMapPoints</span>
<a name="ln-1474"></a>
<a name="ln-1475"></a><span class="k">SUBROUTINE </span><span class="n">FigureDayltgCoeffsAtPointsSetupForWindow</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">,</span> <span class="n">LoopWin</span><span class="p">,</span> <span class="n">CalledFrom</span><span class="p">,</span> <span class="n">RREF</span><span class="p">,</span><span class="n">VIEWVC</span><span class="p">,</span> <span class="n">iWin</span><span class="p">,</span> <span class="n">iWin2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1476"></a>                                                    <span class="n">NWX</span><span class="p">,</span> <span class="n">NWY</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span><span class="n">W3</span><span class="p">,</span><span class="n">W21</span><span class="p">,</span> <span class="n">W23</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1477"></a>                                                    <span class="n">LSHCAL</span><span class="p">,</span><span class="n">InShelfSurf</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-1478"></a>                                                    <span class="n">ICtrl</span><span class="p">,</span> <span class="n">ShType</span><span class="p">,</span> <span class="n">BlNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1479"></a>                                                    <span class="n">WNORM2</span><span class="p">,</span> <span class="n">ExtWinType</span><span class="p">,</span> <span class="n">IConst</span><span class="p">,</span>   <span class="n">RREF2</span><span class="p">,</span> <span class="n">DWX</span><span class="p">,</span> <span class="n">DWY</span><span class="p">,</span> <span class="n">DAXY</span><span class="p">,</span> <span class="n">U2</span><span class="p">,</span> <span class="n">U23</span><span class="p">,</span><span class="n">U21</span><span class="p">,</span><span class="n">VIEWVC2</span><span class="p">,&amp;</span>
<a name="ln-1480"></a>                                                    <span class="n">Rectangle</span><span class="p">,</span> <span class="n">Triangle</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1481"></a>                                                    <span class="n">MapNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1482"></a>                                                    <span class="n">MapWindowSolidAngAtRefPt</span><span class="p">,</span> <span class="n">MapWindowSolidAngAtRefPtWtd</span><span class="p">)</span>
<a name="ln-1483"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1484"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-1485"></a>          <span class="c">!       DATE WRITTEN   November 2012, refactor from legacy code by Fred Winklemann</span>
<a name="ln-1486"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1487"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1488"></a>
<a name="ln-1489"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1490"></a>          <span class="c">! collect code to setup calculations for each window for daylighting coefficients</span>
<a name="ln-1491"></a>
<a name="ln-1492"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1493"></a>          <span class="c">! switch as need to serve both reference points and map points based on calledFrom</span>
<a name="ln-1494"></a>
<a name="ln-1495"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1496"></a>          <span class="c">! na</span>
<a name="ln-1497"></a>
<a name="ln-1498"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1499"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-1500"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">POLYF</span><span class="p">,</span> <span class="n">InterpProfAng</span><span class="p">,</span> <span class="n">BlindBeamBeamTrans</span><span class="p">,</span> <span class="n">SafeDivide</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-1501"></a>  <span class="k">USE </span><span class="n">DaylightingDevices</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindTDDPipe</span>
<a name="ln-1502"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DetailedSolarTimestepIntegration</span>
<a name="ln-1503"></a>
<a name="ln-1504"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1505"></a>
<a name="ln-1506"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1507"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">LoopWin</span>
<a name="ln-1508"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ZoneNum</span>
<a name="ln-1509"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iRefPoint</span>
<a name="ln-1510"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CalledFrom</span> <span class="c">! indicate  which type of routine called this routine</span>
<a name="ln-1511"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RREF</span>        <span class="c">! Location of a reference point in absolute coordinate system</span>
<a name="ln-1512"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VIEWVC</span>          <span class="c">! View vector in absolute coordinate system</span>
<a name="ln-1513"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iWin</span>
<a name="ln-1514"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iWin2</span>
<a name="ln-1515"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NWX</span>
<a name="ln-1516"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NWY</span>
<a name="ln-1517"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">W2</span>                        <span class="c">! Second vertex of window</span>
<a name="ln-1518"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">W3</span>                        <span class="c">! Third vertex of window</span>
<a name="ln-1519"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W21</span>                       <span class="c">! Vector from window vertex 2 to window vertex 1</span>
<a name="ln-1520"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W23</span>                       <span class="c">! Vector from window vertex 2 to window vertex 3</span>
<a name="ln-1521"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LSHCAL</span>     <span class="c">! Interior shade calculation flag:  0=not yet calculated, 1=already calculated</span>
<a name="ln-1522"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">InShelfSurf</span>  <span class="c">! Inside daylighting shelf surface number</span>
<a name="ln-1523"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ICtrl</span>                        <span class="c">! Window control counter</span>
<a name="ln-1524"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ShType</span>                       <span class="c">! Window shading type</span>
<a name="ln-1525"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">BlNum</span>                        <span class="c">! Window blind number</span>
<a name="ln-1526"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WNORM2</span>                    <span class="c">! Unit vector normal to window</span>
<a name="ln-1527"></a>  <span class="kt">INTEGER</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ExtWinType</span>                   <span class="c">! Exterior window type (InZoneExtWin, AdjZoneExtWin, NotInOrAdjZoneExtWin)</span>
<a name="ln-1528"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">IConst</span>                       <span class="c">! Construction counter</span>
<a name="ln-1529"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RREF2</span>  <span class="c">! Location of virtual reference point in absolute coordinate system</span>
<a name="ln-1530"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DWX</span>                          <span class="c">! Horizontal dimension of window element (m)</span>
<a name="ln-1531"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DWY</span>                          <span class="c">! Vertical dimension of window element (m)</span>
<a name="ln-1532"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DAXY</span>                         <span class="c">! Area of window element</span>
<a name="ln-1533"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">U2</span>              <span class="c">! Second vertex of window for TDD:DOME (if exists)</span>
<a name="ln-1534"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">U21</span>                       <span class="c">! Vector from window vertex 2 to window vertex 1 for TDD:DOME (if exists)</span>
<a name="ln-1535"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">U23</span>                       <span class="c">! Vector from window vertex 2 to window vertex 3 for TDD:DOME (if exists)</span>
<a name="ln-1536"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VIEWVC2</span>                   <span class="c">! Virtual view vector in absolute coordinate system</span>
<a name="ln-1537"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Rectangle</span>                    <span class="c">! True if window is rectangular</span>
<a name="ln-1538"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Triangle</span>                     <span class="c">! True if window is triangular</span>
<a name="ln-1539"></a>  <span class="kt">INTEGER</span><span class="p">,</span>  <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">MapNum</span>
<a name="ln-1540"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>  <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">MapWindowSolidAngAtRefPt</span>
<a name="ln-1541"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>  <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">MapWindowSolidAngAtRefPtWtd</span>
<a name="ln-1542"></a>
<a name="ln-1543"></a>
<a name="ln-1544"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1545"></a>          <span class="c">! na</span>
<a name="ln-1546"></a>
<a name="ln-1547"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1548"></a>          <span class="c">! na</span>
<a name="ln-1549"></a>
<a name="ln-1550"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1551"></a>          <span class="c">! na</span>
<a name="ln-1552"></a>
<a name="ln-1553"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1554"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ZoneNumThisWin</span>               <span class="c">! A window&#39;s zone number</span>
<a name="ln-1555"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ShelfNum</span>                     <span class="c">! Daylighting shelf object number</span>
<a name="ln-1556"></a>
<a name="ln-1557"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W1</span>             <span class="c">! First vertex of window (where vertices are numbered</span>
<a name="ln-1558"></a>                                            <span class="c">! counter-clockwise starting at upper left as viewed</span>
<a name="ln-1559"></a>                                            <span class="c">! from inside of room</span>
<a name="ln-1560"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IConstShaded</span>                 <span class="c">! Shaded construction counter</span>
<a name="ln-1561"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ScNum</span>                        <span class="c">! Window screen number</span>
<a name="ln-1562"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WW</span>                           <span class="c">! Window width (m)</span>
<a name="ln-1563"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HW</span>                           <span class="c">! Window height (m)</span>
<a name="ln-1564"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WC</span>             <span class="c">! Center point of window</span>
<a name="ln-1565"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">REFWC</span>          <span class="c">! Vector from reference point to center of window</span>
<a name="ln-1566"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WNORM</span>          <span class="c">! Unit vector normal to window (pointing away from room)</span>
<a name="ln-1567"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NDIVX</span>                        <span class="c">! Number of window x divisions for daylighting calc</span>
<a name="ln-1568"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NDIVY</span>                        <span class="c">! Number of window y divisions for daylighting calc</span>
<a name="ln-1569"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ALF</span>                          <span class="c">! Distance from reference point to window plane (m)</span>
<a name="ln-1570"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W2REF</span>          <span class="c">! Vector from window origin to project of ref. pt. on window plane</span>
<a name="ln-1571"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">D1a</span>                          <span class="c">! Projection of vector from window origin to reference</span>
<a name="ln-1572"></a>                                            <span class="c">!  on window X  axis (m)</span>
<a name="ln-1573"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">D1b</span>                          <span class="c">! Projection of vector from window origin to reference</span>
<a name="ln-1574"></a>                                            <span class="c">!  on window Y axis (m)</span>
<a name="ln-1575"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SolidAngExtWin</span>               <span class="c">! Approx. solid angle subtended by an ext. window wrt ref pt</span>
<a name="ln-1576"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SolidAngMinIntWin</span>            <span class="c">! Approx. smallest solid angle subtended by an int. window wrt ref pt</span>
<a name="ln-1577"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SolidAngRatio</span>                <span class="c">! Ratio of SolidAngExtWin and SolidAngMinIntWin</span>
<a name="ln-1578"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">PipeNum</span>                      <span class="c">! TDD pipe object number</span>
<a name="ln-1579"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">REFD</span>           <span class="c">! Vector from ref pt to center of win in TDD:DIFFUSER coord sys (if exists)</span>
<a name="ln-1580"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VIEWVD</span>         <span class="c">! Virtual view vector in TDD:DIFFUSER coord sys (if exists)</span>
<a name="ln-1581"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">U1</span>             <span class="c">! First vertex of window for TDD:DOME (if exists)</span>
<a name="ln-1582"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">U3</span>             <span class="c">! Third vertex of window for TDD:DOME (if exists)</span>
<a name="ln-1583"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SinCornerAng</span>                 <span class="c">! For triangle, sine of corner angle of window element</span>
<a name="ln-1584"></a>
<a name="ln-1585"></a>  <span class="c">! Complex fenestration variables</span>
<a name="ln-1586"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CplxFenState</span>                 <span class="c">! Current complex fenestration state</span>
<a name="ln-1587"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NReflSurf</span>                    <span class="c">! Number of blocked beams for complex fenestration</span>
<a name="ln-1588"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NRefPts</span>                      <span class="c">! number of reference points</span>
<a name="ln-1589"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">WinEl</span>                        <span class="c">! Current window element</span>
<a name="ln-1590"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ICplxFen</span>                     <span class="c">! Complex fenestration counter</span>
<a name="ln-1591"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">RayIndex</span>
<a name="ln-1592"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">RayVector</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1593"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">TransBeam</span>                  <span class="c">! Obstructions transmittance for incoming BSDF rays (temporary variable)</span>
<a name="ln-1594"></a>
<a name="ln-1595"></a>  <span class="c">! Complex fenestration variables</span>
<a name="ln-1596"></a>  <span class="n">CplxFenState</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1597"></a>  <span class="n">NReflSurf</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1598"></a>  <span class="n">WinEl</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1599"></a>  <span class="n">TransBeam</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1600"></a>  <span class="n">NRefPts</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1601"></a>
<a name="ln-1602"></a>  <span class="n">IWin</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">loopwin</span><span class="p">)</span>
<a name="ln-1603"></a>
<a name="ln-1604"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Calledfrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1605"></a><span class="k">     </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPt</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">loopwin</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1606"></a>     <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">loopwin</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1607"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForMapPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1608"></a><span class="k">     </span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SolidAngAtMapPt</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">loopwin</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1609"></a>     <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SolidAngAtMapPtWtd</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">loopwin</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1610"></a>  <span class="n">ENDIF</span>
<a name="ln-1611"></a>  <span class="n">ZoneNumThisWin</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-1612"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ZoneNumThisWin</span> <span class="o">==</span> <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1613"></a><span class="k">    </span><span class="n">ExtWinType</span> <span class="o">=</span> <span class="n">InZoneExtWin</span>
<a name="ln-1614"></a>  <span class="k">ELSE</span>
<a name="ln-1615"></a><span class="k">    </span><span class="n">ExtWinType</span> <span class="o">=</span> <span class="n">AdjZoneExtWin</span>
<a name="ln-1616"></a>  <span class="k">END IF</span>
<a name="ln-1617"></a>
<a name="ln-1618"></a><span class="k">  </span><span class="n">IConst</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-1619"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">StormWinFlag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">IConst</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">StormWinConstruction</span>
<a name="ln-1620"></a>
<a name="ln-1621"></a>  <span class="c">! TH Added 6/29/2009.</span>
<a name="ln-1622"></a>  <span class="c">! For thermochromic windows, the daylight and glare factros are calculated for a base window cosntruction</span>
<a name="ln-1623"></a>  <span class="c">!  at base TC layer temperature. During each time step calculations at DayltgInteriorIllum,</span>
<a name="ln-1624"></a>  <span class="c">!  DayltgInteriorMapIllum, and DayltgGlare, the daylight and glare factors are adjusted by the visible</span>
<a name="ln-1625"></a>  <span class="c">!  transmittance ratio = VT of actual TC window based on last hour TC layer temperature / VT of the base TC window</span>
<a name="ln-1626"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TCFlag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1627"></a>    <span class="c">! For thermochromic windows, use the base window construction at base temperature of the TC layer</span>
<a name="ln-1628"></a>    <span class="n">IConst</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TCMasterConst</span>
<a name="ln-1629"></a>  <span class="n">ENDIF</span>
<a name="ln-1630"></a>
<a name="ln-1631"></a>  <span class="n">ICtrl</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span>
<a name="ln-1632"></a>  <span class="n">ShType</span> <span class="o">=</span> <span class="n">WSC_ST_NoShade</span> <span class="c">! &#39;NOSHADE&#39;</span>
<a name="ln-1633"></a>  <span class="n">BlNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1634"></a>  <span class="n">ScNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1635"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ICtrl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">ShType</span> <span class="o">=</span> <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ICtrl</span><span class="p">)%</span><span class="n">ShadingType</span>
<a name="ln-1636"></a>  <span class="n">BlNum</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">BlindNumber</span>
<a name="ln-1637"></a>  <span class="n">ScNum</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ScreenNumber</span>
<a name="ln-1638"></a>
<a name="ln-1639"></a>  <span class="n">ShelfNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Shelf</span>
<a name="ln-1640"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ShelfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1641"></a><span class="k">    </span><span class="n">InShelfSurf</span> <span class="o">=</span> <span class="n">Shelf</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Shelf</span><span class="p">)%</span><span class="n">InSurf</span> <span class="c">! Inside daylighting shelf present if &gt; 0</span>
<a name="ln-1642"></a>  <span class="k">ELSE</span>
<a name="ln-1643"></a><span class="k">    </span><span class="n">InShelfSurf</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1644"></a>  <span class="k">END IF</span>
<a name="ln-1645"></a>
<a name="ln-1646"></a><span class="k">  </span><span class="n">Rectangle</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1647"></a>  <span class="n">Triangle</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1648"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="n">Triangle</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1649"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="n">Rectangle</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1650"></a>
<a name="ln-1651"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Rectangle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1652"></a>    <span class="c">! Vertices of window (numbered counter-clockwise starting at upper left as viewed</span>
<a name="ln-1653"></a>    <span class="c">! from inside of room). Assumes original vertices are numbered counter-clockwise from</span>
<a name="ln-1654"></a>    <span class="c">! upper left as viewed from outside.</span>
<a name="ln-1655"></a>    <span class="n">W3</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1656"></a>    <span class="n">W2</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1657"></a>    <span class="n">W1</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1658"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Triangle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1659"></a><span class="k">    </span><span class="n">W3</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1660"></a>    <span class="n">W2</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1661"></a>    <span class="n">W1</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1662"></a>  <span class="k">END IF</span>
<a name="ln-1663"></a>
<a name="ln-1664"></a>  <span class="c">! Shade/blind calculation flag</span>
<a name="ln-1665"></a>  <span class="n">LSHCAL</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1666"></a>
<a name="ln-1667"></a>  <span class="c">! Visible transmittance at normal incidence</span>
<a name="ln-1668"></a>  <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">VisTransSelected</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1669"></a>                                         <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-1670"></a>  <span class="c">! For windows with switchable glazing, ratio of visible transmittance at normal</span>
<a name="ln-1671"></a>  <span class="c">! incidence for fully switched (dark) state to that of unswitched state</span>
<a name="ln-1672"></a>  <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">VisTransRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1673"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ICtrl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1674"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1675"></a><span class="k">      </span><span class="n">IConstShaded</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-1676"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">VisTransRatio</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-1677"></a>      <span class="n">SafeDivide</span><span class="p">(</span><span class="n">POLYF</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConstShaded</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">POLYF</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1678"></a>    <span class="k">END IF</span>
<a name="ln-1679"></a><span class="k">  END IF</span>
<a name="ln-1680"></a>
<a name="ln-1681"></a>  <span class="c">! Unit vectors from window vertex 2 to 1 and 2 to 3,</span>
<a name="ln-1682"></a>  <span class="c">! center point of window, and vector from ref pt to center of window</span>
<a name="ln-1683"></a>  <span class="n">W21</span> <span class="o">=</span> <span class="n">W1</span> <span class="o">-</span> <span class="n">W2</span>
<a name="ln-1684"></a>  <span class="n">W23</span> <span class="o">=</span> <span class="n">W3</span> <span class="o">-</span> <span class="n">W2</span>
<a name="ln-1685"></a>  <span class="n">HW</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">W21</span><span class="p">,</span><span class="n">W21</span><span class="p">))</span>
<a name="ln-1686"></a>  <span class="n">WW</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">W23</span><span class="p">,</span><span class="n">W23</span><span class="p">))</span>
<a name="ln-1687"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Rectangle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1688"></a><span class="k">    </span><span class="n">WC</span>  <span class="o">=</span> <span class="n">W2</span> <span class="o">+</span> <span class="p">(</span><span class="n">W23</span> <span class="o">+</span> <span class="n">W21</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.d0</span>
<a name="ln-1689"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Triangle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1690"></a><span class="k">    </span><span class="n">WC</span>  <span class="o">=</span> <span class="n">W2</span> <span class="o">+</span> <span class="p">(</span><span class="n">W23</span> <span class="o">+</span> <span class="n">W21</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.d0</span>
<a name="ln-1691"></a>  <span class="k">END IF</span>
<a name="ln-1692"></a><span class="k">  </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WinCenter</span> <span class="o">=</span> <span class="n">WC</span>
<a name="ln-1693"></a>  <span class="n">REFWC</span> <span class="o">=</span> <span class="n">WC</span> <span class="o">-</span> <span class="n">RREF</span>
<a name="ln-1694"></a>  <span class="c">! Unit vectors</span>
<a name="ln-1695"></a>  <span class="n">W21</span> <span class="o">=</span> <span class="n">W21</span><span class="o">/</span><span class="n">HW</span>
<a name="ln-1696"></a>  <span class="n">W23</span> <span class="o">=</span> <span class="n">W23</span><span class="o">/</span><span class="n">WW</span>
<a name="ln-1697"></a>
<a name="ln-1698"></a>  <span class="c">! Unit vector normal to window (pointing away from room)</span>
<a name="ln-1699"></a>  <span class="n">WNORM</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">lcsz</span>
<a name="ln-1700"></a>
<a name="ln-1701"></a>  <span class="c">! Initialize number of window elements</span>
<a name="ln-1702"></a>  <span class="n">NDIVX</span> <span class="o">=</span> <span class="mi">40</span>
<a name="ln-1703"></a>  <span class="n">NDIVY</span> <span class="o">=</span> <span class="mi">40</span>
<a name="ln-1704"></a>
<a name="ln-1705"></a>  <span class="c">! Distance from ref point to window plane</span>
<a name="ln-1706"></a>  <span class="n">ALF</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">WNORM</span><span class="p">,</span> <span class="n">REFWC</span><span class="p">))</span>
<a name="ln-1707"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Calledfrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1708"></a>    <span class="c">! Check if ref point to close to window due to input error (0.1524 m below is 0.5 ft)</span>
<a name="ln-1709"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ALF</span> <span class="o">&lt;</span> <span class="mf">0.1524d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ExtWinType</span> <span class="o">==</span> <span class="n">InZoneExtWin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1710"></a>      <span class="c">! Ref pt is close to window plane. Get vector from window</span>
<a name="ln-1711"></a>      <span class="c">! origin to projection of ref pt on window plane.</span>
<a name="ln-1712"></a>      <span class="n">W2REF</span> <span class="o">=</span> <span class="n">RREF</span> <span class="o">+</span> <span class="n">ALF</span> <span class="o">*</span> <span class="n">WNORM</span> <span class="o">-</span> <span class="n">W2</span>
<a name="ln-1713"></a>
<a name="ln-1714"></a>      <span class="n">D1a</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">W2REF</span><span class="p">,</span> <span class="n">W23</span><span class="p">)</span>
<a name="ln-1715"></a>      <span class="n">D1b</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">W2REF</span><span class="p">,</span> <span class="n">W21</span><span class="p">)</span>
<a name="ln-1716"></a>
<a name="ln-1717"></a><span class="c">!            ! Error message if ref pt is too close to window.</span>
<a name="ln-1718"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">D1a</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">D1b</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">D1b</span> <span class="o">&lt;=</span> <span class="n">HW</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">D1a</span> <span class="o">&lt;=</span> <span class="n">WW</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1719"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;CalcDaylightCoeffRefPoints: Daylighting calculation cannot be done for zone &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1720"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; because reference point #&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1721"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is less than 0.15m (6&quot;) from window plane &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1722"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Distance=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ALF</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1723"></a>                    <span class="s1">&#39;]. This is too close; check position of reference point.&#39;</span><span class="p">)</span>
<a name="ln-1724"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Program terminates due to preceding condition.&#39;</span><span class="p">)</span>
<a name="ln-1725"></a>      <span class="k">END IF</span>
<a name="ln-1726"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">ALF</span> <span class="o">&lt;</span> <span class="mf">0.1524d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">ExtWinType</span> <span class="o">==</span> <span class="n">AdjZoneExtWin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1727"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">RefErrIndex</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! only show error message once</span>
<a name="ln-1728"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;CalcDaylightCoeffRefPoints: For Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>        <span class="p">&amp;</span>
<a name="ln-1729"></a>            <span class="s1">&#39;&quot; External Window=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;in Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>      <span class="p">&amp;</span>
<a name="ln-1730"></a>             <span class="s1">&#39;&quot; reference point is less than 0.15m (6&quot;) from window plane &#39;</span><span class="p">)</span>
<a name="ln-1731"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Distance=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ALF</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m] to ref point=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1732"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RREF</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1733"></a>           <span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RREF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1734"></a>           <span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RREF</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;], Inaccuracy in Daylighting Calcs may result.&#39;</span><span class="p">)</span>
<a name="ln-1735"></a>        <span class="n">RefErrIndex</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1736"></a>      <span class="n">ENDIF</span>
<a name="ln-1737"></a>    <span class="k">END IF</span>
<a name="ln-1738"></a><span class="k">  </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForMapPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1739"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ALF</span> <span class="o">&lt;</span> <span class="mf">0.1524d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">ExtWinType</span> <span class="o">==</span> <span class="n">AdjZoneExtWin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1740"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MapErrIndex</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! only show error message once</span>
<a name="ln-1741"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;CalcDaylightCoeffMapPoints: For Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>        <span class="p">&amp;</span>
<a name="ln-1742"></a>           <span class="s1">&#39;&quot; External Window=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;in Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>      <span class="p">&amp;</span>
<a name="ln-1743"></a>           <span class="s1">&#39;&quot; map point is less than 0.15m (6&quot;) from window plane &#39;</span><span class="p">)</span>
<a name="ln-1744"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Distance=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ALF</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m] map point=[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1745"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RREF</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1746"></a>           <span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RREF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1747"></a>           <span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RREF</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;], Inaccuracy in Map Calcs may result.&#39;</span><span class="p">)</span>
<a name="ln-1748"></a>        <span class="n">MapErrIndex</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1749"></a>      <span class="n">ENDIF</span>
<a name="ln-1750"></a>    <span class="k">END IF</span>
<a name="ln-1751"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-1752"></a>  <span class="c">! Number of window elements in X and Y for daylighting calculation</span>
<a name="ln-1753"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ALF</span> <span class="o">&gt;</span> <span class="mf">0.1524d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1754"></a><span class="k">    </span><span class="n">NDIVX</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="mf">4.d0</span> <span class="o">*</span> <span class="n">WW</span> <span class="o">/</span> <span class="n">ALF</span><span class="p">)</span>
<a name="ln-1755"></a>    <span class="n">NDIVY</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="mf">4.d0</span> <span class="o">*</span> <span class="n">HW</span> <span class="o">/</span> <span class="n">ALF</span><span class="p">)</span>
<a name="ln-1756"></a>  <span class="n">ENDIF</span>
<a name="ln-1757"></a>
<a name="ln-1758"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ExtWinType</span> <span class="o">==</span> <span class="n">AdjZoneExtWin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1759"></a>    <span class="c">! Adjust number of exterior window elements to give acceptable number of rays through</span>
<a name="ln-1760"></a>    <span class="c">! interior windows in the zone (for accuracy of interior window daylighting calculation)</span>
<a name="ln-1761"></a>    <span class="n">SolidAngExtWin</span> <span class="o">=</span> <span class="n">SafeDivide</span><span class="p">(</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DividerArea</span><span class="p">)</span> <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Multiplier</span> <span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1762"></a>                                                      <span class="n">ALF</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1763"></a>    <span class="n">SolidAngMinIntWin</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinIntWinSolidAng</span>
<a name="ln-1764"></a>    <span class="n">SolidAngRatio</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SolidAngExtWin</span><span class="o">/</span><span class="n">SolidAngMinIntWin</span><span class="p">)</span>
<a name="ln-1765"></a>    <span class="n">NDIVX</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">SolidAngRatio</span><span class="p">)</span><span class="o">*</span><span class="n">NDIVX</span>
<a name="ln-1766"></a>    <span class="n">NDIVY</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">SolidAngRatio</span><span class="p">)</span><span class="o">*</span><span class="n">NDIVY</span>
<a name="ln-1767"></a>  <span class="k">END IF</span>
<a name="ln-1768"></a>
<a name="ln-1769"></a><span class="k">  </span><span class="n">NWX</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="n">NDIVX</span><span class="p">)</span>
<a name="ln-1770"></a>  <span class="n">NWY</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="n">NDIVY</span><span class="p">)</span>
<a name="ln-1771"></a>
<a name="ln-1772"></a>  <span class="c">! Discretization of triangle is simpler if NWX = NWY</span>
<a name="ln-1773"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Triangle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1774"></a><span class="k">    </span><span class="n">NWX</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">NWX</span><span class="p">,</span><span class="n">NWY</span><span class="p">)</span>
<a name="ln-1775"></a>    <span class="n">NWY</span> <span class="o">=</span> <span class="n">NWX</span>
<a name="ln-1776"></a>  <span class="k">END IF</span>
<a name="ln-1777"></a>
<a name="ln-1778"></a>  <span class="c">! Edge lengths of window elements</span>
<a name="ln-1779"></a>  <span class="n">DWX</span> <span class="o">=</span> <span class="n">WW</span> <span class="o">/</span> <span class="n">NWX</span>
<a name="ln-1780"></a>  <span class="n">DWY</span> <span class="o">=</span> <span class="n">HW</span> <span class="o">/</span> <span class="n">NWY</span>
<a name="ln-1781"></a>
<a name="ln-1782"></a>  <span class="c">! Azimuth and altitude of window normal</span>
<a name="ln-1783"></a>  <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Phi</span> <span class="o">=</span> <span class="nb">ASIN</span><span class="p">(</span><span class="n">WNORM</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-1784"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">WNORM</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">1.0d-5</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">WNORM</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">1.0d-5</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1785"></a><span class="k">    </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Theta</span> <span class="o">=</span> <span class="n">ATAN2</span><span class="p">(</span><span class="n">WNORM</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">WNORM</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1786"></a>  <span class="k">ELSE</span>
<a name="ln-1787"></a><span class="k">    </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Theta</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1788"></a>  <span class="k">END IF</span>
<a name="ln-1789"></a>
<a name="ln-1790"></a>  <span class="c">! Recalculation of values for TDD:DOME</span>
<a name="ln-1791"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1792"></a>
<a name="ln-1793"></a>    <span class="c">! Look up the TDD:DOME object</span>
<a name="ln-1794"></a>    <span class="n">PipeNum</span> <span class="o">=</span> <span class="n">FindTDDPipe</span><span class="p">(</span><span class="n">IWin</span><span class="p">)</span>
<a name="ln-1795"></a>    <span class="n">IWin2</span> <span class="o">=</span> <span class="n">TDDPipe</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">)%</span><span class="n">Dome</span>
<a name="ln-1796"></a>
<a name="ln-1797"></a>    <span class="c">! Calculate reference point coords relative to the diffuser coordinate system</span>
<a name="ln-1798"></a>    <span class="c">! W21, W23, and WNORM are the unit vectors</span>
<a name="ln-1799"></a>    <span class="n">REFD</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">REFWC</span><span class="p">,</span><span class="n">W21</span><span class="p">)</span>
<a name="ln-1800"></a>    <span class="n">REFD</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">REFWC</span><span class="p">,</span><span class="n">W23</span><span class="p">)</span>
<a name="ln-1801"></a>    <span class="n">REFD</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">REFWC</span><span class="p">,</span><span class="n">WNORM</span><span class="p">)</span>
<a name="ln-1802"></a>
<a name="ln-1803"></a>    <span class="c">! Calculate view vector coords relative to the diffuser coordinate system</span>
<a name="ln-1804"></a>    <span class="n">VIEWVD</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">VIEWVC</span><span class="p">,</span><span class="n">W21</span><span class="p">)</span>
<a name="ln-1805"></a>    <span class="n">VIEWVD</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">VIEWVC</span><span class="p">,</span><span class="n">W23</span><span class="p">)</span>
<a name="ln-1806"></a>    <span class="n">VIEWVD</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">VIEWVC</span><span class="p">,</span><span class="n">WNORM</span><span class="p">)</span>
<a name="ln-1807"></a>
<a name="ln-1808"></a>    <span class="n">U3</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1809"></a>    <span class="n">U2</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1810"></a>
<a name="ln-1811"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1812"></a>      <span class="c">! Vertices of window (numbered counter-clockwise starting</span>
<a name="ln-1813"></a>      <span class="c">! at upper left as viewed from inside of room)</span>
<a name="ln-1814"></a>      <span class="c">! Assumes original vertices are numbered counter-clockwise from</span>
<a name="ln-1815"></a>      <span class="c">! upper left as viewed from outside.</span>
<a name="ln-1816"></a>      <span class="n">U3</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1817"></a>      <span class="n">U2</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1818"></a>      <span class="n">U1</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1819"></a>    <span class="k">ELSE IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1820"></a><span class="k">      </span><span class="n">U3</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1821"></a>      <span class="n">U2</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1822"></a>      <span class="n">U1</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1823"></a>    <span class="k">END IF</span>
<a name="ln-1824"></a>
<a name="ln-1825"></a>    <span class="c">! Unit vectors from window vertex 2 to 1 and 2 to 3,</span>
<a name="ln-1826"></a>    <span class="c">! center point of window, and vector from ref pt to center of window</span>
<a name="ln-1827"></a>    <span class="n">U21</span> <span class="o">=</span> <span class="n">U1</span> <span class="o">-</span> <span class="n">U2</span>
<a name="ln-1828"></a>    <span class="n">U23</span> <span class="o">=</span> <span class="n">U3</span> <span class="o">-</span> <span class="n">U2</span>
<a name="ln-1829"></a>    <span class="n">HW</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">U21</span><span class="p">,</span><span class="n">U21</span><span class="p">))</span>
<a name="ln-1830"></a>    <span class="n">WW</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">U23</span><span class="p">,</span><span class="n">U23</span><span class="p">))</span>
<a name="ln-1831"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1832"></a><span class="k">      </span><span class="n">WC</span> <span class="o">=</span> <span class="n">U2</span> <span class="o">+</span> <span class="p">(</span><span class="n">U23</span> <span class="o">+</span> <span class="n">U21</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.d0</span>
<a name="ln-1833"></a>    <span class="k">ELSE IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1834"></a><span class="k">      </span><span class="n">WC</span> <span class="o">=</span> <span class="n">U2</span> <span class="o">+</span> <span class="p">(</span><span class="n">U23</span> <span class="o">+</span> <span class="n">U21</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.0d0</span>
<a name="ln-1835"></a>    <span class="k">END IF</span>
<a name="ln-1836"></a><span class="k">    </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">WinCenter</span> <span class="o">=</span> <span class="n">WC</span>
<a name="ln-1837"></a>    <span class="c">! Unit vectors</span>
<a name="ln-1838"></a>    <span class="n">U21</span> <span class="o">=</span> <span class="n">U21</span> <span class="o">/</span> <span class="n">HW</span>
<a name="ln-1839"></a>    <span class="n">U23</span> <span class="o">=</span> <span class="n">U23</span> <span class="o">/</span> <span class="n">WW</span>
<a name="ln-1840"></a>
<a name="ln-1841"></a>    <span class="c">! Unit vector normal to dome (pointing away from TDD)</span>
<a name="ln-1842"></a>    <span class="c">! These are specific to the exterior.</span>
<a name="ln-1843"></a>    <span class="c">! NOTE:  Preserve WNORM for later in the code.</span>
<a name="ln-1844"></a>    <span class="k">CALL </span><span class="n">DayltgCrossProduct</span><span class="p">(</span><span class="n">U21</span><span class="p">,</span> <span class="n">U23</span><span class="p">,</span> <span class="n">WNORM2</span><span class="p">)</span>
<a name="ln-1845"></a>    <span class="n">WNORM2</span> <span class="o">=</span> <span class="n">WNORM2</span> <span class="o">/</span> <span class="p">(</span><span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">WNORM2</span><span class="p">,</span><span class="n">WNORM2</span><span class="p">)))</span>
<a name="ln-1846"></a>
<a name="ln-1847"></a>    <span class="c">! Azimuth and altitude of dome normal</span>
<a name="ln-1848"></a>    <span class="c">! These are specific to the exterior.</span>
<a name="ln-1849"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">Phi</span> <span class="o">=</span> <span class="nb">ASIN</span><span class="p">(</span><span class="n">WNORM2</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-1850"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">WNORM2</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">1.0d-5</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">WNORM2</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">1.0d-5</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1851"></a><span class="k">      </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">Theta</span> <span class="o">=</span> <span class="n">ATAN2</span><span class="p">(</span><span class="n">WNORM2</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">WNORM2</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1852"></a>    <span class="k">ELSE</span>
<a name="ln-1853"></a><span class="k">      </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">Theta</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1854"></a>    <span class="k">END IF</span>
<a name="ln-1855"></a>
<a name="ln-1856"></a>    <span class="c">! Calculate new virtual reference point coords relative to dome coord system</span>
<a name="ln-1857"></a>    <span class="c">! W21, W23, and WNORM2 are now the unit vectors for the dome coord system</span>
<a name="ln-1858"></a>    <span class="n">REFWC</span> <span class="o">=</span> <span class="n">REFD</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">U21</span> <span class="o">+</span> <span class="n">REFD</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">U23</span> <span class="o">+</span> <span class="n">REFD</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">WNORM2</span>
<a name="ln-1859"></a>    <span class="n">RREF2</span> <span class="o">=</span> <span class="n">WC</span> <span class="o">-</span> <span class="n">REFWC</span>
<a name="ln-1860"></a>
<a name="ln-1861"></a>    <span class="c">! Calculate new virtual view vector coords relative to dome coord system</span>
<a name="ln-1862"></a>    <span class="n">VIEWVC2</span> <span class="o">=</span> <span class="n">VIEWVD</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">U21</span> <span class="o">+</span> <span class="n">VIEWVD</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">U23</span> <span class="o">+</span> <span class="n">VIEWVD</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">WNORM2</span>
<a name="ln-1863"></a>
<a name="ln-1864"></a>    <span class="c">! Copy several values from the diffuser so that DayltgInterReflectedIllum works correctly</span>
<a name="ln-1865"></a>    <span class="c">! These are specific to the interior.</span>
<a name="ln-1866"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">RhoCeilingWall</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">RhoCeilingWall</span>
<a name="ln-1867"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">RhoFloorWall</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">RhoFloorWall</span>
<a name="ln-1868"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">FractionUpgoing</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span>
<a name="ln-1869"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-1870"></a>
<a name="ln-1871"></a>  <span class="k">ELSE</span>
<a name="ln-1872"></a>    <span class="c">! This is not a TDD:DIFFUSER.  Make sure nothing is messed up for a regular window.</span>
<a name="ln-1873"></a>    <span class="n">IWin2</span> <span class="o">=</span> <span class="n">IWin</span>
<a name="ln-1874"></a>    <span class="n">WNORM2</span> <span class="o">=</span> <span class="n">WNORM</span>
<a name="ln-1875"></a>    <span class="n">RREF2</span> <span class="o">=</span> <span class="n">RREF</span>
<a name="ln-1876"></a>    <span class="n">VIEWVC2</span> <span class="o">=</span> <span class="n">VIEWVC</span>
<a name="ln-1877"></a>
<a name="ln-1878"></a>    <span class="n">U2</span> <span class="o">=</span> <span class="n">W2</span>
<a name="ln-1879"></a>    <span class="n">U21</span> <span class="o">=</span> <span class="n">W21</span>
<a name="ln-1880"></a>    <span class="n">U23</span> <span class="o">=</span> <span class="n">W23</span>
<a name="ln-1881"></a>  <span class="k">END IF</span>
<a name="ln-1882"></a>
<a name="ln-1883"></a>  <span class="c">! Initialize bsdf daylighting coefficients here.  Only one time initialization</span>
<a name="ln-1884"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">==</span> <span class="n">WindowBSDFModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1885"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylightingInitialized</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1886"></a><span class="k">      if</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForMapPoint</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1887"></a><span class="k">        </span><span class="n">NRefPts</span> <span class="o">=</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">TotalMapRefPoints</span>
<a name="ln-1888"></a>      <span class="k">else if</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1889"></a><span class="k">        </span><span class="n">NRefPts</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span>
<a name="ln-1890"></a>      <span class="k">end if</span>
<a name="ln-1891"></a><span class="k">      CALL </span><span class="n">InitializeCFSDaylighting</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="n">IWin</span><span class="p">,</span> <span class="n">NWX</span><span class="p">,</span> <span class="n">NWY</span><span class="p">,</span> <span class="n">VIEWVC2</span><span class="p">,</span> <span class="n">RREF</span><span class="p">,</span> <span class="n">NRefPts</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">,</span> <span class="n">CalledFrom</span><span class="p">,</span> <span class="n">MapNum</span><span class="p">)</span>
<a name="ln-1892"></a>      <span class="c">!if ((WinEl == (NWX * NWY)).and.(CalledFrom == CalledForMapPoint).and.(NRefPts == iRefPoint)) then</span>
<a name="ln-1893"></a>      <span class="k">if</span> <span class="p">((</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForMapPoint</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">NRefPts</span> <span class="o">==</span> <span class="n">iRefPoint</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1894"></a><span class="k">        </span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylightingInitialized</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1895"></a>      <span class="k">end if</span>
<a name="ln-1896"></a><span class="k">    END IF</span>
<a name="ln-1897"></a><span class="k">  END IF</span>
<a name="ln-1898"></a>
<a name="ln-1899"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1900"></a>    <span class="c">! Initialize sky and sun components of direct illuminance (arrays EDIRSK, EDIRSU, EDIRSUdisk)</span>
<a name="ln-1901"></a>    <span class="c">! and average window luminance (arrays AVWLSK, AVWLSU, AVWLSUdisk), at ref pt.</span>
<a name="ln-1902"></a>    <span class="n">EDIRSK</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1903"></a>    <span class="n">EDIRSU</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1904"></a>    <span class="n">EDIRSUdisk</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1905"></a>    <span class="n">AVWLSK</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1906"></a>    <span class="n">AVWLSU</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1907"></a>    <span class="n">AVWLSUdisk</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1908"></a>  <span class="k">ELSE</span>
<a name="ln-1909"></a><span class="k">    </span><span class="n">EDIRSK</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1910"></a>    <span class="n">EDIRSU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1911"></a>    <span class="n">EDIRSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1912"></a>    <span class="n">AVWLSK</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1913"></a>    <span class="n">AVWLSU</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1914"></a>    <span class="n">AVWLSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1915"></a>  <span class="n">ENDIF</span>
<a name="ln-1916"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Calledfrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1917"></a>      <span class="c">! Initialize solid angle subtended by window wrt ref pt</span>
<a name="ln-1918"></a>      <span class="c">! and solid angle weighted by glare position factor</span>
<a name="ln-1919"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolidAngAtRefPt</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1920"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1921"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForMapPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1922"></a>    <span class="c">! Initialize solid angle subtended by window wrt ref pt</span>
<a name="ln-1923"></a>    <span class="c">! and solid angle weighted by glare position factor</span>
<a name="ln-1924"></a>    <span class="n">MapWindowSolidAngAtRefPt</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1925"></a>    <span class="n">MapWindowSolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1926"></a>  <span class="k">END IF</span>
<a name="ln-1927"></a>  <span class="c">! Area of window element</span>
<a name="ln-1928"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Rectangle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1929"></a><span class="k">    </span><span class="n">DAXY</span> <span class="o">=</span> <span class="n">DWX</span> <span class="o">*</span> <span class="n">DWY</span>
<a name="ln-1930"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Triangle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1931"></a><span class="k">    </span><span class="n">SinCornerAng</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">W21</span><span class="p">,</span><span class="n">W23</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1932"></a>    <span class="n">DAXY</span> <span class="o">=</span> <span class="n">DWX</span> <span class="o">*</span> <span class="n">DWY</span> <span class="o">*</span> <span class="n">SinCornerAng</span>
<a name="ln-1933"></a>  <span class="k">END IF</span>
<a name="ln-1934"></a>
<a name="ln-1935"></a><span class="k">  RETURN</span>
<a name="ln-1936"></a>
<a name="ln-1937"></a><span class="k">END SUBROUTINE </span><span class="n">FigureDayltgCoeffsAtPointsSetupForWindow</span>
<a name="ln-1938"></a>
<a name="ln-1939"></a><span class="k">SUBROUTINE </span><span class="n">FigureDayltgCoeffsAtPointsForWindowElements</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">,</span> <span class="n">LoopWin</span><span class="p">,</span> <span class="n">CalledFrom</span><span class="p">,</span> <span class="n">WinEl</span><span class="p">,</span> <span class="n">iWin</span><span class="p">,</span> <span class="n">iWin2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1940"></a>                                              <span class="n">iXelement</span><span class="p">,</span>   <span class="n">iYelement</span><span class="p">,</span>  <span class="n">SkyObstructionMult</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span>  <span class="n">W21</span><span class="p">,</span> <span class="n">W23</span><span class="p">,</span><span class="n">RREF</span><span class="p">,</span><span class="n">NWYlim</span><span class="p">,</span><span class="n">VIEWVC2</span><span class="p">,&amp;</span>
<a name="ln-1941"></a>                                              <span class="n">DWX</span><span class="p">,</span> <span class="n">DWY</span><span class="p">,</span> <span class="n">DAXY</span> <span class="p">,</span><span class="n">U2</span><span class="p">,</span> <span class="n">U23</span><span class="p">,</span><span class="n">U21</span><span class="p">,</span><span class="n">RWIN</span><span class="p">,</span> <span class="n">RWIN2</span><span class="p">,</span> <span class="n">Ray</span><span class="p">,</span> <span class="n">PHRAY</span><span class="p">,</span> <span class="n">LSHCAL</span><span class="p">,</span>  <span class="n">COSB</span><span class="p">,</span> <span class="n">ObTrans</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1942"></a>                                              <span class="n">TVISB</span><span class="p">,</span><span class="n">DOMEGA</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1943"></a>                                              <span class="n">THRAY</span><span class="p">,</span> <span class="n">IHitIntObs</span><span class="p">,</span> <span class="n">IHitExtObs</span><span class="p">,</span> <span class="n">WNORM2</span><span class="p">,</span> <span class="n">ExtWinType</span><span class="p">,</span> <span class="n">IConst</span><span class="p">,</span><span class="n">RREF2</span><span class="p">,</span><span class="n">Triangle</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1944"></a>                                              <span class="n">TVISIntWin</span><span class="p">,</span> <span class="n">TVISIntWinDisk</span><span class="p">,</span>                                               <span class="p">&amp;</span>
<a name="ln-1945"></a>                                              <span class="n">MapNum</span><span class="p">,</span> <span class="n">MapWindowSolidAngAtRefPt</span><span class="p">,</span> <span class="n">MapWindowSolidAngAtRefPtWtd</span><span class="p">)</span>
<a name="ln-1946"></a>
<a name="ln-1947"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1948"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-1949"></a>          <span class="c">!       DATE WRITTEN   November 2012, refactor from legacy code by Fred Winklemann</span>
<a name="ln-1950"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1951"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1952"></a>
<a name="ln-1953"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1954"></a>          <span class="c">! collect code to do calculations for each window element for daylighting coefficients</span>
<a name="ln-1955"></a>
<a name="ln-1956"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1957"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-1958"></a>
<a name="ln-1959"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1960"></a>          <span class="c">! switch as need to serve both reference points and map points based on calledFrom</span>
<a name="ln-1961"></a>
<a name="ln-1962"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1963"></a>  <span class="k">USE </span><span class="n">DaylightingDevices</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span>  <span class="n">TransTDD</span><span class="p">,</span> <span class="n">FindTDDPipe</span>
<a name="ln-1964"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">POLYF</span>
<a name="ln-1965"></a>  <span class="k">USE </span><span class="n">vectors</span>
<a name="ln-1966"></a>
<a name="ln-1967"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1968"></a>
<a name="ln-1969"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1970"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">LoopWin</span>
<a name="ln-1971"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ZoneNum</span>
<a name="ln-1972"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iRefPoint</span>
<a name="ln-1973"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CalledFrom</span> <span class="c">! indicate  which type of routine called this routine</span>
<a name="ln-1974"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">WinEl</span>                        <span class="c">! Current window element number</span>
<a name="ln-1975"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iWin</span>
<a name="ln-1976"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iWin2</span>
<a name="ln-1977"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iXelement</span>
<a name="ln-1978"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iYelement</span>
<a name="ln-1979"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyObstructionMult</span>
<a name="ln-1980"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W2</span>             <span class="c">! Second vertex of window</span>
<a name="ln-1981"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W21</span>            <span class="c">! Vector from window vertex 2 to window vertex 1</span>
<a name="ln-1982"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W23</span>            <span class="c">! Vector from window vertex 2 to window vertex 3</span>
<a name="ln-1983"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DWX</span>                          <span class="c">! Horizontal dimension of window element (m)</span>
<a name="ln-1984"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DWY</span>                          <span class="c">! Vertical dimension of window element (m)</span>
<a name="ln-1985"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DAXY</span>                         <span class="c">! Area of window element</span>
<a name="ln-1986"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">U2</span>             <span class="c">! Second vertex of window for TDD:DOME (if exists)</span>
<a name="ln-1987"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">U21</span>            <span class="c">! Vector from window vertex 2 to window vertex 1 for TDD:DOME (if exists)</span>
<a name="ln-1988"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">U23</span>            <span class="c">! Vector from window vertex 2 to window vertex 3 for TDD:DOME (if exists)</span>
<a name="ln-1989"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RREF</span>           <span class="c">! Location of a reference point in absolute coordinate system</span>
<a name="ln-1990"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">NWYlim</span>                       <span class="c">! For triangle, largest NWY for a given IX</span>
<a name="ln-1991"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VIEWVC2</span>        <span class="c">! Virtual view vector in absolute coordinate system</span>
<a name="ln-1992"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RWIN</span>          <span class="c">! Center of a window element for TDD:DOME (if exists) in abs coord sys</span>
<a name="ln-1993"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RWIN2</span>         <span class="c">! Center of a window element for TDD:DOME (if exists) in abs coord sys</span>
<a name="ln-1994"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RAY</span>           <span class="c">! Unit vector along ray from reference point to window element</span>
<a name="ln-1995"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PHRAY</span>                        <span class="c">! Altitude of ray from reference point to window element (radians)</span>
<a name="ln-1996"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LSHCAL</span>     <span class="c">! Interior shade calculation flag:  0=not yet calculated, 1=already calculated</span>
<a name="ln-1997"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">COSB</span>        <span class="c">! Cosine of angle between window outward normal and ray from reference point to window element</span>
<a name="ln-1998"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObTrans</span>     <span class="c">! Product of solar transmittances of exterior obstructions hit by ray</span>
<a name="ln-1999"></a>                                            <span class="c">! from reference point through a window element</span>
<a name="ln-2000"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVISB</span>           <span class="c">! Visible transmittance of window for COSB angle of incidence (times light well</span>
<a name="ln-2001"></a>                                            <span class="c">!   efficiency, if appropriate)</span>
<a name="ln-2002"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DOMEGA</span>         <span class="c">! Solid angle subtended by window element wrt reference point (steradians)</span>
<a name="ln-2003"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">THRAY</span>                        <span class="c">! Azimuth of ray from reference point to window element (radians)</span>
<a name="ln-2004"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IHitIntObs</span>                   <span class="c">! = 1 if interior obstruction hit, = 0 otherwise</span>
<a name="ln-2005"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IHitExtObs</span>                   <span class="c">! 1 if ray from ref pt to ext win hits an exterior obstruction</span>
<a name="ln-2006"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WNORM2</span>          <span class="c">! Unit vector normal to window</span>
<a name="ln-2007"></a>  <span class="kt">INTEGER</span> <span class="p">,</span>  <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ExtWinType</span>                   <span class="c">! Exterior window type (InZoneExtWin, AdjZoneExtWin, NotInOrAdjZoneExtWin)</span>
<a name="ln-2008"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">IConst</span>                       <span class="c">! Construction counter</span>
<a name="ln-2009"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RREF2</span>  <span class="c">! Location of virtual reference point in absolute coordinate system</span>
<a name="ln-2010"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Triangle</span>
<a name="ln-2011"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVISIntWin</span>                   <span class="c">! Visible transmittance of int win at COSBIntWin for light from ext win</span>
<a name="ln-2012"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVISIntWinDisk</span>               <span class="c">! Visible transmittance of int win at COSBIntWin for sun</span>
<a name="ln-2013"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span>   <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">MapNum</span>
<a name="ln-2014"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">MapWindowSolidAngAtRefPt</span>
<a name="ln-2015"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">MapWindowSolidAngAtRefPtWtd</span>
<a name="ln-2016"></a>
<a name="ln-2017"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2018"></a>          <span class="c">! na</span>
<a name="ln-2019"></a>
<a name="ln-2020"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2021"></a>          <span class="c">! na</span>
<a name="ln-2022"></a>
<a name="ln-2023"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2024"></a>          <span class="c">! na</span>
<a name="ln-2025"></a>
<a name="ln-2026"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2027"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DIS</span>                          <span class="c">! Distance between reference point and center of window element (m)</span>
<a name="ln-2028"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DAXY1</span>                        <span class="c">! For triangle, area of window element at end of column</span>
<a name="ln-2029"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">POSFAC</span>                       <span class="c">! Position factor for a window element / ref point / view vector combination</span>
<a name="ln-2030"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RR</span>                           <span class="c">! Distance from ref point to intersection of view vector</span>
<a name="ln-2031"></a>                                            <span class="c">!  and plane normal to view vector and window element (m)</span>
<a name="ln-2032"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ASQ</span>                          <span class="c">! Square of distance from above intersection to window element (m2)</span>
<a name="ln-2033"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YD</span>                           <span class="c">! Vertical displacement of window element wrt ref point</span>
<a name="ln-2034"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XR</span>                           <span class="c">! Horizontal displacement ratio</span>
<a name="ln-2035"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YR</span>                           <span class="c">! Vertical displacement ratio</span>
<a name="ln-2036"></a>
<a name="ln-2037"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IntWinHitNum</span>                 <span class="c">! Surface number of interior window that is intersected</span>
<a name="ln-2038"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHitIntWin</span>                   <span class="c">! Ray from ref pt passes through interior window</span>
<a name="ln-2039"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">PipeNum</span>                      <span class="c">! TDD pipe object number</span>
<a name="ln-2040"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IntWin</span>                       <span class="c">! Interior window surface index</span>
<a name="ln-2041"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HitPtIntWin</span>    <span class="c">! Intersection point on an interior window for ray from ref pt to ext win (m)</span>
<a name="ln-2042"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">COSBIntWin</span>                   <span class="c">! Cos of angle between int win outward normal and ray betw ref pt and</span>
<a name="ln-2043"></a>                                            <span class="c">!  exterior window element or between ref pt and sun</span>
<a name="ln-2044"></a>
<a name="ln-2045"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Alfa</span> <span class="c">! Intermediate variable</span>
<a name="ln-2046"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Beta</span> <span class="c">! Intermediate variable</span>
<a name="ln-2047"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HorDis</span>                       <span class="c">! Distance between ground hit point and proj&#39;n of center</span>
<a name="ln-2048"></a>                                            <span class="c">!  of window element onto ground (m)</span>
<a name="ln-2049"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GroundHitPt</span>    <span class="c">! Coordinates of point that ray hits ground (m)</span>
<a name="ln-2050"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DPhi</span>   <span class="c">! Phi increment (radians)</span>
<a name="ln-2051"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DTheta</span> <span class="c">! Theta increment (radians)</span>
<a name="ln-2052"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyGndUnObs</span>                  <span class="c">! Unobstructed sky irradiance at a ground point</span>
<a name="ln-2053"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyGndObs</span>                    <span class="c">! Obstructed sky irradiance at a ground point</span>
<a name="ln-2054"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IPhi</span> <span class="c">! Phi  index</span>
<a name="ln-2055"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Phi</span>   <span class="c">! Altitude  angle of ray from a ground point (radians)</span>
<a name="ln-2056"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SPhi</span>  <span class="c">! Sin of Phi</span>
<a name="ln-2057"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CPhi</span>  <span class="c">! cos of Phi</span>
<a name="ln-2058"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ITheta</span> <span class="c">!Theta index</span>
<a name="ln-2059"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Theta</span> <span class="c">! Azimuth angle of ray from a ground point (radians)</span>
<a name="ln-2060"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">URay</span>           <span class="c">! Unit vector in (Phi,Theta) direction</span>
<a name="ln-2061"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosIncAngURay</span>                <span class="c">! Cosine of incidence angle of URay on ground plane</span>
<a name="ln-2062"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dOmegaGnd</span>                    <span class="c">! Solid angle element of ray from ground point (steradians)</span>
<a name="ln-2063"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IncAngSolidAngFac</span>            <span class="c">! CosIncAngURay*dOmegaGnd/Pi</span>
<a name="ln-2064"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHitObs</span>                      <span class="c">! 1 if obstruction is hit; 0 otherwise</span>
<a name="ln-2065"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ObsSurfNum</span>                   <span class="c">! Surface number of obstruction</span>
<a name="ln-2066"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObsHitPt</span>                  <span class="c">! Coordinates of hit point on an obstruction (m)</span>
<a name="ln-2067"></a>
<a name="ln-2068"></a>  <span class="c">! Local complex fenestration variables</span>
<a name="ln-2069"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CplxFenState</span>                 <span class="c">! Current complex fenestration state</span>
<a name="ln-2070"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NReflSurf</span>                    <span class="c">! Number of blocked beams for complex fenestration</span>
<a name="ln-2071"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ICplxFen</span>                     <span class="c">! Complex fenestration counter</span>
<a name="ln-2072"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">RayIndex</span>
<a name="ln-2073"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RayVector</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2074"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TransBeam</span>                  <span class="c">! Obstructions transmittance for incoming BSDF rays (temporary variable)</span>
<a name="ln-2075"></a>
<a name="ln-2076"></a>  <span class="n">LSHCAL</span> <span class="o">=</span> <span class="n">LSHCAL</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2077"></a>  <span class="n">SkyObstructionMult</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2078"></a>
<a name="ln-2079"></a>  <span class="c">! Center of win element in absolute coord sys</span>
<a name="ln-2080"></a>  <span class="n">RWIN</span> <span class="o">=</span> <span class="n">W2</span> <span class="o">+</span> <span class="p">(</span><span class="kt">REAL</span><span class="p">(</span><span class="n">iXelement</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">W23</span> <span class="o">*</span> <span class="n">DWX</span> <span class="o">+</span> <span class="p">(</span><span class="kt">REAL</span><span class="p">(</span><span class="n">iYelement</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">W21</span> <span class="o">*</span> <span class="n">DWY</span>
<a name="ln-2081"></a>
<a name="ln-2082"></a>  <span class="c">! Center of win element on TDD:DOME in absolute coord sys</span>
<a name="ln-2083"></a>  <span class="c">! If no TDD, RWIN2 = RWIN</span>
<a name="ln-2084"></a>  <span class="n">RWIN2</span> <span class="o">=</span> <span class="n">U2</span> <span class="o">+</span> <span class="p">(</span><span class="kt">REAL</span><span class="p">(</span><span class="n">iXelement</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">U23</span> <span class="o">*</span> <span class="n">DWX</span> <span class="o">+</span> <span class="p">(</span><span class="kt">REAL</span><span class="p">(</span><span class="n">iYelement</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">U21</span> <span class="o">*</span> <span class="n">DWY</span>
<a name="ln-2085"></a>
<a name="ln-2086"></a>  <span class="c">! Distance between ref pt and window element</span>
<a name="ln-2087"></a>  <span class="n">DIS</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">RWIN</span> <span class="o">-</span> <span class="n">RREF</span><span class="p">,</span> <span class="n">RWIN</span> <span class="o">-</span> <span class="n">RREF</span><span class="p">))</span>
<a name="ln-2088"></a>
<a name="ln-2089"></a>  <span class="c">! Unit vector along ray from ref pt to element</span>
<a name="ln-2090"></a>  <span class="n">RAY</span> <span class="o">=</span> <span class="p">(</span><span class="n">RWIN</span> <span class="o">-</span> <span class="n">RREF</span><span class="p">)</span> <span class="o">/</span> <span class="n">DIS</span>
<a name="ln-2091"></a>
<a name="ln-2092"></a>  <span class="c">! Cosine of angle between ray and window outward normal</span>
<a name="ln-2093"></a>  <span class="n">COSB</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">WNORM2</span><span class="p">,</span> <span class="n">RAY</span><span class="p">)</span>
<a name="ln-2094"></a>
<a name="ln-2095"></a>  <span class="c">! If COSB &gt; 0, direct light from window can reach ref pt. Otherwise go to loop</span>
<a name="ln-2096"></a>  <span class="c">! over sun position and calculate inter-reflected component of illuminance</span>
<a name="ln-2097"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">COSB</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2098"></a>    <span class="c">! Azimuth (-pi to pi) and altitude (-pi/2 to pi/2) of ray. Azimuth = 0 is along east.</span>
<a name="ln-2099"></a>    <span class="n">PHRAY</span> <span class="o">=</span> <span class="nb">ASIN</span><span class="p">(</span><span class="n">RAY</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-2100"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RAY</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">1.0d-5</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">RAY</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">1.0d-5</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2101"></a><span class="k">      </span><span class="n">THRAY</span> <span class="o">=</span> <span class="n">ATAN2</span><span class="p">(</span><span class="n">RAY</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">RAY</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-2102"></a>    <span class="k">ELSE</span>
<a name="ln-2103"></a><span class="k">      </span><span class="n">THRAY</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2104"></a>    <span class="k">END IF</span>
<a name="ln-2105"></a>
<a name="ln-2106"></a>    <span class="c">! Solid angle subtended by element wrt ref pt.</span>
<a name="ln-2107"></a>    <span class="n">DAXY1</span> <span class="o">=</span> <span class="n">DAXY</span>
<a name="ln-2108"></a>    <span class="c">! For triangle, at end of Y column only one half of parallelopiped&#39;s area contributes</span>
<a name="ln-2109"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Triangle</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">iYelement</span> <span class="o">==</span> <span class="n">NWYlim</span><span class="p">)</span> <span class="n">DAXY1</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="n">DAXY</span>
<a name="ln-2110"></a>    <span class="n">DOMEGA</span> <span class="o">=</span> <span class="n">DAXY1</span> <span class="o">*</span> <span class="n">COSB</span> <span class="o">/</span> <span class="p">(</span><span class="n">DIS</span> <span class="o">*</span> <span class="n">DIS</span><span class="p">)</span>
<a name="ln-2111"></a>
<a name="ln-2112"></a>    <span class="c">! Calculate position factor (used in glare calculation) for this</span>
<a name="ln-2113"></a>    <span class="c">! win element / ref pt / view-vector combination</span>
<a name="ln-2114"></a>    <span class="n">POSFAC</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2115"></a>
<a name="ln-2116"></a>    <span class="c">! Distance from ref pt to intersection of view vector and plane</span>
<a name="ln-2117"></a>    <span class="c">! normal to view vector containing the window element</span>
<a name="ln-2118"></a>
<a name="ln-2119"></a>    <span class="n">RR</span> <span class="o">=</span> <span class="n">DIS</span> <span class="o">*</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">RAY</span><span class="p">,</span> <span class="n">VIEWVC2</span><span class="p">)</span>
<a name="ln-2120"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">RR</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2121"></a>      <span class="c">! Square of distance from above intersection point to win element</span>
<a name="ln-2122"></a>      <span class="n">ASQ</span> <span class="o">=</span> <span class="n">DIS</span> <span class="o">*</span> <span class="n">DIS</span> <span class="o">-</span> <span class="n">RR</span> <span class="o">*</span> <span class="n">RR</span>
<a name="ln-2123"></a>      <span class="c">! Vertical displacement of win element wrt ref pt</span>
<a name="ln-2124"></a>      <span class="n">YD</span> <span class="o">=</span> <span class="n">RWIN2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">RREF2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2125"></a>      <span class="c">! Horizontal and vertical displacement ratio and position factor</span>
<a name="ln-2126"></a>      <span class="n">XR</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ASQ</span> <span class="o">-</span> <span class="n">YD</span> <span class="o">*</span> <span class="n">YD</span><span class="p">))</span> <span class="o">/</span> <span class="n">RR</span>
<a name="ln-2127"></a>      <span class="n">YR</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">YD</span> <span class="o">/</span> <span class="n">RR</span><span class="p">)</span>
<a name="ln-2128"></a>      <span class="n">POSFAC</span> <span class="o">=</span> <span class="n">DayltgGlarePositionFactor</span><span class="p">(</span><span class="n">XR</span><span class="p">,</span> <span class="n">YR</span><span class="p">)</span>
<a name="ln-2129"></a>    <span class="k">END IF</span>
<a name="ln-2130"></a>
<a name="ln-2131"></a><span class="k">    </span><span class="n">IHitIntObs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2132"></a>    <span class="n">IntWinHitNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2133"></a>    <span class="n">IHitIntWin</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2134"></a>    <span class="n">TVISIntWinDisk</span> <span class="o">=</span> <span class="mf">0.0d0</span><span class="c">! Init Value</span>
<a name="ln-2135"></a>    <span class="n">TVISIntWin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2136"></a>
<a name="ln-2137"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2138"></a>        <span class="c">! Look up the TDD:DOME object</span>
<a name="ln-2139"></a>      <span class="n">PipeNum</span> <span class="o">=</span> <span class="n">FindTDDPipe</span><span class="p">(</span><span class="n">IWin</span><span class="p">)</span>
<a name="ln-2140"></a>      <span class="c">! Unshaded visible transmittance of TDD for a single ray from sky/ground element</span>
<a name="ln-2141"></a>      <span class="n">TVISB</span> <span class="o">=</span> <span class="n">TransTDD</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span> <span class="n">COSB</span><span class="p">,</span> <span class="n">VisibleBeam</span><span class="p">)</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-2142"></a>
<a name="ln-2143"></a>    <span class="k">ELSE</span> <span class="c">! Regular window</span>
<a name="ln-2144"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">/=</span> <span class="n">WindowBSDFModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2145"></a>        <span class="c">! Vis trans of glass for COSB incidence angle</span>
<a name="ln-2146"></a>        <span class="n">TVISB</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">COSB</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2147"></a>                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-2148"></a>      <span class="k">ELSE</span>
<a name="ln-2149"></a>        <span class="c">! Complex fenestration needs to use different equation for visible transmittance.  That will be calculated later</span>
<a name="ln-2150"></a>        <span class="c">! in the code since it depends on different incoming directions.  For now, just put zero to differentiate from</span>
<a name="ln-2151"></a>        <span class="c">! regular windows</span>
<a name="ln-2152"></a>        <span class="n">TVISB</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2153"></a>      <span class="k">END IF</span>
<a name="ln-2154"></a><span class="k">      IF</span><span class="p">(</span><span class="n">ExtWinType</span> <span class="o">==</span> <span class="n">AdjZoneExtWin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2155"></a><span class="k">        </span><span class="n">IHitIntWin</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2156"></a>        <span class="c">! Does ray pass through an interior window in zone (ZoneNum) containing the ref point?</span>
<a name="ln-2157"></a>        <span class="k">DO </span><span class="n">IntWin</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-2158"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IntWin</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IntWin</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2159"></a><span class="k">            IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IntWin</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2160"></a><span class="k">              CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">IntWin</span><span class="p">,</span><span class="n">RREF</span><span class="p">,</span><span class="n">RAY</span><span class="p">,</span><span class="n">IHitIntWin</span><span class="p">,</span><span class="n">HitPtIntWin</span><span class="p">)</span>
<a name="ln-2161"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">IHitIntWin</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2162"></a><span class="k">                </span><span class="n">IntWinHitNum</span> <span class="o">=</span> <span class="n">IntWin</span>
<a name="ln-2163"></a>                <span class="n">COSBIntWin</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IntWin</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span><span class="n">RAY</span><span class="p">)</span>
<a name="ln-2164"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">COSBIntWin</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2165"></a><span class="k">                  </span><span class="n">IHitIntWin</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2166"></a>                  <span class="n">IntWinHitNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2167"></a>                  <span class="k">CYCLE</span>
<a name="ln-2168"></a><span class="k">                END IF</span>
<a name="ln-2169"></a><span class="k">                </span><span class="n">TVISIntWin</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">COSBIntWin</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IntWin</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-2170"></a>                <span class="n">TVISB</span> <span class="o">=</span> <span class="n">TVISB</span> <span class="o">*</span> <span class="n">TVISIntWin</span>
<a name="ln-2171"></a>                <span class="k">EXIT</span>  <span class="c">! Ray passes thru interior window; exit from DO loop</span>
<a name="ln-2172"></a>              <span class="k">END IF</span>
<a name="ln-2173"></a><span class="k">            END IF</span>
<a name="ln-2174"></a><span class="k">          END IF</span>
<a name="ln-2175"></a><span class="k">        END DO</span>  <span class="c">! End of loop over surfaces in zone ZoneNum</span>
<a name="ln-2176"></a>
<a name="ln-2177"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">IHitIntWin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2178"></a>          <span class="c">! Ray does not pass through an int win in ZoneNum. Therefore, it hits the opaque part</span>
<a name="ln-2179"></a>          <span class="c">! of a surface between ref point in ZoneNum and ext win element in adjacent zone.</span>
<a name="ln-2180"></a>          <span class="n">IHitIntObs</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2181"></a>        <span class="k">END IF</span>
<a name="ln-2182"></a><span class="k">      END IF</span>  <span class="c">! End of check if this is an ext win in an adjacent zone</span>
<a name="ln-2183"></a>    <span class="k">END IF</span>  <span class="c">! End of check if TDD:Diffuser or regular exterior window or complex fenestration</span>
<a name="ln-2184"></a>
<a name="ln-2185"></a>    <span class="c">! Check for interior obstructions</span>
<a name="ln-2186"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ExtWinType</span> <span class="o">==</span> <span class="n">InZoneExtWin</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">IHitIntObs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2187"></a>      <span class="c">! Check for obstruction between reference point and window element</span>
<a name="ln-2188"></a>      <span class="c">! Returns IHitIntObs = 1 if obstruction is hit, IHitIntObs = 0 otherwise.</span>
<a name="ln-2189"></a>      <span class="c">! (Example of interior obstruction is a wall in an L-shaped room that lies</span>
<a name="ln-2190"></a>      <span class="c">! between reference point and window.)</span>
<a name="ln-2191"></a>      <span class="k">CALL </span><span class="n">DayltgHitInteriorObstruction</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span><span class="n">RREF</span><span class="p">,</span><span class="n">RWIN</span><span class="p">,</span><span class="n">IHitIntObs</span><span class="p">)</span>
<a name="ln-2192"></a>    <span class="k">END IF</span>
<a name="ln-2193"></a>
<a name="ln-2194"></a><span class="k">    IF</span><span class="p">(</span><span class="n">ExtWinType</span> <span class="o">==</span> <span class="n">AdjZoneExtWin</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">IntWinHitNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">IHitIntObs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2195"></a>      <span class="c">! Check for obstruction between ref point and interior window through which ray passes</span>
<a name="ln-2196"></a>      <span class="k">CALL </span><span class="n">DayltgHitInteriorObstruction</span><span class="p">(</span><span class="n">IntWinHitNum</span><span class="p">,</span><span class="n">RREF</span><span class="p">,</span><span class="n">HitPtIntWin</span><span class="p">,</span><span class="n">IHitIntObs</span><span class="p">)</span>
<a name="ln-2197"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">IHitIntObs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2198"></a>        <span class="c">! Check for obstruction between intersection point on int window and ext win element</span>
<a name="ln-2199"></a>        <span class="k">CALL </span><span class="n">DayltgHitBetWinObstruction</span><span class="p">(</span><span class="n">IntWinHitNum</span><span class="p">,</span><span class="n">IWin</span><span class="p">,</span><span class="n">HitPtIntwin</span><span class="p">,</span><span class="n">RWIN</span><span class="p">,</span><span class="n">IHitIntObs</span><span class="p">)</span>
<a name="ln-2200"></a>      <span class="k">END IF</span>
<a name="ln-2201"></a><span class="k">    END IF</span>
<a name="ln-2202"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Calledfrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2203"></a><span class="k">      IF</span><span class="p">(</span><span class="n">IHitIntObs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2204"></a><span class="k">        IF</span><span class="p">(</span><span class="n">ExtWinType</span><span class="o">==</span><span class="n">InZoneExtWin</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">ExtWinType</span><span class="o">==</span><span class="n">AdjZoneExtWin</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">IHitIntWin</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2205"></a>          <span class="c">! Increment solid angle subtended by portion of window above ref pt</span>
<a name="ln-2206"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolidAngAtRefPt</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolidAngAtRefPt</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)</span> <span class="o">+</span> <span class="n">DOMEGA</span>
<a name="ln-2207"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPt</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">loopwin</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-2208"></a>                        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPt</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">loopwin</span><span class="p">)</span> <span class="o">+</span> <span class="n">DOMEGA</span>
<a name="ln-2209"></a>          <span class="c">! Increment position-factor-modified solid angle</span>
<a name="ln-2210"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-2211"></a>                <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)</span> <span class="o">+</span> <span class="n">DOMEGA</span> <span class="o">*</span> <span class="n">POSFAC</span>
<a name="ln-2212"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">loopwin</span><span class="p">)</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-2213"></a>                <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">loopwin</span><span class="p">)</span> <span class="o">+</span> <span class="n">DOMEGA</span> <span class="o">*</span> <span class="n">POSFAC</span>
<a name="ln-2214"></a>        <span class="k">END IF</span>
<a name="ln-2215"></a><span class="k">      END IF</span>
<a name="ln-2216"></a><span class="k">    </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForMapPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2217"></a><span class="k">      IF</span><span class="p">(</span><span class="n">IHitIntObs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2218"></a><span class="k">        IF</span><span class="p">(</span><span class="n">ExtWinType</span><span class="o">==</span><span class="n">InZoneExtWin</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">ExtWinType</span><span class="o">==</span><span class="n">AdjZoneExtWin</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">IHitIntWin</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2219"></a><span class="k">          </span><span class="n">MapWindowSolidAngAtRefPt</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">)</span> <span class="o">=</span> <span class="n">MapWindowSolidAngAtRefPt</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">)</span> <span class="o">+</span> <span class="n">DOMEGA</span>
<a name="ln-2220"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SolidAngAtMapPt</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">loopwin</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-2221"></a>                        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SolidAngAtMapPt</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">loopwin</span><span class="p">)</span> <span class="o">+</span> <span class="n">DOMEGA</span>
<a name="ln-2222"></a>          <span class="n">MapWindowSolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-2223"></a>                        <span class="n">MapWindowSolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">)</span>  <span class="o">+</span> <span class="n">DOMEGA</span> <span class="o">*</span> <span class="n">POSFAC</span>
<a name="ln-2224"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SolidAngAtMapPtWtd</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">loopwin</span><span class="p">)</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-2225"></a>                <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SolidAngAtMapPtWtd</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">loopwin</span><span class="p">)</span> <span class="o">+</span> <span class="n">DOMEGA</span> <span class="o">*</span> <span class="n">POSFAC</span>
<a name="ln-2226"></a>        <span class="k">END IF</span>
<a name="ln-2227"></a><span class="k">      END IF</span>
<a name="ln-2228"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-2229"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">IHitIntObs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">ObTrans</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2230"></a>
<a name="ln-2231"></a>    <span class="n">IHitExtObs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2232"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IHitIntObs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2233"></a>      <span class="c">! No interior obstruction was hit.</span>
<a name="ln-2234"></a>      <span class="c">! Check for exterior obstructions between window element and sky/ground.</span>
<a name="ln-2235"></a>      <span class="c">! Get product of transmittances of obstructions hit by ray.</span>
<a name="ln-2236"></a>      <span class="c">! ObTrans = 1.0 will be returned if no exterior obstructions are hit.</span>
<a name="ln-2237"></a>
<a name="ln-2238"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">/=</span> <span class="n">WindowBSDFModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2239"></a>        <span class="c">! the IHR (now HourOfDay) here is/was not correct, this is outside of hour loop</span>
<a name="ln-2240"></a>        <span class="c">! the hour is used to query schedule for transmission , not sure what to do</span>
<a name="ln-2241"></a>        <span class="c">! it will work for detailed and never did work correctly before.</span>
<a name="ln-2242"></a>        <span class="k">CALL </span><span class="n">DayltgHitObstruction</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">IWin2</span><span class="p">,</span><span class="n">RWIN2</span><span class="p">,</span><span class="n">RAY</span><span class="p">,</span><span class="n">ObTrans</span><span class="p">)</span>
<a name="ln-2243"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ObTrans</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="n">IHitExtObs</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2244"></a>      <span class="k">ELSE</span>
<a name="ln-2245"></a>        <span class="c">! Transmittance from exterior obstruction surfaces is calculated here. This needs to be done for each timestep</span>
<a name="ln-2246"></a>        <span class="c">! in order to account for changes in exterior surface transmittances</span>
<a name="ln-2247"></a>        <span class="n">CplxFenState</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span>
<a name="ln-2248"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2249"></a><span class="k">          </span><span class="n">NReflSurf</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CplxFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)%</span><span class="n">NReflSurf</span><span class="p">(</span><span class="n">WinEl</span><span class="p">)</span>
<a name="ln-2250"></a>        <span class="k">else</span>
<a name="ln-2251"></a><span class="k">          </span><span class="n">NReflSurf</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CplxFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)%</span><span class="n">NReflSurf</span><span class="p">(</span><span class="n">WinEl</span><span class="p">)</span>
<a name="ln-2252"></a>        <span class="k">end if</span>
<a name="ln-2253"></a><span class="k">        DO </span><span class="n">ICplxFen</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NReflSurf</span>
<a name="ln-2254"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2255"></a><span class="k">            </span><span class="n">RayIndex</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CplxFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)%</span><span class="n">RefSurfIndex</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">ICplxFen</span><span class="p">)</span>
<a name="ln-2256"></a>          <span class="k">else</span>
<a name="ln-2257"></a><span class="k">            </span><span class="n">RayIndex</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CplxFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)%</span><span class="n">RefSurfIndex</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">ICplxFen</span><span class="p">)</span>
<a name="ln-2258"></a>          <span class="k">end if</span>
<a name="ln-2259"></a><span class="k">          </span><span class="n">RayVector</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CplxFenState</span><span class="p">)%</span><span class="n">sInc</span><span class="p">(</span><span class="n">RayIndex</span><span class="p">)</span>
<a name="ln-2260"></a>          <span class="c">! It will get product of all transmittances</span>
<a name="ln-2261"></a>          <span class="k">CALL </span><span class="n">DayltgHitObstruction</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">IWin</span><span class="p">,</span><span class="n">RWIN</span><span class="p">,</span><span class="n">RayVector</span><span class="p">,</span><span class="n">TransBeam</span><span class="p">)</span>
<a name="ln-2262"></a>          <span class="c">! IF (TransBeam &gt; 0.0d0) ObTrans = TransBeam</span>
<a name="ln-2263"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2264"></a><span class="k">            </span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CplxFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)%</span><span class="n">TransOutSurf</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">ICplxFen</span><span class="p">)</span> <span class="o">=</span> <span class="n">TransBeam</span>
<a name="ln-2265"></a>          <span class="k">else</span>
<a name="ln-2266"></a><span class="k">            </span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CplxFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)%</span><span class="n">TransOutSurf</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">ICplxFen</span><span class="p">)</span> <span class="o">=</span> <span class="n">TransBeam</span>
<a name="ln-2267"></a>          <span class="k">end if</span>
<a name="ln-2268"></a><span class="k">        END DO</span>
<a name="ln-2269"></a>        <span class="c">! This will avoid obstruction multiplier calculations for non-CFS window</span>
<a name="ln-2270"></a>        <span class="n">ObTrans</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2271"></a>      <span class="k">END IF</span>
<a name="ln-2272"></a><span class="k">    END IF</span>
<a name="ln-2273"></a>
<a name="ln-2274"></a><span class="k">    IF</span><span class="p">(</span><span class="n">CalcSolRefl</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PHRAY</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ObTrans</span> <span class="o">&gt;</span> <span class="mf">1.d-6</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2275"></a>      <span class="c">! Calculate effect of obstructions on shading of sky diffuse reaching the ground point hit</span>
<a name="ln-2276"></a>      <span class="c">! by the ray. This effect is given by the ratio SkyObstructionMult =</span>
<a name="ln-2277"></a>      <span class="c">! (obstructed sky diffuse at ground point)/(unobstructed sky diffuse at ground point).</span>
<a name="ln-2278"></a>      <span class="c">! This ratio is calculated for an isotropic sky.</span>
<a name="ln-2279"></a>      <span class="c">! Ground point hit by the ray:</span>
<a name="ln-2280"></a>      <span class="n">Alfa</span> <span class="o">=</span> <span class="nb">ACOS</span><span class="p">(</span><span class="o">-</span><span class="n">RAY</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-2281"></a>      <span class="n">Beta</span> <span class="o">=</span> <span class="n">ATAN2</span><span class="p">(</span><span class="n">RAY</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">RAY</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-2282"></a>      <span class="n">HorDis</span> <span class="o">=</span> <span class="p">(</span><span class="n">RWIN2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">GroundLevelZ</span><span class="p">)</span><span class="o">*</span><span class="nb">TAN</span><span class="p">(</span><span class="n">Alfa</span><span class="p">)</span>
<a name="ln-2283"></a>      <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">GroundLevelZ</span>
<a name="ln-2284"></a>      <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">RWIN2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">HorDis</span><span class="o">*</span><span class="nb">COS</span><span class="p">(</span><span class="n">Beta</span><span class="p">)</span>
<a name="ln-2285"></a>      <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">RWIN2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">HorDis</span><span class="o">*</span><span class="nb">SIN</span><span class="p">(</span><span class="n">Beta</span><span class="p">)</span>
<a name="ln-2286"></a>
<a name="ln-2287"></a>      <span class="n">SkyObstructionMult</span> <span class="o">=</span> <span class="n">CalcObstrMultiplier</span><span class="p">(</span><span class="n">GroundHitPt</span><span class="p">,</span> <span class="n">AltAngStepsForSolReflCalc</span><span class="p">,</span> <span class="n">AzimAngStepsForSolReflCalc</span><span class="p">)</span>
<a name="ln-2288"></a>    <span class="k">END IF</span>  <span class="c">! End of check if solar reflection calculation is in effect</span>
<a name="ln-2289"></a>
<a name="ln-2290"></a>  <span class="k">END IF</span>  <span class="c">! End of check if COSB &gt; 0</span>
<a name="ln-2291"></a>
<a name="ln-2292"></a>  <span class="k">RETURN</span>
<a name="ln-2293"></a>
<a name="ln-2294"></a><span class="k">END SUBROUTINE </span><span class="n">FigureDayltgCoeffsAtPointsForWindowElements</span>
<a name="ln-2295"></a>
<a name="ln-2296"></a><span class="k">SUBROUTINE </span><span class="n">InitializeCFSDaylighting</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="n">IWin</span><span class="p">,</span> <span class="n">NWX</span><span class="p">,</span> <span class="n">NWY</span><span class="p">,</span> <span class="n">VIEWVC</span><span class="p">,</span> <span class="n">RefPoint</span><span class="p">,</span> <span class="n">NRefPts</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">,</span> <span class="n">CalledFrom</span><span class="p">,</span> <span class="n">MapNum</span><span class="p">)</span>
<a name="ln-2297"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2298"></a>          <span class="c">!       AUTHOR         Simon Vidanovic</span>
<a name="ln-2299"></a>          <span class="c">!       DATE WRITTEN   April 2013</span>
<a name="ln-2300"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2301"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2302"></a>
<a name="ln-2303"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2304"></a>          <span class="c">! For incoming BSDF window direction calucates wheter bin is coming from sky, ground or reflected surface.</span>
<a name="ln-2305"></a>          <span class="c">! Routine also calculates intersection points with ground and exterior reflection surfaces.</span>
<a name="ln-2306"></a>
<a name="ln-2307"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2308"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-2309"></a>
<a name="ln-2310"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2311"></a>          <span class="c">! na</span>
<a name="ln-2312"></a>
<a name="ln-2313"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2314"></a>  <span class="k">use </span><span class="n">vectors</span>
<a name="ln-2315"></a>  <span class="k">use </span><span class="n">WindowComplexManager</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">PierceSurfaceVector</span><span class="p">,</span> <span class="n">DaylghtAltAndAzimuth</span>
<a name="ln-2316"></a>
<a name="ln-2317"></a>  <span class="k">implicit none</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2318"></a>
<a name="ln-2319"></a>  <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2320"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span>  <span class="n">ZoneNum</span>   <span class="c">! Current zone number</span>
<a name="ln-2321"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span>  <span class="n">IWin</span>      <span class="c">! Complex fenestration number</span>
<a name="ln-2322"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span>  <span class="n">NWX</span>       <span class="c">! Number of horizontal divisions</span>
<a name="ln-2323"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span>  <span class="n">NWY</span>       <span class="c">! Number of vertical divisions</span>
<a name="ln-2324"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VIEWVC</span> <span class="c">! view vector component in absolute coord sys</span>
<a name="ln-2325"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RefPoint</span>  <span class="c">! reference point coordinates</span>
<a name="ln-2326"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">NRefPts</span>    <span class="c">! Number of reference points</span>
<a name="ln-2327"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">iRefPoint</span>  <span class="c">! Reference points counter</span>
<a name="ln-2328"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">CalledFrom</span>
<a name="ln-2329"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">MapNum</span>
<a name="ln-2330"></a>
<a name="ln-2331"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">NumOfWinEl</span>  <span class="c">! Number of window elements</span>
<a name="ln-2332"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">CurFenState</span> <span class="c">! Current fenestration state</span>
<a name="ln-2333"></a>
<a name="ln-2334"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DWX</span>  <span class="c">! Window element width</span>
<a name="ln-2335"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DWY</span>  <span class="c">! Window element height</span>
<a name="ln-2336"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WinElArea</span> <span class="c">! Window element area</span>
<a name="ln-2337"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosB</span> <span class="c">! Cosine of angle between ray and window outward normal</span>
<a name="ln-2338"></a>
<a name="ln-2339"></a>  <span class="c">! window coordinates and vectors</span>
<a name="ln-2340"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2341"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2342"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W3</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2343"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W21</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2344"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W23</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2345"></a>
<a name="ln-2346"></a>  <span class="c">! window elements counters</span>
<a name="ln-2347"></a>  <span class="c">! integer :: IX ! horizontal elements</span>
<a name="ln-2348"></a>  <span class="c">! integer :: IY ! vertical elements</span>
<a name="ln-2349"></a>
<a name="ln-2350"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">NReflSurf</span>
<a name="ln-2351"></a>
<a name="ln-2352"></a>  <span class="c">! type(vector) :: HitPt ! surface hit point</span>
<a name="ln-2353"></a>  <span class="c">! real(r64), dimension(3) :: RWin ! window element center point (same as centroid)</span>
<a name="ln-2354"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WNorm</span> <span class="c">! unit vector from window (point towards outside)</span>
<a name="ln-2355"></a>
<a name="ln-2356"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">NSky</span>
<a name="ln-2357"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">NGnd</span>
<a name="ln-2358"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">NReflected</span>
<a name="ln-2359"></a>
<a name="ln-2360"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">IRay</span>
<a name="ln-2361"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iTrnRay</span>
<a name="ln-2362"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">JSurf</span>
<a name="ln-2363"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iHit</span>
<a name="ln-2364"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">TotHits</span>
<a name="ln-2365"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">MaxTotHits</span> <span class="c">! maximal number of exterior surface hits for current window state</span>
<a name="ln-2366"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">I</span><span class="p">,</span> <span class="n">J</span>
<a name="ln-2367"></a>
<a name="ln-2368"></a>  <span class="c">!real(r64) :: DotProd     !Temporary variable for manipulating dot product .dot.</span>
<a name="ln-2369"></a>  <span class="c">!real(r64) :: LeastHitDsq  ! dist^2 from window element center to hit point</span>
<a name="ln-2370"></a>  <span class="c">!real(r64) :: HitDsq</span>
<a name="ln-2371"></a>  <span class="c">!real(r64), dimension(3)  ::  V    !vector array</span>
<a name="ln-2372"></a>  <span class="c">!real(r64), dimension(3) :: GroundHitPt    ! Coordinates of point that ray hits ground (m)</span>
<a name="ln-2373"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TransRSurf</span>
<a name="ln-2374"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">curWinEl</span>    <span class="c">! Counter for current window element</span>
<a name="ln-2375"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">NBasis</span>  <span class="c">! number of incident basis directions for current state</span>
<a name="ln-2376"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">NTrnBasis</span>  <span class="c">! number of outgoing basis directions for current state</span>
<a name="ln-2377"></a>
<a name="ln-2378"></a>  <span class="c">! reference point variables</span>
<a name="ln-2379"></a>  <span class="c">! real(r64), dimension(3) :: RefPoint ! reference point</span>
<a name="ln-2380"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ray</span> <span class="c">! vector along ray from window to reference point</span>
<a name="ln-2381"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RayNorm</span> <span class="c">! unit vector along ray from window to reference point</span>
<a name="ln-2382"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Dist</span> <span class="c">! distance between reference point and center of window element</span>
<a name="ln-2383"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BestMatch</span> <span class="c">! temporary variable for storing best match when calculating reference point outgoing beam number</span>
<a name="ln-2384"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">temp</span>
<a name="ln-2385"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iPierc</span>     <span class="c">! intersection flag = 1 (Yes); =0 (No)</span>
<a name="ln-2386"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InterPoint</span>      <span class="c">! Intersection point</span>
<a name="ln-2387"></a>
<a name="ln-2388"></a>  <span class="c">! Position factor variables</span>
<a name="ln-2389"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RR</span>     <span class="c">! Distance from ref point to intersection of view vector</span>
<a name="ln-2390"></a>                      <span class="c">!  and plane normal to view vector and window element (m)</span>
<a name="ln-2391"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ASQ</span>    <span class="c">! Square of distance from above intersection to window element (m2)</span>
<a name="ln-2392"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YD</span>     <span class="c">! Vertical displacement of window element wrt ref point</span>
<a name="ln-2393"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XR</span>     <span class="c">! Horizontal displacement ratio</span>
<a name="ln-2394"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YR</span>     <span class="c">! Vertical displacement ratio</span>
<a name="ln-2395"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AZVIEW</span> <span class="c">! Azimuth of view vector</span>
<a name="ln-2396"></a>  <span class="k">type</span><span class="p">(</span><span class="n">BSDFDaylghtPosition</span><span class="p">)</span> <span class="kd">::</span> <span class="n">elPos</span>  <span class="c">! altitude and azimuth of intersection element</span>
<a name="ln-2397"></a>  <span class="k">type</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Vec</span>  <span class="c">! temporary vector variable</span>
<a name="ln-2398"></a>
<a name="ln-2399"></a>  <span class="n">NumOfWinEl</span> <span class="o">=</span> <span class="n">NWX</span> <span class="o">*</span> <span class="n">NWY</span>
<a name="ln-2400"></a>
<a name="ln-2401"></a>  <span class="n">DWX</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Width</span> <span class="o">/</span> <span class="n">NWX</span>
<a name="ln-2402"></a>  <span class="n">DWY</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Height</span> <span class="o">/</span> <span class="n">NWY</span>
<a name="ln-2403"></a>
<a name="ln-2404"></a>  <span class="n">AZVIEW</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ViewAzimuthForGlare</span> <span class="o">+</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">RelNorth</span> <span class="o">+</span> <span class="n">BuildingAzimuth</span> <span class="o">+</span> <span class="n">BuildingRotationAppendixG</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-2405"></a>               <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-2406"></a>
<a name="ln-2407"></a>  <span class="c">! Perform necessary calculations for window coordinates and vectors.  This will be used to calculate centroids for</span>
<a name="ln-2408"></a>  <span class="c">! each window element</span>
<a name="ln-2409"></a>  <span class="n">W1</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2410"></a>  <span class="n">W2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2411"></a>  <span class="n">W3</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2412"></a>
<a name="ln-2413"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2414"></a><span class="k">    </span><span class="n">W3</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2415"></a>    <span class="n">W2</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2416"></a>    <span class="n">W1</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-2417"></a>  <span class="k">else if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2418"></a><span class="k">    </span><span class="n">W3</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2419"></a>    <span class="n">W2</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2420"></a>    <span class="n">W1</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2421"></a>  <span class="k">end if</span>
<a name="ln-2422"></a>
<a name="ln-2423"></a><span class="k">  </span><span class="n">W21</span> <span class="o">=</span> <span class="n">W1</span> <span class="o">-</span> <span class="n">W2</span>
<a name="ln-2424"></a>  <span class="n">W23</span> <span class="o">=</span> <span class="n">W3</span> <span class="o">-</span> <span class="n">W2</span>
<a name="ln-2425"></a>
<a name="ln-2426"></a>  <span class="n">W21</span> <span class="o">=</span> <span class="n">W21</span><span class="o">/</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-2427"></a>  <span class="n">W23</span> <span class="o">=</span> <span class="n">W23</span><span class="o">/</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-2428"></a>
<a name="ln-2429"></a>  <span class="n">WNorm</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">lcsz</span>
<a name="ln-2430"></a>
<a name="ln-2431"></a>  <span class="n">WinElArea</span> <span class="o">=</span> <span class="n">DWX</span> <span class="o">*</span> <span class="n">DWY</span>
<a name="ln-2432"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2433"></a><span class="k">    </span><span class="n">WinElArea</span> <span class="o">=</span> <span class="n">WinElArea</span> <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">W21</span><span class="p">,</span><span class="n">W23</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2434"></a>  <span class="k">end if</span>
<a name="ln-2435"></a>
<a name="ln-2436"></a><span class="k">  if</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForMapPoint</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2437"></a>
<a name="ln-2438"></a><span class="k">    if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2439"></a><span class="k">      allocate</span> <span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">TotIllumMaps</span><span class="p">,</span> <span class="n">NRefPts</span><span class="p">))</span>
<a name="ln-2440"></a>    <span class="k">end if</span>
<a name="ln-2441"></a>
<a name="ln-2442"></a><span class="k">    call </span><span class="n">AllocateForCFSRefPointsGeometry</span><span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">),</span> <span class="n">NumOfWinEl</span><span class="p">)</span>
<a name="ln-2443"></a>
<a name="ln-2444"></a>  <span class="k">else if</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2445"></a><span class="k">    if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2446"></a><span class="k">      allocate</span> <span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">NRefPts</span><span class="p">))</span>
<a name="ln-2447"></a>    <span class="k">end if</span>
<a name="ln-2448"></a>
<a name="ln-2449"></a><span class="k">    call </span><span class="n">AllocateForCFSRefPointsGeometry</span><span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">),</span> <span class="n">NumOfWinEl</span><span class="p">)</span>
<a name="ln-2450"></a>  <span class="k">end if</span>
<a name="ln-2451"></a>
<a name="ln-2452"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-2453"></a>  <span class="c">!! Allocation for each complex fenestration state reference points</span>
<a name="ln-2454"></a>  <span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-2455"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2456"></a><span class="k">    allocate</span> <span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">NumStates</span><span class="p">))</span>
<a name="ln-2457"></a>  <span class="k">end if</span>
<a name="ln-2458"></a>
<a name="ln-2459"></a>  <span class="c">! Calculation needs to be performed for each state</span>
<a name="ln-2460"></a>  <span class="k">do </span><span class="n">CurFenState</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">NumStates</span>
<a name="ln-2461"></a>    <span class="n">NBasis</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">Inc</span><span class="p">%</span><span class="n">NBasis</span>
<a name="ln-2462"></a>    <span class="n">NTrnBasis</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">Trn</span><span class="p">%</span><span class="n">NBasis</span>
<a name="ln-2463"></a>
<a name="ln-2464"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForMapPoint</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2465"></a><span class="k">      if</span> <span class="p">(</span><span class="n">TotIllumMaps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2466"></a>        <span class="c">! illuminance map for each state</span>
<a name="ln-2467"></a>        <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2468"></a><span class="k">          allocate</span> <span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">TotIllumMaps</span><span class="p">,</span> <span class="n">NRefPts</span><span class="p">))</span>
<a name="ln-2469"></a>        <span class="k">end if</span>
<a name="ln-2470"></a>
<a name="ln-2471"></a><span class="k">        call </span><span class="n">AllocateForCFSRefPointsState</span><span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2472"></a>          <span class="n">NumOfWinEl</span><span class="p">,</span> <span class="n">NBasis</span><span class="p">,</span> <span class="n">NTrnBasis</span><span class="p">)</span>
<a name="ln-2473"></a>
<a name="ln-2474"></a>        <span class="k">call </span><span class="n">InitializeCFSStateData</span><span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2475"></a>          <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">),</span> <span class="n">ZoneNum</span><span class="p">,</span> <span class="n">iWin</span><span class="p">,</span> <span class="n">RefPoint</span><span class="p">,</span> <span class="n">curFenState</span><span class="p">,</span> <span class="n">NBasis</span><span class="p">,</span> <span class="n">NTrnBasis</span><span class="p">,</span> <span class="n">AZVIEW</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2476"></a>          <span class="n">NWX</span><span class="p">,</span> <span class="n">NWY</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">W21</span><span class="p">,</span> <span class="n">W23</span><span class="p">,</span> <span class="n">DWX</span><span class="p">,</span> <span class="n">DWY</span><span class="p">,</span> <span class="n">WNorm</span><span class="p">,</span> <span class="n">WinElArea</span><span class="p">,</span> <span class="n">CalledFrom</span><span class="p">,</span> <span class="n">MapNum</span><span class="p">)</span>
<a name="ln-2477"></a>      <span class="k">end if</span>
<a name="ln-2478"></a>
<a name="ln-2479"></a><span class="k">    else if</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2480"></a><span class="k">      if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2481"></a><span class="k">        allocate</span> <span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">NRefPts</span><span class="p">))</span>
<a name="ln-2482"></a>      <span class="k">end if</span>
<a name="ln-2483"></a>
<a name="ln-2484"></a><span class="k">      call </span><span class="n">AllocateForCFSRefPointsState</span><span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">),</span> <span class="n">NumOfWinEl</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2485"></a>        <span class="n">NBasis</span><span class="p">,</span> <span class="n">NTrnBasis</span><span class="p">)</span>
<a name="ln-2486"></a>
<a name="ln-2487"></a>      <span class="k">call </span><span class="n">InitializeCFSStateData</span><span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2488"></a>        <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">),</span> <span class="n">ZoneNum</span><span class="p">,</span> <span class="n">iWin</span><span class="p">,</span> <span class="n">RefPoint</span><span class="p">,</span> <span class="n">curFenState</span><span class="p">,</span> <span class="n">NBasis</span><span class="p">,</span> <span class="n">NTrnBasis</span><span class="p">,</span> <span class="n">AZVIEW</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2489"></a>          <span class="n">NWX</span><span class="p">,</span> <span class="n">NWY</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">W21</span><span class="p">,</span> <span class="n">W23</span><span class="p">,</span> <span class="n">DWX</span><span class="p">,</span> <span class="n">DWY</span><span class="p">,</span> <span class="n">WNorm</span><span class="p">,</span> <span class="n">WinElArea</span><span class="p">,</span> <span class="n">CalledFrom</span><span class="p">,</span> <span class="n">MapNum</span><span class="p">)</span>
<a name="ln-2490"></a>    <span class="k">end if</span>
<a name="ln-2491"></a><span class="k">  end do</span>
<a name="ln-2492"></a>
<a name="ln-2493"></a><span class="k">END SUBROUTINE </span><span class="n">InitializeCFSDaylighting</span>
<a name="ln-2494"></a>
<a name="ln-2495"></a><span class="k">SUBROUTINE </span><span class="n">InitializeCFSStateData</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">,</span> <span class="n">DaylghtGeomDescr</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">,</span> <span class="n">iWin</span><span class="p">,</span> <span class="n">RefPoint</span><span class="p">,</span> <span class="n">curFenState</span><span class="p">,</span> <span class="n">NBasis</span><span class="p">,</span> <span class="n">NTrnBasis</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2496"></a>  <span class="n">AZVIEW</span><span class="p">,</span> <span class="n">NWX</span><span class="p">,</span> <span class="n">NWY</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">W21</span><span class="p">,</span> <span class="n">W23</span><span class="p">,</span> <span class="n">DWX</span><span class="p">,</span> <span class="n">DWY</span><span class="p">,</span> <span class="n">WNorm</span><span class="p">,</span> <span class="n">WinElArea</span><span class="p">,</span> <span class="n">CalledFrom</span><span class="p">,</span> <span class="n">MapNum</span><span class="p">)</span>
<a name="ln-2497"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2498"></a>          <span class="c">!       AUTHOR         Simon Vidanovic</span>
<a name="ln-2499"></a>          <span class="c">!       DATE WRITTEN   June 2013</span>
<a name="ln-2500"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2501"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2502"></a>
<a name="ln-2503"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2504"></a>          <span class="c">! Initialize daylight state data for current</span>
<a name="ln-2505"></a>
<a name="ln-2506"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2507"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-2508"></a>
<a name="ln-2509"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2510"></a>          <span class="c">! na</span>
<a name="ln-2511"></a>
<a name="ln-2512"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2513"></a>  <span class="k">use </span><span class="n">vectors</span>
<a name="ln-2514"></a>  <span class="k">use </span><span class="n">WindowComplexManager</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">PierceSurfaceVector</span><span class="p">,</span> <span class="n">DaylghtAltAndAzimuth</span>
<a name="ln-2515"></a>
<a name="ln-2516"></a>  <span class="k">implicit none</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2517"></a>
<a name="ln-2518"></a>  <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2519"></a>  <span class="k">type</span><span class="p">(</span><span class="n">BSDFRefPoints</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StateRefPoint</span>
<a name="ln-2520"></a>  <span class="k">type</span><span class="p">(</span><span class="n">BSDFRefPointsGeomDescr</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DaylghtGeomDescr</span>
<a name="ln-2521"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">ZoneNum</span>   <span class="c">! Current zone number</span>
<a name="ln-2522"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iWin</span>
<a name="ln-2523"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RefPoint</span> <span class="c">! reference point</span>
<a name="ln-2524"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">curFenState</span>
<a name="ln-2525"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NBasis</span>
<a name="ln-2526"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NTrnBasis</span>
<a name="ln-2527"></a>  <span class="c">!integer, intent(in) :: NRefPt</span>
<a name="ln-2528"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CalledFrom</span>
<a name="ln-2529"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AZVIEW</span>
<a name="ln-2530"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NWX</span>
<a name="ln-2531"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NWY</span>
<a name="ln-2532"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W2</span>
<a name="ln-2533"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W21</span>
<a name="ln-2534"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W23</span>
<a name="ln-2535"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DWX</span>
<a name="ln-2536"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DWY</span>
<a name="ln-2537"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WNorm</span> <span class="c">! unit vector from window (point towards outside)</span>
<a name="ln-2538"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WinElArea</span>
<a name="ln-2539"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">MapNum</span>
<a name="ln-2540"></a>
<a name="ln-2541"></a>  <span class="c">! SUBROUTINE LOCAL VARIABLES</span>
<a name="ln-2542"></a>  <span class="k">type</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Centroid</span> <span class="c">! current window element centroid</span>
<a name="ln-2543"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">curWinEl</span>
<a name="ln-2544"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">IRay</span>
<a name="ln-2545"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iHit</span>
<a name="ln-2546"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">TotHits</span>
<a name="ln-2547"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">JSurf</span>
<a name="ln-2548"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DotProd</span>     <span class="c">!Temporary variable for manipulating dot product .dot.</span>
<a name="ln-2549"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">NSky</span>
<a name="ln-2550"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">NGnd</span>
<a name="ln-2551"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">NReflSurf</span>
<a name="ln-2552"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">MaxTotHits</span>
<a name="ln-2553"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">IX</span>
<a name="ln-2554"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">IY</span>
<a name="ln-2555"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RWin</span> <span class="c">! window element center point (same as centroid)</span>
<a name="ln-2556"></a>  <span class="k">type</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HitPt</span> <span class="c">! surface hit point</span>
<a name="ln-2557"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">V</span>    <span class="c">!vector array</span>
<a name="ln-2558"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LeastHitDsq</span>  <span class="c">! dist^2 from window element center to hit point</span>
<a name="ln-2559"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HitDsq</span>
<a name="ln-2560"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TransRSurf</span>
<a name="ln-2561"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">I</span><span class="p">,</span> <span class="n">J</span>
<a name="ln-2562"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GroundHitPt</span>    <span class="c">! Coordinates of point that ray hits ground (m)</span>
<a name="ln-2563"></a>
<a name="ln-2564"></a>  <span class="c">! Refrence point data</span>
<a name="ln-2565"></a>  <span class="c">! integer :: iRefPoint</span>
<a name="ln-2566"></a>
<a name="ln-2567"></a>  <span class="c">! temporary arrays for surfaces</span>
<a name="ln-2568"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span>  <span class="kd">::</span>  <span class="n">TmpSkyInd</span>  <span class="c">!Temporary sky index list</span>
<a name="ln-2569"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span>  <span class="kd">::</span>  <span class="n">TmpGndInd</span>  <span class="c">!Temporary gnd index list</span>
<a name="ln-2570"></a>  <span class="k">type</span> <span class="p">(</span><span class="n">vector</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span>  <span class="kd">::</span>  <span class="n">TmpGndPt</span>  <span class="c">!Temporary ground intersection list</span>
<a name="ln-2571"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span>  <span class="kd">::</span>  <span class="n">TmpGndMultiplier</span>  <span class="c">!Temporary ground obstruction multiplier</span>
<a name="ln-2572"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span>  <span class="kd">::</span>  <span class="n">TmpRfSfInd</span>  <span class="c">!Temporary RefSurfIndex</span>
<a name="ln-2573"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span>  <span class="kd">::</span>  <span class="n">TmpRfRyNH</span>  <span class="c">!Temporary RefRayNHits</span>
<a name="ln-2574"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">allocatable</span>  <span class="kd">::</span>  <span class="n">TmpHSurfNo</span>  <span class="c">!Temporary HitSurfNo</span>
<a name="ln-2575"></a>  <span class="k">type</span><span class="p">(</span><span class="n">vector</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">allocatable</span>  <span class="kd">::</span>  <span class="n">TmpHitPt</span>    <span class="c">!Temporary HitPt</span>
<a name="ln-2576"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">allocatable</span>  <span class="kd">::</span>  <span class="n">TmpHSurfDSq</span>    <span class="c">!Temporary HitSurfDSq</span>
<a name="ln-2577"></a>
<a name="ln-2578"></a>  <span class="c">! each complex fenestration state can have different number of basis elements.  This is the reason for making</span>
<a name="ln-2579"></a>  <span class="c">! temporary arrays allocated at this moment.  It is also important to note that deallocation needs to occur at the</span>
<a name="ln-2580"></a>  <span class="c">! end of current fenestration state loop</span>
<a name="ln-2581"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpSkyInd</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">TmpSkyInd</span><span class="p">(</span><span class="n">NBasis</span><span class="p">))</span>
<a name="ln-2582"></a>  <span class="n">TmpSkyInd</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2583"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpGndInd</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">TmpGndInd</span><span class="p">(</span><span class="n">NBasis</span><span class="p">))</span>
<a name="ln-2584"></a>  <span class="n">TmpGndInd</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2585"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpGndPt</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">TmpGndPt</span><span class="p">(</span><span class="n">NBasis</span><span class="p">))</span>
<a name="ln-2586"></a>  <span class="n">TmpGndPt</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-2587"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpGndMultiplier</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">TmpGndMultiplier</span><span class="p">(</span><span class="n">NBasis</span><span class="p">))</span>
<a name="ln-2588"></a>  <span class="n">TmpGndMultiplier</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2589"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpRfSfInd</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">TmpRfSfInd</span><span class="p">(</span><span class="n">NBasis</span><span class="p">))</span>
<a name="ln-2590"></a>  <span class="n">TmpRfSfInd</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2591"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpRfRyNH</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">TmpRfRyNH</span><span class="p">(</span><span class="n">NBasis</span><span class="p">))</span>
<a name="ln-2592"></a>  <span class="n">TmpRfRyNH</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2593"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpHSurfNo</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">TmpHSurfNo</span><span class="p">(</span><span class="n">NBasis</span><span class="p">,</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-2594"></a>  <span class="n">TmpHSurfNo</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2595"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpHitPt</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">TmpHitPt</span><span class="p">(</span><span class="n">NBasis</span><span class="p">,</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-2596"></a>  <span class="n">TmpHitPt</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-2597"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpHSurfDSq</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">TmpHSurfDSq</span><span class="p">(</span><span class="n">NBasis</span><span class="p">,</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-2598"></a>  <span class="n">TmpHSurfDSq</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2599"></a>
<a name="ln-2600"></a>  <span class="c">! find if reference point belongs to light tube of outgoing bsdf direction.  This works for entire window and not window</span>
<a name="ln-2601"></a>  <span class="c">! elements.</span>
<a name="ln-2602"></a>  <span class="c">! initialization for each reference point</span>
<a name="ln-2603"></a>  <span class="c">!do iRefPoint = 1, NRefPt</span>
<a name="ln-2604"></a>  <span class="c">!if (CalledFrom == CalledForRefPoint) then</span>
<a name="ln-2605"></a>  <span class="c">!  RefPoint = ZoneDaylight(ZoneNum)%DaylRefPtAbsCoord(iRefPoint, 1:3)</span>
<a name="ln-2606"></a>  <span class="c">!else</span>
<a name="ln-2607"></a>  <span class="c">!  RefPoint = IllumMapCalc(MapNum)%MapRefPtAbsCoord(irefPoint, 1:3)</span>
<a name="ln-2608"></a>  <span class="c">!end if</span>
<a name="ln-2609"></a>
<a name="ln-2610"></a>  <span class="k">call </span><span class="n">CFSRefPointPosFactor</span><span class="p">(</span><span class="n">RefPoint</span><span class="p">,</span> <span class="n">StateRefPoint</span><span class="p">,</span> <span class="n">iWin</span><span class="p">,</span> <span class="n">CurFenState</span><span class="p">,</span> <span class="n">NTrnBasis</span><span class="p">,</span> <span class="n">AZVIEW</span><span class="p">)</span>
<a name="ln-2611"></a>  <span class="c">!end do</span>
<a name="ln-2612"></a>
<a name="ln-2613"></a>  <span class="n">curWinEl</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2614"></a>  <span class="c">! loop through window elements. This will calculate sky, ground and reflection bins for each window element</span>
<a name="ln-2615"></a>  <span class="k">do </span><span class="n">IX</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NWX</span>
<a name="ln-2616"></a>    <span class="k">do </span><span class="n">IY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NWY</span>
<a name="ln-2617"></a>
<a name="ln-2618"></a>      <span class="n">curWinEl</span> <span class="o">=</span> <span class="n">curWinEl</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2619"></a>
<a name="ln-2620"></a>      <span class="c">! centroid coordinates for current window element</span>
<a name="ln-2621"></a>      <span class="n">Centroid</span> <span class="o">=</span> <span class="n">W2</span> <span class="o">+</span> <span class="p">(</span><span class="kt">REAL</span><span class="p">(</span><span class="n">IX</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">W23</span> <span class="o">*</span> <span class="n">DWX</span> <span class="o">+</span> <span class="p">(</span><span class="kt">REAL</span><span class="p">(</span><span class="n">IY</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">W21</span> <span class="o">*</span> <span class="n">DWY</span>
<a name="ln-2622"></a>      <span class="n">RWin</span> <span class="o">=</span> <span class="n">Centroid</span>
<a name="ln-2623"></a>
<a name="ln-2624"></a>      <span class="c">!do iRefPoint = 1, NRefPt</span>
<a name="ln-2625"></a>      <span class="c">!if (CalledFrom == CalledForRefPoint) then</span>
<a name="ln-2626"></a>      <span class="c">!  RefPoint = ZoneDaylight(ZoneNum)%DaylRefPtAbsCoord(iRefPoint, 1:3)</span>
<a name="ln-2627"></a>      <span class="c">!else</span>
<a name="ln-2628"></a>      <span class="c">!  RefPoint = IllumMapCalc(MapNum)%MapRefPtAbsCoord(iRefPoint, 1:3)</span>
<a name="ln-2629"></a>      <span class="c">!end if</span>
<a name="ln-2630"></a>
<a name="ln-2631"></a>      <span class="k">call </span><span class="n">CFSRefPointSolidAngle</span><span class="p">(</span><span class="n">RefPoint</span><span class="p">,</span> <span class="n">RWin</span><span class="p">,</span> <span class="n">WNorm</span><span class="p">,</span> <span class="n">StateRefPoint</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2632"></a>            <span class="n">DaylghtGeomDescr</span><span class="p">,</span> <span class="n">iWin</span><span class="p">,</span> <span class="n">CurFenState</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2633"></a>            <span class="n">NTrnBasis</span><span class="p">,</span> <span class="n">curWinEl</span><span class="p">,</span> <span class="n">WinElArea</span><span class="p">)</span>
<a name="ln-2634"></a>      <span class="c">!end do</span>
<a name="ln-2635"></a>
<a name="ln-2636"></a>
<a name="ln-2637"></a>      <span class="n">NSky</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2638"></a>      <span class="n">NGnd</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2639"></a>      <span class="n">NReflSurf</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2640"></a>      <span class="n">MaxTotHits</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2641"></a>      <span class="c">! Calculation of potential surface obstruction for each incoming direction</span>
<a name="ln-2642"></a>      <span class="k">do </span><span class="n">IRay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NBasis</span>
<a name="ln-2643"></a>
<a name="ln-2644"></a>        <span class="n">iHit</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2645"></a>        <span class="n">TotHits</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2646"></a>        <span class="k">do </span><span class="n">JSurf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-2647"></a>          <span class="c">! the following test will cycle on anything except exterior surfaces and shading surfaces</span>
<a name="ln-2648"></a>          <span class="k">if</span><span class="p">(</span> <span class="n">Surface</span><span class="p">(</span><span class="n">JSurf</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">JSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-2649"></a>          <span class="c">!  skip the base surface containing the window and any other subsurfaces of that surface</span>
<a name="ln-2650"></a>          <span class="k">if</span><span class="p">(</span> <span class="n">JSurf</span> <span class="o">==</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">JSurf</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-2651"></a>          <span class="c">!  skip surfaces that face away from the window</span>
<a name="ln-2652"></a>          <span class="n">DotProd</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">sInc</span><span class="p">(</span><span class="n">IRay</span><span class="p">)</span> <span class="p">.</span><span class="n">dot</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">JSurf</span><span class="p">)%</span><span class="n">NewellSurfaceNormalVector</span>
<a name="ln-2653"></a>          <span class="k">if</span><span class="p">(</span> <span class="n">DotProd</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">cycle</span>
<a name="ln-2654"></a><span class="k">          call </span><span class="n">PierceSurfaceVector</span><span class="p">(</span><span class="n">JSurf</span><span class="p">,</span> <span class="n">Centroid</span><span class="p">,</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">sInc</span><span class="p">(</span><span class="n">IRay</span><span class="p">),</span> <span class="n">IHit</span><span class="p">,</span> <span class="n">HitPt</span><span class="p">)</span>
<a name="ln-2655"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">IHit</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-2656"></a><span class="k">          </span><span class="n">IHit</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">!A hit, clear the hit flag for the next cycle</span>
<a name="ln-2657"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">TotHits</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2658"></a>          <span class="c">! First hit for this ray</span>
<a name="ln-2659"></a>          <span class="n">TotHits</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2660"></a>          <span class="n">NReflSurf</span> <span class="o">=</span> <span class="n">NReflSurf</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2661"></a>          <span class="n">TmpRfSfInd</span><span class="p">(</span><span class="n">NReflSurf</span><span class="p">)</span> <span class="o">=</span> <span class="n">IRay</span>
<a name="ln-2662"></a>          <span class="n">TmpRfRyNH</span><span class="p">(</span><span class="n">NReflSurf</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2663"></a>          <span class="n">TmpHSurfNo</span><span class="p">(</span><span class="n">NReflSurf</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">JSurf</span>
<a name="ln-2664"></a>          <span class="n">TmpHitPt</span><span class="p">(</span><span class="n">NReflSurf</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">HitPt</span>
<a name="ln-2665"></a>          <span class="n">V</span> <span class="o">=</span> <span class="n">HitPt</span> <span class="o">-</span> <span class="n">Centroid</span>    <span class="c">!vector array from window ctr to hit pt</span>
<a name="ln-2666"></a>          <span class="n">LeastHitDsq</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span> <span class="p">(</span><span class="n">V</span> <span class="p">,</span> <span class="n">V</span><span class="p">)</span>  <span class="c">!dist^2 window ctr to hit pt</span>
<a name="ln-2667"></a>          <span class="n">TmpHSurfDSq</span><span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">LeastHitDsq</span>
<a name="ln-2668"></a>          <span class="k">if</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">JSurf</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">JSurf</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2669"></a><span class="k">            </span><span class="n">TransRSurf</span> <span class="o">=</span> <span class="mf">1.0d0</span>  <span class="c">!If a shadowing surface may have a scheduled transmittance,</span>
<a name="ln-2670"></a>                         <span class="c">!   treat it here as completely transparent</span>
<a name="ln-2671"></a>          <span class="k">else</span>
<a name="ln-2672"></a><span class="k">            </span><span class="n">TransRSurf</span><span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2673"></a>          <span class="k">end if</span>
<a name="ln-2674"></a><span class="k">          else</span>
<a name="ln-2675"></a><span class="k">            </span><span class="n">V</span> <span class="o">=</span> <span class="n">HitPt</span> <span class="o">-</span> <span class="n">Centroid</span>
<a name="ln-2676"></a>            <span class="n">HitDsq</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span> <span class="p">(</span><span class="n">V</span> <span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<a name="ln-2677"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">HitDsq</span> <span class="o">&gt;=</span> <span class="n">LeastHitDsq</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2678"></a><span class="k">              if</span> <span class="p">(</span><span class="n">TransRSurf</span>  <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>  <span class="c">!forget the new hit if the closer hit is opaque</span>
<a name="ln-2679"></a>                <span class="n">J</span> <span class="o">=</span> <span class="n">TotHits</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2680"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">TotHits</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2681"></a><span class="k">                  do </span><span class="n">I</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">TotHits</span>
<a name="ln-2682"></a>                    <span class="k">if</span> <span class="p">(</span> <span class="n">HitDsq</span> <span class="o">&lt;</span> <span class="n">TmpHSurfDSq</span><span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">I</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2683"></a><span class="k">                      </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span>
<a name="ln-2684"></a>                      <span class="k">exit</span>
<a name="ln-2685"></a><span class="k">                    end if</span>
<a name="ln-2686"></a><span class="k">                  end do</span>
<a name="ln-2687"></a><span class="k">                  if</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">JSurf</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2688"></a>                                                <span class="n">Surface</span><span class="p">(</span><span class="n">JSurf</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>  <span class="k">then</span>
<a name="ln-2689"></a>                    <span class="c">!  The new hit is opaque, so we can drop all the hits further away</span>
<a name="ln-2690"></a>                    <span class="n">TmpHSurfNo</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">JSurf</span>
<a name="ln-2691"></a>                    <span class="n">TmpHitPt</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">HitPt</span>
<a name="ln-2692"></a>                    <span class="n">TmpHSurfDSq</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">HitDsq</span>
<a name="ln-2693"></a>                    <span class="n">TotHits</span> <span class="o">=</span> <span class="n">J</span>
<a name="ln-2694"></a>                  <span class="k">else</span>
<a name="ln-2695"></a>                    <span class="c">!  The new hit is scheduled (presumed transparent), so keep the more distant hits</span>
<a name="ln-2696"></a>                    <span class="c">!     Note that all the hists in the list will be transparent except the last,</span>
<a name="ln-2697"></a>                    <span class="c">!       which may be either transparent or opaque</span>
<a name="ln-2698"></a>                    <span class="k">if</span> <span class="p">(</span><span class="n">TotHits</span> <span class="o">&gt;=</span> <span class="n">J</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-2699"></a><span class="k">                      do </span><span class="n">I</span> <span class="o">=</span> <span class="n">TotHits</span> <span class="p">,</span> <span class="n">J</span> <span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-2700"></a>                        <span class="n">TmpHSurfNo</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TmpHSurfNo</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">I</span><span class="p">)</span>
<a name="ln-2701"></a>                        <span class="n">TmpHitPt</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TmpHitPt</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">I</span><span class="p">)</span>
<a name="ln-2702"></a>                        <span class="n">TmpHSurfDSq</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TmpHSurfDSq</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">I</span><span class="p">)</span>
<a name="ln-2703"></a>                      <span class="k">end do</span>
<a name="ln-2704"></a><span class="k">                      </span><span class="n">TmpHSurfNo</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">JSurf</span>
<a name="ln-2705"></a>                      <span class="n">TmpHitPt</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">HitPt</span>
<a name="ln-2706"></a>                      <span class="n">TmpHSurfDSq</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">HitDsq</span>
<a name="ln-2707"></a>                      <span class="n">TotHits</span> <span class="o">=</span> <span class="n">TotHits</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2708"></a>                    <span class="k">end if</span>
<a name="ln-2709"></a><span class="k">                  end if</span> <span class="c">! if (.NOT.Surface(JSurf)%HeatTransSurf .AND. Surface(JSurf)%SchedShadowSurfIndex == 0)  then</span>
<a name="ln-2710"></a>                <span class="k">end if</span> <span class="c">! if (TotHits &gt; 1) then</span>
<a name="ln-2711"></a>              <span class="k">end if</span> <span class="c">! if (TransRSurf  &gt; 0.0d0) then</span>
<a name="ln-2712"></a>            <span class="k">else</span> <span class="c">! if (HitDsq &gt;= LeastHitDsq) then</span>
<a name="ln-2713"></a>              <span class="c">!  A new closest hit.  If it is opaque, drop the current hit list,</span>
<a name="ln-2714"></a>              <span class="c">!    otherwise add it at the front</span>
<a name="ln-2715"></a>              <span class="n">LeastHitDsq</span> <span class="o">=</span> <span class="n">HitDsq</span>
<a name="ln-2716"></a>              <span class="k">if</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">JSurf</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">JSurf</span><span class="p">)&amp;</span>
<a name="ln-2717"></a>                               <span class="p">%</span><span class="n">SchedShadowSurfIndex</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2718"></a><span class="k">                </span><span class="n">TransRSurf</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! New closest hit is transparent, keep the existing hit list</span>
<a name="ln-2719"></a>                <span class="k">do </span><span class="n">I</span> <span class="o">=</span> <span class="n">TotHits</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-2720"></a>                  <span class="n">TmpHSurfNo</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TmpHSurfNo</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">I</span><span class="p">)</span>
<a name="ln-2721"></a>                  <span class="n">TmpHitPt</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TmpHitPt</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">I</span><span class="p">)</span>
<a name="ln-2722"></a>                  <span class="n">TmpHSurfDSq</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TmpHSurfDSq</span> <span class="p">(</span><span class="n">NReflSurf</span> <span class="p">,</span> <span class="n">I</span><span class="p">)</span>
<a name="ln-2723"></a>                  <span class="n">TotHits</span> <span class="o">=</span> <span class="n">TotHits</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2724"></a>                <span class="k">end do</span>
<a name="ln-2725"></a><span class="k">              else</span>
<a name="ln-2726"></a><span class="k">                </span><span class="n">TransRSurf</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! New closest hit is opaque, drop the existing hit list</span>
<a name="ln-2727"></a>                <span class="n">TotHits</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2728"></a>              <span class="k">end if</span>
<a name="ln-2729"></a><span class="k">              </span><span class="n">TmpHSurfNo</span> <span class="p">(</span><span class="n">NReflSurf</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">JSurf</span>  <span class="c">! In either case the new hit is put in position 1</span>
<a name="ln-2730"></a>              <span class="n">TmpHitPt</span> <span class="p">(</span><span class="n">NReflSurf</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">HitPt</span>
<a name="ln-2731"></a>              <span class="n">TmpHSurfDSq</span> <span class="p">(</span><span class="n">NReflSurf</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">LeastHitDsq</span>
<a name="ln-2732"></a>            <span class="k">end if</span>
<a name="ln-2733"></a><span class="k">          end if</span>
<a name="ln-2734"></a><span class="k">        end do</span> <span class="c">! do JSurf = 1, TotSurfaces</span>
<a name="ln-2735"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">TotHits</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-2736"></a>          <span class="c">!This ray reached the sky or ground unobstructed</span>
<a name="ln-2737"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">sInc</span><span class="p">(</span><span class="n">IRay</span><span class="p">)%</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2738"></a>            <span class="c">!A ground ray</span>
<a name="ln-2739"></a>            <span class="n">NGnd</span> <span class="o">=</span> <span class="n">NGnd</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2740"></a>            <span class="n">TmpGndInd</span><span class="p">(</span><span class="n">NGnd</span><span class="p">)</span> <span class="o">=</span> <span class="n">IRay</span>
<a name="ln-2741"></a>            <span class="n">TmpGndPt</span><span class="p">(</span><span class="n">NGnd</span><span class="p">)%</span><span class="n">x</span> <span class="o">=</span> <span class="n">Centroid</span><span class="p">%</span><span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">sInc</span><span class="p">(</span><span class="n">IRay</span><span class="p">)%</span><span class="n">x</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-2742"></a>                                <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">sInc</span><span class="p">(</span><span class="n">IRay</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="n">Centroid</span><span class="p">%</span><span class="n">z</span>
<a name="ln-2743"></a>            <span class="n">TmpGndPt</span><span class="p">(</span><span class="n">NGnd</span><span class="p">)%</span><span class="n">y</span> <span class="o">=</span> <span class="n">Centroid</span><span class="p">%</span><span class="n">y</span> <span class="o">-</span> <span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">sInc</span><span class="p">(</span><span class="n">IRay</span><span class="p">)%</span><span class="n">y</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-2744"></a>                                <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">sInc</span><span class="p">(</span><span class="n">IRay</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="n">Centroid</span><span class="p">%</span><span class="n">z</span>
<a name="ln-2745"></a>            <span class="n">TmpGndPt</span><span class="p">(</span><span class="n">NGnd</span><span class="p">)%</span><span class="n">z</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2746"></a>
<a name="ln-2747"></a>            <span class="c">! for solar reflectance calculations, need to precalculate obstruction multipliers</span>
<a name="ln-2748"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">CalcSolRefl</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2749"></a><span class="k">              </span><span class="n">GroundHitPt</span> <span class="o">=</span> <span class="n">TmpGndPt</span><span class="p">(</span><span class="n">NGnd</span><span class="p">)</span>
<a name="ln-2750"></a>              <span class="n">TmpGndMultiplier</span><span class="p">(</span><span class="n">NGnd</span><span class="p">)</span> <span class="o">=</span> <span class="n">CalcObstrMultiplier</span><span class="p">(</span><span class="n">GroundHitPt</span><span class="p">,</span> <span class="n">AltAngStepsForSolReflCalc</span><span class="p">,</span> <span class="n">AzimAngStepsForSolReflCalc</span><span class="p">)</span>
<a name="ln-2751"></a>            <span class="k">end if</span>
<a name="ln-2752"></a><span class="k">          else</span>
<a name="ln-2753"></a>            <span class="c">!A sky ray</span>
<a name="ln-2754"></a>            <span class="n">NSky</span> <span class="o">=</span> <span class="n">NSky</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2755"></a>            <span class="n">TmpSkyInd</span><span class="p">(</span><span class="n">NSky</span><span class="p">)</span> <span class="o">=</span> <span class="n">IRay</span>
<a name="ln-2756"></a>          <span class="k">end if</span>
<a name="ln-2757"></a><span class="k">        else</span>
<a name="ln-2758"></a>          <span class="c">!Save the number of hits for this ray</span>
<a name="ln-2759"></a>          <span class="n">TmpRfRyNH</span> <span class="p">(</span><span class="n">NReflSurf</span><span class="p">)</span> <span class="o">=</span> <span class="n">TotHits</span>
<a name="ln-2760"></a>        <span class="k">end if</span>
<a name="ln-2761"></a><span class="k">        </span><span class="n">MaxTotHits</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">MaxTotHits</span><span class="p">,</span> <span class="n">TotHits</span><span class="p">)</span>
<a name="ln-2762"></a>      <span class="k">end do</span> <span class="c">! do IRay = 1, ComplexWind(IWin)%Geom(CurFenState)%Inc%NBasis</span>
<a name="ln-2763"></a>
<a name="ln-2764"></a>      <span class="c">! Fill up state data for current window element data</span>
<a name="ln-2765"></a>      <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">NSky</span><span class="p">(</span><span class="n">curWinEl</span><span class="p">)</span> <span class="o">=</span> <span class="n">NSky</span>
<a name="ln-2766"></a>      <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">SkyIndex</span><span class="p">(</span><span class="n">curWinEl</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NSky</span><span class="p">)</span> <span class="o">=</span> <span class="n">TmpSkyInd</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NSky</span><span class="p">)</span>
<a name="ln-2767"></a>
<a name="ln-2768"></a>      <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">NGnd</span><span class="p">(</span><span class="n">curWinEl</span><span class="p">)</span> <span class="o">=</span> <span class="n">NGnd</span>
<a name="ln-2769"></a>      <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">GndIndex</span><span class="p">(</span><span class="n">curWinEl</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NGnd</span><span class="p">)</span> <span class="o">=</span> <span class="n">TmpGndInd</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NGnd</span><span class="p">)</span>
<a name="ln-2770"></a>      <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">GndPt</span><span class="p">(</span><span class="n">curWinEl</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NGnd</span><span class="p">)</span> <span class="o">=</span> <span class="n">TmpGndPt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NGnd</span><span class="p">)</span>
<a name="ln-2771"></a>      <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">GndObstrMultiplier</span><span class="p">(</span><span class="n">curWinEl</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NGnd</span><span class="p">)</span> <span class="o">=</span> <span class="n">TmpGndMultiplier</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NGnd</span><span class="p">)</span>
<a name="ln-2772"></a>
<a name="ln-2773"></a>      <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">NReflSurf</span><span class="p">(</span><span class="n">curWinEl</span><span class="p">)</span> <span class="o">=</span> <span class="n">NReflSurf</span>
<a name="ln-2774"></a>      <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">RefSurfIndex</span><span class="p">(</span><span class="n">curWinEl</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NReflSurf</span><span class="p">)</span> <span class="o">=</span> <span class="n">TmpRfSfInd</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NReflSurf</span><span class="p">)</span>
<a name="ln-2775"></a>      <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">RefRayNHits</span><span class="p">(</span><span class="n">curWinEl</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NReflSurf</span><span class="p">)</span> <span class="o">=</span> <span class="n">TmpRfRyNH</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NReflSurf</span><span class="p">)</span>
<a name="ln-2776"></a>      <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">HitSurfNo</span><span class="p">(</span><span class="n">curWinEl</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NReflSurf</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">MaxTotHits</span><span class="p">)</span> <span class="o">=</span> <span class="n">TmpHSurfNo</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NReflSurf</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">MaxTotHits</span><span class="p">)</span>
<a name="ln-2777"></a>      <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">HitSurfDSq</span><span class="p">(</span><span class="n">curWinEl</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NReflSurf</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">MaxTotHits</span><span class="p">)</span> <span class="o">=</span> <span class="n">TmpHSurfDSq</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NReflSurf</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">MaxTotHits</span><span class="p">)</span>
<a name="ln-2778"></a>      <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">HitPt</span><span class="p">(</span><span class="n">curWinEl</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NReflSurf</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">MaxTotHits</span><span class="p">)</span> <span class="o">=</span> <span class="n">TmpHitPt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NReflSurf</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">MaxTotHits</span><span class="p">)</span>
<a name="ln-2779"></a>    <span class="k">end do</span> <span class="c">! do IY = 1, NWY</span>
<a name="ln-2780"></a>  <span class="k">end do</span> <span class="c">! do IX = 1, NWX</span>
<a name="ln-2781"></a>
<a name="ln-2782"></a>  <span class="c">! Deallocate temporary arrays</span>
<a name="ln-2783"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpSkyInd</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">TmpSkyInd</span><span class="p">)</span>
<a name="ln-2784"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpGndInd</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">TmpGndInd</span><span class="p">)</span>
<a name="ln-2785"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpGndPt</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">TmpGndPt</span><span class="p">)</span>
<a name="ln-2786"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpGndMultiplier</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">TmpGndMultiplier</span><span class="p">)</span>
<a name="ln-2787"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpRfSfInd</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">TmpRfSfInd</span><span class="p">)</span>
<a name="ln-2788"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpRfRyNH</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">TmpRfRyNH</span><span class="p">)</span>
<a name="ln-2789"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpHSurfNo</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">TmpHSurfNo</span><span class="p">)</span>
<a name="ln-2790"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpHitPt</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">TmpHitPt</span><span class="p">)</span>
<a name="ln-2791"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TmpHSurfDSq</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">TmpHSurfDSq</span><span class="p">)</span>
<a name="ln-2792"></a>
<a name="ln-2793"></a><span class="k">END SUBROUTINE </span><span class="n">InitializeCFSStateData</span>
<a name="ln-2794"></a>
<a name="ln-2795"></a><span class="k">SUBROUTINE </span><span class="n">AllocateForCFSRefPointsState</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">,</span> <span class="n">NumOfWinEl</span><span class="p">,</span> <span class="n">NBasis</span><span class="p">,</span> <span class="n">NTrnBasis</span><span class="p">)</span>
<a name="ln-2796"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2797"></a>          <span class="c">!       AUTHOR         Simon Vidanovic</span>
<a name="ln-2798"></a>          <span class="c">!       DATE WRITTEN   June 2013</span>
<a name="ln-2799"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2800"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2801"></a>
<a name="ln-2802"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2803"></a>          <span class="c">! Memory allocation for complex fenestration systems reference points geometry</span>
<a name="ln-2804"></a>
<a name="ln-2805"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2806"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-2807"></a>
<a name="ln-2808"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2809"></a>          <span class="c">! na</span>
<a name="ln-2810"></a>
<a name="ln-2811"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2812"></a>  <span class="k">use </span><span class="n">vectors</span>
<a name="ln-2813"></a>
<a name="ln-2814"></a>  <span class="k">implicit none</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2815"></a>
<a name="ln-2816"></a>  <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2817"></a>  <span class="k">type</span><span class="p">(</span><span class="n">BSDFRefPoints</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StateRefPoint</span>
<a name="ln-2818"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NumOfWinEl</span>
<a name="ln-2819"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NBasis</span>
<a name="ln-2820"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NTrnBasis</span>
<a name="ln-2821"></a>
<a name="ln-2822"></a>  <span class="c">! SUBROUTINE LOCAL VARIABLES</span>
<a name="ln-2823"></a>
<a name="ln-2824"></a>
<a name="ln-2825"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">NSky</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2826"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">NSky</span><span class="p">(</span><span class="n">NumOfWinEl</span><span class="p">))</span>
<a name="ln-2827"></a>    <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">NSky</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2828"></a>  <span class="k">end if</span>
<a name="ln-2829"></a>
<a name="ln-2830"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">SkyIndex</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2831"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">SkyIndex</span><span class="p">(</span><span class="n">NumOfWinEl</span><span class="p">,</span> <span class="n">NBasis</span><span class="p">))</span>
<a name="ln-2832"></a>    <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">SkyIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2833"></a>  <span class="k">end if</span>
<a name="ln-2834"></a>
<a name="ln-2835"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">NGnd</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2836"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">NGnd</span><span class="p">(</span><span class="n">NumOfWinEl</span><span class="p">))</span>
<a name="ln-2837"></a>    <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">NGnd</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2838"></a>  <span class="k">end if</span>
<a name="ln-2839"></a>
<a name="ln-2840"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">GndIndex</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2841"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">GndIndex</span><span class="p">(</span><span class="n">NumOfWinEl</span><span class="p">,</span> <span class="n">NBasis</span><span class="p">))</span>
<a name="ln-2842"></a>    <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">GndIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2843"></a>  <span class="k">end if</span>
<a name="ln-2844"></a>
<a name="ln-2845"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">GndPt</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2846"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">GndPt</span><span class="p">(</span><span class="n">NumOfWinEl</span><span class="p">,</span> <span class="n">NBasis</span><span class="p">))</span>
<a name="ln-2847"></a>    <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">GndPt</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-2848"></a>  <span class="k">end if</span>
<a name="ln-2849"></a>
<a name="ln-2850"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">GndObstrMultiplier</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2851"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">GndObstrMultiplier</span><span class="p">(</span><span class="n">NumOfWinEl</span><span class="p">,</span> <span class="n">NBasis</span><span class="p">))</span>
<a name="ln-2852"></a>    <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">GndObstrMultiplier</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2853"></a>  <span class="k">end if</span>
<a name="ln-2854"></a>
<a name="ln-2855"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">NReflSurf</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2856"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">NReflSurf</span><span class="p">(</span><span class="n">NumOfWinEl</span><span class="p">))</span>
<a name="ln-2857"></a>    <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">NReflSurf</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2858"></a>  <span class="k">end if</span>
<a name="ln-2859"></a>
<a name="ln-2860"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">RefSurfIndex</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2861"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">RefSurfIndex</span><span class="p">(</span><span class="n">NumOfWinEl</span><span class="p">,</span> <span class="n">NBasis</span><span class="p">))</span>
<a name="ln-2862"></a>    <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">RefSurfIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2863"></a>  <span class="k">end if</span>
<a name="ln-2864"></a>
<a name="ln-2865"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">TransOutSurf</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2866"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">TransOutSurf</span><span class="p">(</span><span class="n">NumOfWinEl</span><span class="p">,</span> <span class="n">NBasis</span><span class="p">))</span>
<a name="ln-2867"></a>    <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">TransOutSurf</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2868"></a>  <span class="k">end if</span>
<a name="ln-2869"></a>
<a name="ln-2870"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">RefRayNHits</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2871"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">RefRayNHits</span><span class="p">(</span><span class="n">NumOfWinEl</span><span class="p">,</span> <span class="n">NBasis</span><span class="p">))</span>
<a name="ln-2872"></a>    <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">RefRayNHits</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2873"></a>  <span class="k">end if</span>
<a name="ln-2874"></a>
<a name="ln-2875"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">HitSurfNo</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2876"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">HitSurfNo</span><span class="p">(</span><span class="n">NumOfWinEl</span><span class="p">,</span> <span class="n">NBasis</span><span class="p">,</span> <span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-2877"></a>    <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">HitSurfNo</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2878"></a>  <span class="k">end if</span>
<a name="ln-2879"></a>
<a name="ln-2880"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">HitSurfDSq</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2881"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">HitSurfDSq</span><span class="p">(</span><span class="n">NumOfWinEl</span><span class="p">,</span> <span class="n">NBasis</span><span class="p">,</span> <span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-2882"></a>    <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">HitSurfDSq</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2883"></a>  <span class="k">end if</span>
<a name="ln-2884"></a>
<a name="ln-2885"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">HitPt</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2886"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">HitPt</span><span class="p">(</span><span class="n">NumOfWinEl</span><span class="p">,</span> <span class="n">NBasis</span><span class="p">,</span> <span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-2887"></a>    <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">HitPt</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-2888"></a>  <span class="k">end if</span>
<a name="ln-2889"></a>
<a name="ln-2890"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">RefPointIndex</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2891"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">RefPointIndex</span><span class="p">(</span><span class="n">NumOfWinEl</span><span class="p">))</span>
<a name="ln-2892"></a>    <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">RefPointIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2893"></a>  <span class="k">end if</span>
<a name="ln-2894"></a>
<a name="ln-2895"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">RefPointIntersection</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2896"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">RefPointIntersection</span><span class="p">(</span><span class="n">NTrnBasis</span><span class="p">))</span>
<a name="ln-2897"></a>    <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">RefPointIntersection</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2898"></a>  <span class="k">end if</span>
<a name="ln-2899"></a>
<a name="ln-2900"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">RefPtIntPosFac</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2901"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">StateRefPoint</span><span class="p">%</span><span class="n">RefPtIntPosFac</span><span class="p">(</span><span class="n">NTrnBasis</span><span class="p">))</span>
<a name="ln-2902"></a>    <span class="n">StateRefPoint</span><span class="p">%</span><span class="n">RefPtIntPosFac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2903"></a>  <span class="k">end if</span>
<a name="ln-2904"></a>
<a name="ln-2905"></a><span class="k">  return</span>
<a name="ln-2906"></a>
<a name="ln-2907"></a><span class="k">END SUBROUTINE </span><span class="n">AllocateForCFSRefPointsState</span>
<a name="ln-2908"></a>
<a name="ln-2909"></a><span class="k">SUBROUTINE </span><span class="n">AllocateForCFSRefPointsGeometry</span><span class="p">(</span><span class="n">RefPointsGeomDescr</span><span class="p">,</span> <span class="n">NumOfWinEl</span><span class="p">)</span>
<a name="ln-2910"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2911"></a>          <span class="c">!       AUTHOR         Simon Vidanovic</span>
<a name="ln-2912"></a>          <span class="c">!       DATE WRITTEN   June 2013</span>
<a name="ln-2913"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2914"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2915"></a>
<a name="ln-2916"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2917"></a>          <span class="c">! Memory allocation for complex fenestration systems reference points geometry</span>
<a name="ln-2918"></a>
<a name="ln-2919"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2920"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-2921"></a>
<a name="ln-2922"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2923"></a>          <span class="c">! na</span>
<a name="ln-2924"></a>
<a name="ln-2925"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2926"></a>  <span class="k">use </span><span class="n">vectors</span>
<a name="ln-2927"></a>
<a name="ln-2928"></a>  <span class="k">implicit none</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2929"></a>
<a name="ln-2930"></a>  <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2931"></a>  <span class="k">type</span><span class="p">(</span><span class="n">BSDFRefPointsGeomDescr</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RefPointsGeomDescr</span>
<a name="ln-2932"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NumOfWinEl</span>
<a name="ln-2933"></a>  <span class="c">!integer, intent(in) :: NRefPts</span>
<a name="ln-2934"></a>
<a name="ln-2935"></a>  <span class="c">! SUBROUTINE LOCAL VARIABLES</span>
<a name="ln-2936"></a>
<a name="ln-2937"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">RefPointsGeomDescr</span><span class="p">%</span><span class="n">SolidAngle</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2938"></a><span class="k">    allocate</span> <span class="p">(</span><span class="n">RefPointsGeomDescr</span><span class="p">%</span><span class="n">SolidAngle</span><span class="p">(</span><span class="n">NumOfWinEl</span><span class="p">))</span>
<a name="ln-2939"></a>    <span class="n">RefPointsGeomDescr</span><span class="p">%</span><span class="n">SolidAngle</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2940"></a>  <span class="k">end if</span>
<a name="ln-2941"></a>
<a name="ln-2942"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">RefPointsGeomDescr</span><span class="p">%</span><span class="n">SolidAngleVec</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2943"></a><span class="k">    allocate</span> <span class="p">(</span><span class="n">RefPointsGeomDescr</span><span class="p">%</span><span class="n">SolidAngleVec</span><span class="p">(</span><span class="n">NumOfWinEl</span><span class="p">))</span>
<a name="ln-2944"></a>    <span class="n">RefPointsGeomDescr</span><span class="p">%</span><span class="n">SolidAngleVec</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-2945"></a>  <span class="k">end if</span>
<a name="ln-2946"></a>
<a name="ln-2947"></a><span class="k">  return</span>
<a name="ln-2948"></a>
<a name="ln-2949"></a><span class="k">END SUBROUTINE </span><span class="n">AllocateForCFSRefPointsGeometry</span>
<a name="ln-2950"></a>
<a name="ln-2951"></a><span class="k">SUBROUTINE </span><span class="n">CFSRefPointSolidAngle</span><span class="p">(</span><span class="n">RefPoint</span><span class="p">,</span> <span class="n">RWin</span><span class="p">,</span> <span class="n">WNorm</span><span class="p">,</span> <span class="n">RefPointMap</span><span class="p">,</span> <span class="n">RefPointGeomMap</span><span class="p">,</span> <span class="n">iWin</span><span class="p">,</span> <span class="n">CurFenState</span><span class="p">,</span> <span class="n">NTrnBasis</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2952"></a>  <span class="n">curWinEl</span><span class="p">,</span> <span class="n">WinElArea</span><span class="p">)</span>
<a name="ln-2953"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2954"></a>          <span class="c">!       AUTHOR         Simon Vidanovic</span>
<a name="ln-2955"></a>          <span class="c">!       DATE WRITTEN   June 2013</span>
<a name="ln-2956"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2957"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2958"></a>
<a name="ln-2959"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2960"></a>          <span class="c">! Calculate position factor for given reference point.</span>
<a name="ln-2961"></a>
<a name="ln-2962"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2963"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-2964"></a>
<a name="ln-2965"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2966"></a>          <span class="c">! na</span>
<a name="ln-2967"></a>
<a name="ln-2968"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2969"></a>  <span class="k">use </span><span class="n">vectors</span>
<a name="ln-2970"></a>
<a name="ln-2971"></a>  <span class="k">implicit none</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2972"></a>
<a name="ln-2973"></a>  <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2974"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RefPoint</span>
<a name="ln-2975"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RWin</span>
<a name="ln-2976"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WNorm</span>
<a name="ln-2977"></a>  <span class="c">!integer, intent(in) :: iRefPoint</span>
<a name="ln-2978"></a>  <span class="k">type</span><span class="p">(</span><span class="n">BSDFRefPoints</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RefPointMap</span>
<a name="ln-2979"></a>  <span class="k">type</span><span class="p">(</span><span class="n">BSDFRefPointsGeomDescr</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RefPointGeomMap</span>
<a name="ln-2980"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iWin</span>
<a name="ln-2981"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurFenState</span>
<a name="ln-2982"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NTrnBasis</span>
<a name="ln-2983"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">curWinEl</span>
<a name="ln-2984"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WinElArea</span>
<a name="ln-2985"></a>
<a name="ln-2986"></a>  <span class="c">! SUBROUTINE LOCAL VARIABLES</span>
<a name="ln-2987"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ray</span>
<a name="ln-2988"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RayNorm</span>
<a name="ln-2989"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">V</span>
<a name="ln-2990"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BestMatch</span>
<a name="ln-2991"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iTrnRay</span>
<a name="ln-2992"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">temp</span>
<a name="ln-2993"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Dist</span>
<a name="ln-2994"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosB</span>
<a name="ln-2995"></a>
<a name="ln-2996"></a>  <span class="c">! calculate vector from center of window element to the current reference point</span>
<a name="ln-2997"></a>  <span class="n">Ray</span> <span class="o">=</span> <span class="n">RefPoint</span> <span class="o">-</span> <span class="n">RWin</span>
<a name="ln-2998"></a>
<a name="ln-2999"></a>  <span class="c">! figure out outgoing beam direction from current reference point</span>
<a name="ln-3000"></a>  <span class="n">BestMatch</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3001"></a>  <span class="k">do </span><span class="n">iTrnRay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NTrnBasis</span>
<a name="ln-3002"></a>    <span class="n">V</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">sTrn</span><span class="p">(</span><span class="n">iTrnRay</span><span class="p">)</span>
<a name="ln-3003"></a>    <span class="n">temp</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">Ray</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<a name="ln-3004"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">temp</span> <span class="o">&gt;</span> <span class="n">BestMatch</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3005"></a><span class="k">      </span><span class="n">BestMatch</span> <span class="o">=</span> <span class="n">temp</span>
<a name="ln-3006"></a>      <span class="n">RefPointMap</span><span class="p">%</span><span class="n">RefPointIndex</span><span class="p">(</span><span class="n">curWinEl</span><span class="p">)</span> <span class="o">=</span> <span class="n">iTrnRay</span>
<a name="ln-3007"></a>    <span class="k">end if</span>
<a name="ln-3008"></a><span class="k">  end do</span>
<a name="ln-3009"></a>
<a name="ln-3010"></a>  <span class="c">! calculate solid view angle</span>
<a name="ln-3011"></a>  <span class="n">Dist</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">dot_product</span><span class="p">(</span><span class="n">Ray</span><span class="p">,</span> <span class="n">Ray</span><span class="p">))</span>
<a name="ln-3012"></a>  <span class="n">RayNorm</span> <span class="o">=</span> <span class="n">Ray</span> <span class="o">/</span> <span class="n">Dist</span>
<a name="ln-3013"></a>  <span class="n">RefPointGeomMap</span><span class="p">%</span><span class="n">SolidAngleVec</span><span class="p">(</span><span class="n">curWinEl</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">RayNorm</span>
<a name="ln-3014"></a>  <span class="n">CosB</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">WNorm</span><span class="p">,</span> <span class="o">-</span><span class="n">RayNorm</span><span class="p">)</span>
<a name="ln-3015"></a>  <span class="n">RefPointGeomMap</span><span class="p">%</span><span class="n">SolidAngle</span><span class="p">(</span><span class="n">curWinEl</span><span class="p">)</span> <span class="o">=</span> <span class="n">WinElArea</span> <span class="o">*</span> <span class="n">CosB</span> <span class="o">/</span> <span class="p">(</span><span class="n">Dist</span> <span class="o">*</span> <span class="n">Dist</span><span class="p">)</span>
<a name="ln-3016"></a>
<a name="ln-3017"></a>  <span class="k">return</span>
<a name="ln-3018"></a>
<a name="ln-3019"></a><span class="k">END SUBROUTINE</span>
<a name="ln-3020"></a>
<a name="ln-3021"></a><span class="k">SUBROUTINE </span><span class="n">CFSRefPointPosFactor</span><span class="p">(</span><span class="n">RefPoint</span><span class="p">,</span> <span class="n">RefPointMap</span><span class="p">,</span> <span class="n">iWin</span><span class="p">,</span> <span class="n">CurFenState</span><span class="p">,</span> <span class="n">NTrnBasis</span><span class="p">,</span> <span class="n">AZVIEW</span><span class="p">)</span>
<a name="ln-3022"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3023"></a>          <span class="c">!       AUTHOR         Simon Vidanovic</span>
<a name="ln-3024"></a>          <span class="c">!       DATE WRITTEN   June 2013</span>
<a name="ln-3025"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3026"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3027"></a>
<a name="ln-3028"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3029"></a>          <span class="c">! Calculate position factor for given reference point.</span>
<a name="ln-3030"></a>
<a name="ln-3031"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3032"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3033"></a>
<a name="ln-3034"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3035"></a>          <span class="c">! na</span>
<a name="ln-3036"></a>
<a name="ln-3037"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3038"></a>  <span class="k">use </span><span class="n">vectors</span>
<a name="ln-3039"></a>  <span class="k">use </span><span class="n">WindowComplexManager</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">PierceSurfaceVector</span><span class="p">,</span> <span class="n">DaylghtAltAndAzimuth</span>
<a name="ln-3040"></a>
<a name="ln-3041"></a>  <span class="k">implicit none</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3042"></a>
<a name="ln-3043"></a>  <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3044"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RefPoint</span>
<a name="ln-3045"></a>  <span class="c">!integer, intent(in) :: iRefPoint</span>
<a name="ln-3046"></a>  <span class="k">type</span><span class="p">(</span><span class="n">BSDFRefPoints</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RefPointMap</span>
<a name="ln-3047"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iWin</span>
<a name="ln-3048"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurFenState</span>
<a name="ln-3049"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NTrnBasis</span>
<a name="ln-3050"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AZVIEW</span>
<a name="ln-3051"></a>
<a name="ln-3052"></a>  <span class="c">! SUBROUTINE LOCAL VARIABLES</span>
<a name="ln-3053"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iTrnRay</span>
<a name="ln-3054"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XR</span>
<a name="ln-3055"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YR</span>
<a name="ln-3056"></a>  <span class="k">type</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Vec</span>
<a name="ln-3057"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">V</span>
<a name="ln-3058"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iPierc</span>
<a name="ln-3059"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InterPoint</span>
<a name="ln-3060"></a>  <span class="k">type</span><span class="p">(</span><span class="n">BSDFDaylghtPosition</span><span class="p">)</span> <span class="kd">::</span> <span class="n">elPos</span>  <span class="c">! altitude and azimuth of intersection element</span>
<a name="ln-3061"></a>
<a name="ln-3062"></a>  <span class="k">do </span><span class="n">iTrnRay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NTrnBasis</span>
<a name="ln-3063"></a>    <span class="n">Vec</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">iWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurFenState</span><span class="p">)%</span><span class="n">sTrn</span><span class="p">(</span><span class="n">iTrnRay</span><span class="p">)</span>
<a name="ln-3064"></a>    <span class="n">Vec</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">Vec</span><span class="p">%</span><span class="n">x</span>
<a name="ln-3065"></a>    <span class="n">Vec</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">Vec</span><span class="p">%</span><span class="n">y</span>
<a name="ln-3066"></a>    <span class="n">Vec</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="n">Vec</span><span class="p">%</span><span class="n">z</span>
<a name="ln-3067"></a>    <span class="n">V</span> <span class="o">=</span> <span class="n">Vec</span>
<a name="ln-3068"></a>    <span class="k">call </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span> <span class="n">RefPoint</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">iPierc</span><span class="p">,</span> <span class="n">InterPoint</span><span class="p">)</span>
<a name="ln-3069"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">iPierc</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3070"></a><span class="k">      </span><span class="n">RefPointMap</span><span class="p">%</span><span class="n">RefPointIntersection</span><span class="p">(</span><span class="n">iTrnRay</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3071"></a>
<a name="ln-3072"></a>      <span class="n">elPos</span> <span class="o">=</span> <span class="n">DaylghtAltAndAzimuth</span><span class="p">(</span><span class="n">Vec</span><span class="p">)</span>
<a name="ln-3073"></a>
<a name="ln-3074"></a>      <span class="n">XR</span> <span class="o">=</span> <span class="nb">TAN</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">PIOVR2</span> <span class="o">-</span> <span class="n">AZVIEW</span> <span class="o">-</span> <span class="n">elPos</span><span class="p">%</span><span class="n">Azimuth</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.001d0</span><span class="p">)</span>
<a name="ln-3075"></a>      <span class="n">YR</span> <span class="o">=</span> <span class="nb">TAN</span><span class="p">(</span><span class="n">elPos</span><span class="p">%</span><span class="n">Altitude</span> <span class="o">+</span> <span class="mf">0.001d0</span><span class="p">)</span>
<a name="ln-3076"></a>      <span class="n">RefPointMap</span><span class="p">%</span><span class="n">RefPtIntPosFac</span><span class="p">(</span><span class="n">iTrnRay</span><span class="p">)</span> <span class="o">=</span> <span class="n">DayltgGlarePositionFactor</span><span class="p">(</span><span class="n">XR</span><span class="p">,</span> <span class="n">YR</span><span class="p">)</span>
<a name="ln-3077"></a>    <span class="k">end if</span>
<a name="ln-3078"></a><span class="k">  end do</span>
<a name="ln-3079"></a>
<a name="ln-3080"></a><span class="k">  return</span>
<a name="ln-3081"></a>
<a name="ln-3082"></a><span class="k">END SUBROUTINE </span><span class="n">CFSRefPointPosFactor</span>
<a name="ln-3083"></a>
<a name="ln-3084"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">CalcObstrMultiplier</span><span class="p">(</span><span class="n">GroundHitPt</span><span class="p">,</span> <span class="n">AltSteps</span><span class="p">,</span> <span class="n">AzimSteps</span><span class="p">)</span>
<a name="ln-3085"></a>
<a name="ln-3086"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3087"></a>          <span class="c">!       AUTHOR         Simon Vidanovic</span>
<a name="ln-3088"></a>          <span class="c">!       DATE WRITTEN   April 2013, refactor from legacy code by Fred Winklemann</span>
<a name="ln-3089"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3090"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3091"></a>
<a name="ln-3092"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3093"></a>          <span class="c">! collect code to do obstruction multiplier from ground point</span>
<a name="ln-3094"></a>
<a name="ln-3095"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3096"></a>          <span class="c">! Send rays upward from hit point and see which ones are unobstructed and so go to sky.</span>
<a name="ln-3097"></a>          <span class="c">! Divide hemisphere centered at ground hit point into elements of altitude Phi and</span>
<a name="ln-3098"></a>          <span class="c">! azimuth Theta and create upward-going ground ray unit vector at each Phi,Theta pair.</span>
<a name="ln-3099"></a>          <span class="c">! Phi = 0 at the horizon; Phi = Pi/2 at the zenith.</span>
<a name="ln-3100"></a>
<a name="ln-3101"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3102"></a>          <span class="c">! &lt;&gt;</span>
<a name="ln-3103"></a>
<a name="ln-3104"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3105"></a>
<a name="ln-3106"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-3107"></a>
<a name="ln-3108"></a><span class="k">  </span><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GroundHitPt</span>    <span class="c">! Coordinates of point that ray hits ground (m)</span>
<a name="ln-3109"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AltSteps</span>  <span class="c">! Number of steps in altitude angle for solar reflection calc</span>
<a name="ln-3110"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AzimSteps</span>  <span class="c">! Number of steps in azimuth angle of solar reflection calc</span>
<a name="ln-3111"></a>
<a name="ln-3112"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">URay</span>           <span class="c">! Unit vector in (Phi,Theta) direction</span>
<a name="ln-3113"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DPhi</span>   <span class="c">! Phi increment (radians)</span>
<a name="ln-3114"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DTheta</span> <span class="c">! Theta increment (radians)</span>
<a name="ln-3115"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyGndUnObs</span>                  <span class="c">! Unobstructed sky irradiance at a ground point</span>
<a name="ln-3116"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyGndObs</span>                    <span class="c">! Obstructed sky irradiance at a ground point</span>
<a name="ln-3117"></a>
<a name="ln-3118"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IPhi</span> <span class="c">! Phi  index</span>
<a name="ln-3119"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Phi</span>   <span class="c">! Altitude  angle of ray from a ground point (radians)</span>
<a name="ln-3120"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SPhi</span>  <span class="c">! Sin of Phi</span>
<a name="ln-3121"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CPhi</span>  <span class="c">! cos of Phi</span>
<a name="ln-3122"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ITheta</span> <span class="c">!Theta index</span>
<a name="ln-3123"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Theta</span> <span class="c">! Azimuth angle of ray from a ground point (radians)</span>
<a name="ln-3124"></a>
<a name="ln-3125"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosIncAngURay</span>                <span class="c">! Cosine of incidence angle of URay on ground plane</span>
<a name="ln-3126"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dOmegaGnd</span>                    <span class="c">! Solid angle element of ray from ground point (steradians)</span>
<a name="ln-3127"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IncAngSolidAngFac</span>            <span class="c">! CosIncAngURay*dOmegaGnd/Pi</span>
<a name="ln-3128"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHitObs</span>                      <span class="c">! 1 if obstruction is hit; 0 otherwise</span>
<a name="ln-3129"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ObsSurfNum</span>                   <span class="c">! Surface number of obstruction</span>
<a name="ln-3130"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObsHitPt</span>                  <span class="c">! Coordinates of hit point on an obstruction (m)</span>
<a name="ln-3131"></a>
<a name="ln-3132"></a>  <span class="n">DPhi</span> <span class="o">=</span> <span class="n">PiOvr2</span> <span class="o">/</span> <span class="p">(</span><span class="n">AltSteps</span><span class="o">/</span><span class="mf">2.d0</span><span class="p">)</span>
<a name="ln-3133"></a>  <span class="n">DTheta</span> <span class="o">=</span> <span class="n">Pi</span> <span class="o">/</span> <span class="n">AzimSteps</span>
<a name="ln-3134"></a>  <span class="n">SkyGndObs</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3135"></a>  <span class="n">SkyGndUnObs</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3136"></a>
<a name="ln-3137"></a>  <span class="c">! Altitude loop</span>
<a name="ln-3138"></a>  <span class="k">DO </span><span class="n">IPhi</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,(</span><span class="n">AltSteps</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3139"></a>    <span class="n">Phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">IPhi</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">DPhi</span>
<a name="ln-3140"></a>    <span class="n">SPhi</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
<a name="ln-3141"></a>    <span class="n">CPhi</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
<a name="ln-3142"></a>
<a name="ln-3143"></a>    <span class="c">! Third component of ground ray unit vector in (Theta,Phi) direction</span>
<a name="ln-3144"></a>    <span class="n">URay</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">SPhi</span>
<a name="ln-3145"></a>    <span class="n">dOmegaGnd</span> <span class="o">=</span> <span class="n">CPhi</span> <span class="o">*</span> <span class="n">DTheta</span> <span class="o">*</span> <span class="n">DPhi</span>
<a name="ln-3146"></a>    <span class="c">! Cosine of angle of incidence of ground ray on ground plane</span>
<a name="ln-3147"></a>    <span class="n">CosIncAngURay</span> <span class="o">=</span> <span class="n">SPhi</span>
<a name="ln-3148"></a>    <span class="n">IncAngSolidAngFac</span> <span class="o">=</span> <span class="n">CosIncAngURay</span><span class="o">*</span><span class="n">dOmegaGnd</span><span class="o">/</span><span class="n">Pi</span>
<a name="ln-3149"></a>    <span class="c">! Azimuth loop</span>
<a name="ln-3150"></a>    <span class="k">DO </span><span class="n">ITheta</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">AzimSteps</span>
<a name="ln-3151"></a>      <span class="n">Theta</span> <span class="o">=</span> <span class="p">(</span><span class="n">ITheta</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">DTheta</span>
<a name="ln-3152"></a>      <span class="n">URay</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhi</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
<a name="ln-3153"></a>      <span class="n">URay</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhi</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
<a name="ln-3154"></a>      <span class="n">SkyGndUnObs</span> <span class="o">=</span> <span class="n">SkyGndUnObs</span> <span class="o">+</span> <span class="n">IncAngSolidAngFac</span>
<a name="ln-3155"></a>      <span class="c">! Does this ground ray hit an obstruction?</span>
<a name="ln-3156"></a>      <span class="n">IHitObs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3157"></a>      <span class="k">DO </span><span class="n">ObsSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-3158"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfPossibleObstruction</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3159"></a><span class="k">          CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">,</span><span class="n">GroundHitPt</span><span class="p">,</span><span class="n">URay</span><span class="p">,</span><span class="n">IHitObs</span><span class="p">,</span><span class="n">ObsHitPt</span><span class="p">)</span>
<a name="ln-3160"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-3161"></a><span class="k">      END DO</span>
<a name="ln-3162"></a><span class="k">      IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span> <span class="c">! Obstruction hit</span>
<a name="ln-3163"></a>      <span class="c">! Sky is hit</span>
<a name="ln-3164"></a>      <span class="n">SkyGndObs</span> <span class="o">=</span> <span class="n">SkyGndObs</span> <span class="o">+</span> <span class="n">IncAngSolidAngFac</span>
<a name="ln-3165"></a>    <span class="k">END DO</span> <span class="c">! End of azimuth loop</span>
<a name="ln-3166"></a>  <span class="k">END DO</span>  <span class="c">! End of altitude loop</span>
<a name="ln-3167"></a>
<a name="ln-3168"></a>  <span class="c">! in case ground point is surrounded by obstructions (SkyGndUnObs == 0), then multiplier will be equal to zero</span>
<a name="ln-3169"></a>  <span class="c">! This should not happen anyway because in that case ray would not be able to reach ground point</span>
<a name="ln-3170"></a>  <span class="n">CalcObstrMultiplier</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3171"></a>
<a name="ln-3172"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SkyGndUnObs</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3173"></a><span class="k">    </span><span class="n">CalcObstrMultiplier</span> <span class="o">=</span> <span class="n">SkyGndObs</span> <span class="o">/</span> <span class="n">SkyGndUnObs</span>
<a name="ln-3174"></a>  <span class="k">END IF</span>
<a name="ln-3175"></a>
<a name="ln-3176"></a><span class="k">  RETURN</span>
<a name="ln-3177"></a>
<a name="ln-3178"></a><span class="k">END FUNCTION </span><span class="n">CalcObstrMultiplier</span>
<a name="ln-3179"></a>
<a name="ln-3180"></a>
<a name="ln-3181"></a><span class="k">SUBROUTINE </span><span class="n">FigureDayltgCoeffsAtPointsForSunPosition</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">,</span> <span class="n">iXelement</span><span class="p">,</span> <span class="n">NWX</span><span class="p">,</span> <span class="n">iYelement</span><span class="p">,</span> <span class="n">NWY</span><span class="p">,</span> <span class="n">WinEl</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3182"></a>                            <span class="n">iWin</span><span class="p">,</span> <span class="n">iWin2</span><span class="p">,</span> <span class="n">iHour</span><span class="p">,</span><span class="n">iSunPos</span><span class="p">,</span><span class="n">SkyObstructionMult</span><span class="p">,</span>  <span class="n">RWIN2</span><span class="p">,</span> <span class="n">Ray</span><span class="p">,</span> <span class="n">PHRAY</span><span class="p">,</span> <span class="n">LSHCAL</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3183"></a>                            <span class="n">InShelfSurf</span><span class="p">,</span> <span class="n">COSB</span><span class="p">,</span> <span class="n">ObTrans</span><span class="p">,</span><span class="n">TVISB</span><span class="p">,</span><span class="n">DOMEGA</span><span class="p">,</span> <span class="n">ICtrl</span><span class="p">,</span> <span class="n">ShType</span><span class="p">,</span> <span class="n">BlNum</span><span class="p">,</span> <span class="n">THRAY</span><span class="p">,</span> <span class="n">WNORM2</span><span class="p">,</span> <span class="n">ExtWinType</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3184"></a>                            <span class="n">IConst</span><span class="p">,</span> <span class="n">AZVIEW</span><span class="p">,</span> <span class="n">RREF2</span><span class="p">,</span> <span class="n">LoopWin</span><span class="p">,</span> <span class="n">IHitIntObs</span><span class="p">,</span><span class="n">IHitExtObs</span><span class="p">,</span> <span class="n">CalledFrom</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-3185"></a>                            <span class="n">TVISIntWin</span><span class="p">,</span> <span class="n">TVISIntWinDisk</span><span class="p">,</span>                                               <span class="p">&amp;</span>
<a name="ln-3186"></a>                            <span class="n">MapNum</span><span class="p">,</span> <span class="n">MapWindowSolidAngAtRefPtWtd</span><span class="p">)</span>
<a name="ln-3187"></a>
<a name="ln-3188"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3189"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-3190"></a>          <span class="c">!       DATE WRITTEN   November 2012, refactor from legacy code by Fred Winklemann</span>
<a name="ln-3191"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3192"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3193"></a>
<a name="ln-3194"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3195"></a>          <span class="c">! collect code for calculations sun position aspects for daylighting coefficients</span>
<a name="ln-3196"></a>
<a name="ln-3197"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3198"></a>          <span class="c">! switch as need to serve both reference points and map points based on calledFrom</span>
<a name="ln-3199"></a>
<a name="ln-3200"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3201"></a>          <span class="c">! na</span>
<a name="ln-3202"></a>
<a name="ln-3203"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3204"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>             <span class="n">ONLY</span><span class="p">:</span> <span class="n">POLYF</span><span class="p">,</span> <span class="n">BlindBeamBeamTrans</span>
<a name="ln-3205"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DetailedSkyDiffuseAlgorithm</span>
<a name="ln-3206"></a>  <span class="k">USE </span><span class="n">SolarReflectionManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolReflRecSurf</span>
<a name="ln-3207"></a>
<a name="ln-3208"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3209"></a>
<a name="ln-3210"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3211"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ZoneNum</span>
<a name="ln-3212"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iRefPoint</span>
<a name="ln-3213"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iXelement</span>
<a name="ln-3214"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NWX</span>                          <span class="c">! Number of window elements in x direction for dayltg calc</span>
<a name="ln-3215"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iYelement</span>
<a name="ln-3216"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NWY</span>                          <span class="c">! Number of window elements in y direction for dayltg calc</span>
<a name="ln-3217"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">WinEl</span>                        <span class="c">! Current window element counter</span>
<a name="ln-3218"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iWin</span>
<a name="ln-3219"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iWin2</span>
<a name="ln-3220"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iHour</span>
<a name="ln-3221"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iSunPos</span>
<a name="ln-3222"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyObstructionMult</span>
<a name="ln-3223"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RWIN2</span>  <span class="c">! Center of a window element for TDD:DOME (if exists) in abs coord sys</span>
<a name="ln-3224"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RAY</span>    <span class="c">! Unit vector along ray from reference point to window element</span>
<a name="ln-3225"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PHRAY</span>                <span class="c">! Altitude of ray from reference point to window element (radians)</span>
<a name="ln-3226"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LSHCAL</span>               <span class="c">! Interior shade calculation flag:  0=not yet calculated, 1=already calculated</span>
<a name="ln-3227"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">InShelfSurf</span>          <span class="c">! Inside daylighting shelf surface number</span>
<a name="ln-3228"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">COSB</span>                <span class="c">! Cosine of angle between window outward normal and ray from reference point</span>
<a name="ln-3229"></a>                                               <span class="c">! to window element</span>
<a name="ln-3230"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObTrans</span>             <span class="c">! Product of solar transmittances of exterior obstructions hit by ray</span>
<a name="ln-3231"></a>                                               <span class="c">! from reference point through a window element</span>
<a name="ln-3232"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVISB</span>               <span class="c">! Visible transmittance of window for COSB angle of incidence (times light well</span>
<a name="ln-3233"></a>                                               <span class="c">!   efficiency, if appropriate)</span>
<a name="ln-3234"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DOMEGA</span>             <span class="c">! Solid angle subtended by window element wrt reference point (steradians)</span>
<a name="ln-3235"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ICtrl</span>               <span class="c">! Window control counter</span>
<a name="ln-3236"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ShType</span>                       <span class="c">! Window shading type</span>
<a name="ln-3237"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">BlNum</span>                        <span class="c">! Window blind number</span>
<a name="ln-3238"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">THRAY</span>                        <span class="c">! Azimuth of ray from reference point to window element (radians)</span>
<a name="ln-3239"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WNORM2</span>                    <span class="c">! Unit vector normal to window</span>
<a name="ln-3240"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ExtWinType</span>                   <span class="c">! Exterior window type (InZoneExtWin, AdjZoneExtWin, NotInOrAdjZoneExtWin)</span>
<a name="ln-3241"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">IConst</span>                       <span class="c">! Construction counter</span>
<a name="ln-3242"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AZVIEW</span>                       <span class="c">! Azimuth of view vector in absolute coord system for</span>
<a name="ln-3243"></a>                                            <span class="c">!  glare calculation (radians)</span>
<a name="ln-3244"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RREF2</span>  <span class="c">! Location of virtual reference point in absolute coordinate system</span>
<a name="ln-3245"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">LoopWin</span>
<a name="ln-3246"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">IHitIntObs</span>                   <span class="c">! = 1 if interior obstruction hit, = 0 otherwise</span>
<a name="ln-3247"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">IHitExtObs</span>                   <span class="c">! 1 if ray from ref pt to ext win hits an exterior obstruction</span>
<a name="ln-3248"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CalledFrom</span> <span class="c">! indicate  which type of routine called this routine</span>
<a name="ln-3249"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVISIntWin</span>    <span class="c">! Visible transmittance of int win at COSBIntWin for light from ext win</span>
<a name="ln-3250"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVISIntWinDisk</span>    <span class="c">! Visible transmittance of int win at COSBIntWin for sun</span>
<a name="ln-3251"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span>   <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">MapNum</span>
<a name="ln-3252"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>  <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">MapWindowSolidAngAtRefPtWtd</span>
<a name="ln-3253"></a>
<a name="ln-3254"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3255"></a>          <span class="c">! na</span>
<a name="ln-3256"></a>
<a name="ln-3257"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3258"></a>          <span class="c">! na</span>
<a name="ln-3259"></a>
<a name="ln-3260"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3261"></a>          <span class="c">! na</span>
<a name="ln-3262"></a>
<a name="ln-3263"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3264"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RREF</span>           <span class="c">! Location of a reference point in absolute coordinate system</span>
<a name="ln-3265"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XEDIRSK</span>        <span class="c">! Illuminance contribution from luminance element, sky-related</span>
<a name="ln-3266"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XEDIRSU</span>                      <span class="c">! Illuminance contribution from luminance element, sun-related</span>
<a name="ln-3267"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XAVWLSK</span>        <span class="c">! Luminance of window element, sky-related</span>
<a name="ln-3268"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RAYCOS</span>         <span class="c">! Unit vector from reference point to sun</span>
<a name="ln-3269"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">JB</span>                           <span class="c">! Slat angle counter</span>
<a name="ln-3270"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TransBmBmMult</span><span class="p">(</span><span class="n">MaxSlatAngs</span><span class="p">)</span>   <span class="c">! Beam-beam transmittance of isolated blind</span>
<a name="ln-3271"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TransBmBmMultRefl</span><span class="p">(</span><span class="n">MaxSlatAngs</span><span class="p">)</span> <span class="c">! As above but for beam reflected from exterior obstruction</span>
<a name="ln-3272"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ProfAng</span>                      <span class="c">! Solar profile angle on a window (radians)</span>
<a name="ln-3273"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">POSFAC</span>                       <span class="c">! Position factor for a window element / ref point / view vector combination</span>
<a name="ln-3274"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XR</span>                           <span class="c">! Horizontal displacement ratio</span>
<a name="ln-3275"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YR</span>                           <span class="c">! Vertical displacement ratio</span>
<a name="ln-3276"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHIT</span>                         <span class="c">! Hit flag; =1 if ray from ref point thru window element hits</span>
<a name="ln-3277"></a>                                            <span class="c">!  an obstruction, =0 otherwise.</span>
<a name="ln-3278"></a>
<a name="ln-3279"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObTransDisk</span>                  <span class="c">! Product of solar transmittances of exterior obstructions hit by ray</span>
<a name="ln-3280"></a>                                            <span class="c">! from reference point to sun</span>
<a name="ln-3281"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HP</span>             <span class="c">! Hit coordinates, if ray hits</span>
<a name="ln-3282"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LumAtHitPtFrSun</span>              <span class="c">! Luminance at hit point of obstruction by reflection of direct light from</span>
<a name="ln-3283"></a>                                            <span class="c">!  sun (cd/m2)</span>
<a name="ln-3284"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ISky</span>                         <span class="c">! Sky type index: 1=clear, 2=clear turbid, 3=intermediate, 4=overcast</span>
<a name="ln-3285"></a>
<a name="ln-3286"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ELUM</span>                         <span class="c">! Sky or ground luminance (cd/m2)</span>
<a name="ln-3287"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DEDIR</span>                        <span class="c">! Illuminance contribution at reference point from window element (lux)</span>
<a name="ln-3288"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">COSI</span>                         <span class="c">! Cosine of angle between direct sun and window outward normal</span>
<a name="ln-3289"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IP</span>                           <span class="c">! IP=1 if ray passes thru window, =0 if not</span>
<a name="ln-3290"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVISS</span>                        <span class="c">! Direct solar visible transmittance of window at given angle of incidence</span>
<a name="ln-3291"></a>                                            <span class="c">!  (times light well efficiency, if appropriate)</span>
<a name="ln-3292"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XAVWL</span>                        <span class="c">! XAVWL*TVISS is contribution of window luminance from solar disk (cd/m2)</span>
<a name="ln-3293"></a>
<a name="ln-3294"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SlatAng</span>                      <span class="c">! Blind slat angle (rad)</span>
<a name="ln-3295"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">Loop</span><span class="p">,</span><span class="n">Loop2</span>                   <span class="c">! DO loop indices</span>
<a name="ln-3296"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NearestHitSurfNum</span>            <span class="c">! Surface number of nearest obstruction</span>
<a name="ln-3297"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NearestHitSurfNumX</span>           <span class="c">! Surface number to use when obstruction is a shadowing surface</span>
<a name="ln-3298"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NearestHitPt</span>   <span class="c">! Hit point of ray on nearest obstruction</span>
<a name="ln-3299"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SunObstructionMult</span>           <span class="c">! = 1.0 if sun hits a ground point; otherwise = 0.0</span>
<a name="ln-3300"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HorDis</span>                       <span class="c">! Distance between ground hit point and proj&#39;n of center</span>
<a name="ln-3301"></a>                                            <span class="c">!  of window element onto ground (m)</span>
<a name="ln-3302"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Alfa</span><span class="p">,</span><span class="n">Beta</span>                    <span class="c">! Intermediate variables</span>
<a name="ln-3303"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GroundHitPt</span>    <span class="c">! Coordinates of point that ray hits ground (m)</span>
<a name="ln-3304"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHitObs</span>                      <span class="c">! 1 if obstruction is hit; 0 otherwise</span>
<a name="ln-3305"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObsHitPt</span>       <span class="c">! Coordinates of hit point on an obstruction (m)</span>
<a name="ln-3306"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ObsSurfNum</span>                   <span class="c">! Surface number of obstruction</span>
<a name="ln-3307"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ObsConstrNum</span>                 <span class="c">! Construction number of obstruction</span>
<a name="ln-3308"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObsVisRefl</span>                   <span class="c">! Visible reflectance of obstruction</span>
<a name="ln-3309"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyReflVisLum</span>                <span class="c">! Reflected sky luminance at hit point divided by</span>
<a name="ln-3310"></a>
<a name="ln-3311"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">RecSurfNum</span>                   <span class="c">! Receiving surface number</span>
<a name="ln-3312"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ReflSurfNum</span><span class="p">,</span><span class="n">ReflSurfNumX</span>     <span class="c">! Reflecting surface number</span>
<a name="ln-3313"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReflNorm</span>       <span class="c">! Normal vector to reflecting surface</span>
<a name="ln-3314"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosIncAngRefl</span>                <span class="c">! Cos of angle of incidence of beam on reflecting surface</span>
<a name="ln-3315"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SunVecMir</span>      <span class="c">! Sun ray mirrored in reflecting surface</span>
<a name="ln-3316"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosIncAngRec</span>                 <span class="c">! Cos of angle of incidence of reflected beam on receiving window</span>
<a name="ln-3317"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHitRefl</span>                     <span class="c">! 1 if ray hits reflecting surface; 0 otherwise</span>
<a name="ln-3318"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HitPtRefl</span>      <span class="c">! Point that ray hits reflecting surface</span>
<a name="ln-3319"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReflDistance</span>                 <span class="c">! Distance between ref pt and hit point on reflecting surf (m)</span>
<a name="ln-3320"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHitObsRefl</span>                  <span class="c">! &gt; 0 if obstruction hit between ref pt and reflection point</span>
<a name="ln-3321"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HitPtObs</span>       <span class="c">! Hit point on obstruction</span>
<a name="ln-3322"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObsDistance</span>                  <span class="c">! Distance from ref pt to reflection point</span>
<a name="ln-3323"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ReflSurfRecNum</span>               <span class="c">! Receiving surface number for a reflecting window</span>
<a name="ln-3324"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpecReflectance</span>              <span class="c">! Specular reflectance of a reflecting surface</span>
<a name="ln-3325"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVisRefl</span>                     <span class="c">! Bare window vis trans for reflected beam</span>
<a name="ln-3326"></a>                                            <span class="c">!  (times light well efficiency, if appropriate)</span>
<a name="ln-3327"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ConstrNumRefl</span>                <span class="c">! Window construction number for a specularly reflecting shading surf</span>
<a name="ln-3328"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PHSUNrefl</span>                    <span class="c">! Altitude angle of reflected sun (radians)</span>
<a name="ln-3329"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">THSUNrefl</span>                    <span class="c">! Azimuth anggle of reflected sun (radians)</span>
<a name="ln-3330"></a>
<a name="ln-3331"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHitIntWinDisk</span>               <span class="c">! 1 if ray from ref pt to sun passes thru an int window; 0 otherwise</span>
<a name="ln-3332"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHitIntObsDisk</span>               <span class="c">! 1 if ray from ref pt to sun hits an interior obstruction; 0 otherwise</span>
<a name="ln-3333"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHitExtObsDisk</span>               <span class="c">! 1 if ray from ref pt to sun hits an exterior obstruction; 0 otherwise</span>
<a name="ln-3334"></a>
<a name="ln-3335"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IntWinDisk</span>                   <span class="c">! Surface loop index for finding int windows betw ref pt and sun</span>
<a name="ln-3336"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HitPtIntWinDisk</span>  <span class="c">! Intersection point on an interior window for ray from ref pt to sun (m)</span>
<a name="ln-3337"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IntWinDiskHitNum</span>             <span class="c">! Surface number of int window intersected by ray betw ref pt and sun</span>
<a name="ln-3338"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">COSBIntWin</span>                   <span class="c">! Cos of angle between int win outward normal and ray betw ref pt and</span>
<a name="ln-3339"></a>                                            <span class="c">!  exterior window element or between ref pt and sun</span>
<a name="ln-3340"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVisIntWinMult</span>               <span class="c">! Interior window vis trans multiplier for ext win in adjacent zone</span>
<a name="ln-3341"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVisIntWinDiskMult</span>           <span class="c">! Interior window vis trans solar disk multiplier for ext win in adj zone</span>
<a name="ln-3342"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindowSolidAngleDaylightPoint</span>
<a name="ln-3343"></a>
<a name="ln-3344"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SUNCOSHR</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SunIsUpValue</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-3345"></a>
<a name="ln-3346"></a><span class="k">  </span><span class="n">ISunPos</span> <span class="o">=</span> <span class="n">ISunPos</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3347"></a>
<a name="ln-3348"></a> <span class="c">! Altitude of sun (degrees)</span>
<a name="ln-3349"></a>  <span class="n">PHSUN</span> <span class="o">=</span> <span class="n">PHSUNHR</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-3350"></a>  <span class="n">SPHSUN</span> <span class="o">=</span> <span class="n">SPHSUNHR</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-3351"></a>  <span class="n">CPHSUN</span> <span class="o">=</span> <span class="n">CPHSUNHR</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-3352"></a>
<a name="ln-3353"></a>  <span class="c">! Azimuth of sun in absolute coord sys</span>
<a name="ln-3354"></a>  <span class="n">THSUN</span> <span class="o">=</span> <span class="n">THSUNHR</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-3355"></a>
<a name="ln-3356"></a>            <span class="c">! First time through, call routine to calculate inter-reflected illuminance</span>
<a name="ln-3357"></a>            <span class="c">! at reference point and luminance of window with shade, screen or blind.</span>
<a name="ln-3358"></a>
<a name="ln-3359"></a>            <span class="c">! Rob/TH - Not sure whether this call is necessary for interior zones with interior windows only.</span>
<a name="ln-3360"></a><span class="c">!  new code would be -</span>
<a name="ln-3361"></a><span class="c">! IF (LSHCAL == 1 .AND. ExtWinType /= AdjZoneExtWin) CALL DayltgInterReflectedIllum(ISunPos,IHR,ZoneNum,IWin2)</span>
<a name="ln-3362"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">/=</span> <span class="n">WindowBSDFModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3363"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">LSHCAL</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">CALL </span><span class="n">DayltgInterReflectedIllum</span><span class="p">(</span><span class="n">iSunPos</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="n">ZoneNum</span><span class="p">,</span><span class="n">IWin2</span><span class="p">)</span>
<a name="ln-3364"></a>  <span class="k">ELSE</span>
<a name="ln-3365"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">LSHCAL</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">CALL </span><span class="n">DayltgInterReflectedIllumComplexFenestration</span><span class="p">(</span><span class="n">IWin2</span><span class="p">,</span> <span class="n">WinEl</span><span class="p">,</span> <span class="n">iHour</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">,</span> <span class="n">CalledFrom</span><span class="p">,</span> <span class="n">MapNum</span><span class="p">)</span>
<a name="ln-3366"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">COSB</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-3367"></a><span class="k">    CALL </span><span class="n">DayltgDirectIllumComplexFenestration</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span> <span class="n">WinEl</span><span class="p">,</span> <span class="n">iHour</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">,</span> <span class="n">CalledFrom</span><span class="p">,</span> <span class="n">MapNum</span><span class="p">)</span>
<a name="ln-3368"></a>    <span class="c">! Call direct sun component only once since calculation is done for entire window</span>
<a name="ln-3369"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WinEl</span> <span class="o">==</span> <span class="p">(</span><span class="n">NWX</span> <span class="o">*</span> <span class="n">NWY</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3370"></a><span class="k">      CALL </span><span class="n">DayltgDirectSunDiskComplexFenestration</span><span class="p">(</span><span class="n">IWin2</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">,</span> <span class="n">iHour</span><span class="p">,</span> <span class="n">loopwin</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">,</span> <span class="n">WinEl</span><span class="p">,</span> <span class="n">AZVIEW</span><span class="p">,</span> <span class="n">CalledFrom</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3371"></a>       <span class="n">MapNum</span><span class="p">,</span> <span class="n">MapWindowSolidAngAtRefPtWtd</span><span class="p">)</span>
<a name="ln-3372"></a>    <span class="k">END IF</span>
<a name="ln-3373"></a><span class="k">    RETURN</span>
<a name="ln-3374"></a><span class="k">  END IF</span>
<a name="ln-3375"></a>
<a name="ln-3376"></a>            <span class="c">! Daylighting shelf simplification:  The shelf completely blocks all view of the window,</span>
<a name="ln-3377"></a>            <span class="c">! only interrelflected illumination is allowed (see DayltgInterReflectedIllum above).</span>
<a name="ln-3378"></a>            <span class="c">! Everything else in this loop has to do with direct luminance from the window.</span>
<a name="ln-3379"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">InShelfSurf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-3380"></a>
<a name="ln-3381"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">COSB</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-3382"></a>
<a name="ln-3383"></a><span class="k">  </span><span class="n">XEDIRSK</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3384"></a>  <span class="n">XEDIRSU</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3385"></a>  <span class="n">XAVWLSK</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3386"></a>
<a name="ln-3387"></a>  <span class="c">! Add contribution of this window element to glare and to</span>
<a name="ln-3388"></a>  <span class="c">! direct illuminance at reference point</span>
<a name="ln-3389"></a>
<a name="ln-3390"></a>  <span class="c">! The I,J,K indices for sky and sun components of direct illuminance</span>
<a name="ln-3391"></a>  <span class="c">! (EDIRSK, EDIRSU) and average window luminance (AVWLSK, AVWLSU) are:</span>
<a name="ln-3392"></a>  <span class="c">! I=1 for clear sky, =2 Clear turbid, =3 Intermediate, =4 Overcast;</span>
<a name="ln-3393"></a>  <span class="c">! J=1 for bare window, =2 for window with shade or fixed slat-angle blind;</span>
<a name="ln-3394"></a>  <span class="c">!  = 2,3,...,MaxSlatAngs+1 for window with variable slat-angle blind;</span>
<a name="ln-3395"></a>  <span class="c">! K = sun position index.</span>
<a name="ln-3396"></a>
<a name="ln-3397"></a>  <span class="c">! ----- CASE I -- BARE WINDOW (no shading device)</span>
<a name="ln-3398"></a>
<a name="ln-3399"></a>  <span class="c">! Beam solar and sky solar reflected from nearest obstruction.</span>
<a name="ln-3400"></a>  <span class="c">! In the following IHitIntObs == 0  ==&gt; no interior obstructions hit, and</span>
<a name="ln-3401"></a>  <span class="c">!                  IHitExtObs == 1  ==&gt; one or more exterior obstructions hit.</span>
<a name="ln-3402"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">CalcSolRefl</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">IHitIntObs</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">IHitExtObs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3403"></a>    <span class="c">! One or more exterior obstructions was hit; get contribution of reflection</span>
<a name="ln-3404"></a>    <span class="c">! from nearest obstruction.</span>
<a name="ln-3405"></a>    <span class="c">! Find obstruction whose hit point is closest to this ray&#39;s window element</span>
<a name="ln-3406"></a>    <span class="k">CALL </span><span class="n">DayltgClosestObstruction</span><span class="p">(</span><span class="n">RWIN2</span><span class="p">,</span><span class="n">Ray</span><span class="p">,</span><span class="n">NearestHitSurfNum</span><span class="p">,</span><span class="n">NearestHitPt</span><span class="p">)</span>
<a name="ln-3407"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NearestHitSurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3408"></a>
<a name="ln-3409"></a>      <span class="c">! Beam solar reflected from nearest obstruction</span>
<a name="ln-3410"></a>
<a name="ln-3411"></a>      <span class="k">CALL </span><span class="n">DayltgSurfaceLumFromSun</span><span class="p">(</span><span class="n">iHour</span><span class="p">,</span><span class="n">Ray</span><span class="p">,</span><span class="n">NearestHitSurfNum</span><span class="p">,</span><span class="n">NearestHitPt</span><span class="p">,</span><span class="n">LumAtHitPtFrSun</span><span class="p">)</span>
<a name="ln-3412"></a>      <span class="n">AVWLSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">AVWLSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">LumAtHitPtFrSun</span> <span class="o">*</span> <span class="n">TVISB</span>
<a name="ln-3413"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PHRAY</span> <span class="o">&gt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="n">EDIRSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">EDIRSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">LumAtHitPtFrSun</span> <span class="o">*</span> <span class="n">DOMEGA</span> <span class="o">*</span> <span class="n">RAY</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">TVISB</span>
<a name="ln-3414"></a>
<a name="ln-3415"></a>      <span class="c">! Sky solar reflected from nearest obstruction</span>
<a name="ln-3416"></a>
<a name="ln-3417"></a>      <span class="n">ObsConstrNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-3418"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ObsConstrNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3419"></a>        <span class="c">! Exterior building surface is nearest hit</span>
<a name="ln-3420"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Construct</span><span class="p">(</span><span class="n">ObsConstrNum</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3421"></a>          <span class="c">! Obstruction is not a window, i.e., is an opaque surface</span>
<a name="ln-3422"></a>          <span class="n">ObsVisRefl</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ObsConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">AbsorpVisible</span>
<a name="ln-3423"></a>        <span class="k">ELSE</span>
<a name="ln-3424"></a>          <span class="c">! Obstruction is a window; assume it is bare</span>
<a name="ln-3425"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">StormWinFlag</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-3426"></a>            <span class="n">ObsConstrNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">StormWinConstruction</span>
<a name="ln-3427"></a>          <span class="n">ObsVisRefl</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ObsConstrNum</span><span class="p">)%</span><span class="n">ReflectVisDiffFront</span>
<a name="ln-3428"></a>        <span class="k">END IF</span>
<a name="ln-3429"></a><span class="k">      ELSE</span>
<a name="ln-3430"></a>        <span class="c">! Shadowing surface is nearest hit</span>
<a name="ln-3431"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">Shelf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3432"></a>          <span class="c">! This is a daylighting shelf, for which reflection is separately calculated</span>
<a name="ln-3433"></a>          <span class="n">ObsVisRefl</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3434"></a>        <span class="k">ELSE</span>
<a name="ln-3435"></a><span class="k">          </span><span class="n">ObsVisRefl</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfDiffuseVisRefl</span>
<a name="ln-3436"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingConstruct</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3437"></a>            <span class="n">ObsVisRefl</span> <span class="o">=</span> <span class="n">ObsVisRefl</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingFrac</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-3438"></a>            <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingConstruct</span><span class="p">)%</span><span class="n">ReflectVisDiffFront</span>
<a name="ln-3439"></a>        <span class="k">END IF</span>
<a name="ln-3440"></a><span class="k">      END IF</span>
<a name="ln-3441"></a><span class="k">      </span><span class="n">NearestHitSurfNumX</span> <span class="o">=</span> <span class="n">NearestHitSurfNum</span>
<a name="ln-3442"></a>      <span class="c">! Each shadowing surface has a &quot;mirror&quot; duplicate surface facing in the opposite direction.</span>
<a name="ln-3443"></a>      <span class="c">! The following gets the correct side of a shadowing surface for reflection.</span>
<a name="ln-3444"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3445"></a><span class="k">        IF</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">RAY</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span>  <span class="n">NearestHitSurfNumX</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3446"></a>             <span class="n">NearestHitSurfNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3447"></a>      <span class="k">END IF</span>
<a name="ln-3448"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DetailedSkyDiffuseAlgorithm</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span>  <span class="n">ShadingTransmittanceVaries</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-3449"></a>          <span class="n">SolarDistribution</span> <span class="o">==</span> <span class="n">MinimalShadowing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3450"></a><span class="k">        </span><span class="n">SkyReflVisLum</span> <span class="o">=</span> <span class="n">ObsVisRefl</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNumX</span><span class="p">)%</span><span class="n">ViewFactorSky</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-3451"></a>                 <span class="n">DifShdgRatioIsoSky</span><span class="p">(</span><span class="n">NearestHitSurfNumX</span><span class="p">)</span> <span class="o">/</span> <span class="n">Pi</span>
<a name="ln-3452"></a>      <span class="k">ELSE</span>
<a name="ln-3453"></a><span class="k">        </span><span class="n">SkyReflVisLum</span> <span class="o">=</span> <span class="n">ObsVisRefl</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNumX</span><span class="p">)%</span><span class="n">ViewFactorSky</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-3454"></a>                 <span class="n">DifShdgRatioIsoSkyHRTS</span><span class="p">(</span><span class="n">NearestHitSurfNumX</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">Pi</span>
<a name="ln-3455"></a>      <span class="n">ENDIF</span>
<a name="ln-3456"></a>      <span class="k">DO </span><span class="n">ISky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-3457"></a>        <span class="n">XAVWLSK</span><span class="p">(</span><span class="n">ISky</span><span class="p">)</span> <span class="o">=</span> <span class="n">GILSK</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">*</span> <span class="n">SkyReflVisLum</span>
<a name="ln-3458"></a>        <span class="n">AVWLSK</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">AVWLSK</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">XAVWLSK</span><span class="p">(</span><span class="n">ISky</span><span class="p">)</span> <span class="o">*</span> <span class="n">TVISB</span>
<a name="ln-3459"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PHRAY</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3460"></a><span class="k">          </span><span class="n">XEDIRSK</span><span class="p">(</span><span class="n">ISky</span><span class="p">)</span> <span class="o">=</span> <span class="n">GILSK</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">*</span> <span class="n">SkyReflVisLum</span> <span class="o">*</span> <span class="n">DOMEGA</span> <span class="o">*</span> <span class="n">RAY</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3461"></a>          <span class="n">EDIRSK</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">EDIRSK</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">XEDIRSK</span><span class="p">(</span><span class="n">ISky</span><span class="p">)</span> <span class="o">*</span> <span class="n">TVISB</span>
<a name="ln-3462"></a>        <span class="k">END IF</span>
<a name="ln-3463"></a><span class="k">      END DO</span>
<a name="ln-3464"></a><span class="k">    END IF</span>
<a name="ln-3465"></a><span class="k">  END IF</span>  <span class="c">! End of check if solar reflection calculation is in effect</span>
<a name="ln-3466"></a>
<a name="ln-3467"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ObTrans</span> <span class="o">&gt;</span> <span class="mf">1.d-6</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3468"></a>    <span class="c">! Ray did not hit an obstruction or the transmittance product of hit obstructions is non-zero.</span>
<a name="ln-3469"></a>    <span class="c">! Contribution of sky or ground luminance in cd/m2</span>
<a name="ln-3470"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3471"></a>      <span class="c">! Make all transmitted light diffuse for a TDD with a bare diffuser</span>
<a name="ln-3472"></a>      <span class="k">DO </span><span class="n">ISKY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-3473"></a>        <span class="n">AVWLSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">AVWLSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">WLUMSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-3474"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3475"></a><span class="k">          </span><span class="n">AVWLSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">AVWLSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">WLUMSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-3476"></a>          <span class="n">AVWLSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">AVWLSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">WLUMSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-3477"></a>        <span class="k">END IF</span>
<a name="ln-3478"></a><span class="k">        IF</span><span class="p">(</span><span class="n">PHRAY</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3479"></a><span class="k">          </span><span class="n">EDIRSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">EDIRSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">WLUMSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">*</span> <span class="n">DOMEGA</span> <span class="o">*</span> <span class="n">RAY</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3480"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">EDIRSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">EDIRSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">WLUMSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">*</span> <span class="n">DOMEGA</span> <span class="o">*</span> <span class="n">RAY</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3481"></a>        <span class="k">END IF</span>
<a name="ln-3482"></a><span class="k">      END DO</span>
<a name="ln-3483"></a>
<a name="ln-3484"></a><span class="k">    ELSE</span> <span class="c">! Bare window</span>
<a name="ln-3485"></a>
<a name="ln-3486"></a>      <span class="k">DO </span><span class="n">ISKY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-3487"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PHRAY</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3488"></a>          <span class="c">! Ray heads upward to sky</span>
<a name="ln-3489"></a>          <span class="n">ELUM</span> <span class="o">=</span> <span class="n">DayltgSkyLuminance</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="n">THRAY</span><span class="p">,</span><span class="n">PHRAY</span><span class="p">)</span>
<a name="ln-3490"></a>          <span class="n">XEDIRSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">=</span> <span class="n">ELUM</span> <span class="o">*</span> <span class="n">DOMEGA</span> <span class="o">*</span> <span class="n">RAY</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3491"></a>          <span class="n">DEDIR</span>  <span class="o">=</span> <span class="n">XEDIRSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">*</span> <span class="n">TVISB</span>
<a name="ln-3492"></a>          <span class="n">EDIRSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">EDIRSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">DEDIR</span> <span class="o">*</span> <span class="n">ObTrans</span>
<a name="ln-3493"></a>          <span class="n">AVWLSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">AVWLSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">ELUM</span> <span class="o">*</span> <span class="n">TVISB</span> <span class="o">*</span> <span class="n">ObTrans</span>
<a name="ln-3494"></a>          <span class="n">XAVWLSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">=</span> <span class="n">ELUM</span> <span class="o">*</span> <span class="n">ObTrans</span>
<a name="ln-3495"></a>        <span class="k">ELSE</span> <span class="c">! PHRAY &lt;= 0.</span>
<a name="ln-3496"></a>          <span class="c">! Ray heads downward to ground.</span>
<a name="ln-3497"></a>          <span class="c">! Contribution from sky diffuse reflected from ground</span>
<a name="ln-3498"></a>          <span class="n">XAVWLSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">=</span> <span class="n">GILSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">GndReflectanceForDayltg</span> <span class="o">/</span> <span class="n">PI</span><span class="p">)</span> <span class="o">*</span> <span class="n">ObTrans</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-3499"></a>                                    <span class="n">SkyObstructionMult</span>
<a name="ln-3500"></a>          <span class="n">AVWLSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">AVWLSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">TVISB</span> <span class="o">*</span> <span class="n">XAVWLSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span>
<a name="ln-3501"></a>          <span class="c">! Contribution from beam solar reflected from ground (beam reaching ground point</span>
<a name="ln-3502"></a>          <span class="c">! can be obstructed [SunObstructionMult &lt; 1.0] if CalcSolRefl = .TRUE.)</span>
<a name="ln-3503"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3504"></a><span class="k">            </span><span class="n">SunObstructionMult</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-3505"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">CalcSolRefl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3506"></a>              <span class="c">! Coordinates of ground point hit by the ray</span>
<a name="ln-3507"></a>              <span class="n">Alfa</span> <span class="o">=</span> <span class="nb">ACOS</span><span class="p">(</span><span class="o">-</span><span class="n">RAY</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-3508"></a>              <span class="n">Beta</span> <span class="o">=</span> <span class="n">ATAN2</span><span class="p">(</span><span class="n">RAY</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">RAY</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3509"></a>              <span class="n">HorDis</span> <span class="o">=</span> <span class="p">(</span><span class="n">RWIN2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">GroundLevelZ</span><span class="p">)</span><span class="o">*</span><span class="nb">TAN</span><span class="p">(</span><span class="n">Alfa</span><span class="p">)</span>
<a name="ln-3510"></a>              <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">GroundLevelZ</span>
<a name="ln-3511"></a>              <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">RWIN2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">HorDis</span><span class="o">*</span><span class="nb">COS</span><span class="p">(</span><span class="n">Beta</span><span class="p">)</span>
<a name="ln-3512"></a>              <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">RWIN2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">HorDis</span><span class="o">*</span><span class="nb">SIN</span><span class="p">(</span><span class="n">Beta</span><span class="p">)</span>
<a name="ln-3513"></a>              <span class="c">! Sun reaches ground point if vector from this point to the sun is unobstructed</span>
<a name="ln-3514"></a>              <span class="n">IHitObs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3515"></a>              <span class="k">DO </span><span class="n">ObsSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-3516"></a>                 <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfPossibleObstruction</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3517"></a><span class="k">                 CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">,</span><span class="n">GroundHitPt</span><span class="p">,</span><span class="n">SunCosHr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">iHour</span><span class="p">),</span><span class="n">IHitObs</span><span class="p">,</span><span class="n">ObsHitPt</span><span class="p">)</span>
<a name="ln-3518"></a>                 <span class="k">IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-3519"></a><span class="k">              END DO</span>
<a name="ln-3520"></a><span class="k">              IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SunObstructionMult</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3521"></a>            <span class="k">END IF</span>
<a name="ln-3522"></a><span class="k">            </span><span class="n">AVWLSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">AVWLSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-3523"></a>                 <span class="n">TVISB</span> <span class="o">*</span> <span class="n">GILSU</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">GndReflectanceForDayltg</span> <span class="o">/</span> <span class="n">PI</span><span class="p">)</span> <span class="o">*</span> <span class="n">ObTrans</span> <span class="o">*</span> <span class="n">SunObstructionMult</span>
<a name="ln-3524"></a>          <span class="k">END IF</span>  <span class="c">! End of check if ISky = 1</span>
<a name="ln-3525"></a>        <span class="k">END IF</span>  <span class="c">! End of check if ray is going up or down</span>
<a name="ln-3526"></a>      <span class="k">END DO</span>  <span class="c">! End of loop over sky types</span>
<a name="ln-3527"></a>    <span class="k">END IF</span> <span class="c">! End of check if bare window or TDD:DIFFUSER</span>
<a name="ln-3528"></a>  <span class="k">END IF</span> <span class="c">! End of check if ObTrans &gt; 1.E-6</span>
<a name="ln-3529"></a>
<a name="ln-3530"></a>  <span class="c">!</span>
<a name="ln-3531"></a>  <span class="c">! Illuminance from beam solar (without interior reflection)</span>
<a name="ln-3532"></a>  <span class="c">!</span>
<a name="ln-3533"></a>  <span class="c">! Just run this once on the last pass</span>
<a name="ln-3534"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">iXelement</span> <span class="o">==</span> <span class="n">NWX</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">iYelement</span> <span class="o">==</span> <span class="n">NWY</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Last pass</span>
<a name="ln-3535"></a>
<a name="ln-3536"></a>    <span class="c">! Beam solar reaching reference point directly without exterior reflection</span>
<a name="ln-3537"></a>
<a name="ln-3538"></a>    <span class="c">! Unit vector from ref. pt. to sun</span>
<a name="ln-3539"></a>    <span class="n">RAYCOS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPHSUN</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">THSUN</span><span class="p">)</span>
<a name="ln-3540"></a>    <span class="n">RAYCOS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPHSUN</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">THSUN</span><span class="p">)</span>
<a name="ln-3541"></a>    <span class="n">RAYCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">SPHSUN</span>
<a name="ln-3542"></a>
<a name="ln-3543"></a>    <span class="c">! Is sun on front side of exterior window?</span>
<a name="ln-3544"></a>    <span class="n">COSI</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">WNORM2</span><span class="p">,</span><span class="n">RAYCOS</span><span class="p">)</span>
<a name="ln-3545"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">COSI</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3546"></a>
<a name="ln-3547"></a>      <span class="c">! Does RAYCOS pass thru exterior window? HP is point that RAYCOS intersects window plane.</span>
<a name="ln-3548"></a>      <span class="k">CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">,</span><span class="n">RREF2</span><span class="p">,</span><span class="n">RAYCOS</span><span class="p">,</span><span class="n">IP</span><span class="p">,</span><span class="n">HP</span><span class="p">)</span>
<a name="ln-3549"></a>      <span class="n">IHitIntObsDisk</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3550"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IP</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3551"></a><span class="k">        IF</span><span class="p">(</span><span class="n">ExtWinType</span> <span class="o">==</span> <span class="n">InZoneExtWin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3552"></a>          <span class="c">! Check for interior obstructions between reference point and HP.</span>
<a name="ln-3553"></a>          <span class="k">CALL </span><span class="n">DayltgHitInteriorObstruction</span><span class="p">(</span><span class="n">IWin2</span><span class="p">,</span><span class="n">RREF2</span><span class="p">,</span><span class="n">HP</span><span class="p">,</span><span class="n">IHitIntObsDisk</span><span class="p">)</span>
<a name="ln-3554"></a>        <span class="k">END IF</span>
<a name="ln-3555"></a><span class="k">        </span><span class="n">ObTransDisk</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Init value</span>
<a name="ln-3556"></a>        <span class="c">! Init flag for vector from RP to sun passing through interior window</span>
<a name="ln-3557"></a>        <span class="n">IHitIntWinDisk</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3558"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ExtWinType</span> <span class="o">==</span> <span class="n">AdjZoneExtWin</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! This block is for RPs in zones with interior windows</span>
<a name="ln-3559"></a>                                             <span class="c">! adjacent to zones with exterior windows</span>
<a name="ln-3560"></a>          <span class="c">! Does RAYCOS pass through interior window in zone containing RP?</span>
<a name="ln-3561"></a>          <span class="k">DO </span><span class="n">IntWinDisk</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-3562"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IntWinDisk</span><span class="p">)%</span><span class="k">Class</span><span class="o">==</span><span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IntWinDisk</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3563"></a><span class="k">              IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IntWinDisk</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3564"></a><span class="k">                CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">IntWinDisk</span><span class="p">,</span><span class="n">RREF</span><span class="p">,</span><span class="n">RAYCOS</span><span class="p">,</span><span class="n">IHitIntWinDisk</span><span class="p">,</span><span class="n">HitPtIntWinDisk</span><span class="p">)</span>
<a name="ln-3565"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">IHitIntWinDisk</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3566"></a><span class="k">                  </span><span class="n">IntWinDiskHitNum</span> <span class="o">=</span> <span class="n">IntWinDisk</span>
<a name="ln-3567"></a>                  <span class="n">COSBIntWin</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IntWinDisk</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span><span class="n">RAYCOS</span><span class="p">)</span>
<a name="ln-3568"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">COSBIntWin</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3569"></a><span class="k">                    </span><span class="n">IHitIntWinDisk</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3570"></a>                    <span class="n">IntWinDiskHitNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3571"></a>                    <span class="k">CYCLE</span>
<a name="ln-3572"></a><span class="k">                  END IF</span>
<a name="ln-3573"></a><span class="k">                  </span><span class="n">TVISIntWinDisk</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">COSBIntWin</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IntWinDisk</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3574"></a>                  <span class="k">EXIT</span>
<a name="ln-3575"></a><span class="k">                END IF</span>
<a name="ln-3576"></a><span class="k">              END IF</span>
<a name="ln-3577"></a><span class="k">            END IF</span>
<a name="ln-3578"></a><span class="k">          END DO</span>
<a name="ln-3579"></a>
<a name="ln-3580"></a><span class="k">          IF</span><span class="p">(</span><span class="n">IHitIntWinDisk</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Vector from RP to sun does not pass through interior window</span>
<a name="ln-3581"></a>            <span class="n">ObTransDisk</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3582"></a>            <span class="n">IHIT</span> <span class="o">=</span> <span class="mi">1</span>             <span class="c">!!fcw Is this needed?</span>
<a name="ln-3583"></a>          <span class="k">END IF</span>
<a name="ln-3584"></a>
<a name="ln-3585"></a>          <span class="c">! Check for interior obstructions between ref point and interior window</span>
<a name="ln-3586"></a>          <span class="n">IHitIntObsDisk</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3587"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">IHitIntWinDisk</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3588"></a><span class="k">            CALL </span><span class="n">DayltgHitInteriorObstruction</span><span class="p">(</span><span class="n">IntWinDiskHitNum</span><span class="p">,</span><span class="n">RREF</span><span class="p">,</span><span class="n">HitPtIntWinDisk</span><span class="p">,</span><span class="n">IHitIntObsDisk</span><span class="p">)</span>
<a name="ln-3589"></a>            <span class="c">! If no obstruction between RP and hit int win, check for obstruction</span>
<a name="ln-3590"></a>            <span class="c">! between int win and ext win</span>
<a name="ln-3591"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">IHitIntObsDisk</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3592"></a><span class="k">              CALL </span><span class="n">DayltgHitBetWinObstruction</span><span class="p">(</span><span class="n">IntWinDiskHitNum</span><span class="p">,</span><span class="n">IWin2</span><span class="p">,</span><span class="n">HitPtIntWinDisk</span><span class="p">,</span><span class="n">HP</span><span class="p">,</span><span class="n">IHitIntObsDisk</span><span class="p">)</span>
<a name="ln-3593"></a>            <span class="n">ENDIF</span>
<a name="ln-3594"></a>          <span class="k">END IF</span>
<a name="ln-3595"></a><span class="k">          IF</span><span class="p">(</span><span class="n">IHitIntObsDisk</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">ObTransDisk</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3596"></a>        <span class="k">END IF</span>  <span class="c">! case where RP is in zone with interior window adjacent to zone with exterior window</span>
<a name="ln-3597"></a>
<a name="ln-3598"></a>        <span class="n">IHitExtObsDisk</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3599"></a>        <span class="c">! RJH 08-25-07 IHitIntWinDisk should not be reset to 0 here, and should be tested below.</span>
<a name="ln-3600"></a>        <span class="c">! This is to correct logic flaw causing direct solar to reach adjacent zone refpt</span>
<a name="ln-3601"></a>        <span class="c">! when vector to sun does not pass through interior window</span>
<a name="ln-3602"></a>        <span class="c">! IHitIntWinDisk = 0</span>
<a name="ln-3603"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">IHitIntObsDisk</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! No interior obstruction was hit</span>
<a name="ln-3604"></a>          <span class="c">! Net transmittance of exterior obstructions encountered by RAYCOS</span>
<a name="ln-3605"></a>          <span class="c">! ObTransDisk = 1.0 will be returned if no exterior obstructions are hit.</span>
<a name="ln-3606"></a>          <span class="k">CALL </span><span class="n">DayltgHitObstruction</span><span class="p">(</span><span class="n">iHour</span><span class="p">,</span><span class="n">IWin2</span><span class="p">,</span><span class="n">RREF2</span><span class="p">,</span><span class="n">RAYCOS</span><span class="p">,</span><span class="n">ObTransDisk</span><span class="p">)</span>
<a name="ln-3607"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ObTransDisk</span> <span class="o">&lt;</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="n">IHitExtObsDisk</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-3608"></a>          <span class="c">! RJH 08-26-07 However, if this is a case of interior window</span>
<a name="ln-3609"></a>          <span class="c">! and vector to sun does not pass through interior window</span>
<a name="ln-3610"></a>          <span class="c">! then reset ObTransDisk to 0.0 since it is the key test for adding</span>
<a name="ln-3611"></a>          <span class="c">! contribution of sun to RP below.</span>
<a name="ln-3612"></a>          <span class="k">IF</span><span class="p">((</span><span class="n">ExtWinType</span> <span class="o">==</span> <span class="n">AdjZoneExtWin</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">IHitIntWinDisk</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3613"></a><span class="k">            </span><span class="n">ObTransDisk</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3614"></a>          <span class="k">END IF</span>
<a name="ln-3615"></a><span class="k">        END IF</span>
<a name="ln-3616"></a>
<a name="ln-3617"></a>        <span class="c">! PETER: need side wall mounted TDD to test this</span>
<a name="ln-3618"></a>        <span class="c">! PETER: probably need to replace RREF2 with RWIN2</span>
<a name="ln-3619"></a>        <span class="c">! PETER: need to check for interior obstructions too.</span>
<a name="ln-3620"></a>
<a name="ln-3621"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ObTransDisk</span> <span class="o">&gt;</span> <span class="mf">1.d-6</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3622"></a>
<a name="ln-3623"></a>          <span class="c">! Sun reaches reference point;  increment illuminance.</span>
<a name="ln-3624"></a>          <span class="c">! Direct normal illuminance is normalized to 1.0</span>
<a name="ln-3625"></a>
<a name="ln-3626"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3627"></a>            <span class="c">! No beam is transmitted.  Takes care of TDD with a bare diffuser and all types of blinds.</span>
<a name="ln-3628"></a>            <span class="n">TVISS</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3629"></a>          <span class="k">ELSE</span>
<a name="ln-3630"></a>            <span class="c">! Beam transmittance for bare window and all types of blinds</span>
<a name="ln-3631"></a>            <span class="n">TVISS</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">COSI</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3632"></a>                       <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-3633"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ExtWinType</span><span class="o">==</span><span class="n">AdjZoneExtWin</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">IHitIntWinDisk</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-3634"></a>              <span class="n">TVISS</span> <span class="o">=</span> <span class="n">TVISS</span> <span class="o">*</span> <span class="n">TVISIntWinDisk</span>
<a name="ln-3635"></a>          <span class="k">END IF</span>
<a name="ln-3636"></a>
<a name="ln-3637"></a><span class="k">          </span><span class="n">EDIRSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">RAYCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">TVISS</span> <span class="o">*</span> <span class="n">ObTransDisk</span>  <span class="c">! Bare window</span>
<a name="ln-3638"></a>
<a name="ln-3639"></a>          <span class="n">TransBmBmMult</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3640"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorBlind</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_InteriorBlind</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-3641"></a>              <span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_BetweenGlassBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3642"></a><span class="k">            CALL </span><span class="n">ProfileAngle</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span><span class="n">RAYCOS</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatOrientation</span><span class="p">,</span><span class="n">ProfAng</span><span class="p">)</span>
<a name="ln-3643"></a>            <span class="c">! Contribution of beam passing through slats and reaching reference point</span>
<a name="ln-3644"></a>            <span class="k">DO </span><span class="n">JB</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">MaxSlatAngs</span>
<a name="ln-3645"></a>              <span class="c">!IF (.NOT.SurfaceWindow(IWin)%MovableSlats .AND. JB &gt; 1) EXIT</span>
<a name="ln-3646"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3647"></a><span class="k">                </span><span class="n">SlatAng</span> <span class="o">=</span> <span class="p">(</span><span class="n">JB</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">/</span> <span class="p">(</span><span class="n">MaxSlatAngs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-3648"></a>              <span class="k">ELSE</span>
<a name="ln-3649"></a><span class="k">                </span><span class="n">SlatAng</span> <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatAngle</span> <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-3650"></a>              <span class="k">END IF</span>
<a name="ln-3651"></a><span class="k">              </span><span class="n">TransBmBmMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">=</span> <span class="n">BlindBeamBeamTrans</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3652"></a>                                   <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatThickness</span><span class="p">)</span>
<a name="ln-3653"></a>              <span class="n">EDIRSUdisk</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">RAYCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">TVISS</span> <span class="o">*</span> <span class="n">TransBmBmMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">*</span> <span class="n">ObTransDisk</span>
<a name="ln-3654"></a>
<a name="ln-3655"></a>              <span class="c">! do this only once for fixed slat blinds</span>
<a name="ln-3656"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-3657"></a><span class="k">            END DO</span>
<a name="ln-3658"></a><span class="k">          ELSE IF</span><span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorScreen</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3659"></a><span class="c">!                          pass angle from sun to window normal here using PHSUN and THSUN from above and surface angles</span>
<a name="ln-3660"></a><span class="c">!                          SunAltitudeToWindowNormalAngle = PHSUN - SurfaceWindow(IWin)%Phi</span>
<a name="ln-3661"></a><span class="c">!                          SunAzimuthToWindowNormalAngle = THSUN - SurfaceWindow(IWin)%Theta</span>
<a name="ln-3662"></a>            <span class="k">CALL </span><span class="n">CalcScreenTransmittance</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span> <span class="n">Phi</span><span class="o">=</span><span class="p">(</span><span class="n">PHSUN</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Phi</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3663"></a>                                             <span class="n">Theta</span><span class="o">=</span><span class="p">(</span><span class="n">THSUN</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Theta</span><span class="p">))</span>
<a name="ln-3664"></a>            <span class="n">TransBmBmMult</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ScreenNumber</span><span class="p">)%</span><span class="n">BmBmTrans</span>
<a name="ln-3665"></a>            <span class="n">EDIRSUdisk</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">RAYCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">TVISS</span> <span class="o">*</span> <span class="n">TransBmBmMult</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ObTransDisk</span>
<a name="ln-3666"></a>          <span class="k">END IF</span>
<a name="ln-3667"></a>
<a name="ln-3668"></a>          <span class="c">! Glare from solar disk</span>
<a name="ln-3669"></a>
<a name="ln-3670"></a>          <span class="c">! Position factor for sun (note that AZVIEW is wrt y-axis and THSUN is wrt</span>
<a name="ln-3671"></a>          <span class="c">! x-axis of absolute coordinate system.</span>
<a name="ln-3672"></a>          <span class="n">XR</span> <span class="o">=</span> <span class="nb">TAN</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">PIOVR2</span> <span class="o">-</span> <span class="n">AZVIEW</span> <span class="o">-</span> <span class="n">THSUN</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.001d0</span><span class="p">)</span>
<a name="ln-3673"></a>          <span class="n">YR</span> <span class="o">=</span> <span class="nb">TAN</span><span class="p">(</span><span class="n">PHSUN</span> <span class="o">+</span> <span class="mf">0.001d0</span><span class="p">)</span>
<a name="ln-3674"></a>          <span class="n">POSFAC</span> <span class="o">=</span> <span class="n">DayltgGlarePositionFactor</span><span class="p">(</span><span class="n">XR</span><span class="p">,</span><span class="n">YR</span><span class="p">)</span>
<a name="ln-3675"></a>
<a name="ln-3676"></a>          <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">CalledFrom</span><span class="p">)</span>
<a name="ln-3677"></a>
<a name="ln-3678"></a>          <span class="k">CASE</span> <span class="p">(</span> <span class="n">CalledForRefPoint</span> <span class="p">)</span>
<a name="ln-3679"></a>            <span class="n">WindowSolidAngleDaylightPoint</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)</span>
<a name="ln-3680"></a>          <span class="k">CASE</span> <span class="p">(</span> <span class="n">CalledForMapPoint</span> <span class="p">)</span>
<a name="ln-3681"></a>            <span class="n">WindowSolidAngleDaylightPoint</span> <span class="o">=</span> <span class="n">MapWindowSolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">)</span>
<a name="ln-3682"></a>          <span class="k">END SELECT</span>
<a name="ln-3683"></a>
<a name="ln-3684"></a>
<a name="ln-3685"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">POSFAC</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WindowSolidAngleDaylightPoint</span> <span class="o">&gt;</span> <span class="mf">0.000001d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3686"></a>            <span class="c">! Increment window luminance.  Luminance of solar disk (cd/m2)</span>
<a name="ln-3687"></a>            <span class="c">! is 1.47*10^4*(direct normal solar illuminance) for direct normal solar</span>
<a name="ln-3688"></a>            <span class="c">! illuminance in lux (lumens/m2). For purposes of calculating daylight factors</span>
<a name="ln-3689"></a>            <span class="c">! direct normal solar illuminance = 1.0.</span>
<a name="ln-3690"></a>            <span class="c">! Solid angle subtended by sun is 0.000068 steradians</span>
<a name="ln-3691"></a>
<a name="ln-3692"></a>            <span class="n">XAVWL</span> <span class="o">=</span> <span class="mi">1470</span><span class="mf">0.d0</span> <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="mf">0.000068d0</span> <span class="o">*</span> <span class="n">POSFAC</span><span class="p">)</span> <span class="o">*</span>  <span class="kt">REAL</span><span class="p">(</span><span class="n">NWX</span> <span class="o">*</span> <span class="n">NWY</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-3693"></a>                     <span class="n">WindowSolidAngleDaylightPoint</span><span class="o">**</span><span class="mf">0.8d0</span>
<a name="ln-3694"></a>            <span class="n">AVWLSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">XAVWL</span> <span class="o">*</span> <span class="n">TVISS</span> <span class="o">*</span> <span class="n">ObTransDisk</span>  <span class="c">! Bare window</span>
<a name="ln-3695"></a>
<a name="ln-3696"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorBlind</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_InteriorBlind</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-3697"></a>                <span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_BetweenGlassBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3698"></a><span class="k">              DO </span><span class="n">JB</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">MaxSlatAngs</span>
<a name="ln-3699"></a>                <span class="c">!IF (.NOT. SurfaceWindow(IWin)%MovableSlats .AND. JB &gt; 1) EXIT</span>
<a name="ln-3700"></a>                <span class="n">AVWLSUdisk</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">XAVWL</span> <span class="o">*</span> <span class="n">TVISS</span> <span class="o">*</span> <span class="n">TransBmBmMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">*</span> <span class="n">ObTransDisk</span>
<a name="ln-3701"></a>                <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-3702"></a><span class="k">              END DO</span>
<a name="ln-3703"></a><span class="k">            ELSE IF</span><span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorScreen</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3704"></a><span class="k">              </span><span class="n">AVWLSUdisk</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">XAVWL</span> <span class="o">*</span> <span class="n">TVISS</span> <span class="o">*</span> <span class="n">TransBmBmMult</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ObTransDisk</span>
<a name="ln-3705"></a>            <span class="k">END IF</span>
<a name="ln-3706"></a><span class="k">          </span><span class="n">ENDIF</span> <span class="c">! Position Factor</span>
<a name="ln-3707"></a>        <span class="k">END IF</span> <span class="c">! Beam avoids all obstructions</span>
<a name="ln-3708"></a>      <span class="k">END IF</span> <span class="c">! Beam passes thru window</span>
<a name="ln-3709"></a>    <span class="k">END IF</span> <span class="c">! Sun on front side</span>
<a name="ln-3710"></a>
<a name="ln-3711"></a>    <span class="c">! Beam solar reaching reference point after beam-beam (specular) reflection from</span>
<a name="ln-3712"></a>    <span class="c">! an exterior surface</span>
<a name="ln-3713"></a>
<a name="ln-3714"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CalcSolRefl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3715"></a>      <span class="c">! Receiving surface number corresponding this window</span>
<a name="ln-3716"></a>      <span class="n">RecSurfNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">ShadowSurfRecSurfNum</span>
<a name="ln-3717"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">RecSurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>    <span class="c">! interior windows do not apply</span>
<a name="ln-3718"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumPossibleObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3719"></a>          <span class="c">! This window has associated obstructions that could reflect beam onto the window</span>
<a name="ln-3720"></a>          <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumPossibleObs</span>
<a name="ln-3721"></a>            <span class="n">ReflSurfNum</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">PossibleObsSurfNums</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-3722"></a>            <span class="n">ReflSurfNumX</span> <span class="o">=</span> <span class="n">ReflSurfNum</span>
<a name="ln-3723"></a>            <span class="c">! Each shadowing surface has a &quot;mirror&quot; duplicate surface facing in the opposite direction.</span>
<a name="ln-3724"></a>            <span class="c">! The following gets the correct side of a shadowing surface for reflection.</span>
<a name="ln-3725"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3726"></a><span class="k">              IF</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">RAYCOS</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.d0</span><span class="p">)</span>  <span class="n">ReflSurfNumX</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3727"></a>              <span class="n">ReflSurfNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3728"></a>            <span class="k">END IF</span>
<a name="ln-3729"></a>            <span class="c">! Require that the surface can have specular reflection</span>
<a name="ln-3730"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3731"></a>               <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingFrac</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3732"></a><span class="k">              </span><span class="n">ReflNorm</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNumX</span><span class="p">)%</span><span class="n">OutNormVec</span>
<a name="ln-3733"></a>              <span class="c">! Vector to sun that is mirrored in obstruction</span>
<a name="ln-3734"></a>              <span class="n">SunVecMir</span> <span class="o">=</span> <span class="n">RAYCOS</span> <span class="o">-</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">RAYCOS</span><span class="p">,</span><span class="n">ReflNorm</span><span class="p">)</span><span class="o">*</span><span class="n">ReflNorm</span>
<a name="ln-3735"></a>              <span class="c">! Skip if reflecting surface is not sunlit</span>
<a name="ln-3736"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">SunlitFrac</span><span class="p">(</span><span class="n">ReflSurfNumX</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3737"></a>              <span class="c">! Skip if altitude angle of mirrored sun is negative since reflected sun cannot</span>
<a name="ln-3738"></a>              <span class="c">! reach reference point in this case</span>
<a name="ln-3739"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">SunVecMir</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3740"></a>              <span class="c">! Cosine of incidence angle of reflected beam on window</span>
<a name="ln-3741"></a>              <span class="n">CosIncAngRec</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">,</span><span class="n">SunVecMir</span><span class="p">)</span>
<a name="ln-3742"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">CosIncAngRec</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3743"></a>              <span class="c">! Does ray from ref. pt. along SunVecMir pass through window?</span>
<a name="ln-3744"></a>              <span class="k">CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">,</span><span class="n">RREF2</span><span class="p">,</span><span class="n">SunVecMir</span><span class="p">,</span><span class="n">IP</span><span class="p">,</span><span class="n">HP</span><span class="p">)</span>
<a name="ln-3745"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">IP</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! Ray did not pass through window</span>
<a name="ln-3746"></a>              <span class="c">! Check if this ray hits interior obstructions</span>
<a name="ln-3747"></a>              <span class="k">CALL </span><span class="n">DayltgHitInteriorObstruction</span><span class="p">(</span><span class="n">IWin2</span><span class="p">,</span><span class="n">RREF2</span><span class="p">,</span><span class="n">HP</span><span class="p">,</span><span class="n">IHit</span><span class="p">)</span>
<a name="ln-3748"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">IHit</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span> <span class="c">! Interior obstruction was hit</span>
<a name="ln-3749"></a>              <span class="c">! Does ray hit this reflecting surface?</span>
<a name="ln-3750"></a>              <span class="k">CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">,</span><span class="n">RREF2</span><span class="p">,</span><span class="n">SunVecMir</span><span class="p">,</span><span class="n">IHitRefl</span><span class="p">,</span><span class="n">HitPtRefl</span><span class="p">)</span>
<a name="ln-3751"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">IHitRefl</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! Ray did not hit this reflecting surface</span>
<a name="ln-3752"></a>              <span class="n">ReflDistance</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">HitPtRefl</span><span class="o">-</span><span class="n">RREF2</span><span class="p">,</span><span class="n">HitPtRefl</span><span class="o">-</span><span class="n">RREF2</span><span class="p">))</span>
<a name="ln-3753"></a>              <span class="c">! Is ray from ref. pt. to reflection point (HitPtRefl) obstructed?</span>
<a name="ln-3754"></a>              <span class="n">IHitObsRefl</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3755"></a>              <span class="k">DO </span><span class="n">loop2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumPossibleObs</span>
<a name="ln-3756"></a>                <span class="n">ObsSurfNum</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">PossibleObsSurfNums</span><span class="p">(</span><span class="n">loop2</span><span class="p">)</span>
<a name="ln-3757"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ObsSurfNum</span> <span class="o">==</span> <span class="n">ReflSurfNum</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ObsSurfNum</span> <span class="o">==</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3758"></a><span class="k">                CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">,</span><span class="n">RREF2</span><span class="p">,</span><span class="n">SunVecMir</span><span class="p">,</span><span class="n">IHitObs</span><span class="p">,</span><span class="n">HitPtObs</span><span class="p">)</span>
<a name="ln-3759"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3760"></a><span class="k">                  </span><span class="n">ObsDistance</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">HitPtObs</span><span class="o">-</span><span class="n">RREF2</span><span class="p">,</span><span class="n">HitPtObs</span><span class="o">-</span><span class="n">RREF2</span><span class="p">))</span>
<a name="ln-3761"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">ObsDistance</span> <span class="o">&lt;</span> <span class="n">ReflDistance</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3762"></a><span class="k">                    </span><span class="n">IHitObsRefl</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-3763"></a>                    <span class="k">EXIT</span>
<a name="ln-3764"></a><span class="k">                  END IF</span>
<a name="ln-3765"></a><span class="k">                END IF</span>
<a name="ln-3766"></a><span class="k">              END DO</span>
<a name="ln-3767"></a><span class="k">              IF</span><span class="p">(</span><span class="n">IHitObsRefl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! Obstruct&#39;n closer than reflect&#39;n pt. was hit; go to next obstruction</span>
<a name="ln-3768"></a>              <span class="c">! There is no obstruction for this ray between ref pt and hit pt on reflecting surface.</span>
<a name="ln-3769"></a>              <span class="c">! See if ray from hit pt on reflecting surface to original (unmirrored) sun position is obstructed</span>
<a name="ln-3770"></a>              <span class="n">IHitObs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3771"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3772"></a>                <span class="c">! Reflecting surface is a window.</span>
<a name="ln-3773"></a>                <span class="c">! Receiving surface number for this reflecting window.</span>
<a name="ln-3774"></a>                <span class="n">ReflSurfRecNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfRecSurfNum</span>
<a name="ln-3775"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ReflSurfRecNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3776"></a>                  <span class="c">! Loop over possible obstructions for this reflecting window</span>
<a name="ln-3777"></a>                  <span class="k">DO </span><span class="n">loop2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">ReflSurfRecNum</span><span class="p">)%</span><span class="n">NumPossibleObs</span>
<a name="ln-3778"></a>                    <span class="n">ObsSurfNum</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">ReflSurfRecNum</span><span class="p">)%</span><span class="n">PossibleObsSurfNums</span><span class="p">(</span><span class="n">loop2</span><span class="p">)</span>
<a name="ln-3779"></a>                    <span class="k">CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">,</span><span class="n">HitPtRefl</span><span class="p">,</span><span class="n">RAYCOS</span><span class="p">,</span><span class="n">IHitObs</span><span class="p">,</span><span class="n">HitPtObs</span><span class="p">)</span>
<a name="ln-3780"></a>                    <span class="k">IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-3781"></a><span class="k">                  END DO</span>
<a name="ln-3782"></a><span class="k">                END IF</span>
<a name="ln-3783"></a><span class="k">              ELSE</span>
<a name="ln-3784"></a>                <span class="c">! Reflecting surface is a building shade</span>
<a name="ln-3785"></a>                <span class="k">DO </span><span class="n">ObsSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-3786"></a>                  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfPossibleObstruction</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3787"></a><span class="k">                  IF</span><span class="p">(</span><span class="n">ObsSurfNum</span> <span class="o">==</span> <span class="n">ReflSurfNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3788"></a><span class="k">                  CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">,</span><span class="n">HitPtRefl</span><span class="p">,</span><span class="n">RAYCOS</span><span class="p">,</span><span class="n">IHitObs</span><span class="p">,</span><span class="n">HitPtObs</span><span class="p">)</span>
<a name="ln-3789"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-3790"></a><span class="k">                END DO</span>
<a name="ln-3791"></a><span class="k">              END IF</span>  <span class="c">! End of check if reflector is a window or shadowing surface</span>
<a name="ln-3792"></a>
<a name="ln-3793"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span> <span class="c">! Obstruct&#39;n hit between reflect&#39;n hit point and sun; go to next obstruction</span>
<a name="ln-3794"></a>
<a name="ln-3795"></a>              <span class="c">! No obstructions. Calculate reflected beam illuminance at ref. pt. from this reflecting surface.</span>
<a name="ln-3796"></a>              <span class="n">SpecReflectance</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3797"></a>              <span class="n">CosIncAngRefl</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">RAYCOS</span><span class="p">,</span><span class="n">ReflNorm</span><span class="p">))</span>
<a name="ln-3798"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3799"></a><span class="k">                </span><span class="n">ConstrNumRefl</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-3800"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">StormWinFlag</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3801"></a>                  <span class="n">ConstrNumRefl</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">StormWinConstruction</span>
<a name="ln-3802"></a>                <span class="n">SpecReflectance</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CosIncAngRefl</span><span class="p">),</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumRefl</span><span class="p">)%</span><span class="n">ReflSolBeamFrontCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-3803"></a>              <span class="k">END IF</span>
<a name="ln-3804"></a><span class="k">              IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span>  <span class="p">&amp;</span>
<a name="ln-3805"></a>                 <span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingConstruct</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-3806"></a>                 <span class="n">SpecReflectance</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingFrac</span> <span class="o">*</span> <span class="n">POLYF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CosIncAngRefl</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3807"></a>                       <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingConstruct</span><span class="p">)%</span><span class="n">ReflSolBeamFrontCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-3808"></a>              <span class="n">TVisRefl</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncAngRec</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-3809"></a>                                  <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-3810"></a>              <span class="n">EDIRSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">EDIRSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">SunVecMir</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">SpecReflectance</span> <span class="o">*</span> <span class="n">TVisRefl</span>  <span class="c">! Bare window</span>
<a name="ln-3811"></a>
<a name="ln-3812"></a>              <span class="n">TransBmBmMultRefl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3813"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorBlind</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_InteriorBlind</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-3814"></a>                  <span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_BetweenGlassBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3815"></a><span class="k">                CALL </span><span class="n">ProfileAngle</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span><span class="n">SunVecMir</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatOrientation</span><span class="p">,</span><span class="n">ProfAng</span><span class="p">)</span>
<a name="ln-3816"></a>                <span class="c">! Contribution of reflected beam passing through slats and reaching reference point</span>
<a name="ln-3817"></a>                <span class="k">DO </span><span class="n">JB</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">MaxSlatAngs</span>
<a name="ln-3818"></a>                  <span class="c">!IF (.NOT.SurfaceWindow(IWin)%MovableSlats .AND. JB &gt; 1) EXIT</span>
<a name="ln-3819"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3820"></a><span class="k">                    </span><span class="n">SlatAng</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">((</span><span class="n">JB</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span><span class="n">r64</span><span class="p">)</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">/</span> <span class="kt">REAL</span><span class="p">((</span><span class="n">MaxSlatAngs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-3821"></a>                  <span class="k">ELSE</span>
<a name="ln-3822"></a><span class="k">                    </span><span class="n">SlatAng</span> <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatAngle</span> <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-3823"></a>                  <span class="k">END IF</span>
<a name="ln-3824"></a><span class="k">                  </span><span class="n">TransBmBmMultRefl</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">=</span> <span class="n">BlindBeamBeamTrans</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3825"></a>                                     <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatThickness</span><span class="p">)</span>
<a name="ln-3826"></a>                  <span class="n">EDIRSUdisk</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">EDIRSUdisk</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-3827"></a>                     <span class="n">SunVecMir</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">SpecReflectance</span> <span class="o">*</span> <span class="n">TVisRefl</span> <span class="o">*</span> <span class="n">TransBmBmMultRefl</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-3828"></a>
<a name="ln-3829"></a>                  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-3830"></a><span class="k">                END DO</span>
<a name="ln-3831"></a><span class="k">              ELSE IF</span><span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorScreen</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3832"></a><span class="c">!                             pass angle from sun to window normal here using PHSUN and THSUN from above and surface angles</span>
<a name="ln-3833"></a><span class="c">!                             SunAltitudeToWindowNormalAngle = PHSUN - SurfaceWindow(IWin)%Phi</span>
<a name="ln-3834"></a><span class="c">!                             SunAzimuthToWindowNormalAngle = THSUN - SurfaceWindow(IWin)%Theta</span>
<a name="ln-3835"></a>                <span class="k">CALL </span><span class="n">CalcScreenTransmittance</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span> <span class="n">Phi</span><span class="o">=</span><span class="p">(</span><span class="n">PHSUN</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Phi</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3836"></a>                                                 <span class="n">Theta</span><span class="o">=</span><span class="p">(</span><span class="n">THSUN</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Theta</span><span class="p">))</span>
<a name="ln-3837"></a>                <span class="n">TransBmBmMultRefl</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ScreenNumber</span><span class="p">)%</span><span class="n">BmBmTrans</span>
<a name="ln-3838"></a>                <span class="n">EDIRSUdisk</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">EDIRSUdisk</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-3839"></a>                     <span class="n">SunVecMir</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">SpecReflectance</span> <span class="o">*</span> <span class="n">TVisRefl</span> <span class="o">*</span> <span class="n">TransBmBmMultRefl</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3840"></a>              <span class="k">END IF</span>  <span class="c">! End of check if window has a blind or screen</span>
<a name="ln-3841"></a>
<a name="ln-3842"></a>              <span class="c">! Glare from reflected solar disk</span>
<a name="ln-3843"></a>
<a name="ln-3844"></a>              <span class="n">PHSUNrefl</span> <span class="o">=</span> <span class="n">SunVecMir</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3845"></a>              <span class="n">THSUNrefl</span> <span class="o">=</span> <span class="n">ATAN2</span><span class="p">(</span><span class="n">SunVecMir</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">SunVecMir</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3846"></a>              <span class="n">XR</span> <span class="o">=</span> <span class="nb">TAN</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">PiOvr2</span> <span class="o">-</span> <span class="n">AZVIEW</span> <span class="o">-</span> <span class="n">THSUNrefl</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.001d0</span><span class="p">)</span>
<a name="ln-3847"></a>              <span class="n">YR</span> <span class="o">=</span> <span class="nb">TAN</span><span class="p">(</span><span class="n">PHSUNrefl</span> <span class="o">+</span> <span class="mf">0.001d0</span><span class="p">)</span>
<a name="ln-3848"></a>              <span class="n">POSFAC</span><span class="o">=</span><span class="n">DayltgGlarePositionFactor</span><span class="p">(</span><span class="n">XR</span><span class="p">,</span><span class="n">YR</span><span class="p">)</span>
<a name="ln-3849"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">POSFAC</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.000001d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3850"></a><span class="k">                </span><span class="n">XAVWL</span> <span class="o">=</span> <span class="mi">1470</span><span class="mf">0.0d0</span> <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="mf">0.000068d0</span> <span class="o">*</span> <span class="n">POSFAC</span><span class="p">)</span> <span class="o">*</span>  <span class="kt">REAL</span><span class="p">(</span><span class="n">NWX</span> <span class="o">*</span> <span class="n">NWY</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-3851"></a>                       <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)</span><span class="o">**</span><span class="mf">0.8d0</span>
<a name="ln-3852"></a>                <span class="n">AVWLSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">AVWLSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">XAVWL</span> <span class="o">*</span> <span class="n">TVisRefl</span> <span class="o">*</span> <span class="n">SpecReflectance</span>  <span class="c">! Bare window</span>
<a name="ln-3853"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorBlind</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_InteriorBlind</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-3854"></a>                    <span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_BetweenGlassBlind</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3855"></a><span class="k">                  DO </span><span class="n">JB</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">MaxSlatAngs</span>
<a name="ln-3856"></a>                    <span class="c">!IF(.NOT. SurfaceWindow(IWin)%MovableSlats .AND. JB &gt; 1) EXIT</span>
<a name="ln-3857"></a>                    <span class="n">AVWLSUdisk</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">AVWLSUdisk</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-3858"></a>                          <span class="n">XAVWL</span> <span class="o">*</span> <span class="n">TVisRefl</span> <span class="o">*</span> <span class="n">SpecReflectance</span> <span class="o">*</span> <span class="n">TransBmBmMultRefl</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-3859"></a>                    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-3860"></a><span class="k">                  END DO</span>
<a name="ln-3861"></a><span class="k">                ELSE IF</span><span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorScreen</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3862"></a><span class="k">                    </span><span class="n">AVWLSUdisk</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">AVWLSUdisk</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-3863"></a>                          <span class="n">XAVWL</span> <span class="o">*</span> <span class="n">TVisRefl</span> <span class="o">*</span> <span class="n">SpecReflectance</span> <span class="o">*</span> <span class="n">TransBmBmMultRefl</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3864"></a>                <span class="k">END IF</span>
<a name="ln-3865"></a><span class="k">              END IF</span>
<a name="ln-3866"></a><span class="k">            END IF</span>  <span class="c">! End of check that obstruction can specularly reflect</span>
<a name="ln-3867"></a>          <span class="k">END DO</span>  <span class="c">! End of loop over obstructions associated with this window</span>
<a name="ln-3868"></a>
<a name="ln-3869"></a>        <span class="k">END IF</span>  <span class="c">! End of check if this window has associated obstructions</span>
<a name="ln-3870"></a>      <span class="k">END IF</span>   <span class="c">! End of check to see if this is exterior type window</span>
<a name="ln-3871"></a>    <span class="k">END IF</span>  <span class="c">! End of check if exterior reflection calculation is in effect</span>
<a name="ln-3872"></a>
<a name="ln-3873"></a>  <span class="k">END IF</span> <span class="c">! Last pass</span>
<a name="ln-3874"></a>
<a name="ln-3875"></a>  <span class="k">IF</span><span class="p">((</span><span class="n">ICtrl</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-3876"></a>     <span class="p">(</span><span class="n">ShType</span> <span class="o">==</span><span class="n">WSC_ST_InteriorShade</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShType</span> <span class="o">==</span><span class="n">WSC_ST_ExteriorShade</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShType</span> <span class="o">==</span><span class="n">WSC_ST_BetweenGlassShade</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3877"></a>      <span class="n">ShType</span> <span class="o">==</span><span class="n">WSC_ST_InteriorBlind</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShType</span> <span class="o">==</span><span class="n">WSC_ST_ExteriorBlind</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShType</span> <span class="o">==</span><span class="n">WSC_ST_BetweenGlassBlind</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3878"></a>      <span class="n">ShType</span> <span class="o">==</span><span class="n">WSC_ST_ExteriorScreen</span><span class="p">)).</span><span class="nb">OR</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3879"></a>
<a name="ln-3880"></a>    <span class="c">! ----- CASE II -- WINDOW WITH SCREEN, SHADE, BLIND, OR DIFFUSING WINDOW</span>
<a name="ln-3881"></a>
<a name="ln-3882"></a>    <span class="c">! Interior window visible transmittance multiplier for exterior window in adjacent zone</span>
<a name="ln-3883"></a>    <span class="n">TVisIntWinMult</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-3884"></a>    <span class="n">TVisIntWinDiskMult</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-3885"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">/=</span> <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3886"></a><span class="k">      </span><span class="n">TVisIntWinMult</span> <span class="o">=</span> <span class="n">TVisIntWin</span>
<a name="ln-3887"></a>      <span class="n">TVisIntWinDiskMult</span> <span class="o">=</span> <span class="n">TVisIntWinDisk</span>
<a name="ln-3888"></a>    <span class="k">END IF</span>
<a name="ln-3889"></a>
<a name="ln-3890"></a><span class="k">    DO </span><span class="n">ISKY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-3891"></a>      <span class="k">DO </span><span class="n">JB</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">MaxSlatAngs</span>
<a name="ln-3892"></a>        <span class="c">!IF (.NOT.SurfaceWindow(IWin)%MovableSlats .AND. JB &gt; 1) EXIT</span>
<a name="ln-3893"></a>        <span class="n">AVWLSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">AVWLSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">WLUMSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">TVisIntWinMult</span>
<a name="ln-3894"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3895"></a><span class="k">          </span><span class="n">AVWLSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">AVWLSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">WLUMSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">TVisIntWinMult</span>
<a name="ln-3896"></a>          <span class="n">AVWLSUdisk</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">AVWLSUdisk</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">WLUMSUdisk</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">TVisIntWinDiskMult</span>
<a name="ln-3897"></a>        <span class="k">END IF</span>
<a name="ln-3898"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">PHRAY</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3899"></a><span class="k">          </span><span class="n">EDIRSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">EDIRSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">WLUMSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">DOMEGA</span><span class="o">*</span><span class="n">RAY</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">TVisIntWinMult</span>
<a name="ln-3900"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">EDIRSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">EDIRSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">WLUMSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">DOMEGA</span><span class="o">*</span><span class="n">RAY</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">TVisIntWinMult</span>
<a name="ln-3901"></a>        <span class="k">END IF</span>
<a name="ln-3902"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-3903"></a><span class="k">      END DO</span>
<a name="ln-3904"></a><span class="k">    END DO</span>
<a name="ln-3905"></a><span class="k">  END IF</span>
<a name="ln-3906"></a>
<a name="ln-3907"></a><span class="k">  RETURN</span>
<a name="ln-3908"></a>
<a name="ln-3909"></a><span class="k">END SUBROUTINE </span><span class="n">FigureDayltgCoeffsAtPointsForSunPosition</span>
<a name="ln-3910"></a>
<a name="ln-3911"></a>
<a name="ln-3912"></a><span class="k">SUBROUTINE </span><span class="n">FigureRefPointDayltgFactorsToAddIllums</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span> <span class="n">iHour</span><span class="p">,</span> <span class="n">iSunPos</span><span class="p">,</span> <span class="n">iWin</span><span class="p">,</span> <span class="n">loopWin</span><span class="p">,</span> <span class="n">NWX</span> <span class="p">,</span> <span class="n">NWY</span> <span class="p">,</span> <span class="n">ICtrl</span> <span class="p">)</span>
<a name="ln-3913"></a>
<a name="ln-3914"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3915"></a>          <span class="c">!       AUTHOR         B. Griffith, Oct 2012, derived from legacy code by Fred Winkelmann</span>
<a name="ln-3916"></a>          <span class="c">!       DATE WRITTEN   Oct. 2012</span>
<a name="ln-3917"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3918"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3919"></a>
<a name="ln-3920"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3921"></a>          <span class="c">! calculation worker routine to fill daylighting coefficients</span>
<a name="ln-3922"></a>
<a name="ln-3923"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3924"></a>          <span class="c">! this version is just for reference points.</span>
<a name="ln-3925"></a>
<a name="ln-3926"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3927"></a>          <span class="c">! na</span>
<a name="ln-3928"></a>
<a name="ln-3929"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3930"></a>          <span class="c">! na</span>
<a name="ln-3931"></a>
<a name="ln-3932"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3933"></a>
<a name="ln-3934"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3935"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ZoneNum</span>
<a name="ln-3936"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iRefPoint</span>
<a name="ln-3937"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iHour</span>
<a name="ln-3938"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iSunPos</span>
<a name="ln-3939"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iWin</span>
<a name="ln-3940"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">loopWin</span>
<a name="ln-3941"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NWX</span>                          <span class="c">! Number of window elements in x direction for dayltg calc</span>
<a name="ln-3942"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NWY</span>                          <span class="c">! Number of window elements in y direction for dayltg calc</span>
<a name="ln-3943"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ICtrl</span>                        <span class="c">! Window control counter</span>
<a name="ln-3944"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3945"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">tmpDFCalc</span> <span class="o">=</span> <span class="mf">0.05d0</span> <span class="c">! cut off illuminance (lux) for exterior horizontal in calculating</span>
<a name="ln-3946"></a>                                             <span class="c">! the daylighting and glare factors</span>
<a name="ln-3947"></a>
<a name="ln-3948"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3949"></a>          <span class="c">! na</span>
<a name="ln-3950"></a>
<a name="ln-3951"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3952"></a>          <span class="c">! na</span>
<a name="ln-3953"></a>
<a name="ln-3954"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3955"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ISky</span>                         <span class="c">! Sky type index: 1=clear, 2=clear turbid, 3=intermediate, 4=overcast</span>
<a name="ln-3956"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">JSH</span>                          <span class="c">! Shading index: J=1 is unshaded window, J=2 is shaded window</span>
<a name="ln-3957"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VTR</span>                          <span class="c">! For switchable glazing, ratio of visible transmittance of</span>
<a name="ln-3958"></a>                                            <span class="c">!  fully-switched state to that of the unswitched state</span>
<a name="ln-3959"></a>
<a name="ln-3960"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SUNCOSHR</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SunIsUpValue</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-3961"></a>
<a name="ln-3962"></a><span class="k">  </span><span class="n">ISunPos</span> <span class="o">=</span> <span class="n">ISunPos</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3963"></a>
<a name="ln-3964"></a>  <span class="c">! Altitude of sun (degrees)</span>
<a name="ln-3965"></a>  <span class="n">PHSUN</span> <span class="o">=</span> <span class="n">PHSUNHR</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-3966"></a>  <span class="n">SPHSUN</span> <span class="o">=</span> <span class="n">SPHSUNHR</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-3967"></a>  <span class="n">CPHSUN</span> <span class="o">=</span> <span class="n">CPHSUNHR</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-3968"></a>
<a name="ln-3969"></a>  <span class="c">! Azimuth of sun in absolute coord sys</span>
<a name="ln-3970"></a>  <span class="n">THSUN</span> <span class="o">=</span> <span class="n">THSUNHR</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-3971"></a>
<a name="ln-3972"></a>  <span class="k">DO </span><span class="n">ISKY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span> <span class="c">! Loop over sky types</span>
<a name="ln-3973"></a>
<a name="ln-3974"></a>    <span class="c">! Loop over shading index (1=bare window; 2=diffusing glazing, shade, screen or fixed slat-angle blind;</span>
<a name="ln-3975"></a>    <span class="c">! 2 to MaxSlatAngs+1 for variable slat-angle blind)</span>
<a name="ln-3976"></a>
<a name="ln-3977"></a>    <span class="c">! TH. 9/22/2009. CR 7625 - daylight illuminance spikes during some sunset hours due to the calculated sky and sun</span>
<a name="ln-3978"></a>    <span class="c">!  related daylight factors &gt; 1, which theoretically can occur when sun is perpendicular to the window</span>
<a name="ln-3979"></a>    <span class="c">!  and interior surfaces with high visible reflectance.</span>
<a name="ln-3980"></a>    <span class="c">! Added tmpDFCalc (default to 0.05 lux) as the cap for GILSK and GILSU in calculating the daylight factors</span>
<a name="ln-3981"></a>    <span class="c">!  the assumption behind it is if exterior horizontal surface does not get daylight, spaces do not get daylight.</span>
<a name="ln-3982"></a>
<a name="ln-3983"></a>    <span class="k">DO </span><span class="n">JSH</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3984"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">JSH</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-3985"></a>
<a name="ln-3986"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GILSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tmpDFCalc</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3987"></a><span class="k">        </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3988"></a>                       <span class="p">(</span><span class="n">EDIRSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">EINTSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">))</span> <span class="o">/</span> <span class="n">GILSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-3989"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3990"></a>                       <span class="n">AVWLSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">NWX</span><span class="o">*</span><span class="n">NWY</span> <span class="o">*</span> <span class="n">GILSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">iHour</span><span class="p">))</span>
<a name="ln-3991"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3992"></a>            <span class="n">EINTSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span> <span class="o">/</span> <span class="p">(</span><span class="n">PI</span><span class="o">*</span><span class="n">GILSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">iHour</span><span class="p">))</span>
<a name="ln-3993"></a>      <span class="k">ELSE</span>
<a name="ln-3994"></a><span class="k">        </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3995"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3996"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3997"></a>      <span class="n">ENDIF</span>
<a name="ln-3998"></a>
<a name="ln-3999"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4000"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">GILSU</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tmpDFCalc</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4001"></a><span class="k">          </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4002"></a>                            <span class="p">(</span><span class="n">EDIRSU</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">EINTSU</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">GILSU</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0001d0</span><span class="p">)</span>
<a name="ln-4003"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4004"></a>                        <span class="p">(</span><span class="n">EDIRSUdisk</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">EINTSUdisk</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">GILSU</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0001d0</span><span class="p">)</span>
<a name="ln-4005"></a>
<a name="ln-4006"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-4007"></a>                         <span class="n">AVWLSU</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">NWX</span><span class="o">*</span><span class="n">NWY</span> <span class="o">*</span> <span class="p">(</span><span class="n">GILSU</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0001d0</span><span class="p">))</span>
<a name="ln-4008"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4009"></a>                         <span class="n">AVWLSUdisk</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">NWX</span><span class="o">*</span><span class="n">NWY</span> <span class="o">*</span> <span class="p">(</span><span class="n">GILSU</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0001d0</span><span class="p">))</span>
<a name="ln-4010"></a>
<a name="ln-4011"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4012"></a>            <span class="n">EINTSU</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span> <span class="o">/</span> <span class="p">(</span><span class="n">Pi</span><span class="o">*</span><span class="p">(</span><span class="n">GILSU</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0001d0</span><span class="p">))</span>
<a name="ln-4013"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4014"></a>            <span class="n">EINTSUdisk</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span> <span class="o">/</span> <span class="p">(</span><span class="n">Pi</span><span class="o">*</span><span class="p">(</span><span class="n">GILSU</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0001d0</span><span class="p">))</span>
<a name="ln-4015"></a>        <span class="k">ELSE</span>
<a name="ln-4016"></a><span class="k">          </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4017"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4018"></a>
<a name="ln-4019"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4020"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4021"></a>
<a name="ln-4022"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4023"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4024"></a>        <span class="n">ENDIF</span>
<a name="ln-4025"></a>      <span class="k">END IF</span>
<a name="ln-4026"></a><span class="k">    END DO</span> <span class="c">! End of shading index loop, JSH</span>
<a name="ln-4027"></a>
<a name="ln-4028"></a>    <span class="c">! For switchable glazing put daylighting factors for switched (dark) state in IS=2 location</span>
<a name="ln-4029"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ICtrl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4030"></a><span class="k">      IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ICtrl</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4031"></a><span class="k">        </span><span class="n">VTR</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">VisTransRatio</span>
<a name="ln-4032"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4033"></a>                          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4034"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4035"></a>                          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4036"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4037"></a>                          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4038"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4039"></a><span class="k">          </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4040"></a>                          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4041"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4042"></a>                          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4043"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4044"></a>                          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4045"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4046"></a>                          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4047"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4048"></a>                          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4049"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>     <span class="p">&amp;</span>
<a name="ln-4050"></a>                          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iRefPoint</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4051"></a>        <span class="k">END IF</span>
<a name="ln-4052"></a><span class="k">      END IF</span>
<a name="ln-4053"></a><span class="k">    END IF</span> <span class="c">! ICtrl &gt; 0</span>
<a name="ln-4054"></a>
<a name="ln-4055"></a>  <span class="k">END DO</span> <span class="c">! End of sky type loop, ISky</span>
<a name="ln-4056"></a>
<a name="ln-4057"></a>  <span class="k">RETURN</span>
<a name="ln-4058"></a>
<a name="ln-4059"></a><span class="k">END SUBROUTINE </span><span class="n">FigureRefPointDayltgFactorsToAddIllums</span>
<a name="ln-4060"></a>
<a name="ln-4061"></a><span class="k">SUBROUTINE </span><span class="n">FigureMapPointDayltgFactorsToAddIllums</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iMapPoint</span><span class="p">,</span> <span class="n">iHour</span><span class="p">,</span>  <span class="n">iWin</span><span class="p">,</span> <span class="n">loopWin</span><span class="p">,</span> <span class="n">NWX</span> <span class="p">,</span> <span class="n">NWY</span> <span class="p">,</span> <span class="n">ICtrl</span> <span class="p">)</span>
<a name="ln-4062"></a>
<a name="ln-4063"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4064"></a>          <span class="c">!       AUTHOR         B. Griffith, Oct 2012, derived from legacy code by Fred Winkelmann, Peter Ellis, Linda Lawrie</span>
<a name="ln-4065"></a>          <span class="c">!       DATE WRITTEN   Nov. 2012</span>
<a name="ln-4066"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4067"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4068"></a>
<a name="ln-4069"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4070"></a>          <span class="c">! calculation worker routine to fill daylighting coefficients</span>
<a name="ln-4071"></a>
<a name="ln-4072"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4073"></a>          <span class="c">! this version is just for map points.</span>
<a name="ln-4074"></a>
<a name="ln-4075"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4076"></a>          <span class="c">! na</span>
<a name="ln-4077"></a>
<a name="ln-4078"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4079"></a>          <span class="c">! na</span>
<a name="ln-4080"></a>
<a name="ln-4081"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4082"></a>
<a name="ln-4083"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4084"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ZoneNum</span>
<a name="ln-4085"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MapNum</span>
<a name="ln-4086"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iMapPoint</span>
<a name="ln-4087"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iHour</span>
<a name="ln-4088"></a>
<a name="ln-4089"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iWin</span>
<a name="ln-4090"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">loopWin</span>
<a name="ln-4091"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NWX</span>                          <span class="c">! Number of window elements in x direction for dayltg calc</span>
<a name="ln-4092"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NWY</span>                          <span class="c">! Number of window elements in y direction for dayltg calc</span>
<a name="ln-4093"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ICtrl</span>                        <span class="c">! Window control counter</span>
<a name="ln-4094"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4095"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">tmpDFCalc</span> <span class="o">=</span> <span class="mf">0.05d0</span> <span class="c">! cut off illuminance (lux) for exterior horizontal in calculating</span>
<a name="ln-4096"></a>                                             <span class="c">! the daylighting and glare factors</span>
<a name="ln-4097"></a>
<a name="ln-4098"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4099"></a>          <span class="c">! na</span>
<a name="ln-4100"></a>
<a name="ln-4101"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4102"></a>          <span class="c">! na</span>
<a name="ln-4103"></a>
<a name="ln-4104"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4105"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ISky</span>                         <span class="c">! Sky type index: 1=clear, 2=clear turbid, 3=intermediate, 4=overcast</span>
<a name="ln-4106"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">JSH</span>                          <span class="c">! Shading index: J=1 is unshaded window, J=2 is shaded window</span>
<a name="ln-4107"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VTR</span>                          <span class="c">! For switchable glazing, ratio of visible transmittance of</span>
<a name="ln-4108"></a>                                            <span class="c">!  fully-switched state to that of the unswitched state</span>
<a name="ln-4109"></a>
<a name="ln-4110"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SUNCOSHR</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SunIsUpValue</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-4111"></a>
<a name="ln-4112"></a>  <span class="c">! Altitude of sun (degrees)</span>
<a name="ln-4113"></a>  <span class="n">PHSUN</span> <span class="o">=</span> <span class="n">PHSUNHR</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-4114"></a>  <span class="n">SPHSUN</span> <span class="o">=</span> <span class="n">SPHSUNHR</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-4115"></a>  <span class="n">CPHSUN</span> <span class="o">=</span> <span class="n">CPHSUNHR</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-4116"></a>
<a name="ln-4117"></a>  <span class="c">! Azimuth of sun in absolute coord sys</span>
<a name="ln-4118"></a>  <span class="n">THSUN</span> <span class="o">=</span> <span class="n">THSUNHR</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-4119"></a>
<a name="ln-4120"></a>  <span class="k">DO </span><span class="n">ISKY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span> <span class="c">! Loop over sky types</span>
<a name="ln-4121"></a>
<a name="ln-4122"></a>    <span class="c">! Loop over shading index (1=bare window; 2=diffusing glazing, shade, screen or fixed slat-angle blind;</span>
<a name="ln-4123"></a>    <span class="c">! 2 to MaxSlatAngs+1 for variable slat-angle blind)</span>
<a name="ln-4124"></a>
<a name="ln-4125"></a>    <span class="c">! TH. 9/22/2009. CR 7625 - daylight illuminance spikes during some sunset hours due to the calculated sky and sun</span>
<a name="ln-4126"></a>    <span class="c">!  related daylight factors &gt; 1, which theoretically can occur when sun is perpendicular to the window</span>
<a name="ln-4127"></a>    <span class="c">!  and interior surfaces with high visible reflectance.</span>
<a name="ln-4128"></a>    <span class="c">! Added tmpDFCalc (default to 0.05 lux) as the cap for GILSK and GILSU in calculating the daylight factors</span>
<a name="ln-4129"></a>    <span class="c">!  the assumption behind it is if exterior horizontal surface does not get daylight, spaces do not get daylight.</span>
<a name="ln-4130"></a>
<a name="ln-4131"></a>    <span class="k">DO </span><span class="n">JSH</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4132"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">JSH</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-4133"></a>
<a name="ln-4134"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GILSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tmpDFCalc</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4135"></a><span class="k">        </span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4136"></a>                       <span class="p">(</span><span class="n">EDIRSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">EINTSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">))</span> <span class="o">/</span> <span class="n">GILSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-4137"></a>        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4138"></a>                       <span class="n">AVWLSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">NWX</span><span class="o">*</span><span class="n">NWY</span> <span class="o">*</span> <span class="n">GILSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">iHour</span><span class="p">))</span>
<a name="ln-4139"></a>        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4140"></a>            <span class="n">EINTSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span> <span class="o">/</span> <span class="p">(</span><span class="n">PI</span><span class="o">*</span><span class="n">GILSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">iHour</span><span class="p">))</span>
<a name="ln-4141"></a>      <span class="k">ELSE</span>
<a name="ln-4142"></a><span class="k">        </span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4143"></a>        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4144"></a>        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4145"></a>      <span class="n">ENDIF</span>
<a name="ln-4146"></a>
<a name="ln-4147"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4148"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">GILSU</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tmpDFCalc</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4149"></a><span class="k">          </span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4150"></a>                            <span class="p">(</span><span class="n">EDIRSU</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">EINTSU</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">GILSU</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0001d0</span><span class="p">)</span>
<a name="ln-4151"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4152"></a>                        <span class="p">(</span><span class="n">EDIRSUdisk</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">EINTSUdisk</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">GILSU</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0001d0</span><span class="p">)</span>
<a name="ln-4153"></a>
<a name="ln-4154"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-4155"></a>                         <span class="n">AVWLSU</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">NWX</span><span class="o">*</span><span class="n">NWY</span> <span class="o">*</span> <span class="p">(</span><span class="n">GILSU</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0001d0</span><span class="p">))</span>
<a name="ln-4156"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4157"></a>                         <span class="n">AVWLSUdisk</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">NWX</span><span class="o">*</span><span class="n">NWY</span> <span class="o">*</span> <span class="p">(</span><span class="n">GILSU</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0001d0</span><span class="p">))</span>
<a name="ln-4158"></a>
<a name="ln-4159"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4160"></a>            <span class="n">EINTSU</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span> <span class="o">/</span> <span class="p">(</span><span class="n">Pi</span><span class="o">*</span><span class="p">(</span><span class="n">GILSU</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0001d0</span><span class="p">))</span>
<a name="ln-4161"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4162"></a>            <span class="n">EINTSUdisk</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span> <span class="o">/</span> <span class="p">(</span><span class="n">Pi</span><span class="o">*</span><span class="p">(</span><span class="n">GILSU</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0001d0</span><span class="p">))</span>
<a name="ln-4163"></a>        <span class="k">ELSE</span>
<a name="ln-4164"></a><span class="k">          </span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4165"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4166"></a>
<a name="ln-4167"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4168"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4169"></a>
<a name="ln-4170"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4171"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4172"></a>        <span class="n">ENDIF</span>
<a name="ln-4173"></a>      <span class="k">END IF</span>
<a name="ln-4174"></a><span class="k">    END DO</span> <span class="c">! End of shading index loop, JSH</span>
<a name="ln-4175"></a>
<a name="ln-4176"></a>    <span class="c">! For switchable glazing put daylighting factors for switched (dark) state in IS=2 location</span>
<a name="ln-4177"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ICtrl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4178"></a><span class="k">      IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ICtrl</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4179"></a><span class="k">        </span><span class="n">VTR</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">VisTransRatio</span>
<a name="ln-4180"></a>        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4181"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4182"></a>        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4183"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4184"></a>        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4185"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4186"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4187"></a><span class="k">          </span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4188"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4189"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4190"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4191"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4192"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4193"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4194"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4195"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4196"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4197"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span>     <span class="p">&amp;</span>
<a name="ln-4198"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loopwin</span><span class="p">,</span><span class="n">iMapPoint</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">*</span><span class="n">VTR</span>
<a name="ln-4199"></a>        <span class="k">END IF</span>
<a name="ln-4200"></a><span class="k">      END IF</span>
<a name="ln-4201"></a><span class="k">    END IF</span> <span class="c">! ICtrl &gt; 0</span>
<a name="ln-4202"></a>
<a name="ln-4203"></a>  <span class="k">END DO</span> <span class="c">! End of sky type loop, ISky</span>
<a name="ln-4204"></a>
<a name="ln-4205"></a>  <span class="k">RETURN</span>
<a name="ln-4206"></a>
<a name="ln-4207"></a><span class="k">END SUBROUTINE </span><span class="n">FigureMapPointDayltgFactorsToAddIllums</span>
<a name="ln-4208"></a>
<a name="ln-4209"></a><span class="k">SUBROUTINE </span><span class="n">GetDaylightingParametersInput</span>
<a name="ln-4210"></a>
<a name="ln-4211"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4212"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-4213"></a>          <span class="c">!       DATE WRITTEN   Oct 2004</span>
<a name="ln-4214"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4215"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4216"></a>
<a name="ln-4217"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4218"></a>          <span class="c">! This subroutine provides a simple structure to get all daylighting</span>
<a name="ln-4219"></a>          <span class="c">! parameters.</span>
<a name="ln-4220"></a>
<a name="ln-4221"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4222"></a>          <span class="c">! na</span>
<a name="ln-4223"></a>
<a name="ln-4224"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4225"></a>          <span class="c">! na</span>
<a name="ln-4226"></a>
<a name="ln-4227"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4228"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-4229"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span>
<a name="ln-4230"></a>  <span class="c">! RJH DElight Modification Begin</span>
<a name="ln-4231"></a>  <span class="k">USE </span><span class="n">DElightManagerF</span>     <span class="c">! Module for managing DElight subroutines</span>
<a name="ln-4232"></a>  <span class="c">! RJH DElight Modification End</span>
<a name="ln-4233"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GoodIOStatValue</span>
<a name="ln-4234"></a>
<a name="ln-4235"></a>
<a name="ln-4236"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4237"></a>
<a name="ln-4238"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4239"></a>          <span class="c">! na</span>
<a name="ln-4240"></a>
<a name="ln-4241"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4242"></a>          <span class="c">! na</span>
<a name="ln-4243"></a>
<a name="ln-4244"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-4245"></a>          <span class="c">! na</span>
<a name="ln-4246"></a>
<a name="ln-4247"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-4248"></a>          <span class="c">! na</span>
<a name="ln-4249"></a>
<a name="ln-4250"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4251"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">TotDaylightingDetailed</span>       <span class="c">! Total Daylighting:Detailed inputs</span>
<a name="ln-4252"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IntWin</span>                       <span class="c">! Interior window surface index</span>
<a name="ln-4253"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">ErrorsFound</span>                  <span class="c">! Error flag</span>
<a name="ln-4254"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SurfNum</span>                      <span class="c">! Surface counter (loop)</span>
<a name="ln-4255"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">WindowShadingControlPtr</span>      <span class="c">! Pointer for WindowShadingControl</span>
<a name="ln-4256"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ZoneNum</span>                      <span class="c">! Zone Number (loop counter)</span>
<a name="ln-4257"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SurfNumAdj</span>                   <span class="c">! Surface Number for adjacent surface</span>
<a name="ln-4258"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ZoneNumAdj</span>                   <span class="c">! Zone Number for adjacent zone</span>
<a name="ln-4259"></a>  <span class="c">! RJH DElight Modification Begin - local variable declarations</span>
<a name="ln-4260"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">TotDaylightingDElight</span>  <span class="c">! Total Daylighting:DElight inputs</span>
<a name="ln-4261"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dLatitude</span>    <span class="c">! double for argument passing</span>
<a name="ln-4262"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">iErrorFlag</span>             <span class="c">! Error Flag for warning/errors returned from DElight</span>
<a name="ln-4263"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">EXTERNAL</span> <span class="kd">::</span> <span class="n">GetNewUnitNumber</span>  <span class="c">! External  function to &quot;get&quot; a unit number</span>
<a name="ln-4264"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">iDElightErrorFile</span>      <span class="c">! Unit number for reading DElight Error File (eplusout.delightdfdmp)</span>
<a name="ln-4265"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">iReadStatus</span>            <span class="c">! Error File Read Status</span>
<a name="ln-4266"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">210</span><span class="p">)</span> <span class="n">cErrorLine</span>     <span class="c">! Each DElight Error line can be up to 210 characters long</span>
<a name="ln-4267"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span> <span class="n">cErrorMsg</span>      <span class="c">! Each DElight Error Message can be up to 200 characters long</span>
<a name="ln-4268"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">bEndofErrFile</span>          <span class="c">! End of Error File flag</span>
<a name="ln-4269"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">bRecordsOnErrFile</span>      <span class="c">! true if there are records on the error file</span>
<a name="ln-4270"></a>  <span class="c">! RJH DElight Modification End - local variable declarations</span>
<a name="ln-4271"></a>
<a name="ln-4272"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NumReports</span><span class="p">,</span> <span class="n">NumNames</span><span class="p">,</span> <span class="n">NumNumbers</span><span class="p">,</span> <span class="n">IOStat</span>
<a name="ln-4273"></a>
<a name="ln-4274"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4275"></a>    <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Daylighting:Controls&#39;</span>
<a name="ln-4276"></a>    <span class="n">TotDaylightingDetailed</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-4277"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TotDaylightingDetailed</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4278"></a><span class="k">      CALL </span><span class="n">GetDaylightingParametersDetaild</span><span class="p">(</span><span class="n">TotDaylightingDetailed</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-4279"></a>      <span class="k">CALL </span><span class="n">GetLightWellData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-4280"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Program terminated for above reasons, related to DAYLIGHTING&#39;</span><span class="p">)</span>
<a name="ln-4281"></a>      <span class="k">CALL </span><span class="n">DayltgSetupAdjZoneListsAndPointers</span>
<a name="ln-4282"></a>    <span class="k">END IF</span>
<a name="ln-4283"></a>
<a name="ln-4284"></a><span class="k">    DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-4285"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4286"></a><span class="k">      </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-4287"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4288"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SurfDayLightInit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4289"></a><span class="k">          ALLOCATE</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPt</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">))</span>
<a name="ln-4290"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4291"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">))</span>
<a name="ln-4292"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4293"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4294"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4295"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4296"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4297"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4298"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4299"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SurfDayLightInit</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4300"></a>        <span class="n">ENDIF</span>
<a name="ln-4301"></a>      <span class="k">ELSE</span>
<a name="ln-4302"></a><span class="k">        </span><span class="n">SurfNumAdj</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-4303"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfNumAdj</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4304"></a><span class="k">          </span><span class="n">ZoneNumAdj</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-4305"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4306"></a><span class="k">            IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SurfDayLightInit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4307"></a><span class="k">              ALLOCATE</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPt</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">))</span>
<a name="ln-4308"></a>              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4309"></a>              <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">))</span>
<a name="ln-4310"></a>              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4311"></a>              <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4312"></a>              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4313"></a>              <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4314"></a>              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4315"></a>              <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4316"></a>              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4317"></a>              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SurfDayLightInit</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4318"></a>            <span class="n">ENDIF</span>
<a name="ln-4319"></a>          <span class="n">ENDIF</span>
<a name="ln-4320"></a>        <span class="n">ENDIF</span>
<a name="ln-4321"></a>      <span class="n">ENDIF</span>
<a name="ln-4322"></a>
<a name="ln-4323"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4324"></a>
<a name="ln-4325"></a><span class="k">        </span><span class="n">WindowShadingControlPtr</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span>
<a name="ln-4326"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">WindowShadingControlPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4327"></a><span class="k">          IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WindowShadingControlPtr</span><span class="p">)%</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4328"></a>            <span class="c">! Error if GlareControlIsActive but window is not in a Daylighting:Detailed zone</span>
<a name="ln-4329"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4330"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Window=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39; has Window Shading Control with&#39;</span><span class="p">)</span>
<a name="ln-4331"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;GlareControlIsActive = Yes but it is not in a Daylighting zone.&#39;</span><span class="p">)</span>
<a name="ln-4332"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Zone indicated=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4333"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4334"></a>            <span class="k">END IF</span>
<a name="ln-4335"></a>            <span class="c">! Error if GlareControlIsActive and window is in a Daylighting:Detailed zone with</span>
<a name="ln-4336"></a>            <span class="c">! an interior window adjacent to another Daylighting:Detailed zone</span>
<a name="ln-4337"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4338"></a><span class="k">              DO </span><span class="n">IntWin</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-4339"></a>                <span class="n">SurfNumAdj</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IntWin</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-4340"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IntWin</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfNumAdj</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4341"></a><span class="k">                  </span><span class="n">ZoneNumAdj</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-4342"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4343"></a><span class="k">                    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Window=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39; has Window Shading Control with&#39;</span><span class="p">)</span>
<a name="ln-4344"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;GlareControlIsActive = Yes and is in a Daylighting zone&#39;</span><span class="p">)</span>
<a name="ln-4345"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;that shares an interior window with another Daylighting zone&#39;</span><span class="p">)</span>
<a name="ln-4346"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Adjacent Zone indicated=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4347"></a>                    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4348"></a>                  <span class="k">END IF</span>
<a name="ln-4349"></a><span class="k">                END IF</span>
<a name="ln-4350"></a><span class="k">              END DO</span>
<a name="ln-4351"></a><span class="k">            END IF</span>
<a name="ln-4352"></a><span class="k">          END IF</span>
<a name="ln-4353"></a>
<a name="ln-4354"></a><span class="k">          IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WindowShadingControlPtr</span><span class="p">)%</span><span class="n">ShadingControlType</span> <span class="o">==</span> <span class="n">WSCT_MeetDaylIlumSetp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4355"></a>            <span class="c">! Error if window has ShadingControlType = MeetDaylightingIlluminanceSetpoint &amp;</span>
<a name="ln-4356"></a>            <span class="c">! but is not in a Daylighting:Detailed zone</span>
<a name="ln-4357"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4358"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Window=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39; has Window Shading Control with&#39;</span><span class="p">)</span>
<a name="ln-4359"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;MeetDaylightingIlluminanceSetpoint but it is not in a Daylighting zone.&#39;</span><span class="p">)</span>
<a name="ln-4360"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Zone indicated=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4361"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4362"></a>            <span class="k">END IF</span>
<a name="ln-4363"></a>            <span class="c">! Error if window has ShadingControlType = MeetDaylightIlluminanceSetpoint and is in a &amp;</span>
<a name="ln-4364"></a>            <span class="c">! Daylighting:Detailed zone with an interior window adjacent to another Daylighting:Detailed zone</span>
<a name="ln-4365"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4366"></a><span class="k">              DO </span><span class="n">IntWin</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-4367"></a>                <span class="n">SurfNumAdj</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IntWin</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-4368"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IntWin</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfNumAdj</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4369"></a><span class="k">                  </span><span class="n">ZoneNumAdj</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-4370"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4371"></a><span class="k">                    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Window=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39; has Window Shading Control with&#39;</span><span class="p">)</span>
<a name="ln-4372"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;MeetDaylightIlluminanceSetpoint and is in a Daylighting zone&#39;</span><span class="p">)</span>
<a name="ln-4373"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;that shares an interior window with another Daylighting zone&#39;</span><span class="p">)</span>
<a name="ln-4374"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Adjacent Zone indicated=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4375"></a>                    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4376"></a>                  <span class="k">END IF</span>
<a name="ln-4377"></a><span class="k">                END IF</span>
<a name="ln-4378"></a><span class="k">              END DO</span>
<a name="ln-4379"></a><span class="k">            END IF</span>
<a name="ln-4380"></a><span class="k">          END IF</span>
<a name="ln-4381"></a>
<a name="ln-4382"></a><span class="k">        END IF</span>
<a name="ln-4383"></a><span class="k">      END IF</span>
<a name="ln-4384"></a><span class="k">    END DO</span>
<a name="ln-4385"></a>
<a name="ln-4386"></a>    <span class="c">! RJH DElight Modification Begin - Calls to DElight preprocessing subroutines</span>
<a name="ln-4387"></a>    <span class="n">TotDaylightingDElight</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Daylighting:DELight:Controls&#39;</span><span class="p">)</span>
<a name="ln-4388"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TotDaylightingDElight</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4389"></a><span class="k">        </span><span class="n">dLatitude</span> <span class="o">=</span> <span class="n">Latitude</span>
<a name="ln-4390"></a>        <span class="k">CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Calculating DElight Daylighting Factors&#39;</span><span class="p">)</span>
<a name="ln-4391"></a>        <span class="k">CALL </span><span class="n">DElightInputGenerator</span>
<a name="ln-4392"></a>        <span class="c">! Init Error Flag to 0 (no Warnings or Errors)</span>
<a name="ln-4393"></a>        <span class="k">CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;ReturnFrom DElightInputGenerator&#39;</span><span class="p">)</span>
<a name="ln-4394"></a>        <span class="n">iErrorFlag</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4395"></a>        <span class="k">CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Calculating DElight DaylightCoefficients&#39;</span><span class="p">)</span>
<a name="ln-4396"></a>        <span class="k">CALL </span><span class="n">GenerateDElightDaylightCoefficients</span><span class="p">(</span><span class="n">dLatitude</span><span class="p">,</span> <span class="n">iErrorFlag</span><span class="p">)</span>
<a name="ln-4397"></a>        <span class="c">! Check Error Flag for Warnings or Errors returning from DElight</span>
<a name="ln-4398"></a>        <span class="c">! RJH 2008-03-07: open file for READWRITE and DELETE file after processing</span>
<a name="ln-4399"></a>        <span class="k">CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;ReturnFrom DElight DaylightCoefficients Calc&#39;</span><span class="p">)</span>
<a name="ln-4400"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">iErrorFlag</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4401"></a>            <span class="c">! Open DElight Daylight Factors Error File for reading</span>
<a name="ln-4402"></a>            <span class="n">iDElightErrorFile</span><span class="o">=</span><span class="n">GetNewUnitNumber</span><span class="p">()</span>
<a name="ln-4403"></a>            <span class="k">Open</span> <span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">iDElightErrorFile</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;eplusout.delightdfdmp&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;READWRITE&#39;</span><span class="p">)</span>
<a name="ln-4404"></a>
<a name="ln-4405"></a>            <span class="c">! Sequentially read lines in DElight Daylight Factors Error File</span>
<a name="ln-4406"></a>            <span class="c">! and process them using standard EPlus warning/error handling calls</span>
<a name="ln-4407"></a>            <span class="c">! Process all error/warning messages first</span>
<a name="ln-4408"></a>            <span class="c">! Then, if any error has occurred, ShowFatalError to terminate processing</span>
<a name="ln-4409"></a>            <span class="n">bEndofErrFile</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4410"></a>            <span class="n">bRecordsOnErrFile</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4411"></a>            <span class="k">DO WHILE</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">bEndofErrFile</span><span class="p">)</span>
<a name="ln-4412"></a>                <span class="k">READ</span><span class="p">(</span><span class="n">iDElightErrorFile</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">iReadStatus</span><span class="p">)</span> <span class="n">cErrorLine</span>
<a name="ln-4413"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">iReadStatus</span> <span class="o">&lt;</span> <span class="n">GoodIOStatValue</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4414"></a><span class="k">                    </span><span class="n">bEndofErrFile</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4415"></a>                    <span class="k">CYCLE</span>
<a name="ln-4416"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-4417"></a>                <span class="n">bRecordsOnErrFile</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4418"></a>                <span class="c">! Is the current line a Warning message?</span>
<a name="ln-4419"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">cErrorLine</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">9</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;WARNING: &#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4420"></a><span class="k">                    </span><span class="n">cErrorMsg</span> <span class="o">=</span> <span class="n">cErrorLine</span><span class="p">(</span><span class="mi">10</span><span class="p">:</span><span class="mi">210</span><span class="p">)</span>
<a name="ln-4421"></a>                    <span class="n">cErrorMsg</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cErrorMsg</span><span class="p">)</span>
<a name="ln-4422"></a>                    <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">cErrorMsg</span><span class="p">)</span>
<a name="ln-4423"></a>                <span class="n">ENDIF</span>
<a name="ln-4424"></a>                <span class="c">! Is the current line an Error message?</span>
<a name="ln-4425"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">cErrorLine</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;ERROR: &#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4426"></a><span class="k">                    </span><span class="n">cErrorMsg</span> <span class="o">=</span> <span class="n">cErrorLine</span><span class="p">(</span><span class="mi">8</span><span class="p">:</span><span class="mi">210</span><span class="p">)</span>
<a name="ln-4427"></a>                    <span class="n">cErrorMsg</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cErrorMsg</span><span class="p">)</span>
<a name="ln-4428"></a>                    <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">cErrorMsg</span><span class="p">)</span>
<a name="ln-4429"></a>                    <span class="n">iErrorFlag</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4430"></a>                <span class="n">ENDIF</span>
<a name="ln-4431"></a>            <span class="n">ENDDO</span>
<a name="ln-4432"></a>
<a name="ln-4433"></a>            <span class="c">! Close and Delete DElight Error File</span>
<a name="ln-4434"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">bRecordsOnErrFile</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4435"></a><span class="k">              Close</span> <span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">iDElightErrorFile</span><span class="p">,</span><span class="n">Status</span><span class="o">=</span><span class="s1">&#39;DELETE&#39;</span><span class="p">)</span>
<a name="ln-4436"></a>            <span class="k">ELSE</span>
<a name="ln-4437"></a><span class="k">              Close</span> <span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">iDElightErrorFile</span><span class="p">,</span><span class="n">Status</span><span class="o">=</span><span class="s1">&#39;DELETE&#39;</span><span class="p">)</span>
<a name="ln-4438"></a>            <span class="n">ENDIF</span>
<a name="ln-4439"></a>            <span class="c">! If any DElight Error occurred then ShowFatalError to terminate</span>
<a name="ln-4440"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">iErrorFlag</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4441"></a><span class="k">                </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4442"></a>            <span class="n">ENDIF</span>
<a name="ln-4443"></a>        <span class="k">ELSE</span>
<a name="ln-4444"></a>            <span class="c">! Open, Close, and Delete DElight Daylight Factors Error File for reading</span>
<a name="ln-4445"></a>            <span class="n">iDElightErrorFile</span><span class="o">=</span><span class="n">GetNewUnitNumber</span><span class="p">()</span>
<a name="ln-4446"></a>            <span class="k">Open</span> <span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">iDElightErrorFile</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;eplusout.delightdfdmp&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;READWRITE&#39;</span><span class="p">)</span>
<a name="ln-4447"></a>            <span class="k">Close</span> <span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">iDElightErrorFile</span><span class="p">,</span><span class="n">Status</span><span class="o">=</span><span class="s1">&#39;DELETE&#39;</span><span class="p">)</span>
<a name="ln-4448"></a>        <span class="n">ENDIF</span>
<a name="ln-4449"></a>        <span class="k">CALL </span><span class="n">SetupDElightOutput4EPlus</span>
<a name="ln-4450"></a>    <span class="n">ENDIF</span>
<a name="ln-4451"></a>    <span class="c">! RJH DElight Modification End - Calls to DElight preprocessing subroutines</span>
<a name="ln-4452"></a>
<a name="ln-4453"></a>    <span class="c">! TH 6/3/2010, added to report daylight factors</span>
<a name="ln-4454"></a>    <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Output:DaylightFactors&#39;</span>
<a name="ln-4455"></a>    <span class="n">NumReports</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-4456"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumReports</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4457"></a><span class="k">      CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumNames</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4458"></a>                     <span class="n">IOStat</span><span class="p">,</span> <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4459"></a>                     <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-4460"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;SIZINGDAYS&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4461"></a><span class="k">        </span><span class="n">DFSReportSizingDays</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4462"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="mi">1</span><span class="p">:</span><span class="mi">24</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;ALLSHADOWCALCULATIONDAYS&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4463"></a><span class="k">        </span><span class="n">DFSReportAllShadowCalculationDays</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4464"></a>      <span class="n">ENDIF</span>
<a name="ln-4465"></a>    <span class="n">ENDIF</span>
<a name="ln-4466"></a>
<a name="ln-4467"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Program terminated for above reasons&#39;</span><span class="p">)</span>
<a name="ln-4468"></a>
<a name="ln-4469"></a>  <span class="k">RETURN</span>
<a name="ln-4470"></a>
<a name="ln-4471"></a><span class="k">END SUBROUTINE </span><span class="n">GetDaylightingParametersInput</span>
<a name="ln-4472"></a>
<a name="ln-4473"></a><span class="k">SUBROUTINE </span><span class="n">GetDaylightingParametersDetaild</span><span class="p">(</span><span class="n">TotDaylightingDetailed</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-4474"></a>
<a name="ln-4475"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4476"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-4477"></a>          <span class="c">!       DATE WRITTEN   March 2002</span>
<a name="ln-4478"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4479"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4480"></a>
<a name="ln-4481"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4482"></a>          <span class="c">! Obtain the user input data for Daylighting:Detailed objects in the input file.</span>
<a name="ln-4483"></a>          <span class="c">! For detailed daylighting, a calculation of interior daylight illuminance is done at one</span>
<a name="ln-4484"></a>          <span class="c">!    or two reference points; the illuminance level, setpoint and type of control</span>
<a name="ln-4485"></a>          <span class="c">!    system determines lighting power reduction.</span>
<a name="ln-4486"></a>
<a name="ln-4487"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4488"></a>          <span class="c">! na</span>
<a name="ln-4489"></a>
<a name="ln-4490"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4491"></a>          <span class="c">! none</span>
<a name="ln-4492"></a>
<a name="ln-4493"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4494"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-4495"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">FindIteminList</span>
<a name="ln-4496"></a>  <span class="k">USE </span><span class="n">DataStringGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CharSpace</span><span class="p">,</span> <span class="n">CharComma</span><span class="p">,</span> <span class="n">CharTab</span>
<a name="ln-4497"></a>  <span class="k">USE </span><span class="n">InternalHeatGains</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CheckLightsReplaceableMinMaxForZone</span><span class="p">,</span> <span class="n">GetDesignLightingLevelForZone</span>
<a name="ln-4498"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-4499"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-4500"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span>
<a name="ln-4501"></a>
<a name="ln-4502"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4503"></a>
<a name="ln-4504"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4505"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotDaylightingDetailed</span> <span class="c">! Total &quot;simple&quot; daylighting inputs</span>
<a name="ln-4506"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-4507"></a>
<a name="ln-4508"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4509"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-4510"></a>
<a name="ln-4511"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS: na</span>
<a name="ln-4512"></a>          <span class="c">! DERIVED TYPE DEFINITIONS: na</span>
<a name="ln-4513"></a>
<a name="ln-4514"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4515"></a>  <span class="kt">INTEGER</span>                                    <span class="kd">::</span> <span class="n">IOStat</span>
<a name="ln-4516"></a>  <span class="kt">INTEGER</span>                                    <span class="kd">::</span> <span class="n">Loop1</span>
<a name="ln-4517"></a>  <span class="kt">INTEGER</span>                                    <span class="kd">::</span> <span class="n">MapStyleIn</span>
<a name="ln-4518"></a>  <span class="kt">INTEGER</span>                                    <span class="kd">::</span> <span class="n">NumAlpha</span>
<a name="ln-4519"></a>  <span class="kt">INTEGER</span>                                    <span class="kd">::</span> <span class="n">NumNumber</span>
<a name="ln-4520"></a>  <span class="kt">INTEGER</span>                                    <span class="kd">::</span> <span class="n">ZoneNum</span>
<a name="ln-4521"></a>  <span class="kt">INTEGER</span>                                    <span class="kd">::</span> <span class="n">MapNum</span>
<a name="ln-4522"></a>  <span class="kt">INTEGER</span>                                    <span class="kd">::</span> <span class="n">RefPt</span>
<a name="ln-4523"></a>  <span class="kt">INTEGER</span>                                    <span class="kd">::</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span>
<a name="ln-4524"></a>  <span class="kt">INTEGER</span>                                    <span class="kd">::</span> <span class="n">SurfLoop</span>
<a name="ln-4525"></a>  <span class="kt">INTEGER</span>                                    <span class="kd">::</span> <span class="n">AddMapPoints</span>
<a name="ln-4526"></a>  <span class="kt">INTEGER</span>                                    <span class="kd">::</span> <span class="n">ZoneFound</span>
<a name="ln-4527"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">refName</span>
<a name="ln-4528"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosBldgRelNorth</span>        <span class="c">! Cosine of Building rotation</span>
<a name="ln-4529"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SinBldgRelNorth</span>        <span class="c">! Sine of Building rotation</span>
<a name="ln-4530"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosZoneRelNorth</span>        <span class="c">! Cosine of Zone rotation</span>
<a name="ln-4531"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SinZoneRelNorth</span>        <span class="c">! Sine of Zone rotation</span>
<a name="ln-4532"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosBldgRotAppGonly</span> <span class="o">=</span><span class="mf">0.0D0</span> <span class="c">! Cosine of the building rotation for appendix G only (relative north)</span>
<a name="ln-4533"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SinBldgRotAppGonly</span> <span class="o">=</span><span class="mf">0.0D0</span> <span class="c">! Sine of the building rotation for appendix G only (relative north)</span>
<a name="ln-4534"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Xb</span>                     <span class="c">! temp var for transformation calc</span>
<a name="ln-4535"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Yb</span>                     <span class="c">! temp var for transformation calc</span>
<a name="ln-4536"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Xo</span><span class="p">,</span> <span class="n">XnoRot</span><span class="p">,</span> <span class="n">Xtrans</span>
<a name="ln-4537"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Yo</span><span class="p">,</span> <span class="n">YnoRot</span><span class="p">,</span> <span class="n">Ytrans</span>
<a name="ln-4538"></a>  <span class="kt">Logical</span>   <span class="kd">::</span> <span class="n">doTransform</span>
<a name="ln-4539"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OldAspectRatio</span>
<a name="ln-4540"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NewAspectRatio</span>
<a name="ln-4541"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rLightLevel</span>
<a name="ln-4542"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ZoneMsgDone</span>
<a name="ln-4543"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ZoneMapCount</span>
<a name="ln-4544"></a>
<a name="ln-4545"></a>          <span class="c">! FLOW:</span>
<a name="ln-4546"></a>
<a name="ln-4547"></a>    <span class="c">! Calc cos and sin of Building Relative North values for later use in transforming Reference Point coordinates</span>
<a name="ln-4548"></a>    <span class="n">CosBldgRelNorth</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">BuildingAzimuth</span> <span class="o">+</span> <span class="n">BuildingRotationAppendixG</span><span class="p">)</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-4549"></a>    <span class="n">SinBldgRelNorth</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">BuildingAzimuth</span> <span class="o">+</span> <span class="n">BuildingRotationAppendixG</span><span class="p">)</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-4550"></a>    <span class="c">! these are only for Building Rotation for Appendix G when using world coordinate system</span>
<a name="ln-4551"></a>    <span class="n">CosBldgRotAppGonly</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="o">-</span><span class="n">BuildingRotationAppendixG</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-4552"></a>    <span class="n">SinBldgRotAppGonly</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="o">-</span><span class="n">BuildingRotationAppendixG</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-4553"></a>
<a name="ln-4554"></a>  <span class="n">doTransform</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4555"></a>  <span class="n">OldAspectRatio</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-4556"></a>  <span class="n">NewAspectRatio</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-4557"></a>
<a name="ln-4558"></a>  <span class="k">CALL </span><span class="n">CheckForGeometricTransform</span><span class="p">(</span><span class="n">DoTransform</span><span class="p">,</span><span class="n">OldAspectRatio</span><span class="p">,</span><span class="n">NewAspectRatio</span><span class="p">)</span>
<a name="ln-4559"></a>
<a name="ln-4560"></a>  <span class="c">! Get and initialize illuminance map objects</span>
<a name="ln-4561"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Output:IlluminanceMap&#39;</span>
<a name="ln-4562"></a>  <span class="n">TotIllumMaps</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-4563"></a>
<a name="ln-4564"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">TotIllumMaps</span><span class="p">))</span>
<a name="ln-4565"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">TotIllumMaps</span><span class="p">))</span>
<a name="ln-4566"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneMapCount</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-4567"></a>  <span class="n">ZoneMapCount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4568"></a>
<a name="ln-4569"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TotIllumMaps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4570"></a><span class="k">    DO </span><span class="n">MapNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotIllumMaps</span>
<a name="ln-4571"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">MapNum</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlpha</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumber</span><span class="p">,</span><span class="n">IOStat</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4572"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4573"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-4574"></a>      <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4575"></a>      <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">=</span> <span class="n">FindIteminList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-4576"></a>
<a name="ln-4577"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4578"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4579"></a>                             <span class="s1">&#39;&quot;, invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4580"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4581"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4582"></a>      <span class="n">ENDIF</span>
<a name="ln-4583"></a>
<a name="ln-4584"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="o">=</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-4585"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4586"></a><span class="k">        </span><span class="n">ZoneMapCount</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span><span class="o">=</span><span class="n">ZoneMapCount</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4587"></a>      <span class="n">ENDIF</span>
<a name="ln-4588"></a>      <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Z</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4589"></a>
<a name="ln-4590"></a>      <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xmin</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4591"></a>      <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xmax</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4592"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4593"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4594"></a>                             <span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-4595"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4596"></a>                    <span class="s1">&#39;] must be &lt;= &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-4597"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4598"></a>      <span class="n">ENDIF</span>
<a name="ln-4599"></a>      <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-4600"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4601"></a><span class="k">        </span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xinc</span> <span class="o">=</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xmax</span> <span class="o">-</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xmin</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-4602"></a>      <span class="k">ELSE</span>
<a name="ln-4603"></a><span class="k">        </span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xinc</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4604"></a>      <span class="n">ENDIF</span>
<a name="ln-4605"></a>
<a name="ln-4606"></a>      <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ymin</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4607"></a>      <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ymax</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4608"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4609"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4610"></a>                             <span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-4611"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4612"></a>                    <span class="s1">&#39;] must be &lt;= &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-4613"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4614"></a>      <span class="n">ENDIF</span>
<a name="ln-4615"></a>      <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ynum</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-4616"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ynum</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4617"></a><span class="k">        </span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Yinc</span> <span class="o">=</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ymax</span> <span class="o">-</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ymin</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ynum</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-4618"></a>      <span class="k">ELSE</span>
<a name="ln-4619"></a><span class="k">        </span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Yinc</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4620"></a>      <span class="n">ENDIF</span>
<a name="ln-4621"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span><span class="o">*</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ynum</span> <span class="o">&gt;</span> <span class="n">MaxMapRefPoints</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4622"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4623"></a>                             <span class="s1">&#39;&quot;, too many map points specified.&#39;</span><span class="p">)</span>
<a name="ln-4624"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4625"></a>                    <span class="s1">&#39;] * &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ynum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4626"></a>                    <span class="s1">&#39;= [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span><span class="o">*</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ynum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] must be &lt;= [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4627"></a>                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxMapRefPoints</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-4628"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4629"></a>      <span class="n">ENDIF</span>
<a name="ln-4630"></a>    <span class="k">END DO</span> <span class="c">! MapNum</span>
<a name="ln-4631"></a>
<a name="ln-4632"></a>    <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;OutputControl:IlluminanceMap:Style&#39;</span>
<a name="ln-4633"></a>    <span class="n">MapStyleIn</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-4634"></a>
<a name="ln-4635"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MapStyleIn</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4636"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;COMMA&#39;</span>
<a name="ln-4637"></a>      <span class="n">MapColSep</span> <span class="o">=</span> <span class="n">CharComma</span> <span class="c">!comma</span>
<a name="ln-4638"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">MapStyleIn</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4639"></a><span class="k">      CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlpha</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumber</span><span class="p">,</span><span class="n">IOStat</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4640"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4641"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-4642"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;COMMA&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4643"></a><span class="k">        </span><span class="n">MapColSep</span> <span class="o">=</span> <span class="n">CharComma</span> <span class="c">!comma</span>
<a name="ln-4644"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;TAB&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4645"></a><span class="k">        </span><span class="n">MapColSep</span> <span class="o">=</span> <span class="n">CharTab</span>  <span class="c">!tab</span>
<a name="ln-4646"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;FIXED&#39;</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;SPACE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4647"></a><span class="k">        </span><span class="n">MapColSep</span> <span class="o">=</span> <span class="n">CharSpace</span> <span class="c">! space</span>
<a name="ln-4648"></a>      <span class="k">ELSE</span>
<a name="ln-4649"></a><span class="k">        </span><span class="n">MapColSep</span> <span class="o">=</span> <span class="n">CharComma</span> <span class="c">!comma</span>
<a name="ln-4650"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4651"></a>                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, Commas will be used to separate fields.&#39;</span><span class="p">)</span>
<a name="ln-4652"></a>        <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;COMMA&#39;</span>
<a name="ln-4653"></a>      <span class="n">ENDIF</span>
<a name="ln-4654"></a>    <span class="n">ENDIF</span>
<a name="ln-4655"></a>    <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Daylighting:Illuminance Maps&gt;,#Maps,Style&#39;</span>
<a name="ln-4656"></a>    <span class="k">CALL </span><span class="n">ConvertCaseToLower</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4657"></a>    <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="mi">2</span><span class="p">:)</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="mi">2</span><span class="p">:)</span>
<a name="ln-4658"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s2">&quot;(&#39;Daylighting:Illuminance Maps,&#39;,A,&#39;,&#39;,A)&quot;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TotIllumMaps</span><span class="p">)),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4659"></a>
<a name="ln-4660"></a>  <span class="k">END IF</span>
<a name="ln-4661"></a>
<a name="ln-4662"></a><span class="k">  DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-4663"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">ZoneToMap</span><span class="p">(</span><span class="n">ZoneMapCount</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)))</span>
<a name="ln-4664"></a>    <span class="n">ZoneDayLight</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">ZoneToMap</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4665"></a>    <span class="n">ZoneDayLight</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">MapCount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4666"></a>  <span class="n">ENDDO</span>
<a name="ln-4667"></a>
<a name="ln-4668"></a>  <span class="k">DO </span><span class="n">MapNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotIllumMaps</span>
<a name="ln-4669"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4670"></a><span class="k">    </span><span class="n">ZoneDayLight</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">MapCount</span><span class="o">=</span><span class="n">ZoneDayLight</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">MapCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4671"></a>    <span class="n">ZoneDayLight</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">ZoneToMap</span><span class="p">(</span><span class="n">ZoneDayLight</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">MapCount</span><span class="p">)</span><span class="o">=</span><span class="n">MapNum</span>
<a name="ln-4672"></a>  <span class="n">ENDDO</span>
<a name="ln-4673"></a>
<a name="ln-4674"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">ZoneMapCount</span><span class="p">)</span>
<a name="ln-4675"></a>
<a name="ln-4676"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;Daylighting:Controls&#39;</span>
<a name="ln-4677"></a>  <span class="k">DO </span><span class="n">Loop1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotDaylightingDetailed</span>
<a name="ln-4678"></a>    <span class="n">cAlphaArgs</span><span class="o">=</span><span class="s1">&#39;  &#39;</span>
<a name="ln-4679"></a>    <span class="n">rNumericArgs</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4680"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop1</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlpha</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumber</span><span class="p">,</span><span class="n">IOStat</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4681"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4682"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-4683"></a>    <span class="c">! First is Zone Name</span>
<a name="ln-4684"></a>    <span class="n">ZoneFound</span><span class="o">=</span><span class="n">FindIteminList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-4685"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneFound</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4686"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4687"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-4688"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4689"></a>      <span class="k">CYCLE</span>
<a name="ln-4690"></a><span class="k">    END IF</span>
<a name="ln-4691"></a>
<a name="ln-4692"></a>    <span class="c">! Calc cos and sin of Zone Relative North values for later use in transforming Reference Point coordinates</span>
<a name="ln-4693"></a>    <span class="n">CosZoneRelNorth</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="o">-</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">RelNorth</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-4694"></a>    <span class="n">SinZoneRelNorth</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="o">-</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">RelNorth</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-4695"></a>
<a name="ln-4696"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylightType</span> <span class="o">/=</span> <span class="n">NoDaylighting</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4697"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4698"></a>         <span class="s1">&#39;: Attempted to apply Detailed Daylighting to a Zone with Previous Daylighting&#39;</span><span class="p">)</span>
<a name="ln-4699"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error discovered for Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4700"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Previously applied Daylighting Type=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DaylightTypes</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylightType</span><span class="p">)))</span>
<a name="ln-4701"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4702"></a>      <span class="k">CYCLE</span>
<a name="ln-4703"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-4704"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylightType</span><span class="o">=</span><span class="n">DetailedDaylighting</span>
<a name="ln-4705"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4706"></a>
<a name="ln-4707"></a>    <span class="n">rLightLevel</span><span class="o">=</span><span class="n">GetDesignLightingLevelForZone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)</span>
<a name="ln-4708"></a>    <span class="k">CALL </span><span class="n">CheckLightsReplaceableMinMaxForZone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)</span>
<a name="ln-4709"></a>
<a name="ln-4710"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-4711"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span>   <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4712"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtInBounds</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">))</span>
<a name="ln-4713"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtInBounds</span>   <span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4714"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">FracZoneDaylit</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">))</span>
<a name="ln-4715"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">FracZoneDaylit</span>       <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4716"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">IllumSetPoint</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">))</span>
<a name="ln-4717"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">IllumSetPoint</span>        <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4718"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">RefPtPowerReductionFactor</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">))</span>
<a name="ln-4719"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">RefPtPowerReductionFactor</span> <span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-4720"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylIllumAtRefPt</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">))</span>
<a name="ln-4721"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylIllumAtRefPt</span>     <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4722"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">GlareIndexAtRefPt</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">))</span>
<a name="ln-4723"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">GlareIndexAtRefPt</span>    <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4724"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">BacLum</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">))</span>
<a name="ln-4725"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">BacLum</span>               <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4726"></a>
<a name="ln-4727"></a>    <span class="c">!added TH 12/2/2008</span>
<a name="ln-4728"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">TimeExceedingGlareIndexSPAtRefPt</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">))</span>
<a name="ln-4729"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">TimeExceedingGlareIndexSPAtRefPt</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4730"></a>
<a name="ln-4731"></a>    <span class="c">!added TH 7/6/2009</span>
<a name="ln-4732"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">TimeExceedingDaylightIlluminanceSPAtRefPt</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">))</span>
<a name="ln-4733"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">TimeExceedingDaylightIlluminanceSPAtRefPt</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4734"></a>
<a name="ln-4735"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4736"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DaylRefWorldCoordSystem</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4737"></a>        <span class="c">!transform only by appendix G rotation</span>
<a name="ln-4738"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">CosBldgRotAppGonly</span> <span class="o">-</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">SinBldgRotAppGonly</span>
<a name="ln-4739"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">SinBldgRotAppGonly</span> <span class="o">+</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">CosBldgRotAppGonly</span>
<a name="ln-4740"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-4741"></a>      <span class="k">ELSE</span>
<a name="ln-4742"></a>        <span class="c">!Transform reference point coordinates into building coordinate system</span>
<a name="ln-4743"></a>        <span class="n">Xb</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">CosZoneRelNorth</span> <span class="p">&amp;</span>
<a name="ln-4744"></a>            <span class="o">-</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">SinZoneRelNorth</span> <span class="p">&amp;</span>
<a name="ln-4745"></a>            <span class="o">+</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">OriginX</span>
<a name="ln-4746"></a>        <span class="n">Yb</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">SinZoneRelNorth</span> <span class="p">&amp;</span>
<a name="ln-4747"></a>            <span class="o">+</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">CosZoneRelNorth</span> <span class="p">&amp;</span>
<a name="ln-4748"></a>            <span class="o">+</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">OriginY</span>
<a name="ln-4749"></a>        <span class="c">!Transform into World Coordinate System</span>
<a name="ln-4750"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">CosBldgRelNorth</span> <span class="o">-</span> <span class="n">Yb</span><span class="o">*</span><span class="n">SinBldgRelNorth</span>
<a name="ln-4751"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">SinBldgRelNorth</span> <span class="o">+</span> <span class="n">Yb</span><span class="o">*</span><span class="n">CosBldgRelNorth</span>
<a name="ln-4752"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4753"></a>                                <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">OriginZ</span>
<a name="ln-4754"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">doTransform</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4755"></a><span class="k">          </span><span class="n">Xo</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c">! world coordinates.... shifted by relative north angle...</span>
<a name="ln-4756"></a>          <span class="n">Yo</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4757"></a>          <span class="c">! next derotate the building</span>
<a name="ln-4758"></a>          <span class="n">XnoRot</span><span class="o">=</span><span class="n">Xo</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span> <span class="o">+</span> <span class="n">Yo</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span>
<a name="ln-4759"></a>          <span class="n">YnoRot</span><span class="o">=</span><span class="n">Yo</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span> <span class="o">-</span> <span class="n">Xo</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span>
<a name="ln-4760"></a>          <span class="c">! translate</span>
<a name="ln-4761"></a>          <span class="n">Xtrans</span> <span class="o">=</span> <span class="n">XnoRot</span> <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">NewAspectRatio</span><span class="o">/</span><span class="n">OldAspectRatio</span><span class="p">)</span>
<a name="ln-4762"></a>          <span class="n">Ytrans</span> <span class="o">=</span> <span class="n">YnoRot</span> <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">OldAspectRatio</span><span class="o">/</span><span class="n">NewAspectRatio</span><span class="p">)</span>
<a name="ln-4763"></a>          <span class="c">! rerotate</span>
<a name="ln-4764"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Xtrans</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span> <span class="o">-</span> <span class="n">Ytrans</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span>
<a name="ln-4765"></a>
<a name="ln-4766"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Xtrans</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span> <span class="o">+</span> <span class="n">Ytrans</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span>
<a name="ln-4767"></a>        <span class="n">ENDIF</span>
<a name="ln-4768"></a>      <span class="n">ENDIF</span>
<a name="ln-4769"></a>      <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">FracZoneDaylit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-4770"></a>      <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">IllumSetPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-4771"></a>    <span class="n">ENDIF</span>
<a name="ln-4772"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4773"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DaylRefWorldCoordSystem</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4774"></a>        <span class="c">!transform only by appendix G rotation</span>
<a name="ln-4775"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">CosBldgRotAppGonly</span> <span class="o">-</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">SinBldgRotAppGonly</span>
<a name="ln-4776"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">SinBldgRotAppGonly</span> <span class="o">+</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">CosBldgRotAppGonly</span>
<a name="ln-4777"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-4778"></a>      <span class="k">ELSE</span>
<a name="ln-4779"></a>        <span class="c">!Transform reference point coordinates into building coordinate system</span>
<a name="ln-4780"></a>        <span class="n">Xb</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">CosZoneRelNorth</span> <span class="p">&amp;</span>
<a name="ln-4781"></a>            <span class="o">-</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">SinZoneRelNorth</span> <span class="p">&amp;</span>
<a name="ln-4782"></a>            <span class="o">+</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">OriginX</span>
<a name="ln-4783"></a>        <span class="n">Yb</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">SinZoneRelNorth</span> <span class="p">&amp;</span>
<a name="ln-4784"></a>            <span class="o">+</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">CosZoneRelNorth</span> <span class="p">&amp;</span>
<a name="ln-4785"></a>            <span class="o">+</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">OriginY</span>
<a name="ln-4786"></a>        <span class="c">!Transform into World Coordinate System</span>
<a name="ln-4787"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">CosBldgRelNorth</span> <span class="o">-</span> <span class="n">Yb</span><span class="o">*</span><span class="n">SinBldgRelNorth</span>
<a name="ln-4788"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Xb</span><span class="o">*</span><span class="n">SinBldgRelNorth</span> <span class="o">+</span> <span class="n">Yb</span><span class="o">*</span><span class="n">CosBldgRelNorth</span>
<a name="ln-4789"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4790"></a>                                <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">OriginZ</span>
<a name="ln-4791"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">doTransform</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4792"></a><span class="k">          </span><span class="n">Xo</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c">! world coordinates.... shifted by relative north angle...</span>
<a name="ln-4793"></a>          <span class="n">Yo</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4794"></a>          <span class="c">! next derotate the building</span>
<a name="ln-4795"></a>          <span class="n">XnoRot</span><span class="o">=</span><span class="n">Xo</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span> <span class="o">+</span> <span class="n">Yo</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span>
<a name="ln-4796"></a>          <span class="n">YnoRot</span><span class="o">=</span><span class="n">Yo</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span> <span class="o">-</span> <span class="n">Xo</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span>
<a name="ln-4797"></a>          <span class="c">! translate</span>
<a name="ln-4798"></a>          <span class="n">Xtrans</span> <span class="o">=</span> <span class="n">XnoRot</span> <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">NewAspectRatio</span><span class="o">/</span><span class="n">OldAspectRatio</span><span class="p">)</span>
<a name="ln-4799"></a>          <span class="n">Ytrans</span> <span class="o">=</span> <span class="n">YnoRot</span> <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">OldAspectRatio</span><span class="o">/</span><span class="n">NewAspectRatio</span><span class="p">)</span>
<a name="ln-4800"></a>          <span class="c">! rerotate</span>
<a name="ln-4801"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Xtrans</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span> <span class="o">-</span> <span class="n">Ytrans</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span>
<a name="ln-4802"></a>
<a name="ln-4803"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Xtrans</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span> <span class="o">+</span> <span class="n">Ytrans</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span>
<a name="ln-4804"></a>        <span class="n">ENDIF</span>
<a name="ln-4805"></a>      <span class="n">ENDIF</span>
<a name="ln-4806"></a>      <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">FracZoneDaylit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-4807"></a>      <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">IllumSetPoint</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-4808"></a>    <span class="n">ENDIF</span>
<a name="ln-4809"></a>    <span class="k">do </span><span class="n">refpt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span>
<a name="ln-4810"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumX</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-4811"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumX</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4812"></a><span class="k">        </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptInBounds</span><span class="p">(</span><span class="n">refpt</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4813"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GetDetailedDaylighting: Reference point X Value outside Zone Min/Max X, Zone=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4814"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4815"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...X Reference Point= &#39;</span><span class="o">//</span>                                                        <span class="p">&amp;</span>
<a name="ln-4816"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Zone Minimum X= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4817"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumX</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Zone Maximum X= &#39;</span><span class="o">//</span>                             <span class="p">&amp;</span>
<a name="ln-4818"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumX</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-4819"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumX</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4820"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...X Reference Distance Outside MinimumX= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4821"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumX</span><span class="o">-</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m.&#39;</span><span class="p">)</span>
<a name="ln-4822"></a>        <span class="k">ELSE</span>
<a name="ln-4823"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...X Reference Distance Outside MaximumX= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4824"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumX</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m.&#39;</span><span class="p">)</span>
<a name="ln-4825"></a>        <span class="n">ENDIF</span>
<a name="ln-4826"></a>      <span class="n">ENDIF</span>
<a name="ln-4827"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumY</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-4828"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumY</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4829"></a><span class="k">        </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptInBounds</span><span class="p">(</span><span class="n">refpt</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4830"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GetDetailedDaylighting: Reference point Y Value outside Zone Min/Max Y, Zone=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4831"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4832"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Y Reference Point= &#39;</span><span class="o">//</span>                                                        <span class="p">&amp;</span>
<a name="ln-4833"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Zone Minimum Y= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4834"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumY</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Zone Maximum Y= &#39;</span><span class="o">//</span>                             <span class="p">&amp;</span>
<a name="ln-4835"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumY</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-4836"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumY</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4837"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Y Reference Distance Outside MinimumY= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4838"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumY</span><span class="o">-</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m.&#39;</span><span class="p">)</span>
<a name="ln-4839"></a>        <span class="k">ELSE</span>
<a name="ln-4840"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Y Reference Distance Outside MaximumY= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4841"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumY</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m.&#39;</span><span class="p">)</span>
<a name="ln-4842"></a>        <span class="n">ENDIF</span>
<a name="ln-4843"></a>      <span class="n">ENDIF</span>
<a name="ln-4844"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumZ</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-4845"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumZ</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4846"></a><span class="k">        </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptInBounds</span><span class="p">(</span><span class="n">refpt</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4847"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GetDetailedDaylighting: Reference point Z Value outside Zone Min/Max Z, Zone=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4848"></a>             <span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4849"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Z Reference Point= &#39;</span><span class="o">//</span>                                                        <span class="p">&amp;</span>
<a name="ln-4850"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Zone Minimum Z= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4851"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumZ</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Zone Maximum Z= &#39;</span><span class="o">//</span>                             <span class="p">&amp;</span>
<a name="ln-4852"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumZ</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-4853"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumZ</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4854"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Z Reference Distance Outside MinimumZ= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4855"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumZ</span><span class="o">-</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m.&#39;</span><span class="p">)</span>
<a name="ln-4856"></a>        <span class="k">ELSE</span>
<a name="ln-4857"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Z Reference Distance Outside MaximumZ= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4858"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">DaylrefptAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumZ</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m.&#39;</span><span class="p">)</span>
<a name="ln-4859"></a>        <span class="n">ENDIF</span>
<a name="ln-4860"></a>      <span class="n">ENDIF</span>
<a name="ln-4861"></a>    <span class="k">END DO</span> <span class="c">! RefPt</span>
<a name="ln-4862"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">SUM</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">FracZoneDaylit</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4863"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GetDetailedDaylighting: Fraction of Zone controlled by the Daylighting reference points is &lt; 1.0.&#39;</span><span class="p">)</span>
<a name="ln-4864"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..discovered in &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; for Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, only &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4865"></a>                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">SUM</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">FracZoneDaylit</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; of the zone is controlled.&#39;</span><span class="p">)</span>
<a name="ln-4866"></a>    <span class="n">ENDIF</span>
<a name="ln-4867"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">SUM</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">FracZoneDaylit</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4868"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetDetailedDaylighting: Fraction of Zone controlled by the Daylighting reference points is &gt; 1.0.&#39;</span><span class="p">)</span>
<a name="ln-4869"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..discovered in &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; for Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4870"></a>         <span class="s1">&#39;&quot;, trying to control &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">SUM</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">FracZoneDaylit</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; of the zone.&#39;</span><span class="p">)</span>
<a name="ln-4871"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4872"></a>    <span class="n">ENDIF</span>
<a name="ln-4873"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">LightControlType</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>  <span class="c">! Relies on IDD limits for verification</span>
<a name="ln-4874"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">ViewAzimuthForGlare</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-4875"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaxGlareallowed</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-4876"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinPowerFraction</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-4877"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinLightFraction</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-4878"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">LightControlSteps</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-4879"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">LightControlType</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">LightControlSteps</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4880"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GetDetailedDaylighting: For Stepped Control, the number of steps must be &gt; 0&#39;</span><span class="p">)</span>
<a name="ln-4881"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..discovered in &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; for Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4882"></a>         <span class="s1">&#39;&quot;, will use 1&#39;</span><span class="p">)</span>
<a name="ln-4883"></a>      <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">LightControlSteps</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-4884"></a>    <span class="n">ENDIF</span>
<a name="ln-4885"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">LightControlProbability</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-4886"></a>
<a name="ln-4887"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4888"></a><span class="k">      </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">AvailSchedNum</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4889"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">AvailSchedNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4890"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-4891"></a>                              <span class="o">//</span><span class="s1">&#39;, occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;object for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4892"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-4893"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Schedule was not found so controls will always be available, and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-4894"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">AvailSchedNum</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-4895"></a>      <span class="n">ENDIF</span>
<a name="ln-4896"></a>    <span class="k">ELSE</span>
<a name="ln-4897"></a><span class="k">      </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">AvailSchedNum</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-4898"></a>    <span class="n">ENDIF</span>
<a name="ln-4899"></a>
<a name="ln-4900"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4901"></a><span class="k">      </span><span class="n">refName</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; - REF 1&#39;</span>
<a name="ln-4902"></a>      <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDyLtZone</span><span class="p">,</span><span class="n">refName</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4903"></a>      <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDyLtKind</span><span class="p">,</span><span class="n">refName</span><span class="p">,</span><span class="s1">&#39;Detailed&#39;</span><span class="p">)</span>
<a name="ln-4904"></a>      <span class="c">! (1=continuous, 2=stepped, 3=continuous/off)</span>
<a name="ln-4905"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">LightControlType</span><span class="p">)</span>
<a name="ln-4906"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4907"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDyLtCtrl</span><span class="p">,</span><span class="n">refName</span><span class="p">,</span><span class="s1">&#39;Continuous&#39;</span><span class="p">)</span>
<a name="ln-4908"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4909"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDyLtCtrl</span><span class="p">,</span><span class="n">refName</span><span class="p">,</span><span class="s1">&#39;Stepped&#39;</span><span class="p">)</span>
<a name="ln-4910"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4911"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDyLtCtrl</span><span class="p">,</span><span class="n">refName</span><span class="p">,</span><span class="s1">&#39;Continuous/Off&#39;</span><span class="p">)</span>
<a name="ln-4912"></a>      <span class="k">END SELECT</span>
<a name="ln-4913"></a><span class="k">      CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDyLtFrac</span><span class="p">,</span><span class="n">refName</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">FracZoneDaylit</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4914"></a>      <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDyLtWInst</span><span class="p">,</span> <span class="n">refName</span><span class="p">,</span> <span class="n">rLightLevel</span><span class="p">)</span>
<a name="ln-4915"></a>      <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDyLtWCtrl</span><span class="p">,</span> <span class="n">refName</span><span class="p">,</span> <span class="n">rLightLevel</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">FracZoneDaylit</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4916"></a>    <span class="k">END IF</span>
<a name="ln-4917"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4918"></a><span class="k">      </span><span class="n">refName</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; - REF 2&#39;</span>
<a name="ln-4919"></a>      <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDyLtZone</span><span class="p">,</span><span class="n">refName</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4920"></a>      <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDyLtKind</span><span class="p">,</span><span class="n">refName</span><span class="p">,</span><span class="s1">&#39;Detailed&#39;</span><span class="p">)</span>
<a name="ln-4921"></a>      <span class="c">! (1=continuous, 2=stepped, 3=continuous/off)</span>
<a name="ln-4922"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">LightControlType</span><span class="p">)</span>
<a name="ln-4923"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4924"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDyLtCtrl</span><span class="p">,</span><span class="n">refName</span><span class="p">,</span><span class="s1">&#39;Continuous&#39;</span><span class="p">)</span>
<a name="ln-4925"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4926"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDyLtCtrl</span><span class="p">,</span><span class="n">refName</span><span class="p">,</span><span class="s1">&#39;Stepped&#39;</span><span class="p">)</span>
<a name="ln-4927"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4928"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDyLtCtrl</span><span class="p">,</span><span class="n">refName</span><span class="p">,</span><span class="s1">&#39;Continuous/Off&#39;</span><span class="p">)</span>
<a name="ln-4929"></a>      <span class="k">END SELECT</span>
<a name="ln-4930"></a><span class="k">      CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDyLtFrac</span><span class="p">,</span><span class="n">refName</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">FracZoneDaylit</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4931"></a>      <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDyLtWInst</span><span class="p">,</span> <span class="n">refName</span><span class="p">,</span> <span class="n">rLightLevel</span><span class="p">)</span>
<a name="ln-4932"></a>      <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchDyLtWCtrl</span><span class="p">,</span> <span class="n">refName</span><span class="p">,</span> <span class="n">rLightLevel</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">FracZoneDaylit</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4933"></a>    <span class="k">END IF</span>
<a name="ln-4934"></a>
<a name="ln-4935"></a>    <span class="c">! Check for illuminance maps associated with this zone</span>
<a name="ln-4936"></a>    <span class="k">DO </span><span class="n">MapNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotIllumMaps</span>
<a name="ln-4937"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="n">ZoneFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4938"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span><span class="o">*</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ynum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-4939"></a>          <span class="c">! Add additional daylighting reference points for map</span>
<a name="ln-4940"></a>          <span class="n">AddMapPoints</span> <span class="o">=</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span><span class="o">*</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ynum</span>
<a name="ln-4941"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">TotalMapRefPoints</span><span class="o">=</span><span class="n">AddMapPoints</span>
<a name="ln-4942"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">AddMapPoints</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-4943"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4944"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtInBounds</span><span class="p">(</span><span class="n">AddMapPoints</span><span class="p">))</span>
<a name="ln-4945"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtInBounds</span>   <span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4946"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllumAtMapPt</span><span class="p">(</span><span class="n">AddMapPoints</span><span class="p">))</span>
<a name="ln-4947"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllumAtMapPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4948"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">GlareIndexAtMapPt</span><span class="p">(</span><span class="n">AddMapPoints</span><span class="p">))</span>
<a name="ln-4949"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">GlareIndexAtMapPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4950"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllumAtMapPtHr</span><span class="p">(</span><span class="n">AddMapPoints</span><span class="p">))</span>
<a name="ln-4951"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllumAtMapPtHr</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4952"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">GlareIndexAtMapPtHr</span><span class="p">(</span><span class="n">AddMapPoints</span><span class="p">))</span>
<a name="ln-4953"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">GlareIndexAtMapPtHr</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4954"></a>
<a name="ln-4955"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">AddMapPoints</span> <span class="o">&gt;</span> <span class="n">MaxMapRefPoints</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4956"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetDaylighting Parameters: Total Map Reference points entered is greater than maximum allowed.&#39;</span><span class="p">)</span>
<a name="ln-4957"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4958"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Maximum reference points allowed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4959"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxMapRefPoints</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4960"></a>                                   <span class="s1">&#39;, entered amount (when error first occurred)=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4961"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">AddMapPoints</span><span class="p">)))</span>
<a name="ln-4962"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4963"></a>            <span class="k">EXIT</span>
<a name="ln-4964"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-4965"></a>          <span class="n">RefPt</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-4966"></a>          <span class="c">! Calc cos and sin of Zone Relative North values for later use in transforming Map Point coordinates</span>
<a name="ln-4967"></a>          <span class="n">CosZoneRelNorth</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="o">-</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">RelNorth</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-4968"></a>          <span class="n">SinZoneRelNorth</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="o">-</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">RelNorth</span><span class="o">*</span><span class="n">DegToRadians</span><span class="p">)</span>
<a name="ln-4969"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4970"></a><span class="k">            </span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xinc</span> <span class="o">=</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xmax</span> <span class="o">-</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xmin</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-4971"></a>          <span class="k">ELSE</span>
<a name="ln-4972"></a><span class="k">            </span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xinc</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4973"></a>          <span class="n">ENDIF</span>
<a name="ln-4974"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ynum</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4975"></a><span class="k">            </span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Yinc</span> <span class="o">=</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ymax</span> <span class="o">-</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ymin</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ynum</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-4976"></a>          <span class="k">ELSE</span>
<a name="ln-4977"></a><span class="k">            </span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Yinc</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4978"></a>          <span class="n">ENDIF</span>
<a name="ln-4979"></a>
<a name="ln-4980"></a>          <span class="c">! Map points and increments are stored in AbsCoord and then that is operated on if relative coords entered.</span>
<a name="ln-4981"></a>          <span class="k">DO </span><span class="n">Y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ynum</span>
<a name="ln-4982"></a>            <span class="k">DO </span><span class="n">X</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span>
<a name="ln-4983"></a>              <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xmin</span> <span class="o">+</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xinc</span>
<a name="ln-4984"></a>              <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ymin</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Yinc</span>
<a name="ln-4985"></a>              <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-4986"></a>              <span class="n">RefPt</span> <span class="o">=</span> <span class="n">RefPt</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4987"></a>            <span class="n">ENDDO</span>
<a name="ln-4988"></a>          <span class="n">ENDDO</span>
<a name="ln-4989"></a>          <span class="n">RefPt</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-4990"></a>          <span class="k">DO </span><span class="n">Y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ynum</span>
<a name="ln-4991"></a>            <span class="k">DO </span><span class="n">X</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span>
<a name="ln-4992"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DaylRefWorldCoordSystem</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4993"></a><span class="k">                </span><span class="n">Xb</span> <span class="o">=</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">CosZoneRelNorth</span> <span class="p">&amp;</span>
<a name="ln-4994"></a>                     <span class="o">-</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">SinZoneRelNorth</span> <span class="p">&amp;</span>
<a name="ln-4995"></a>                     <span class="o">+</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">OriginX</span>
<a name="ln-4996"></a>                <span class="n">Yb</span> <span class="o">=</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">SinZoneRelNorth</span> <span class="p">&amp;</span>
<a name="ln-4997"></a>                     <span class="o">+</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">CosZoneRelNorth</span> <span class="p">&amp;</span>
<a name="ln-4998"></a>                     <span class="o">+</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">OriginY</span>
<a name="ln-4999"></a>                <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Xb</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span> <span class="o">-</span> <span class="n">Yb</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span>
<a name="ln-5000"></a>                <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Xb</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span> <span class="o">+</span> <span class="n">Yb</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span>
<a name="ln-5001"></a>                <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-5002"></a>                             <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">OriginZ</span>
<a name="ln-5003"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">doTransform</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5004"></a><span class="k">                  </span><span class="n">Xo</span> <span class="o">=</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c">! world coordinates.... shifted by relative north angle...</span>
<a name="ln-5005"></a>                  <span class="n">Yo</span> <span class="o">=</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5006"></a>                  <span class="c">! next derotate the building</span>
<a name="ln-5007"></a>                  <span class="n">XnoRot</span><span class="o">=</span><span class="n">Xo</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span> <span class="o">+</span> <span class="n">Yo</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span>
<a name="ln-5008"></a>                  <span class="n">YnoRot</span><span class="o">=</span><span class="n">Yo</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span> <span class="o">-</span> <span class="n">Xo</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span>
<a name="ln-5009"></a>                  <span class="c">! translate</span>
<a name="ln-5010"></a>                  <span class="n">Xtrans</span> <span class="o">=</span> <span class="n">XnoRot</span> <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">NewAspectRatio</span><span class="o">/</span><span class="n">OldAspectRatio</span><span class="p">)</span>
<a name="ln-5011"></a>                  <span class="n">Ytrans</span> <span class="o">=</span> <span class="n">YnoRot</span> <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">OldAspectRatio</span><span class="o">/</span><span class="n">NewAspectRatio</span><span class="p">)</span>
<a name="ln-5012"></a>                  <span class="c">! rerotate</span>
<a name="ln-5013"></a>                  <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Xtrans</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span> <span class="o">-</span> <span class="n">Ytrans</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span>
<a name="ln-5014"></a>
<a name="ln-5015"></a>                  <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Xtrans</span> <span class="o">*</span> <span class="n">SinBldgRelNorth</span> <span class="o">+</span> <span class="n">Ytrans</span> <span class="o">*</span> <span class="n">CosBldgRelNorth</span>
<a name="ln-5016"></a>                <span class="n">ENDIF</span>
<a name="ln-5017"></a>              <span class="k">ELSE</span>
<a name="ln-5018"></a><span class="k">                </span><span class="n">Xb</span> <span class="o">=</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5019"></a>                <span class="n">Yb</span> <span class="o">=</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5020"></a>                <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Xb</span> <span class="o">*</span> <span class="n">CosBldgRotAppGonly</span> <span class="o">-</span> <span class="n">Yb</span> <span class="o">*</span> <span class="n">SinBldgRotAppGonly</span>
<a name="ln-5021"></a>                <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Xb</span> <span class="o">*</span> <span class="n">SinBldgRotAppGonly</span> <span class="o">+</span> <span class="n">Yb</span> <span class="o">*</span> <span class="n">CosBldgRotAppGonly</span>
<a name="ln-5022"></a>              <span class="n">ENDIF</span>
<a name="ln-5023"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">RefPt</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5024"></a><span class="k">                </span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xmin</span><span class="o">=</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5025"></a>                <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ymin</span><span class="o">=</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5026"></a>                <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xmax</span><span class="o">=</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5027"></a>                <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ymax</span><span class="o">=</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5028"></a>                <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Z</span>   <span class="o">=</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-5029"></a>              <span class="n">ENDIF</span>
<a name="ln-5030"></a>              <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xmin</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xmin</span><span class="p">,</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-5031"></a>              <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ymin</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ymin</span><span class="p">,</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-5032"></a>              <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xmax</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xmax</span><span class="p">,</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-5033"></a>              <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ymax</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ymax</span><span class="p">,</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-5034"></a>              <span class="k">IF</span> <span class="p">((</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumX</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>          <span class="p">&amp;</span>
<a name="ln-5035"></a>                  <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumX</span> <span class="o">-</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5036"></a>                  <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumX</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>          <span class="p">&amp;</span>
<a name="ln-5037"></a>                  <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumX</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5038"></a>                  <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumY</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>          <span class="p">&amp;</span>
<a name="ln-5039"></a>                  <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumY</span> <span class="o">-</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5040"></a>                  <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumY</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>          <span class="p">&amp;</span>
<a name="ln-5041"></a>                  <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumY</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5042"></a>                  <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumZ</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>          <span class="p">&amp;</span>
<a name="ln-5043"></a>                  <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumZ</span> <span class="o">-</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5044"></a>                  <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumZ</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>          <span class="p">&amp;</span>
<a name="ln-5045"></a>                  <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumZ</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5046"></a><span class="k">                </span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtInBounds</span><span class="p">(</span><span class="n">RefPt</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5047"></a>              <span class="n">ENDIF</span>
<a name="ln-5048"></a>              <span class="c">! Test extremes of Map Points against Zone Min/Max</span>
<a name="ln-5049"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">RefPt</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">RefPt</span> <span class="o">==</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">TotalMapRefPoints</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5050"></a><span class="k">                IF</span> <span class="p">((</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumX</span>  <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5051"></a>                     <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumX</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5052"></a>                     <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtInBounds</span><span class="p">(</span><span class="n">RefPt</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5053"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GetDetailedDaylighting: Reference Map point #[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5054"></a>                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RefPt</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;], X Value outside Zone Min/Max X, Zone=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5055"></a>                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5056"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...X Reference Point= &#39;</span><span class="o">//</span>                                                        <span class="p">&amp;</span>
<a name="ln-5057"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Zone Minimum X= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5058"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumX</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Zone Maximum X= &#39;</span><span class="o">//</span>                             <span class="p">&amp;</span>
<a name="ln-5059"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumX</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-5060"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumX</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5061"></a><span class="k">                    CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...X Reference Distance Outside MinimumX= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5062"></a>                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumX</span><span class="o">-</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m.&#39;</span><span class="p">)</span>
<a name="ln-5063"></a>                  <span class="k">ELSE</span>
<a name="ln-5064"></a><span class="k">                    CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...X Reference Distance Outside MaximumX= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5065"></a>                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumX</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m.&#39;</span><span class="p">)</span>
<a name="ln-5066"></a>                  <span class="n">ENDIF</span>
<a name="ln-5067"></a>                <span class="n">ENDIF</span>
<a name="ln-5068"></a>                <span class="k">IF</span> <span class="p">((</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumY</span>  <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5069"></a>                     <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumY</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5070"></a>                     <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtInBounds</span><span class="p">(</span><span class="n">RefPt</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5071"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GetDetailedDaylighting: Reference Map point #[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5072"></a>                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RefPt</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;], Y Value outside Zone Min/Max Y, Zone=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5073"></a>                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5074"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Y Reference Point= &#39;</span><span class="o">//</span>                                                        <span class="p">&amp;</span>
<a name="ln-5075"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Zone Minimum Y= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5076"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumY</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Zone Maximum Y= &#39;</span><span class="o">//</span>                             <span class="p">&amp;</span>
<a name="ln-5077"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumY</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-5078"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumY</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5079"></a><span class="k">                    CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Y Reference Distance Outside MinimumY= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5080"></a>                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumY</span><span class="o">-</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m.&#39;</span><span class="p">)</span>
<a name="ln-5081"></a>                  <span class="k">ELSE</span>
<a name="ln-5082"></a><span class="k">                    CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Y Reference Distance Outside MaximumY= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5083"></a>                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumY</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m.&#39;</span><span class="p">)</span>
<a name="ln-5084"></a>                  <span class="n">ENDIF</span>
<a name="ln-5085"></a>                <span class="n">ENDIF</span>
<a name="ln-5086"></a>                <span class="k">IF</span> <span class="p">((</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumZ</span>  <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5087"></a>                     <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumZ</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5088"></a>                     <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtInBounds</span><span class="p">(</span><span class="n">RefPt</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5089"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GetDetailedDaylighting: Reference Map point #[&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5090"></a>                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RefPt</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;], Z Value outside Zone Min/Max Z, Zone=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5091"></a>                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5092"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Z Reference Point= &#39;</span><span class="o">//</span>                                                        <span class="p">&amp;</span>
<a name="ln-5093"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Zone Minimum Z= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5094"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumZ</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Zone Maximum Z= &#39;</span><span class="o">//</span>                             <span class="p">&amp;</span>
<a name="ln-5095"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumZ</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-5096"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumZ</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5097"></a><span class="k">                    CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Z Reference Distance Outside MinimumZ= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5098"></a>                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MinimumZ</span><span class="o">-</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m.&#39;</span><span class="p">)</span>
<a name="ln-5099"></a>                  <span class="k">ELSE</span>
<a name="ln-5100"></a><span class="k">                    CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Z Reference Distance Outside MaximumZ= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5101"></a>                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneFound</span><span class="p">)%</span><span class="n">MaximumZ</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m.&#39;</span><span class="p">)</span>
<a name="ln-5102"></a>                  <span class="n">ENDIF</span>
<a name="ln-5103"></a>                <span class="n">ENDIF</span>
<a name="ln-5104"></a>              <span class="n">ENDIF</span>
<a name="ln-5105"></a>              <span class="n">RefPt</span> <span class="o">=</span> <span class="n">RefPt</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5106"></a>            <span class="k">END DO</span> <span class="c">! X</span>
<a name="ln-5107"></a>          <span class="k">END DO</span> <span class="c">! Y</span>
<a name="ln-5108"></a>
<a name="ln-5109"></a>        <span class="k">END IF</span>
<a name="ln-5110"></a><span class="k">      END IF</span>
<a name="ln-5111"></a><span class="k">    END DO</span> <span class="c">! MapNum</span>
<a name="ln-5112"></a>
<a name="ln-5113"></a>  <span class="k">END DO</span>
<a name="ln-5114"></a>
<a name="ln-5115"></a><span class="k">  ALLOCATE</span><span class="p">(</span><span class="n">ZoneMsgDone</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-5116"></a>  <span class="n">ZoneMsgDone</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5117"></a>  <span class="k">DO </span><span class="n">MapNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotIllumMaps</span>
<a name="ln-5118"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-5119"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">DaylightType</span> <span class="o">/=</span> <span class="n">DetailedDaylighting</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-5120"></a>        <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ZoneMsgDone</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5121"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Zone Name in Output:IlluminanceMap is not used for Daylighting:Controls=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5122"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5123"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5124"></a>    <span class="n">ENDIF</span>
<a name="ln-5125"></a>  <span class="n">ENDDO</span>
<a name="ln-5126"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">ZoneMsgDone</span><span class="p">)</span>
<a name="ln-5127"></a>
<a name="ln-5128"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TotIllumMaps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5129"></a><span class="k">    Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-5130"></a>     <span class="s1">&#39;! &lt;Daylighting:Illuminance Maps:Detail&gt;,Name,Zone,XMin {m},XMax {m},Xinc {m},#X Points,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5131"></a>        <span class="s1">&#39;YMin {m},YMax {m},Yinc {m},#Y Points,Z {m}&#39;</span>
<a name="ln-5132"></a>  <span class="n">ENDIF</span>
<a name="ln-5133"></a>  <span class="k">DO </span><span class="n">MapNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotIllumMaps</span>
<a name="ln-5134"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s2">&quot;(&#39;Daylighting:Illuminance Maps:Detail&#39;,11(&#39;,&#39;,A))&quot;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span>   <span class="p">&amp;</span>
<a name="ln-5135"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-5136"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">XMin</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">XMax</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-5137"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xinc</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">XNum</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5138"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">YMin</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">YMax</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-5139"></a>         <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Yinc</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">YNum</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-5140"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Z</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-5141"></a>  <span class="n">ENDDO</span>
<a name="ln-5142"></a>
<a name="ln-5143"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-5144"></a>
<a name="ln-5145"></a><span class="k">  DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfZones</span>
<a name="ln-5146"></a>
<a name="ln-5147"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-5148"></a>
<a name="ln-5149"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5150"></a><span class="k">      CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Daylighting Reference Point 1 Illuminance [lux]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5151"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllumAtRefPt</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5152"></a>        <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5153"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Daylighting Reference Point 1 Glare Index []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5154"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">GlareIndexAtRefPt</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5155"></a>        <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5156"></a>
<a name="ln-5157"></a>      <span class="c">!added TH 12/2/2008 to calculate the time exceeding the glare index setpoint</span>
<a name="ln-5158"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Daylighting Reference Point 1 Glare Index Setpoint Exceeded Time [hr]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5159"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TimeExceedingGlareIndexSPAtRefPt</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5160"></a>
<a name="ln-5161"></a>      <span class="c">!added TH 7/6/2009 to calculate the time exceeding the illuminance setpoint</span>
<a name="ln-5162"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Daylighting Reference Point 1 Daylight Illuminance Setpoint Exceeded Time [hr]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5163"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TimeExceedingDaylightIlluminanceSPAtRefPt</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5164"></a>    <span class="n">ENDIF</span>
<a name="ln-5165"></a>
<a name="ln-5166"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5167"></a><span class="k">      CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Daylighting Reference Point 2 Illuminance [lux]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5168"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllumAtRefPt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5169"></a>        <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5170"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Daylighting Reference Point 2 Glare Index []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5171"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">GlareIndexAtRefPt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5172"></a>        <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5173"></a>
<a name="ln-5174"></a>      <span class="c">!added TH 12/2/2008 to calculate the time exceeding the glare index setpoint</span>
<a name="ln-5175"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Daylighting Reference Point 2 Glare Index Setpoint Exceeded Time [hr]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5176"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TimeExceedingGlareIndexSPAtRefPt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5177"></a>
<a name="ln-5178"></a>      <span class="c">!added TH 7/6/2009 to calculate the time exceeding the illuminance setpoint</span>
<a name="ln-5179"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Daylighting Reference Point 2 Daylight Illuminance Setpoint Exceeded Time [hr]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5180"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TimeExceedingDaylightIlluminanceSPAtRefPt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5181"></a>    <span class="k">END IF</span>
<a name="ln-5182"></a><span class="k">    CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Daylighting Lighting Power Multiplier []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5183"></a>      <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ZonePowerReductionFactor</span><span class="p">,</span> <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5184"></a>      <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5185"></a>  <span class="k">END DO</span>
<a name="ln-5186"></a>
<a name="ln-5187"></a><span class="k">  DO </span><span class="n">SurfLoop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-5188"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5189"></a><span class="k">      IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5190"></a>         <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">HasInterZoneWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5191"></a><span class="k">        CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Daylighting Window Reference Point 1 Illuminance [lux]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5192"></a>                                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt1Rep</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5193"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5194"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Daylighting Window Reference Point 1 View Luminance [cd/m2]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5195"></a>                                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">LumWinFromRefPt1Rep</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5196"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5197"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5198"></a><span class="k">          CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Daylighting Window Reference Point 2 Illuminance [lux]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5199"></a>                                  <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt2Rep</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5200"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5201"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Daylighting Window Reference Point 2 View Luminance [cd/m2]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5202"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">LumWinFromRefPt2Rep</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5203"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-5204"></a>        <span class="k">END IF</span>
<a name="ln-5205"></a><span class="k">      END IF</span>
<a name="ln-5206"></a><span class="k">    END IF</span>
<a name="ln-5207"></a><span class="k">  END DO</span>
<a name="ln-5208"></a>
<a name="ln-5209"></a><span class="k">  RETURN</span>
<a name="ln-5210"></a>
<a name="ln-5211"></a><span class="k">END SUBROUTINE </span><span class="n">GetDaylightingParametersDetaild</span>
<a name="ln-5212"></a>
<a name="ln-5213"></a><span class="k">Subroutine </span><span class="n">CheckTDDsAndLightShelvesInDaylitZones</span>
<a name="ln-5214"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5215"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-5216"></a>          <span class="c">!       DATE WRITTEN   Dec 2007</span>
<a name="ln-5217"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5218"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5219"></a>
<a name="ln-5220"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5221"></a>          <span class="c">! This subroutine checks daylighting input for TDDs and light shelfs</span>
<a name="ln-5222"></a>          <span class="c">!  which need to be checked after daylighting input has been read in (CR 7145)</span>
<a name="ln-5223"></a>          <span class="c">!  (eventually this should be changed once/if implementations change to decouple from daylighting calcs so that</span>
<a name="ln-5224"></a>          <span class="c">!  these devices can be used in models without daylighting controls</span>
<a name="ln-5225"></a>          <span class="c">!</span>
<a name="ln-5226"></a>          <span class="c">! CR 7145 was for TDDs, but also implenting check for light shelves, the other &quot;daylighting device&quot;</span>
<a name="ln-5227"></a>
<a name="ln-5228"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5229"></a>          <span class="c">! loop thru daylighting devices and check that their zones have daylight controls</span>
<a name="ln-5230"></a>
<a name="ln-5231"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5232"></a>          <span class="c">! na</span>
<a name="ln-5233"></a>
<a name="ln-5234"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5235"></a>  <span class="k">Use </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Zone</span>
<a name="ln-5236"></a>  <span class="k">USE </span><span class="n">DataDaylighting</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneDaylight</span><span class="p">,</span> <span class="n">NoDaylighting</span>
<a name="ln-5237"></a>  <span class="k">USE </span><span class="n">DataDaylightingDevices</span>
<a name="ln-5238"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-5239"></a>
<a name="ln-5240"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5241"></a>
<a name="ln-5242"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5243"></a>          <span class="c">! na</span>
<a name="ln-5244"></a>
<a name="ln-5245"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5246"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">fmta</span><span class="o">=</span><span class="s2">&quot;(A)&quot;</span>
<a name="ln-5247"></a>
<a name="ln-5248"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5249"></a>          <span class="c">! na</span>
<a name="ln-5250"></a>
<a name="ln-5251"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5252"></a>          <span class="c">! na</span>
<a name="ln-5253"></a>
<a name="ln-5254"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5255"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">PipeNum</span>     <span class="c">! TDD pipe object number</span>
<a name="ln-5256"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">ShelfNum</span>    <span class="c">! light shelf object number</span>
<a name="ln-5257"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">SurfNum</span>     <span class="c">! daylight device surface number</span>
<a name="ln-5258"></a>  <span class="kt">LOGICAL</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-5259"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">FirstTime</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5260"></a>
<a name="ln-5261"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FirstTime</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5262"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">CheckTDDZone</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-5263"></a>    <span class="n">CheckTDDZone</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5264"></a>    <span class="n">FirstTime</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5265"></a>  <span class="n">ENDIF</span>
<a name="ln-5266"></a>
<a name="ln-5267"></a>  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5268"></a>
<a name="ln-5269"></a>  <span class="k">DO </span><span class="n">PipeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfTDDPipes</span>
<a name="ln-5270"></a>    <span class="n">SurfNum</span> <span class="o">=</span> <span class="n">TDDPipe</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">)%</span><span class="n">Diffuser</span>
<a name="ln-5271"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5272"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">zone</span><span class="p">)%</span><span class="n">DaylightType</span> <span class="o">==</span> <span class="n">NoDaylighting</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5273"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;DaylightingDevice:Tubular = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TDDPipe</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5274"></a>            <span class="s1">&#39;:  is not connected to a Zone that has Daylighting.  &#39;</span><span class="p">)</span>
<a name="ln-5275"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Add Daylighting:Controls (or Daylighting:DELight:Controls) &#39;</span> <span class="o">//</span><span class="p">&amp;</span>
<a name="ln-5276"></a>            <span class="s1">&#39;to Zone named:  &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">zone</span><span class="p">)%</span><span class="n">name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-5277"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;A sufficient control is provided on the .dbg file.&#39;</span><span class="p">)</span>
<a name="ln-5278"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5279"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CheckTDDZone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">zone</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5280"></a><span class="k">          WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39; ! Following control is to allow tubular reporting in this Zone&#39;</span>
<a name="ln-5281"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;Daylighting:Controls,  !- this control controls 0% of zone.&#39;</span>
<a name="ln-5282"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;   &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">zone</span><span class="p">)%</span><span class="n">name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,  !- Zone Name&#39;</span>
<a name="ln-5283"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;     1,   !- Total Daylighting Reference Points&#39;</span>
<a name="ln-5284"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DaylRefWorldCoordSystem</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5285"></a>            <span class="c">! world coordinates, use zone origin for ref pt</span>
<a name="ln-5286"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;   &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">zone</span><span class="p">)%</span><span class="n">OriginX</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5287"></a>                                    <span class="s1">&#39;,   !- X-Coordinate of First Reference Point {m}&#39;</span>
<a name="ln-5288"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;   &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">zone</span><span class="p">)%</span><span class="n">OriginY</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5289"></a>                                    <span class="s1">&#39;,   !- Y-Coordinate of First Reference Point {m}&#39;</span>
<a name="ln-5290"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;   &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">zone</span><span class="p">)%</span><span class="n">OriginZ</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5291"></a>                                    <span class="s1">&#39;,   !- Z-Coordinate of First Reference Point {m}&#39;</span>
<a name="ln-5292"></a>          <span class="k">ELSE</span>
<a name="ln-5293"></a>            <span class="c">! relative coordinates, use 0,0,0 for ref pt</span>
<a name="ln-5294"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;   0.0,   !- X-Coordinate of First Reference Point {m}&#39;</span>
<a name="ln-5295"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;   0.0,   !- Y-Coordinate of First Reference Point {m}&#39;</span>
<a name="ln-5296"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;   0.0,   !- Z-Coordinate of First Reference Point {m}&#39;</span>
<a name="ln-5297"></a>          <span class="n">ENDIF</span>
<a name="ln-5298"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;      ,   !- X-Coordinate of Second Reference Point&#39;</span>
<a name="ln-5299"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;      ,   !- Y-Coordinate of Second Reference Point&#39;</span>
<a name="ln-5300"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;      ,   !- Z-Coordinate of Second Reference Point&#39;</span>
<a name="ln-5301"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;   0.0,   !- Fraction of Zone Controlled by First Reference Point&#39;</span>
<a name="ln-5302"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;   0.0,   !- Fraction of Zone Controlled by Second Reference Point&#39;</span>
<a name="ln-5303"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;   0.0,   !- Illuminance Setpoint at First Reference Point&#39;</span>
<a name="ln-5304"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;   0.0,   !- Illuminance Setpoint at Second Reference Point&#39;</span>
<a name="ln-5305"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;     3,   !- Lighting Control Type&#39;</span>
<a name="ln-5306"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;   0.0,   !- Glare Calculation Azimuth Angle of View Direction Clockwise from Zone y-Axis&#39;</span>
<a name="ln-5307"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;      ,   !- Maximum Allowable Discomfort Glare Index&#39;</span>
<a name="ln-5308"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;   0.0,   !- Minimum Input Power Fraction for Continuous Dimming Control&#39;</span>
<a name="ln-5309"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;   0.0,   !- Minimum Light Output Fraction for Continuous Dimming Control&#39;</span>
<a name="ln-5310"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;     0,   !- Number of Stepped Control Steps&#39;</span>
<a name="ln-5311"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileDebug</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;   0.0;   !- Probability Lighting will be Reset When Needed in Manual Stepped Control&#39;</span>
<a name="ln-5312"></a>
<a name="ln-5313"></a>          <span class="n">CheckTDDZone</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">zone</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5314"></a>        <span class="n">ENDIF</span>
<a name="ln-5315"></a>      <span class="n">ENDIF</span>
<a name="ln-5316"></a>
<a name="ln-5317"></a>    <span class="k">ELSE</span> <span class="c">! surfNum == 0</span>
<a name="ln-5318"></a>      <span class="c">! should not come here (would have already been caught in TDD get input), but is an error</span>
<a name="ln-5319"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;DaylightingDevice:Tubular = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TDDPipe</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5320"></a>            <span class="s1">&#39;:  Diffuser surface not found &#39;</span><span class="p">)</span>
<a name="ln-5321"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5322"></a>    <span class="n">ENDIF</span>
<a name="ln-5323"></a>  <span class="k">END DO</span> <span class="c">! PipeNum</span>
<a name="ln-5324"></a>
<a name="ln-5325"></a>  <span class="k">DO </span><span class="n">ShelfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfShelf</span>
<a name="ln-5326"></a>    <span class="n">SurfNum</span> <span class="o">=</span> <span class="n">Shelf</span><span class="p">(</span><span class="n">ShelfNum</span><span class="p">)%</span><span class="n">Window</span>
<a name="ln-5327"></a><span class="c">!    IF (SurfNum &gt; 0) THEN</span>
<a name="ln-5328"></a><span class="c">!      IF (ZoneDaylight(Surface(SurfNum)%zone)%DaylightType == NoDaylighting) THEN</span>
<a name="ln-5329"></a><span class="c">!        CALL ShowSevereError(&#39;DaylightingDevice:Shelf = &#39;//TRIM(Shelf(ShelfNum)%Name)// &amp;</span>
<a name="ln-5330"></a><span class="c">!            &#39;:  is not connected to a Zone that has Daylighting.  &#39;)</span>
<a name="ln-5331"></a><span class="c">!        CALL ShowContinueError(&#39;Add Daylighting:Controls (or Daylighting:DELight:Controls) &#39; //&amp;</span>
<a name="ln-5332"></a><span class="c">!            &#39;to Zone named:  &#39;//TRIM(Zone(Surface(SurfNum)%zone)%name) )</span>
<a name="ln-5333"></a><span class="c">!          ErrorsFound = .TRUE.</span>
<a name="ln-5334"></a><span class="c">!      ENDIF</span>
<a name="ln-5335"></a><span class="c">!</span>
<a name="ln-5336"></a><span class="c">!    ELSE ! surfNum == 0</span>
<a name="ln-5337"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5338"></a>      <span class="c">! should not come here (would have already been caught in shelf get input), but is an error</span>
<a name="ln-5339"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;DaylightingDevice:Shelf = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Shelf</span><span class="p">(</span><span class="n">ShelfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5340"></a>            <span class="s1">&#39;:  window not found &#39;</span><span class="p">)</span>
<a name="ln-5341"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5342"></a>    <span class="n">ENDIF</span>
<a name="ln-5343"></a>  <span class="k">END DO</span> <span class="c">! ShelfNum</span>
<a name="ln-5344"></a>
<a name="ln-5345"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CheckTDDsAndLightShelvesInDaylitZones: Errors in DAYLIGHTING input.&#39;</span><span class="p">)</span>
<a name="ln-5346"></a>
<a name="ln-5347"></a><span class="k">END SUBROUTINE </span><span class="n">CheckTDDsAndLightShelvesInDaylitZones</span>
<a name="ln-5348"></a>
<a name="ln-5349"></a><span class="k">SUBROUTINE </span><span class="n">GetLightWellData</span><span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5350"></a>
<a name="ln-5351"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5352"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-5353"></a>          <span class="c">!       DATE WRITTEN   Apr 2004</span>
<a name="ln-5354"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5355"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5356"></a>
<a name="ln-5357"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5358"></a>          <span class="c">! Gets data for a light well associated with a rectangular exterior window.</span>
<a name="ln-5359"></a>          <span class="c">! Calculates light well efficiency, defined as the ratio of the amount of visible</span>
<a name="ln-5360"></a>          <span class="c">! solar radiation leaving a well to the amount entering the well.</span>
<a name="ln-5361"></a>
<a name="ln-5362"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5363"></a>          <span class="c">! Based on fit to Fig. 8-21, &quot;Efficiency factors for various depths of light wells</span>
<a name="ln-5364"></a>          <span class="c">! based on well-interreflectance values,&quot; Lighting Handbook, 8th Edition, Illuminating</span>
<a name="ln-5365"></a>          <span class="c">! Engineering Society of North America, 1993.</span>
<a name="ln-5366"></a>
<a name="ln-5367"></a>          <span class="c">! REFERENCES: see above.</span>
<a name="ln-5368"></a>
<a name="ln-5369"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5370"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-5371"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">FindItemInList</span>
<a name="ln-5372"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-5373"></a>
<a name="ln-5374"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5375"></a>
<a name="ln-5376"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5377"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="c">! If errors found in input</span>
<a name="ln-5378"></a>
<a name="ln-5379"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:na</span>
<a name="ln-5380"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:na</span>
<a name="ln-5381"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:na</span>
<a name="ln-5382"></a>
<a name="ln-5383"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5384"></a>
<a name="ln-5385"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>                   <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-5386"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlpha</span>                 <span class="c">! Number of alpha names being passed</span>
<a name="ln-5387"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumProp</span>                  <span class="c">! Number of properties being passed</span>
<a name="ln-5388"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotLightWells</span>            <span class="c">! Total Light Well objects</span>
<a name="ln-5389"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Loop</span>                     <span class="c">! DO loop index</span>
<a name="ln-5390"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfNum</span>                  <span class="c">! Surface number</span>
<a name="ln-5391"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">WrongSurfaceType</span>         <span class="c">! True if associated surface is not an exterior window</span>
<a name="ln-5392"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeightWell</span>                  <span class="c">! Well height (from window to bottom of well) (m)</span>
<a name="ln-5393"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PerimWell</span>                   <span class="c">! Well perimeter (at bottom of well) (m)</span>
<a name="ln-5394"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AreaWell</span>                    <span class="c">! Well area (at bottom of well) (m2)</span>
<a name="ln-5395"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VisReflWell</span>                 <span class="c">! Area-weighted visible reflectance of well walls</span>
<a name="ln-5396"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WellCavRatio</span>                <span class="c">! Well cavity ratio</span>
<a name="ln-5397"></a>
<a name="ln-5398"></a>  <span class="c">! Get the total number of Light Well objects</span>
<a name="ln-5399"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;DaylightingDevice:LightWell&#39;</span>
<a name="ln-5400"></a>  <span class="n">TotLightWells</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-5401"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">TotLightWells</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-5402"></a>
<a name="ln-5403"></a><span class="k">  DO </span><span class="n">Loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotLightWells</span>
<a name="ln-5404"></a>
<a name="ln-5405"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">Loop</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlpha</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumProp</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5406"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5407"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-5408"></a>
<a name="ln-5409"></a>    <span class="n">SurfNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Surface</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TotSurfaces</span><span class="p">)</span>
<a name="ln-5410"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5411"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5412"></a>          <span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-5413"></a>    <span class="k">END IF</span>
<a name="ln-5414"></a>
<a name="ln-5415"></a>    <span class="c">! Check that associated surface is an exterior window</span>
<a name="ln-5416"></a>    <span class="n">WrongSurfaceType</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5417"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5418"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Window</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5419"></a>         <span class="n">WrongSurfaceType</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5420"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">WrongSurfaceType</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5421"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5422"></a>          <span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; - not an exterior window.&#39;</span><span class="p">)</span>
<a name="ln-5423"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5424"></a>      <span class="k">END IF</span>
<a name="ln-5425"></a><span class="k">    END IF</span>
<a name="ln-5426"></a>
<a name="ln-5427"></a><span class="k">    IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5428"></a>
<a name="ln-5429"></a>      <span class="c">! Associated surface is an exterior window; calculate light well efficiency.</span>
<a name="ln-5430"></a>
<a name="ln-5431"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">LightWellEff</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-5432"></a>      <span class="n">HeightWell</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5433"></a>      <span class="n">PerimWell</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5434"></a>      <span class="n">AreaWell</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-5435"></a>      <span class="n">VisReflWell</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-5436"></a>
<a name="ln-5437"></a>      <span class="c">! Warning if light well area is less than window area</span>
<a name="ln-5438"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">AreaWell</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="o">+</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">DividerArea</span><span class="o">-</span><span class="mf">0.1d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5439"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5440"></a>            <span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; - Areas.&#39;</span><span class="p">)</span>
<a name="ln-5441"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;has Area of Bottom of Well=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5442"></a>           <span class="s1">&#39; that is less than window area=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AreaWell</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-5443"></a>      <span class="k">END IF</span>
<a name="ln-5444"></a>
<a name="ln-5445"></a><span class="k">      IF</span><span class="p">(</span><span class="n">HeightWell</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PerimWell</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">AreaWell</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5446"></a><span class="k">        </span><span class="n">WellCavRatio</span> <span class="o">=</span> <span class="mf">2.5d0</span><span class="o">*</span><span class="n">HeightWell</span><span class="o">*</span><span class="n">PerimWell</span><span class="o">/</span><span class="n">AreaWell</span>
<a name="ln-5447"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">LightWellEff</span> <span class="o">=</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">WellCavRatio</span><span class="o">*</span><span class="p">(</span><span class="mf">0.16368d0</span><span class="o">-</span><span class="mf">0.14467d0</span><span class="o">*</span><span class="n">VisReflWell</span><span class="p">))</span>
<a name="ln-5448"></a>      <span class="k">END IF</span>
<a name="ln-5449"></a>
<a name="ln-5450"></a><span class="k">    END IF</span>
<a name="ln-5451"></a>
<a name="ln-5452"></a><span class="k">  END DO</span>  <span class="c">! End of loop over light well objects</span>
<a name="ln-5453"></a>
<a name="ln-5454"></a>  <span class="k">RETURN</span>
<a name="ln-5455"></a>
<a name="ln-5456"></a><span class="k">END SUBROUTINE </span><span class="n">GetLightWellData</span>
<a name="ln-5457"></a>
<a name="ln-5458"></a><span class="k">SUBROUTINE </span><span class="n">DayltgGlare</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span> <span class="n">BLUM</span><span class="p">,</span> <span class="n">GLINDX</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-5459"></a>
<a name="ln-5460"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5461"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-5462"></a>          <span class="c">!       DATE WRITTEN   July 1997</span>
<a name="ln-5463"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5464"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5465"></a>
<a name="ln-5466"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5467"></a>          <span class="c">! CALCULATE GLARE INDEX.</span>
<a name="ln-5468"></a>
<a name="ln-5469"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5470"></a>          <span class="c">! Called from DayltgInteriorIllum.  Finds glare index at reference</span>
<a name="ln-5471"></a>          <span class="c">! point no. IL in a space using the Cornell/BRS large source</span>
<a name="ln-5472"></a>          <span class="c">! glare formula. BLUM is the background luminance (cd/m**2).</span>
<a name="ln-5473"></a>          <span class="c">!</span>
<a name="ln-5474"></a>          <span class="c">! TH comment 1/21/2010: The SurfaceWindow(IWin)%ShadingFlag has to be set</span>
<a name="ln-5475"></a>          <span class="c">!  before calling this subroutine. For switchable glazings this is tricky</span>
<a name="ln-5476"></a>          <span class="c">!  because the ZoneDaylight(ZoneNum)%SourceLumFromWinAtRefPt(IL,2,loop)</span>
<a name="ln-5477"></a>          <span class="c">!  may change every time step to represent intermediate switched state.</span>
<a name="ln-5478"></a>
<a name="ln-5479"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5480"></a>          <span class="c">! Based on DOE-2.1E subroutine DGLARE.</span>
<a name="ln-5481"></a>
<a name="ln-5482"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5483"></a>          <span class="c">! na</span>
<a name="ln-5484"></a>
<a name="ln-5485"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5486"></a>
<a name="ln-5487"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5488"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">IL</span>                           <span class="c">! Reference point index: 1=first ref pt, 2=second ref pt</span>
<a name="ln-5489"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">BLUM</span>                         <span class="c">! Window background (surround) luminance (cd/m2)</span>
<a name="ln-5490"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">GLINDX</span>                       <span class="c">! Glare index</span>
<a name="ln-5491"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ZoneNum</span>                      <span class="c">! Zone number</span>
<a name="ln-5492"></a>
<a name="ln-5493"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5494"></a>          <span class="c">! na</span>
<a name="ln-5495"></a>
<a name="ln-5496"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5497"></a>          <span class="c">! na</span>
<a name="ln-5498"></a>
<a name="ln-5499"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5500"></a>          <span class="c">! na</span>
<a name="ln-5501"></a>
<a name="ln-5502"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5503"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">GTOT</span>                         <span class="c">! Glare constant</span>
<a name="ln-5504"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">GTOT1</span>                        <span class="c">! Portion of glare constant</span>
<a name="ln-5505"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">GTOT2</span>                        <span class="c">! Portion of glare constant</span>
<a name="ln-5506"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">IWin</span>                         <span class="c">! Window counter</span>
<a name="ln-5507"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="k">IS</span>                           <span class="c">! Window shading index: 1=unshaded, 2=shaded</span>
<a name="ln-5508"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">loop</span>                         <span class="c">! Loop index</span>
<a name="ln-5509"></a>
<a name="ln-5510"></a>          <span class="c">! FLOW:</span>
<a name="ln-5511"></a>  <span class="c">! Initialize glare constant</span>
<a name="ln-5512"></a>  <span class="n">GTOT</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5513"></a>
<a name="ln-5514"></a>  <span class="c">! Loop over exterior windows associated with zone</span>
<a name="ln-5515"></a>  <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span>
<a name="ln-5516"></a>    <span class="n">IWin</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-5517"></a>    <span class="k">IS</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5518"></a>    <span class="k">IF</span><span class="p">((</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5519"></a>           <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">IS</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-5520"></a>    <span class="c">! Conversion from ft-L to cd/m2, with cd/m2 = 0.2936 ft-L, gives the 0.4794 factor</span>
<a name="ln-5521"></a>    <span class="c">! below, which is (0.2936)**0.6</span>
<a name="ln-5522"></a>    <span class="n">GTOT1</span>  <span class="o">=</span> <span class="mf">0.4794d0</span><span class="o">*</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span><span class="o">**</span><span class="mf">1.6d0</span><span class="p">)</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-5523"></a>                <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span><span class="o">**</span><span class="mf">0.8d0</span>
<a name="ln-5524"></a>    <span class="n">GTOT2</span>  <span class="o">=</span> <span class="n">BLUM</span> <span class="o">+</span> <span class="mf">0.07d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-5525"></a>                <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-5526"></a>    <span class="n">GTOT</span> <span class="o">=</span> <span class="n">GTOT</span> <span class="o">+</span> <span class="n">GTOT1</span> <span class="o">/</span> <span class="p">(</span><span class="n">GTOT2</span> <span class="o">+</span> <span class="mf">0.000001d0</span><span class="p">)</span>
<a name="ln-5527"></a>  <span class="k">END DO</span>
<a name="ln-5528"></a>
<a name="ln-5529"></a>  <span class="c">! Glare index (adding 0.000001 prevents LOG10 (0))</span>
<a name="ln-5530"></a>  <span class="n">GLINDX</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span><span class="o">*</span><span class="n">LOG10</span><span class="p">(</span><span class="n">GTOT</span><span class="o">+</span><span class="mf">0.000001d0</span><span class="p">)</span>
<a name="ln-5531"></a>  <span class="c">! Set glare index to zero for GTOT &lt; 1</span>
<a name="ln-5532"></a>  <span class="n">GLINDX</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">GLINDX</span><span class="p">)</span>
<a name="ln-5533"></a>
<a name="ln-5534"></a>  <span class="k">RETURN</span>
<a name="ln-5535"></a>
<a name="ln-5536"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgGlare</span>
<a name="ln-5537"></a>
<a name="ln-5538"></a><span class="k">SUBROUTINE </span><span class="n">DayltgGlareWithIntWins</span><span class="p">(</span><span class="n">GLINDX</span><span class="p">,</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-5539"></a>
<a name="ln-5540"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5541"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-5542"></a>          <span class="c">!       DATE WRITTEN   March 2004</span>
<a name="ln-5543"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5544"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5545"></a>
<a name="ln-5546"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5547"></a>          <span class="c">! Calculate daylighting glare index for zones with interior windows.</span>
<a name="ln-5548"></a>
<a name="ln-5549"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5550"></a>          <span class="c">! Finds glare index at reference point IL in a daylit zone using the Cornell/BRS large source</span>
<a name="ln-5551"></a>          <span class="c">! glare formula. Takes into account inter-reflected illuminance from light entering</span>
<a name="ln-5552"></a>          <span class="c">! the zone through interior windows</span>
<a name="ln-5553"></a>
<a name="ln-5554"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5555"></a>          <span class="c">! Based on subroutine DayltgGlare.</span>
<a name="ln-5556"></a>
<a name="ln-5557"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5558"></a>          <span class="c">! na</span>
<a name="ln-5559"></a>
<a name="ln-5560"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5561"></a>
<a name="ln-5562"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS</span>
<a name="ln-5563"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ZoneNum</span>                      <span class="c">! Zone number</span>
<a name="ln-5564"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">GLINDX</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                    <span class="c">! Glare index</span>
<a name="ln-5565"></a>
<a name="ln-5566"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS: na</span>
<a name="ln-5567"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS: na</span>
<a name="ln-5568"></a>          <span class="c">! DERIVED TYPE DEFINITIONS: na</span>
<a name="ln-5569"></a>
<a name="ln-5570"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5571"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IL</span>                           <span class="c">! Reference point index: 1=first ref pt, 2=second ref pt</span>
<a name="ln-5572"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GTOT</span>                         <span class="c">! Glare constant</span>
<a name="ln-5573"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GTOT1</span>                        <span class="c">! Portion of glare constant</span>
<a name="ln-5574"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GTOT2</span>                        <span class="c">! Portion of glare constant</span>
<a name="ln-5575"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IWin</span>                         <span class="c">! Window counter</span>
<a name="ln-5576"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="k">IS</span>                           <span class="c">! Window shading index: 1=unshaded, 2=shaded</span>
<a name="ln-5577"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BacLum</span>                       <span class="c">! Background luminance (cd/m2)</span>
<a name="ln-5578"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">loop</span>                         <span class="c">! Loop index</span>
<a name="ln-5579"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">RefPoints</span>                    <span class="c">! Number of daylighting reference points in zone</span>
<a name="ln-5580"></a>          <span class="c">! FLOW:</span>
<a name="ln-5581"></a>  <span class="c">! Initialize glare constant</span>
<a name="ln-5582"></a>  <span class="n">GTOT</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5583"></a>
<a name="ln-5584"></a>  <span class="c">! Calculate background luminance including effect of inter-reflected illuminance from light</span>
<a name="ln-5585"></a>  <span class="c">! entering zone through its interior windows</span>
<a name="ln-5586"></a>
<a name="ln-5587"></a>  <span class="n">RefPoints</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span><span class="p">)</span>
<a name="ln-5588"></a>  <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">RefPoints</span>
<a name="ln-5589"></a>    <span class="n">BacLum</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BacLum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-5590"></a>               <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InterReflIllFrIntWins</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span> <span class="o">/</span> <span class="n">Pi</span>
<a name="ln-5591"></a>    <span class="n">BacLum</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumSetPoint</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span><span class="o">*</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span><span class="o">/</span><span class="n">Pi</span><span class="p">,</span><span class="n">BacLum</span><span class="p">)</span>
<a name="ln-5592"></a>
<a name="ln-5593"></a>    <span class="c">! Loop over exterior windows associated with zone</span>
<a name="ln-5594"></a>    <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span>
<a name="ln-5595"></a>      <span class="n">IWin</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-5596"></a>      <span class="k">IS</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5597"></a>      <span class="k">IF</span><span class="p">((</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5598"></a>            <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">IS</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-5599"></a>      <span class="c">! Conversion from ft-L to cd/m2, with cd/m2 = 0.2936 ft-L, gives the 0.4794 factor</span>
<a name="ln-5600"></a>      <span class="c">! below, which is (0.2936)**0.6</span>
<a name="ln-5601"></a>      <span class="n">GTOT1</span>  <span class="o">=</span> <span class="mf">0.4794d0</span><span class="o">*</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span><span class="o">**</span><span class="mf">1.6d0</span><span class="p">)</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-5602"></a>                  <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span><span class="o">**</span><span class="mf">0.8d0</span>
<a name="ln-5603"></a>      <span class="n">GTOT2</span>  <span class="o">=</span> <span class="n">BacLum</span> <span class="o">+</span> <span class="mf">0.07d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-5604"></a>                  <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-5605"></a>      <span class="n">GTOT</span> <span class="o">=</span> <span class="n">GTOT</span> <span class="o">+</span> <span class="n">GTOT1</span> <span class="o">/</span> <span class="p">(</span><span class="n">GTOT2</span> <span class="o">+</span> <span class="mf">0.000001d0</span><span class="p">)</span>
<a name="ln-5606"></a>    <span class="k">END DO</span>
<a name="ln-5607"></a>
<a name="ln-5608"></a>    <span class="c">! Glare index</span>
<a name="ln-5609"></a>    <span class="n">GLINDX</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span><span class="o">*</span><span class="n">LOG10</span><span class="p">(</span><span class="n">GTOT</span><span class="o">+</span><span class="mf">0.000001d0</span><span class="p">)</span>
<a name="ln-5610"></a>    <span class="c">! Set glare index to zero for GTOT &lt; 1</span>
<a name="ln-5611"></a>    <span class="n">GLINDX</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">GLINDX</span><span class="p">(</span><span class="n">IL</span><span class="p">))</span>
<a name="ln-5612"></a>  <span class="k">END DO</span>
<a name="ln-5613"></a>
<a name="ln-5614"></a><span class="k">  RETURN</span>
<a name="ln-5615"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgGlareWithIntWins</span>
<a name="ln-5616"></a>
<a name="ln-5617"></a>
<a name="ln-5618"></a><span class="k">SUBROUTINE </span><span class="n">DayltgExtHorizIllum</span><span class="p">(</span><span class="n">HISK</span><span class="p">,</span><span class="n">HISU</span><span class="p">)</span>
<a name="ln-5619"></a>
<a name="ln-5620"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5621"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-5622"></a>          <span class="c">!       DATE WRITTEN   July 1997</span>
<a name="ln-5623"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5624"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5625"></a>
<a name="ln-5626"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5627"></a>          <span class="c">! Calculates exterior daylight illuminance.</span>
<a name="ln-5628"></a>
<a name="ln-5629"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5630"></a>          <span class="c">! Called by CalcDayltgCoefficients. Calculates illuminance</span>
<a name="ln-5631"></a>          <span class="c">! on unobstructed horizontal surface by integrating</span>
<a name="ln-5632"></a>          <span class="c">! over the luminance distribution of standard CIE skies.</span>
<a name="ln-5633"></a>          <span class="c">! Calculates horizontal beam illuminance.</span>
<a name="ln-5634"></a>          <span class="c">!</span>
<a name="ln-5635"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5636"></a>          <span class="c">! Based on DOE-2.1E subroutine DHILL.</span>
<a name="ln-5637"></a>
<a name="ln-5638"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5639"></a>          <span class="c">! na</span>
<a name="ln-5640"></a>
<a name="ln-5641"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5642"></a>
<a name="ln-5643"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5644"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HISK</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>                 <span class="c">! Horizontal illuminance from sky for different sky types</span>
<a name="ln-5645"></a>                                               <span class="c">!  and overcast sky (lux)</span>
<a name="ln-5646"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HISU</span>                    <span class="c">! Horizontal illuminance from sun for unit beam normal</span>
<a name="ln-5647"></a>                                               <span class="c">!   illuminance (lux)</span>
<a name="ln-5648"></a>
<a name="ln-5649"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5650"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">NTH</span> <span class="o">=</span> <span class="mi">18</span>             <span class="c">! Number of azimuth steps for sky integration</span>
<a name="ln-5651"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">NPH</span> <span class="o">=</span> <span class="mi">8</span>              <span class="c">! Number of altitude steps for sky integration</span>
<a name="ln-5652"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DTH</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.0d0</span><span class="o">*</span><span class="n">PI</span><span class="p">)</span> <span class="o">/</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">NTH</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>  <span class="c">! Sky integration azimuth stepsize (radians)</span>
<a name="ln-5653"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DPH</span> <span class="o">=</span> <span class="n">PIOVR2</span> <span class="o">/</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">NPH</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>      <span class="c">! Sky integration altitude stepsize (radians)</span>
<a name="ln-5654"></a>
<a name="ln-5655"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5656"></a>          <span class="c">! na</span>
<a name="ln-5657"></a>
<a name="ln-5658"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5659"></a>          <span class="c">! na</span>
<a name="ln-5660"></a>
<a name="ln-5661"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5662"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">IPH</span>       <span class="c">! Altitude index for sky integration</span>
<a name="ln-5663"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">ITH</span>       <span class="c">! Azimuth index for sky integration</span>
<a name="ln-5664"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">NPH</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PH</span>        <span class="c">! Altitude of sky element (radians)</span>
<a name="ln-5665"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">NTH</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TH</span>        <span class="c">! Azimuth of sky element (radians)</span>
<a name="ln-5666"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">ISky</span>      <span class="c">! Sky type index</span>
<a name="ln-5667"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">NPH</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SPHCPH</span>    <span class="c">! Sine times cosine of altitude of sky element</span>
<a name="ln-5668"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>            <span class="kd">::</span> <span class="n">FirstTime</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>  <span class="c">! flag for first time thru to initialize</span>
<a name="ln-5669"></a>
<a name="ln-5670"></a>          <span class="c">! FLOW:</span>
<a name="ln-5671"></a>  <span class="c">! Integrate to obtain illuminance from sky.</span>
<a name="ln-5672"></a>  <span class="c">! The contribution in lumens/m2 from a patch of sky at altitude PH and azimuth TH</span>
<a name="ln-5673"></a>  <span class="c">! is L(TH,PH)*SIN(PH)*COS(PH)*DTH*DPH, where L(TH,PH) is the luminance</span>
<a name="ln-5674"></a>  <span class="c">! of the patch in cd/m2.</span>
<a name="ln-5675"></a>  <span class="c">!  Init</span>
<a name="ln-5676"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FirstTime</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5677"></a><span class="k">    DO </span><span class="n">IPH</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NPH</span>
<a name="ln-5678"></a>      <span class="n">PH</span><span class="p">(</span><span class="n">IPH</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">IPH</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">DPH</span>
<a name="ln-5679"></a>      <span class="n">SPHCPH</span><span class="p">(</span><span class="n">IPH</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">PH</span><span class="p">(</span><span class="n">IPH</span><span class="p">))</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">PH</span><span class="p">(</span><span class="n">IPH</span><span class="p">))</span> <span class="c">! DA = COS(PH)*DTH*DPH</span>
<a name="ln-5680"></a>    <span class="k">END DO</span>
<a name="ln-5681"></a><span class="k">    DO </span><span class="n">ITH</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NTH</span>
<a name="ln-5682"></a>      <span class="n">TH</span><span class="p">(</span><span class="n">ITH</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">ITH</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">DTH</span>
<a name="ln-5683"></a>    <span class="k">END DO</span>
<a name="ln-5684"></a><span class="k">    </span><span class="n">FirstTime</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5685"></a>  <span class="n">ENDIF</span>
<a name="ln-5686"></a>
<a name="ln-5687"></a>  <span class="n">HISK</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5688"></a>
<a name="ln-5689"></a>  <span class="c">! Sky integration</span>
<a name="ln-5690"></a>  <span class="k">DO </span><span class="n">IPH</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NPH</span>
<a name="ln-5691"></a>    <span class="k">DO </span><span class="n">ITH</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NTH</span>
<a name="ln-5692"></a>      <span class="k">DO </span><span class="n">ISky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-5693"></a>        <span class="n">HISK</span><span class="p">(</span><span class="n">ISky</span><span class="p">)</span> <span class="o">=</span> <span class="n">HISK</span><span class="p">(</span><span class="n">ISky</span><span class="p">)</span> <span class="o">+</span> <span class="n">DayltgSkyLuminance</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="n">TH</span><span class="p">(</span><span class="n">ITH</span><span class="p">),</span><span class="n">PH</span><span class="p">(</span><span class="n">IPH</span><span class="p">))</span> <span class="o">*</span> <span class="n">SPHCPH</span><span class="p">(</span><span class="n">IPH</span><span class="p">)</span>
<a name="ln-5694"></a>      <span class="k">END DO</span>
<a name="ln-5695"></a><span class="k">    END DO</span>
<a name="ln-5696"></a><span class="k">  END DO</span>
<a name="ln-5697"></a>
<a name="ln-5698"></a><span class="k">  DO </span><span class="n">ISky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-5699"></a>    <span class="n">HISK</span><span class="p">(</span><span class="n">ISky</span><span class="p">)</span> <span class="o">=</span> <span class="n">HISK</span><span class="p">(</span><span class="n">ISky</span><span class="p">)</span> <span class="o">*</span> <span class="n">DTH</span> <span class="o">*</span> <span class="n">DPH</span>
<a name="ln-5700"></a>  <span class="k">END DO</span>
<a name="ln-5701"></a>
<a name="ln-5702"></a>  <span class="c">! Direct solar horizontal illum (for unit direct normal illuminance)</span>
<a name="ln-5703"></a>  <span class="n">HISU</span>  <span class="o">=</span> <span class="n">SPHSUN</span> <span class="o">*</span> <span class="mf">1.0d0</span>
<a name="ln-5704"></a>
<a name="ln-5705"></a>  <span class="k">RETURN</span>
<a name="ln-5706"></a>
<a name="ln-5707"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgExtHorizIllum</span>
<a name="ln-5708"></a>
<a name="ln-5709"></a><span class="k">SUBROUTINE </span><span class="n">DayltgCrossProduct</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
<a name="ln-5710"></a>
<a name="ln-5711"></a>
<a name="ln-5712"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5713"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-5714"></a>          <span class="c">!       DATE WRITTEN   unknown</span>
<a name="ln-5715"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5716"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5717"></a>
<a name="ln-5718"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5719"></a>          <span class="c">! This subroutine calculates Cross product between vectors A and B.</span>
<a name="ln-5720"></a>
<a name="ln-5721"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5722"></a>          <span class="c">! na</span>
<a name="ln-5723"></a>
<a name="ln-5724"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5725"></a>          <span class="c">! na</span>
<a name="ln-5726"></a>
<a name="ln-5727"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5728"></a>          <span class="c">! na</span>
<a name="ln-5729"></a>
<a name="ln-5730"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5731"></a>
<a name="ln-5732"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5733"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">B</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>          <span class="c">! Vector components: C = A X B</span>
<a name="ln-5734"></a>
<a name="ln-5735"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5736"></a>          <span class="c">! na</span>
<a name="ln-5737"></a>
<a name="ln-5738"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5739"></a>          <span class="c">! na</span>
<a name="ln-5740"></a>
<a name="ln-5741"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5742"></a>          <span class="c">! na</span>
<a name="ln-5743"></a>
<a name="ln-5744"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5745"></a>          <span class="c">! na</span>
<a name="ln-5746"></a>          <span class="c">! FLOW:</span>
<a name="ln-5747"></a>  <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">B</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5748"></a>  <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">B</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-5749"></a>  <span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5750"></a>
<a name="ln-5751"></a>  <span class="k">RETURN</span>
<a name="ln-5752"></a>
<a name="ln-5753"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgCrossProduct</span>
<a name="ln-5754"></a>
<a name="ln-5755"></a><span class="k">SUBROUTINE </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">,</span> <span class="n">R1</span><span class="p">,</span> <span class="n">RN</span><span class="p">,</span> <span class="n">IPIERC</span><span class="p">,</span> <span class="n">CP</span><span class="p">)</span>
<a name="ln-5756"></a>
<a name="ln-5757"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5758"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-5759"></a>          <span class="c">!       DATE WRITTEN   July 1997</span>
<a name="ln-5760"></a>          <span class="c">!       MODIFIED       Sept 2003, FCW: change shape test for rectangular surface to exclude</span>
<a name="ln-5761"></a>          <span class="c">!                       triangular windows (Surface%Shape=8)</span>
<a name="ln-5762"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5763"></a>
<a name="ln-5764"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5765"></a>          <span class="c">! Called to determine if (1) solar disk is visible from reference point,</span>
<a name="ln-5766"></a>          <span class="c">! (2) if a ray intersects an obstruction, or (3) if ray passes through an interior window.</span>
<a name="ln-5767"></a>          <span class="c">! Returns 0 if line through point R1 in direction of unit vector</span>
<a name="ln-5768"></a>          <span class="c">! RN does not intersect surface ISurf.</span>
<a name="ln-5769"></a>          <span class="c">!</span>
<a name="ln-5770"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5771"></a>
<a name="ln-5772"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5773"></a>          <span class="c">! Based on DOE-2.1E subroutine DPIERC.</span>
<a name="ln-5774"></a>
<a name="ln-5775"></a>          <span class="c">! USE STATEMENTS:na</span>
<a name="ln-5776"></a>
<a name="ln-5777"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5778"></a>
<a name="ln-5779"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5780"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ISurf</span>      <span class="c">! Surface index</span>
<a name="ln-5781"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">R1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>      <span class="c">! Point from which ray originates</span>
<a name="ln-5782"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RN</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>      <span class="c">! Unit vector along in direction of ray whose</span>
<a name="ln-5783"></a>                                             <span class="c">!  intersection with surface is to be determined</span>
<a name="ln-5784"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">IPIERC</span>     <span class="c">! =1 if line through point R1 in direction of unit vector</span>
<a name="ln-5785"></a>                                             <span class="c">!  RN intersects surface ISurf; =0 otherwise.</span>
<a name="ln-5786"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>      <span class="c">! Point that ray along RN intersects plane of surface</span>
<a name="ln-5787"></a>
<a name="ln-5788"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:na</span>
<a name="ln-5789"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:na</span>
<a name="ln-5790"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:na</span>
<a name="ln-5791"></a>
<a name="ln-5792"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5793"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">V1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                    <span class="c">! First vertex</span>
<a name="ln-5794"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">V2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                    <span class="c">! Second vertex</span>
<a name="ln-5795"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">V3</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                    <span class="c">! Third vertex</span>
<a name="ln-5796"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NV</span>                       <span class="c">! Number of vertices (3 or 4)</span>
<a name="ln-5797"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                    <span class="c">! Vector from vertex 1 to 2</span>
<a name="ln-5798"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                    <span class="c">! Vector from vertex 2 to 3</span>
<a name="ln-5799"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AXC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                   <span class="c">! Cross product of A and C</span>
<a name="ln-5800"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SN</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                    <span class="c">! Vector normal to surface (SN = A1 X A2)</span>
<a name="ln-5801"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AA</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                    <span class="c">! AA(I) = A(N,I)</span>
<a name="ln-5802"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                    <span class="c">! CC(I) = C(N,I)</span>
<a name="ln-5803"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CCC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                   <span class="c">! Vector from vertex 2 to CP</span>
<a name="ln-5804"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AAA</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                   <span class="c">! Vector from vertex 2 to vertex 1</span>
<a name="ln-5805"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BBB</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                   <span class="c">! Vector from vertex 2 to vertex 3</span>
<a name="ln-5806"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">N</span>                        <span class="c">! Vertex loop index</span>
<a name="ln-5807"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">I</span>                        <span class="c">! Vertex-to-vertex index</span>
<a name="ln-5808"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">F1</span><span class="p">,</span><span class="n">F2</span>                    <span class="c">! Intermediate variables</span>
<a name="ln-5809"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">SCALE</span>                    <span class="c">! Scale factor</span>
<a name="ln-5810"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DOTCB</span>                    <span class="c">! Dot product of vectors CCC and BBB</span>
<a name="ln-5811"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DOTCA</span>                    <span class="c">! Dot product of vectors CCC and AAA</span>
<a name="ln-5812"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DOTAXCSN</span>                 <span class="c">! Dot product of vectors AXC and SN</span>
<a name="ln-5813"></a>  <span class="c">! Following must be allocated to MaxVerticesPerSurface</span>
<a name="ln-5814"></a><span class="c">!  REAL(r64)      :: A(4,3)                   ! Vertex-to-vertex vectors; A(1,i) is from vertex 1 to 2, etc.</span>
<a name="ln-5815"></a><span class="c">!  REAL(r64)      :: C(4,3)                   ! Vectors from vertices to intersection point</span>
<a name="ln-5816"></a><span class="c">!  REAL(r64)      :: V(4,3)                   ! Vertices of surfaces</span>
<a name="ln-5817"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">A</span>   <span class="c">! Vertex-to-vertex vectors; A(1,i) is from vertex 1 to 2, etc.</span>
<a name="ln-5818"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">C</span>   <span class="c">! Vectors from vertices to intersection point</span>
<a name="ln-5819"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">V</span>   <span class="c">! Vertices of surfaces</span>
<a name="ln-5820"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">FirstTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5821"></a>
<a name="ln-5822"></a>          <span class="c">! FLOW:</span>
<a name="ln-5823"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FirstTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5824"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-5825"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-5826"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">V</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-5827"></a>    <span class="n">FirstTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5828"></a>  <span class="n">ENDIF</span>
<a name="ln-5829"></a>  <span class="n">IPIERC</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5830"></a>  <span class="c">! Vertex vectors</span>
<a name="ln-5831"></a>  <span class="n">NV</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-5832"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NV</span>
<a name="ln-5833"></a>    <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-5834"></a>    <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-5835"></a>    <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-5836"></a>  <span class="k">END DO</span>
<a name="ln-5837"></a>
<a name="ln-5838"></a>  <span class="c">! Vertex-to-vertex vectors. A(1,2) is from vertex 1 to 2, etc.</span>
<a name="ln-5839"></a>  <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-5840"></a>    <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NV</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5841"></a>      <span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">I</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5842"></a>    <span class="k">END DO</span>
<a name="ln-5843"></a><span class="k">    </span><span class="n">A</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">I</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5844"></a>    <span class="n">A1</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5845"></a>    <span class="n">A2</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5846"></a>    <span class="n">V1</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5847"></a>    <span class="n">V2</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5848"></a>    <span class="n">V3</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5849"></a>  <span class="k">END DO</span>
<a name="ln-5850"></a>
<a name="ln-5851"></a>  <span class="c">! Vector normal to surface</span>
<a name="ln-5852"></a>  <span class="k">CALL </span><span class="n">DayltgCrossProduct</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">SN</span><span class="p">)</span>
<a name="ln-5853"></a>  <span class="c">! Scale factor, the solution of SN.(CP-V2) = 0 and</span>
<a name="ln-5854"></a>  <span class="c">! CP = R1 + SCALE*RN, where CP is the point that RN,</span>
<a name="ln-5855"></a>  <span class="c">! when extended, intersects the plane of the surface.</span>
<a name="ln-5856"></a>  <span class="n">F1</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">SN</span><span class="p">,</span> <span class="n">V2</span> <span class="o">-</span> <span class="n">R1</span><span class="p">)</span>
<a name="ln-5857"></a>  <span class="n">F2</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">SN</span><span class="p">,</span> <span class="n">RN</span><span class="p">)</span>
<a name="ln-5858"></a>  <span class="c">! Skip surfaces that are parallel to RN</span>
<a name="ln-5859"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">F2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01d0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-5860"></a><span class="k">  </span><span class="nb">SCALE</span> <span class="o">=</span> <span class="n">F1</span> <span class="o">/</span> <span class="n">F2</span>
<a name="ln-5861"></a>  <span class="c">! Skip surfaces that RN points away from</span>
<a name="ln-5862"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">SCALE</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-5863"></a>  <span class="c">! Point that RN intersects plane of surface</span>
<a name="ln-5864"></a>  <span class="n">CP</span> <span class="o">=</span> <span class="n">R1</span> <span class="o">+</span> <span class="n">RN</span> <span class="o">*</span> <span class="nb">SCALE</span>
<a name="ln-5865"></a>  <span class="c">! Vector from vertex 2 to CP</span>
<a name="ln-5866"></a>  <span class="n">CCC</span> <span class="o">=</span> <span class="n">CP</span> <span class="o">-</span> <span class="n">V2</span>
<a name="ln-5867"></a>  <span class="c">! Two cases: rectangle and non-rectangle; do rectangle</span>
<a name="ln-5868"></a>  <span class="c">! first since most common shape and faster calculation</span>
<a name="ln-5869"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">==</span> <span class="n">Rectangle</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">==</span> <span class="n">RectangularDoorWindow</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5870"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">==</span> <span class="n">RectangularOverhang</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">==</span> <span class="n">RectangularLeftFin</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5871"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">==</span> <span class="n">RectangularRightFin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5872"></a>    <span class="c">!</span>
<a name="ln-5873"></a>    <span class="c">! Surface is rectangular</span>
<a name="ln-5874"></a>    <span class="c">!</span>
<a name="ln-5875"></a>    <span class="c">! Vectors from vertex 2 to vertex 1 and vertex 2 to vertex 3</span>
<a name="ln-5876"></a>    <span class="n">AAA</span> <span class="o">=</span> <span class="n">V1</span> <span class="o">-</span> <span class="n">V2</span>
<a name="ln-5877"></a>    <span class="n">BBB</span> <span class="o">=</span> <span class="n">V3</span> <span class="o">-</span> <span class="n">V2</span>
<a name="ln-5878"></a>    <span class="c">! Intersection point, CCC, is inside rectangle if</span>
<a name="ln-5879"></a>    <span class="c">! 0 &lt; CCC.BBB &lt; BBB.BBB AND 0 &lt; CCC.AAA &lt; AAA.AAA</span>
<a name="ln-5880"></a>    <span class="n">DOTCB</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">CCC</span><span class="p">,</span> <span class="n">BBB</span><span class="p">)</span>
<a name="ln-5881"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DOTCB</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-5882"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DOTCB</span> <span class="o">&gt;</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">BBB</span><span class="p">,</span><span class="n">BBB</span><span class="p">))</span> <span class="k">RETURN</span>
<a name="ln-5883"></a><span class="k">    </span><span class="n">DOTCA</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">CCC</span><span class="p">,</span> <span class="n">AAA</span><span class="p">)</span>
<a name="ln-5884"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DOTCA</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-5885"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DOTCA</span> <span class="o">&gt;</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">AAA</span><span class="p">,</span><span class="n">AAA</span><span class="p">))</span> <span class="k">RETURN</span>
<a name="ln-5886"></a>    <span class="c">! Surface is intersected</span>
<a name="ln-5887"></a>    <span class="n">IPIERC</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5888"></a>  <span class="k">ELSE</span>
<a name="ln-5889"></a>    <span class="c">!</span>
<a name="ln-5890"></a>    <span class="c">! Surface is not rectangular</span>
<a name="ln-5891"></a>    <span class="c">!</span>
<a name="ln-5892"></a>    <span class="c">! Vectors from surface vertices to CP</span>
<a name="ln-5893"></a>    <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NV</span>
<a name="ln-5894"></a>      <span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-5895"></a>        <span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">CP</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5896"></a>      <span class="k">END DO</span>
<a name="ln-5897"></a><span class="k">    END DO</span>
<a name="ln-5898"></a>    <span class="c">! Cross products of vertex-to-vertex vectors and</span>
<a name="ln-5899"></a>    <span class="c">! vertex-to-CP vectors</span>
<a name="ln-5900"></a>    <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NV</span>
<a name="ln-5901"></a>      <span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-5902"></a>        <span class="n">AA</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5903"></a>        <span class="n">CC</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5904"></a>      <span class="k">END DO</span>
<a name="ln-5905"></a><span class="k">      CALL </span><span class="n">DayltgCrossProduct</span><span class="p">(</span><span class="n">AA</span><span class="p">,</span><span class="n">CC</span><span class="p">,</span><span class="n">AXC</span><span class="p">)</span>
<a name="ln-5906"></a>      <span class="n">DOTAXCSN</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">AXC</span><span class="p">,</span><span class="n">SN</span><span class="p">)</span>
<a name="ln-5907"></a>       <span class="c">! If at least one of these dot products is negative</span>
<a name="ln-5908"></a>       <span class="c">! intersection point is outside of surface</span>
<a name="ln-5909"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DOTAXCSN</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-5910"></a><span class="k">    END DO</span>
<a name="ln-5911"></a>    <span class="c">! Surface is intersected</span>
<a name="ln-5912"></a>    <span class="n">IPIERC</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5913"></a>  <span class="k">END IF</span>
<a name="ln-5914"></a>
<a name="ln-5915"></a><span class="k">  RETURN</span>
<a name="ln-5916"></a>
<a name="ln-5917"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgPierceSurface</span>
<a name="ln-5918"></a>
<a name="ln-5919"></a><span class="k">SUBROUTINE </span><span class="n">DayltgHitObstruction</span><span class="p">(</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">IWin</span><span class="p">,</span><span class="n">R1</span><span class="p">,</span><span class="n">RN</span><span class="p">,</span><span class="n">ObTrans</span><span class="p">)</span>
<a name="ln-5920"></a>
<a name="ln-5921"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5922"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-5923"></a>          <span class="c">!       DATE WRITTEN   July 1997</span>
<a name="ln-5924"></a>          <span class="c">!       MODIFIED       FCW, May 2003: update list of surface classes that qualify as obstructions;</span>
<a name="ln-5925"></a>          <span class="c">!                        add interior surfaces as possible obstructors;</span>
<a name="ln-5926"></a>          <span class="c">!                        return from DO loop over surfaces as soon as any obstruction is hit;</span>
<a name="ln-5927"></a>          <span class="c">!                      FCW, July 2003: change from returning whether an obstruction is hit or not</span>
<a name="ln-5928"></a>          <span class="c">!                        to product of solar transmittances of hit obstructions.</span>
<a name="ln-5929"></a>          <span class="c">!                      FCW, Nov 2003: remove interior surfaces as possible obstructors since there</span>
<a name="ln-5930"></a>          <span class="c">!                        is now a separate check for interior obstructions; exclude windows and</span>
<a name="ln-5931"></a>          <span class="c">!                        doors as obstructors since if they are obstructors their base surfaces will</span>
<a name="ln-5932"></a>          <span class="c">!                        also be obstructors</span>
<a name="ln-5933"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5934"></a>
<a name="ln-5935"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5936"></a>          <span class="c">! Determines the product of the solar transmittances of the obstructions hit by a ray</span>
<a name="ln-5937"></a>          <span class="c">! from R1 in the direction of vector RN.</span>
<a name="ln-5938"></a>
<a name="ln-5939"></a>          <span class="c">! METHODOLOGY EMPLOYED:na</span>
<a name="ln-5940"></a>
<a name="ln-5941"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5942"></a>          <span class="c">! Based on DOE-2.1E subroutine DHITSH.</span>
<a name="ln-5943"></a>
<a name="ln-5944"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5945"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">LookUpScheduleValue</span>
<a name="ln-5946"></a>
<a name="ln-5947"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5948"></a>
<a name="ln-5949"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5950"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">IHOUR</span>             <span class="c">! Hour number</span>
<a name="ln-5951"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">IWin</span>              <span class="c">! Window index</span>
<a name="ln-5952"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">R1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>             <span class="c">! Origin of ray (m)</span>
<a name="ln-5953"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RN</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>             <span class="c">! Unit vector along ray</span>
<a name="ln-5954"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">ObTrans</span>           <span class="c">! Product of solar transmittances of exterior obstructions</span>
<a name="ln-5955"></a>                                                    <span class="c">!  (shading surfaces, building walls, etc.) that are hit</span>
<a name="ln-5956"></a>
<a name="ln-5957"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:na</span>
<a name="ln-5958"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:na</span>
<a name="ln-5959"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:na</span>
<a name="ln-5960"></a>
<a name="ln-5961"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5962"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ISurf</span>                        <span class="c">! Surface index</span>
<a name="ln-5963"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IType</span>                        <span class="c">! Surface type/class</span>
<a name="ln-5964"></a>                                            <span class="c">!  mirror surfaces of shading surfaces</span>
<a name="ln-5965"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                        <span class="c">! Hit coordinates, if ray hits an obstruction</span>
<a name="ln-5966"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">Pierce</span>                       <span class="c">! 1 if a particular obstruction is hit, 0 otherwise</span>
<a name="ln-5967"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Trans</span>                        <span class="c">! Solar transmittance of a shading surface</span>
<a name="ln-5968"></a>          <span class="c">! FLOW:</span>
<a name="ln-5969"></a>
<a name="ln-5970"></a>  <span class="n">ObTrans</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-5971"></a>
<a name="ln-5972"></a>  <span class="c">! Loop over obstructions, which can be building elements, like walls,</span>
<a name="ln-5973"></a>  <span class="c">! or shadowing surfaces, like overhangs. Exclude base surface of window IWin.</span>
<a name="ln-5974"></a>  <span class="c">! Building elements are assumed to be opaque. A shadowing surface is opaque unless</span>
<a name="ln-5975"></a>  <span class="c">! its transmittance schedule value is non-zero.</span>
<a name="ln-5976"></a>
<a name="ln-5977"></a>  <span class="k">DO </span><span class="n">ISurf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-5978"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadowSurfPossibleObstruction</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-5979"></a><span class="k">    </span><span class="n">IType</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="k">Class</span>
<a name="ln-5980"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">IType</span><span class="o">==</span><span class="n">SurfaceClass_Wall</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">IType</span><span class="o">==</span><span class="n">SurfaceClass_Roof</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">IType</span><span class="o">==</span><span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5981"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ISurf</span> <span class="o">/=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5982"></a><span class="k">      CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">,</span><span class="n">R1</span><span class="p">,</span><span class="n">RN</span><span class="p">,</span><span class="n">Pierce</span><span class="p">,</span><span class="n">HP</span><span class="p">)</span>
<a name="ln-5983"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Pierce</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Building element is hit (assumed opaque)</span>
<a name="ln-5984"></a>        <span class="n">ObTrans</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5985"></a>        <span class="k">EXIT</span>
<a name="ln-5986"></a><span class="k">      END IF</span>
<a name="ln-5987"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadowingSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5988"></a>      <span class="c">!!fw following check on mirror shadow surface can be removed with addition of above</span>
<a name="ln-5989"></a>      <span class="c">!!fw check on ShadowSurfPossibleObstruction (which is false for mirror shadow surfaces)</span>
<a name="ln-5990"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">MirroredSurf</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! This check skips mirror surfaces</span>
<a name="ln-5991"></a>        <span class="k">CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">,</span><span class="n">R1</span><span class="p">,</span><span class="n">RN</span><span class="p">,</span><span class="n">Pierce</span><span class="p">,</span><span class="n">HP</span><span class="p">)</span>
<a name="ln-5992"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Pierce</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Shading surface is hit</span>
<a name="ln-5993"></a>          <span class="c">! Get solar transmittance of the shading surface</span>
<a name="ln-5994"></a>          <span class="n">Trans</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5995"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5996"></a>                 <span class="n">Trans</span> <span class="o">=</span> <span class="n">LookUpScheduleValue</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="p">,</span><span class="n">IHOUR</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5997"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Trans</span> <span class="o">&lt;</span> <span class="mf">1.d-6</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5998"></a><span class="k">            </span><span class="n">ObTrans</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5999"></a>            <span class="k">EXIT</span>
<a name="ln-6000"></a><span class="k">          ELSE</span>
<a name="ln-6001"></a><span class="k">            </span><span class="n">ObTrans</span> <span class="o">=</span> <span class="n">Obtrans</span> <span class="o">*</span> <span class="n">Trans</span>
<a name="ln-6002"></a>          <span class="k">END IF</span>
<a name="ln-6003"></a><span class="k">        END IF</span>
<a name="ln-6004"></a><span class="k">      END IF</span>
<a name="ln-6005"></a><span class="k">    END IF</span>  <span class="c">! End of test if building element or shading surface</span>
<a name="ln-6006"></a>  <span class="k">END DO</span>
<a name="ln-6007"></a>
<a name="ln-6008"></a><span class="k">  RETURN</span>
<a name="ln-6009"></a>
<a name="ln-6010"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgHitObstruction</span>
<a name="ln-6011"></a>
<a name="ln-6012"></a>
<a name="ln-6013"></a><span class="k">SUBROUTINE </span><span class="n">DayltgHitInteriorObstruction</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span><span class="n">R1</span><span class="p">,</span><span class="n">R2</span><span class="p">,</span><span class="n">IHIT</span><span class="p">)</span>
<a name="ln-6014"></a>
<a name="ln-6015"></a>
<a name="ln-6016"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6017"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-6018"></a>          <span class="c">!       DATE WRITTEN   July 1997</span>
<a name="ln-6019"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6020"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6021"></a>
<a name="ln-6022"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6023"></a>          <span class="c">! This subroutine checks for interior obstructions between reference point and window element.</span>
<a name="ln-6024"></a>
<a name="ln-6025"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6026"></a>          <span class="c">! na</span>
<a name="ln-6027"></a>
<a name="ln-6028"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6029"></a>          <span class="c">! na</span>
<a name="ln-6030"></a>
<a name="ln-6031"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6032"></a>          <span class="c">! na</span>
<a name="ln-6033"></a>
<a name="ln-6034"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6035"></a>
<a name="ln-6036"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6037"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">IWin</span>              <span class="c">! Window index</span>
<a name="ln-6038"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">R1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>             <span class="c">! Origin of ray (m)</span>
<a name="ln-6039"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">R2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>             <span class="c">! Destination of ray (m)</span>
<a name="ln-6040"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">IHIT</span>              <span class="c">! Hit flag: 1 = ray hits an obstruction, 0 = does not</span>
<a name="ln-6041"></a>
<a name="ln-6042"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6043"></a>          <span class="c">! na</span>
<a name="ln-6044"></a>
<a name="ln-6045"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6046"></a>          <span class="c">! na</span>
<a name="ln-6047"></a>
<a name="ln-6048"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6049"></a>          <span class="c">! na</span>
<a name="ln-6050"></a>
<a name="ln-6051"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6052"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ISurf</span>                        <span class="c">! Surface index</span>
<a name="ln-6053"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IType</span>                        <span class="c">! Surface type/class</span>
<a name="ln-6054"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                        <span class="c">! Hit coordinates, if ray hits an obstruction</span>
<a name="ln-6055"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">r12</span>                          <span class="c">! Distance between R1 and R2</span>
<a name="ln-6056"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">d</span>                            <span class="c">! Distance between R1 and pierced surface</span>
<a name="ln-6057"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RN</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                        <span class="c">! Unit vector along ray</span>
<a name="ln-6058"></a>
<a name="ln-6059"></a>          <span class="c">! FLOW:</span>
<a name="ln-6060"></a>  <span class="n">IHIT</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6061"></a>
<a name="ln-6062"></a>  <span class="n">r12</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">R1</span> <span class="o">-</span> <span class="n">R2</span><span class="p">,</span><span class="n">R1</span> <span class="o">-</span> <span class="n">R2</span><span class="p">))</span>
<a name="ln-6063"></a>  <span class="n">RN</span> <span class="o">=</span> <span class="n">R2</span> <span class="o">-</span> <span class="n">R1</span>
<a name="ln-6064"></a>  <span class="n">RN</span> <span class="o">=</span> <span class="n">RN</span> <span class="o">/</span> <span class="p">(</span><span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">RN</span><span class="p">,</span><span class="n">RN</span><span class="p">)))</span> <span class="c">! Make unit vector</span>
<a name="ln-6065"></a>
<a name="ln-6066"></a>  <span class="c">! Loop over obstructions, which can be building elements, like walls,</span>
<a name="ln-6067"></a>  <span class="c">! or shadowing surfaces, like overhangs. Exclude base surface of window IWin.</span>
<a name="ln-6068"></a>  <span class="k">DO </span><span class="n">ISurf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-6069"></a>    <span class="n">IType</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="k">Class</span>
<a name="ln-6070"></a>
<a name="ln-6071"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">IType</span><span class="o">==</span><span class="n">SurfaceClass_Wall</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">IType</span><span class="o">==</span><span class="n">SurfaceClass_Roof</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">IType</span><span class="o">==</span><span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6072"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ISurf</span> <span class="o">/=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ISurf</span> <span class="o">/=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6073"></a>
<a name="ln-6074"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Wall/ceiling/floor is in same zone as window</span>
<a name="ln-6075"></a>        <span class="k">CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">,</span><span class="n">R1</span><span class="p">,</span><span class="n">RN</span><span class="p">,</span><span class="n">IHIT</span><span class="p">,</span><span class="n">HP</span><span class="p">)</span>
<a name="ln-6076"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IHIT</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6077"></a><span class="k">          </span><span class="n">d</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">R1</span> <span class="o">-</span> <span class="n">HP</span><span class="p">,</span><span class="n">R1</span> <span class="o">-</span> <span class="n">HP</span><span class="p">))</span>
<a name="ln-6078"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">d</span> <span class="o">&gt;</span> <span class="n">r12</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Discount any hits farther than the window.</span>
<a name="ln-6079"></a>            <span class="n">IHIT</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6080"></a>          <span class="k">ELSE</span>               <span class="c">! The hit is closer than the window.</span>
<a name="ln-6081"></a>            <span class="k">EXIT</span>
<a name="ln-6082"></a><span class="k">          END IF</span>
<a name="ln-6083"></a><span class="k">        END IF</span>
<a name="ln-6084"></a><span class="k">      END IF</span>
<a name="ln-6085"></a>
<a name="ln-6086"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadowingSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6087"></a>
<a name="ln-6088"></a><span class="k">      CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">,</span><span class="n">R1</span><span class="p">,</span><span class="n">RN</span><span class="p">,</span><span class="n">IHIT</span><span class="p">,</span><span class="n">HP</span><span class="p">)</span>
<a name="ln-6089"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IHIT</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6090"></a><span class="k">        </span><span class="n">d</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">R1</span> <span class="o">-</span> <span class="n">HP</span><span class="p">,</span><span class="n">R1</span> <span class="o">-</span> <span class="n">HP</span><span class="p">))</span>
<a name="ln-6091"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">d</span> <span class="o">&gt;</span> <span class="n">r12</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Discount any hits farther than the window.</span>
<a name="ln-6092"></a>          <span class="n">IHIT</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6093"></a>        <span class="k">ELSE</span>               <span class="c">! The hit is closer than the window.</span>
<a name="ln-6094"></a>          <span class="k">EXIT</span>
<a name="ln-6095"></a><span class="k">        END IF</span>
<a name="ln-6096"></a><span class="k">      END IF</span>
<a name="ln-6097"></a>
<a name="ln-6098"></a><span class="k">    END IF</span>
<a name="ln-6099"></a><span class="k">  END DO</span>
<a name="ln-6100"></a>
<a name="ln-6101"></a><span class="k">  RETURN</span>
<a name="ln-6102"></a>
<a name="ln-6103"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgHitInteriorObstruction</span>
<a name="ln-6104"></a>
<a name="ln-6105"></a><span class="k">SUBROUTINE </span><span class="n">DayltgHitBetWinObstruction</span><span class="p">(</span><span class="n">IWin1</span><span class="p">,</span><span class="n">IWin2</span><span class="p">,</span><span class="n">R1</span><span class="p">,</span><span class="n">R2</span><span class="p">,</span><span class="n">IHIT</span><span class="p">)</span>
<a name="ln-6106"></a>
<a name="ln-6107"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6108"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-6109"></a>          <span class="c">!       DATE WRITTEN   Feb 2004</span>
<a name="ln-6110"></a>          <span class="c">!       MODIFIED na</span>
<a name="ln-6111"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6112"></a>
<a name="ln-6113"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6114"></a>          <span class="c">! Determines if a ray from point R1 on window IWin1 to point R2</span>
<a name="ln-6115"></a>          <span class="c">! on window IWin2 hits an obstruction</span>
<a name="ln-6116"></a>
<a name="ln-6117"></a>          <span class="c">! METHODOLOGY EMPLOYED:na</span>
<a name="ln-6118"></a>          <span class="c">! REFERENCES:na</span>
<a name="ln-6119"></a>          <span class="c">! USE STATEMENTS:na</span>
<a name="ln-6120"></a>
<a name="ln-6121"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6122"></a>
<a name="ln-6123"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6124"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">IWin1</span>             <span class="c">! Surface number of origin window</span>
<a name="ln-6125"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">IWin2</span>             <span class="c">! Surface number of destination window</span>
<a name="ln-6126"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">R1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>             <span class="c">! Origin of ray (on IWin1) (m)</span>
<a name="ln-6127"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">R2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>             <span class="c">! Destination of ray (on IWin2) (m)</span>
<a name="ln-6128"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">IHIT</span>              <span class="c">! Hit flag: 1 = ray hits an obstruction, 0 = does not</span>
<a name="ln-6129"></a>
<a name="ln-6130"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS: na</span>
<a name="ln-6131"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS: na</span>
<a name="ln-6132"></a>          <span class="c">! DERIVED TYPE DEFINITIONS: na</span>
<a name="ln-6133"></a>
<a name="ln-6134"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6135"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ISurf</span>                        <span class="c">! Surface index</span>
<a name="ln-6136"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IType</span>                        <span class="c">! Surface type/class</span>
<a name="ln-6137"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                        <span class="c">! Hit coordinates, if ray hits an obstruction surface (m)</span>
<a name="ln-6138"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">r12</span>                          <span class="c">! Distance between R1 and R2 (m)</span>
<a name="ln-6139"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">d</span>                            <span class="c">! Distance between R1 and obstruction surface (m)</span>
<a name="ln-6140"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RN</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                        <span class="c">! Unit vector along ray from R1 to R2</span>
<a name="ln-6141"></a>
<a name="ln-6142"></a>          <span class="c">! FLOW:</span>
<a name="ln-6143"></a>  <span class="n">IHIT</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6144"></a>
<a name="ln-6145"></a>  <span class="n">r12</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">R1</span> <span class="o">-</span> <span class="n">R2</span><span class="p">,</span><span class="n">R1</span> <span class="o">-</span> <span class="n">R2</span><span class="p">))</span>
<a name="ln-6146"></a>  <span class="n">RN</span> <span class="o">=</span> <span class="n">R2</span> <span class="o">-</span> <span class="n">R1</span>
<a name="ln-6147"></a>  <span class="n">RN</span> <span class="o">=</span> <span class="n">RN</span> <span class="o">/</span> <span class="p">(</span><span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">RN</span><span class="p">,</span><span class="n">RN</span><span class="p">)))</span> <span class="c">! Unit vector</span>
<a name="ln-6148"></a>
<a name="ln-6149"></a>  <span class="c">! Loop over obstructions, which can be building elements, like walls,</span>
<a name="ln-6150"></a>  <span class="c">! or shadowing surfaces, like overhangs. Exclude base surface of window IWin1.</span>
<a name="ln-6151"></a>  <span class="c">! Exclude base surface of window IWin2.</span>
<a name="ln-6152"></a>  <span class="k">DO </span><span class="n">ISurf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-6153"></a>    <span class="n">IType</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="k">Class</span>
<a name="ln-6154"></a>
<a name="ln-6155"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">IType</span><span class="o">==</span><span class="n">SurfaceClass_Wall</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">IType</span><span class="o">==</span><span class="n">SurfaceClass_Roof</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">IType</span><span class="o">==</span><span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6156"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ISurf</span> <span class="o">/=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ISurf</span> <span class="o">/=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin1</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="p">&amp;</span>
<a name="ln-6157"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ISurf</span> <span class="o">/=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="p">&amp;</span>
<a name="ln-6158"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ISurf</span> <span class="o">/=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin1</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6159"></a>
<a name="ln-6160"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin2</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Wall/ceiling/floor is in same zone as destination window</span>
<a name="ln-6161"></a>        <span class="k">CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">,</span><span class="n">R1</span><span class="p">,</span><span class="n">RN</span><span class="p">,</span><span class="n">IHIT</span><span class="p">,</span><span class="n">HP</span><span class="p">)</span>
<a name="ln-6162"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IHIT</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6163"></a><span class="k">          </span><span class="n">d</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">R1</span> <span class="o">-</span> <span class="n">HP</span><span class="p">,</span><span class="n">R1</span> <span class="o">-</span> <span class="n">HP</span><span class="p">))</span>
<a name="ln-6164"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">d</span> <span class="o">&gt;</span> <span class="n">r12</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Discount any hits farther than the window.</span>
<a name="ln-6165"></a>            <span class="n">IHIT</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6166"></a>          <span class="k">ELSE</span>               <span class="c">! The hit is closer than the window.</span>
<a name="ln-6167"></a>            <span class="k">EXIT</span>
<a name="ln-6168"></a><span class="k">          END IF</span>
<a name="ln-6169"></a><span class="k">        END IF</span>
<a name="ln-6170"></a><span class="k">      END IF</span>
<a name="ln-6171"></a>
<a name="ln-6172"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadowingSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6173"></a>
<a name="ln-6174"></a><span class="k">      CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">,</span><span class="n">R1</span><span class="p">,</span><span class="n">RN</span><span class="p">,</span><span class="n">IHIT</span><span class="p">,</span><span class="n">HP</span><span class="p">)</span>
<a name="ln-6175"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IHIT</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6176"></a><span class="k">        </span><span class="n">d</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">R1</span> <span class="o">-</span> <span class="n">HP</span><span class="p">,</span><span class="n">R1</span> <span class="o">-</span> <span class="n">HP</span><span class="p">))</span>
<a name="ln-6177"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">d</span> <span class="o">&gt;</span> <span class="n">r12</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Discount any hits farther than the window.</span>
<a name="ln-6178"></a>          <span class="n">IHIT</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6179"></a>        <span class="k">ELSE</span>               <span class="c">! The hit is closer than the window.</span>
<a name="ln-6180"></a>          <span class="k">EXIT</span>
<a name="ln-6181"></a><span class="k">        END IF</span>
<a name="ln-6182"></a><span class="k">      END IF</span>
<a name="ln-6183"></a>
<a name="ln-6184"></a><span class="k">    END IF</span>
<a name="ln-6185"></a><span class="k">  END DO</span>
<a name="ln-6186"></a>
<a name="ln-6187"></a><span class="k">  RETURN</span>
<a name="ln-6188"></a>
<a name="ln-6189"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgHitBetWinObstruction</span>
<a name="ln-6190"></a>
<a name="ln-6191"></a><span class="k">SUBROUTINE </span><span class="n">DayltgInteriorIllum</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-6192"></a>
<a name="ln-6193"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6194"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-6195"></a>          <span class="c">!       DATE WRITTEN   July 1997</span>
<a name="ln-6196"></a>          <span class="c">!       MODIFIED       March 2000, FCW: interpolate clear-sky daylight factors using</span>
<a name="ln-6197"></a>          <span class="c">!                      HourOfDay/WeightNow and NextHour/WeightNextHour. Previously</span>
<a name="ln-6198"></a>          <span class="c">!                      only HourOfDay was used</span>
<a name="ln-6199"></a>          <span class="c">!                      Jan 2001, FCW: interpolate in slat angle for windows with blinds</span>
<a name="ln-6200"></a>          <span class="c">!                      that have movable slats</span>
<a name="ln-6201"></a>          <span class="c">!                      Oct 2002, LKL: changed interpolation steps to HourOfDay/WeightNow</span>
<a name="ln-6202"></a>          <span class="c">!                      LastHour/WeightPreviousHour</span>
<a name="ln-6203"></a>          <span class="c">!                      Aug 2003, FCW: fix bug that prevented ShadingControlType =</span>
<a name="ln-6204"></a>          <span class="c">!                      MEETDAYLIGHTILLUMINANCESETPOINT from working</span>
<a name="ln-6205"></a>          <span class="c">!                      Mar 2004, FCW: fix bug in calc of illuminance setpoint contribution</span>
<a name="ln-6206"></a>          <span class="c">!                      to background luminance: now it is divided by pi to give cd/m2</span>
<a name="ln-6207"></a>          <span class="c">!                      Mar 2004, FCW: modify to handle daylighting through interior windows</span>
<a name="ln-6208"></a>          <span class="c">!                      June 2009, TH: modified for thermochromic windows</span>
<a name="ln-6209"></a>          <span class="c">!                      Jan 2010, TH (CR 7984): added iterations for switchable windows with shading</span>
<a name="ln-6210"></a>          <span class="c">!                       control of MeetDaylightIlluminanceSetpoint and glare control is active</span>
<a name="ln-6211"></a>          <span class="c">!                       Also corrected bugs (CR 7988) for switchable glazings not related to CR 7984</span>
<a name="ln-6212"></a>
<a name="ln-6213"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6214"></a>
<a name="ln-6215"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6216"></a>          <span class="c">! Using daylighting factors and exterior illuminance, determine</span>
<a name="ln-6217"></a>          <span class="c">! the current-hour interior daylight illuminance and glare index</span>
<a name="ln-6218"></a>          <span class="c">! at each reference point in a space. Deploy window shading window by window</span>
<a name="ln-6219"></a>          <span class="c">! if glare control is active for window and if the acceptable glare index</span>
<a name="ln-6220"></a>          <span class="c">! is exceeded at both reference points.</span>
<a name="ln-6221"></a>
<a name="ln-6222"></a>          <span class="c">! Called by InitSurfaceHeatBalance.</span>
<a name="ln-6223"></a>
<a name="ln-6224"></a>          <span class="c">! METHODOLOGY EMPLOYED:na</span>
<a name="ln-6225"></a>
<a name="ln-6226"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6227"></a>          <span class="c">! Based on DOE-2.1E subroutine DINTIL.</span>
<a name="ln-6228"></a>
<a name="ln-6229"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6230"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">POLYF</span><span class="p">,</span> <span class="n">InterpSlatAng</span>
<a name="ln-6231"></a>
<a name="ln-6232"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6233"></a>
<a name="ln-6234"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6235"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ZoneNum</span>               <span class="c">! Zone number</span>
<a name="ln-6236"></a>
<a name="ln-6237"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6238"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">tmpSWIterStep</span> <span class="o">=</span> <span class="mf">0.05d0</span> <span class="c">! step of switching factor, assuming maximum of 20 switching states</span>
<a name="ln-6239"></a>
<a name="ln-6240"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6241"></a>          <span class="c">! na</span>
<a name="ln-6242"></a>
<a name="ln-6243"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6244"></a>          <span class="c">! na</span>
<a name="ln-6245"></a>
<a name="ln-6246"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6247"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NREFPT</span>                <span class="c">! Number of daylighting reference points</span>
<a name="ln-6248"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ISky</span>                  <span class="c">! Sky type index</span>
<a name="ln-6249"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ISky1</span><span class="p">,</span> <span class="n">ISky2</span>          <span class="c">! Sky type index values for averaging two sky types</span>
<a name="ln-6250"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SetPnt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>             <span class="c">! Illuminance setpoint at reference points (lux)</span>
<a name="ln-6251"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DFSKHR</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>           <span class="c">! Sky daylight factor for sky type (first index),</span>
<a name="ln-6252"></a>                                     <span class="c">!   bare/shaded window (second index)</span>
<a name="ln-6253"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>             <span class="c">! Sun daylight factor for bare/shaded window</span>
<a name="ln-6254"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BFSKHR</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>           <span class="c">! Sky background luminance factor for sky type (first index),</span>
<a name="ln-6255"></a>                                     <span class="c">!   bare/shaded window (second index)</span>
<a name="ln-6256"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>             <span class="c">! Sun background luminance factor for bare/shaded window</span>
<a name="ln-6257"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SFSKHR</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>           <span class="c">! Sky source luminance factor for sky type (first index),</span>
<a name="ln-6258"></a>                                     <span class="c">!   bare/shaded window (second index)</span>
<a name="ln-6259"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>             <span class="c">! Sun source luminance factor for bare/shaded window</span>
<a name="ln-6260"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WDAYIL</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>           <span class="c">! Illuminance from window at reference point (first index)</span>
<a name="ln-6261"></a>                                     <span class="c">!   for shade open/closed (second index)</span>
<a name="ln-6262"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WBACLU</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>           <span class="c">! Background illuminance from window at reference point (first index)</span>
<a name="ln-6263"></a>                                     <span class="c">!   for shade open/closed (second index)</span>
<a name="ln-6264"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RDAYIL</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>             <span class="c">! Illuminance from window at reference point after closing shade</span>
<a name="ln-6265"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RBACLU</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>             <span class="c">! Background illuminance from window at reference point after closing shade</span>
<a name="ln-6266"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GLRNDX</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>             <span class="c">! Glare index at reference point</span>
<a name="ln-6267"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GLRNEW</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>             <span class="c">! New glare index at reference point</span>
<a name="ln-6268"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IL</span>                    <span class="c">! Reference point index</span>
<a name="ln-6269"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IWin</span>                  <span class="c">! Window index</span>
<a name="ln-6270"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="k">IS</span>                    <span class="c">! IS=1 for unshaded window, =2 for shaded window</span>
<a name="ln-6271"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ISWFLG</span>                <span class="c">! Switchable glazing flag: =1 if one or more windows in a zone</span>
<a name="ln-6272"></a>                                     <span class="c">!  has switchable glazing that adjusts visible transmittance to just meet</span>
<a name="ln-6273"></a>                                     <span class="c">!  daylighting setpoint; =0 otherwise.</span>
<a name="ln-6274"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IConst</span>                <span class="c">! Window construction pointer</span>
<a name="ln-6275"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IConstShaded</span>          <span class="c">! Pointer to shaded window construction</span>
<a name="ln-6276"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ICtrl</span>                 <span class="c">! Window shading control pointer</span>
<a name="ln-6277"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DILLSW</span><span class="p">,</span><span class="n">DILLUN</span>         <span class="c">! Illuminance a ref point from windows that can be switched,</span>
<a name="ln-6278"></a>                                     <span class="c">!  and from those that can&#39;t (lux)</span>
<a name="ln-6279"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ASETIL</span>                <span class="c">! Illuminance ratio (lux)</span>
<a name="ln-6280"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVIS1</span>                 <span class="c">! Visible transmittance at normal incidence of unswitched glazing</span>
<a name="ln-6281"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVIS2</span>                 <span class="c">! Visible transmittance at normal incidence of fully-switched glazing</span>
<a name="ln-6282"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VTRAT</span>                 <span class="c">! Ratio between switched and unswitched visible transmittance at normal incidence</span>
<a name="ln-6283"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BACL</span>                  <span class="c">! Window background (surround) luminance for glare calc (cd/m2)</span>
<a name="ln-6284"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyWeight</span>             <span class="c">! Weighting factor used to average two different sky types</span>
<a name="ln-6285"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HorIllSky</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>          <span class="c">! Horizontal illuminance for different sky types</span>
<a name="ln-6286"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HorIllSkyFac</span>          <span class="c">! Ratio between horizontal illuminance from sky horizontal irradiance and</span>
<a name="ln-6287"></a>                                     <span class="c">!   luminous efficacy and horizontal illuminance from averaged sky</span>
<a name="ln-6288"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SlatAng</span>               <span class="c">! Blind slat angle (rad)</span>
<a name="ln-6289"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">VarSlats</span>              <span class="c">! True if slats are movable, i.e., variable angle</span>
<a name="ln-6290"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">GlareFlag</span>             <span class="c">! True if maximum glare is exceeded</span>
<a name="ln-6291"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">loop</span>                  <span class="c">! Loop index</span>
<a name="ln-6292"></a>
<a name="ln-6293"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VTRatio</span>               <span class="c">! VT (visible transmittance) ratio = VTNow / VTMaster</span>
<a name="ln-6294"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VTNow</span>                 <span class="c">! VT of the time step actual TC window</span>
<a name="ln-6295"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VTMaster</span>              <span class="c">! VT of the base/master TC window</span>
<a name="ln-6296"></a>
<a name="ln-6297"></a>  <span class="c">! Added variables for glare iterations for switchable glazings</span>
<a name="ln-6298"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpSWSL1</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6299"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpSWSL2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6300"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpSWFactor</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! new switching factor to meet glare criteria</span>
<a name="ln-6301"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpSWFactor0</span>  <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! original switching factor to meet daylight illuminance</span>
<a name="ln-6302"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpMult</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6303"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">GlareOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">False</span><span class="p">.</span>
<a name="ln-6304"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">tmpIllumFromWinAtRefPt</span>
<a name="ln-6305"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">tmpBackLumFromWinAtRefPt</span>
<a name="ln-6306"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">tmpSourceLumFromWinAtRefPt</span>
<a name="ln-6307"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">firsttime</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>  <span class="c">! true first time routine is called</span>
<a name="ln-6308"></a>
<a name="ln-6309"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">blnCycle</span> <span class="o">=</span> <span class="p">.</span><span class="n">False</span><span class="p">.</span>
<a name="ln-6310"></a>
<a name="ln-6311"></a>  <span class="c">! Three arrays to save original clear and dark (fully switched) states&#39;</span>
<a name="ln-6312"></a>  <span class="c">!  zone/window daylighting properties.</span>
<a name="ln-6313"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">firsttime</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6314"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">tmpIllumFromWinAtRefPt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Zone</span><span class="p">%</span><span class="n">NumSubSurfaces</span><span class="p">),</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">%</span><span class="n">NumOfDayltgExtWins</span><span class="p">))))</span>
<a name="ln-6315"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">tmpBackLumFromWinAtRefPt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Zone</span><span class="p">%</span><span class="n">NumSubSurfaces</span><span class="p">),</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">%</span><span class="n">NumOfDayltgExtWins</span><span class="p">))))</span>
<a name="ln-6316"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">tmpSourceLumFromWinAtRefPt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Zone</span><span class="p">%</span><span class="n">NumSubSurfaces</span><span class="p">),</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">%</span><span class="n">NumOfDayltgExtWins</span><span class="p">))))</span>
<a name="ln-6317"></a>    <span class="n">firsttime</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6318"></a>  <span class="n">ENDIF</span>
<a name="ln-6319"></a>  <span class="n">tmpIllumFromWinAtRefPt</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6320"></a>  <span class="n">tmpBackLumFromWinAtRefPt</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6321"></a>  <span class="n">tmpSourceLumFromWinAtRefPt</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6322"></a>
<a name="ln-6323"></a>          <span class="c">! FLOW:</span>
<a name="ln-6324"></a>  <span class="c">! Limit the number of control reference points to 2</span>
<a name="ln-6325"></a>  <span class="n">NREFPT</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span>
<a name="ln-6326"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NREFPT</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="n">NREFPT</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-6327"></a>
<a name="ln-6328"></a>  <span class="c">! Initialize reference point illuminance and window background luminance</span>
<a name="ln-6329"></a>  <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-6330"></a>    <span class="n">SetPnt</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumSetPoint</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span>
<a name="ln-6331"></a>    <span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6332"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BacLum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6333"></a>  <span class="k">END DO</span>
<a name="ln-6334"></a>
<a name="ln-6335"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SkyClearness</span> <span class="o">&gt;</span> <span class="mf">3.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Sky is average of clear and clear turbid</span>
<a name="ln-6336"></a>    <span class="n">SkyWeight</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,(</span><span class="n">SkyClearness</span><span class="o">-</span><span class="mf">3.d0</span><span class="p">)</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">)</span>
<a name="ln-6337"></a>    <span class="n">ISky1</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-6338"></a>    <span class="n">ISky2</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-6339"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SkyClearness</span> <span class="o">&gt;</span> <span class="mf">1.2d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Sky is average of clear turbid and intermediate</span>
<a name="ln-6340"></a>    <span class="n">SkyWeight</span> <span class="o">=</span> <span class="p">(</span><span class="n">SkyClearness</span> <span class="o">-</span> <span class="mf">1.2d0</span><span class="p">)</span><span class="o">/</span><span class="mf">1.8d0</span>
<a name="ln-6341"></a>    <span class="n">ISky1</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-6342"></a>    <span class="n">ISky2</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-6343"></a>  <span class="k">ELSE</span> <span class="c">! Sky is average of intermediate and overcast</span>
<a name="ln-6344"></a>    <span class="n">SkyWeight</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">SkyClearness</span><span class="o">-</span><span class="mf">1.d0</span><span class="p">)</span><span class="o">/</span><span class="mf">0.2d0</span><span class="p">,</span> <span class="p">(</span><span class="n">SkyBrightness</span><span class="o">-</span><span class="mf">0.05d0</span><span class="p">)</span><span class="o">/</span><span class="mf">0.4d0</span><span class="p">))</span>
<a name="ln-6345"></a>    <span class="n">ISky1</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-6346"></a>    <span class="n">ISky2</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-6347"></a>  <span class="k">END IF</span>
<a name="ln-6348"></a>
<a name="ln-6349"></a>  <span class="c">! First loop over exterior windows associated with this zone. The window may be an exterior window in</span>
<a name="ln-6350"></a>  <span class="c">! the zone or an exterior window in an adjacent zone that shares an interior window with the zone.</span>
<a name="ln-6351"></a>  <span class="c">! Find contribution of each window to the daylight illum and to the glare numerator at each reference point.</span>
<a name="ln-6352"></a>  <span class="c">! Use shading flags set in WindowShadingManager.</span>
<a name="ln-6353"></a>  <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span>
<a name="ln-6354"></a>    <span class="n">IWin</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6355"></a>
<a name="ln-6356"></a>    <span class="c">! Added TH 6/29/2009 for thermochromic windows</span>
<a name="ln-6357"></a>    <span class="n">VTRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6358"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NREFPT</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6359"></a><span class="k">      </span><span class="n">IConst</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-6360"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TCFlag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6361"></a>        <span class="c">! For thermochromic windows, daylight and glare factors are always calculated</span>
<a name="ln-6362"></a>        <span class="c">!  based on the master construction. They need to be adjusted by the VTRatio, including:</span>
<a name="ln-6363"></a>        <span class="c">!  ZoneDaylight()%DaylIllFacSky, DaylIllFacSun, DaylIllFacSunDisk; DaylBackFacSky,</span>
<a name="ln-6364"></a>        <span class="c">!  DaylBackFacSun, DaylBackFacSunDisk, DaylSourceFacSky, DaylSourceFacSun, DaylSourceFacSunDisk</span>
<a name="ln-6365"></a>        <span class="n">VTNow</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-6366"></a>        <span class="n">VTMaster</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TCMasterConst</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-6367"></a>        <span class="n">VTRatio</span> <span class="o">=</span> <span class="n">VTNow</span> <span class="o">/</span> <span class="n">VTMaster</span>
<a name="ln-6368"></a>      <span class="n">ENDIF</span>
<a name="ln-6369"></a>    <span class="n">ENDIF</span>
<a name="ln-6370"></a>
<a name="ln-6371"></a>    <span class="c">! Loop over reference points</span>
<a name="ln-6372"></a>    <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NREFPT</span>
<a name="ln-6373"></a>
<a name="ln-6374"></a>      <span class="c">! Daylight factors for current sun position</span>
<a name="ln-6375"></a>      <span class="k">DO </span><span class="n">ISky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-6376"></a>
<a name="ln-6377"></a>        <span class="c">! ===Bare window===</span>
<a name="ln-6378"></a>        <span class="n">DFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6379"></a>                         <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-6380"></a>
<a name="ln-6381"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">DFSUHR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-6382"></a>                                                <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6383"></a>                                   <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-6384"></a>                                                         <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-6385"></a>
<a name="ln-6386"></a>        <span class="n">BFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6387"></a>                         <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-6388"></a>
<a name="ln-6389"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">BFSUHR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-6390"></a>                                                <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6391"></a>                         <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-6392"></a>                                                <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-6393"></a>
<a name="ln-6394"></a>        <span class="n">SFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6395"></a>                         <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-6396"></a>
<a name="ln-6397"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">SFSUHR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-6398"></a>                                                <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6399"></a>                      <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-6400"></a>                                            <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-6401"></a>
<a name="ln-6402"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6403"></a>
<a name="ln-6404"></a>          <span class="c">! ===Shaded window or window with diffusing glass===</span>
<a name="ln-6405"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6406"></a>            <span class="c">! Shade, screen, blind with fixed slats, or diffusing glass</span>
<a name="ln-6407"></a>            <span class="n">DFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6408"></a>                             <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-6409"></a>
<a name="ln-6410"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6411"></a><span class="k">              </span><span class="n">DFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-6412"></a>                          <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-6413"></a>
<a name="ln-6414"></a>
<a name="ln-6415"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6416"></a>                <span class="n">DFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6417"></a>                                        <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-6418"></a>            <span class="k">END IF</span>
<a name="ln-6419"></a>
<a name="ln-6420"></a><span class="k">            </span><span class="n">BFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6421"></a>                             <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-6422"></a>
<a name="ln-6423"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6424"></a><span class="k">              </span><span class="n">BFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-6425"></a>                          <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-6426"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6427"></a>                <span class="n">BFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">BFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6428"></a>                                        <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-6429"></a>            <span class="k">END IF</span>
<a name="ln-6430"></a>
<a name="ln-6431"></a><span class="k">            </span><span class="n">SFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6432"></a>                             <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-6433"></a>
<a name="ln-6434"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6435"></a><span class="k">              </span><span class="n">SFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-6436"></a>                          <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-6437"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6438"></a>                <span class="n">SFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">SFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6439"></a>                                        <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-6440"></a>            <span class="k">END IF</span>
<a name="ln-6441"></a>
<a name="ln-6442"></a><span class="k">          ELSE</span> <span class="c">! Blind with movable slats</span>
<a name="ln-6443"></a>            <span class="n">VarSlats</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span>
<a name="ln-6444"></a>            <span class="n">SlatAng</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SlatAngThisTs</span>
<a name="ln-6445"></a>
<a name="ln-6446"></a>            <span class="n">DFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6447"></a>                               <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6448"></a>                             <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6449"></a>                               <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-6450"></a>
<a name="ln-6451"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6452"></a><span class="k">              </span><span class="n">DFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6453"></a>                            <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6454"></a>                          <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6455"></a>                            <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-6456"></a>
<a name="ln-6457"></a>              <span class="c">! We add the contribution from the solar disk if slats do not block beam solar</span>
<a name="ln-6458"></a>              <span class="c">! TH CR 8010. DaylIllFacSunDisk needs to be interpolated!</span>
<a name="ln-6459"></a>              <span class="c">!IF (.NOT.SurfaceWindow(IWin)%SlatsBlockBeam) DFSUHR(2) = DFSUHR(2) + &amp;</span>
<a name="ln-6460"></a>              <span class="c">!            VTRatio * (WeightNow * ZoneDaylight(ZoneNum)%DaylIllFacSunDisk(loop,IL,2,HourOfDay) + &amp;</span>
<a name="ln-6461"></a>              <span class="c">!            WeightPreviousHour * ZoneDaylight(ZoneNum)%DaylIllFacSunDisk(loop,IL,2,PreviousHour))</span>
<a name="ln-6462"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span><span class="p">)</span> <span class="n">DFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6463"></a>                          <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6464"></a>                          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6465"></a>                          <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6466"></a>                          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-6467"></a>            <span class="k">END IF</span>
<a name="ln-6468"></a>
<a name="ln-6469"></a><span class="k">            </span><span class="n">BFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6470"></a>                               <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6471"></a>                             <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6472"></a>                               <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-6473"></a>
<a name="ln-6474"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6475"></a><span class="k">              </span><span class="n">BFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6476"></a>                            <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6477"></a>                          <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6478"></a>                            <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-6479"></a>
<a name="ln-6480"></a>              <span class="c">! TH CR 8010. DaylBackFacSunDisk needs to be interpolated!</span>
<a name="ln-6481"></a>              <span class="c">!IF (.NOT.SurfaceWindow(IWin)%SlatsBlockBeam) THEN</span>
<a name="ln-6482"></a>              <span class="c">!  BFSUHR(2) = BFSUHR(2) + &amp;</span>
<a name="ln-6483"></a>              <span class="c">!            VTRatio * (WeightNow * ZoneDaylight(ZoneNum)%DaylBackFacSunDisk(loop,IL,2,HourOfDay) + &amp;</span>
<a name="ln-6484"></a>              <span class="c">!            WeightPreviousHour * ZoneDaylight(ZoneNum)%DaylBackFacSunDisk(loop,IL,2,PreviousHour))</span>
<a name="ln-6485"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6486"></a><span class="k">                </span><span class="n">BFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">BFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6487"></a>                          <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6488"></a>                          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6489"></a>                          <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6490"></a>                          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-6491"></a>              <span class="k">END IF</span>
<a name="ln-6492"></a><span class="k">            END IF</span>
<a name="ln-6493"></a>
<a name="ln-6494"></a><span class="k">            </span><span class="n">SFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6495"></a>                         <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6496"></a>                             <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6497"></a>                         <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-6498"></a>
<a name="ln-6499"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6500"></a><span class="k">              </span><span class="n">SFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6501"></a>                     <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6502"></a>                          <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6503"></a>                     <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-6504"></a>
<a name="ln-6505"></a>              <span class="c">! TH CR 8010. DaylSourceFacSunDisk needs to be interpolated!</span>
<a name="ln-6506"></a>              <span class="c">!IF (.NOT.SurfaceWindow(IWin)%SlatsBlockBeam) THEN</span>
<a name="ln-6507"></a>              <span class="c">!  SFSUHR(2) = SFSUHR(2) + &amp;</span>
<a name="ln-6508"></a>              <span class="c">!           VTRatio * (WeightNow * ZoneDaylight(ZoneNum)%DaylSourceFacSunDisk(loop,IL,2,HourOfDay) + &amp;</span>
<a name="ln-6509"></a>              <span class="c">!           WeightPreviousHour * ZoneDaylight(ZoneNum)%DaylSourceFacSunDisk(loop,IL,2,PreviousHour))</span>
<a name="ln-6510"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6511"></a><span class="k">                </span><span class="n">SFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">SFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6512"></a>                         <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6513"></a>                         <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6514"></a>                         <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6515"></a>                         <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-6516"></a>              <span class="k">END IF</span>
<a name="ln-6517"></a><span class="k">            END IF</span>
<a name="ln-6518"></a>
<a name="ln-6519"></a><span class="k">          END IF</span> <span class="c">! End of check if window has blind with movable slats</span>
<a name="ln-6520"></a>        <span class="k">END IF</span> <span class="c">! End of check if window is shaded or has diffusing glass</span>
<a name="ln-6521"></a>      <span class="k">END DO</span> <span class="c">! End of sky type loop, ISky</span>
<a name="ln-6522"></a>
<a name="ln-6523"></a>      <span class="c">! Get illuminance at ref point from bare and shaded window by</span>
<a name="ln-6524"></a>      <span class="c">! multiplying daylight factors by exterior horizontal illuminance</span>
<a name="ln-6525"></a>
<a name="ln-6526"></a>      <span class="c">! Adding 0.001 in the following prevents zero HorIllSky in early morning or late evening when sun</span>
<a name="ln-6527"></a>      <span class="c">! is up in the present time step but GILSK(ISky,HourOfDay) and GILSK(ISky,NextHour) are both zero.</span>
<a name="ln-6528"></a>      <span class="k">DO </span><span class="n">ISky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-6529"></a>        <span class="c">! HorIllSky(ISky) = WeightNow * GILSK(ISky,HourOfDay) + WeightNextHour * GILSK(ISky,NextHour) + 0.001</span>
<a name="ln-6530"></a>        <span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky</span><span class="p">)</span> <span class="o">=</span> <span class="n">WeightNow</span> <span class="o">*</span> <span class="n">GILSK</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">GILSK</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.001d0</span>
<a name="ln-6531"></a>      <span class="k">END DO</span>
<a name="ln-6532"></a>
<a name="ln-6533"></a>      <span class="c">! HISKF is current time step horizontal illuminance from sky, calculated in DayltgLuminousEfficacy,</span>
<a name="ln-6534"></a>      <span class="c">! which is called in WeatherManager. HISUNF is current time step horizontal illuminance from sun,</span>
<a name="ln-6535"></a>      <span class="c">! also calculated in DayltgLuminousEfficacy.</span>
<a name="ln-6536"></a>
<a name="ln-6537"></a>      <span class="n">HorIllSkyFac</span> <span class="o">=</span> <span class="n">HISKF</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">SkyWeight</span><span class="p">)</span><span class="o">*</span><span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky2</span><span class="p">)</span> <span class="o">+</span> <span class="n">SkyWeight</span><span class="o">*</span><span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky1</span><span class="p">))</span>
<a name="ln-6538"></a>
<a name="ln-6539"></a>      <span class="k">DO IS</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<a name="ln-6540"></a>        <span class="k">IF</span> <span class="p">(</span><span class="k">IS</span> <span class="o">==</span> <span class="mf">2.</span><span class="nb">and</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span><span class="o">&lt;=</span><span class="mf">0.</span><span class="nb">and</span><span class="p">..</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-6541"></a>
<a name="ln-6542"></a><span class="k">        </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefpt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6543"></a>          <span class="n">DFSUHR</span><span class="p">(</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="n">HISUNF</span> <span class="o">+</span> <span class="n">HorIllSkyFac</span> <span class="o">*</span> <span class="p">(</span><span class="n">DFSKHR</span><span class="p">(</span><span class="n">ISky1</span><span class="p">,</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="n">SkyWeight</span><span class="o">*</span><span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6544"></a>                              <span class="n">DFSKHR</span><span class="p">(</span><span class="n">ISky2</span><span class="p">,</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SkyWeight</span><span class="p">)</span><span class="o">*</span><span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky2</span><span class="p">))</span>
<a name="ln-6545"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6546"></a>          <span class="n">BFSUHR</span><span class="p">(</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="n">HISUNF</span> <span class="o">+</span> <span class="n">HorIllSkyFac</span> <span class="o">*</span> <span class="p">(</span><span class="n">BFSKHR</span><span class="p">(</span><span class="n">ISky1</span><span class="p">,</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="n">SkyWeight</span><span class="o">*</span><span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6547"></a>                              <span class="n">BFSKHR</span><span class="p">(</span><span class="n">ISky2</span><span class="p">,</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SkyWeight</span><span class="p">)</span><span class="o">*</span><span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky2</span><span class="p">))</span>
<a name="ln-6548"></a>
<a name="ln-6549"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6550"></a>          <span class="n">SFSUHR</span><span class="p">(</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="n">HISUNF</span> <span class="o">+</span> <span class="n">HorIllSkyFac</span> <span class="o">*</span> <span class="p">(</span><span class="n">SFSKHR</span><span class="p">(</span><span class="n">ISky1</span><span class="p">,</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="n">SkyWeight</span><span class="o">*</span><span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6551"></a>                              <span class="n">SFSKHR</span><span class="p">(</span><span class="n">ISky2</span><span class="p">,</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SkyWeight</span><span class="p">)</span><span class="o">*</span><span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky2</span><span class="p">))</span>
<a name="ln-6552"></a>
<a name="ln-6553"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6554"></a>          <span class="nb">MAX</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">),</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-6555"></a>
<a name="ln-6556"></a>        <span class="c">! Added TH 1/21/2010 - save the original clear and dark (fully switched) states&#39;</span>
<a name="ln-6557"></a>        <span class="c">!  zone daylighting values, needed for switachable glazings</span>
<a name="ln-6558"></a>        <span class="n">tmpIllumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefpt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6559"></a>        <span class="n">tmpBackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6560"></a>        <span class="n">tmpSourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6561"></a>      <span class="k">END DO</span> <span class="c">! IS</span>
<a name="ln-6562"></a>
<a name="ln-6563"></a>    <span class="k">END DO</span> <span class="c">! End of reference point loop, IL</span>
<a name="ln-6564"></a>  <span class="k">END DO</span> <span class="c">! End of first loop over exterior windows associated with this zone</span>
<a name="ln-6565"></a>
<a name="ln-6566"></a>  <span class="c">! Initialize flag that one or more windows has switchable glazing</span>
<a name="ln-6567"></a>  <span class="c">! control that adjusts visible transmittance to just meet dayltg setpoint</span>
<a name="ln-6568"></a>  <span class="c">! (and the window has not already been switched)</span>
<a name="ln-6569"></a>  <span class="n">ISWFLG</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6570"></a>
<a name="ln-6571"></a>  <span class="c">! Second loop over windows. Find total daylight illuminance and background luminance</span>
<a name="ln-6572"></a>  <span class="c">! for each ref pt from all exterior windows associated with the zone.  Use shading flags.</span>
<a name="ln-6573"></a>  <span class="c">! This illuminance excludes contribution of inter-reflected illuminance produced by solar</span>
<a name="ln-6574"></a>  <span class="c">! entering the zone through interior windows (which is calculated in DayltgInterReflIllFrIntWins.</span>
<a name="ln-6575"></a>
<a name="ln-6576"></a>  <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span>
<a name="ln-6577"></a>    <span class="n">IWin</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6578"></a>    <span class="n">ICtrl</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span>
<a name="ln-6579"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ICtrl</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ISWFLG</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6580"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ICtrl</span><span class="p">)%</span><span class="n">ShadingControlType</span> <span class="o">==</span> <span class="n">WSCT_MeetDaylIlumSetp</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6581"></a>       <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">GlassConditionallyLightened</span><span class="p">)</span> <span class="n">ISWFLG</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-6582"></a>    <span class="k">END IF</span>
<a name="ln-6583"></a>
<a name="ln-6584"></a>    <span class="c">! Determine if illuminance contribution is from bare or shaded window</span>
<a name="ln-6585"></a>    <span class="c">!  For switchable glazings with shading control type of WSCT_MeetDaylIlumSetp,</span>
<a name="ln-6586"></a>    <span class="c">!   the shading flag is initialized at GlassConditionallyLightened (20), and</span>
<a name="ln-6587"></a>    <span class="c">!   the window is initialized at clear state: IS = 1</span>
<a name="ln-6588"></a>    <span class="c">!  For other windows with glare control, the shading flag is initialized at &gt;10, to be determined</span>
<a name="ln-6589"></a>    <span class="k">IS</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-6590"></a>    <span class="k">IF</span><span class="p">((</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6591"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">IS</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-6592"></a>
<a name="ln-6593"></a>    <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-6594"></a>      <span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6595"></a>      <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BacLum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BacLum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-6596"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6597"></a>    <span class="k">END DO</span>
<a name="ln-6598"></a><span class="k">  END DO</span> <span class="c">! End of second window loop over exterior windows associated with this zone</span>
<a name="ln-6599"></a>
<a name="ln-6600"></a>  <span class="c">! Optical switching control (e.g. electrochromic glass) to adjust</span>
<a name="ln-6601"></a>  <span class="c">! window&#39;s vis trans downward so daylight level equals or is as</span>
<a name="ln-6602"></a>  <span class="c">! close as possible to the illuminance setpoint at first reference point.</span>
<a name="ln-6603"></a>  <span class="c">! Assumes vis trans in the fully switched state is less than that in the</span>
<a name="ln-6604"></a>  <span class="c">! unswitched state. Assumes some windows in a space may have this control and</span>
<a name="ln-6605"></a>  <span class="c">! others not.</span>
<a name="ln-6606"></a>
<a name="ln-6607"></a>  <span class="c">! If daylight illuminance is above setpoint, allow switching</span>
<a name="ln-6608"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ISWFLG</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DaylIllum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SETPNT</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6609"></a>
<a name="ln-6610"></a>    <span class="c">! Third loop over windows.  Get illuminance at ref pt 1 from</span>
<a name="ln-6611"></a>    <span class="c">! windows that can be switched (DILLSW) and those that can&#39;t (DILLUN).</span>
<a name="ln-6612"></a>    <span class="c">! Windows that can be switched are initially in the unswitched state.</span>
<a name="ln-6613"></a>    <span class="n">DILLSW</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6614"></a>    <span class="n">DILLUN</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6615"></a>    <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span>
<a name="ln-6616"></a>      <span class="n">IWin</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6617"></a>      <span class="n">ICtrl</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span>
<a name="ln-6618"></a>      <span class="k">IS</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-6619"></a>      <span class="k">IF</span><span class="p">((</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6620"></a>             <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">IS</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-6621"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ICtrl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6622"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">GlassConditionallyLightened</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6623"></a>        <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ICtrl</span><span class="p">)%</span><span class="n">ShadingControlType</span> <span class="o">==</span> <span class="n">WSCT_MeetDaylIlumSetp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6624"></a><span class="k">          </span><span class="n">DILLSW</span> <span class="o">=</span> <span class="n">DILLSW</span> <span class="o">+</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6625"></a>        <span class="k">ELSE</span>
<a name="ln-6626"></a><span class="k">          </span><span class="n">DILLUN</span> <span class="o">=</span> <span class="n">DILLUN</span> <span class="o">+</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6627"></a>        <span class="k">END IF</span>
<a name="ln-6628"></a><span class="k">      END IF</span>
<a name="ln-6629"></a><span class="k">    END DO</span> <span class="c">! End of third window loop, IWin</span>
<a name="ln-6630"></a>
<a name="ln-6631"></a>    <span class="c">! Transmittance multiplier</span>
<a name="ln-6632"></a>    <span class="n">ASETIL</span> <span class="o">=</span> <span class="p">(</span><span class="n">SETPNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">DILLUN</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">DILLSW</span> <span class="o">+</span> <span class="mf">0.00001d0</span><span class="p">)</span>
<a name="ln-6633"></a>
<a name="ln-6634"></a>    <span class="c">! ASETIL &lt; 1 means there&#39;s enough light, so check for switching</span>
<a name="ln-6635"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ASETIL</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6636"></a>
<a name="ln-6637"></a>      <span class="c">! Fourth loop over windows to determine which to switch</span>
<a name="ln-6638"></a>      <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span>
<a name="ln-6639"></a>        <span class="n">IWin</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6640"></a>
<a name="ln-6641"></a>        <span class="n">ICtrl</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span>
<a name="ln-6642"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ICtrl</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6643"></a>
<a name="ln-6644"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">/=</span> <span class="n">GlassConditionallyLightened</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6645"></a>          <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ICtrl</span><span class="p">)%</span><span class="n">ShadingControlType</span> <span class="o">/=</span> <span class="n">WSCT_MeetDaylIlumSetp</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6646"></a>
<a name="ln-6647"></a><span class="k">        </span><span class="n">IConst</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-6648"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">StormWinFlag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">IConst</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">StormWinConstruction</span>
<a name="ln-6649"></a>        <span class="c">! Vis trans at normal incidence of unswitched glass</span>
<a name="ln-6650"></a>        <span class="n">TVIS1</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-6651"></a>
<a name="ln-6652"></a>        <span class="c">! Vis trans at normal incidence of fully switched glass</span>
<a name="ln-6653"></a>        <span class="n">IConstShaded</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-6654"></a>        <span class="n">TVIS2</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConstShaded</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-6655"></a>
<a name="ln-6656"></a>        <span class="c">! Reset shading flag to indicate that window is shaded by being partially or fully switched</span>
<a name="ln-6657"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">SwitchableGlazing</span>
<a name="ln-6658"></a>
<a name="ln-6659"></a>        <span class="c">! ASETIL &lt; 0 means illuminance from non-daylight-switchable windows exceeds setpoint,</span>
<a name="ln-6660"></a>        <span class="c">! so completely switch all daylight-switchable windows to minimize solar gain</span>
<a name="ln-6661"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ASETIL</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6662"></a><span class="k">          </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SwitchingFactor</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6663"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">VisTransSelected</span> <span class="o">=</span> <span class="n">TVIS2</span>
<a name="ln-6664"></a>        <span class="k">ELSE</span>
<a name="ln-6665"></a>          <span class="c">! Case where 0 &lt; ASETIL &lt; 1: darken glass in all</span>
<a name="ln-6666"></a>          <span class="c">! daylight-switchable windows to just meet illuminance setpoint</span>
<a name="ln-6667"></a>          <span class="c">! From this equation: SETPNT(1) = DILLUN + DILLSW/TVIS1 * VisTransSelected</span>
<a name="ln-6668"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">VisTransSelected</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">TVIS2</span><span class="p">,</span> <span class="n">ASETIL</span> <span class="o">*</span> <span class="n">TVIS1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.000001d0</span>
<a name="ln-6669"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SwitchingFactor</span> <span class="o">=</span> <span class="p">(</span><span class="n">TVIS1</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">VisTransSelected</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">TVIS1</span> <span class="o">-</span> <span class="n">TVIS2</span> <span class="o">+</span> <span class="mf">0.000001d0</span><span class="p">)</span>
<a name="ln-6670"></a>          <span class="c">! bound switching factor between 0 and 1</span>
<a name="ln-6671"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SwitchingFactor</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.d0</span><span class="p">,</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SwitchingFactor</span><span class="p">)</span>
<a name="ln-6672"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SwitchingFactor</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.D0</span><span class="p">,</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SwitchingFactor</span><span class="p">)</span>
<a name="ln-6673"></a>        <span class="k">END IF</span>
<a name="ln-6674"></a>
<a name="ln-6675"></a>        <span class="c">! Adjust daylight quantities based on ratio between switched and unswitched visible transmittance</span>
<a name="ln-6676"></a>        <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-6677"></a>          <span class="c">! DaylIllum(IL) and BacLum(IL) were calculated at the clear state: IS = 1,</span>
<a name="ln-6678"></a>          <span class="c">!  and need to adjusted for intermediate switched state at VisTransSelected: IS = 2</span>
<a name="ln-6679"></a>          <span class="k">IS</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-6680"></a>          <span class="n">VTRAT</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">VisTransSelected</span><span class="o">/</span><span class="p">(</span><span class="n">TVIS1</span><span class="o">+</span><span class="mf">0.000001d0</span><span class="p">)</span>
<a name="ln-6681"></a>          <span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">VTRAT</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6682"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BacLum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span>  <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BacLum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-6683"></a>                         <span class="p">(</span><span class="n">VTRAT</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6684"></a>
<a name="ln-6685"></a>          <span class="c">! Adjust illum, background illum and source luminance for this window in intermediate switched state</span>
<a name="ln-6686"></a>          <span class="c">!  for later use in the DayltgGlare calc because SurfaceWindow(IWin)%ShadingFlag = SwitchableGlazing = 2</span>
<a name="ln-6687"></a>          <span class="k">IS</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-6688"></a>          <span class="n">VTRAT</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">VisTransSelected</span><span class="o">/</span><span class="p">(</span><span class="n">TVIS2</span><span class="o">+</span><span class="mf">0.000001d0</span><span class="p">)</span>
<a name="ln-6689"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>    <span class="o">=</span> <span class="n">VTRAT</span> <span class="o">*</span> <span class="n">tmpIllumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6690"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>  <span class="o">=</span> <span class="n">VTRAT</span> <span class="o">*</span> <span class="n">tmpBackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6691"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span><span class="o">=</span> <span class="n">VTRAT</span> <span class="o">*</span> <span class="n">tmpSourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6692"></a>        <span class="k">END DO</span> <span class="c">! IL</span>
<a name="ln-6693"></a>
<a name="ln-6694"></a>        <span class="c">! If new daylight does not exceed the illuminance setpoint, done, no more checking other switchable glazings</span>
<a name="ln-6695"></a>        <span class="c">!  even though this should not happen because all switchable glazings suppose to be dimmed by a same ratio ASETIL</span>
<a name="ln-6696"></a>        <span class="c">!   In real world, this can be improved by setting priority of each switchable glazing to switch - NFP.</span>
<a name="ln-6697"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DaylIllum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">SETPNT</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6698"></a><span class="k">          EXIT</span>
<a name="ln-6699"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-6700"></a>      <span class="k">END DO</span> <span class="c">! End of fourth window loop, IWin -- end of switching to control daylight illuminance</span>
<a name="ln-6701"></a>
<a name="ln-6702"></a>    <span class="k">END IF</span> <span class="c">! ASETIL &lt; 1</span>
<a name="ln-6703"></a>  <span class="k">END IF</span> <span class="c">! ISWFLG /= 0 .AND. DaylIllum(1) &gt; SETPNT(1)</span>
<a name="ln-6704"></a>
<a name="ln-6705"></a>  <span class="c">! Calculate glare index at each reference point assuming the daylight illuminance setpoint is</span>
<a name="ln-6706"></a>  <span class="c">!  met at both reference points, either by daylight or electric lights</span>
<a name="ln-6707"></a>  <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-6708"></a>    <span class="n">BACL</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SETPNT</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span> <span class="o">/</span> <span class="n">Pi</span><span class="p">,</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BacLum</span><span class="p">(</span><span class="n">IL</span><span class="p">))</span>
<a name="ln-6709"></a>    <span class="c">! DayltgGlare uses ZoneDaylight(ZoneNum)%SourceLumFromWinAtRefPt(IL,1,loop) for unshaded windows, and</span>
<a name="ln-6710"></a>    <span class="c">!  ZoneDaylight(ZoneNum)%SourceLumFromWinAtRefPt(IL,2,loop) for shaded windows</span>
<a name="ln-6711"></a>    <span class="k">CALL </span><span class="n">DayltgGlare</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span> <span class="n">BACL</span><span class="p">,</span> <span class="n">GLRNDX</span><span class="p">(</span><span class="n">IL</span><span class="p">),</span> <span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-6712"></a>  <span class="k">END DO</span>
<a name="ln-6713"></a>
<a name="ln-6714"></a>  <span class="c">! Check if glare level is less than maximum allowed at each ref pt.  If maximum</span>
<a name="ln-6715"></a>  <span class="c">! is exceeded at either ref pt, attempt to reduce glare to acceptable level by closing</span>
<a name="ln-6716"></a>  <span class="c">! shading device on windows that have shades that have not already been closed.</span>
<a name="ln-6717"></a>  <span class="n">GlareFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6718"></a>  <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-6719"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GLRNDX</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaxGlareallowed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6720"></a><span class="k">      </span><span class="n">GlareFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6721"></a>      <span class="k">EXIT</span>
<a name="ln-6722"></a><span class="k">    END IF</span>
<a name="ln-6723"></a><span class="k">  END DO</span>
<a name="ln-6724"></a>
<a name="ln-6725"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">GlareFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6726"></a>    <span class="c">! Glare is too high at a ref pt.  Loop through windows.</span>
<a name="ln-6727"></a>    <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span>
<a name="ln-6728"></a>      <span class="n">IWin</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6729"></a>
<a name="ln-6730"></a>      <span class="c">! Check if window is eligible for glare control</span>
<a name="ln-6731"></a>      <span class="c">! TH 1/21/2010. Switchable glazings already in partially switched state</span>
<a name="ln-6732"></a>      <span class="c">!  should be allowed to further dim to control glare</span>
<a name="ln-6733"></a>      <span class="c">!IF (SurfaceWindow(IWin)%ShadingFlag &lt; 10) CYCLE</span>
<a name="ln-6734"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">/=</span> <span class="n">SwitchableGlazing</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6735"></a>
<a name="ln-6736"></a><span class="k">      </span><span class="n">ICtrl</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span>
<a name="ln-6737"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ICtrl</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6738"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ICtrl</span><span class="p">)%</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6739"></a>
<a name="ln-6740"></a>        <span class="c">! Illuminance (WDAYIL) and background luminance (WBACLU) contribution from this</span>
<a name="ln-6741"></a>        <span class="c">! window without shading (IS=1) and with shading (IS=2) for each ref pt</span>
<a name="ln-6742"></a>        <span class="c">!  For switchable windows, this may be partially switched rather than fully dark</span>
<a name="ln-6743"></a>        <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-6744"></a>          <span class="k">DO IS</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<a name="ln-6745"></a>            <span class="n">WDAYIL</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6746"></a>            <span class="n">WBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6747"></a>          <span class="k">END DO</span>
<a name="ln-6748"></a><span class="k">        END DO</span>
<a name="ln-6749"></a>
<a name="ln-6750"></a>        <span class="c">! Recalculate illuminance and glare with shading on this window.</span>
<a name="ln-6751"></a>        <span class="c">!  For switchable glazings, this is the fully switched (dark) state</span>
<a name="ln-6752"></a>        <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-6753"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">/=</span> <span class="n">SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6754"></a>            <span class="c">! for non switchable glazings or switchable glazings not switched yet (still in clear state)</span>
<a name="ln-6755"></a>            <span class="c">!  SurfaceWindow(IWin)%ShadingFlag = GlassConditionallyLightened</span>
<a name="ln-6756"></a>            <span class="n">RDAYIL</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">-</span> <span class="n">WDAYIL</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">WDAYIL</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6757"></a>            <span class="n">RBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BacLum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">-</span> <span class="n">WBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">WBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6758"></a>          <span class="k">ELSE</span>
<a name="ln-6759"></a>            <span class="c">! switchable glazings already in partially switched state when calc the RDAYIL(IL) &amp; RBACLU(IL)</span>
<a name="ln-6760"></a>            <span class="n">RDAYIL</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">-</span> <span class="n">WDAYIL</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">tmpIllumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6761"></a>            <span class="n">RBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BacLum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">-</span> <span class="n">WBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">tmpBackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6762"></a>          <span class="n">ENDIF</span>
<a name="ln-6763"></a>        <span class="k">END DO</span>
<a name="ln-6764"></a>
<a name="ln-6765"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">/=</span> <span class="n">SwitchableGlazing</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6766"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">/</span> <span class="mi">10</span>
<a name="ln-6767"></a>
<a name="ln-6768"></a>        <span class="c">!For switchable glazings, it is switched to fully dark state,</span>
<a name="ln-6769"></a>        <span class="c">! update ZoneDaylight(ZoneNum)%SourceLumFromWinAtRefPt(IL,2,loop) for use in DayltgGlare</span>
<a name="ln-6770"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6771"></a><span class="k">          DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-6772"></a>            <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpSourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6773"></a>            <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>    <span class="o">=</span> <span class="n">tmpIllumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6774"></a>            <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>  <span class="o">=</span> <span class="n">tmpBackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6775"></a>          <span class="k">END DO</span>
<a name="ln-6776"></a>
<a name="ln-6777"></a><span class="k">          </span><span class="n">IConst</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-6778"></a>          <span class="c">! Vis trans at normal incidence of unswitched glass</span>
<a name="ln-6779"></a>          <span class="n">TVIS1</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-6780"></a>
<a name="ln-6781"></a>          <span class="c">! Vis trans at normal incidence of fully switched glass</span>
<a name="ln-6782"></a>          <span class="n">IConstShaded</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-6783"></a>          <span class="n">TVIS2</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConstShaded</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-6784"></a>        <span class="n">ENDIF</span>
<a name="ln-6785"></a>
<a name="ln-6786"></a>        <span class="c">! Re-calc daylight and glare at shaded state. For switchable glazings, it is the fully dark state.</span>
<a name="ln-6787"></a>        <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-6788"></a>          <span class="n">BACL</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SETPNT</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span> <span class="o">/</span> <span class="n">Pi</span><span class="p">,</span> <span class="n">RBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">))</span>
<a name="ln-6789"></a>          <span class="c">! DayltgGlare uses ZoneDaylight(ZoneNum)%SourceLumFromWinAtRefPt(IL,2,loop) for shaded state</span>
<a name="ln-6790"></a>          <span class="k">CALL </span><span class="n">DayltgGlare</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span> <span class="n">BACL</span><span class="p">,</span> <span class="n">GLRNEW</span><span class="p">(</span><span class="n">IL</span><span class="p">),</span> <span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-6791"></a>        <span class="k">END DO</span>
<a name="ln-6792"></a>
<a name="ln-6793"></a><span class="k">        </span><span class="n">blnCycle</span> <span class="o">=</span> <span class="p">.</span><span class="n">False</span><span class="p">.</span>
<a name="ln-6794"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NREFPT</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">GLRNEW</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">GLRNDX</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6795"></a>          <span class="c">! One ref pt;  go to next window if glare has increased.</span>
<a name="ln-6796"></a>          <span class="n">blnCycle</span> <span class="o">=</span> <span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-6797"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">NREFPT</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6798"></a>          <span class="c">! Two ref pts.  There are three cases depending on glare values.</span>
<a name="ln-6799"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">GLRNDX</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaxGlareallowed</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">GLRNDX</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaxGlareallowed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6800"></a>            <span class="c">!</span>
<a name="ln-6801"></a>            <span class="c">! (1) Initial glare too high at both ref pts.  Deploy shading on</span>
<a name="ln-6802"></a>            <span class="c">!     this window if this decreases glare at both ref pts.</span>
<a name="ln-6803"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">GLRNEW</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">GLRNDX</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">GLRNEW</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">GLRNDX</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="n">blnCycle</span> <span class="o">=</span> <span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-6804"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">GLRNDX</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaxGlareallowed</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">GLRNDX</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaxGlareallowed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6805"></a>            <span class="c">!</span>
<a name="ln-6806"></a>            <span class="c">! (2) Initial glare too high only at first ref pt.  Deploy shading</span>
<a name="ln-6807"></a>            <span class="c">!     on this window if glare at first ref pt decreases and</span>
<a name="ln-6808"></a>            <span class="c">!     glare at second ref pt stays below max.</span>
<a name="ln-6809"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">GLRNEW</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">GLRNDX</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">GLRNEW</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaxGlareallowed</span><span class="p">)</span> <span class="n">blnCycle</span> <span class="o">=</span> <span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-6810"></a>          <span class="k">ELSE</span>
<a name="ln-6811"></a>            <span class="c">!</span>
<a name="ln-6812"></a>            <span class="c">! (3) Initial glare too high at second ref pt.  Deploy shading if glare</span>
<a name="ln-6813"></a>            <span class="c">!     at second ref pt decreases and glare at first ref pt stays below max.</span>
<a name="ln-6814"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">GLRNEW</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">GLRNDX</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">GLRNEW</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaxGlareallowed</span><span class="p">)</span> <span class="n">blnCycle</span> <span class="o">=</span> <span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-6815"></a>          <span class="k">END IF</span>
<a name="ln-6816"></a><span class="k">        END IF</span>
<a name="ln-6817"></a>
<a name="ln-6818"></a>        <span class="c">! Shading this window has not improved the glare situation.</span>
<a name="ln-6819"></a>        <span class="c">! Reset shading flag to no shading condition, go to next window.</span>
<a name="ln-6820"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">blnCycle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6821"></a>          <span class="c">!  for switchable glazings, reset properties to clear state or partial switched state?</span>
<a name="ln-6822"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6823"></a><span class="k">            </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SwitchingFactor</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6824"></a>            <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">VisTransSelected</span> <span class="o">=</span> <span class="n">TVIS1</span>
<a name="ln-6825"></a>
<a name="ln-6826"></a>            <span class="c">! RESET properties for fully dark state</span>
<a name="ln-6827"></a>            <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-6828"></a>              <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>    <span class="o">=</span> <span class="n">tmpIllumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6829"></a>              <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>  <span class="o">=</span> <span class="n">tmpBackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6830"></a>              <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span><span class="o">=</span> <span class="n">tmpSourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6831"></a>            <span class="n">ENDDO</span>
<a name="ln-6832"></a>          <span class="n">ENDIF</span>
<a name="ln-6833"></a>
<a name="ln-6834"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShadeOff</span>
<a name="ln-6835"></a>          <span class="k">CYCLE</span>
<a name="ln-6836"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-6837"></a>
<a name="ln-6838"></a>        <span class="c">! Shading this window has improved the glare situation.</span>
<a name="ln-6839"></a>        <span class="c">! Reset background luminance, glare index, and daylight illuminance at each ref pt.</span>
<a name="ln-6840"></a>        <span class="c">! For switchable glazings, this is fully switched, dark state</span>
<a name="ln-6841"></a>        <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-6842"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BacLum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">RBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span>
<a name="ln-6843"></a>          <span class="n">GLRNDX</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">GLRNEW</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span>
<a name="ln-6844"></a>          <span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">RDAYIL</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span>
<a name="ln-6845"></a>        <span class="k">END DO</span>
<a name="ln-6846"></a>
<a name="ln-6847"></a>
<a name="ln-6848"></a>        <span class="c">! TH comments (5/22/2009): seems for EC windows, if the calculated glare exceeds the max setpoint,</span>
<a name="ln-6849"></a>        <span class="c">!  the EC windows will be reset to fully dark state which significantly reduces the available daylight.</span>
<a name="ln-6850"></a>        <span class="c">!  A better way is to dim the EC windows as necessary just to meet the glare index, which will still</span>
<a name="ln-6851"></a>        <span class="c">!  provide more daylight while not exceeding the max glare! The question is then how to set the</span>
<a name="ln-6852"></a>        <span class="c">!  SwitchingFactor to just meet the glare index.</span>
<a name="ln-6853"></a>        <span class="c">!  This was addressed in CR 7984 for E+ 5.0. 1/19/2010</span>
<a name="ln-6854"></a>
<a name="ln-6855"></a>        <span class="c">! If switchable glazing, set switching factor to 1: fully switched.</span>
<a name="ln-6856"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6857"></a><span class="k">          </span><span class="n">tmpSWFactor0</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SwitchingFactor</span>  <span class="c">! save original switching factor</span>
<a name="ln-6858"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SwitchingFactor</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6859"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">VisTransSelected</span> <span class="o">=</span> <span class="n">TVIS2</span>
<a name="ln-6860"></a>
<a name="ln-6861"></a>          <span class="c">! restore fully dark values</span>
<a name="ln-6862"></a>          <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-6863"></a>             <span class="n">WDAYIL</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpIllumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6864"></a>             <span class="n">WBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpBackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6865"></a>             <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>    <span class="o">=</span> <span class="n">tmpIllumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6866"></a>             <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>  <span class="o">=</span> <span class="n">tmpBackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6867"></a>             <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span><span class="o">=</span> <span class="n">tmpSourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6868"></a>          <span class="k">END DO</span>
<a name="ln-6869"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-6870"></a>
<a name="ln-6871"></a>        <span class="c">! Check if glare now acceptable at each ref pt.</span>
<a name="ln-6872"></a>        <span class="n">GlareOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">False</span><span class="p">.</span>
<a name="ln-6873"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NREFPT</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6874"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">GLRNDX</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaxGlareallowed</span><span class="p">)</span> <span class="n">GlareOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-6875"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">NREFPT</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6876"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">GLRNDX</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaxGlareallowed</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6877"></a>            <span class="n">GLRNDX</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaxGlareallowed</span><span class="p">)</span> <span class="n">GlareOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-6878"></a>        <span class="n">ENDIF</span>
<a name="ln-6879"></a>
<a name="ln-6880"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">GlareOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6881"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">SwitchableGlazing</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6882"></a>            <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ICtrl</span><span class="p">)%</span><span class="n">ShadingControlType</span> <span class="o">==</span> <span class="n">WSCT_MeetDaylIlumSetp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6883"></a>            <span class="c">! Added TH 1/14/2010</span>
<a name="ln-6884"></a>            <span class="c">! Only for switchable glazings with MeetDaylightIlluminanceSetpoint control</span>
<a name="ln-6885"></a>            <span class="c">! The glazing is in fully dark state, it might lighten a bit to provide more daylight</span>
<a name="ln-6886"></a>            <span class="c">!  while meeting maximum discomfort glare index</span>
<a name="ln-6887"></a>            <span class="c">! Iteration to find the right switching factor meeting the glare index</span>
<a name="ln-6888"></a>
<a name="ln-6889"></a>            <span class="c">! get fully dark state values</span>
<a name="ln-6890"></a>            <span class="n">tmpSWSL1</span> <span class="o">=</span> <span class="n">tmpSourceLumFromWinAtRefPt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6891"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">NREFPT</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">tmpSWSL2</span> <span class="o">=</span> <span class="n">tmpSourceLumFromWinAtRefPt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-6892"></a>
<a name="ln-6893"></a>            <span class="c">! use simple fixed step search in iteraction, can be improved in future</span>
<a name="ln-6894"></a>            <span class="n">tmpSWFactor</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">tmpSWIterStep</span>
<a name="ln-6895"></a>            <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">tmpSWFactor</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-6896"></a>              <span class="c">! calc new glare at new switching state</span>
<a name="ln-6897"></a>              <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-6898"></a>                <span class="n">RDAYIL</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">WDAYIL</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">WDAYIL</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">tmpSWFactor</span><span class="p">)</span>
<a name="ln-6899"></a>                <span class="n">RBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BacLum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">WBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">WBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">tmpSWFactor</span><span class="p">)</span>
<a name="ln-6900"></a>                <span class="n">BACL</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SETPNT</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span> <span class="o">/</span> <span class="n">Pi</span><span class="p">,</span> <span class="n">RBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">))</span>
<a name="ln-6901"></a>                <span class="c">! needs to update SourceLumFromWinAtRefPt(IL,2,loop) before re-calc DayltgGlare</span>
<a name="ln-6902"></a>                <span class="n">tmpMult</span> <span class="o">=</span> <span class="p">(</span><span class="n">TVIS1</span> <span class="o">-</span> <span class="p">(</span><span class="n">TVIS1</span> <span class="o">-</span> <span class="n">TVIS2</span><span class="p">)</span> <span class="o">*</span> <span class="n">tmpSWFactor</span><span class="p">)</span> <span class="o">/</span> <span class="n">TVIS2</span>
<a name="ln-6903"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">IL</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6904"></a><span class="k">                  </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpSWSL1</span> <span class="o">*</span> <span class="n">tmpMult</span>
<a name="ln-6905"></a>                <span class="k">ELSE</span>
<a name="ln-6906"></a><span class="k">                  </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpSWSL2</span> <span class="o">*</span> <span class="n">tmpMult</span>
<a name="ln-6907"></a>                <span class="n">ENDIF</span>
<a name="ln-6908"></a>                <span class="c">! Calc new glare</span>
<a name="ln-6909"></a>                <span class="k">CALL </span><span class="n">DayltgGlare</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span> <span class="n">BACL</span><span class="p">,</span> <span class="n">GLRNEW</span><span class="p">(</span><span class="n">IL</span><span class="p">),</span> <span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-6910"></a>              <span class="k">END DO</span>
<a name="ln-6911"></a>
<a name="ln-6912"></a>              <span class="c">! Check whether new glare is OK</span>
<a name="ln-6913"></a>              <span class="n">GlareOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">False</span><span class="p">.</span>
<a name="ln-6914"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">NREFPT</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6915"></a><span class="k">                IF</span> <span class="p">(</span><span class="n">GLRNEW</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaxGlareallowed</span><span class="p">)</span> <span class="n">GlareOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-6916"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">NREFPT</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6917"></a><span class="k">                IF</span> <span class="p">(</span><span class="n">GLRNEW</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaxGlareallowed</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6918"></a>                  <span class="n">GLRNEW</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaxGlareallowed</span><span class="p">)</span> <span class="n">GlareOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-6919"></a>              <span class="n">ENDIF</span>
<a name="ln-6920"></a>
<a name="ln-6921"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">GlareOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6922"></a><span class="k">                IF</span> <span class="p">(</span><span class="n">tmpSWFactor</span> <span class="o">&gt;=</span> <span class="n">tmpSWIterStep</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6923"></a>                  <span class="c">! Continue to lighten the glazing</span>
<a name="ln-6924"></a>                  <span class="n">tmpSWFactor</span> <span class="o">=</span> <span class="n">tmpSWFactor</span> <span class="o">-</span> <span class="n">tmpSWIterStep</span>
<a name="ln-6925"></a>                  <span class="k">CYCLE</span>
<a name="ln-6926"></a><span class="k">                ELSE</span>
<a name="ln-6927"></a>                  <span class="c">! Glare still OK but glazing already in clear state, no more lighten</span>
<a name="ln-6928"></a>                  <span class="k">EXIT</span>
<a name="ln-6929"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-6930"></a>              <span class="k">ELSE</span>
<a name="ln-6931"></a>                <span class="c">! Glare too high, exit and use previous switching state</span>
<a name="ln-6932"></a>                <span class="n">tmpSWFactor</span> <span class="o">=</span> <span class="n">tmpSWFactor</span> <span class="o">+</span> <span class="n">tmpSWIterStep</span>
<a name="ln-6933"></a>                <span class="k">EXIT</span>
<a name="ln-6934"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-6935"></a>            <span class="k">END DO</span>
<a name="ln-6936"></a>
<a name="ln-6937"></a>            <span class="c">! Final re-calculation if needed</span>
<a name="ln-6938"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">GlareOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6939"></a>              <span class="c">! Glare too high, use previous state and re-calc</span>
<a name="ln-6940"></a>              <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-6941"></a>                <span class="n">RDAYIL</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">WDAYIL</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">WDAYIL</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">tmpSWFactor</span><span class="p">)</span>
<a name="ln-6942"></a>                <span class="n">RBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BacLum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">WBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">WBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">tmpSWFactor</span><span class="p">)</span>
<a name="ln-6943"></a>                <span class="n">BACL</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SETPNT</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span> <span class="o">/</span> <span class="n">Pi</span><span class="p">,</span> <span class="n">RBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">))</span>
<a name="ln-6944"></a>
<a name="ln-6945"></a>                <span class="c">! needs to update SourceLumFromWinAtRefPt(IL,2,IWin) before re-calc DayltgGlare</span>
<a name="ln-6946"></a>                <span class="n">tmpMult</span> <span class="o">=</span> <span class="p">(</span><span class="n">TVIS1</span> <span class="o">-</span> <span class="p">(</span><span class="n">TVIS1</span> <span class="o">-</span> <span class="n">TVIS2</span><span class="p">)</span> <span class="o">*</span> <span class="n">tmpSWFactor</span><span class="p">)</span> <span class="o">/</span> <span class="n">TVIS2</span>
<a name="ln-6947"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">IL</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6948"></a><span class="k">                  </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpSWSL1</span> <span class="o">*</span> <span class="n">tmpMult</span>
<a name="ln-6949"></a>                <span class="k">ELSE</span>
<a name="ln-6950"></a><span class="k">                  </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpSWSL2</span> <span class="o">*</span> <span class="n">tmpMult</span>
<a name="ln-6951"></a>                <span class="n">ENDIF</span>
<a name="ln-6952"></a>                <span class="k">CALL </span><span class="n">DayltgGlare</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span> <span class="n">BACL</span><span class="p">,</span> <span class="n">GLRNEW</span><span class="p">(</span><span class="n">IL</span><span class="p">),</span> <span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-6953"></a>              <span class="k">END DO</span>
<a name="ln-6954"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-6955"></a>
<a name="ln-6956"></a>            <span class="c">!Update final results</span>
<a name="ln-6957"></a>            <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-6958"></a>              <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BacLum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">RBACLU</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span>
<a name="ln-6959"></a>              <span class="n">GLRNDX</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">GLRNEW</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span>
<a name="ln-6960"></a>              <span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">RDAYIL</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span>
<a name="ln-6961"></a>
<a name="ln-6962"></a>              <span class="n">tmpMult</span> <span class="o">=</span> <span class="p">(</span><span class="n">TVIS1</span> <span class="o">-</span> <span class="p">(</span><span class="n">TVIS1</span> <span class="o">-</span> <span class="n">TVIS2</span><span class="p">)</span> <span class="o">*</span> <span class="n">tmpSWFactor</span><span class="p">)</span> <span class="o">/</span> <span class="n">TVIS2</span>
<a name="ln-6963"></a>              <span class="c">!update report variables</span>
<a name="ln-6964"></a>              <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpIllumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">*</span> <span class="n">tmpMult</span>
<a name="ln-6965"></a>              <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpBackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">*</span> <span class="n">tmpMult</span>
<a name="ln-6966"></a>            <span class="k">END DO</span>
<a name="ln-6967"></a><span class="k">            </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SwitchingFactor</span> <span class="o">=</span> <span class="n">tmpSWFactor</span>
<a name="ln-6968"></a>            <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">VisTransSelected</span> <span class="o">=</span> <span class="n">TVIS1</span> <span class="o">-</span> <span class="p">(</span><span class="n">TVIS1</span> <span class="o">-</span> <span class="n">TVIS2</span><span class="p">)</span> <span class="o">*</span> <span class="n">tmpSWFactor</span>
<a name="ln-6969"></a>
<a name="ln-6970"></a>          <span class="k">ELSE</span>
<a name="ln-6971"></a>            <span class="c">!For un-switchable glazing or switchable glazing but not MeetDaylightIlluminaceSetpoint control,</span>
<a name="ln-6972"></a>            <span class="c">! it is in shaded state and glare is ok - job is done, exit the window loop - IWin</span>
<a name="ln-6973"></a>            <span class="k">EXIT</span>
<a name="ln-6974"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-6975"></a>     <span class="c">!</span>
<a name="ln-6976"></a>     <span class="c">!   ELSE</span>
<a name="ln-6977"></a>     <span class="c">!     ! glare still high at either ref pt. go to next window</span>
<a name="ln-6978"></a>     <span class="c">!     !  clean up for switchable glazings</span>
<a name="ln-6979"></a>     <span class="c">!     IF (SurfaceWindow(IWin)%ShadingFlag == SwitchableGlazing) THEN</span>
<a name="ln-6980"></a>     <span class="c">!       ! Already in fully dark state</span>
<a name="ln-6981"></a>     <span class="c">!       DO IL = 1,NREFPT</span>
<a name="ln-6982"></a>     <span class="c">!         ZoneDaylight(ZoneNum)%SourceLumFromWinAtRefPt(IL,2,loop) = tmpSourceLumFromWinAtRefPt(IL,2,loop)</span>
<a name="ln-6983"></a>     <span class="c">!         ZoneDaylight(ZoneNum)%IllumFromWinAtRefPt(IL,2,loop) = tmpIllumFromWinAtRefPt(IL,2,loop)</span>
<a name="ln-6984"></a>     <span class="c">!         ZoneDaylight(ZoneNum)%BackLumFromWinAtRefPt(IL,2,loop) = tmpBackLumFromWinAtRefPt(IL,2,loop)</span>
<a name="ln-6985"></a>     <span class="c">!       END DO</span>
<a name="ln-6986"></a>     <span class="c">!     ENDIF</span>
<a name="ln-6987"></a>        <span class="n">ENDIF</span>
<a name="ln-6988"></a>
<a name="ln-6989"></a>      <span class="k">END IF</span> <span class="c">! End of check if window glare control is active</span>
<a name="ln-6990"></a>    <span class="k">END DO</span> <span class="c">! End of window loop, IWin</span>
<a name="ln-6991"></a>  <span class="k">END IF</span> <span class="c">! GlareFlag</span>
<a name="ln-6992"></a>
<a name="ln-6993"></a>  <span class="c">! Loop again over windows and reset remaining shading flags that</span>
<a name="ln-6994"></a>  <span class="c">! are 10 or higher (i.e., conditionally off) to off</span>
<a name="ln-6995"></a>  <span class="k">DO </span><span class="n">IWin</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-6996"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6997"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6998"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">)</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShadeOff</span>
<a name="ln-6999"></a>  <span class="k">END DO</span>
<a name="ln-7000"></a>
<a name="ln-7001"></a>  <span class="c">! Variables for reporting</span>
<a name="ln-7002"></a>  <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-7003"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllumAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span>
<a name="ln-7004"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">GlareIndexAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">GLRNDX</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span>
<a name="ln-7005"></a>
<a name="ln-7006"></a>    <span class="c">!added TH 12/2/2008</span>
<a name="ln-7007"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GLRNDX</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MaxGlareallowed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7008"></a><span class="k">      </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TimeExceedingGlareIndexSPAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">TimeStepZone</span>  <span class="c">!fraction of hours</span>
<a name="ln-7009"></a>    <span class="k">ELSE</span>
<a name="ln-7010"></a><span class="k">      </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TimeExceedingGlareIndexSPAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7011"></a>    <span class="n">ENDIF</span>
<a name="ln-7012"></a>
<a name="ln-7013"></a>    <span class="c">!added TH 7/6/2009</span>
<a name="ln-7014"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumSetPoint</span><span class="p">(</span><span class="n">IL</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7015"></a><span class="k">      </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TimeExceedingDaylightIlluminanceSPAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">TimeStepZone</span>  <span class="c">!fraction of hours</span>
<a name="ln-7016"></a>    <span class="k">ELSE</span>
<a name="ln-7017"></a><span class="k">      </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TimeExceedingDaylightIlluminanceSPAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7018"></a>    <span class="n">ENDIF</span>
<a name="ln-7019"></a>  <span class="k">END DO</span>
<a name="ln-7020"></a>
<a name="ln-7021"></a>  <span class="c">! The following report variables are valid only for daylit zones without interior windows</span>
<a name="ln-7022"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">HasInterZoneWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7023"></a><span class="k">    DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span>
<a name="ln-7024"></a>      <span class="n">IWin</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-7025"></a>      <span class="k">IS</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-7026"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">IS</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-7027"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt1Rep</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-7028"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LumWinFromRefPt1Rep</span>     <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-7029"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7030"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt2Rep</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-7031"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LumWinFromRefPt2Rep</span>     <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-7032"></a>      <span class="n">ENDIF</span>
<a name="ln-7033"></a>    <span class="k">END DO</span>
<a name="ln-7034"></a><span class="k">  END IF</span>
<a name="ln-7035"></a>
<a name="ln-7036"></a><span class="k">  RETURN</span>
<a name="ln-7037"></a>
<a name="ln-7038"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgInteriorIllum</span>
<a name="ln-7039"></a>
<a name="ln-7040"></a><span class="k">SUBROUTINE </span><span class="n">DayltgInteriorTDDIllum</span>
<a name="ln-7041"></a>
<a name="ln-7042"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7043"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-7044"></a>          <span class="c">!       DATE WRITTEN   October 2006</span>
<a name="ln-7045"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7046"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7047"></a>
<a name="ln-7048"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7049"></a>          <span class="c">! Calculate the TDD Pipe illuminance values</span>
<a name="ln-7050"></a>
<a name="ln-7051"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7052"></a>          <span class="c">! na</span>
<a name="ln-7053"></a>
<a name="ln-7054"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7055"></a>          <span class="c">! na</span>
<a name="ln-7056"></a>
<a name="ln-7057"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7058"></a>          <span class="c">! na</span>
<a name="ln-7059"></a>
<a name="ln-7060"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7061"></a>
<a name="ln-7062"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7063"></a>          <span class="c">! na</span>
<a name="ln-7064"></a>
<a name="ln-7065"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7066"></a>          <span class="c">! na</span>
<a name="ln-7067"></a>
<a name="ln-7068"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7069"></a>          <span class="c">! na</span>
<a name="ln-7070"></a>
<a name="ln-7071"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7072"></a>          <span class="c">! na</span>
<a name="ln-7073"></a>
<a name="ln-7074"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7075"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">PipeNum</span>               <span class="c">! TDD pipe object number</span>
<a name="ln-7076"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TDDTransVisDiffNow</span>    <span class="c">! TDD diffuse visible transmittance at the current hour</span>
<a name="ln-7077"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TDDTransVisDiffPrev</span>   <span class="c">! TDD diffuse visible transmittance at the previous hour</span>
<a name="ln-7078"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TDDTransVisDiff</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>    <span class="c">! Weighted diffuse visible transmittance for each sky type</span>
<a name="ln-7079"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ISky</span>                  <span class="c">! Sky type index</span>
<a name="ln-7080"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ISky1</span><span class="p">,</span> <span class="n">ISky2</span>          <span class="c">! Sky type index values for averaging two sky types</span>
<a name="ln-7081"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyWeight</span>             <span class="c">! Weighting factor used to average two different sky types</span>
<a name="ln-7082"></a>
<a name="ln-7083"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SkyClearness</span> <span class="o">&gt;</span> <span class="mf">3.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Sky is average of clear and clear turbid</span>
<a name="ln-7084"></a>    <span class="n">SkyWeight</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,(</span><span class="n">SkyClearness</span><span class="o">-</span><span class="mf">3.d0</span><span class="p">)</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">)</span>
<a name="ln-7085"></a>    <span class="n">ISky1</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-7086"></a>    <span class="n">ISky2</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-7087"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SkyClearness</span> <span class="o">&gt;</span> <span class="mf">1.2d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Sky is average of clear turbid and intermediate</span>
<a name="ln-7088"></a>    <span class="n">SkyWeight</span> <span class="o">=</span> <span class="p">(</span><span class="n">SkyClearness</span> <span class="o">-</span> <span class="mf">1.2d0</span><span class="p">)</span><span class="o">/</span><span class="mf">1.8d0</span>
<a name="ln-7089"></a>    <span class="n">ISky1</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-7090"></a>    <span class="n">ISky2</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-7091"></a>  <span class="k">ELSE</span> <span class="c">! Sky is average of intermediate and overcast</span>
<a name="ln-7092"></a>    <span class="n">SkyWeight</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">SkyClearness</span><span class="o">-</span><span class="mf">1.d0</span><span class="p">)</span><span class="o">/</span><span class="mf">0.2d0</span><span class="p">,</span> <span class="p">(</span><span class="n">SkyBrightness</span><span class="o">-</span><span class="mf">0.05d0</span><span class="p">)</span><span class="o">/</span><span class="mf">0.4d0</span><span class="p">))</span>
<a name="ln-7093"></a>    <span class="n">ISky1</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-7094"></a>    <span class="n">ISky2</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-7095"></a>  <span class="k">END IF</span>
<a name="ln-7096"></a>
<a name="ln-7097"></a>  <span class="c">! Calculate and report TDD visible transmittances</span>
<a name="ln-7098"></a>  <span class="k">DO </span><span class="n">PipeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfTDDPipes</span>
<a name="ln-7099"></a>
<a name="ln-7100"></a>    <span class="n">TDDPipe</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">)%</span><span class="n">TransVisBeam</span> <span class="o">=</span> <span class="n">WeightNow</span> <span class="o">*</span> <span class="n">TDDTransVisBeam</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7101"></a>      <span class="o">+</span> <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">TDDTransVisBeam</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)</span>
<a name="ln-7102"></a>
<a name="ln-7103"></a>    <span class="k">DO </span><span class="n">ISky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-7104"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TDDFluxInc</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7105"></a><span class="k">        </span><span class="n">TDDTransVisDiffNow</span> <span class="o">=</span> <span class="n">TDDFluxTrans</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">/</span> <span class="n">TDDFluxInc</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>
<a name="ln-7106"></a>      <span class="k">ELSE</span>
<a name="ln-7107"></a><span class="k">        </span><span class="n">TDDTransVisDiffNow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7108"></a>      <span class="k">END IF</span>
<a name="ln-7109"></a>
<a name="ln-7110"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">TDDFluxInc</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7111"></a><span class="k">        </span><span class="n">TDDTransVisDiffPrev</span> <span class="o">=</span> <span class="n">TDDFluxTrans</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)</span> <span class="o">/</span> <span class="n">TDDFluxInc</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)</span>
<a name="ln-7112"></a>      <span class="k">ELSE</span>
<a name="ln-7113"></a><span class="k">        </span><span class="n">TDDTransVisDiffPrev</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7114"></a>      <span class="k">END IF</span>
<a name="ln-7115"></a>
<a name="ln-7116"></a><span class="k">      </span><span class="n">TDDTransVisDiff</span><span class="p">(</span><span class="n">ISky</span><span class="p">)</span> <span class="o">=</span> <span class="n">WeightNow</span> <span class="o">*</span> <span class="n">TDDTransVisDiffNow</span> <span class="o">+</span> <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">TDDTransVisDiffPrev</span>
<a name="ln-7117"></a>    <span class="k">END DO</span> <span class="c">! ISky</span>
<a name="ln-7118"></a>
<a name="ln-7119"></a>    <span class="n">TDDPipe</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">)%</span><span class="n">TransVisDiff</span> <span class="o">=</span> <span class="n">SkyWeight</span> <span class="o">*</span> <span class="n">TDDTransVisDiff</span><span class="p">(</span><span class="n">ISky1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SkyWeight</span><span class="p">)</span> <span class="o">*</span> <span class="n">TDDTransVisDiff</span><span class="p">(</span><span class="n">ISky2</span><span class="p">)</span>
<a name="ln-7120"></a>  <span class="k">END DO</span> <span class="c">! PipeNum</span>
<a name="ln-7121"></a>
<a name="ln-7122"></a>
<a name="ln-7123"></a>  <span class="k">RETURN</span>
<a name="ln-7124"></a>
<a name="ln-7125"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgInteriorTDDIllum</span>
<a name="ln-7126"></a>
<a name="ln-7127"></a><span class="k">SUBROUTINE </span><span class="n">DayltgElecLightingControl</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-7128"></a>
<a name="ln-7129"></a>        <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7130"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-7131"></a>          <span class="c">!       DATE WRITTEN   July 1997</span>
<a name="ln-7132"></a>          <span class="c">!       MODIFIED       Mar 2004, FCW: add inter-reflected illuminance from interior windows to DaylIllum</span>
<a name="ln-7133"></a>          <span class="c">!                      Apr 2004, FCW: move CALL ReportIllumMap from DayltgInteriorIllum2 (DayltgInteriorMapIllum)</span>
<a name="ln-7134"></a>          <span class="c">!                      Apr 2010, BG NREL: remove inter-reflected illuminance to stop double counting</span>
<a name="ln-7135"></a>          <span class="c">!                      Aug 2012, BG NREL: added availability schedule logic</span>
<a name="ln-7136"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7137"></a>
<a name="ln-7138"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7139"></a>          <span class="c">! For a daylit space, determines lighting power reduction factor due to</span>
<a name="ln-7140"></a>          <span class="c">! daylighting for different lighting control systems.</span>
<a name="ln-7141"></a>
<a name="ln-7142"></a>          <span class="c">! Called by InitSurfaceHeatBalance.</span>
<a name="ln-7143"></a>
<a name="ln-7144"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7145"></a>
<a name="ln-7146"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7147"></a>          <span class="c">! Based on DOE-2.1E subroutine DLTSYS.</span>
<a name="ln-7148"></a>
<a name="ln-7149"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7150"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-7151"></a>
<a name="ln-7152"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7153"></a>
<a name="ln-7154"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7155"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ZoneNum</span>                      <span class="c">! Zone number</span>
<a name="ln-7156"></a>
<a name="ln-7157"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7158"></a>          <span class="c">! na</span>
<a name="ln-7159"></a>
<a name="ln-7160"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-7161"></a>          <span class="c">! na</span>
<a name="ln-7162"></a>
<a name="ln-7163"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7164"></a>          <span class="c">! na</span>
<a name="ln-7165"></a>
<a name="ln-7166"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7167"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotReduction</span>                 <span class="c">! Electric lighting power reduction factor for a zone</span>
<a name="ln-7168"></a>                                            <span class="c">!  due to daylighting</span>
<a name="ln-7169"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NREFPT</span>                       <span class="c">! Number of daylighting reference points in a zone</span>
<a name="ln-7170"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZFTOT</span>                        <span class="c">! Fraction of zone&#39;s floor area that has daylighting controls</span>
<a name="ln-7171"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IL</span>                           <span class="c">! Reference point index</span>
<a name="ln-7172"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">LSYSTP</span>                       <span class="c">! Lighting control type: 1=continuous dimming, 2=stepped,</span>
<a name="ln-7173"></a>                                            <span class="c">!  3=continuous dimming then off</span>
<a name="ln-7174"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZFRAC</span>                        <span class="c">! Fraction of zone controlled by a reference point</span>
<a name="ln-7175"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FL</span>                           <span class="c">! Fraction electric lighting output required to meet setpoint</span>
<a name="ln-7176"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FP</span>                           <span class="c">! Fraction electric lighting power input required to meet setpoint</span>
<a name="ln-7177"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XRAN</span>                         <span class="c">! Random number between 0 and 1</span>
<a name="ln-7178"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">MapNum</span>                       <span class="c">! Illuminance map number</span>
<a name="ln-7179"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ILM</span>
<a name="ln-7180"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">ScheduledAvailable</span>
<a name="ln-7181"></a>
<a name="ln-7182"></a>          <span class="c">! FLOW:</span>
<a name="ln-7183"></a>
<a name="ln-7184"></a>  <span class="n">TotReduction</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7185"></a><span class="c">!  ScheduledAvailable = .TRUE.</span>
<a name="ln-7186"></a>
<a name="ln-7187"></a>  <span class="c">! check if scheduled to be available</span>
<a name="ln-7188"></a><span class="c">!  IF (ZoneDaylight(ZoneNum)%AvailSchedNum &gt; 0) THEN</span>
<a name="ln-7189"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AvailSchedNum</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7190"></a><span class="k">      </span><span class="n">ScheduledAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7191"></a>    <span class="k">ELSE</span>
<a name="ln-7192"></a><span class="k">      </span><span class="n">ScheduledAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7193"></a>    <span class="n">ENDIF</span>
<a name="ln-7194"></a><span class="c">!  ENDIF</span>
<a name="ln-7195"></a>
<a name="ln-7196"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ScheduledAvailable</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7197"></a>    <span class="c">! Limit the number of control reference points to 2</span>
<a name="ln-7198"></a>    <span class="n">NREFPT</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span>
<a name="ln-7199"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NREFPT</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="n">NREFPT</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-7200"></a>
<a name="ln-7201"></a>    <span class="c">! Total fraction of zone that is daylit</span>
<a name="ln-7202"></a>    <span class="n">ZFTOT</span>  <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FracZoneDaylit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7203"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NREFPT</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">ZFTOT</span> <span class="o">=</span> <span class="n">ZFTOT</span> <span class="o">+</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FracZoneDaylit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7204"></a>
<a name="ln-7205"></a>    <span class="c">! Loop over reference points</span>
<a name="ln-7206"></a>    <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-7207"></a>      <span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span>  <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllumAtRefPt</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span>
<a name="ln-7208"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumSetPoint</span><span class="p">(</span><span class="n">IL</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7209"></a><span class="k">        </span><span class="n">FL</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7210"></a>      <span class="k">ELSE</span>
<a name="ln-7211"></a><span class="k">        </span><span class="n">FL</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumSetPoint</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">-</span> <span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">))</span> <span class="o">/</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumSetPoint</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span>
<a name="ln-7212"></a>      <span class="k">END IF</span>
<a name="ln-7213"></a>
<a name="ln-7214"></a>      <span class="c">! BRANCH ON LIGHTING SYSTEM TYPE</span>
<a name="ln-7215"></a>      <span class="n">LSYSTP</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">LightControlType</span>
<a name="ln-7216"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">LSYSTP</span> <span class="o">/=</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7217"></a>        <span class="c">! Continuously dimmable system with linear power curve</span>
<a name="ln-7218"></a>        <span class="c">!</span>
<a name="ln-7219"></a>        <span class="c">! Fractional output power required to meet setpoint</span>
<a name="ln-7220"></a>        <span class="n">FP</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7221"></a>        <span class="c">! LIGHT-CTRL-TYPE = CONTINUOUS (LSYSTP = 1)</span>
<a name="ln-7222"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">FL</span> <span class="o">&lt;=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinLightFraction</span><span class="p">)</span> <span class="n">FP</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinPowerFraction</span>
<a name="ln-7223"></a>        <span class="c">! LIGHT-CTRL-TYPE = CONTINUOUS/OFF (LSYSTP = 3)</span>
<a name="ln-7224"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">FL</span> <span class="o">&lt;=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinLightFraction</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">LSYSTP</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="n">FP</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7225"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">FL</span> <span class="o">&gt;</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinLightFraction</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">FL</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7226"></a>          <span class="n">FP</span> <span class="o">=</span> <span class="p">(</span><span class="n">FL</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">FL</span><span class="p">)</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinPowerFraction</span> <span class="o">-</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinLightFraction</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-7227"></a>               <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinLightFraction</span><span class="p">)</span>
<a name="ln-7228"></a>
<a name="ln-7229"></a>      <span class="k">ELSE</span> <span class="c">! LSYSTP = 2</span>
<a name="ln-7230"></a>        <span class="c">! Stepped system</span>
<a name="ln-7231"></a>        <span class="n">FP</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7232"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumSetPoint</span><span class="p">(</span><span class="n">IL</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-7233"></a>          <span class="n">FP</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="nb">INT</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">LightControlSteps</span><span class="o">*</span><span class="n">FL</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">/</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">LightControlSteps</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7234"></a>
<a name="ln-7235"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">FP</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7236"></a>
<a name="ln-7237"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">LightControlProbability</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7238"></a>          <span class="c">! Manual operation.  Occupant sets lights one level too high a fraction of the time equal to</span>
<a name="ln-7239"></a>          <span class="c">! 1. - ZoneDaylight(ZoneNum)%LightControlProbability.  RANDOM_NUMBER returns a random number</span>
<a name="ln-7240"></a>          <span class="c">! between 0 and 1.</span>
<a name="ln-7241"></a>          <span class="k">CALL </span><span class="nb">RANDOM_NUMBER</span><span class="p">(</span><span class="n">XRAN</span><span class="p">)</span>
<a name="ln-7242"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">XRAN</span> <span class="o">&gt;=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">LightControlProbability</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7243"></a>            <span class="c">! Set level one higher</span>
<a name="ln-7244"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">FP</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="n">FP</span> <span class="o">=</span> <span class="n">FP</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">/</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">LightControlSteps</span><span class="p">,</span><span class="n">r64</span><span class="p">))</span>
<a name="ln-7245"></a>          <span class="k">END IF</span> <span class="c">! XRAN</span>
<a name="ln-7246"></a>        <span class="k">END IF</span> <span class="c">! Light Control Probability &lt; 1</span>
<a name="ln-7247"></a>      <span class="k">END IF</span> <span class="c">! Lighting System Type</span>
<a name="ln-7248"></a>
<a name="ln-7249"></a>      <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">RefPtPowerReductionFactor</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">FP</span>
<a name="ln-7250"></a>
<a name="ln-7251"></a>      <span class="c">! Accumulate net ltg power reduction factor for entire zone</span>
<a name="ln-7252"></a>      <span class="n">ZFRAC</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FracZoneDaylit</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span>
<a name="ln-7253"></a>      <span class="n">TotReduction</span> <span class="o">=</span> <span class="n">TotReduction</span> <span class="o">+</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">RefPtPowerReductionFactor</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">*</span> <span class="n">ZFRAC</span>
<a name="ln-7254"></a>
<a name="ln-7255"></a>    <span class="k">END DO</span> <span class="c">! End of loop over reference points, IL</span>
<a name="ln-7256"></a>
<a name="ln-7257"></a>    <span class="c">! Correct for fraction of zone (1-ZFTOT) not controlled by</span>
<a name="ln-7258"></a>    <span class="c">! the reference points.  For this fraction (which is usually zero),</span>
<a name="ln-7259"></a>    <span class="c">! the electric lighting is unaffected and the power reduction</span>
<a name="ln-7260"></a>    <span class="c">! factor is therefore 1.0.</span>
<a name="ln-7261"></a>    <span class="n">TotReduction</span> <span class="o">=</span> <span class="n">TotReduction</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span> <span class="n">ZFTOT</span><span class="p">)</span>
<a name="ln-7262"></a>  <span class="k">ELSE</span> <span class="c">! controls not currently available</span>
<a name="ln-7263"></a>    <span class="n">TotReduction</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-7264"></a>  <span class="n">ENDIF</span>
<a name="ln-7265"></a>  <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ZonePowerReductionFactor</span> <span class="o">=</span> <span class="n">TotReduction</span>
<a name="ln-7266"></a>
<a name="ln-7267"></a><span class="c">!  IF(TotIllumMaps &gt; 0 .and. .not. DoingSizing .and. .not. WarmupFlag .and. .not. KickoffSimulation) THEN</span>
<a name="ln-7268"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">TotIllumMaps</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DoingSizing</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7269"></a>    <span class="c">! If an illuminance map is associated with this zone, generate the map</span>
<a name="ln-7270"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TimeStep</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">mapResultsToReport</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7271"></a>    <span class="k">DO </span><span class="n">ILM</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MapCount</span>
<a name="ln-7272"></a>      <span class="n">MapNum</span><span class="o">=</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ZoneToMap</span><span class="p">(</span><span class="n">ILM</span><span class="p">)</span>
<a name="ln-7273"></a>      <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">TotalMapRefPoints</span>
<a name="ln-7274"></a>        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllumAtMapPtHr</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllumAtMapPtHr</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-7275"></a>            <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllumAtMapPt</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfTimeStepInHour</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7276"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllumAtMapPtHr</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7277"></a><span class="k">          </span><span class="n">mapResultsToReport</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7278"></a>          <span class="n">mapResultsReported</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7279"></a>        <span class="n">ENDIF</span>
<a name="ln-7280"></a>      <span class="k">END DO</span>
<a name="ln-7281"></a><span class="k">      CALL </span><span class="n">ReportIllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)</span>
<a name="ln-7282"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TimeStep</span> <span class="o">==</span> <span class="n">NumOfTimeStepInHour</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7283"></a><span class="k">        </span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllumAtMapPtHr</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-7284"></a>        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllumAtMapPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-7285"></a>      <span class="n">ENDIF</span>
<a name="ln-7286"></a>    <span class="k">END DO</span>
<a name="ln-7287"></a><span class="k">  END IF</span>
<a name="ln-7288"></a>
<a name="ln-7289"></a><span class="k">  RETURN</span>
<a name="ln-7290"></a>
<a name="ln-7291"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgElecLightingControl</span>
<a name="ln-7292"></a>
<a name="ln-7293"></a>
<a name="ln-7294"></a><span class="k">FUNCTION </span><span class="n">DayltgGlarePositionFactor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<a name="ln-7295"></a>
<a name="ln-7296"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7297"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-7298"></a>          <span class="c">!       DATE WRITTEN   July 1997</span>
<a name="ln-7299"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7300"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7301"></a>
<a name="ln-7302"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7303"></a>          <span class="c">! by table interpolation, evaluates the</span>
<a name="ln-7304"></a>          <span class="c">! Hopkinson position factor used in glare calculation</span>
<a name="ln-7305"></a>          <span class="c">! (Hopkinson, Petherbridge, AND Longmore -- Daylighting,</span>
<a name="ln-7306"></a>          <span class="c">! London, 1966, PP 307, 323).  X (Y) is the lateral</span>
<a name="ln-7307"></a>          <span class="c">! (vertical) distance of luminous window element from</span>
<a name="ln-7308"></a>          <span class="c">! horizontal line of vision, divided by horizontal distance</span>
<a name="ln-7309"></a>          <span class="c">! from eye of observer. The array PF contains values of</span>
<a name="ln-7310"></a>          <span class="c">! the position factor for X = 0, 0.5, 1.0, 1.5, 2.0, 2.5,</span>
<a name="ln-7311"></a>          <span class="c">! and 3.0 and Y = 0, 0.5, 1.0, 1.5, 2.0. Called by CalcDayltgCoefficients.</span>
<a name="ln-7312"></a>
<a name="ln-7313"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7314"></a>
<a name="ln-7315"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7316"></a>          <span class="c">! Based on DOE-2.1E subroutine DPFAC.</span>
<a name="ln-7317"></a>
<a name="ln-7318"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7319"></a>          <span class="c">! na</span>
<a name="ln-7320"></a>
<a name="ln-7321"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7322"></a>
<a name="ln-7323"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-7324"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span>                     <span class="c">! Lateral and vertical distance of luminous window element from</span>
<a name="ln-7325"></a>                                         <span class="c">!  horizontal line of vision, divided by horizontal distance from</span>
<a name="ln-7326"></a>                                         <span class="c">!  eye of observer</span>
<a name="ln-7327"></a>
<a name="ln-7328"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-7329"></a>          <span class="c">! na</span>
<a name="ln-7330"></a>
<a name="ln-7331"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-7332"></a>          <span class="c">! na</span>
<a name="ln-7333"></a>
<a name="ln-7334"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7335"></a>          <span class="c">! na</span>
<a name="ln-7336"></a>
<a name="ln-7337"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7338"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">IX</span><span class="p">,</span><span class="n">IY</span>                   <span class="c">! Lateral and vertical displacement indices</span>
<a name="ln-7339"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">X1</span><span class="p">,</span><span class="n">Y1</span>                   <span class="c">! Lateral and vertical displacement ratios</span>
<a name="ln-7340"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FA</span><span class="p">,</span><span class="n">FB</span>                   <span class="c">! Intermediate variables</span>
<a name="ln-7341"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">DayltgGlarePositionFactor</span>  <span class="c">! Position factor</span>
<a name="ln-7342"></a>
<a name="ln-7343"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PF</span>  <span class="c">! Position factor array</span>
<a name="ln-7344"></a>  <span class="k">DATA </span><span class="n">PF</span>  <span class="p">&amp;</span>
<a name="ln-7345"></a>   <span class="o">/</span> <span class="mf">1.00d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">492</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">226</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">128</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">081</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">061</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">057</span><span class="n">d0</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7346"></a>     <span class="p">.</span><span class="mi">123</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">119</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">065</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">043</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">029</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">026</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">023</span><span class="n">d0</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7347"></a>     <span class="p">.</span><span class="mi">019</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">026</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">019</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">016</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">014</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">011</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">011</span><span class="n">d0</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7348"></a>     <span class="p">.</span><span class="mi">008</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">008</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">008</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">008</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">008</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">006</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">006</span><span class="n">d0</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7349"></a>     <span class="mf">0.00d0</span><span class="p">,</span> <span class="mf">0.00d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">003</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">003</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">003</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">003</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">003</span><span class="n">d0</span> <span class="o">/</span>
<a name="ln-7350"></a>
<a name="ln-7351"></a>
<a name="ln-7352"></a>          <span class="c">! FLOW:</span>
<a name="ln-7353"></a>  <span class="n">DayltgGlarePositionFactor</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7354"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">X</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">X</span> <span class="o">&gt;=</span> <span class="mf">3.0d0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-7355"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Y</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Y</span> <span class="o">&gt;=</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-7356"></a>
<a name="ln-7357"></a><span class="k">  </span><span class="n">IX</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="mf">2.d0</span> <span class="o">*</span> <span class="n">X</span><span class="p">)</span>
<a name="ln-7358"></a>  <span class="n">IY</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="mf">2.d0</span> <span class="o">*</span> <span class="n">Y</span><span class="p">)</span>
<a name="ln-7359"></a>  <span class="n">X1</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">IX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7360"></a>  <span class="n">Y1</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">IY</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7361"></a>  <span class="n">FA</span> <span class="o">=</span> <span class="n">PF</span><span class="p">(</span><span class="n">IX</span><span class="p">,</span><span class="n">IY</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.0d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">X1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">PF</span><span class="p">(</span><span class="n">IX</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">IY</span><span class="p">)</span> <span class="o">-</span> <span class="n">PF</span><span class="p">(</span><span class="n">IX</span><span class="p">,</span><span class="n">IY</span><span class="p">))</span>
<a name="ln-7362"></a>  <span class="n">FB</span> <span class="o">=</span> <span class="n">PF</span><span class="p">(</span><span class="n">IX</span><span class="p">,</span><span class="n">IY</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.0d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="o">-</span><span class="n">X1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">PF</span><span class="p">(</span><span class="n">IX</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">IY</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">PF</span><span class="p">(</span><span class="n">IX</span><span class="p">,</span><span class="n">IY</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-7363"></a>  <span class="n">DayltgGlarePositionFactor</span> <span class="o">=</span> <span class="n">FA</span> <span class="o">+</span> <span class="mf">2.0d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">Y1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">FB</span> <span class="o">-</span> <span class="n">FA</span><span class="p">)</span>
<a name="ln-7364"></a>
<a name="ln-7365"></a>  <span class="k">RETURN</span>
<a name="ln-7366"></a>
<a name="ln-7367"></a><span class="k">END FUNCTION </span><span class="n">DayltgGlarePositionFactor</span>
<a name="ln-7368"></a>
<a name="ln-7369"></a>
<a name="ln-7370"></a><span class="k">SUBROUTINE </span><span class="n">DayltgInterReflectedIllum</span><span class="p">(</span><span class="n">ISunPos</span><span class="p">,</span><span class="n">IHR</span><span class="p">,</span><span class="n">ZoneNum</span><span class="p">,</span><span class="n">IWin</span><span class="p">)</span>
<a name="ln-7371"></a>
<a name="ln-7372"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7373"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-7374"></a>          <span class="c">!       DATE WRITTEN   July 1997</span>
<a name="ln-7375"></a>          <span class="c">!       MODIFIED       FCW December 1998</span>
<a name="ln-7376"></a>          <span class="c">!                      FCW June 2001: Add blind calculations</span>
<a name="ln-7377"></a>          <span class="c">!                      FCW Jan 2001: Add blinds with movable slats</span>
<a name="ln-7378"></a>          <span class="c">!                      FCW Jan 2003: Add between-glass blinds</span>
<a name="ln-7379"></a>          <span class="c">!                      FCW Jul 2003: account for transmittance of shading surfaces</span>
<a name="ln-7380"></a>          <span class="c">!                       (previously these were assumed opaque even if transmittance schedule</span>
<a name="ln-7381"></a>          <span class="c">!                        value was non-zero)</span>
<a name="ln-7382"></a>          <span class="c">!                      FCW Aug 2003: modify initialization of WLUMSK from WLUMSK = 0. TO</span>
<a name="ln-7383"></a>          <span class="c">!                        WLUMSK(:,:,IHR) = 0. Otherwise values calculated in previous</span>
<a name="ln-7384"></a>          <span class="c">!                        call are incorrectly zeroed. Result was that window luminance with</span>
<a name="ln-7385"></a>          <span class="c">!                        shade or blind included only contribution from first window element</span>
<a name="ln-7386"></a>          <span class="c">!                        in window element loop in CalcDayltgCoefficients, thus seriously</span>
<a name="ln-7387"></a>          <span class="c">!                        undercalculating window luminance for windows with more than one</span>
<a name="ln-7388"></a>          <span class="c">!                        window element. Similarly, modified initialization of WLUMSU from</span>
<a name="ln-7389"></a>          <span class="c">!                        WLUMSU = 0. to WLUMSU(:,IHR) = 0., and of WLUMSUdisk from</span>
<a name="ln-7390"></a>          <span class="c">!                        WLUMSUdisk = 0. to WLUMSUdisk(:,IHR) = 0.</span>
<a name="ln-7391"></a>          <span class="c">!                      PGE Aug 2003: Add daylighting shelves.</span>
<a name="ln-7392"></a>          <span class="c">!                      FCW Nov 2003: Add beam solar and sky solar reflected from obstructions;</span>
<a name="ln-7393"></a>          <span class="c">!                                    add beam solar reflected from ground accounting for obstructions.</span>
<a name="ln-7394"></a>          <span class="c">!                      FCW Nov 2003: increase NPHMAX from 9 to 10 to avoid rays with altitude angle = 0</span>
<a name="ln-7395"></a>          <span class="c">!                                    for vertical surfaces.</span>
<a name="ln-7396"></a>          <span class="c">!                      FCW Nov 2003: fix the expression for min and max limits of azimuth; old expression</span>
<a name="ln-7397"></a>          <span class="c">!                                    broke down for window normals with negative altitude angle</span>
<a name="ln-7398"></a>          <span class="c">!                      FCW Nov 2003: add specular reflection from exterior obstructions</span>
<a name="ln-7399"></a>          <span class="c">!                      FCW Apr 2004: add light well efficiency multiplying window transmittance</span>
<a name="ln-7400"></a>          <span class="c">!                      FCW Apr 2004: add diffusing glazing</span>
<a name="ln-7401"></a>          <span class="c">!                      RAR (FSEC)  May 2006: add exterior window screen</span>
<a name="ln-7402"></a>          <span class="c">!                      B. Griffith NREL April 2010: CR7869 add adjacent zone area if window is not on this zone</span>
<a name="ln-7403"></a>          <span class="c">!                                    apply interior window transmission and blocking to beam transmission from ext win</span>
<a name="ln-7404"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7405"></a>
<a name="ln-7406"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7407"></a>          <span class="c">! Called from CalcDayltgCoefficients for each window and reference point in a daylit</span>
<a name="ln-7408"></a>          <span class="c">! space, for each sun position. Calculates illuminance (EINTSK and EINTSU) at reference point due</span>
<a name="ln-7409"></a>          <span class="c">! to internally reflected light by integrating to determine the amount of flux from</span>
<a name="ln-7410"></a>          <span class="c">! sky and ground (and beam reflected from obstructions) transmitted through</span>
<a name="ln-7411"></a>          <span class="c">! the center of the window and then reflecting this</span>
<a name="ln-7412"></a>          <span class="c">! light from the inside surfaces of the space.  The &quot;split-flux&quot; method is used</span>
<a name="ln-7413"></a>          <span class="c">! (Lynes, Principles of Natural Lighting, 1968).  EINT is determined for</span>
<a name="ln-7414"></a>          <span class="c">! different sky types and for window with and without shades, screens or blinds.</span>
<a name="ln-7415"></a>          <span class="c">!</span>
<a name="ln-7416"></a>          <span class="c">! Also finds luminance (WLUMSK and WLUMSU) of window with shade or blind, &amp;</span>
<a name="ln-7417"></a>          <span class="c">! or with diffusing glass, for different sky types.</span>
<a name="ln-7418"></a>
<a name="ln-7419"></a>          <span class="c">! METHODOLOGY EMPLOYED:na</span>
<a name="ln-7420"></a>
<a name="ln-7421"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7422"></a>          <span class="c">! Based on DOE-2.1E subroutine DREFLT.</span>
<a name="ln-7423"></a>
<a name="ln-7424"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7425"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">InterpProfAng</span><span class="p">,</span> <span class="n">POLYF</span><span class="p">,</span> <span class="n">BlindBeamBeamTrans</span>
<a name="ln-7426"></a>  <span class="k">USE </span><span class="n">DaylightingDevices</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindTDDPipe</span><span class="p">,</span> <span class="n">TransTDD</span>
<a name="ln-7427"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DetailedSkyDiffuseAlgorithm</span>
<a name="ln-7428"></a>
<a name="ln-7429"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7430"></a>
<a name="ln-7431"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7432"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ISunPos</span>                   <span class="c">! Sun position counter; used to avoid calculating various</span>
<a name="ln-7433"></a>                                                 <span class="c">!  quantities that do not depend on sun position.</span>
<a name="ln-7434"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">IHR</span>                       <span class="c">! Hour of day</span>
<a name="ln-7435"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ZoneNum</span>                   <span class="c">! Zone number</span>
<a name="ln-7436"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">IWin</span>                      <span class="c">! Window index</span>
<a name="ln-7437"></a>
<a name="ln-7438"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7439"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">NPHMAX</span> <span class="o">=</span> <span class="mi">10</span>             <span class="c">! Number of sky/ground integration steps in altitude</span>
<a name="ln-7440"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">NTHMAX</span> <span class="o">=</span> <span class="mi">16</span>             <span class="c">! Number of sky/ground integration steps in azimuth</span>
<a name="ln-7441"></a>
<a name="ln-7442"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-7443"></a>          <span class="c">! na</span>
<a name="ln-7444"></a>
<a name="ln-7445"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7446"></a>          <span class="c">! na</span>
<a name="ln-7447"></a>
<a name="ln-7448"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7449"></a>  <span class="c">! In the following I,J arrays:</span>
<a name="ln-7450"></a>  <span class="c">! I = sky type;</span>
<a name="ln-7451"></a>  <span class="c">! J = 1 for bare window, 2 and above for window with shade or blind.</span>
<a name="ln-7452"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FLFWSK</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>   <span class="c">! Sky-related downgoing luminous flux</span>
<a name="ln-7453"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FLFWSU</span><span class="p">(</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>     <span class="c">! Sun-related downgoing luminous flux, excluding entering beam</span>
<a name="ln-7454"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FLFWSUdisk</span><span class="p">(</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="c">! Sun-related downgoing luminous flux, due to entering beam</span>
<a name="ln-7455"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FLCWSK</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>   <span class="c">! Sky-related upgoing luminous flux</span>
<a name="ln-7456"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FLCWSU</span><span class="p">(</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>     <span class="c">! Sun-related upgoing luminous flux</span>
<a name="ln-7457"></a>
<a name="ln-7458"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ISKY</span>                      <span class="c">! Sky type index: 1=clear, 2=clear turbid,</span>
<a name="ln-7459"></a>                                         <span class="c">!  3=intermediate, 4=overcast</span>
<a name="ln-7460"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TransMult</span><span class="p">(</span><span class="n">MaxSlatAngs</span><span class="p">)</span>    <span class="c">! Transmittance multiplier</span>
<a name="ln-7461"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TransBmBmMult</span><span class="p">(</span><span class="n">MaxSlatAngs</span><span class="p">)</span><span class="c">! Isolated blind beam-beam transmittance</span>
<a name="ln-7462"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DPH</span><span class="p">,</span><span class="n">DTH</span>                   <span class="c">! Sky/ground element altitude and azimuth increments (radians)</span>
<a name="ln-7463"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IPH</span><span class="p">,</span><span class="n">ITH</span>                   <span class="c">! Sky/ground element altitude and azimuth indices</span>
<a name="ln-7464"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PH</span><span class="p">,</span><span class="n">TH</span>                     <span class="c">! Sky/ground element altitude and azimuth (radians)</span>
<a name="ln-7465"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SPH</span><span class="p">,</span><span class="n">CPH</span>                   <span class="c">! Sine and cosine of PH</span>
<a name="ln-7466"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PHMIN</span><span class="p">,</span><span class="n">PHMAX</span>               <span class="c">! Limits of altitude integration (radians)</span>
<a name="ln-7467"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">THMIN</span><span class="p">,</span><span class="n">THMAX</span>               <span class="c">! Limits of azimuth integration (radians)</span>
<a name="ln-7468"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PhWin</span><span class="p">,</span><span class="n">ThWin</span>               <span class="c">! Altitude, azimuth angle of window normal (radians)</span>
<a name="ln-7469"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ACosTanTan</span>                <span class="c">! ACOS(-TAN(Ph)*TAN(PhWin))</span>
<a name="ln-7470"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IConst</span>                    <span class="c">! Construction pointer</span>
<a name="ln-7471"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DA</span>                        <span class="c">! CPH*DTH*DPH</span>
<a name="ln-7472"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">COSB</span>                      <span class="c">! Cosine of angle of incidence of light from sky or ground</span>
<a name="ln-7473"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVISBR</span>                    <span class="c">! Transmittance of window without shading at COSB</span>
<a name="ln-7474"></a>                                         <span class="c">!  (times light well efficiency, if appropriate)</span>
<a name="ln-7475"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZSK</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ZSU</span>                <span class="c">! Sky-related and sun-related illuminance on window from sky/ground</span>
<a name="ln-7476"></a>                                         <span class="c">!  element for clear and overcast sky</span>
<a name="ln-7477"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">U</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                      <span class="c">! Unit vector in (PH,TH) direction</span>
<a name="ln-7478"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObTrans</span>                   <span class="c">! Product of solar transmittances of obstructions seen by a light ray</span>
<a name="ln-7479"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ObTransM</span><span class="p">(</span><span class="n">NTHMAX</span><span class="p">,</span><span class="n">NPHMAX</span><span class="p">)</span>   <span class="c">! ObTrans value for each (TH,PH) direction</span>
<a name="ln-7480"></a><span class="c">!!unused  REAL(r64)         :: HitPointLumFrClearSky     ! Luminance of obstruction from clear sky (cd/m2)</span>
<a name="ln-7481"></a><span class="c">!!unused  REAL(r64)         :: HitPointLumFrOvercSky     ! Luminance of obstruction from overcast sky (cd/m2)</span>
<a name="ln-7482"></a><span class="c">!!unused  REAL(r64)         :: HitPointLumFrSun          ! Luminance of obstruction from sun (cd/m2)</span>
<a name="ln-7483"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ICtrl</span>                     <span class="c">! Window control pointer</span>
<a name="ln-7484"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IConstShaded</span>              <span class="c">! Pointer to shaded construction for a window</span>
<a name="ln-7485"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">JSH</span>                       <span class="c">! Shading index: JSH=1 is bare window, JSH=2 is shaded window</span>
<a name="ln-7486"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">COSBSun</span>                   <span class="c">! Cosine of angle of incidence of direct sun on window</span>
<a name="ln-7487"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVISBSun</span>                  <span class="c">! Window&#39;s visible transmittance at COSBSun</span>
<a name="ln-7488"></a>                                         <span class="c">!  (times light well efficiency, if appropriate)</span>
<a name="ln-7489"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZSU1</span>                      <span class="c">! Transmitted direct normal illuminance (lux)</span>
<a name="ln-7490"></a><span class="c">!  CHARACTER(len=32) :: ShType                    ! Window shading device type</span>
<a name="ln-7491"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ShType</span>                    <span class="c">! Window shading device type</span>
<a name="ln-7492"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">ShadeOn</span>                   <span class="c">! True if exterior or interior window shade present</span>
<a name="ln-7493"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">BlindOn</span>                   <span class="c">! True if exterior or interior window blind present</span>
<a name="ln-7494"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">ScreenOn</span>                  <span class="c">! True if exterior window screen present</span>
<a name="ln-7495"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">BlNum</span>                     <span class="c">! Blind number</span>
<a name="ln-7496"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ScNum</span>                     <span class="c">! Screen number</span>
<a name="ln-7497"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">PipeNum</span>                   <span class="c">! TDD pipe object number</span>
<a name="ln-7498"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ShelfNum</span>                  <span class="c">! Daylighting shelf object number</span>
<a name="ln-7499"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">InShelfSurf</span>               <span class="c">! Inside daylighting shelf surface number</span>
<a name="ln-7500"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">OutShelfSurf</span>              <span class="c">! Outside daylighting shelf surface number</span>
<a name="ln-7501"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TransBlBmDiffFront</span>        <span class="c">! Isolated blind vis beam-diffuse front transmittance</span>
<a name="ln-7502"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TransScBmDiffFront</span>        <span class="c">! Isolated screen vis beam-diffuse front transmittance</span>
<a name="ln-7503"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TransScDiffDiffFront</span>      <span class="c">! Isolated screen vis diffuse-diffuse front transmittance</span>
<a name="ln-7504"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReflGlDiffDiffBack</span>        <span class="c">! Bare glazing system vis diffuse back reflectance</span>
<a name="ln-7505"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReflGlDiffDiffFront</span>       <span class="c">! Bare glazing system vis diffuse front reflectance</span>
<a name="ln-7506"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReflBlBmDiffFront</span>         <span class="c">! Isolated blind vis beam-diffuse front reflectance</span>
<a name="ln-7507"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TransBlDiffDiffFront</span>      <span class="c">! Isolated blind vis diffuse-diffuse front transmittance</span>
<a name="ln-7508"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReflBlDiffDiffFront</span>       <span class="c">! Isolated blind vis diffuse-diffuse front reflectance</span>
<a name="ln-7509"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReflBlDiffDiffBack</span>        <span class="c">! Isolated blind vis diffuse-diffuse back reflectance</span>
<a name="ln-7510"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReflScDiffDiffBack</span>        <span class="c">! Isolated screen vis diffuse-diffuse back reflectance</span>
<a name="ln-7511"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ProfAng</span>                   <span class="c">! Solar profile angle (radians)</span>
<a name="ln-7512"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SlatAng</span>                   <span class="c">! Blind slat angle</span>
<a name="ln-7513"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">JB</span>                        <span class="c">! Blind slat angle index</span>
<a name="ln-7514"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">t1</span><span class="p">,</span><span class="n">t2</span>                     <span class="c">! Beam-beam vis trans of bare glass layers 1 and 2</span>
<a name="ln-7515"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">td2</span><span class="p">,</span><span class="n">td3</span>                   <span class="c">! Diffuse-diffuse vis trans of bare glass layers 2 and 3</span>
<a name="ln-7516"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rbd1</span><span class="p">,</span><span class="n">rbd2</span>                 <span class="c">! Beam-diffuse back vis reflectance of bare glass layers 1 and 2</span>
<a name="ln-7517"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rfd2</span><span class="p">,</span><span class="n">rfd3</span>                 <span class="c">! Beam-diffuse front vis reflectance of bare glass layers 2 and 3</span>
<a name="ln-7518"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tfshBd</span>                    <span class="c">! Beam-diffuse front vis trans of bare blind</span>
<a name="ln-7519"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rfshB</span>                     <span class="c">! Beam-diffuse front vis reflectance of bare blind</span>
<a name="ln-7520"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tfshd</span>                     <span class="c">! Diffuse-diffuse front vis trans of bare blind</span>
<a name="ln-7521"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rbshd</span>                     <span class="c">! Diffuse-diffuse back vis reflectance of bare blind</span>
<a name="ln-7522"></a><span class="c">!!unused  REAL(r64)         :: A                         ! Intermediate value for azimuth limits calculation</span>
<a name="ln-7523"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZSUObsRefl</span>                <span class="c">! Illuminance on window from beam solar reflected by an</span>
<a name="ln-7524"></a>                                         <span class="c">!  obstruction (for unit beam normal illuminance)</span>
<a name="ln-7525"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NearestHitSurfNum</span>         <span class="c">! Surface number of nearest obstruction</span>
<a name="ln-7526"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NearestHitSurfNumX</span>        <span class="c">! Surface number to use when obstruction is a shadowing surface</span>
<a name="ln-7527"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NearestHitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>           <span class="c">! Hit point of ray on nearest obstruction (m)</span>
<a name="ln-7528"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LumAtHitPtFrSun</span>           <span class="c">! Luminance at hit point on obstruction from solar reflection</span>
<a name="ln-7529"></a>                                         <span class="c">!  for unit beam normal illuminance (cd/m2)</span>
<a name="ln-7530"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SunObstructionMult</span>        <span class="c">! = 1 if sun hits a ground point; otherwise = 0</span>
<a name="ln-7531"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">SkyObstructionMult</span><span class="p">(</span><span class="n">NTHMAX</span><span class="p">,</span><span class="n">NPHMAX</span><span class="p">)</span> <span class="c">! Ratio of obstructed to unobstructed sky diffuse at</span>
<a name="ln-7532"></a>                                                  <span class="c">! a ground point for each (TH,PH) direction</span>
<a name="ln-7533"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Alfa</span><span class="p">,</span><span class="n">Beta</span>            <span class="c">! Direction angles for ray heading towards the ground (radians)</span>
<a name="ln-7534"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HorDis</span>               <span class="c">! Distance between ground hit point and proj&#39;n of window center onto ground (m)</span>
<a name="ln-7535"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>       <span class="c">! Coordinates of point that ray from window center hits the ground (m)</span>
<a name="ln-7536"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ObsSurfNum</span>           <span class="c">! Obstruction surface number</span>
<a name="ln-7537"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHitObs</span>              <span class="c">! = 1 if obstruction is hit, = 0 otherwise</span>
<a name="ln-7538"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObsHitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>          <span class="c">! Coordinates of hit point on an obstruction (m)</span>
<a name="ln-7539"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ObsConstrNum</span>         <span class="c">! Construction number of obstruction</span>
<a name="ln-7540"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObsVisRefl</span>           <span class="c">! Visible reflectance of obstruction</span>
<a name="ln-7541"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyReflVisLum</span>        <span class="c">! Reflected sky luminance at hit point divided by unobstructed sky</span>
<a name="ln-7542"></a>                                    <span class="c">!  diffuse horizontal illuminance [(cd/m2)/lux]</span>
<a name="ln-7543"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dReflObsSky</span>          <span class="c">! Contribution to sky-related illuminance on window due to sky diffuse</span>
<a name="ln-7544"></a>                                    <span class="c">!  reflection from an obstruction</span>
<a name="ln-7545"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyGndUnObs</span>          <span class="c">! Unobstructed sky irradiance at a ground point</span>
<a name="ln-7546"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyGndObs</span>            <span class="c">! Obstructed sky irradiance at a ground point</span>
<a name="ln-7547"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Phi</span><span class="p">,</span><span class="n">Theta</span>            <span class="c">! Altitude and azimuth angle of ray from a ground point (radians)</span>
<a name="ln-7548"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IPhi</span><span class="p">,</span><span class="n">ITheta</span>          <span class="c">! Phi and Theta indices</span>
<a name="ln-7549"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DPhi</span><span class="p">,</span><span class="n">DTheta</span>          <span class="c">! Phi and Theta increment (radians)</span>
<a name="ln-7550"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SPhi</span><span class="p">,</span><span class="n">CPhi</span>            <span class="c">! Sin and cos of Phi</span>
<a name="ln-7551"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dOmega</span>               <span class="c">! Solid angle element of ray from ground point (steradians)</span>
<a name="ln-7552"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">URay</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>              <span class="c">! Unit vector in (Phi,Theta) direction</span>
<a name="ln-7553"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosIncAngURay</span>            <span class="c">! Cosine of incidence angle of URay on ground plane</span>
<a name="ln-7554"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IncAngSolidAngFac</span>    <span class="c">! CosIncAngURay*dOmega/Pi</span>
<a name="ln-7555"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TVisSunRefl</span>          <span class="c">! Diffuse vis trans of bare window for beam reflection calc</span>
<a name="ln-7556"></a>                                    <span class="c">!  (times light well efficiency, if appropriate)</span>
<a name="ln-7557"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZSU1refl</span>             <span class="c">! Beam normal illuminance times ZSU1refl = illuminance on window</span>
<a name="ln-7558"></a>                                            <span class="c">!  due to specular reflection from exterior surfaces</span>
<a name="ln-7559"></a>
<a name="ln-7560"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ZoneNumThisWin</span>   <span class="c">! temporary to check if this window is actually in adjacent zone</span>
<a name="ln-7561"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ExtWinType</span>                   <span class="c">! Exterior window type (InZoneExtWin, AdjZoneExtWin, NotInOrAdjZoneExtWin)</span>
<a name="ln-7562"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneInsideSurfArea</span> <span class="c">! temporary for calculations, total surface area of zone surfaces m2</span>
<a name="ln-7563"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IntWinAdjZoneExtWinNum</span> <span class="c">! the index of the exterior window in IntWinAdjZoneExtWin nested struct</span>
<a name="ln-7564"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">AdjExtWinLoop</span>  <span class="c">! loop index for searching IntWinAdjZoneExtWin</span>
<a name="ln-7565"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IntWinLoop</span> <span class="c">! loop index for searching interior windows</span>
<a name="ln-7566"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IntWinNum</span> <span class="c">! window index for interior windows associated with exterior windows</span>
<a name="ln-7567"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">COSBintWin</span>
<a name="ln-7568"></a>
<a name="ln-7569"></a>  <span class="n">ZoneNumThisWin</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-7570"></a>  <span class="c">! The inside surface area, ZoneDaylight(ZoneNum)%TotInsSurfArea was calculated in subr DayltgAveInteriorReflectance</span>
<a name="ln-7571"></a>
<a name="ln-7572"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ZoneNumThisWin</span> <span class="o">==</span> <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7573"></a><span class="k">    </span><span class="n">ExtWinType</span> <span class="o">=</span> <span class="n">InZoneExtWin</span>
<a name="ln-7574"></a>    <span class="n">ZoneInsideSurfArea</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotInsSurfArea</span>
<a name="ln-7575"></a>    <span class="n">IntWinAdjZoneExtWinNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7576"></a>  <span class="k">ELSE</span>
<a name="ln-7577"></a><span class="k">    </span><span class="n">ExtWinType</span> <span class="o">=</span> <span class="n">AdjZoneExtWin</span>
<a name="ln-7578"></a>    <span class="c">! If window is exterior window in adjacent zone, then use areas of both zones</span>
<a name="ln-7579"></a>    <span class="n">ZoneInsideSurfArea</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotInsSurfArea</span> <span class="o">+</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNumThisWin</span><span class="p">)%</span><span class="n">TotInsSurfArea</span>
<a name="ln-7580"></a>    <span class="c">! find index in IntWinAdjZoneExtWin</span>
<a name="ln-7581"></a>    <span class="k">Do </span><span class="n">AdjExtWinLoop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfIntWinAdjZoneExtWins</span>
<a name="ln-7582"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IWin</span> <span class="o">==</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IntWinAdjZoneExtWin</span><span class="p">(</span><span class="n">AdjExtWinLoop</span><span class="p">)%</span><span class="n">SurfNum</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! found it</span>
<a name="ln-7583"></a>        <span class="n">IntWinAdjZoneExtWinNum</span> <span class="o">=</span> <span class="n">AdjExtWinLoop</span>
<a name="ln-7584"></a>        <span class="k">EXIT</span>  <span class="c">! added TH 4/13/2010</span>
<a name="ln-7585"></a>      <span class="n">ENDIF</span>
<a name="ln-7586"></a>    <span class="n">ENDDO</span>
<a name="ln-7587"></a>  <span class="k">END IF</span>
<a name="ln-7588"></a>
<a name="ln-7589"></a>         <span class="c">! FLOW:</span>
<a name="ln-7590"></a>  <span class="c">! Initialize window luminance and fluxes for split-flux calculation</span>
<a name="ln-7591"></a>  <span class="n">WLUMSK</span><span class="p">(:,:,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7592"></a>  <span class="n">WLUMSU</span><span class="p">(:,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7593"></a>  <span class="n">WLUMSUdisk</span><span class="p">(:,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7594"></a>  <span class="n">FLFWSK</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7595"></a>  <span class="n">FLFWSU</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7596"></a>  <span class="n">FLFWSUdisk</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7597"></a>  <span class="n">FLCWSK</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7598"></a>  <span class="n">FLCWSU</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7599"></a>
<a name="ln-7600"></a>  <span class="n">IConst</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-7601"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">StormWinFlag</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="n">IConst</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">StormWinConstruction</span>
<a name="ln-7602"></a>  <span class="n">BlindOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7603"></a>  <span class="n">ShadeOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7604"></a>  <span class="n">ScreenOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7605"></a>
<a name="ln-7606"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7607"></a><span class="k">    </span><span class="n">PipeNum</span> <span class="o">=</span> <span class="n">FindTDDPipe</span><span class="p">(</span><span class="n">IWin</span><span class="p">)</span>
<a name="ln-7608"></a>  <span class="k">END IF</span>
<a name="ln-7609"></a>
<a name="ln-7610"></a><span class="k">  </span><span class="n">ShelfNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Shelf</span>
<a name="ln-7611"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ShelfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7612"></a><span class="k">    </span><span class="n">InShelfSurf</span> <span class="o">=</span> <span class="n">Shelf</span><span class="p">(</span><span class="n">ShelfNum</span><span class="p">)%</span><span class="n">InSurf</span> <span class="c">! Inside daylighting shelf present if &gt; 0</span>
<a name="ln-7613"></a>    <span class="n">OutShelfSurf</span> <span class="o">=</span> <span class="n">Shelf</span><span class="p">(</span><span class="n">ShelfNum</span><span class="p">)%</span><span class="n">OutSurf</span> <span class="c">! Outside daylighting shelf present if &gt; 0</span>
<a name="ln-7614"></a>  <span class="k">ELSE</span>
<a name="ln-7615"></a><span class="k">    </span><span class="n">InShelfSurf</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7616"></a>    <span class="n">OutShelfSurf</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7617"></a>  <span class="k">END IF</span>
<a name="ln-7618"></a>
<a name="ln-7619"></a>  <span class="c">! Divide sky and ground into elements of altitude PH and</span>
<a name="ln-7620"></a>  <span class="c">! azimuth TH, and add the contribution of light coming from each</span>
<a name="ln-7621"></a>  <span class="c">! element to the transmitted flux at the center of the window</span>
<a name="ln-7622"></a>  <span class="c">!</span>
<a name="ln-7623"></a>  <span class="c">! Azimuth ranges over a maximum of 2 Pi radians.</span>
<a name="ln-7624"></a>  <span class="c">! Altitude ranges over a maximum of Pi/2 radians between -Pi/2 &lt; PH &lt; +Pi/2, so that elements are not counted twice</span>
<a name="ln-7625"></a>  <span class="c">! PH = 0 at the horizon; PH = Pi/2 at the zenith</span>
<a name="ln-7626"></a>  <span class="n">PHMIN</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="o">-</span><span class="n">PIOVR2</span><span class="p">,</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Phi</span> <span class="o">-</span> <span class="n">PIOVR2</span><span class="p">)</span>
<a name="ln-7627"></a>  <span class="n">PHMAX</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">PIOVR2</span><span class="p">,</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Phi</span> <span class="o">+</span> <span class="n">PIOVR2</span><span class="p">)</span>
<a name="ln-7628"></a>  <span class="n">DPH</span> <span class="o">=</span> <span class="p">(</span><span class="n">PHMAX</span> <span class="o">-</span> <span class="n">PHMIN</span><span class="p">)</span> <span class="o">/</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">NPHMAX</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7629"></a>
<a name="ln-7630"></a>  <span class="c">! Sky/ground element altitude integration</span>
<a name="ln-7631"></a>  <span class="k">DO </span><span class="n">IPH</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NPHMAX</span>
<a name="ln-7632"></a>    <span class="n">PH</span> <span class="o">=</span> <span class="n">PHMIN</span> <span class="o">+</span> <span class="p">(</span><span class="kt">REAL</span><span class="p">(</span><span class="n">IPH</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">DPH</span>
<a name="ln-7633"></a>
<a name="ln-7634"></a>    <span class="n">SPH</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">PH</span><span class="p">)</span>
<a name="ln-7635"></a>    <span class="n">CPH</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">PH</span><span class="p">)</span>
<a name="ln-7636"></a>    <span class="c">! Third component of unit vector in (TH,PH) direction</span>
<a name="ln-7637"></a>    <span class="n">U</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">SPH</span>
<a name="ln-7638"></a>
<a name="ln-7639"></a>    <span class="c">! Limits of azimuth integration</span>
<a name="ln-7640"></a>    <span class="n">PhWin</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Phi</span>
<a name="ln-7641"></a>    <span class="n">ThWin</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Theta</span>
<a name="ln-7642"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">PhWin</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7643"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Ph</span> <span class="o">&gt;=</span> <span class="n">PiOvr2</span> <span class="o">-</span> <span class="n">PhWin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7644"></a><span class="k">        </span><span class="n">ThMin</span> <span class="o">=</span> <span class="o">-</span><span class="n">Pi</span>
<a name="ln-7645"></a>        <span class="n">ThMax</span> <span class="o">=</span> <span class="n">Pi</span>
<a name="ln-7646"></a>      <span class="k">ELSE</span>
<a name="ln-7647"></a><span class="k">        </span><span class="n">ACosTanTan</span> <span class="o">=</span> <span class="nb">ACOS</span><span class="p">(</span><span class="o">-</span><span class="nb">TAN</span><span class="p">(</span><span class="n">Ph</span><span class="p">)</span><span class="o">*</span><span class="nb">TAN</span><span class="p">(</span><span class="n">PhWin</span><span class="p">))</span>
<a name="ln-7648"></a>        <span class="n">ThMin</span> <span class="o">=</span> <span class="n">ThWin</span> <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">ACosTanTan</span><span class="p">)</span>
<a name="ln-7649"></a>        <span class="n">ThMax</span> <span class="o">=</span> <span class="n">ThWin</span> <span class="o">+</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">ACosTanTan</span><span class="p">)</span>
<a name="ln-7650"></a>      <span class="k">END IF</span>
<a name="ln-7651"></a>
<a name="ln-7652"></a><span class="k">    ELSE</span>  <span class="c">! PhiSurf &lt; 0.0</span>
<a name="ln-7653"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Ph</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">PhWin</span> <span class="o">-</span> <span class="n">PiOvr2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7654"></a><span class="k">        </span><span class="n">ThMin</span> <span class="o">=</span> <span class="o">-</span><span class="n">Pi</span>
<a name="ln-7655"></a>        <span class="n">ThMax</span> <span class="o">=</span> <span class="n">Pi</span>
<a name="ln-7656"></a>      <span class="k">ELSE</span>
<a name="ln-7657"></a><span class="k">        </span><span class="n">ACosTanTan</span> <span class="o">=</span> <span class="nb">ACOS</span><span class="p">(</span><span class="o">-</span><span class="nb">TAN</span><span class="p">(</span><span class="n">Ph</span><span class="p">)</span><span class="o">*</span><span class="nb">TAN</span><span class="p">(</span><span class="n">PhWin</span><span class="p">))</span>
<a name="ln-7658"></a>        <span class="n">ThMin</span> <span class="o">=</span> <span class="n">ThWin</span> <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">ACosTanTan</span><span class="p">)</span>
<a name="ln-7659"></a>        <span class="n">ThMax</span> <span class="o">=</span> <span class="n">ThWin</span> <span class="o">+</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">ACosTanTan</span><span class="p">)</span>
<a name="ln-7660"></a>      <span class="k">END IF</span>
<a name="ln-7661"></a><span class="k">    END IF</span>
<a name="ln-7662"></a>
<a name="ln-7663"></a><span class="k">    </span><span class="n">DTH</span> <span class="o">=</span> <span class="p">(</span><span class="n">THMAX</span> <span class="o">-</span> <span class="n">THMIN</span><span class="p">)</span> <span class="o">/</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">NTHMAX</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7664"></a>    <span class="n">DA</span> <span class="o">=</span> <span class="n">CPH</span> <span class="o">*</span> <span class="n">DTH</span> <span class="o">*</span> <span class="n">DPH</span>
<a name="ln-7665"></a>
<a name="ln-7666"></a>    <span class="c">! Sky/ground element azimuth integration</span>
<a name="ln-7667"></a>    <span class="k">DO </span><span class="n">ITH</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NTHMAX</span>
<a name="ln-7668"></a>      <span class="n">TH</span> <span class="o">=</span> <span class="n">THMIN</span> <span class="o">+</span> <span class="p">(</span><span class="kt">REAL</span><span class="p">(</span><span class="n">ITH</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">DTH</span>
<a name="ln-7669"></a>      <span class="n">U</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPH</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">TH</span><span class="p">)</span>
<a name="ln-7670"></a>      <span class="n">U</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPH</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">TH</span><span class="p">)</span>
<a name="ln-7671"></a>      <span class="c">! Cosine of angle of incidence of light from sky or ground element</span>
<a name="ln-7672"></a>      <span class="n">COSB</span> <span class="o">=</span> <span class="n">SPH</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Phi</span><span class="p">)</span> <span class="o">+</span> <span class="n">CPH</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Phi</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7673"></a>                 <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">TH</span><span class="o">-</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Theta</span><span class="p">)</span>
<a name="ln-7674"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">COSB</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span> <span class="c">! Sky/ground elements behind window (although there shouldn&#39;t be any)</span>
<a name="ln-7675"></a>
<a name="ln-7676"></a>      <span class="c">! Initialize illuminance on window for this sky/ground element</span>
<a name="ln-7677"></a>      <span class="n">ZSK</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7678"></a>      <span class="n">ZSU</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7679"></a>      <span class="c">! Initialize illuminance on window from beam solar reflection if ray hits an obstruction</span>
<a name="ln-7680"></a>      <span class="n">ZSUObsRefl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7681"></a>
<a name="ln-7682"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ISunPos</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Intersection calculation has to be done only for first sun position</span>
<a name="ln-7683"></a>        <span class="c">! Determine net transmittance of obstructions that the ray hits. ObTrans will be 1.0</span>
<a name="ln-7684"></a>        <span class="c">! if no obstructions are hit.</span>
<a name="ln-7685"></a>        <span class="k">CALL </span><span class="n">DayltgHitObstruction</span><span class="p">(</span><span class="n">IHr</span><span class="p">,</span><span class="n">IWin</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WinCenter</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">ObTrans</span><span class="p">)</span>
<a name="ln-7686"></a>        <span class="n">ObTransM</span><span class="p">(</span><span class="n">ITH</span><span class="p">,</span><span class="n">IPH</span><span class="p">)</span> <span class="o">=</span> <span class="n">ObTrans</span>
<a name="ln-7687"></a>      <span class="k">END IF</span>
<a name="ln-7688"></a>
<a name="ln-7689"></a>      <span class="c">! SKY AND GROUND RADIATION ON WINDOW</span>
<a name="ln-7690"></a>
<a name="ln-7691"></a>      <span class="c">! Contribution is from sky if PH &gt; 0 (ray goes upward), and from ground if PH &lt; 0 (ray goes downward)</span>
<a name="ln-7692"></a>      <span class="c">! (There may also be contributions from reflection from obstructions; see &#39;BEAM SOLAR AND SKY SOLAR</span>
<a name="ln-7693"></a>      <span class="c">! REFLECTED FROM NEAREST OBSTRUCTION,&#39; below.)</span>
<a name="ln-7694"></a>
<a name="ln-7695"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ISunPos</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">SkyObstructionMult</span><span class="p">(</span><span class="n">ITH</span><span class="p">,</span><span class="n">IPH</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7696"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PH</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Contribution is from sky</span>
<a name="ln-7697"></a>        <span class="k">DO </span><span class="n">ISKY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-7698"></a>          <span class="n">ZSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">=</span> <span class="n">DayltgSkyLuminance</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="n">TH</span><span class="p">,</span><span class="n">PH</span><span class="p">)</span> <span class="o">*</span> <span class="n">COSB</span> <span class="o">*</span> <span class="n">DA</span> <span class="o">*</span> <span class="n">ObTransM</span><span class="p">(</span><span class="n">ITH</span><span class="p">,</span><span class="n">IPH</span><span class="p">)</span>
<a name="ln-7699"></a>        <span class="k">END DO</span>
<a name="ln-7700"></a><span class="k">      ELSE</span>               <span class="c">! PH &lt;= 0.0; contribution is from ground</span>
<a name="ln-7701"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CalcSolRefl</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ObTransM</span><span class="p">(</span><span class="n">ITH</span><span class="p">,</span><span class="n">IPH</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-6</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ISunPos</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7702"></a>          <span class="c">! Calculate effect of obstructions on shading of sky diffuse reaching the ground point hit</span>
<a name="ln-7703"></a>          <span class="c">! by the ray. This effect is given by the ratio SkyObstructionMult =</span>
<a name="ln-7704"></a>          <span class="c">! (obstructed sky diffuse at ground point)/(unobstructed sky diffuse at ground point).</span>
<a name="ln-7705"></a>          <span class="c">! This ratio is calculated for an isotropic sky.</span>
<a name="ln-7706"></a>          <span class="c">! Ground point hit by the ray:</span>
<a name="ln-7707"></a>          <span class="n">Alfa</span> <span class="o">=</span> <span class="nb">ACOS</span><span class="p">(</span><span class="o">-</span><span class="n">U</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7708"></a>          <span class="n">Beta</span> <span class="o">=</span> <span class="n">ATAN2</span><span class="p">(</span><span class="n">U</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">U</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-7709"></a>          <span class="n">HorDis</span> <span class="o">=</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WinCenter</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">GroundLevelZ</span><span class="p">)</span><span class="o">*</span><span class="nb">TAN</span><span class="p">(</span><span class="n">Alfa</span><span class="p">)</span>
<a name="ln-7710"></a>          <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">GroundLevelZ</span>
<a name="ln-7711"></a>          <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WinCenter</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">HorDis</span><span class="o">*</span><span class="nb">COS</span><span class="p">(</span><span class="n">Beta</span><span class="p">)</span>
<a name="ln-7712"></a>          <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WinCenter</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">HorDis</span><span class="o">*</span><span class="nb">SIN</span><span class="p">(</span><span class="n">Beta</span><span class="p">)</span>
<a name="ln-7713"></a>
<a name="ln-7714"></a>          <span class="n">SkyObstructionMult</span><span class="p">(</span><span class="n">ITH</span><span class="p">,</span><span class="n">IPH</span><span class="p">)</span> <span class="o">=</span> <span class="n">CalcObstrMultiplier</span><span class="p">(</span><span class="n">GroundHitPt</span><span class="p">,</span> <span class="n">AltAngStepsForSolReflCalc</span><span class="p">,</span> <span class="n">AzimAngStepsForSolReflCalc</span><span class="p">)</span>
<a name="ln-7715"></a>        <span class="k">END IF</span>  <span class="c">! End of check if solar reflection calc is in effect</span>
<a name="ln-7716"></a>        <span class="k">DO </span><span class="n">ISKY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-7717"></a>          <span class="c">! Below, luminance of ground in cd/m2 is illuminance on ground in lumens/m2</span>
<a name="ln-7718"></a>          <span class="c">! times ground reflectance, divided by pi, times obstruction multiplier.</span>
<a name="ln-7719"></a>          <span class="n">ZSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">GILSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">*</span> <span class="n">GndReflectanceForDayltg</span> <span class="o">/</span> <span class="n">PI</span><span class="p">)</span> <span class="o">*</span> <span class="n">COSB</span> <span class="o">*</span> <span class="n">DA</span> <span class="o">*</span> <span class="n">ObTransM</span><span class="p">(</span><span class="n">ITH</span><span class="p">,</span><span class="n">IPH</span><span class="p">)</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-7720"></a>                          <span class="n">SkyObstructionMult</span><span class="p">(</span><span class="n">ITH</span><span class="p">,</span><span class="n">IPH</span><span class="p">)</span>
<a name="ln-7721"></a>        <span class="k">END DO</span>
<a name="ln-7722"></a>        <span class="c">! Determine if sun illuminates the point that ray hits the ground. If the solar reflection</span>
<a name="ln-7723"></a>        <span class="c">! calculation has been requested (CalcSolRefl = .TRUE.) shading by obstructions, including</span>
<a name="ln-7724"></a>        <span class="c">! the building itself, is considered in determining whether sun hits the ground point.</span>
<a name="ln-7725"></a>        <span class="c">! Otherwise this shading is ignored and the sun always hits the ground point.</span>
<a name="ln-7726"></a>        <span class="n">SunObstructionMult</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7727"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CalcSolRefl</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ObTransM</span><span class="p">(</span><span class="n">ITH</span><span class="p">,</span><span class="n">IPH</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-6</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7728"></a>          <span class="c">! Sun reaches ground point if vector from this point to the sun is unobstructed</span>
<a name="ln-7729"></a>          <span class="n">IHitObs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7730"></a>          <span class="k">DO </span><span class="n">ObsSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-7731"></a>            <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfPossibleObstruction</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-7732"></a><span class="k">            CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">,</span><span class="n">GroundHitPt</span><span class="p">,</span><span class="n">SunCosHr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">IHr</span><span class="p">),</span><span class="n">IHitObs</span><span class="p">,</span><span class="n">ObsHitPt</span><span class="p">)</span>
<a name="ln-7733"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-7734"></a><span class="k">          END DO</span>
<a name="ln-7735"></a><span class="k">          IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SunObstructionMult</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7736"></a>        <span class="k">END IF</span>
<a name="ln-7737"></a><span class="k">        </span><span class="n">ZSU</span> <span class="o">=</span> <span class="p">(</span><span class="n">GILSU</span><span class="p">(</span><span class="n">IHR</span><span class="p">)</span> <span class="o">*</span> <span class="n">GndReflectanceForDayltg</span> <span class="o">/</span> <span class="n">PI</span><span class="p">)</span> <span class="o">*</span> <span class="n">COSB</span> <span class="o">*</span> <span class="n">DA</span> <span class="o">*</span> <span class="n">ObTransM</span><span class="p">(</span><span class="n">ITH</span><span class="p">,</span><span class="n">IPH</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7738"></a>                <span class="n">SunObstructionMult</span>
<a name="ln-7739"></a>      <span class="k">END IF</span>
<a name="ln-7740"></a>
<a name="ln-7741"></a>      <span class="c">! BEAM SOLAR AND SKY SOLAR REFLECTED FROM NEAREST OBSTRUCTION</span>
<a name="ln-7742"></a>
<a name="ln-7743"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">CalcSolRefl</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ObTransM</span><span class="p">(</span><span class="n">ITH</span><span class="p">,</span><span class="n">IPH</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7744"></a>        <span class="c">! Find obstruction whose hit point is closest to the center of the window</span>
<a name="ln-7745"></a>        <span class="k">CALL </span><span class="n">DayltgClosestObstruction</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WinCenter</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">NearestHitSurfNum</span><span class="p">,</span><span class="n">NearestHitPt</span><span class="p">)</span>
<a name="ln-7746"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NearestHitSurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7747"></a>
<a name="ln-7748"></a>          <span class="c">! Beam solar reflected from nearest obstruction.</span>
<a name="ln-7749"></a>          <span class="k">CALL </span><span class="n">DayltgSurfaceLumFromSun</span><span class="p">(</span><span class="n">IHr</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">NearestHitSurfNum</span><span class="p">,</span><span class="n">NearestHitPt</span><span class="p">,</span><span class="n">LumAtHitPtFrSun</span><span class="p">)</span>
<a name="ln-7750"></a>          <span class="n">ZSUObsRefl</span> <span class="o">=</span> <span class="n">LumAtHitPtFrSun</span> <span class="o">*</span> <span class="n">COSB</span> <span class="o">*</span> <span class="n">DA</span>
<a name="ln-7751"></a>          <span class="n">ZSU</span> <span class="o">=</span> <span class="n">ZSU</span> <span class="o">+</span> <span class="n">ZSUObsRefl</span>
<a name="ln-7752"></a>
<a name="ln-7753"></a>          <span class="c">! Sky solar reflected from nearest obstruction.</span>
<a name="ln-7754"></a>          <span class="n">ObsConstrNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-7755"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ObsConstrNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7756"></a>            <span class="c">! Exterior building surface is nearest hit</span>
<a name="ln-7757"></a>            <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Construct</span><span class="p">(</span><span class="n">ObsConstrNum</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7758"></a>              <span class="c">! Obstruction is not a window, i.e., is an opaque surface</span>
<a name="ln-7759"></a>              <span class="n">ObsVisRefl</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">-</span> <span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ObsConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">AbsorpVisible</span>
<a name="ln-7760"></a>            <span class="k">ELSE</span>
<a name="ln-7761"></a>              <span class="c">! Obstruction is a window; assume it is bare</span>
<a name="ln-7762"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">StormWinFlag</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7763"></a>                <span class="n">ObsConstrNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">StormWinConstruction</span>
<a name="ln-7764"></a>              <span class="n">ObsVisRefl</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ObsConstrNum</span><span class="p">)%</span><span class="n">ReflectVisDiffFront</span>
<a name="ln-7765"></a>            <span class="k">END IF</span>
<a name="ln-7766"></a><span class="k">          ELSE</span>
<a name="ln-7767"></a>            <span class="c">! Shadowing surface is nearest hit</span>
<a name="ln-7768"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">Shelf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7769"></a>              <span class="c">! Skip daylighting shelves, whose reflection is separately calculated</span>
<a name="ln-7770"></a>              <span class="n">ObsVisRefl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7771"></a>            <span class="k">ELSE</span>
<a name="ln-7772"></a><span class="k">              </span><span class="n">ObsVisRefl</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfDiffuseVisRefl</span>
<a name="ln-7773"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingConstruct</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7774"></a>                 <span class="n">ObsVisRefl</span> <span class="o">=</span> <span class="n">ObsVisRefl</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingFrac</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-7775"></a>                  <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingConstruct</span><span class="p">)%</span><span class="n">ReflectVisDiffFront</span>
<a name="ln-7776"></a>              <span class="c">! Note in the above that ShadowSurfDiffuseVisRefl is the reflectance of opaque part of</span>
<a name="ln-7777"></a>              <span class="c">! shadowing surface times (1 - ShadowSurfGlazingFrac)</span>
<a name="ln-7778"></a>            <span class="k">END IF</span>
<a name="ln-7779"></a><span class="k">          END IF</span>
<a name="ln-7780"></a><span class="k">          </span><span class="n">NearestHitSurfNumX</span> <span class="o">=</span> <span class="n">NearestHitSurfNum</span>
<a name="ln-7781"></a>          <span class="c">! Each shadowing surface has a &quot;mirror&quot; duplicate surface facing in the opposite direction.</span>
<a name="ln-7782"></a>          <span class="c">! The following gets the correct side of a shadowing surface for reflection.</span>
<a name="ln-7783"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7784"></a><span class="k">            IF</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span>  <span class="n">NearestHitSurfNumX</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7785"></a>                      <span class="n">NearestHitSurfNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7786"></a>          <span class="k">END IF</span>
<a name="ln-7787"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DetailedSkyDiffuseAlgorithm</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span>  <span class="n">ShadingTransmittanceVaries</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-7788"></a>              <span class="n">SolarDistribution</span> <span class="o">==</span> <span class="n">MinimalShadowing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7789"></a><span class="k">            </span><span class="n">SkyReflVisLum</span> <span class="o">=</span> <span class="n">ObsVisRefl</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNumX</span><span class="p">)%</span><span class="n">ViewFactorSky</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-7790"></a>                               <span class="n">DifShdgRatioIsoSky</span><span class="p">(</span><span class="n">NearestHitSurfNumX</span><span class="p">)</span> <span class="o">/</span> <span class="n">Pi</span>
<a name="ln-7791"></a>          <span class="k">ELSE</span>
<a name="ln-7792"></a><span class="k">            </span><span class="n">SkyReflVisLum</span> <span class="o">=</span> <span class="n">ObsVisRefl</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNumX</span><span class="p">)%</span><span class="n">ViewFactorSky</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-7793"></a>                               <span class="n">DifShdgRatioIsoSkyHRTS</span><span class="p">(</span><span class="n">NearestHitSurfNumX</span><span class="p">,</span><span class="n">IHR</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">Pi</span>
<a name="ln-7794"></a>          <span class="n">ENDIF</span>
<a name="ln-7795"></a>          <span class="n">dReflObsSky</span> <span class="o">=</span> <span class="n">SkyReflVisLum</span> <span class="o">*</span> <span class="n">COSB</span> <span class="o">*</span> <span class="n">DA</span>
<a name="ln-7796"></a>          <span class="k">DO </span><span class="n">ISky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-7797"></a>            <span class="n">ZSK</span><span class="p">(</span><span class="n">ISky</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZSK</span><span class="p">(</span><span class="n">ISky</span><span class="p">)</span> <span class="o">+</span> <span class="n">GILSK</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="n">IHr</span><span class="p">)</span> <span class="o">*</span> <span class="n">dReflObsSky</span>
<a name="ln-7798"></a>          <span class="k">END DO</span>
<a name="ln-7799"></a><span class="k">        END IF</span>
<a name="ln-7800"></a><span class="k">      END IF</span>  <span class="c">! End of check if exterior solar reflection calculation is active</span>
<a name="ln-7801"></a>
<a name="ln-7802"></a>      <span class="c">!  ===Bare window (no shade or blind; non-diffusing glass)===</span>
<a name="ln-7803"></a>
<a name="ln-7804"></a>      <span class="c">! Increment flux entering space and window luminance (cd/m2).</span>
<a name="ln-7805"></a>      <span class="c">! FLCW--(I,J) = part of incoming flux (in lumens) that goes up to ceiling and upper part of walls.</span>
<a name="ln-7806"></a>      <span class="c">! FLFW--(I,J) = part that goes down to floor and lower part of walls</span>
<a name="ln-7807"></a>
<a name="ln-7808"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWIN</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7809"></a>        <span class="c">! Unshaded visible transmittance of TDD for a single ray from sky/ground element</span>
<a name="ln-7810"></a>        <span class="n">TVISBR</span> <span class="o">=</span> <span class="n">TransTDD</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span> <span class="n">COSB</span><span class="p">,</span> <span class="n">VisibleBeam</span><span class="p">)</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-7811"></a>
<a name="ln-7812"></a>        <span class="c">! Make all transmitted light diffuse for a TDD with a bare diffuser</span>
<a name="ln-7813"></a>        <span class="k">DO </span><span class="n">ISKY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-7814"></a>          <span class="n">WLUMSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">WLUMSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">*</span> <span class="n">TVISBR</span> <span class="o">/</span> <span class="n">PI</span>
<a name="ln-7815"></a>          <span class="n">FLFWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLFWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">*</span> <span class="n">TVISBR</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span><span class="p">)</span>
<a name="ln-7816"></a>          <span class="n">FLCWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLCWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">*</span> <span class="n">TVISBR</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span>
<a name="ln-7817"></a>
<a name="ln-7818"></a>          <span class="c">! For later calculation of diffuse visible transmittance</span>
<a name="ln-7819"></a>          <span class="n">TDDFluxInc</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span><span class="n">ISKY</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">TDDFluxInc</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span><span class="n">ISKY</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span>
<a name="ln-7820"></a>          <span class="n">TDDFluxTrans</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span><span class="n">ISKY</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">TDDFluxTrans</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span><span class="n">ISKY</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">*</span> <span class="n">TVISBR</span>
<a name="ln-7821"></a>
<a name="ln-7822"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7823"></a><span class="k">            </span><span class="n">WLUMSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">WLUMSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU</span> <span class="o">*</span> <span class="n">TVISBR</span> <span class="o">/</span> <span class="n">PI</span>
<a name="ln-7824"></a>            <span class="n">FLFWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLFWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU</span> <span class="o">*</span> <span class="n">TVISBR</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span><span class="p">)</span>
<a name="ln-7825"></a>            <span class="n">FLCWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLCWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU</span> <span class="o">*</span> <span class="n">TVISBR</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span>
<a name="ln-7826"></a>
<a name="ln-7827"></a>            <span class="c">! For later calculation of diffuse visible transmittance</span>
<a name="ln-7828"></a>            <span class="n">TDDFluxInc</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span><span class="n">ISKY</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">TDDFluxInc</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span><span class="n">ISKY</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU</span>
<a name="ln-7829"></a>            <span class="n">TDDFluxTrans</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span><span class="n">ISKY</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">TDDFluxTrans</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span><span class="n">ISKY</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU</span> <span class="o">*</span> <span class="n">TVISBR</span>
<a name="ln-7830"></a>          <span class="k">END IF</span>
<a name="ln-7831"></a><span class="k">        END DO</span>
<a name="ln-7832"></a>
<a name="ln-7833"></a><span class="k">      ELSE</span> <span class="c">! Bare window</span>
<a name="ln-7834"></a>
<a name="ln-7835"></a>        <span class="c">! Transmittance of bare window for this sky/ground element</span>
<a name="ln-7836"></a>        <span class="n">TVISBR</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">COSB</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-7837"></a>                    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-7838"></a>
<a name="ln-7839"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InShelfSurf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Inside daylighting shelf</span>
<a name="ln-7840"></a>          <span class="c">! Daylighting shelf simplification:  All light is diffuse</span>
<a name="ln-7841"></a>          <span class="c">! SurfaceWindow(IWin)%FractionUpgoing is already set to 1.0 earlier</span>
<a name="ln-7842"></a>          <span class="k">DO </span><span class="n">ISKY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-7843"></a>            <span class="n">FLCWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLCWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">*</span> <span class="n">TVISBR</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span>
<a name="ln-7844"></a>
<a name="ln-7845"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7846"></a><span class="k">              </span><span class="n">FLCWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLCWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU</span> <span class="o">*</span> <span class="n">TVISBR</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span>
<a name="ln-7847"></a>            <span class="k">END IF</span>
<a name="ln-7848"></a><span class="k">          END DO</span>
<a name="ln-7849"></a>
<a name="ln-7850"></a><span class="k">        ELSE</span> <span class="c">! Normal window</span>
<a name="ln-7851"></a>
<a name="ln-7852"></a>          <span class="c">! CR 7869  correct TVISBR if disk beam passes thru interior window</span>
<a name="ln-7853"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ExtWinType</span> <span class="o">==</span><span class="n">AdjZoneExtWin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7854"></a>            <span class="c">! modify TVISBR by second window transmission</span>
<a name="ln-7855"></a>            <span class="c">! first determine if ray from point passes thru any interior window</span>
<a name="ln-7856"></a>            <span class="n">IHitObs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7857"></a>            <span class="k">DO </span><span class="n">IntWinLoop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IntWinAdjZoneExtWin</span><span class="p">(</span><span class="n">IntWinAdjZoneExtWinNum</span><span class="p">)%</span><span class="n">NumOfIntWindows</span>
<a name="ln-7858"></a>              <span class="n">IntWinNum</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IntWinAdjZoneExtWin</span><span class="p">(</span><span class="n">IntWinAdjZoneExtWinNum</span><span class="p">)%</span><span class="n">IntWinNum</span><span class="p">(</span><span class="n">IntWinLoop</span><span class="p">)</span>
<a name="ln-7859"></a>              <span class="k">Call </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">IntWinNum</span><span class="p">,</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IntWinNum</span><span class="p">)%</span><span class="n">WinCenter</span><span class="p">,</span><span class="n">SunCosHr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">IHr</span><span class="p">),</span><span class="n">IHitObs</span><span class="p">,</span> <span class="n">ObsHitPt</span><span class="p">)</span>
<a name="ln-7860"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">IHitObs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! disk passes thru</span>
<a name="ln-7861"></a>                <span class="c">! cosine of incidence angle of light from sky or ground element for</span>
<a name="ln-7862"></a>                <span class="n">COSBintWin</span> <span class="o">=</span> <span class="n">SPH</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IntWinNum</span><span class="p">)%</span><span class="n">Phi</span><span class="p">)</span> <span class="o">+</span> <span class="n">CPH</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IntWinNum</span><span class="p">)%</span><span class="n">Phi</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7863"></a>                                   <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">TH</span><span class="o">-</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IntWinNum</span><span class="p">)%</span><span class="n">Theta</span><span class="p">)</span>
<a name="ln-7864"></a>                <span class="n">TVISBR</span> <span class="o">=</span> <span class="n">TVISBR</span> <span class="o">*</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">COSBintWin</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IntWinNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-7865"></a>                <span class="k">EXIT</span>
<a name="ln-7866"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-7867"></a>            <span class="n">ENDDO</span>
<a name="ln-7868"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IHitObs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THen</span> <span class="c">! blocked by opaque parts, beam does not actually pass thru interior window to reach zone</span>
<a name="ln-7869"></a>              <span class="n">TVISBR</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-7870"></a>            <span class="n">ENDIF</span>
<a name="ln-7871"></a>          <span class="n">ENDIF</span>
<a name="ln-7872"></a>
<a name="ln-7873"></a>          <span class="k">DO </span><span class="n">ISKY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-7874"></a>            <span class="c">!IF (PH &lt; 0.) THEN</span>
<a name="ln-7875"></a>            <span class="c">!Fixed by FCW, Nov. 2003:</span>
<a name="ln-7876"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">PH</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7877"></a><span class="k">              </span><span class="n">FLFWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLFWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">*</span> <span class="n">TVISBR</span>
<a name="ln-7878"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">FLFWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLFWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU</span> <span class="o">*</span> <span class="n">TVISBR</span>
<a name="ln-7879"></a>            <span class="k">ELSE</span>
<a name="ln-7880"></a><span class="k">              </span><span class="n">FLCWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLCWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">*</span> <span class="n">TVISBR</span>
<a name="ln-7881"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">FLCWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLCWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU</span> <span class="o">*</span> <span class="n">TVISBR</span>
<a name="ln-7882"></a>            <span class="k">END IF</span>
<a name="ln-7883"></a>
<a name="ln-7884"></a><span class="k">          END DO</span>
<a name="ln-7885"></a><span class="k">        END IF</span> <span class="c">! End of check if window with daylighting shelf or normal window</span>
<a name="ln-7886"></a>      <span class="k">END IF</span> <span class="c">! End of check if TDD:DOME or bare window</span>
<a name="ln-7887"></a>
<a name="ln-7888"></a>      <span class="c">! Check if window has shade or blind</span>
<a name="ln-7889"></a>      <span class="n">ICtrl</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span>
<a name="ln-7890"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ICtrl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7891"></a><span class="k">        </span><span class="n">ShType</span> <span class="o">=</span> <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ICtrl</span><span class="p">)%</span><span class="n">ShadingType</span>
<a name="ln-7892"></a>        <span class="n">BlNum</span>  <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">BlindNumber</span>
<a name="ln-7893"></a>        <span class="n">ScNum</span>  <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ScreenNumber</span>
<a name="ln-7894"></a>
<a name="ln-7895"></a>        <span class="n">ShadeOn</span> <span class="o">=</span> <span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_InteriorShade</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorShade</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_BetweenGlassShade</span><span class="p">)</span>
<a name="ln-7896"></a>        <span class="n">BlindOn</span> <span class="o">=</span> <span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_InteriorBlind</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorBlind</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_BetweenGlassBlind</span><span class="p">)</span>
<a name="ln-7897"></a>        <span class="n">ScreenOn</span> <span class="o">=</span> <span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorScreen</span><span class="p">)</span>
<a name="ln-7898"></a>      <span class="k">END IF</span>
<a name="ln-7899"></a>
<a name="ln-7900"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">BlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ScreenOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7901"></a>
<a name="ln-7902"></a>        <span class="c">! ===Window with interior or exterior shade or blind, exterior screen, or with diffusing glass===</span>
<a name="ln-7903"></a>
<a name="ln-7904"></a>        <span class="c">! Increment flux entering space and window luminance. Shades and diffusing glass are</span>
<a name="ln-7905"></a>        <span class="c">! assumed to be perfect diffusers, i.e., the transmittance is independent of angle of</span>
<a name="ln-7906"></a>        <span class="c">! incidence and the transmitted light is isotropic. The transmittance of a blind is</span>
<a name="ln-7907"></a>        <span class="c">! assumed to depend on profile angle and slat angle; the diffuse light entering the room from</span>
<a name="ln-7908"></a>        <span class="c">! the slats of the blind is assumed to be isotropic. With blinds, light can also enter</span>
<a name="ln-7909"></a>        <span class="c">! the room by passing between the slats without reflection. The beam transmittance of a screen</span>
<a name="ln-7910"></a>        <span class="c">! is assumed to depend on sun azimuth and azimuth angle.</span>
<a name="ln-7911"></a>
<a name="ln-7912"></a>        <span class="c">! For light from a shade, or from diffusing glass, or from the slats of a blind, a flux fraction,</span>
<a name="ln-7913"></a>        <span class="c">! SurfaceWindow(IWin)%FractionUpgoing (determined by window tilt), goes up toward</span>
<a name="ln-7914"></a>        <span class="c">! ceiling and upper part of walls, and 1-Surfacewindow(iwin)%FractionUpgoing</span>
<a name="ln-7915"></a>        <span class="c">! goes down toward floor and lower part of walls. For a blind, the light passing</span>
<a name="ln-7916"></a>        <span class="c">! between the slats goes either up or down depending on the altitude angle of the</span>
<a name="ln-7917"></a>        <span class="c">! element from which the light came. For a screen, the light passing</span>
<a name="ln-7918"></a>        <span class="c">! between the screen&#39;s cylinders goes either up or down depending on the altitude angle of the</span>
<a name="ln-7919"></a>        <span class="c">! element from which the light came.</span>
<a name="ln-7920"></a>
<a name="ln-7921"></a>        <span class="n">IConstShaded</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-7922"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">StormWinFlag</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="n">IConstShaded</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">StormWinShadedConstruction</span>
<a name="ln-7923"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="n">IConstShaded</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-7924"></a>
<a name="ln-7925"></a>        <span class="c">! Transmittance of window including shade, screen or blind</span>
<a name="ln-7926"></a>        <span class="n">TransBmBmMult</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7927"></a>        <span class="n">TransMult</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7928"></a>
<a name="ln-7929"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ShadeOn</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Shade</span>
<a name="ln-7930"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7931"></a>            <span class="c">! Shaded visible transmittance of TDD for a single ray from sky/ground element</span>
<a name="ln-7932"></a>            <span class="n">TransMult</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TransTDD</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span> <span class="n">COSB</span><span class="p">,</span> <span class="n">VisibleBeam</span><span class="p">)</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-7933"></a>          <span class="k">ELSE</span> <span class="c">! Shade only, no TDD</span>
<a name="ln-7934"></a>            <span class="c">! Calculate transmittance of the combined window and shading device for this sky/ground element</span>
<a name="ln-7935"></a>            <span class="n">TransMult</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">COSB</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConstShaded</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7936"></a>                              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-7937"></a>          <span class="k">END IF</span>
<a name="ln-7938"></a>
<a name="ln-7939"></a><span class="k">        ELSE IF</span><span class="p">(</span><span class="n">ScreenOn</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Screen: get beam-beam, beam-diffuse and diffuse-diffuse vis trans/ref of screen and glazing system</span>
<a name="ln-7940"></a>            <span class="k">CALL </span><span class="n">CalcScreenTransmittance</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span> <span class="n">Phi</span><span class="o">=</span><span class="p">(</span><span class="n">PH</span><span class="o">-</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Phi</span><span class="p">),</span> <span class="n">Theta</span><span class="o">=</span><span class="p">(</span><span class="n">TH</span><span class="o">-</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Theta</span><span class="p">))</span>
<a name="ln-7941"></a>            <span class="n">ReflGlDiffDiffFront</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">ReflectVisDiffFront</span>
<a name="ln-7942"></a>            <span class="n">ReflScDiffDiffBack</span> <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ScreenNumber</span><span class="p">)%</span><span class="n">DifReflectVis</span>
<a name="ln-7943"></a>            <span class="n">TransScBmDiffFront</span> <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ScreenNumber</span><span class="p">)%</span><span class="n">BmDifTransVis</span>
<a name="ln-7944"></a>            <span class="n">TransMult</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TransScBmDiffFront</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7945"></a>                            <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransDiffVis</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ReflGlDiffDiffFront</span><span class="o">*</span><span class="n">ReflScDiffDiffBack</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7946"></a>                              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-7947"></a>            <span class="n">TransBmBmMult</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ScreenNumber</span><span class="p">)%</span><span class="n">BmBmTransVis</span>
<a name="ln-7948"></a>
<a name="ln-7949"></a>        <span class="k">ELSE IF</span><span class="p">(</span><span class="n">BlindOn</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Blind: get beam-diffuse and beam-beam vis trans of blind+glazing system</span>
<a name="ln-7950"></a>          <span class="c">! PETER:  As long as only interior blinds are allowed for TDDs, no need to change TransMult calculation</span>
<a name="ln-7951"></a>          <span class="c">!         for TDDs because it is based on TVISBR which is correctly calculated for TDDs above.</span>
<a name="ln-7952"></a>
<a name="ln-7953"></a>          <span class="k">CALL </span><span class="n">ProfileAngle</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatOrientation</span><span class="p">,</span><span class="n">ProfAng</span><span class="p">)</span>
<a name="ln-7954"></a>
<a name="ln-7955"></a>          <span class="k">DO </span><span class="n">JB</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MaxSlatAngs</span>
<a name="ln-7956"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">JB</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-7957"></a>
<a name="ln-7958"></a><span class="k">            </span><span class="n">TransBlBmDiffFront</span> <span class="o">=</span> <span class="n">InterpProfAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontBeamDiffTrans</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">37</span><span class="p">,</span><span class="n">JB</span><span class="p">))</span>
<a name="ln-7959"></a>
<a name="ln-7960"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_InteriorBlind</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Interior blind</span>
<a name="ln-7961"></a>              <span class="n">ReflGlDiffDiffBack</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">ReflectVisDiffBack</span>
<a name="ln-7962"></a>              <span class="n">ReflBlBmDiffFront</span>  <span class="o">=</span> <span class="n">InterpProfAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontBeamDiffRefl</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">37</span><span class="p">,</span><span class="n">JB</span><span class="p">))</span>
<a name="ln-7963"></a>              <span class="n">ReflBlDiffDiffFront</span> <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontDiffDiffRefl</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-7964"></a>              <span class="n">TransBlDiffDiffFront</span> <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontDiffDiffTrans</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-7965"></a>              <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">=</span> <span class="n">TVISBR</span><span class="o">*</span><span class="p">(</span><span class="n">TransBlBmDiffFront</span> <span class="o">+</span> <span class="n">ReflBlBmDiffFront</span><span class="o">*</span><span class="n">ReflGlDiffDiffBack</span><span class="o">*</span><span class="n">TransBlDiffDiffFront</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-7966"></a>                              <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">ReflBlDiffDiffFront</span><span class="o">*</span><span class="n">ReflGlDiffDiffBack</span><span class="p">))</span>
<a name="ln-7967"></a>
<a name="ln-7968"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorBlind</span><span class="p">)</span> <span class="k">THEN</span>     <span class="c">! Exterior blind</span>
<a name="ln-7969"></a>              <span class="n">ReflGlDiffDiffFront</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">ReflectVisDiffFront</span>
<a name="ln-7970"></a>              <span class="n">ReflBlDiffDiffBack</span> <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisBackDiffDiffRefl</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-7971"></a>              <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">=</span> <span class="n">TransBlBmDiffFront</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7972"></a>                               <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransDiffVis</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">ReflGlDiffDiffFront</span><span class="o">*</span><span class="n">ReflBlDiffDiffBack</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7973"></a>                               <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-7974"></a>
<a name="ln-7975"></a>            <span class="k">ELSE</span>                                        <span class="c">! Between-glass blind</span>
<a name="ln-7976"></a>              <span class="n">t1</span>     <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">COSB</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">tBareVisCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-7977"></a>              <span class="n">td2</span>    <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">tBareVisDiff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7978"></a>              <span class="n">rbd1</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">rbBareVisDiff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7979"></a>              <span class="n">rfd2</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">rfBareVisDiff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7980"></a>              <span class="n">tfshBd</span> <span class="o">=</span> <span class="n">InterpProfAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontBeamDiffTrans</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">37</span><span class="p">,</span><span class="n">JB</span><span class="p">))</span>
<a name="ln-7981"></a>              <span class="n">tfshd</span>  <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontDiffDiffTrans</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-7982"></a>              <span class="n">rfshB</span>  <span class="o">=</span> <span class="n">InterpProfAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontBeamDiffRefl</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">37</span><span class="p">,</span><span class="n">JB</span><span class="p">))</span>
<a name="ln-7983"></a>              <span class="n">rbshd</span>  <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontDiffDiffRefl</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-7984"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TotGlassLayers</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! 2 glass layers</span>
<a name="ln-7985"></a>                <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">=</span> <span class="n">t1</span><span class="o">*</span><span class="p">(</span><span class="n">tfshBd</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">+</span> <span class="n">rfd2</span><span class="o">*</span><span class="n">rbshd</span><span class="p">)</span> <span class="o">+</span> <span class="n">rfshB</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">tfshd</span><span class="p">)</span><span class="o">*</span><span class="n">td2</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-7986"></a>              <span class="k">ELSE</span>                                             <span class="c">! 3 glass layers; blind between layers 2 and 3</span>
<a name="ln-7987"></a>                <span class="n">t2</span>   <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">COSB</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">tBareVisCoef</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-7988"></a>                <span class="n">td3</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">tBareVisDiff</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-7989"></a>                <span class="n">rfd3</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">rfBareVisDiff</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-7990"></a>                <span class="n">rbd2</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">rbBareVisDiff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7991"></a>                <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">=</span> <span class="n">t1</span><span class="o">*</span><span class="n">t2</span><span class="o">*</span><span class="p">(</span><span class="n">tfshBd</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">+</span> <span class="n">rfd3</span><span class="o">*</span><span class="n">rbshd</span><span class="p">)</span> <span class="o">+</span> <span class="n">rfshB</span><span class="o">*</span><span class="p">(</span><span class="n">rbd2</span><span class="o">*</span><span class="n">tfshd</span> <span class="o">+</span> <span class="n">td2</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">td2</span><span class="o">*</span><span class="n">tfshd</span><span class="p">))</span><span class="o">*</span><span class="n">td3</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-7992"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-7993"></a>              <span class="k">END IF</span>
<a name="ln-7994"></a><span class="k">            END IF</span>
<a name="ln-7995"></a>
<a name="ln-7996"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7997"></a><span class="k">              </span><span class="n">SlatAng</span> <span class="o">=</span> <span class="p">(</span><span class="n">JB</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">PI</span><span class="o">/</span><span class="p">(</span><span class="n">MaxSlatAngs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7998"></a>            <span class="k">ELSE</span>
<a name="ln-7999"></a><span class="k">              </span><span class="n">SlatAng</span> <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatAngle</span> <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-8000"></a>            <span class="k">END IF</span>
<a name="ln-8001"></a><span class="k">            </span><span class="n">TransBmBmMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">=</span> <span class="n">TVISBR</span> <span class="o">*</span> <span class="n">BlindBeamBeamTrans</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8002"></a>                                  <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatThickness</span><span class="p">)</span>
<a name="ln-8003"></a>          <span class="k">END DO</span> <span class="c">! End of loop over slat angles</span>
<a name="ln-8004"></a>
<a name="ln-8005"></a>        <span class="k">ELSE</span>  <span class="c">! Diffusing glass</span>
<a name="ln-8006"></a>          <span class="n">TransMult</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">COSB</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConstShaded</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-8007"></a>                              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-8008"></a>        <span class="k">END IF</span> <span class="c">! End of check if shade, blind or diffusing glass</span>
<a name="ln-8009"></a>
<a name="ln-8010"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8011"></a>          <span class="c">! No beam is transmitted.  This takes care of all types of screens and blinds.</span>
<a name="ln-8012"></a>          <span class="n">TransBmBmMult</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8013"></a>        <span class="k">END IF</span>
<a name="ln-8014"></a>
<a name="ln-8015"></a>        <span class="c">! Daylighting shelf simplification:  No beam makes it past end of shelf, all light is diffuse</span>
<a name="ln-8016"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InShelfSurf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Inside daylighting shelf</span>
<a name="ln-8017"></a>          <span class="n">TransBmBmMult</span> <span class="o">=</span> <span class="mf">0.0d0</span><span class="c">! No beam, diffuse only</span>
<a name="ln-8018"></a>        <span class="k">END IF</span>
<a name="ln-8019"></a>
<a name="ln-8020"></a>        <span class="c">! TransBmBmMult is used in the following for windows with blinds or screens to get contribution from light</span>
<a name="ln-8021"></a>        <span class="c">! passing directly between slats or between screen material without reflection.</span>
<a name="ln-8022"></a>
<a name="ln-8023"></a>        <span class="k">DO </span><span class="n">ISKY</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-8024"></a>          <span class="k">DO </span><span class="n">JB</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MaxSlatAngs</span>
<a name="ln-8025"></a>            <span class="c">! EXIT after first pass if not movable slats or exterior window screen</span>
<a name="ln-8026"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">JB</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-8027"></a>
<a name="ln-8028"></a><span class="k">            </span><span class="n">WLUMSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">WLUMSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">*</span> <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">/</span> <span class="n">PI</span>
<a name="ln-8029"></a>            <span class="n">FLFWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLFWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">*</span> <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span><span class="p">)</span>
<a name="ln-8030"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">PH</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">BlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ScreenOn</span><span class="p">))</span> <span class="n">FLFWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLFWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">*</span> <span class="n">TransBmBmMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-8031"></a>            <span class="n">FLCWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLCWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">*</span> <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span>
<a name="ln-8032"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">PH</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">BlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ScreenOn</span><span class="p">))</span> <span class="n">FLCWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLCWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">*</span> <span class="n">TransBmBmMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-8033"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8034"></a><span class="k">              </span><span class="n">WLUMSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">WLUMSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU</span> <span class="o">*</span> <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">/</span> <span class="n">PI</span>
<a name="ln-8035"></a>              <span class="n">FLFWSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLFWSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU</span> <span class="o">*</span> <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span><span class="p">)</span>
<a name="ln-8036"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">PH</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">BlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ScreenOn</span><span class="p">))</span> <span class="n">FLFWSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLFWSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU</span> <span class="o">*</span> <span class="n">TransBmBmMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-8037"></a>              <span class="n">FLCWSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLCWSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU</span> <span class="o">*</span> <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span>
<a name="ln-8038"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">PH</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">BlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ScreenOn</span><span class="p">))</span> <span class="n">FLCWSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLCWSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU</span> <span class="o">*</span> <span class="n">TransBmBmMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-8039"></a>            <span class="k">END IF</span>
<a name="ln-8040"></a><span class="k">          END DO</span>
<a name="ln-8041"></a><span class="k">        END DO</span>
<a name="ln-8042"></a><span class="k">      END IF</span> <span class="c">! End of window with shade, screen, blind or diffusing glass</span>
<a name="ln-8043"></a>
<a name="ln-8044"></a>    <span class="k">END DO</span> <span class="c">! End of azimuth integration loop, ITH</span>
<a name="ln-8045"></a>  <span class="k">END DO</span> <span class="c">! End of altitude integration loop, IPH</span>
<a name="ln-8046"></a>
<a name="ln-8047"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OutShelfSurf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Outside daylighting shelf</span>
<a name="ln-8048"></a>    <span class="c">! Add exterior diffuse illuminance due to outside shelf</span>
<a name="ln-8049"></a>    <span class="c">! Since all of the illuminance is added to the zone as upgoing diffuse, it can be added as a lump sum here</span>
<a name="ln-8050"></a>
<a name="ln-8051"></a>    <span class="n">TVISBR</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransDiffVis</span> <span class="c">! Assume diffuse transmittance for shelf illuminance</span>
<a name="ln-8052"></a>
<a name="ln-8053"></a>    <span class="k">DO </span><span class="n">ISKY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-8054"></a>      <span class="c">! This is only an estimate because the anisotropic sky view of the shelf is not yet taken into account.</span>
<a name="ln-8055"></a>      <span class="c">! AnisoSkyMult would be great to use but it is not available until the heat balance starts up.</span>
<a name="ln-8056"></a>      <span class="n">ZSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">=</span> <span class="n">GILSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0d0</span><span class="o">*</span> <span class="n">Shelf</span><span class="p">(</span><span class="n">ShelfNum</span><span class="p">)%</span><span class="n">OutReflectVis</span> <span class="o">*</span> <span class="n">Shelf</span><span class="p">(</span><span class="n">ShelfNum</span><span class="p">)%</span><span class="n">ViewFactor</span>
<a name="ln-8057"></a>
<a name="ln-8058"></a>      <span class="c">! SurfaceWindow(IWin)%FractionUpgoing is already set to 1.0 earlier</span>
<a name="ln-8059"></a>      <span class="n">FLCWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLCWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">)</span> <span class="o">*</span> <span class="n">TVISBR</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span>
<a name="ln-8060"></a>
<a name="ln-8061"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8062"></a><span class="k">        </span><span class="n">ZSU</span> <span class="o">=</span> <span class="n">GILSU</span><span class="p">(</span><span class="n">IHR</span><span class="p">)</span> <span class="o">*</span> <span class="n">SunLitFracHR</span><span class="p">(</span><span class="n">OutShelfSurf</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">*</span> <span class="n">Shelf</span><span class="p">(</span><span class="n">ShelfNum</span><span class="p">)%</span><span class="n">OutReflectVis</span> <span class="o">*</span> <span class="n">Shelf</span><span class="p">(</span><span class="n">ShelfNum</span><span class="p">)%</span><span class="n">ViewFactor</span>
<a name="ln-8063"></a>        <span class="n">FLCWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLCWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU</span> <span class="o">*</span> <span class="n">TVISBR</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span>
<a name="ln-8064"></a>      <span class="k">END IF</span>
<a name="ln-8065"></a><span class="k">    END DO</span> <span class="c">! ISKY</span>
<a name="ln-8066"></a>  <span class="k">END IF</span>
<a name="ln-8067"></a>
<a name="ln-8068"></a>  <span class="c">! Sky-related portion of internally reflected illuminance.</span>
<a name="ln-8069"></a>  <span class="c">! The inside surface area, ZoneDaylight(ZoneNum)%TotInsSurfArea, and ZoneDaylight(ZoneNum)%AveVisDiffReflect,</span>
<a name="ln-8070"></a>  <span class="c">! were calculated in subr DayltgAveInteriorReflectance.</span>
<a name="ln-8071"></a>
<a name="ln-8072"></a>  <span class="k">DO </span><span class="n">ISKY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-8073"></a>    <span class="k">DO </span><span class="n">JSH</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-8074"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">JSH</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-8075"></a>      <span class="c">! Full area of window is used in following since effect of dividers on reducing</span>
<a name="ln-8076"></a>      <span class="c">! effective window transmittance has already been accounted for in calc of FLFWSK and FLCWSK.</span>
<a name="ln-8077"></a>      <span class="n">EINTSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JSH</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">FLFWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JSH</span><span class="p">)</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">RhoFloorWall</span> <span class="p">&amp;</span>
<a name="ln-8078"></a>                             <span class="o">+</span> <span class="n">FLCWSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="n">JSH</span><span class="p">)</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">RhoCeilingWall</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8079"></a>                             <span class="o">*</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Area</span><span class="o">/</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8080"></a>                             <span class="o">/</span> <span class="p">(</span><span class="n">ZoneInsideSurfArea</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span><span class="p">))</span>
<a name="ln-8081"></a>    <span class="k">END DO</span> <span class="c">! JSH</span>
<a name="ln-8082"></a>  <span class="k">END DO</span> <span class="c">! ISKY</span>
<a name="ln-8083"></a>
<a name="ln-8084"></a>  <span class="c">! BEAM SOLAR RADIATION ON WINDOW</span>
<a name="ln-8085"></a>
<a name="ln-8086"></a>  <span class="c">! Beam reaching window directly (without specular reflection from exterior obstructions)</span>
<a name="ln-8087"></a>
<a name="ln-8088"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SunLitFracHR</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8089"></a>    <span class="c">! Cos of angle of incidence</span>
<a name="ln-8090"></a>    <span class="n">COSBSun</span> <span class="o">=</span> <span class="n">SPHSUN</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Phi</span><span class="p">)</span> <span class="o">+</span> <span class="n">CPHSUN</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Phi</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8091"></a>              <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">THSUN</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Theta</span><span class="p">)</span>
<a name="ln-8092"></a>
<a name="ln-8093"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">COSBSun</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8094"></a>      <span class="c">! Multiply direct normal illuminance (normalized to 1.0 lux)</span>
<a name="ln-8095"></a>      <span class="c">! by incident angle factor and by fraction of window that is sunlit.</span>
<a name="ln-8096"></a>      <span class="c">! Note that in the following SunLitFracHR accounts for possibly non-zero transmittance of</span>
<a name="ln-8097"></a>      <span class="c">! shading surfaces.</span>
<a name="ln-8098"></a>
<a name="ln-8099"></a>      <span class="n">ZSU1</span> <span class="o">=</span> <span class="n">COSBSun</span> <span class="o">*</span> <span class="n">SunLitFracHR</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span>
<a name="ln-8100"></a>
<a name="ln-8101"></a>      <span class="c">! Contribution to window luminance and downgoing flux</span>
<a name="ln-8102"></a>
<a name="ln-8103"></a>      <span class="c">! -- Bare window</span>
<a name="ln-8104"></a>
<a name="ln-8105"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8106"></a>        <span class="c">! Unshaded visible transmittance of TDD for collimated beam from the sun</span>
<a name="ln-8107"></a>        <span class="n">TVISBSun</span> <span class="o">=</span> <span class="n">TransTDD</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span> <span class="n">COSBSun</span><span class="p">,</span> <span class="n">VisibleBeam</span><span class="p">)</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-8108"></a>        <span class="n">TDDTransVisBeam</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span> <span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">TVISBSun</span>
<a name="ln-8109"></a>
<a name="ln-8110"></a>        <span class="n">FLFWSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span><span class="c">! Diffuse light only</span>
<a name="ln-8111"></a>
<a name="ln-8112"></a>        <span class="n">WLUMSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">WLUMSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU1</span> <span class="o">*</span> <span class="n">TVISBSun</span> <span class="o">/</span> <span class="n">PI</span>
<a name="ln-8113"></a>        <span class="n">FLFWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLFWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU1</span> <span class="o">*</span> <span class="n">TVISBSun</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span><span class="p">)</span>
<a name="ln-8114"></a>        <span class="n">FLCWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLCWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU1</span> <span class="o">*</span> <span class="n">TVISBSun</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span>
<a name="ln-8115"></a>
<a name="ln-8116"></a>      <span class="k">ELSE</span> <span class="c">! Bare window</span>
<a name="ln-8117"></a>        <span class="n">TVISBSun</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">COSBSun</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-8118"></a>                      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-8119"></a>
<a name="ln-8120"></a>        <span class="c">! Daylighting shelf simplification:  No beam makes it past end of shelf, all light is diffuse</span>
<a name="ln-8121"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InShelfSurf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Inside daylighting shelf</span>
<a name="ln-8122"></a>          <span class="n">FLFWSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span><span class="c">! Diffuse light only</span>
<a name="ln-8123"></a>
<a name="ln-8124"></a>          <span class="c">! SurfaceWindow(IWin)%FractionUpgoing is already set to 1.0 earlier</span>
<a name="ln-8125"></a>          <span class="c">!WLUMSU(1,IHR) = WLUMSU(1,IHR) + ZSU1 * TVISBSun / PI</span>
<a name="ln-8126"></a>          <span class="c">!FLFWSU(1) = FLFWSU(1) + ZSU1 * TVISBSun * (1.0 - SurfaceWindow(IWin)%FractionUpgoing)</span>
<a name="ln-8127"></a>          <span class="n">FLCWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLCWSU</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU1</span> <span class="o">*</span> <span class="n">TVISBSun</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span>
<a name="ln-8128"></a>        <span class="k">ELSE</span> <span class="c">! Normal window</span>
<a name="ln-8129"></a>          <span class="n">FLFWSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZSU1</span> <span class="o">*</span> <span class="n">TVISBSun</span>
<a name="ln-8130"></a>        <span class="k">END If</span>
<a name="ln-8131"></a><span class="k">      END IF</span>
<a name="ln-8132"></a>
<a name="ln-8133"></a>      <span class="c">! -- Window with shade, screen, blind or diffusing glass</span>
<a name="ln-8134"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">BlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ScreenOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8135"></a><span class="k">        </span><span class="n">TransBmBmMult</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8136"></a>        <span class="n">TransMult</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8137"></a>
<a name="ln-8138"></a>        <span class="c">! TH 7/7/2010 moved from inside the loop: DO JB = 1,MaxSlatAngs</span>
<a name="ln-8139"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BlindOn</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ProfileAngle</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span><span class="n">SUNCOSHR</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">IHR</span><span class="p">),</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatOrientation</span><span class="p">,</span><span class="n">ProfAng</span><span class="p">)</span>
<a name="ln-8140"></a>
<a name="ln-8141"></a>        <span class="k">DO </span><span class="n">JB</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">MaxSlatAngs</span>
<a name="ln-8142"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">JB</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-8143"></a>
<a name="ln-8144"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ScreenOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Shade or screen on or diffusing glass</span>
<a name="ln-8145"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8146"></a>              <span class="c">! Shaded visible transmittance of TDD for collimated beam from the sun</span>
<a name="ln-8147"></a>              <span class="n">TransMult</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TransTDD</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span> <span class="n">COSBSun</span><span class="p">,</span> <span class="n">VisibleBeam</span><span class="p">)</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-8148"></a>            <span class="k">ELSE</span>
<a name="ln-8149"></a><span class="k">              IF</span><span class="p">(</span><span class="n">ScreenOn</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8150"></a><span class="k">                </span><span class="n">TransMult</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ScreenNumber</span><span class="p">)%</span><span class="n">BmBmTransVis</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-8151"></a>                                <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-8152"></a>              <span class="k">ELSE</span>
<a name="ln-8153"></a><span class="k">                </span><span class="n">TransMult</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">COSBSun</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConstShaded</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-8154"></a>                                <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-8155"></a>              <span class="k">END IF</span>
<a name="ln-8156"></a><span class="k">            END IF</span>
<a name="ln-8157"></a>
<a name="ln-8158"></a><span class="k">          ELSE</span> <span class="c">! Blind on</span>
<a name="ln-8159"></a>
<a name="ln-8160"></a>            <span class="c">! PETER:  As long as only interior blinds are allowed for TDDs, no need to change TransMult calculation</span>
<a name="ln-8161"></a>            <span class="c">!         for TDDs because it is based on TVISBSun which is correctly calculated for TDDs above.</span>
<a name="ln-8162"></a>
<a name="ln-8163"></a>            <span class="c">! TH 7/7/2010: This call is moved outside the loop - DO JB = 1,MaxSlatAngs</span>
<a name="ln-8164"></a>            <span class="c">!CALL ProfileAngle(IWin,SUNCOSHR(1:3,IHR),Blind(BlNum)%SlatOrientation,ProfAng)</span>
<a name="ln-8165"></a>
<a name="ln-8166"></a>            <span class="n">TransBlBmDiffFront</span> <span class="o">=</span> <span class="n">InterpProfAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontBeamDiffTrans</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">37</span><span class="p">,</span><span class="n">JB</span><span class="p">))</span>
<a name="ln-8167"></a>
<a name="ln-8168"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_InteriorBlind</span><span class="p">)</span> <span class="k">THEN</span>         <span class="c">! Interior blind</span>
<a name="ln-8169"></a>              <span class="c">! TH CR 8121, 7/7/2010</span>
<a name="ln-8170"></a>              <span class="c">!ReflBlBmDiffFront = InterpProfAng(ProfAng,Blind(BlNum)%VisFrontBeamDiffRefl)</span>
<a name="ln-8171"></a>              <span class="n">ReflBlBmDiffFront</span> <span class="o">=</span> <span class="n">InterpProfAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontBeamDiffRefl</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">37</span><span class="p">,</span><span class="n">JB</span><span class="p">))</span>
<a name="ln-8172"></a>
<a name="ln-8173"></a>              <span class="c">! TH added 7/12/2010 for CR 8121</span>
<a name="ln-8174"></a>              <span class="n">ReflBlDiffDiffFront</span> <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontDiffDiffRefl</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-8175"></a>              <span class="n">TransBlDiffDiffFront</span> <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontDiffDiffTrans</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-8176"></a>
<a name="ln-8177"></a>              <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">=</span> <span class="n">TVISBSun</span> <span class="o">*</span> <span class="p">(</span><span class="n">TransBlBmDiffFront</span> <span class="o">+</span> <span class="n">ReflBlBmDiffFront</span><span class="o">*</span><span class="n">ReflGlDiffDiffBack</span><span class="o">*</span><span class="n">TransBlDiffDiffFront</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-8178"></a>                                <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">ReflBlDiffDiffFront</span><span class="o">*</span><span class="n">ReflGlDiffDiffBack</span><span class="p">))</span>
<a name="ln-8179"></a>
<a name="ln-8180"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorBlind</span><span class="p">)</span> <span class="k">THEN</span>    <span class="c">! Exterior blind</span>
<a name="ln-8181"></a>              <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">=</span> <span class="n">TransBlBmDiffFront</span> <span class="o">*</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransDiffVis</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-8182"></a>                                <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">ReflGlDiffDiffFront</span><span class="o">*</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisBackDiffDiffRefl</span><span class="p">(</span><span class="n">JB</span><span class="p">)))</span> <span class="p">&amp;</span>
<a name="ln-8183"></a>                                <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-8184"></a>
<a name="ln-8185"></a>            <span class="k">ELSE</span>                                             <span class="c">! Between-glass blind</span>
<a name="ln-8186"></a>              <span class="n">t1</span>     <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">COSBSun</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">tBareVisCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-8187"></a>              <span class="n">tfshBd</span> <span class="o">=</span> <span class="n">InterpProfAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontBeamDiffTrans</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">37</span><span class="p">,</span><span class="n">JB</span><span class="p">))</span>
<a name="ln-8188"></a>              <span class="n">rfshB</span>  <span class="o">=</span> <span class="n">InterpProfAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontBeamDiffRefl</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">37</span><span class="p">,</span><span class="n">JB</span><span class="p">))</span>
<a name="ln-8189"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TotGlassLayers</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">! 2 glass layers</span>
<a name="ln-8190"></a>                <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">=</span> <span class="n">t1</span><span class="o">*</span><span class="p">(</span><span class="n">tfshBd</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">+</span> <span class="n">rfd2</span><span class="o">*</span><span class="n">rbshd</span><span class="p">)</span> <span class="o">+</span> <span class="n">rfshB</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">tfshd</span><span class="p">)</span><span class="o">*</span><span class="n">td2</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-8191"></a>              <span class="k">ELSE</span>                                             <span class="c">! 3 glass layers; blind between layers 2 and 3</span>
<a name="ln-8192"></a>                <span class="n">t2</span>            <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">COSBSun</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">tBareVisCoef</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-8193"></a>                <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">=</span> <span class="n">t1</span><span class="o">*</span><span class="n">t2</span><span class="o">*</span><span class="p">(</span><span class="n">tfshBd</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">+</span> <span class="n">rfd3</span><span class="o">*</span><span class="n">rbshd</span><span class="p">)</span> <span class="o">+</span> <span class="n">rfshB</span><span class="o">*</span><span class="p">(</span><span class="n">rbd2</span><span class="o">*</span><span class="n">tfshd</span> <span class="o">+</span> <span class="n">td2</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">td2</span><span class="o">*</span><span class="n">tfshd</span><span class="p">))</span><span class="o">*</span><span class="n">td3</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-8194"></a>                                         <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-8195"></a>              <span class="k">END IF</span>
<a name="ln-8196"></a><span class="k">            END IF</span>
<a name="ln-8197"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8198"></a><span class="k">              </span><span class="n">SlatAng</span> <span class="o">=</span> <span class="p">(</span><span class="n">JB</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">PI</span><span class="o">/</span><span class="p">(</span><span class="n">MaxSlatAngs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-8199"></a>            <span class="k">ELSE</span>
<a name="ln-8200"></a><span class="k">              </span><span class="n">SlatAng</span> <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatAngle</span> <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-8201"></a>            <span class="k">END IF</span>
<a name="ln-8202"></a><span class="k">            </span><span class="n">TransBmBmMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">=</span> <span class="n">TVISBSun</span> <span class="o">*</span> <span class="n">BlindBeamBeamTrans</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8203"></a>                                  <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatThickness</span><span class="p">)</span>
<a name="ln-8204"></a>          <span class="k">END IF</span> <span class="c">! ShadeOn/ScreenOn/BlindOn/Diffusing glass</span>
<a name="ln-8205"></a>
<a name="ln-8206"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8207"></a><span class="k">            </span><span class="n">TransBmBmMult</span> <span class="o">=</span> <span class="mf">0.0d0</span><span class="c">! No beam, diffuse only</span>
<a name="ln-8208"></a>          <span class="k">END IF</span>
<a name="ln-8209"></a>
<a name="ln-8210"></a>          <span class="c">! Daylighting shelf simplification:  No beam makes it past end of shelf, all light is diffuse</span>
<a name="ln-8211"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">InShelfSurf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Inside daylighting shelf</span>
<a name="ln-8212"></a>            <span class="n">TransBmBmMult</span> <span class="o">=</span> <span class="mf">0.0d0</span><span class="c">! No beam, diffuse only (Not sure if this really works)</span>
<a name="ln-8213"></a>            <span class="c">! SurfaceWindow(IWin)%FractionUpgoing is already set to 1.0 earlier</span>
<a name="ln-8214"></a>          <span class="k">END IF</span>
<a name="ln-8215"></a>
<a name="ln-8216"></a><span class="k">          </span><span class="n">WLUMSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">WLUMSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU1</span> <span class="o">*</span> <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">/</span> <span class="n">PI</span>
<a name="ln-8217"></a>          <span class="n">WLUMSUdisk</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZSU1</span> <span class="o">*</span> <span class="n">TransBmBmMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">/</span> <span class="n">PI</span>
<a name="ln-8218"></a>          <span class="n">FLFWSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLFWSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU1</span> <span class="o">*</span> <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span><span class="p">)</span>
<a name="ln-8219"></a>          <span class="n">FLFWSUdisk</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZSU1</span> <span class="o">*</span> <span class="n">TransBmBmMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-8220"></a>          <span class="n">FLCWSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLCWSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU1</span> <span class="o">*</span> <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span>
<a name="ln-8221"></a>        <span class="k">END DO</span> <span class="c">! End of loop over slat angles</span>
<a name="ln-8222"></a>      <span class="k">END IF</span> <span class="c">! End of window with shade or blind</span>
<a name="ln-8223"></a>    <span class="k">END IF</span> <span class="c">! COSBSun &gt; 0</span>
<a name="ln-8224"></a>  <span class="k">END IF</span> <span class="c">! SunLitFracHR &gt; 0</span>
<a name="ln-8225"></a>
<a name="ln-8226"></a>  <span class="c">! Beam reaching window after specular reflection from exterior obstruction</span>
<a name="ln-8227"></a>
<a name="ln-8228"></a>  <span class="c">! In the following, Beam normal illuminance times ZSU1refl = illuminance on window due to</span>
<a name="ln-8229"></a>  <span class="c">! specular reflection from exterior surfaces</span>
<a name="ln-8230"></a>
<a name="ln-8231"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">CalcSolRefl</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">/=</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8232"></a><span class="k">    </span><span class="n">ZSU1refl</span> <span class="o">=</span> <span class="n">ReflFacBmToBmSolObs</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span><span class="n">IHr</span><span class="p">)</span>
<a name="ln-8233"></a>
<a name="ln-8234"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ZSU1refl</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8235"></a>      <span class="c">! Contribution to window luminance and downgoing flux</span>
<a name="ln-8236"></a>
<a name="ln-8237"></a>      <span class="c">! -- Bare window. We use diffuse-diffuse transmittance here rather than beam-beam to avoid</span>
<a name="ln-8238"></a>      <span class="c">!    complications due to specular reflection from multiple exterior surfaces</span>
<a name="ln-8239"></a>
<a name="ln-8240"></a>      <span class="n">TVisSunRefl</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransDiffVis</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-8241"></a>      <span class="c">! In the following it is assumed that all reflected beam is going downward, as it would be in the</span>
<a name="ln-8242"></a>      <span class="c">! important case of reflection from a highly glazed facade of a neighboring building. However, in</span>
<a name="ln-8243"></a>      <span class="c">! rare cases (such as upward specular reflection from a flat horizontal skylight) it may</span>
<a name="ln-8244"></a>      <span class="c">! actually be going upward.</span>
<a name="ln-8245"></a>      <span class="n">FLFWSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLFWSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU1refl</span> <span class="o">*</span> <span class="n">TVisSunRefl</span>
<a name="ln-8246"></a>
<a name="ln-8247"></a>      <span class="c">! -- Window with shade, blind or diffusing glass</span>
<a name="ln-8248"></a>
<a name="ln-8249"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">BlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ScreenOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8250"></a><span class="k">        </span><span class="n">TransBmBmMult</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8251"></a>        <span class="n">TransMult</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8252"></a>
<a name="ln-8253"></a>        <span class="k">DO </span><span class="n">JB</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MaxSlatAngs</span>
<a name="ln-8254"></a>          <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">JB</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-8255"></a>
<a name="ln-8256"></a><span class="k">          IF</span><span class="p">(</span><span class="n">ShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Shade on or diffusing glass</span>
<a name="ln-8257"></a>            <span class="n">TransMult</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConstShaded</span><span class="p">)%</span><span class="n">TransDiffVis</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-8258"></a>                              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-8259"></a>
<a name="ln-8260"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">ScreenOn</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Exterior screen on</span>
<a name="ln-8261"></a>            <span class="n">TransScDiffDiffFront</span> <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ScreenNumber</span><span class="p">)%</span><span class="n">DifDifTransVis</span>
<a name="ln-8262"></a>            <span class="n">TransMult</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TransScDiffDiffFront</span> <span class="o">*</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransDiffVis</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-8263"></a>                                 <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">ReflGlDiffDiffFront</span><span class="o">*</span><span class="n">ReflScDiffDiffBack</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-8264"></a>                                 <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-8265"></a>
<a name="ln-8266"></a>          <span class="k">ELSE</span>             <span class="c">! Blind on</span>
<a name="ln-8267"></a>            <span class="n">TransBlDiffDiffFront</span> <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontDiffDiffTrans</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-8268"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_InteriorBlind</span><span class="p">)</span> <span class="k">THEN</span>         <span class="c">! Interior blind</span>
<a name="ln-8269"></a>                <span class="n">ReflBlDiffDiffFront</span> <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontDiffDiffRefl</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-8270"></a>                <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">=</span> <span class="n">TVISSunRefl</span> <span class="o">*</span> <span class="p">(</span><span class="n">TransBlDiffDiffFront</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-8271"></a>                                  <span class="n">ReflBlDiffDiffFront</span><span class="o">*</span><span class="n">ReflGlDiffDiffBack</span><span class="o">*</span><span class="n">TransBlDiffDiffFront</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-8272"></a>                                  <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">ReflBlDiffDiffFront</span><span class="o">*</span><span class="n">ReflGlDiffDiffBack</span><span class="p">))</span>
<a name="ln-8273"></a>
<a name="ln-8274"></a>            <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ShType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorBlind</span><span class="p">)</span> <span class="k">THEN</span>    <span class="c">! Exterior blind</span>
<a name="ln-8275"></a>              <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">=</span> <span class="n">TransBlDiffDiffFront</span> <span class="o">*</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransDiffVis</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-8276"></a>                                 <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">ReflGlDiffDiffFront</span><span class="o">*</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisBackDiffDiffRefl</span><span class="p">(</span><span class="n">JB</span><span class="p">)))</span> <span class="p">&amp;</span>
<a name="ln-8277"></a>                                 <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-8278"></a>
<a name="ln-8279"></a>            <span class="k">ELSE</span>                                            <span class="c">! Between-glass blind</span>
<a name="ln-8280"></a>              <span class="n">t1</span>     <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">tBareVisDiff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8281"></a>              <span class="n">tfshBd</span> <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontDiffDiffTrans</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-8282"></a>              <span class="n">rfshB</span>  <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">VisFrontDiffDiffRefl</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span>
<a name="ln-8283"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TotGlassLayers</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! 2 glass layers</span>
<a name="ln-8284"></a>                <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">=</span> <span class="n">t1</span><span class="o">*</span><span class="p">(</span><span class="n">tfshBd</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">+</span> <span class="n">rfd2</span><span class="o">*</span><span class="n">rbshd</span><span class="p">)</span> <span class="o">+</span> <span class="n">rfshB</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">tfshd</span><span class="p">)</span><span class="o">*</span><span class="n">td2</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-8285"></a>              <span class="k">ELSE</span>                                             <span class="c">! 3 glass layers; blind between layers 2 and 3</span>
<a name="ln-8286"></a>                <span class="n">t2</span>            <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">tBareVisDiff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-8287"></a>                <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">=</span> <span class="n">t1</span><span class="o">*</span><span class="n">t2</span><span class="o">*</span><span class="p">(</span><span class="n">tfshBd</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">+</span> <span class="n">rfd3</span><span class="o">*</span><span class="n">rbshd</span><span class="p">)</span> <span class="o">+</span> <span class="n">rfshB</span><span class="o">*</span><span class="p">(</span><span class="n">rbd2</span><span class="o">*</span><span class="n">tfshd</span> <span class="o">+</span> <span class="n">td2</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">td2</span><span class="o">*</span><span class="n">tfshd</span><span class="p">))</span><span class="o">*</span><span class="n">td3</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-8288"></a>                                    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">LightWellEff</span>
<a name="ln-8289"></a>              <span class="k">END IF</span>
<a name="ln-8290"></a><span class="k">            END IF</span>  <span class="c">! End of check of interior/exterior/between-glass blind</span>
<a name="ln-8291"></a>          <span class="k">END IF</span>    <span class="c">! ShadeOn/BlindOn</span>
<a name="ln-8292"></a>
<a name="ln-8293"></a>          <span class="n">WLUMSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">WLUMSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU1refl</span> <span class="o">*</span> <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">/</span> <span class="n">PI</span>
<a name="ln-8294"></a>          <span class="n">FLFWSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLFWSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU1refl</span> <span class="o">*</span> <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span><span class="p">)</span>
<a name="ln-8295"></a>          <span class="n">FLCWSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLCWSU</span><span class="p">(</span><span class="n">JB</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZSU1refl</span> <span class="o">*</span> <span class="n">TransMult</span><span class="p">(</span><span class="n">JB</span><span class="p">)</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span>
<a name="ln-8296"></a>        <span class="k">END DO</span> <span class="c">! End of loop over slat angles</span>
<a name="ln-8297"></a>      <span class="k">END IF</span> <span class="c">! End of check if window has shade, blind or diffusing glass</span>
<a name="ln-8298"></a>    <span class="k">END IF</span>  <span class="c">! End of check if ZSU1refl &gt; 0.0</span>
<a name="ln-8299"></a>  <span class="k">END IF</span>  <span class="c">! End of check if solar reflections are in effect</span>
<a name="ln-8300"></a>
<a name="ln-8301"></a>  <span class="c">! Sun-related portion of internally reflected illuminance</span>
<a name="ln-8302"></a>
<a name="ln-8303"></a>  <span class="k">DO </span><span class="n">JSH</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">MaxSlatAngs</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-8304"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">JSH</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-8305"></a>
<a name="ln-8306"></a>    <span class="c">! Full area of window is used in following since effect of dividers on reducing</span>
<a name="ln-8307"></a>    <span class="c">! effective window transmittance already accounted for in calc of FLFWSU and FLCWSU</span>
<a name="ln-8308"></a>    <span class="c">! CR 7869 added effect of intervening interior windows on transmittance and</span>
<a name="ln-8309"></a>    <span class="c">! added inside surface area of adjacent zone</span>
<a name="ln-8310"></a>    <span class="n">EINTSU</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">FLFWSU</span><span class="p">(</span><span class="n">JSH</span><span class="p">)</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">RhoFloorWall</span> <span class="p">&amp;</span>
<a name="ln-8311"></a>                      <span class="o">+</span> <span class="n">FLCWSU</span><span class="p">(</span><span class="n">JSH</span><span class="p">)</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">RhoCeilingWall</span><span class="p">)</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-8312"></a>                      <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Area</span><span class="o">/</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-8313"></a>                      <span class="p">(</span><span class="n">ZoneInsideSurfArea</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span><span class="p">))</span>
<a name="ln-8314"></a>
<a name="ln-8315"></a>    <span class="n">EINTSUdisk</span><span class="p">(</span><span class="n">JSH</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLFWSUdisk</span><span class="p">(</span><span class="n">JSH</span><span class="p">)</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">RhoFloorWall</span>  <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-8316"></a>                      <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Area</span><span class="o">/</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-8317"></a>                      <span class="p">(</span><span class="n">ZoneInsideSurfArea</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span><span class="p">))</span>
<a name="ln-8318"></a>  <span class="k">END DO</span>
<a name="ln-8319"></a>
<a name="ln-8320"></a><span class="k">  RETURN</span>
<a name="ln-8321"></a>
<a name="ln-8322"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgInterReflectedIllum</span>
<a name="ln-8323"></a>
<a name="ln-8324"></a><span class="k">SUBROUTINE </span><span class="n">ComplexFenestrationLuminances</span><span class="p">(</span><span class="n">IWIN</span><span class="p">,</span> <span class="n">WinEl</span><span class="p">,</span> <span class="n">NBasis</span><span class="p">,</span> <span class="n">IHR</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">,</span> <span class="n">ElementLuminanceSky</span><span class="p">,</span> <span class="n">ElementLuminanceSun</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8325"></a>            <span class="n">ElementLuminanceSunDisk</span><span class="p">,</span> <span class="n">CalledFrom</span><span class="p">,</span> <span class="n">MapNum</span><span class="p">)</span>
<a name="ln-8326"></a>
<a name="ln-8327"></a>  <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8328"></a>  <span class="c">!       AUTHOR         Simon Vidanovic</span>
<a name="ln-8329"></a>  <span class="c">!       DATE WRITTEN   June 2013</span>
<a name="ln-8330"></a>  <span class="c">!       MODIFIED       na</span>
<a name="ln-8331"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8332"></a>
<a name="ln-8333"></a>  <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8334"></a>  <span class="c">!</span>
<a name="ln-8335"></a>
<a name="ln-8336"></a>  <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-8337"></a>
<a name="ln-8338"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-8339"></a>  <span class="c">!</span>
<a name="ln-8340"></a>
<a name="ln-8341"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-8342"></a>
<a name="ln-8343"></a>  <span class="k">implicit none</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8344"></a>
<a name="ln-8345"></a>  <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8346"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IWIN</span>
<a name="ln-8347"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WinEl</span>
<a name="ln-8348"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NBasis</span>
<a name="ln-8349"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IHR</span>
<a name="ln-8350"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iRefPoint</span>
<a name="ln-8351"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">NBasis</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElementLuminanceSky</span>     <span class="c">! sky related luminance at window element (exterior side)</span>
<a name="ln-8352"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">NBasis</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElementLuminanceSun</span>     <span class="c">! sun related luminance at window element (exterior side),</span>
<a name="ln-8353"></a>                                                                       <span class="c">! exluding beam</span>
<a name="ln-8354"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">NBasis</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElementLuminanceSunDisk</span> <span class="c">! sun related luminance at window element (exterior side),</span>
<a name="ln-8355"></a>                                                                    <span class="c">! due to sun beam</span>
<a name="ln-8356"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CalledFrom</span>
<a name="ln-8357"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">MapNum</span>
<a name="ln-8358"></a>
<a name="ln-8359"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iIncElem</span>
<a name="ln-8360"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iSky</span>
<a name="ln-8361"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">SolBmIndex</span>
<a name="ln-8362"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LambdaInc</span>
<a name="ln-8363"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Altitude</span>
<a name="ln-8364"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Azimuth</span>
<a name="ln-8365"></a><span class="c">!  real(r64) :: CurCplxFenState</span>
<a name="ln-8366"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">CurCplxFenState</span>
<a name="ln-8367"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SunObstrMultiplier</span>  <span class="c">! sun obstruction multiplier used to determine if sun hit the ground point</span>
<a name="ln-8368"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObstrTrans</span>  <span class="c">! product of all surface transmittances intersecting incoming beam</span>
<a name="ln-8369"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">COSIncSun</span>  <span class="c">! cosine of the Sun incidence angle</span>
<a name="ln-8370"></a>
<a name="ln-8371"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BeamObstrMultiplier</span>  <span class="c">! beam obstruction multiplier in case incoming beam is from the ground</span>
<a name="ln-8372"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">ObsSurfNum</span>           <span class="c">! Obstruction surface number</span>
<a name="ln-8373"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">iHitObs</span>              <span class="c">! = 1 if obstruction is hit, = 0 otherwise</span>
<a name="ln-8374"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObsHitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>          <span class="c">! Coordinates of hit point on an obstruction (m)</span>
<a name="ln-8375"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>       <span class="c">! Coordinates of point that ray from window center hits the ground (m)</span>
<a name="ln-8376"></a>
<a name="ln-8377"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">NRefl</span>          <span class="c">! number of exterior obstructions</span>
<a name="ln-8378"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">iReflElem</span>      <span class="c">! incoming direction blocking surfaces element counter</span>
<a name="ln-8379"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">iReflElemIndex</span> <span class="c">! reflection element index</span>
<a name="ln-8380"></a>
<a name="ln-8381"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">NGnd</span>          <span class="c">! number of ground elements</span>
<a name="ln-8382"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">iGndElem</span>      <span class="c">! ground elements counter</span>
<a name="ln-8383"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">iGndElemIndex</span> <span class="c">! ground element index</span>
<a name="ln-8384"></a>
<a name="ln-8385"></a>  <span class="n">CurCplxFenState</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span>
<a name="ln-8386"></a>
<a name="ln-8387"></a>  <span class="c">! Calculate luminance from sky and sun excluding exterior obstruction transmittances and obstruction multipliers</span>
<a name="ln-8388"></a>  <span class="n">SolBmIndex</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">SolBmIndex</span><span class="p">(</span><span class="n">IHR</span><span class="p">,</span> <span class="n">timestep</span><span class="p">)</span>
<a name="ln-8389"></a>  <span class="k">do </span><span class="n">iIncElem</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NBasis</span>
<a name="ln-8390"></a>    <span class="n">LambdaInc</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">Inc</span><span class="p">%</span><span class="n">Lamda</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">)</span>
<a name="ln-8391"></a>    <span class="c">!COSB = ComplexWind(IWin)%Geom(CurCplxFenState)%CosInc(iIncElem)</span>
<a name="ln-8392"></a>    <span class="c">!DA = ComplexWind(IWin)%Geom(CurCplxFenState)%DAInc(iIncElem)</span>
<a name="ln-8393"></a>    <span class="n">Altitude</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">pInc</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">)%</span><span class="n">Altitude</span>
<a name="ln-8394"></a>    <span class="n">Azimuth</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">pInc</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">)%</span><span class="n">Azimuth</span>
<a name="ln-8395"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">Altitude</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8396"></a>      <span class="c">! Ray from sky element</span>
<a name="ln-8397"></a>      <span class="k">do </span><span class="n">iSky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-8398"></a>        <span class="n">ElementLuminanceSky</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">,</span> <span class="n">iSky</span><span class="p">)</span> <span class="o">=</span> <span class="n">DayltgSkyLuminance</span><span class="p">(</span><span class="n">iSky</span><span class="p">,</span> <span class="n">Azimuth</span><span class="p">,</span> <span class="n">Altitude</span><span class="p">)</span> <span class="o">*</span> <span class="n">LambdaInc</span>
<a name="ln-8399"></a>      <span class="k">end do</span>
<a name="ln-8400"></a><span class="k">    else if</span> <span class="p">(</span><span class="n">Altitude</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8401"></a>      <span class="c">! Ray from ground element</span>
<a name="ln-8402"></a>      <span class="c">! BeamObstrMultiplier = ComplexWind(IWin)%DaylghtGeom(CurCplxFenState)%GndObstrMultiplier(WinEl, iIncElem)</span>
<a name="ln-8403"></a>      <span class="k">do </span><span class="n">iSky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-8404"></a>        <span class="n">ElementLuminanceSky</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">,</span> <span class="n">iSky</span><span class="p">)</span> <span class="o">=</span> <span class="n">GILSK</span><span class="p">(</span><span class="n">iSky</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">*</span> <span class="n">GndReflectanceForDayltg</span> <span class="o">/</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">LambdaInc</span>
<a name="ln-8405"></a>      <span class="k">end do</span>
<a name="ln-8406"></a><span class="k">      </span><span class="n">ElementLuminanceSun</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">)</span> <span class="o">=</span> <span class="n">GILSU</span><span class="p">(</span><span class="n">IHR</span><span class="p">)</span> <span class="o">*</span> <span class="n">GndReflectanceForDayltg</span> <span class="o">/</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">LambdaInc</span>
<a name="ln-8407"></a>    <span class="k">else</span>
<a name="ln-8408"></a>      <span class="c">! Ray from the element which is half sky and half ground</span>
<a name="ln-8409"></a>      <span class="k">do </span><span class="n">iSky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-8410"></a>        <span class="c">! in this case half of the pach is coming from the sky and half from the ground</span>
<a name="ln-8411"></a>        <span class="n">ElementLuminanceSky</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">,</span> <span class="n">iSky</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">DayltgSkyLuminance</span><span class="p">(</span><span class="n">iSky</span><span class="p">,</span> <span class="n">Azimuth</span><span class="p">,</span> <span class="n">Altitude</span><span class="p">)</span> <span class="o">*</span> <span class="n">LambdaInc</span>
<a name="ln-8412"></a>        <span class="n">ElementLuminanceSky</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">,</span> <span class="n">iSky</span><span class="p">)</span> <span class="o">=</span> <span class="n">ElementLuminanceSky</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">,</span> <span class="n">iSky</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8413"></a>            <span class="mf">0.5</span> <span class="o">*</span> <span class="n">GILSK</span><span class="p">(</span><span class="n">iSky</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">*</span> <span class="n">GndReflectanceForDayltg</span> <span class="o">/</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">LambdaInc</span>
<a name="ln-8414"></a>      <span class="k">end do</span>
<a name="ln-8415"></a><span class="k">      </span><span class="n">ElementLuminanceSun</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">GILSU</span><span class="p">(</span><span class="n">IHR</span><span class="p">)</span> <span class="o">*</span> <span class="n">GndReflectanceForDayltg</span> <span class="o">/</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">LambdaInc</span>
<a name="ln-8416"></a>    <span class="k">end if</span>
<a name="ln-8417"></a>    <span class="c">! Sun beam calculations</span>
<a name="ln-8418"></a>    <span class="k">if</span> <span class="p">((</span><span class="n">SolBmIndex</span> <span class="o">==</span> <span class="n">iIncElem</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">SunLitFracHR</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-8419"></a><span class="k">      </span><span class="n">ElementLuminanceSunDisk</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8420"></a>    <span class="k">end if</span>
<a name="ln-8421"></a><span class="k">  end do</span>
<a name="ln-8422"></a>
<a name="ln-8423"></a>  <span class="c">! add exterior obstructions transmittances to calculated luminances</span>
<a name="ln-8424"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8425"></a><span class="k">    </span><span class="n">NRefl</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)%</span><span class="n">NReflSurf</span><span class="p">(</span><span class="n">WinEl</span><span class="p">)</span>
<a name="ln-8426"></a>  <span class="k">else</span>
<a name="ln-8427"></a><span class="k">    </span><span class="n">NRefl</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)%</span><span class="n">NReflSurf</span><span class="p">(</span><span class="n">WinEl</span><span class="p">)</span>
<a name="ln-8428"></a>  <span class="k">end if</span>
<a name="ln-8429"></a><span class="k">  do </span><span class="n">iReflElem</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NRefl</span>
<a name="ln-8430"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8431"></a><span class="k">      </span><span class="n">ObstrTrans</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)%</span><span class="n">TransOutSurf</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">iReflElem</span><span class="p">)</span>
<a name="ln-8432"></a>      <span class="n">iReflElemIndex</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)%</span><span class="n">RefSurfIndex</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">iReflElem</span><span class="p">)</span>
<a name="ln-8433"></a>    <span class="k">else</span>
<a name="ln-8434"></a><span class="k">      </span><span class="n">ObstrTrans</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)%</span><span class="n">TransOutSurf</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">iReflElem</span><span class="p">)</span>
<a name="ln-8435"></a>      <span class="n">iReflElemIndex</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-8436"></a>        <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)%</span><span class="n">RefSurfIndex</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">iReflElem</span><span class="p">)</span>
<a name="ln-8437"></a>    <span class="k">end if</span>
<a name="ln-8438"></a>
<a name="ln-8439"></a><span class="k">    do </span><span class="n">iSky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-8440"></a>      <span class="n">ElementLuminanceSky</span><span class="p">(</span><span class="n">iReflElemIndex</span><span class="p">,</span> <span class="n">iSky</span><span class="p">)</span> <span class="o">=</span> <span class="n">ElementLuminanceSky</span><span class="p">(</span><span class="n">iReflElemIndex</span><span class="p">,</span> <span class="n">iSky</span><span class="p">)</span> <span class="o">*</span> <span class="n">ObstrTrans</span>
<a name="ln-8441"></a>    <span class="k">end do</span>
<a name="ln-8442"></a><span class="k">    </span><span class="n">ElementLuminanceSun</span><span class="p">(</span><span class="n">iReflElemIndex</span><span class="p">)</span> <span class="o">=</span> <span class="n">ElementLuminanceSun</span><span class="p">(</span><span class="n">iReflElemIndex</span><span class="p">)</span> <span class="o">*</span> <span class="n">ObstrTrans</span>
<a name="ln-8443"></a>    <span class="n">ElementLuminanceSunDisk</span><span class="p">(</span><span class="n">iReflElemIndex</span><span class="p">)</span> <span class="o">=</span> <span class="n">ElementLuminanceSunDisk</span><span class="p">(</span><span class="n">iReflElemIndex</span><span class="p">)</span> <span class="o">*</span> <span class="n">ObstrTrans</span>
<a name="ln-8444"></a>  <span class="k">end do</span>
<a name="ln-8445"></a>
<a name="ln-8446"></a>  <span class="c">! add exterior ground element obstruction multipliers to calculated luminances. For sun reflection, calculate if</span>
<a name="ln-8447"></a>  <span class="c">! sun reaches the ground for that point</span>
<a name="ln-8448"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8449"></a><span class="k">    </span><span class="n">NGnd</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)%</span><span class="n">NGnd</span><span class="p">(</span><span class="n">WinEl</span><span class="p">)</span>
<a name="ln-8450"></a>  <span class="k">else</span>
<a name="ln-8451"></a><span class="k">    </span><span class="n">NGnd</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)%</span><span class="n">NGnd</span><span class="p">(</span><span class="n">WinEl</span><span class="p">)</span>
<a name="ln-8452"></a>  <span class="k">end if</span>
<a name="ln-8453"></a><span class="k">  do </span><span class="n">iGndElem</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NGnd</span>
<a name="ln-8454"></a>    <span class="c">! case for sky elements. Integration is done over upper ground hemisphere to determine how many obstructions</span>
<a name="ln-8455"></a>    <span class="c">! were hit in the process</span>
<a name="ln-8456"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8457"></a><span class="k">      </span><span class="n">BeamObstrMultiplier</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)%</span><span class="n">GndObstrMultiplier</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">iGndElem</span><span class="p">)</span>
<a name="ln-8458"></a>      <span class="n">iGndElemIndex</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)%</span><span class="n">GndIndex</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">iGndElem</span><span class="p">)</span>
<a name="ln-8459"></a>    <span class="k">else</span>
<a name="ln-8460"></a><span class="k">      </span><span class="n">BeamObstrMultiplier</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-8461"></a>        <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)%</span><span class="n">GndObstrMultiplier</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">iGndElem</span><span class="p">)</span>
<a name="ln-8462"></a>      <span class="n">iGndElemIndex</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)%</span><span class="n">GndIndex</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">iGndElem</span><span class="p">)</span>
<a name="ln-8463"></a>    <span class="k">end if</span>
<a name="ln-8464"></a><span class="k">    do </span><span class="n">iSky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-8465"></a>      <span class="n">ElementLuminanceSky</span><span class="p">(</span><span class="n">iGndElemIndex</span><span class="p">,</span> <span class="n">iSky</span><span class="p">)</span> <span class="o">=</span> <span class="n">ElementLuminanceSky</span><span class="p">(</span><span class="n">iGndElemIndex</span><span class="p">,</span> <span class="n">iSky</span><span class="p">)</span> <span class="o">*</span> <span class="n">BeamObstrMultiplier</span>
<a name="ln-8466"></a>    <span class="k">end do</span>
<a name="ln-8467"></a>
<a name="ln-8468"></a>    <span class="c">! direct sun disk reflect off the ground</span>
<a name="ln-8469"></a>    <span class="n">SunObstrMultiplier</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8470"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">CalcSolRefl</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8471"></a>      <span class="c">! Sun reaches ground point if vector from this point to the sun is unobstructed</span>
<a name="ln-8472"></a>      <span class="n">iHitObs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-8473"></a>      <span class="k">do </span><span class="n">ObsSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-8474"></a>        <span class="k">if</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfPossibleObstruction</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-8475"></a><span class="k">        if</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8476"></a><span class="k">          </span><span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)%</span><span class="n">GndPt</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">iGndElem</span><span class="p">)%</span><span class="n">x</span>
<a name="ln-8477"></a>          <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)%</span><span class="n">GndPt</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">iGndElem</span><span class="p">)%</span><span class="n">y</span>
<a name="ln-8478"></a>          <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)%</span><span class="n">GndPt</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">iGndElem</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-8479"></a>        <span class="k">else</span>
<a name="ln-8480"></a><span class="k">          </span><span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)%</span><span class="n">GndPt</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">iGndElem</span><span class="p">)%</span><span class="n">x</span>
<a name="ln-8481"></a>          <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)%</span><span class="n">GndPt</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">iGndElem</span><span class="p">)%</span><span class="n">y</span>
<a name="ln-8482"></a>          <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)%</span><span class="n">GndPt</span><span class="p">(</span><span class="n">WinEl</span><span class="p">,</span> <span class="n">iGndElem</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-8483"></a>        <span class="k">end if</span>
<a name="ln-8484"></a>
<a name="ln-8485"></a><span class="k">        call </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">,</span><span class="n">GroundHitPt</span><span class="p">,</span><span class="n">SunCosHr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">IHr</span><span class="p">),</span><span class="n">iHitObs</span><span class="p">,</span><span class="n">ObsHitPt</span><span class="p">)</span>
<a name="ln-8486"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">iHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-8487"></a><span class="k">      end do</span>
<a name="ln-8488"></a><span class="k">      if</span> <span class="p">(</span><span class="n">iHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SunObstrMultiplier</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8489"></a>    <span class="k">end if</span>
<a name="ln-8490"></a><span class="k">    </span><span class="n">ElementLuminanceSun</span><span class="p">(</span><span class="n">iGndElemIndex</span><span class="p">)</span> <span class="o">=</span> <span class="n">ElementLuminanceSun</span><span class="p">(</span><span class="n">iGndElemIndex</span><span class="p">)</span> <span class="o">*</span> <span class="n">SunObstrMultiplier</span>
<a name="ln-8491"></a>  <span class="k">end do</span>
<a name="ln-8492"></a>
<a name="ln-8493"></a><span class="k">  RETURN</span>
<a name="ln-8494"></a>
<a name="ln-8495"></a><span class="k">END SUBROUTINE </span><span class="n">ComplexFenestrationLuminances</span>
<a name="ln-8496"></a>
<a name="ln-8497"></a><span class="k">SUBROUTINE </span><span class="n">DayltgInterReflectedIllumComplexFenestration</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span> <span class="n">WinEl</span><span class="p">,</span> <span class="n">IHR</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">,</span> <span class="n">CalledFrom</span><span class="p">,</span> <span class="n">MapNum</span><span class="p">)</span>
<a name="ln-8498"></a>
<a name="ln-8499"></a>  <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8500"></a>  <span class="c">!       AUTHOR         Simon Vidanovic</span>
<a name="ln-8501"></a>  <span class="c">!       DATE WRITTEN   April 2013</span>
<a name="ln-8502"></a>  <span class="c">!       MODIFIED       na</span>
<a name="ln-8503"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8504"></a>
<a name="ln-8505"></a>  <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8506"></a>  <span class="c">! Called from CalcDayltgCoefficients for each complex (bsdf) fenestration and reference point in a daylit</span>
<a name="ln-8507"></a>  <span class="c">! space, for each sun position. Calculates illuminance (EINTSK and EINTSU) at reference point due</span>
<a name="ln-8508"></a>  <span class="c">! to internally reflected light by integrating to determine the amount of flux from</span>
<a name="ln-8509"></a>  <span class="c">! sky and ground (and beam reflected from obstructions) transmitted through</span>
<a name="ln-8510"></a>  <span class="c">! the center of the window and then reflecting this</span>
<a name="ln-8511"></a>  <span class="c">! light from the inside surfaces of the space.</span>
<a name="ln-8512"></a>
<a name="ln-8513"></a>  <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-8514"></a>
<a name="ln-8515"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-8516"></a>  <span class="c">!</span>
<a name="ln-8517"></a>
<a name="ln-8518"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-8519"></a>
<a name="ln-8520"></a>  <span class="k">implicit none</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8521"></a>
<a name="ln-8522"></a>  <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8523"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">IWin</span>                      <span class="c">! Window index</span>
<a name="ln-8524"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">WinEl</span>                     <span class="c">! Current window element counter</span>
<a name="ln-8525"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">IHR</span>                       <span class="c">! Hour of day</span>
<a name="ln-8526"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ZoneNum</span>                   <span class="c">! Zone number</span>
<a name="ln-8527"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iRefPoint</span>                 <span class="c">! reference point counter</span>
<a name="ln-8528"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CalledFrom</span>
<a name="ln-8529"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">MapNum</span>
<a name="ln-8530"></a>
<a name="ln-8531"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">FLSK</span>      <span class="c">! Sky related luminous flux</span>
<a name="ln-8532"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">FLSU</span>      <span class="c">! Sun related luminous flux, excluding entering beam</span>
<a name="ln-8533"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">FLSUdisk</span>  <span class="c">! Sun related luminous flux, due to entering beam</span>
<a name="ln-8534"></a>
<a name="ln-8535"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">FirstFluxSK</span>      <span class="c">! Sky related first reflected flux</span>
<a name="ln-8536"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">FirstFluxSU</span>      <span class="c">! Sun related first reflected flux, excluding entering beam</span>
<a name="ln-8537"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">FirstFluxSUdisk</span>  <span class="c">! Sun related first reflected flux, due to entering beam</span>
<a name="ln-8538"></a>
<a name="ln-8539"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ElementLuminanceSky</span>     <span class="c">! sky related luminance at window element (exterior side)</span>
<a name="ln-8540"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">ElementLuminanceSun</span>     <span class="c">! sun related luminance at window element (exterior side),</span>
<a name="ln-8541"></a>                                                                    <span class="c">! exluding beam</span>
<a name="ln-8542"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">ElementLuminanceSunDisk</span> <span class="c">! sun related luminance at window element (exterior side),</span>
<a name="ln-8543"></a>                                                                    <span class="c">! due to sun beam</span>
<a name="ln-8544"></a>  <span class="c">! Total transmitted flux</span>
<a name="ln-8545"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FLSKTot</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-8546"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FLSUTot</span>
<a name="ln-8547"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FLSUdiskTot</span>
<a name="ln-8548"></a>
<a name="ln-8549"></a>  <span class="c">! Total for first relflected fluxes</span>
<a name="ln-8550"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FFSKTot</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-8551"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FFSUTot</span>
<a name="ln-8552"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FFSUdiskTot</span>
<a name="ln-8553"></a>
<a name="ln-8554"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">COSIncSun</span> <span class="c">! cosine of sun incidence angle (from basis elements)</span>
<a name="ln-8555"></a>
<a name="ln-8556"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">iSky</span>      <span class="c">! Sky type index: 1=clear, 2=clear turbid, 3=intermediate, 4=overcast</span>
<a name="ln-8557"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">iConst</span>    <span class="c">! Construction number</span>
<a name="ln-8558"></a>
<a name="ln-8559"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">CurCplxFenState</span>
<a name="ln-8560"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">NIncBasis</span>
<a name="ln-8561"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">NTrnBasis</span>
<a name="ln-8562"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">SolBmIndex</span> <span class="c">! index of current sun position</span>
<a name="ln-8563"></a>
<a name="ln-8564"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">iIncElem</span>       <span class="c">! incoming direction counter</span>
<a name="ln-8565"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">iBackElem</span>      <span class="c">! outgoing direction counter</span>
<a name="ln-8566"></a>
<a name="ln-8567"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LambdaInc</span>  <span class="c">! current lambda value for incoming direction</span>
<a name="ln-8568"></a>  <span class="c">!real(r64) :: LambdaTrn  ! current lambda value for incoming direction</span>
<a name="ln-8569"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dirTrans</span>   <span class="c">! directional bsdf transmittance</span>
<a name="ln-8570"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneInsideSurfArea</span>
<a name="ln-8571"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TransmittedFlux</span>
<a name="ln-8572"></a>
<a name="ln-8573"></a>  <span class="n">CurCplxFenState</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span>
<a name="ln-8574"></a>  <span class="n">iConst</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">State</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">Konst</span>
<a name="ln-8575"></a>  <span class="n">NTrnBasis</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">Trn</span><span class="p">%</span><span class="n">NBasis</span>
<a name="ln-8576"></a>
<a name="ln-8577"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">FLSK</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">FLSK</span><span class="p">(</span><span class="n">NTrnBasis</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a name="ln-8578"></a>  <span class="n">FLSK</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8579"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">FLSU</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">FLSU</span><span class="p">(</span><span class="n">NTrnBasis</span><span class="p">))</span>
<a name="ln-8580"></a>  <span class="n">FLSU</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8581"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">FLSUdisk</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">FLSUdisk</span><span class="p">(</span><span class="n">NTrnBasis</span><span class="p">))</span>
<a name="ln-8582"></a>  <span class="n">FLSUdisk</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8583"></a>
<a name="ln-8584"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">FirstFluxSK</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">FirstFluxSK</span><span class="p">(</span><span class="n">NTrnBasis</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a name="ln-8585"></a>  <span class="n">FirstFluxSK</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8586"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">FirstFluxSU</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">FirstFluxSU</span><span class="p">(</span><span class="n">NTrnBasis</span><span class="p">))</span>
<a name="ln-8587"></a>  <span class="n">FirstFluxSU</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8588"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">FirstFluxSUdisk</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">FirstFluxSUdisk</span><span class="p">(</span><span class="n">NTrnBasis</span><span class="p">))</span>
<a name="ln-8589"></a>  <span class="n">FirstFluxSUdisk</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8590"></a>
<a name="ln-8591"></a>  <span class="n">NIncBasis</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">Inc</span><span class="p">%</span><span class="n">NBasis</span>
<a name="ln-8592"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">ElementLuminanceSky</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">ElementLuminanceSky</span><span class="p">(</span><span class="n">NIncBasis</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a name="ln-8593"></a>  <span class="n">ElementLuminanceSky</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8594"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">ElementLuminanceSun</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">ElementLuminanceSun</span><span class="p">(</span><span class="n">NIncBasis</span><span class="p">))</span>
<a name="ln-8595"></a>  <span class="n">ElementLuminanceSun</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8596"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">ElementLuminanceSunDisk</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">ElementLuminanceSunDisk</span><span class="p">(</span><span class="n">NIncBasis</span><span class="p">))</span>
<a name="ln-8597"></a>  <span class="n">ElementLuminanceSunDisk</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8598"></a>
<a name="ln-8599"></a>  <span class="c">! Integration over sky/ground/sun elements is done over window incoming basis element and flux is calculated for each</span>
<a name="ln-8600"></a>  <span class="c">! outgoing direction. This is used to calculate first reflected flux</span>
<a name="ln-8601"></a>
<a name="ln-8602"></a>  <span class="k">call </span><span class="n">ComplexFenestrationLuminances</span><span class="p">(</span><span class="n">IWIN</span><span class="p">,</span> <span class="n">WinEl</span><span class="p">,</span> <span class="n">NIncBasis</span><span class="p">,</span> <span class="n">IHR</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">,</span> <span class="n">ElementLuminanceSky</span><span class="p">,</span> <span class="n">ElementLuminanceSun</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8603"></a>            <span class="n">ElementLuminanceSunDisk</span><span class="p">,</span> <span class="n">CalledFrom</span><span class="p">,</span> <span class="n">MapNum</span><span class="p">)</span>
<a name="ln-8604"></a>
<a name="ln-8605"></a>  <span class="c">! luminance from sun disk needs to include fraction of sunlit area</span>
<a name="ln-8606"></a>  <span class="n">SolBmIndex</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">SolBmIndex</span><span class="p">(</span><span class="n">IHR</span><span class="p">,</span> <span class="n">timestep</span><span class="p">)</span>
<a name="ln-8607"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">SolBmIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8608"></a><span class="k">    </span><span class="n">COSIncSun</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">CosInc</span><span class="p">(</span><span class="n">SolBmIndex</span><span class="p">)</span>
<a name="ln-8609"></a>  <span class="k">else</span>
<a name="ln-8610"></a><span class="k">    </span><span class="n">COSIncSun</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8611"></a>  <span class="k">end if</span>
<a name="ln-8612"></a><span class="k">  </span><span class="n">ElementLuminanceSunDisk</span> <span class="o">=</span> <span class="n">ElementLuminanceSunDisk</span> <span class="o">*</span> <span class="n">SunLitFracHR</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span> <span class="n">IHR</span><span class="p">)</span> <span class="o">*</span> <span class="n">COSIncSun</span>
<a name="ln-8613"></a>
<a name="ln-8614"></a>  <span class="n">FLSKTot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8615"></a>  <span class="n">FLSUTot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8616"></a>  <span class="n">FLSUdiskTot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8617"></a>  <span class="n">FFSKTot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8618"></a>  <span class="n">FFSUTot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8619"></a>  <span class="n">FFSUdiskTot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8620"></a>  <span class="c">! now calculate flux into each outgoing direction by integrating over all incoming directions</span>
<a name="ln-8621"></a>  <span class="k">do </span><span class="n">iBackElem</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NTrnBasis</span>
<a name="ln-8622"></a>    <span class="k">do </span><span class="n">iIncElem</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NIncBasis</span>
<a name="ln-8623"></a>      <span class="n">LambdaInc</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">Inc</span><span class="p">%</span><span class="n">Lamda</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">)</span>
<a name="ln-8624"></a>      <span class="n">dirTrans</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">iConst</span><span class="p">)%</span><span class="n">BSDFInput</span><span class="p">%</span><span class="n">VisFrtTrans</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">,</span> <span class="n">iBackElem</span><span class="p">)</span>
<a name="ln-8625"></a>
<a name="ln-8626"></a>      <span class="k">do </span><span class="n">iSky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-8627"></a>        <span class="n">FLSK</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">,</span> <span class="n">iSky</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLSK</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">,</span> <span class="n">iSky</span><span class="p">)</span> <span class="o">+</span> <span class="n">dirTrans</span> <span class="o">*</span> <span class="n">LambdaInc</span> <span class="o">*</span> <span class="n">ElementLuminanceSky</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">,</span> <span class="n">iSky</span><span class="p">)</span>
<a name="ln-8628"></a>      <span class="k">end do</span>
<a name="ln-8629"></a>
<a name="ln-8630"></a><span class="k">      </span><span class="n">FLSU</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLSU</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">)</span> <span class="o">+</span> <span class="n">dirTrans</span> <span class="o">*</span> <span class="n">LambdaInc</span> <span class="o">*</span> <span class="n">ElementLuminanceSun</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">)</span>
<a name="ln-8631"></a>      <span class="n">FLSUdisk</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLSUdisk</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">)</span> <span class="o">+</span> <span class="n">dirTrans</span> <span class="o">*</span> <span class="n">LambdaInc</span> <span class="o">*</span> <span class="n">ElementLuminanceSunDisk</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">)</span>
<a name="ln-8632"></a>    <span class="k">end do</span>
<a name="ln-8633"></a>
<a name="ln-8634"></a><span class="k">    do </span><span class="n">iSky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-8635"></a>      <span class="n">FirstFluxSK</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">,</span> <span class="n">iSky</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLSK</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">,</span> <span class="n">iSky</span><span class="p">)</span> <span class="o">*</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">AveRhoVisOverlap</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">)</span>
<a name="ln-8636"></a>      <span class="n">FFSKTot</span><span class="p">(</span><span class="n">iSky</span><span class="p">)</span> <span class="o">=</span> <span class="n">FFSKTot</span><span class="p">(</span><span class="n">iSky</span><span class="p">)</span> <span class="o">+</span> <span class="n">FirstFluxSK</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">,</span> <span class="n">iSky</span><span class="p">)</span>
<a name="ln-8637"></a>      <span class="n">FLSKTot</span><span class="p">(</span><span class="n">iSky</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLSKTot</span><span class="p">(</span><span class="n">iSky</span><span class="p">)</span> <span class="o">+</span> <span class="n">FLSK</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">,</span> <span class="n">iSky</span><span class="p">)</span>
<a name="ln-8638"></a>    <span class="k">end do</span>
<a name="ln-8639"></a><span class="k">    </span><span class="n">FirstFluxSU</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLSU</span><span class="p">(</span><span class="n">IBackElem</span><span class="p">)</span> <span class="o">*</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">AveRhoVisOverlap</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">)</span>
<a name="ln-8640"></a>    <span class="n">FFSUTot</span> <span class="o">=</span> <span class="n">FFSUTot</span> <span class="o">+</span> <span class="n">FirstFluxSU</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">)</span>
<a name="ln-8641"></a>    <span class="n">FLSUTot</span> <span class="o">=</span> <span class="n">FLSUTot</span> <span class="o">+</span> <span class="n">FLSU</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">)</span>
<a name="ln-8642"></a>
<a name="ln-8643"></a>    <span class="n">FirstFluxSUdisk</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">)</span> <span class="o">=</span> <span class="n">FLSUdisk</span><span class="p">(</span><span class="n">IBackElem</span><span class="p">)</span> <span class="o">*</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">AveRhoVisOverlap</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">)</span>
<a name="ln-8644"></a>    <span class="n">FFSUdiskTot</span> <span class="o">=</span> <span class="n">FFSUdiskTot</span> <span class="o">+</span> <span class="n">FirstFluxSUdisk</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">)</span>
<a name="ln-8645"></a>    <span class="n">FLSUDiskTot</span> <span class="o">=</span> <span class="n">FLSUDiskTot</span> <span class="o">+</span> <span class="n">FLSUDisk</span><span class="p">(</span><span class="n">iBackElem</span><span class="p">)</span>
<a name="ln-8646"></a>  <span class="k">end do</span>
<a name="ln-8647"></a>
<a name="ln-8648"></a><span class="k">  </span><span class="n">ZoneInsideSurfArea</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotInsSurfArea</span>
<a name="ln-8649"></a>  <span class="k">do </span><span class="n">iSky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-8650"></a>    <span class="n">EINTSK</span><span class="p">(</span><span class="n">iSky</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">FFSKTot</span><span class="p">(</span><span class="n">iSky</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Area</span><span class="o">/</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8651"></a>                             <span class="o">/</span> <span class="p">(</span><span class="n">ZoneInsideSurfArea</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span><span class="p">))</span>
<a name="ln-8652"></a>  <span class="k">end do</span>
<a name="ln-8653"></a><span class="k">  </span><span class="n">EINTSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">FFSUTot</span> <span class="o">*</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Area</span><span class="o">/</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8654"></a>                             <span class="o">/</span> <span class="p">(</span><span class="n">ZoneInsideSurfArea</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span><span class="p">))</span>
<a name="ln-8655"></a>  <span class="n">EINTSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">FFSUdiskTot</span> <span class="o">*</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Area</span><span class="o">/</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8656"></a>                             <span class="o">/</span> <span class="p">(</span><span class="n">ZoneInsideSurfArea</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span><span class="p">))</span>
<a name="ln-8657"></a>
<a name="ln-8658"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">FLSK</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">FLSK</span><span class="p">)</span>
<a name="ln-8659"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">FLSU</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">FLSU</span><span class="p">)</span>
<a name="ln-8660"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">FLSUdisk</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">FLSUdisk</span><span class="p">)</span>
<a name="ln-8661"></a>
<a name="ln-8662"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">FirstFluxSK</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">FirstFluxSK</span><span class="p">)</span>
<a name="ln-8663"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">FirstFluxSU</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">FirstFluxSU</span><span class="p">)</span>
<a name="ln-8664"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">FirstFluxSUdisk</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">FirstFluxSUdisk</span><span class="p">)</span>
<a name="ln-8665"></a>
<a name="ln-8666"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">ElementLuminanceSky</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">ElementLuminanceSky</span><span class="p">)</span>
<a name="ln-8667"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">ElementLuminanceSun</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">ElementLuminanceSun</span><span class="p">)</span>
<a name="ln-8668"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">ElementLuminanceSunDisk</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">ElementLuminanceSunDisk</span><span class="p">)</span>
<a name="ln-8669"></a>
<a name="ln-8670"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgInterReflectedIllumComplexFenestration</span>
<a name="ln-8671"></a>
<a name="ln-8672"></a><span class="k">SUBROUTINE </span><span class="n">DayltgDirectIllumComplexFenestration</span><span class="p">(</span><span class="n">IWin</span><span class="p">,</span> <span class="n">WinEl</span><span class="p">,</span> <span class="n">IHR</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">,</span> <span class="n">CalledFrom</span><span class="p">,</span> <span class="n">MapNum</span><span class="p">)</span>
<a name="ln-8673"></a>
<a name="ln-8674"></a>  <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8675"></a>  <span class="c">!       AUTHOR         Simon Vidanovic</span>
<a name="ln-8676"></a>  <span class="c">!       DATE WRITTEN   June 2013</span>
<a name="ln-8677"></a>  <span class="c">!       MODIFIED       na</span>
<a name="ln-8678"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8679"></a>
<a name="ln-8680"></a>  <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8681"></a>  <span class="c">!</span>
<a name="ln-8682"></a>
<a name="ln-8683"></a>  <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-8684"></a>
<a name="ln-8685"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-8686"></a>  <span class="c">!</span>
<a name="ln-8687"></a>
<a name="ln-8688"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-8689"></a>
<a name="ln-8690"></a>  <span class="k">implicit none</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8691"></a>
<a name="ln-8692"></a>  <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8693"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">IWin</span>                      <span class="c">! Window index</span>
<a name="ln-8694"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">WinEl</span>                     <span class="c">! Current window element counter</span>
<a name="ln-8695"></a>                                                 <span class="c">!  quantities that do not depend on sun position.</span>
<a name="ln-8696"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">IHR</span>                       <span class="c">! Hour of day</span>
<a name="ln-8697"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ZoneNum</span>                   <span class="c">! Zone number</span>
<a name="ln-8698"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iRefPoint</span>                 <span class="c">! reference point index</span>
<a name="ln-8699"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CalledFrom</span>
<a name="ln-8700"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">MapNum</span>
<a name="ln-8701"></a>
<a name="ln-8702"></a>
<a name="ln-8703"></a>  <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8704"></a>
<a name="ln-8705"></a>  <span class="c">! Luminances from different sources to the window</span>
<a name="ln-8706"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ElementLuminanceSky</span>     <span class="c">! sky related luminance at window element (exterior side)</span>
<a name="ln-8707"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">ElementLuminanceSun</span>     <span class="c">! sun related luminance at window element (exterior side),</span>
<a name="ln-8708"></a>                                                                    <span class="c">! exluding beam</span>
<a name="ln-8709"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">ElementLuminanceSunDisk</span> <span class="c">! sun related luminance at window element (exterior side),</span>
<a name="ln-8710"></a>                                                                    <span class="c">! due to sun beam</span>
<a name="ln-8711"></a>
<a name="ln-8712"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WinLumSK</span>      <span class="c">! Sky related window luminance</span>
<a name="ln-8713"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WinLumSU</span>      <span class="c">! Sun related window luminance, excluding entering beam</span>
<a name="ln-8714"></a>  <span class="c">!real(r64) :: WinLumSUdisk  ! Sun related window luminance, due to entering beam</span>
<a name="ln-8715"></a>
<a name="ln-8716"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EDirSky</span>      <span class="c">! Sky related direct illuminance</span>
<a name="ln-8717"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EDirSun</span>      <span class="c">! Sun related direct illuminance, excluding entering beam</span>
<a name="ln-8718"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EDirSunDisk</span>  <span class="c">! Sun related direct illuminance, due to entering beam</span>
<a name="ln-8719"></a>
<a name="ln-8720"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">CurCplxFenState</span>
<a name="ln-8721"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">NIncBasis</span>
<a name="ln-8722"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">RefPointIndex</span>  <span class="c">! reference point patch number</span>
<a name="ln-8723"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">iIncElem</span>
<a name="ln-8724"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">iConst</span>
<a name="ln-8725"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">iSky</span>
<a name="ln-8726"></a>
<a name="ln-8727"></a>  <span class="c">! real(r64) :: LambdaInc ! lambda for incident direation</span>
<a name="ln-8728"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dirTrans</span>  <span class="c">! directional BSDF transmittance</span>
<a name="ln-8729"></a>
<a name="ln-8730"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dOmega</span>  <span class="c">! solid view angle of current element</span>
<a name="ln-8731"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">zProjection</span> <span class="c">! z-axe projection of solid view angle (used to calculate amount of light at horizontal surface</span>
<a name="ln-8732"></a>                           <span class="c">! laying at reference point)</span>
<a name="ln-8733"></a>
<a name="ln-8734"></a>  <span class="n">CurCplxFenState</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span>
<a name="ln-8735"></a>  <span class="n">iConst</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">State</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">Konst</span>
<a name="ln-8736"></a>  <span class="n">NIncBasis</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">Inc</span><span class="p">%</span><span class="n">NBasis</span>
<a name="ln-8737"></a>
<a name="ln-8738"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">ElementLuminanceSky</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">ElementLuminanceSky</span><span class="p">(</span><span class="n">NIncBasis</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a name="ln-8739"></a>  <span class="n">ElementLuminanceSky</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8740"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">ElementLuminanceSun</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">ElementLuminanceSun</span><span class="p">(</span><span class="n">NIncBasis</span><span class="p">))</span>
<a name="ln-8741"></a>  <span class="n">ElementLuminanceSun</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8742"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">allocated</span><span class="p">(</span><span class="n">ElementLuminanceSunDisk</span><span class="p">))</span> <span class="k">allocate</span><span class="p">(</span><span class="n">ElementLuminanceSunDisk</span><span class="p">(</span><span class="n">NIncBasis</span><span class="p">))</span>
<a name="ln-8743"></a>  <span class="n">ElementLuminanceSunDisk</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8744"></a>
<a name="ln-8745"></a>  <span class="k">call </span><span class="n">ComplexFenestrationLuminances</span><span class="p">(</span><span class="n">IWIN</span><span class="p">,</span> <span class="n">WinEl</span><span class="p">,</span> <span class="n">NIncBasis</span><span class="p">,</span> <span class="n">IHR</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">,</span> <span class="n">ElementLuminanceSky</span><span class="p">,</span> <span class="n">ElementLuminanceSun</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8746"></a>            <span class="n">ElementLuminanceSunDisk</span><span class="p">,</span> <span class="n">CalledFrom</span><span class="p">,</span> <span class="n">MapNum</span><span class="p">)</span>
<a name="ln-8747"></a>
<a name="ln-8748"></a>  <span class="c">! find number of outgoing basis towards current reference point</span>
<a name="ln-8749"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8750"></a><span class="k">    </span><span class="n">RefPointIndex</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)%</span><span class="n">RefPointIndex</span><span class="p">(</span><span class="n">WinEl</span><span class="p">)</span>
<a name="ln-8751"></a>    <span class="n">dOmega</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)%</span><span class="n">SolidAngle</span><span class="p">(</span><span class="n">WinEl</span><span class="p">)</span>
<a name="ln-8752"></a>    <span class="n">zProjection</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)%</span><span class="n">SolidAngleVec</span><span class="p">(</span><span class="n">WinEl</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-8753"></a>  <span class="k">else</span>
<a name="ln-8754"></a><span class="k">    </span><span class="n">RefPointIndex</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)%</span><span class="n">RefPointIndex</span><span class="p">(</span><span class="n">WinEl</span><span class="p">)</span>
<a name="ln-8755"></a>    <span class="n">dOmega</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)%</span><span class="n">SolidAngle</span><span class="p">(</span><span class="n">WinEl</span><span class="p">)</span>
<a name="ln-8756"></a>    <span class="n">zProjection</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)%</span><span class="n">SolidAngleVec</span><span class="p">(</span><span class="n">WinEl</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-8757"></a>  <span class="k">end if</span>
<a name="ln-8758"></a>
<a name="ln-8759"></a><span class="k">  </span><span class="n">WinLumSK</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8760"></a>  <span class="n">WinLumSU</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8761"></a>  <span class="c">!WinLumSUdisk = 0.0d0</span>
<a name="ln-8762"></a>  <span class="n">EDirSky</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8763"></a>  <span class="n">EDirSun</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8764"></a>  <span class="n">EDirSunDisk</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8765"></a>
<a name="ln-8766"></a>  <span class="k">do </span><span class="n">iIncElem</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NIncBasis</span>
<a name="ln-8767"></a>    <span class="c">! LambdaInc = ComplexWind(IWin)%Geom(CurCplxFenState)%Inc%Lamda(iIncElem)</span>
<a name="ln-8768"></a>    <span class="n">dirTrans</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">iConst</span><span class="p">)%</span><span class="n">BSDFInput</span><span class="p">%</span><span class="n">VisFrtTrans</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">,</span> <span class="n">RefPointIndex</span><span class="p">)</span>
<a name="ln-8769"></a>
<a name="ln-8770"></a>    <span class="k">do </span><span class="n">iSky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-8771"></a>      <span class="n">WinLumSK</span><span class="p">(</span><span class="n">iSky</span><span class="p">)</span> <span class="o">=</span> <span class="n">WinLumSK</span><span class="p">(</span><span class="n">iSky</span><span class="p">)</span> <span class="o">+</span> <span class="n">dirTrans</span> <span class="o">*</span> <span class="n">ElementLuminanceSky</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">,</span> <span class="n">iSky</span><span class="p">)</span>
<a name="ln-8772"></a>    <span class="k">end do</span>
<a name="ln-8773"></a>
<a name="ln-8774"></a><span class="k">    </span><span class="n">WinLumSU</span> <span class="o">=</span> <span class="n">WinLumSU</span> <span class="o">+</span> <span class="n">dirTrans</span> <span class="o">*</span> <span class="n">ElementLuminanceSun</span><span class="p">(</span><span class="n">iIncElem</span><span class="p">)</span>
<a name="ln-8775"></a>
<a name="ln-8776"></a>    <span class="c">! For sun disk need to go throug outgoing directions and see which directions actually contain reference point</span>
<a name="ln-8777"></a>    <span class="c">!if ((PosFac /= 0.0d0).and.(dOmega &gt; 1e-6)) then</span>
<a name="ln-8778"></a>      <span class="c">!WinLumSUdisk = WinLumSUdisk + dirTrans * ElementLuminanceSunDisk(iIncElem) * 14700.0d0 * sqrt(0.000068d0*PosFac) / &amp;</span>
<a name="ln-8779"></a>      <span class="c">!  (dOmega**0.8d0)</span>
<a name="ln-8780"></a>    <span class="c">!end if</span>
<a name="ln-8781"></a>  <span class="k">end do</span>
<a name="ln-8782"></a>
<a name="ln-8783"></a><span class="k">  if</span> <span class="p">(</span><span class="n">zProjection</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8784"></a><span class="k">    do </span><span class="n">iSky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-8785"></a>      <span class="n">EDirSky</span><span class="p">(</span><span class="n">iSky</span><span class="p">)</span> <span class="o">=</span> <span class="n">WinLumSK</span><span class="p">(</span><span class="n">iSky</span><span class="p">)</span> <span class="o">*</span> <span class="n">dOmega</span> <span class="o">*</span> <span class="n">zProjection</span>
<a name="ln-8786"></a>    <span class="k">end do</span>
<a name="ln-8787"></a><span class="k">    </span><span class="n">EDirSun</span> <span class="o">=</span> <span class="n">WinLumSU</span> <span class="o">*</span> <span class="n">dOmega</span> <span class="o">*</span> <span class="n">zProjection</span>
<a name="ln-8788"></a>  <span class="k">end if</span>
<a name="ln-8789"></a>
<a name="ln-8790"></a>  <span class="c">! Store solution in global variables</span>
<a name="ln-8791"></a>  <span class="k">do </span><span class="n">iSky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-8792"></a>    <span class="n">AVWLSK</span><span class="p">(</span><span class="n">iSky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">AVWLSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">+</span> <span class="n">WinLumSK</span><span class="p">(</span><span class="n">iSky</span><span class="p">)</span>
<a name="ln-8793"></a>    <span class="n">EDIRSK</span><span class="p">(</span><span class="n">iSky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">EDIRSK</span><span class="p">(</span><span class="n">ISKY</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">+</span> <span class="n">EDirSky</span><span class="p">(</span><span class="n">iSky</span><span class="p">)</span>
<a name="ln-8794"></a>  <span class="k">end do</span>
<a name="ln-8795"></a>
<a name="ln-8796"></a><span class="k">  </span><span class="n">AVWLSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">AVWLSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">+</span> <span class="n">WinLumSU</span>
<a name="ln-8797"></a>  <span class="n">EDIRSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">=</span> <span class="n">EDIRSU</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IHR</span><span class="p">)</span> <span class="o">+</span> <span class="n">EDirSun</span>
<a name="ln-8798"></a>  <span class="c">!AVWLSUdisk(1,IHR) = AVWLSUdisk(1,IHR) + WinLumSUdisk</span>
<a name="ln-8799"></a>
<a name="ln-8800"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">ElementLuminanceSky</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">ElementLuminanceSky</span><span class="p">)</span>
<a name="ln-8801"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">ElementLuminanceSun</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">ElementLuminanceSun</span><span class="p">)</span>
<a name="ln-8802"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">ElementLuminanceSunDisk</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">ElementLuminanceSunDisk</span><span class="p">)</span>
<a name="ln-8803"></a>
<a name="ln-8804"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgDirectIllumComplexFenestration</span>
<a name="ln-8805"></a>
<a name="ln-8806"></a><span class="k">SUBROUTINE </span><span class="n">DayltgDirectSunDiskComplexFenestration</span><span class="p">(</span><span class="n">iWin</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">,</span> <span class="n">iHour</span><span class="p">,</span> <span class="n">loopwin</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">,</span> <span class="n">NumEl</span><span class="p">,</span> <span class="n">AZVIEW</span><span class="p">,</span> <span class="n">CalledFrom</span><span class="p">,</span> <span class="n">MapNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8807"></a>    <span class="n">MapWindowSolidAngAtRefPtWtd</span><span class="p">)</span>
<a name="ln-8808"></a>
<a name="ln-8809"></a>  <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8810"></a>  <span class="c">!       AUTHOR         Simon Vidanovic</span>
<a name="ln-8811"></a>  <span class="c">!       DATE WRITTEN   June 2013</span>
<a name="ln-8812"></a>  <span class="c">!       MODIFIED       na</span>
<a name="ln-8813"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8814"></a>
<a name="ln-8815"></a>  <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8816"></a>  <span class="c">! Calculate illuminance from sun disk for complex fenestration systems</span>
<a name="ln-8817"></a>
<a name="ln-8818"></a>  <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-8819"></a>
<a name="ln-8820"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-8821"></a>  <span class="c">!</span>
<a name="ln-8822"></a>
<a name="ln-8823"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-8824"></a>
<a name="ln-8825"></a>  <span class="k">implicit none</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8826"></a>
<a name="ln-8827"></a>  <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8828"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iWin</span>       <span class="c">! Window index</span>
<a name="ln-8829"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ZoneNum</span>    <span class="c">! Zone number</span>
<a name="ln-8830"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iHour</span>      <span class="c">! Hour of day</span>
<a name="ln-8831"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LoopWin</span>
<a name="ln-8832"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CalledFrom</span> <span class="c">! indicate  which type of routine called this routine</span>
<a name="ln-8833"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">NumEl</span>      <span class="c">! Total number of window elements</span>
<a name="ln-8834"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AZVIEW</span>    <span class="c">! Azimuth of view vector in absolute coord system for</span>
<a name="ln-8835"></a>                                     <span class="c">!  glare calculation (radians)</span>
<a name="ln-8836"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iRefPoint</span>
<a name="ln-8837"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">MapNum</span>
<a name="ln-8838"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">MapWindowSolidAngAtRefPtWtd</span>
<a name="ln-8839"></a>
<a name="ln-8840"></a>  <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8841"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">CurCplxFenState</span>
<a name="ln-8842"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">iConst</span>
<a name="ln-8843"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">SolBmIndex</span>
<a name="ln-8844"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">NTrnBasis</span>
<a name="ln-8845"></a>  <span class="kt">integer</span>   <span class="kd">::</span> <span class="n">iTrnElem</span>
<a name="ln-8846"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WindowSolidAngleDaylightPoint</span>
<a name="ln-8847"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XR</span>
<a name="ln-8848"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YR</span>
<a name="ln-8849"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PosFac</span>
<a name="ln-8850"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dirTrans</span>
<a name="ln-8851"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LambdaTrn</span>
<a name="ln-8852"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WinLumSunDisk</span>        <span class="c">! window luminance from sun disk</span>
<a name="ln-8853"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ELumSunDisk</span>          <span class="c">! window illuminance from sun disk</span>
<a name="ln-8854"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TransBeam</span>            <span class="c">! transmittance of the beam for given direction</span>
<a name="ln-8855"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">V</span>      <span class="c">! temporary vector</span>
<a name="ln-8856"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RWin</span>   <span class="c">! Window center</span>
<a name="ln-8857"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RayZ</span>   <span class="c">! z component of unit vector for outgoing direction</span>
<a name="ln-8858"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">refPointIntersect</span>
<a name="ln-8859"></a>
<a name="ln-8860"></a>  <span class="n">CurCplxFenState</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">iWin</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span>
<a name="ln-8861"></a>  <span class="n">iConst</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">iWin</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">State</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">Konst</span>
<a name="ln-8862"></a>  <span class="n">SolBmIndex</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">iWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">SolBmIndex</span><span class="p">(</span><span class="n">iHour</span><span class="p">,</span> <span class="n">timestep</span><span class="p">)</span>
<a name="ln-8863"></a>
<a name="ln-8864"></a>  <span class="k">select case</span> <span class="p">(</span><span class="n">CalledFrom</span><span class="p">)</span>
<a name="ln-8865"></a>    <span class="k">case</span> <span class="p">(</span><span class="n">CalledForRefPoint</span><span class="p">)</span>
<a name="ln-8866"></a>      <span class="n">WindowSolidAngleDaylightPoint</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)</span>
<a name="ln-8867"></a>    <span class="k">case</span> <span class="p">(</span><span class="n">CalledForMapPoint</span><span class="p">)</span>
<a name="ln-8868"></a>      <span class="n">WindowSolidAngleDaylightPoint</span> <span class="o">=</span> <span class="n">MapWindowSolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">LoopWin</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)</span>
<a name="ln-8869"></a>  <span class="k">end select</span>
<a name="ln-8870"></a>
<a name="ln-8871"></a><span class="k">  if</span> <span class="p">(</span><span class="n">WindowSolidAngleDaylightPoint</span> <span class="o">&lt;</span> <span class="err">1</span><span class="n">e</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-8872"></a>
<a name="ln-8873"></a><span class="k">  </span><span class="n">WinLumSunDisk</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8874"></a>  <span class="n">ELumSunDisk</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8875"></a>  <span class="n">NTrnBasis</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">Trn</span><span class="p">%</span><span class="n">NBasis</span>
<a name="ln-8876"></a>  <span class="k">do </span><span class="n">iTrnElem</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NTrnBasis</span>
<a name="ln-8877"></a>    <span class="c">! if ray from any part of the window can reach reference point</span>
<a name="ln-8878"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8879"></a><span class="k">      </span><span class="n">refPointIntersect</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)%</span><span class="n">RefPointIntersection</span><span class="p">(</span><span class="n">iTrnElem</span><span class="p">)</span>
<a name="ln-8880"></a>    <span class="k">else</span>
<a name="ln-8881"></a><span class="k">      </span><span class="n">refPointIntersect</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-8882"></a>        <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)%</span><span class="n">RefPointIntersection</span><span class="p">(</span><span class="n">iTrnElem</span><span class="p">)</span>
<a name="ln-8883"></a>    <span class="k">end if</span>
<a name="ln-8884"></a><span class="k">    if</span> <span class="p">(</span><span class="n">refPointIntersect</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8885"></a><span class="k">      if</span> <span class="p">(</span><span class="n">CalledFrom</span> <span class="o">==</span> <span class="n">CalledForRefPoint</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8886"></a><span class="k">        </span><span class="n">PosFac</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">iWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">RefPoint</span><span class="p">(</span><span class="n">iRefPoint</span><span class="p">)%</span><span class="n">RefPtIntPosFac</span><span class="p">(</span><span class="n">iTrnElem</span><span class="p">)</span>
<a name="ln-8887"></a>      <span class="k">else</span>
<a name="ln-8888"></a><span class="k">        </span><span class="n">PosFac</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">iWin</span><span class="p">)%</span><span class="n">DaylghtGeom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">IlluminanceMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">iRefPoint</span><span class="p">)%</span><span class="n">RefPtIntPosFac</span><span class="p">(</span><span class="n">iTrnElem</span><span class="p">)</span>
<a name="ln-8889"></a>      <span class="k">end if</span>
<a name="ln-8890"></a><span class="k">      </span><span class="n">RayZ</span> <span class="o">=</span> <span class="o">-</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">sTrn</span><span class="p">(</span><span class="n">iTrnElem</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-8891"></a>
<a name="ln-8892"></a>      <span class="c">! Need to recalculate position factor for dominant direction in case of specular bsdf.  Otherwise this will produce</span>
<a name="ln-8893"></a>      <span class="c">! very inaccurate results because of position factor of the sun and bsdf pach can vary by lot</span>
<a name="ln-8894"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">iTrnElem</span> <span class="o">==</span> <span class="n">SolBmIndex</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8895"></a><span class="k">        </span><span class="n">XR</span> <span class="o">=</span> <span class="nb">TAN</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">PIOVR2</span> <span class="o">-</span> <span class="n">AZVIEW</span> <span class="o">-</span> <span class="n">THSUN</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.001d0</span><span class="p">)</span>
<a name="ln-8896"></a>        <span class="n">YR</span> <span class="o">=</span> <span class="nb">TAN</span><span class="p">(</span><span class="n">PHSUN</span> <span class="o">+</span> <span class="mf">0.001d0</span><span class="p">)</span>
<a name="ln-8897"></a>        <span class="n">PosFac</span> <span class="o">=</span> <span class="n">DayltgGlarePositionFactor</span><span class="p">(</span><span class="n">XR</span><span class="p">,</span><span class="n">YR</span><span class="p">)</span>
<a name="ln-8898"></a>        <span class="n">RayZ</span> <span class="o">=</span> <span class="n">SPHSUN</span>
<a name="ln-8899"></a>      <span class="k">end if</span>
<a name="ln-8900"></a>
<a name="ln-8901"></a><span class="k">      if</span> <span class="p">(</span><span class="n">PosFac</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8902"></a><span class="k">        if</span> <span class="p">(</span><span class="n">SolBmIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8903"></a><span class="k">          </span><span class="n">dirTrans</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">iConst</span><span class="p">)%</span><span class="n">BSDFInput</span><span class="p">%</span><span class="n">VisFrtTrans</span><span class="p">(</span><span class="n">SolBmIndex</span><span class="p">,</span> <span class="n">iTrnElem</span><span class="p">)</span>
<a name="ln-8904"></a>        <span class="k">else</span>
<a name="ln-8905"></a><span class="k">          </span><span class="n">dirTrans</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8906"></a>        <span class="k">end if</span>
<a name="ln-8907"></a><span class="k">        </span><span class="n">LambdaTrn</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">iWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">Trn</span><span class="p">%</span><span class="n">Lamda</span><span class="p">(</span><span class="n">iTrnElem</span><span class="p">)</span>
<a name="ln-8908"></a>
<a name="ln-8909"></a>        <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">sTrn</span><span class="p">(</span><span class="n">iTrnElem</span><span class="p">)%</span><span class="n">x</span>
<a name="ln-8910"></a>        <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">sTrn</span><span class="p">(</span><span class="n">iTrnElem</span><span class="p">)%</span><span class="n">y</span>
<a name="ln-8911"></a>        <span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">sTrn</span><span class="p">(</span><span class="n">iTrnElem</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-8912"></a>        <span class="n">V</span> <span class="o">=</span> <span class="o">-</span><span class="n">V</span>
<a name="ln-8913"></a>
<a name="ln-8914"></a>        <span class="n">RWin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">iWin</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">x</span>
<a name="ln-8915"></a>        <span class="n">RWin</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">iWin</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">y</span>
<a name="ln-8916"></a>        <span class="n">RWin</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">iWin</span><span class="p">)%</span><span class="n">Centroid</span><span class="p">%</span><span class="n">z</span>
<a name="ln-8917"></a>
<a name="ln-8918"></a>        <span class="k">call </span><span class="n">DayltgHitObstruction</span><span class="p">(</span><span class="n">iHour</span><span class="p">,</span> <span class="n">iWin</span><span class="p">,</span> <span class="n">RWin</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">TransBeam</span><span class="p">)</span>
<a name="ln-8919"></a>
<a name="ln-8920"></a>        <span class="n">WinLumSunDisk</span> <span class="o">=</span> <span class="n">WinLumSunDisk</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1470</span><span class="mf">0.0d0</span> <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="mf">0.000068d0</span> <span class="o">*</span> <span class="n">PosFac</span><span class="p">)</span> <span class="o">*</span>  <span class="kt">real</span><span class="p">(</span><span class="n">NumEl</span><span class="p">,</span> <span class="n">r64</span><span class="p">)</span> <span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-8921"></a>           <span class="n">WindowSolidAngleDaylightPoint</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">dirTrans</span> <span class="o">*</span> <span class="n">LambdaTrn</span> <span class="o">*</span> <span class="n">TransBeam</span>
<a name="ln-8922"></a>
<a name="ln-8923"></a>        <span class="n">ELumSunDisk</span> <span class="o">=</span> <span class="n">ELumSunDisk</span> <span class="o">+</span> <span class="n">RayZ</span> <span class="o">*</span> <span class="n">dirTrans</span> <span class="o">*</span> <span class="n">LambdaTrn</span> <span class="o">*</span> <span class="n">TransBeam</span>
<a name="ln-8924"></a>      <span class="k">end if</span>
<a name="ln-8925"></a><span class="k">    end if</span>
<a name="ln-8926"></a><span class="k">  end do</span>
<a name="ln-8927"></a>
<a name="ln-8928"></a><span class="k">  </span><span class="n">AVWLSUdisk</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">WinLumSunDisk</span>
<a name="ln-8929"></a>  <span class="n">EDirSUDisk</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">ELumSunDisk</span>
<a name="ln-8930"></a>
<a name="ln-8931"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgDirectSunDiskComplexFenestration</span>
<a name="ln-8932"></a>
<a name="ln-8933"></a><span class="k">FUNCTION </span><span class="n">DayltgSkyLuminance</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span> <span class="n">THSKY</span><span class="p">,</span> <span class="n">PHSKY</span><span class="p">)</span>
<a name="ln-8934"></a>
<a name="ln-8935"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8936"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-8937"></a>          <span class="c">!       DATE WRITTEN   July 1997</span>
<a name="ln-8938"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8939"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8940"></a>
<a name="ln-8941"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8942"></a>          <span class="c">! Called by CalcDayltgCoefficients, DayltgExtHorizIllum AND DayltgInterReflectedIllum.  gives</span>
<a name="ln-8943"></a>          <span class="c">! luminance in cd/m2 for four different sky types, as described in R.Perez, P.Ineichen,</span>
<a name="ln-8944"></a>          <span class="c">! R.Seals, J.Michalsky and R.Stewart, &quot;Modeling daylight availability and irradiance</span>
<a name="ln-8945"></a>          <span class="c">! components from direct and global irradiance,&quot; Solar Energy 44, 1990, 271-289.</span>
<a name="ln-8946"></a>          <span class="c">! The luminance distributions in this routine are normalized such that</span>
<a name="ln-8947"></a>          <span class="c">! the zenith luminance is 1.0, i.e., DayltgSkyLuminance =</span>
<a name="ln-8948"></a>          <span class="c">! (sky luminance at THSKY, PHSKY)/(zenith luminance), which is dimensionless.</span>
<a name="ln-8949"></a>          <span class="c">! The sky types are:</span>
<a name="ln-8950"></a>          <span class="c">! 1. Standard CIE clear sky</span>
<a name="ln-8951"></a>          <span class="c">! 2. Standard CIE high-turbidity clear sky</span>
<a name="ln-8952"></a>          <span class="c">! 3. CIE intermediate sky</span>
<a name="ln-8953"></a>          <span class="c">! 4. CIE overcast sky</span>
<a name="ln-8954"></a>
<a name="ln-8955"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8956"></a>
<a name="ln-8957"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8958"></a>          <span class="c">! Based on DOE-2.1E subroutine DSKYLU, which did only clear and overcast skies.</span>
<a name="ln-8959"></a>
<a name="ln-8960"></a>          <span class="c">! OTHER NOTES:</span>
<a name="ln-8961"></a>          <span class="c">! THSKY ranges from 0 to 2Pi starting with 0 directly East and rotating clockwise.</span>
<a name="ln-8962"></a>          <span class="c">! PHSKY ranges from 0 to Pi starting with 0 at the horizon and Pi/2 at the zenith.</span>
<a name="ln-8963"></a>
<a name="ln-8964"></a>          <span class="c">! USE STATEMENTS: na</span>
<a name="ln-8965"></a>
<a name="ln-8966"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8967"></a>
<a name="ln-8968"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8969"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ISky</span>                      <span class="c">! Sky type: 1=clear, 2=clear turbid, 3=intermediate, 4=overcast</span>
<a name="ln-8970"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">THSKY</span><span class="p">,</span><span class="n">PHSKY</span>               <span class="c">! Azimuth and altitude of sky element (radians)</span>
<a name="ln-8971"></a>
<a name="ln-8972"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8973"></a>          <span class="c">! na</span>
<a name="ln-8974"></a>
<a name="ln-8975"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8976"></a>          <span class="c">! na</span>
<a name="ln-8977"></a>
<a name="ln-8978"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8979"></a>          <span class="c">! na</span>
<a name="ln-8980"></a>
<a name="ln-8981"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8982"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SPHSKY</span>                    <span class="c">! Sine of PHSKY</span>
<a name="ln-8983"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">G</span>                         <span class="c">! Angle between sun and element of sky (radians)</span>
<a name="ln-8984"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">COSG</span>                      <span class="c">! Cosine of G</span>
<a name="ln-8985"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Z</span>                         <span class="c">! Solar zenith angle (radians)</span>
<a name="ln-8986"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">Z3</span><span class="p">,</span><span class="n">Z4</span>               <span class="c">! Luminance factors (intermediate variables)</span>
<a name="ln-8987"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DayltgSkyLuminance</span>        <span class="c">! Luminance of sky element divided by zenith luminance</span>
<a name="ln-8988"></a>
<a name="ln-8989"></a>          <span class="c">! FLOW:</span>
<a name="ln-8990"></a>  <span class="n">SPHSKY</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="nb">SIN</span><span class="p">(</span><span class="n">PHSKY</span><span class="p">),</span><span class="mf">0.01d0</span><span class="p">)</span> <span class="c">! Prevent floating point underflows</span>
<a name="ln-8991"></a>  <span class="n">Z</span> <span class="o">=</span> <span class="n">PIOVR2</span> <span class="o">-</span> <span class="n">PHSUN</span>
<a name="ln-8992"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ISky</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Following not needed for overcast sky</span>
<a name="ln-8993"></a>    <span class="n">COSG</span> <span class="o">=</span> <span class="n">SPHSKY</span> <span class="o">*</span> <span class="n">SPHSUN</span> <span class="o">+</span> <span class="nb">COS</span><span class="p">(</span><span class="n">PHSKY</span><span class="p">)</span> <span class="o">*</span> <span class="n">CPHSUN</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">THSKY</span> <span class="o">-</span> <span class="n">THSUN</span><span class="p">)</span>
<a name="ln-8994"></a>    <span class="n">COSG</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">constant_minusone</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="n">COSG</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">))</span> <span class="c">! Prevent out of range due to roundoff</span>
<a name="ln-8995"></a>    <span class="n">G</span> <span class="o">=</span> <span class="nb">ACOS</span><span class="p">(</span><span class="n">COSG</span><span class="p">)</span>
<a name="ln-8996"></a>  <span class="k">END IF</span>
<a name="ln-8997"></a>
<a name="ln-8998"></a><span class="k">  SELECT CASE</span><span class="p">(</span><span class="n">ISky</span><span class="p">)</span>
<a name="ln-8999"></a>    <span class="k">CASE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c">! Clear Sky</span>
<a name="ln-9000"></a>      <span class="n">Z1</span> <span class="o">=</span> <span class="mf">0.910d0</span> <span class="o">+</span> <span class="mi">1</span><span class="mf">0.d0</span> <span class="o">*</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="mf">3.d0</span> <span class="o">*</span> <span class="n">G</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.45d0</span> <span class="o">*</span> <span class="n">COSG</span> <span class="o">*</span> <span class="n">COSG</span>
<a name="ln-9001"></a>      <span class="n">Z2</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">-</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="mf">0.32d0</span> <span class="o">/</span> <span class="n">SPHSKY</span><span class="p">)</span>
<a name="ln-9002"></a>      <span class="n">Z3</span> <span class="o">=</span> <span class="mf">0.27385d0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.91d0</span> <span class="o">+</span> <span class="mi">1</span><span class="mf">0.d0</span> <span class="o">*</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="mf">3.d0</span> <span class="o">*</span> <span class="n">Z</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.45d0</span> <span class="o">*</span> <span class="n">SPHSUN</span> <span class="o">*</span> <span class="n">SPHSUN</span><span class="p">)</span>
<a name="ln-9003"></a>      <span class="n">DayltgSkyLuminance</span> <span class="o">=</span> <span class="n">Z1</span> <span class="o">*</span> <span class="n">Z2</span> <span class="o">/</span> <span class="n">Z3</span>
<a name="ln-9004"></a>
<a name="ln-9005"></a>    <span class="k">CASE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c">! Clear turbid sky</span>
<a name="ln-9006"></a>      <span class="n">Z1</span> <span class="o">=</span> <span class="mf">0.856d0</span> <span class="o">+</span> <span class="mi">1</span><span class="mf">6.d0</span> <span class="o">*</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="mf">3.d0</span> <span class="o">*</span> <span class="n">G</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.3d0</span> <span class="o">*</span> <span class="n">COSG</span> <span class="o">*</span> <span class="n">COSG</span>
<a name="ln-9007"></a>      <span class="n">Z2</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">-</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="mf">0.32d0</span> <span class="o">/</span> <span class="n">SPHSKY</span><span class="p">)</span>
<a name="ln-9008"></a>      <span class="n">Z3</span> <span class="o">=</span> <span class="mf">0.27385d0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.856d0</span> <span class="o">+</span> <span class="mi">1</span><span class="mf">6.d0</span> <span class="o">*</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="mf">3.d0</span> <span class="o">*</span> <span class="n">Z</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.3d0</span> <span class="o">*</span> <span class="n">SPHSUN</span> <span class="o">*</span> <span class="n">SPHSUN</span><span class="p">)</span>
<a name="ln-9009"></a>      <span class="n">DayltgSkyLuminance</span> <span class="o">=</span> <span class="n">Z1</span> <span class="o">*</span> <span class="n">Z2</span> <span class="o">/</span> <span class="n">Z3</span>
<a name="ln-9010"></a>
<a name="ln-9011"></a>    <span class="k">CASE</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c">! Intermediate sky</span>
<a name="ln-9012"></a>      <span class="n">Z1</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.35d0</span> <span class="o">*</span> <span class="p">(</span><span class="nb">SIN</span><span class="p">(</span><span class="mf">3.59d0</span> <span class="o">*</span> <span class="n">PHSKY</span> <span class="o">-</span> <span class="mf">0.009d0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.31d0</span><span class="p">)</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="mf">2.6d0</span> <span class="o">*</span> <span class="n">PHSUN</span> <span class="o">+</span> <span class="mf">0.316d0</span><span class="p">)</span> <span class="o">+</span> <span class="n">PHSKY</span> <span class="o">+</span> <span class="mf">4.799d0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.326d0</span>
<a name="ln-9013"></a>      <span class="n">Z2</span> <span class="o">=</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">G</span> <span class="o">*</span> <span class="mf">0.563d0</span> <span class="o">*</span> <span class="p">((</span><span class="n">PHSUN</span> <span class="o">-</span> <span class="mf">0.008d0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">PHSKY</span> <span class="o">+</span> <span class="mf">1.059d0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.812d0</span><span class="p">))</span>
<a name="ln-9014"></a>      <span class="n">Z3</span> <span class="o">=</span> <span class="mf">0.99224d0</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="mf">2.6d0</span> <span class="o">*</span> <span class="n">PHSUN</span> <span class="o">+</span> <span class="mf">0.316d0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.73852d0</span>
<a name="ln-9015"></a>      <span class="n">Z4</span> <span class="o">=</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">Z</span> <span class="o">*</span> <span class="mf">0.563d0</span> <span class="o">*</span> <span class="p">((</span><span class="n">PHSUN</span> <span class="o">-</span> <span class="mf">0.008d0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.6298d0</span> <span class="o">+</span> <span class="mf">0.812d0</span><span class="p">))</span>
<a name="ln-9016"></a>      <span class="n">DayltgSkyLuminance</span> <span class="o">=</span> <span class="n">Z1</span> <span class="o">*</span> <span class="n">Z2</span> <span class="o">/</span> <span class="p">(</span><span class="n">Z3</span> <span class="o">*</span> <span class="n">Z4</span><span class="p">)</span>
<a name="ln-9017"></a>
<a name="ln-9018"></a>    <span class="k">CASE</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c">! Overcast sky</span>
<a name="ln-9019"></a>      <span class="n">DayltgSkyLuminance</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">SPHSKY</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.0d0</span>
<a name="ln-9020"></a>
<a name="ln-9021"></a>  <span class="k">END SELECT</span>
<a name="ln-9022"></a>
<a name="ln-9023"></a><span class="k">  RETURN</span>
<a name="ln-9024"></a>
<a name="ln-9025"></a><span class="k">END FUNCTION </span><span class="n">DayltgSkyLuminance</span>
<a name="ln-9026"></a>
<a name="ln-9027"></a><span class="k">SUBROUTINE </span><span class="n">ProfileAngle</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">CosDirSun</span><span class="p">,</span><span class="n">HorOrVert</span><span class="p">,</span><span class="n">ProfileAng</span><span class="p">)</span>
<a name="ln-9028"></a>
<a name="ln-9029"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9030"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-9031"></a>          <span class="c">!       DATE WRITTEN   May 2001</span>
<a name="ln-9032"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9033"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9034"></a>
<a name="ln-9035"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9036"></a>          <span class="c">! Calculates profile angle for a surface.</span>
<a name="ln-9037"></a>
<a name="ln-9038"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-9039"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9040"></a>
<a name="ln-9041"></a>  <span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-9042"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span>
<a name="ln-9043"></a>
<a name="ln-9044"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9045"></a>
<a name="ln-9046"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9047"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Surface number</span>
<a name="ln-9048"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosDirSun</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>      <span class="c">! Solar direction cosines</span>
<a name="ln-9049"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">HorOrVert</span>         <span class="c">! If HORIZONTAL, calculates ProfileAngHor</span>
<a name="ln-9050"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ProfileAng</span>        <span class="c">! Solar profile angle (radians).</span>
<a name="ln-9051"></a>                                 <span class="c">! For HorOrVert = HORIZONTAL,</span>
<a name="ln-9052"></a>                                 <span class="c">!  this is the incidence angle in a plane that is normal to the window</span>
<a name="ln-9053"></a>                                 <span class="c">!  and parallel to the Y-axis of the window (the axis along</span>
<a name="ln-9054"></a>                                 <span class="c">!  which the height of the window is measured).</span>
<a name="ln-9055"></a>                                 <span class="c">!  For HorOrVert = VERTICAL,</span>
<a name="ln-9056"></a>                                 <span class="c">!  this is the incidence angle in a plane that is normal to the window</span>
<a name="ln-9057"></a>                                 <span class="c">!  and parallel to the X-axis of the window (the axis along</span>
<a name="ln-9058"></a>                                 <span class="c">!  which the width of the window is measured).</span>
<a name="ln-9059"></a>                                 <span class="c">! If VERTICAL, calculates ProfileAngVert</span>
<a name="ln-9060"></a>
<a name="ln-9061"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS: na</span>
<a name="ln-9062"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS: na</span>
<a name="ln-9063"></a>          <span class="c">! DERIVED TYPE DEFINITIONS: na</span>
<a name="ln-9064"></a>
<a name="ln-9065"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9066"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElevSun</span>           <span class="c">! Sun elevation; angle between sun and horizontal (radians)</span>
<a name="ln-9067"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElevWin</span>           <span class="c">! Window elevation: angle between window outward normal and horizontal (radians)</span>
<a name="ln-9068"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AzimWin</span>           <span class="c">! Window azimuth (radians)</span>
<a name="ln-9069"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AzimSun</span>           <span class="c">! Sun azimuth (radians)</span>
<a name="ln-9070"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WinNorm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>        <span class="c">! Window outward normal unit vector</span>
<a name="ln-9071"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThWin</span>             <span class="c">! Azimuth angle of WinNorm</span>
<a name="ln-9072"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SunPrime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>       <span class="c">! Projection of sun vector onto plane (perpendicular to</span>
<a name="ln-9073"></a>                                        <span class="c">!  window plane) determined by WinNorm and vector along</span>
<a name="ln-9074"></a>                                        <span class="c">!  baseline of window</span>
<a name="ln-9075"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WinNormCrossBase</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c">! Cross product of WinNorm and vector along window baseline</span>
<a name="ln-9076"></a><span class="c">!  INTEGER            :: IComp             ! Vector component index</span>
<a name="ln-9077"></a>
<a name="ln-9078"></a>          <span class="c">! FLOW:</span>
<a name="ln-9079"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HorOrVert</span> <span class="o">==</span> <span class="n">Horizontal</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Profile angle for horizontal structures</span>
<a name="ln-9080"></a>    <span class="n">ElevWin</span> <span class="o">=</span> <span class="n">Piovr2</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-9081"></a>    <span class="n">AzimWin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="mf">0.d0</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">)</span> <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-9082"></a>    <span class="n">ElevSun</span> <span class="o">=</span> <span class="nb">ASIN</span><span class="p">(</span><span class="n">CosDirSun</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-9083"></a>    <span class="n">AzimSun</span> <span class="o">=</span> <span class="n">ATAN2</span><span class="p">(</span><span class="n">CosDirSun</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">CosDirSun</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-9084"></a>    <span class="n">ProfileAng</span> <span class="o">=</span> <span class="nb">ATAN</span><span class="p">(</span><span class="nb">SIN</span><span class="p">(</span><span class="n">ElevSun</span><span class="p">)</span><span class="o">/</span><span class="nb">ABS</span><span class="p">(</span><span class="nb">COS</span><span class="p">(</span><span class="n">ElevSun</span><span class="p">)</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">AzimWin</span><span class="o">-</span><span class="n">AzimSun</span><span class="p">)))</span> <span class="o">-</span> <span class="n">ElevWin</span>
<a name="ln-9085"></a>  <span class="k">ELSE</span> <span class="c">! Profile angle for vertical structures</span>
<a name="ln-9086"></a>    <span class="n">ElevWin</span> <span class="o">=</span> <span class="n">Piovr2</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-9087"></a>    <span class="n">AzimWin</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span> <span class="o">*</span> <span class="n">DegToRadians</span> <span class="c">! 7952</span>
<a name="ln-9088"></a>    <span class="n">AzimSun</span> <span class="o">=</span> <span class="n">ATAN2</span><span class="p">(</span><span class="n">CosDirSun</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">CosDirSun</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="c">! 7952</span>
<a name="ln-9089"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ElevWin</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Near-vertical window</span>
<a name="ln-9090"></a>      <span class="n">ProfileAng</span> <span class="o">=</span> <span class="n">AzimWin</span> <span class="o">-</span>  <span class="n">AzimSun</span> <span class="c">!CR7952 allow sign changes.</span>
<a name="ln-9091"></a>    <span class="k">ELSE</span>
<a name="ln-9092"></a><span class="k">      </span><span class="n">WinNorm</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span>
<a name="ln-9093"></a>      <span class="n">ThWin</span> <span class="o">=</span> <span class="n">AzimWin</span> <span class="o">-</span> <span class="n">PiOvr2</span>
<a name="ln-9094"></a>      <span class="n">WinNormCrossBase</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="nb">SIN</span><span class="p">(</span><span class="n">ElevWin</span><span class="p">)</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">ThWin</span><span class="p">)</span>
<a name="ln-9095"></a>      <span class="n">WinNormCrossBase</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span>  <span class="nb">SIN</span><span class="p">(</span><span class="n">ElevWin</span><span class="p">)</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">ThWin</span><span class="p">)</span>
<a name="ln-9096"></a>      <span class="n">WinNormCrossBase</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span>  <span class="nb">COS</span><span class="p">(</span><span class="n">ElevWin</span><span class="p">)</span>
<a name="ln-9097"></a>      <span class="n">SunPrime</span> <span class="o">=</span> <span class="n">CosDirSun</span> <span class="o">-</span> <span class="n">WinNormCrossBase</span> <span class="o">*</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">CosDirSun</span><span class="p">,</span><span class="n">WinNormCrossBase</span><span class="p">)</span>
<a name="ln-9098"></a>      <span class="n">ProfileAng</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">ACOS</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">WinNorm</span><span class="p">,</span><span class="n">SunPrime</span><span class="p">)</span><span class="o">/</span><span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">SunPrime</span><span class="p">,</span><span class="n">SunPrime</span><span class="p">))))</span>
<a name="ln-9099"></a>      <span class="c">!CR7952 correct sign of result for vertical slats</span>
<a name="ln-9100"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">AzimWin</span> <span class="o">-</span> <span class="n">AzimSun</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="n">ProfileAng</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0D0</span> <span class="o">*</span> <span class="n">ProfileAng</span>
<a name="ln-9101"></a>    <span class="k">END IF</span>
<a name="ln-9102"></a>    <span class="c">! Constrain to 0 to pi</span>
<a name="ln-9103"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ProfileAng</span> <span class="o">&gt;</span> <span class="n">Pi</span><span class="p">)</span> <span class="n">ProfileAng</span> <span class="o">=</span> <span class="mf">2.d0</span> <span class="o">*</span> <span class="n">Pi</span> <span class="o">-</span> <span class="n">ProfileAng</span>
<a name="ln-9104"></a>  <span class="k">END IF</span>
<a name="ln-9105"></a>
<a name="ln-9106"></a><span class="k">  RETURN</span>
<a name="ln-9107"></a>
<a name="ln-9108"></a><span class="k">END SUBROUTINE </span><span class="n">ProfileAngle</span>
<a name="ln-9109"></a>
<a name="ln-9110"></a><span class="k">SUBROUTINE </span><span class="n">DayltgClosestObstruction</span><span class="p">(</span><span class="n">RecPt</span><span class="p">,</span><span class="n">RayVec</span><span class="p">,</span><span class="n">NearestHitSurfNum</span><span class="p">,</span><span class="n">NearestHitPt</span><span class="p">)</span>
<a name="ln-9111"></a>
<a name="ln-9112"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9113"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-9114"></a>          <span class="c">!       DATE WRITTEN   November 2003</span>
<a name="ln-9115"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9116"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9117"></a>
<a name="ln-9118"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9119"></a>          <span class="c">! Determines surface number and hit point of closest exterior obstruction hit</span>
<a name="ln-9120"></a>          <span class="c">! by a ray from a window. If no obstruction is hit, NearestHitSurfNum = 0.</span>
<a name="ln-9121"></a>
<a name="ln-9122"></a>          <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-9123"></a>
<a name="ln-9124"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-9125"></a>
<a name="ln-9126"></a>          <span class="c">! USE STATEMENTS: na</span>
<a name="ln-9127"></a>
<a name="ln-9128"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9129"></a>
<a name="ln-9130"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9131"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">RecPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>           <span class="c">! Point on window from which ray emanates (m)</span>
<a name="ln-9132"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RayVec</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c">! Unit vector along ray pointing away from window (m)</span>
<a name="ln-9133"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NearestHitSurfNum</span>  <span class="c">! Surface number of nearest obstruction that is hit by ray;</span>
<a name="ln-9134"></a>                                             <span class="c">!  = 0 if no obstruction is hit.</span>
<a name="ln-9135"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NearestHitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>    <span class="c">! Ray&#39;s hit point on nearest obstruction (m)</span>
<a name="ln-9136"></a>
<a name="ln-9137"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9138"></a>          <span class="c">! na</span>
<a name="ln-9139"></a>
<a name="ln-9140"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9141"></a>          <span class="c">! na</span>
<a name="ln-9142"></a>
<a name="ln-9143"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9144"></a>          <span class="c">! na</span>
<a name="ln-9145"></a>
<a name="ln-9146"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9147"></a>          <span class="c">! na</span>
<a name="ln-9148"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>           <span class="c">! Hit point on an obstruction (m)</span>
<a name="ln-9149"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHit</span>               <span class="c">! &gt; 0 if obstruction is hit, 0 otherwise</span>
<a name="ln-9150"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ObsSurfNum</span>         <span class="c">! Obstruction surface number</span>
<a name="ln-9151"></a>
<a name="ln-9152"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">TotObstructionsHit</span> <span class="c">! Number of obstructions hit by a ray</span>
<a name="ln-9153"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HitDistance</span>        <span class="c">! Distance from receiving point to hit point for a ray (m)</span>
<a name="ln-9154"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NearestHitDistance</span> <span class="c">! Distance from receiving point to nearest hit point for a ray (m)</span>
<a name="ln-9155"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ObsSurfNumToSkip</span>   <span class="c">! Surface number of obstruction to be ignored</span>
<a name="ln-9156"></a>
<a name="ln-9157"></a>          <span class="c">! FLOW:</span>
<a name="ln-9158"></a>
<a name="ln-9159"></a><span class="n">TotObstructionsHit</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9160"></a><span class="n">NearestHitSurfNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9161"></a><span class="n">NearestHitDistance</span> <span class="o">=</span> <span class="mf">1.d+8</span>
<a name="ln-9162"></a><span class="n">NearestHitPt</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9163"></a><span class="n">ObsSurfNumToSkip</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9164"></a><span class="k">DO </span><span class="n">ObsSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-9165"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfPossibleObstruction</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-9166"></a>  <span class="c">! If a window was hit previously (see below), ObsSurfNumToSkip was set to the window&#39;s base surface in order</span>
<a name="ln-9167"></a>  <span class="c">! to remove that surface from consideration as a hit surface for this ray</span>
<a name="ln-9168"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ObsSurfNum</span> <span class="o">==</span> <span class="n">ObsSurfNumToSkip</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-9169"></a>  <span class="c">! Determine if this ray hits ObsSurfNum (in which case IHit &gt; 0) and, if so, get the</span>
<a name="ln-9170"></a>  <span class="c">! distance from the receiving point to the hit</span>
<a name="ln-9171"></a>  <span class="k">CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">,</span><span class="n">RecPt</span><span class="p">,</span><span class="n">RayVec</span><span class="p">,</span><span class="n">IHit</span><span class="p">,</span><span class="n">HitPt</span><span class="p">)</span>
<a name="ln-9172"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">IHit</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9173"></a>    <span class="c">! If obstruction is a window and its base surface is the nearest obstruction hit so far,</span>
<a name="ln-9174"></a>    <span class="c">! set NearestHitSurfNum to this window. Note that in this case NearestHitDistance has already</span>
<a name="ln-9175"></a>    <span class="c">! been calculated, so does not have to be recalculated.</span>
<a name="ln-9176"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">NearestHitSurfNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9177"></a><span class="k">      </span><span class="n">NearestHitSurfNum</span> <span class="o">=</span> <span class="n">ObsSurfNum</span>
<a name="ln-9178"></a>    <span class="k">ELSE</span>
<a name="ln-9179"></a><span class="k">      </span><span class="n">TotObstructionsHit</span> <span class="o">=</span> <span class="n">TotObstructionsHit</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-9180"></a>      <span class="c">! Distance from receiving point to hit point</span>
<a name="ln-9181"></a>      <span class="n">HitDistance</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">HitPt</span><span class="o">-</span><span class="n">RecPt</span><span class="p">,</span><span class="n">HitPt</span><span class="o">-</span><span class="n">RecPt</span><span class="p">))</span>
<a name="ln-9182"></a>      <span class="c">! Reset NearestHitSurfNum and NearestHitDistance if this hit point is closer than previous closest</span>
<a name="ln-9183"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">HitDistance</span> <span class="o">&lt;</span> <span class="n">NearestHitDistance</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9184"></a><span class="k">        </span><span class="n">NearestHitDistance</span> <span class="o">=</span> <span class="n">HitDistance</span>
<a name="ln-9185"></a>        <span class="n">NearestHitSurfNum</span>  <span class="o">=</span> <span class="n">ObsSurfNum</span>
<a name="ln-9186"></a>        <span class="n">NearestHitPt</span> <span class="o">=</span> <span class="n">HitPt</span>
<a name="ln-9187"></a>      <span class="k">END IF</span>
<a name="ln-9188"></a><span class="k">    END IF</span>
<a name="ln-9189"></a><span class="k">  END IF</span>  <span class="c">! End of check if obstruction was hit</span>
<a name="ln-9190"></a><span class="k">END DO</span>  <span class="c">! End of loop over possible obstructions for this ray</span>
<a name="ln-9191"></a>
<a name="ln-9192"></a><span class="k">RETURN</span>
<a name="ln-9193"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgClosestObstruction</span>
<a name="ln-9194"></a>
<a name="ln-9195"></a><span class="k">SUBROUTINE </span><span class="n">DayltgSurfaceLumFromSun</span><span class="p">(</span><span class="n">IHr</span><span class="p">,</span><span class="n">Ray</span><span class="p">,</span><span class="n">ReflSurfNum</span><span class="p">,</span><span class="n">ReflHitPt</span><span class="p">,</span><span class="n">LumAtReflHitPtFrSun</span><span class="p">)</span>
<a name="ln-9196"></a>
<a name="ln-9197"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9198"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-9199"></a>          <span class="c">!       DATE WRITTEN   November 2003</span>
<a name="ln-9200"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9201"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9202"></a>
<a name="ln-9203"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9204"></a>          <span class="c">! Calculates exterior surface luminance due to beam solar diffuse reflection.</span>
<a name="ln-9205"></a>
<a name="ln-9206"></a>          <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-9207"></a>
<a name="ln-9208"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-9209"></a>
<a name="ln-9210"></a>          <span class="c">! USE STATEMENTS: na</span>
<a name="ln-9211"></a>
<a name="ln-9212"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9213"></a>
<a name="ln-9214"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9215"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IHr</span>                <span class="c">! Hour number</span>
<a name="ln-9216"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Ray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>    <span class="c">! Ray from window to reflecting surface (m)</span>
<a name="ln-9217"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReflSurfNum</span>        <span class="c">! Number of surface for which luminance is being calculated</span>
<a name="ln-9218"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ReflHitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>       <span class="c">! Point on ReflSurfNum for luminance calculation (m)</span>
<a name="ln-9219"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">LumAtReflHitPtFrSun</span> <span class="c">! Luminance at ReflHitPt from beam solar reflection for unit</span>
<a name="ln-9220"></a>                                            <span class="c">!  beam normal illuminance (cd/m2)</span>
<a name="ln-9221"></a>
<a name="ln-9222"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9223"></a>          <span class="c">! na</span>
<a name="ln-9224"></a>
<a name="ln-9225"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9226"></a>          <span class="c">! na</span>
<a name="ln-9227"></a>
<a name="ln-9228"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9229"></a>          <span class="c">! na</span>
<a name="ln-9230"></a>
<a name="ln-9231"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9232"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReflNorm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>        <span class="c">! Unit normal to reflecting surface (m)</span>
<a name="ln-9233"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ObsSurfNum</span>         <span class="c">! Obstruction surface number</span>
<a name="ln-9234"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHitObs</span>            <span class="c">! &gt; 0 if obstruction is hit</span>
<a name="ln-9235"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObsHitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>        <span class="c">! Hit point on obstruction (m)</span>
<a name="ln-9236"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosIncAngAtHitPt</span>   <span class="c">! Cosine of angle of incidence of sun at HitPt</span>
<a name="ln-9237"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DiffVisRefl</span>        <span class="c">! Diffuse visible reflectance of ReflSurfNum</span>
<a name="ln-9238"></a>
<a name="ln-9239"></a>          <span class="c">! FLOW:</span>
<a name="ln-9240"></a>
<a name="ln-9241"></a><span class="n">LumAtReflHitPtFrSun</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9242"></a><span class="c">! Skip daylighting shelves since reflection from these is separately calculated</span>
<a name="ln-9243"></a><span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">Shelf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-9244"></a><span class="c">! Normal to reflecting surface in hemisphere containing window element</span>
<a name="ln-9245"></a><span class="n">ReflNorm</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span>
<a name="ln-9246"></a><span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9247"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">ReflNorm</span><span class="p">,</span><span class="n">Ray</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">ReflNorm</span> <span class="o">=</span> <span class="o">-</span><span class="n">ReflNorm</span>
<a name="ln-9248"></a><span class="k">END IF</span>
<a name="ln-9249"></a><span class="c">! Cosine of angle of incidence of sun at HitPt if sun were to reach HitPt</span>
<a name="ln-9250"></a><span class="n">CosIncAngAtHitPt</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">ReflNorm</span><span class="p">,</span><span class="n">SunCosHr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">IHr</span><span class="p">))</span>
<a name="ln-9251"></a><span class="c">! Require that the sun be in front of this surface relative to window element</span>
<a name="ln-9252"></a><span class="k">IF</span><span class="p">(</span><span class="n">CosIncAngAtHitPt</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">RETURN</span>  <span class="c">! Sun is in back of reflecting surface</span>
<a name="ln-9253"></a><span class="c">! Sun reaches ReflHitPt if vector from ReflHitPt to sun is unobstructed</span>
<a name="ln-9254"></a><span class="n">IHitObs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9255"></a><span class="k">DO </span><span class="n">ObsSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-9256"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfPossibleObstruction</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-9257"></a>  <span class="c">! Exclude as a possible obstructor ReflSurfNum and its base surface (if it has one)</span>
<a name="ln-9258"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ObsSurfNum</span> <span class="o">==</span> <span class="n">ReflSurfNum</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ObsSurfNum</span> <span class="o">==</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-9259"></a><span class="k">  CALL </span><span class="n">DayltgPierceSurface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">,</span><span class="n">ReflHitPt</span><span class="p">,</span><span class="n">SunCosHr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">IHr</span><span class="p">),</span><span class="n">IHitObs</span><span class="p">,</span><span class="n">ObsHitPt</span><span class="p">)</span>
<a name="ln-9260"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-9261"></a><span class="k">END DO</span>
<a name="ln-9262"></a><span class="k">IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>  <span class="c">! Obstruction was hit, blocking sun</span>
<a name="ln-9263"></a><span class="c">! Obstruction was not hit; sun reaches ReflHitPt.</span>
<a name="ln-9264"></a><span class="c">! Calculate luminance at ReflHitPt due to beam solar reflection (for unit beam normal illuminance)</span>
<a name="ln-9265"></a><span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9266"></a><span class="k">  </span><span class="n">DiffVisRefl</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfDiffuseVisRefl</span>
<a name="ln-9267"></a>  <span class="c">! Note that if the shadowing surface has a non-zero glazing fraction (e.g., neighboring bldg) that the above is</span>
<a name="ln-9268"></a>  <span class="c">! (1 - glazing fraction) * (vis refl of opaque part of shadowing surface); specular reflection is</span>
<a name="ln-9269"></a>  <span class="c">! excluded in this value of DiffVisRefl.</span>
<a name="ln-9270"></a><span class="k">ELSE</span>  <span class="c">! Exterior building surface</span>
<a name="ln-9271"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9272"></a><span class="k">    </span><span class="n">DiffVisRefl</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">OutsideAbsorpSolar</span>
<a name="ln-9273"></a>  <span class="k">ELSE</span>
<a name="ln-9274"></a>    <span class="c">! Window; assume bare so no beam-to-diffuse reflection</span>
<a name="ln-9275"></a>    <span class="n">DiffVisRefl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9276"></a>  <span class="k">END IF</span>
<a name="ln-9277"></a><span class="k">END IF</span>
<a name="ln-9278"></a><span class="n">LumAtReflHitPtFrSun</span> <span class="o">=</span> <span class="n">CosIncAngAtHitPt</span> <span class="o">*</span> <span class="n">DiffVisRefl</span> <span class="o">/</span> <span class="n">Pi</span>
<a name="ln-9279"></a>
<a name="ln-9280"></a><span class="k">RETURN</span>
<a name="ln-9281"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgSurfaceLumFromSun</span>
<a name="ln-9282"></a>
<a name="ln-9283"></a><span class="k">SUBROUTINE </span><span class="n">DayltgInteriorMapIllum</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-9284"></a>
<a name="ln-9285"></a><span class="c">! *****super modified version of DayltgInteriorIllum by Peter Graham Ellis</span>
<a name="ln-9286"></a><span class="c">! *****removes all control code, just calculates illum and glare with previously determined control settings</span>
<a name="ln-9287"></a><span class="c">! *****this should be packaged into a subroutine called from 2 places</span>
<a name="ln-9288"></a>
<a name="ln-9289"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9290"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-9291"></a>          <span class="c">!       DATE WRITTEN   July 1997</span>
<a name="ln-9292"></a>          <span class="c">!       MODIFIED       March 2000, FW: interpolate clear-sky daylight factors using</span>
<a name="ln-9293"></a>          <span class="c">!                      HourOfDay/WeightNow and NextHour/WeightNextHour. Previously</span>
<a name="ln-9294"></a>          <span class="c">!                      only HourOfDay was used</span>
<a name="ln-9295"></a>          <span class="c">!                      Jan 2001, FW: interpolate in slat angle for windows with blinds</span>
<a name="ln-9296"></a>          <span class="c">!                      that have movable slats</span>
<a name="ln-9297"></a>          <span class="c">!                      Dec 2003, FW: fix bug--even though between-glass shade/blind is on</span>
<a name="ln-9298"></a>          <span class="c">!                        daylight illum at ref pt was calculated as though it was off</span>
<a name="ln-9299"></a>          <span class="c">!                      June 2009, TH: modified for thermochromic windows</span>
<a name="ln-9300"></a>          <span class="c">!                      March 2010, TH: fix bug (CR 8057) for electrochromic windows</span>
<a name="ln-9301"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9302"></a>
<a name="ln-9303"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9304"></a>          <span class="c">! Using daylighting factors and exterior illuminance, determine</span>
<a name="ln-9305"></a>          <span class="c">! the current-hour interior daylight illuminance and glare index</span>
<a name="ln-9306"></a>          <span class="c">! at each reference point in a space.</span>
<a name="ln-9307"></a>
<a name="ln-9308"></a>          <span class="c">! Called by InitSurfaceHeatBalance.</span>
<a name="ln-9309"></a>
<a name="ln-9310"></a>          <span class="c">! METHODOLOGY EMPLOYED:na</span>
<a name="ln-9311"></a>
<a name="ln-9312"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9313"></a>          <span class="c">! Based on DOE-2.1E subroutine DINTIL.</span>
<a name="ln-9314"></a>
<a name="ln-9315"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9316"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">POLYF</span><span class="p">,</span> <span class="n">InterpSlatAng</span>
<a name="ln-9317"></a>
<a name="ln-9318"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9319"></a>
<a name="ln-9320"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9321"></a><span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ZoneNum</span>               <span class="c">! Zone number</span>
<a name="ln-9322"></a>
<a name="ln-9323"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9324"></a>          <span class="c">! na</span>
<a name="ln-9325"></a>
<a name="ln-9326"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9327"></a>          <span class="c">! na</span>
<a name="ln-9328"></a>
<a name="ln-9329"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9330"></a>          <span class="c">! na</span>
<a name="ln-9331"></a>
<a name="ln-9332"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9333"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NREFPT</span>                <span class="c">! Number of daylighting map reference points</span>
<a name="ln-9334"></a><span class="c">!INTEGER   :: REFPT1                ! 1st reference point</span>
<a name="ln-9335"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ISky</span>                  <span class="c">! Sky type index</span>
<a name="ln-9336"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ISky1</span><span class="p">,</span> <span class="n">ISky2</span>          <span class="c">! Sky type index values for averaging two sky types</span>
<a name="ln-9337"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DFSKHR</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>          <span class="c">! Sky daylight factor for sky type (first index),</span>
<a name="ln-9338"></a>                                   <span class="c">!   bare/shaded window (second index)</span>
<a name="ln-9339"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DFSUHR</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>            <span class="c">! Sun daylight factor for bare/shaded window</span>
<a name="ln-9340"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BFSKHR</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>          <span class="c">! Sky background luminance factor for sky type (first index),</span>
<a name="ln-9341"></a>                                   <span class="c">!   bare/shaded window (second index)</span>
<a name="ln-9342"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BFSUHR</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>            <span class="c">! Sun background luminance factor for bare/shaded window</span>
<a name="ln-9343"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SFSKHR</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>          <span class="c">! Sky source luminance factor for sky type (first index),</span>
<a name="ln-9344"></a>                                   <span class="c">!   bare/shaded window (second index)</span>
<a name="ln-9345"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SFSUHR</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>            <span class="c">! Sun source luminance factor for bare/shaded window</span>
<a name="ln-9346"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IL</span>                    <span class="c">! Reference point index</span>
<a name="ln-9347"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IWin</span>                  <span class="c">! Window index</span>
<a name="ln-9348"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="k">IS</span>                    <span class="c">! IS=1 for unshaded window, =2 for shaded window</span>
<a name="ln-9349"></a><span class="c">!INTEGER   :: ISWFLG                ! Switchable glazing flag: =1 if one or more windows in a zone</span>
<a name="ln-9350"></a><span class="c">!                                   !  has switchable glazing that adjusts visible transmittance to just meet</span>
<a name="ln-9351"></a><span class="c">!                                   !  daylighting setpoint; =0 otherwise.</span>
<a name="ln-9352"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ICtrl</span>                 <span class="c">! Window shading control pointer</span>
<a name="ln-9353"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyWeight</span>             <span class="c">! Weighting factor used to average two different sky types</span>
<a name="ln-9354"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HorIllSky</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>          <span class="c">! Horizontal illuminance for different sky types</span>
<a name="ln-9355"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HorIllSkyFac</span>          <span class="c">! Ratio between horizontal illuminance from sky horizontal irradiance and</span>
<a name="ln-9356"></a>                                   <span class="c">!   luminous efficacy and horizontal illuminance from averaged sky</span>
<a name="ln-9357"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SlatAng</span>               <span class="c">! Blind slat angle (rad)</span>
<a name="ln-9358"></a><span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">VarSlats</span>              <span class="c">! True if slats are movable, i.e., variable angle</span>
<a name="ln-9359"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">loop</span>                  <span class="c">! Window loop index</span>
<a name="ln-9360"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GTOT</span>
<a name="ln-9361"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GTOT1</span>
<a name="ln-9362"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GTOT2</span>
<a name="ln-9363"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DaylIllum</span>
<a name="ln-9364"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">BACLUM</span>
<a name="ln-9365"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">GLRNDX</span>
<a name="ln-9366"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">FirstTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9367"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ILB</span>
<a name="ln-9368"></a>
<a name="ln-9369"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IConst</span>
<a name="ln-9370"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VTRatio</span>
<a name="ln-9371"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VTNow</span>
<a name="ln-9372"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VTMaster</span>
<a name="ln-9373"></a>
<a name="ln-9374"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VTDark</span> <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! Visible transmittance (VT) of electrochromic (EC) windows in fully dark state</span>
<a name="ln-9375"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VTMULT</span> <span class="o">=</span> <span class="mf">1.0d0</span>         <span class="c">! VT multiplier for EC windows</span>
<a name="ln-9376"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IConstShaded</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c">! The shaded window construction for switchable windows</span>
<a name="ln-9377"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MapNum</span>
<a name="ln-9378"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ILM</span>
<a name="ln-9379"></a>
<a name="ln-9380"></a>
<a name="ln-9381"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FirstTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9382"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">DaylIllum</span><span class="p">(</span><span class="n">MaxMapRefPoints</span><span class="p">))</span>
<a name="ln-9383"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">BACLUM</span><span class="p">(</span><span class="n">MaxMapRefPoints</span><span class="p">))</span>
<a name="ln-9384"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">GLRNDX</span><span class="p">(</span><span class="n">MaxMapRefPoints</span><span class="p">))</span>
<a name="ln-9385"></a>    <span class="n">FirstTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9386"></a>  <span class="n">ENDIF</span>
<a name="ln-9387"></a>
<a name="ln-9388"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WarmUpFlag</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-9389"></a><span class="c">!              Initialize reference point illuminance and window background luminance</span>
<a name="ln-9390"></a>
<a name="ln-9391"></a>  <span class="k">DO </span><span class="n">ILM</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MapCount</span>
<a name="ln-9392"></a>
<a name="ln-9393"></a>    <span class="n">MapNum</span><span class="o">=</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ZoneToMap</span><span class="p">(</span><span class="n">ILM</span><span class="p">)</span>
<a name="ln-9394"></a><span class="c">!    IllumMapCalc(MapNum)%DaylIllumAtMapPt  = 0.0</span>
<a name="ln-9395"></a><span class="c">!    IllumMapCalc(MapNum)%GlareIndexAtMapPt = 0.0</span>
<a name="ln-9396"></a>    <span class="n">NREFPT</span> <span class="o">=</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">TotalMapRefPoints</span>
<a name="ln-9397"></a>
<a name="ln-9398"></a>    <span class="n">DaylIllum</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9399"></a>    <span class="n">BACLUM</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9400"></a>    <span class="n">GLRNDX</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9401"></a>
<a name="ln-9402"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SkyClearness</span> <span class="o">&gt;</span> <span class="mf">3.0d0</span><span class="p">)</span> <span class="k">THEN</span>       <span class="c">!Sky is average of clear and clear turbid</span>
<a name="ln-9403"></a>      <span class="n">SkyWeight</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,(</span><span class="n">SkyClearness</span><span class="o">-</span><span class="mf">3.d0</span><span class="p">)</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">)</span>
<a name="ln-9404"></a>      <span class="n">ISky1</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-9405"></a>      <span class="n">ISky2</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-9406"></a>    <span class="k">ELSE IF</span><span class="p">(</span><span class="n">SkyClearness</span> <span class="o">&gt;</span> <span class="mf">1.2d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!Sky is average of clear turbid and intermediate</span>
<a name="ln-9407"></a>      <span class="n">SkyWeight</span> <span class="o">=</span> <span class="p">(</span><span class="n">SkyClearness</span> <span class="o">-</span> <span class="mf">1.2d0</span><span class="p">)</span><span class="o">/</span><span class="mf">1.8d0</span>
<a name="ln-9408"></a>      <span class="n">ISky1</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-9409"></a>      <span class="n">ISky2</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-9410"></a>    <span class="k">ELSE</span>                              <span class="c">!Sky is average of intermediate and overcast</span>
<a name="ln-9411"></a>      <span class="n">SkyWeight</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">SkyClearness</span><span class="o">-</span><span class="mf">1.d0</span><span class="p">)</span><span class="o">/</span><span class="mf">0.2d0</span><span class="p">,</span> <span class="p">(</span><span class="n">SkyBrightness</span><span class="o">-</span><span class="mf">0.05d0</span><span class="p">)</span><span class="o">/</span><span class="mf">0.4d0</span><span class="p">))</span>
<a name="ln-9412"></a>      <span class="n">ISky1</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-9413"></a>      <span class="n">ISky2</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-9414"></a>    <span class="k">END IF</span>
<a name="ln-9415"></a>
<a name="ln-9416"></a><span class="c">!              First loop over windows in this space.</span>
<a name="ln-9417"></a><span class="c">!              Find contribution of each window to the daylight illum</span>
<a name="ln-9418"></a><span class="c">!              and to the glare numerator at each reference point.</span>
<a name="ln-9419"></a><span class="c">!              Use shading flags set in WindowShadingManager.</span>
<a name="ln-9420"></a>
<a name="ln-9421"></a>    <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span>
<a name="ln-9422"></a>      <span class="n">IWin</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-9423"></a>
<a name="ln-9424"></a>      <span class="c">! Added TH 6/29/2009 for thermochromic windows</span>
<a name="ln-9425"></a>      <span class="n">VTRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9426"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NREFPT</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9427"></a><span class="k">        </span><span class="n">IConst</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-9428"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TCFlag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9429"></a>          <span class="c">! For thermochromic windows, daylight and glare factors are always calculated</span>
<a name="ln-9430"></a>          <span class="c">!  based on the master construction. They need to be adjusted by the VTRatio, including:</span>
<a name="ln-9431"></a>          <span class="c">!  ZoneDaylight()%DaylIllFacSky, DaylIllFacSun, DaylIllFacSunDisk; DaylBackFacSky,</span>
<a name="ln-9432"></a>          <span class="c">!  DaylBackFacSun, DaylBackFacSunDisk, DaylSourceFacSky, DaylSourceFacSun, DaylSourceFacSunDisk</span>
<a name="ln-9433"></a>          <span class="n">VTNow</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-9434"></a>          <span class="n">VTMaster</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TCMasterConst</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-9435"></a>          <span class="n">VTRatio</span> <span class="o">=</span> <span class="n">VTNow</span> <span class="o">/</span> <span class="n">VTMaster</span>
<a name="ln-9436"></a>        <span class="n">ENDIF</span>
<a name="ln-9437"></a>      <span class="n">ENDIF</span>
<a name="ln-9438"></a>
<a name="ln-9439"></a><span class="c">!              Loop over reference points</span>
<a name="ln-9440"></a>      <span class="k">DO </span><span class="n">ILB</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-9441"></a>
<a name="ln-9442"></a><span class="c">!          Daylight factors for current sun position</span>
<a name="ln-9443"></a>        <span class="k">DO </span><span class="n">ISky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-9444"></a><span class="c">!                                ===Bare window===</span>
<a name="ln-9445"></a>          <span class="n">DFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9446"></a>                           <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-9447"></a>
<a name="ln-9448"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9449"></a><span class="k">            </span><span class="n">DFSUHR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span> <span class="n">WeightNow</span> <span class="o">*</span> <span class="p">(</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-9450"></a>                                                  <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9451"></a>                                    <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="p">(</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-9452"></a>                                                           <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-9453"></a>          <span class="n">ENDIF</span>
<a name="ln-9454"></a>
<a name="ln-9455"></a>          <span class="n">BFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9456"></a>                               <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-9457"></a>
<a name="ln-9458"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9459"></a><span class="k">            </span><span class="n">BFSUHR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="p">(</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-9460"></a>                                                 <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="p">)</span> <span class="o">+</span><span class="p">&amp;</span>
<a name="ln-9461"></a>                                   <span class="n">WeightPreviousHour</span> <span class="o">*</span>  <span class="p">(</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-9462"></a>                                                           <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-9463"></a>          <span class="n">ENDIF</span>
<a name="ln-9464"></a>
<a name="ln-9465"></a>          <span class="n">SFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9466"></a>                             <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-9467"></a>
<a name="ln-9468"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9469"></a><span class="k">            </span><span class="n">SFSUHR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="p">(</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-9470"></a>                                                 <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9471"></a>                                   <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="p">(</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-9472"></a>                                                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-9473"></a>          <span class="n">ENDIF</span>
<a name="ln-9474"></a>
<a name="ln-9475"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9476"></a>
<a name="ln-9477"></a><span class="c">!                                 ===Shaded window===</span>
<a name="ln-9478"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9479"></a>              <span class="c">! Shade, screen, blind with fixed slats, or diffusing glass</span>
<a name="ln-9480"></a>              <span class="n">DFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9481"></a>                                          <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9482"></a>
<a name="ln-9483"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9484"></a><span class="k">                </span><span class="n">DFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-9485"></a>                              <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-9486"></a>
<a name="ln-9487"></a>                <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9488"></a><span class="k">                    </span><span class="n">DFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">VTRatio</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-9489"></a>                       <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9490"></a>                        <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-9491"></a>                <span class="n">ENDIF</span>
<a name="ln-9492"></a>              <span class="k">END IF</span>
<a name="ln-9493"></a>
<a name="ln-9494"></a><span class="k">              </span><span class="n">BFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9495"></a>                                 <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-9496"></a>
<a name="ln-9497"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9498"></a><span class="k">                </span><span class="n">BFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-9499"></a>                              <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-9500"></a>                <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9501"></a><span class="k">                  </span><span class="n">BFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">BFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">VTRatio</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-9502"></a>                     <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9503"></a>                      <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-9504"></a>                <span class="n">ENDIF</span>
<a name="ln-9505"></a>              <span class="k">END IF</span>
<a name="ln-9506"></a>
<a name="ln-9507"></a><span class="k">              </span><span class="n">SFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-9508"></a>                   <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9509"></a>                    <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-9510"></a>
<a name="ln-9511"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9512"></a><span class="k">                </span><span class="n">SFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-9513"></a>                     <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-9514"></a>                      <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-9515"></a>                <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9516"></a><span class="k">                  </span><span class="n">SFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">SFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">VTRatio</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-9517"></a>                       <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9518"></a>                        <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">))</span>
<a name="ln-9519"></a>                <span class="n">ENDIF</span>
<a name="ln-9520"></a>              <span class="k">END IF</span>
<a name="ln-9521"></a>
<a name="ln-9522"></a><span class="k">            ELSE</span>  <span class="c">! Blind with movable slats</span>
<a name="ln-9523"></a>              <span class="n">VarSlats</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">MovableSlats</span>
<a name="ln-9524"></a>              <span class="n">SlatAng</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SlatAngThisTs</span>
<a name="ln-9525"></a>
<a name="ln-9526"></a>              <span class="n">DFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-9527"></a>                 <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9528"></a>                               <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9529"></a>                  <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9530"></a>                                 <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-9531"></a>
<a name="ln-9532"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9533"></a><span class="k">                </span><span class="n">DFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-9534"></a>                   <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9535"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9536"></a>                    <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9537"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-9538"></a>
<a name="ln-9539"></a>                  <span class="c">! We add the contribution from the solar disk if slats do not block beam solar</span>
<a name="ln-9540"></a>                  <span class="c">! TH CR 8010, DaylIllFacSunDisk needs to be interpolated</span>
<a name="ln-9541"></a>                  <span class="c">!IF(.NOT.SurfaceWindow(IWin)%SlatsBlockBeam) DFSUHR(2) = DFSUHR(2) + &amp;</span>
<a name="ln-9542"></a>                  <span class="c">!  VTRatio * (WeightNow * ZoneDaylight(ZoneNum)%DaylIllFacSunDisk(loop,ILB,2,HourOfDay) + &amp;</span>
<a name="ln-9543"></a>                  <span class="c">!            WeightPreviousHour * ZoneDaylight(ZoneNum)%DaylIllFacSunDisk(loop,ILB,2,PreviousHour))</span>
<a name="ln-9544"></a>                <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9545"></a><span class="k">                  </span><span class="n">DFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">DFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9546"></a>                         <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9547"></a>                              <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9548"></a>                          <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9549"></a>                              <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-9550"></a>                <span class="n">ENDIF</span>
<a name="ln-9551"></a>              <span class="k">END IF</span>
<a name="ln-9552"></a>
<a name="ln-9553"></a><span class="k">              </span><span class="n">BFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-9554"></a>                 <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9555"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9556"></a>                  <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9557"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-9558"></a>
<a name="ln-9559"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9560"></a><span class="k">                </span><span class="n">BFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-9561"></a>                   <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9562"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9563"></a>                    <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9564"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-9565"></a>
<a name="ln-9566"></a>                  <span class="c">! TH CR 8010, DaylBackFacSunDisk needs to be interpolated</span>
<a name="ln-9567"></a>                <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9568"></a><span class="k">                  </span><span class="n">BFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">BFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9569"></a>                     <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9570"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9571"></a>                      <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9572"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-9573"></a>                <span class="n">ENDIF</span>
<a name="ln-9574"></a>              <span class="k">END IF</span>
<a name="ln-9575"></a>
<a name="ln-9576"></a><span class="k">              </span><span class="n">SFSKHR</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-9577"></a>                 <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9578"></a>                           <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9579"></a>                  <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9580"></a>                           <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="n">ISky</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-9581"></a>
<a name="ln-9582"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ISky</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9583"></a><span class="k">                </span><span class="n">SFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">VTRatio</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-9584"></a>                   <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9585"></a>                         <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9586"></a>                    <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9587"></a>                         <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-9588"></a>
<a name="ln-9589"></a>                  <span class="c">! TH CR 8010, DaylSourceFacSunDisk needs to be interpolated</span>
<a name="ln-9590"></a>                <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9591"></a><span class="k">                  </span><span class="n">SFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">SFSUHR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">VTRatio</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9592"></a>                     <span class="p">(</span><span class="n">WeightNow</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9593"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9594"></a>                      <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9595"></a>                          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span><span class="n">ILB</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)))</span>
<a name="ln-9596"></a>                <span class="n">ENDIF</span>
<a name="ln-9597"></a>              <span class="k">END IF</span>
<a name="ln-9598"></a>
<a name="ln-9599"></a><span class="k">            END IF</span> <span class="c">! End of check if window has blind with movable slats</span>
<a name="ln-9600"></a>
<a name="ln-9601"></a>          <span class="n">ENDIF</span>  <span class="c">! End of check if window is shaded or has diffusing glass</span>
<a name="ln-9602"></a>
<a name="ln-9603"></a>        <span class="k">END DO</span>
<a name="ln-9604"></a>
<a name="ln-9605"></a><span class="c">!              Get illuminance at ref point from bare and shaded window by</span>
<a name="ln-9606"></a><span class="c">!              multiplying daylight factors by exterior horizontal illuminance</span>
<a name="ln-9607"></a>
<a name="ln-9608"></a><span class="c">! Adding 0.001 in the following prevents zero HorIllSky in early morning or late evening when sun</span>
<a name="ln-9609"></a><span class="c">! is up in the present time step but GILSK(ISky,HourOfDay) and GILSK(ISky,NextHour) are both zero.</span>
<a name="ln-9610"></a>        <span class="k">DO </span><span class="n">ISky</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-9611"></a>          <span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky</span><span class="p">)</span> <span class="o">=</span> <span class="n">WeightNow</span> <span class="o">*</span> <span class="n">GILSK</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">+</span> <span class="n">WeightPreviousHour</span> <span class="o">*</span> <span class="n">GILSK</span><span class="p">(</span><span class="n">ISky</span><span class="p">,</span><span class="n">PreviousHour</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.001d0</span>
<a name="ln-9612"></a>        <span class="k">END DO</span>
<a name="ln-9613"></a>
<a name="ln-9614"></a>    <span class="c">! HISKF is current time step horizontal illuminance from sky, calculated in DayltgLuminousEfficacy,</span>
<a name="ln-9615"></a>    <span class="c">! which is called in WeatherManager. HISUNF is current time step horizontal illuminance from sun,</span>
<a name="ln-9616"></a>    <span class="c">! also calculated in DayltgLuminousEfficacy.</span>
<a name="ln-9617"></a>        <span class="n">HorIllSkyFac</span> <span class="o">=</span> <span class="n">HISKF</span><span class="o">/</span><span class="p">((</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">SkyWeight</span><span class="p">)</span><span class="o">*</span><span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky2</span><span class="p">)</span> <span class="o">+</span> <span class="n">SkyWeight</span><span class="o">*</span><span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky1</span><span class="p">))</span>
<a name="ln-9618"></a>
<a name="ln-9619"></a>        <span class="k">DO IS</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<a name="ln-9620"></a>          <span class="k">IF</span><span class="p">(</span><span class="k">IS</span> <span class="o">==</span> <span class="mf">2.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span><span class="o">&lt;=</span><span class="mf">0.</span><span class="nb">AND</span><span class="p">..</span><span class="nb">not</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-9621"></a>
<a name="ln-9622"></a><span class="k">          </span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">IllumFromWinAtMapPt</span><span class="p">(</span><span class="n">ILB</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-9623"></a>            <span class="n">DFSUHR</span><span class="p">(</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="n">HISUNF</span> <span class="o">+</span> <span class="n">HorIllSkyFac</span> <span class="o">*</span> <span class="p">(</span><span class="n">DFSKHR</span><span class="p">(</span><span class="n">ISky1</span><span class="p">,</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="n">SkyWeight</span><span class="o">*</span><span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9624"></a>                                <span class="n">DFSKHR</span><span class="p">(</span><span class="n">ISky2</span><span class="p">,</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SkyWeight</span><span class="p">)</span><span class="o">*</span><span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky2</span><span class="p">))</span>
<a name="ln-9625"></a>
<a name="ln-9626"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtMapPt</span><span class="p">(</span><span class="n">ILB</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-9627"></a>            <span class="n">BFSUHR</span><span class="p">(</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="n">HISUNF</span> <span class="o">+</span> <span class="n">HorIllSkyFac</span> <span class="o">*</span> <span class="p">(</span><span class="n">BFSKHR</span><span class="p">(</span><span class="n">ISky1</span><span class="p">,</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="n">SkyWeight</span><span class="o">*</span><span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9628"></a>                                <span class="n">BFSKHR</span><span class="p">(</span><span class="n">ISky2</span><span class="p">,</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SkyWeight</span><span class="p">)</span><span class="o">*</span><span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky2</span><span class="p">))</span>
<a name="ln-9629"></a>
<a name="ln-9630"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtMapPt</span><span class="p">(</span><span class="n">ILB</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-9631"></a>            <span class="n">SFSUHR</span><span class="p">(</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="n">HISUNF</span> <span class="o">+</span> <span class="n">HorIllSkyFac</span> <span class="o">*</span> <span class="p">(</span><span class="n">SFSKHR</span><span class="p">(</span><span class="n">ISky1</span><span class="p">,</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="n">SkyWeight</span><span class="o">*</span><span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9632"></a>                                <span class="n">SFSKHR</span><span class="p">(</span><span class="n">ISky2</span><span class="p">,</span><span class="k">IS</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SkyWeight</span><span class="p">)</span><span class="o">*</span><span class="n">HorIllSky</span><span class="p">(</span><span class="n">ISky2</span><span class="p">))</span>
<a name="ln-9633"></a>          <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtMapPt</span><span class="p">(</span><span class="n">ILB</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-9634"></a>              <span class="nb">MAX</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtMapPt</span><span class="p">(</span><span class="n">ILB</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">),</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-9635"></a>        <span class="n">ENDDO</span>
<a name="ln-9636"></a>
<a name="ln-9637"></a>      <span class="n">ENDDO</span>  <span class="c">! End of reference point loop</span>
<a name="ln-9638"></a>    <span class="n">ENDDO</span>  <span class="c">! End of first loop over windows</span>
<a name="ln-9639"></a>
<a name="ln-9640"></a><span class="c">!              Second loop over windows. Find total daylight illuminance</span>
<a name="ln-9641"></a><span class="c">!              and background luminance for each ref pt from all windows in</span>
<a name="ln-9642"></a><span class="c">!              the space.  Use shading flags.</span>
<a name="ln-9643"></a>
<a name="ln-9644"></a>    <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span>
<a name="ln-9645"></a>      <span class="n">IWin</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-9646"></a>
<a name="ln-9647"></a>      <span class="k">IS</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-9648"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9649"></a>           <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">IS</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-9650"></a>
<a name="ln-9651"></a>      <span class="c">! CR 8057. 3/17/2010.</span>
<a name="ln-9652"></a>      <span class="c">! Switchable windows may be in partially switched state rather than fully dark state</span>
<a name="ln-9653"></a>      <span class="n">VTMULT</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9654"></a>
<a name="ln-9655"></a>      <span class="n">ICtrl</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span>
<a name="ln-9656"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ICtrl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9657"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ICtrl</span><span class="p">)%</span><span class="n">ShadingControlType</span> <span class="o">==</span> <span class="n">WSCT_MeetDaylIlumSetp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9658"></a>            <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9659"></a>          <span class="c">! switchable windows in partial or fully switched state,</span>
<a name="ln-9660"></a>          <span class="c">!  get its intermediate VT calculated in DayltgInteriorIllum</span>
<a name="ln-9661"></a>          <span class="n">IConstShaded</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-9662"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IConstShaded</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">VTDark</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConstShaded</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9663"></a>                                         <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-9664"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">VTDark</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">VTMULT</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">VisTransSelected</span> <span class="o">/</span> <span class="n">VTDark</span>
<a name="ln-9665"></a>        <span class="n">ENDIF</span>
<a name="ln-9666"></a>      <span class="n">ENDIF</span>
<a name="ln-9667"></a>
<a name="ln-9668"></a>      <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-9669"></a><span class="c">!              Determine if illuminance contribution is from bare or shaded window</span>
<a name="ln-9670"></a>        <span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">+</span> <span class="n">VTMULT</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">IllumFromWinAtMapPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-9671"></a>        <span class="n">BACLUM</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">BACLUM</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">+</span> <span class="n">VTMULT</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtMapPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-9672"></a>      <span class="k">END DO</span>
<a name="ln-9673"></a>
<a name="ln-9674"></a><span class="k">    END DO</span>  <span class="c">! End of second window loop</span>
<a name="ln-9675"></a>
<a name="ln-9676"></a><span class="c">!              Calculate glare index at each reference point</span>
<a name="ln-9677"></a>    <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-9678"></a><span class="c">!        Following code taken directly from DayltgGlare ... duplicate calculation</span>
<a name="ln-9679"></a>       <span class="c">! Initialize glare constant</span>
<a name="ln-9680"></a>      <span class="n">GTOT</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9681"></a>
<a name="ln-9682"></a>      <span class="c">! Loop over exterior windows associated with zone</span>
<a name="ln-9683"></a>      <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span>
<a name="ln-9684"></a>        <span class="n">IWin</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-9685"></a>        <span class="k">IS</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-9686"></a>        <span class="k">IF</span><span class="p">((</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9687"></a>            <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">IS</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-9688"></a>
<a name="ln-9689"></a>        <span class="c">! CR 8057. 3/17/2010</span>
<a name="ln-9690"></a>        <span class="n">VTMULT</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9691"></a>
<a name="ln-9692"></a>        <span class="n">ICtrl</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span>
<a name="ln-9693"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ICtrl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9694"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">ICtrl</span><span class="p">)%</span><span class="n">ShadingControlType</span> <span class="o">==</span> <span class="n">WSCT_MeetDaylIlumSetp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9695"></a>              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9696"></a>            <span class="c">! switchable windows in partial or fully switched state,</span>
<a name="ln-9697"></a>            <span class="c">!  get its intermediate VT calculated in DayltgInteriorIllum</span>
<a name="ln-9698"></a>            <span class="n">IConstShaded</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-9699"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IConstShaded</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">VTDark</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConstShaded</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9700"></a>                                           <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-9701"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VTDark</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">VTMULT</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">VisTransSelected</span> <span class="o">/</span> <span class="n">VTDark</span>
<a name="ln-9702"></a>          <span class="n">ENDIF</span>
<a name="ln-9703"></a>        <span class="n">ENDIF</span>
<a name="ln-9704"></a>
<a name="ln-9705"></a>        <span class="c">! Conversion from ft-L to cd/m2, with cd/m2 = 0.2936 ft-L, gives the 0.4794 factor</span>
<a name="ln-9706"></a>        <span class="c">! below, which is (0.2936)**0.6</span>
<a name="ln-9707"></a>        <span class="n">GTOT1</span>  <span class="o">=</span> <span class="mf">0.4794d0</span><span class="o">*</span><span class="p">((</span><span class="n">VTMULT</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtMapPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">))</span><span class="o">**</span><span class="mf">1.6d0</span><span class="p">)</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-9708"></a>                        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SolidAngAtMapPtWtd</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span><span class="o">**</span><span class="mf">0.8d0</span>
<a name="ln-9709"></a>        <span class="n">GTOT2</span>  <span class="o">=</span> <span class="n">BACLUM</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.07d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SolidAngAtMapPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-9710"></a>                        <span class="n">VTMULT</span> <span class="o">*</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtMapPt</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="k">IS</span><span class="p">,</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-9711"></a>        <span class="n">GTOT</span> <span class="o">=</span> <span class="n">GTOT</span> <span class="o">+</span> <span class="n">GTOT1</span> <span class="o">/</span> <span class="p">(</span><span class="n">GTOT2</span> <span class="o">+</span> <span class="mf">0.000001d0</span><span class="p">)</span>
<a name="ln-9712"></a>      <span class="k">END DO</span>
<a name="ln-9713"></a>
<a name="ln-9714"></a>      <span class="c">! Glare index (adding 0.000001 prevents LOG10 (0))</span>
<a name="ln-9715"></a>      <span class="n">GLRNDX</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span><span class="o">*</span><span class="n">LOG10</span><span class="p">(</span><span class="n">GTOT</span><span class="o">+</span><span class="mf">0.000001d0</span><span class="p">)</span>
<a name="ln-9716"></a>      <span class="c">! Set glare index to zero for GTOT &lt; 1</span>
<a name="ln-9717"></a>      <span class="n">GLRNDX</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">GLRNDX</span><span class="p">(</span><span class="n">IL</span><span class="p">))</span>
<a name="ln-9718"></a>    <span class="n">ENDDO</span>
<a name="ln-9719"></a>
<a name="ln-9720"></a><span class="c">!              Variables for reporting</span>
<a name="ln-9721"></a>    <span class="k">DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NREFPT</span>
<a name="ln-9722"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllumAtMapPt</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">DaylIllum</span><span class="p">(</span><span class="n">IL</span><span class="p">),</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-9723"></a>      <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">GlareIndexAtMapPt</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span> <span class="o">=</span> <span class="n">GLRNDX</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span>
<a name="ln-9724"></a>    <span class="n">ENDDO</span>
<a name="ln-9725"></a>  <span class="n">ENDDO</span>
<a name="ln-9726"></a>
<a name="ln-9727"></a>  <span class="k">RETURN</span>
<a name="ln-9728"></a>
<a name="ln-9729"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgInteriorMapIllum</span>
<a name="ln-9730"></a>
<a name="ln-9731"></a>
<a name="ln-9732"></a><span class="k">SUBROUTINE </span><span class="n">ReportIllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)</span>
<a name="ln-9733"></a>
<a name="ln-9734"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9735"></a>          <span class="c">!       AUTHOR         Peter Ellis</span>
<a name="ln-9736"></a>          <span class="c">!       DATE WRITTEN   May 2003</span>
<a name="ln-9737"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9738"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9739"></a>
<a name="ln-9740"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9741"></a>          <span class="c">! This subroutine produces the Daylighting Illuminance Map output.  Each separate map (by zone)</span>
<a name="ln-9742"></a>          <span class="c">! is placed on a temporary file and later (see CloseReportIllumMaps) coallesced into a single</span>
<a name="ln-9743"></a>          <span class="c">! output file.</span>
<a name="ln-9744"></a>
<a name="ln-9745"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9746"></a>          <span class="c">! na</span>
<a name="ln-9747"></a>
<a name="ln-9748"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9749"></a>          <span class="c">! na</span>
<a name="ln-9750"></a>
<a name="ln-9751"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9752"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-9753"></a>  <span class="k">USE </span><span class="n">DataStringGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CharTab</span><span class="p">,</span> <span class="n">CharComma</span><span class="p">,</span> <span class="n">CharSpace</span>
<a name="ln-9754"></a><span class="c">! BSLLC Start</span>
<a name="ln-9755"></a>  <span class="k">USE </span><span class="n">SQLiteProcedures</span>
<a name="ln-9756"></a><span class="c">! BSLLC Finish</span>
<a name="ln-9757"></a>
<a name="ln-9758"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9759"></a>
<a name="ln-9760"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9761"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MapNum</span>
<a name="ln-9762"></a>
<a name="ln-9763"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9764"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FmtA</span><span class="o">=</span><span class="s2">&quot;(A)&quot;</span>
<a name="ln-9765"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HrFmt</span><span class="o">=</span><span class="s2">&quot;(I2.2)&quot;</span>
<a name="ln-9766"></a>
<a name="ln-9767"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-9768"></a>          <span class="c">! na</span>
<a name="ln-9769"></a>
<a name="ln-9770"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-9771"></a>          <span class="c">! na</span>
<a name="ln-9772"></a>
<a name="ln-9773"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9774"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">EXTERNAL</span>   <span class="kd">::</span> <span class="n">GetNewUnitNumber</span>
<a name="ln-9775"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">string</span>
<a name="ln-9776"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">RefPt</span>
<a name="ln-9777"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span>
<a name="ln-9778"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">R</span>
<a name="ln-9779"></a><span class="c">!  REAL(r64)           :: NumOut</span>
<a name="ln-9780"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">IllumOut</span>
<a name="ln-9781"></a>
<a name="ln-9782"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>       <span class="kd">::</span> <span class="n">FirstTime</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9783"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">FirstTimeMaps</span>
<a name="ln-9784"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">EnvrnPrint</span>
<a name="ln-9785"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SavedMnDy</span>
<a name="ln-9786"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">52</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">RefPts</span>
<a name="ln-9787"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span> <span class="n">MapNoString</span>
<a name="ln-9788"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="n">HrString</span>
<a name="ln-9789"></a>  <span class="kt">INTEGER </span><span class="n">linelen</span>
<a name="ln-9790"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">52</span><span class="p">)</span> <span class="n">AddXorYString</span>
<a name="ln-9791"></a><span class="c">! BSLLC Start</span>
<a name="ln-9792"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">XValue</span>
<a name="ln-9793"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">YValue</span>
<a name="ln-9794"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:),</span><span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">IllumValue</span>
<a name="ln-9795"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SQMonth</span>
<a name="ln-9796"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SQDayOfMonth</span>
<a name="ln-9797"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IllumIndex</span>
<a name="ln-9798"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">SQFirstTime</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9799"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">CommaDelimited</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9800"></a><span class="c">! BSLLC Finish</span>
<a name="ln-9801"></a>
<a name="ln-9802"></a>          <span class="c">! FLOW:</span>
<a name="ln-9803"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FirstTime</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9804"></a><span class="k">    </span><span class="n">FirstTime</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9805"></a>    <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">FirstTimeMaps</span><span class="p">(</span><span class="n">TotIllumMaps</span><span class="p">))</span>
<a name="ln-9806"></a>    <span class="n">FirstTimeMaps</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9807"></a>    <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">EnvrnPrint</span><span class="p">(</span><span class="n">TotIllumMaps</span><span class="p">))</span>
<a name="ln-9808"></a>    <span class="n">EnvrnPrint</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9809"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">RefPts</span><span class="p">(</span><span class="n">MaxRefPoints</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-9810"></a>    <span class="n">RefPts</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-9811"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SavedMnDy</span><span class="p">(</span><span class="n">TotIllumMaps</span><span class="p">))</span>
<a name="ln-9812"></a>    <span class="n">SavedMnDy</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-9813"></a>  <span class="n">ENDIF</span>
<a name="ln-9814"></a>
<a name="ln-9815"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FirstTimeMaps</span><span class="p">(</span><span class="n">MapNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9816"></a>
<a name="ln-9817"></a><span class="k">    </span><span class="n">FirstTimeMaps</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9818"></a>    <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">UnitNo</span><span class="o">=</span><span class="n">GetNewUnitNumber</span><span class="p">()</span>
<a name="ln-9819"></a>    <span class="n">MapNoString</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)</span>
<a name="ln-9820"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MapColSep</span> <span class="o">==</span> <span class="n">CharTab</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9821"></a><span class="k">      OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">UnitNo</span><span class="p">,</span><span class="k">FILE</span><span class="o">=</span><span class="s1">&#39;eplusmap.tab&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MapNoString</span><span class="p">),</span><span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;UNKNOWN&#39;</span><span class="p">,</span><span class="n">ACTION</span><span class="o">=</span><span class="s1">&#39;readwrite&#39;</span><span class="p">,</span><span class="n">ERR</span><span class="o">=</span><span class="mi">901</span><span class="p">)</span>
<a name="ln-9822"></a>      <span class="n">CommaDelimited</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9823"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">MapColSep</span> <span class="o">==</span> <span class="n">CharComma</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9824"></a><span class="k">      OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">UnitNo</span><span class="p">,</span><span class="k">FILE</span><span class="o">=</span><span class="s1">&#39;eplusmap.csv&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MapNoString</span><span class="p">),</span><span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;UNKNOWN&#39;</span><span class="p">,</span><span class="n">ACTION</span><span class="o">=</span><span class="s1">&#39;readwrite&#39;</span><span class="p">,</span><span class="n">ERR</span><span class="o">=</span><span class="mi">902</span><span class="p">)</span>
<a name="ln-9825"></a>      <span class="n">CommaDelimited</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9826"></a>    <span class="k">ELSE</span>
<a name="ln-9827"></a><span class="k">      OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">UnitNo</span><span class="p">,</span><span class="k">FILE</span><span class="o">=</span><span class="s1">&#39;eplusmap.txt&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MapNoString</span><span class="p">),</span><span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;UNKNOWN&#39;</span><span class="p">,</span><span class="n">ACTION</span><span class="o">=</span><span class="s1">&#39;readwrite&#39;</span><span class="p">,</span><span class="n">ERR</span><span class="o">=</span><span class="mi">903</span><span class="p">)</span>
<a name="ln-9828"></a>      <span class="n">CommaDelimited</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9829"></a>    <span class="n">ENDIF</span>
<a name="ln-9830"></a>
<a name="ln-9831"></a>    <span class="n">SavedMnDy</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)</span><span class="o">=</span><span class="n">CurMnDyHr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-9832"></a>
<a name="ln-9833"></a>    <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Name</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; at &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Z</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;m&#39;</span>
<a name="ln-9834"></a>
<a name="ln-9835"></a>    <span class="k">DO </span><span class="n">R</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span>
<a name="ln-9836"></a>      <span class="n">String</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<a name="ln-9837"></a>      <span class="n">RefPts</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;RefPt&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=(&#39;</span>
<a name="ln-9838"></a>      <span class="n">String</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-9839"></a>      <span class="n">RefPts</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RefPts</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">))</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span>
<a name="ln-9840"></a>      <span class="n">String</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-9841"></a>      <span class="n">RefPts</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RefPts</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">))</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span>
<a name="ln-9842"></a>      <span class="n">String</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-9843"></a>      <span class="n">RefPts</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RefPts</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">))</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;)&#39;</span>
<a name="ln-9844"></a>    <span class="n">ENDDO</span>
<a name="ln-9845"></a>  <span class="k">END IF</span>
<a name="ln-9846"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SavedMnDy</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)</span> <span class="o">/=</span> <span class="n">CurMnDyHr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9847"></a><span class="k">    </span><span class="n">EnvrnPrint</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9848"></a>    <span class="n">SavedMnDy</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)</span><span class="o">=</span><span class="n">CurMnDyHr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-9849"></a>  <span class="n">ENDIF</span>
<a name="ln-9850"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">EnvrnPrint</span><span class="p">(</span><span class="n">MapNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9851"></a><span class="k">    CALL </span><span class="n">WriteDaylightMapTitle</span> <span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">UnitNo</span><span class="p">,</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9852"></a>        <span class="n">EnvironmentName</span><span class="p">,</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">,</span> <span class="n">RefPts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-9853"></a>        <span class="n">RefPts</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Zone</span><span class="p">),</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Z</span><span class="p">)</span>
<a name="ln-9854"></a>    <span class="n">EnvrnPrint</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9855"></a>  <span class="n">ENDIF</span>
<a name="ln-9856"></a>
<a name="ln-9857"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9858"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">TimeStep</span> <span class="o">==</span> <span class="n">NumOfTimeStepInHour</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Report only hourly</span>
<a name="ln-9859"></a>
<a name="ln-9860"></a>      <span class="c">! Write X scale column header</span>
<a name="ln-9861"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">HrString</span><span class="p">,</span><span class="n">HrFmt</span><span class="p">)</span> <span class="n">HourOfDay</span>
<a name="ln-9862"></a>      <span class="n">mapLine</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SavedMnDy</span><span class="p">(</span><span class="n">MapNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HrString</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:00&#39;</span>
<a name="ln-9863"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">HeaderXLineLengthNeeded</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9864"></a>           <span class="n">linelen</span><span class="o">=</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">mapLine</span><span class="p">)</span>
<a name="ln-9865"></a>      <span class="n">RefPt</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-9866"></a>      <span class="k">DO </span><span class="n">X</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span>
<a name="ln-9867"></a>         <span class="n">AddXorYString</span><span class="o">=</span><span class="n">MapColSep</span><span class="o">//</span><span class="s1">&#39;(&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9868"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9869"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;)=&#39;</span>
<a name="ln-9870"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">HeaderXLineLengthNeeded</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9871"></a>           <span class="n">linelen</span><span class="o">=</span><span class="n">linelen</span><span class="o">+</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">AddXorYString</span><span class="p">)</span>
<a name="ln-9872"></a>         <span class="n">mapLine</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">mapLine</span><span class="p">)</span><span class="o">//</span><span class="n">AddXorYString</span>
<a name="ln-9873"></a>         <span class="n">RefPt</span><span class="o">=</span><span class="n">RefPt</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9874"></a>      <span class="k">END DO</span> <span class="c">! X</span>
<a name="ln-9875"></a>
<a name="ln-9876"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">HeaderXLineLengthNeeded</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9877"></a><span class="k">        </span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">HeaderXLineLength</span><span class="o">=</span><span class="n">linelen</span>
<a name="ln-9878"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">HeaderXLineLength</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">mapLine</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9879"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;ReportIllumMap: Map=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9880"></a>             <span class="s1">&#39;&quot; -- the X Header overflows buffer -- will be truncated at &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9881"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MapLine</span><span class="p">)))</span><span class="o">//</span><span class="s1">&#39; characters.&#39;</span><span class="p">)</span>
<a name="ln-9882"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...needed &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">HeaderXLineLength</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9883"></a>            <span class="s1">&#39; characters. Please contact EnergyPlus support.&#39;</span><span class="p">)</span>
<a name="ln-9884"></a>        <span class="n">ENDIF</span>
<a name="ln-9885"></a>        <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">HeaderXLineLengthNeeded</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9886"></a>      <span class="n">ENDIF</span>
<a name="ln-9887"></a>
<a name="ln-9888"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">UnitNo</span><span class="p">,</span><span class="n">FmtA</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">mapLine</span><span class="p">)</span>
<a name="ln-9889"></a>
<a name="ln-9890"></a>      <span class="c">! Write Y scale prefix and illuminance values</span>
<a name="ln-9891"></a>      <span class="n">RefPt</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-9892"></a>      <span class="k">DO </span><span class="n">Y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ynum</span>
<a name="ln-9893"></a>        <span class="n">mapLine</span><span class="o">=</span><span class="s1">&#39;(&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9894"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">RefPt</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;)=&#39;</span>
<a name="ln-9895"></a>        <span class="k">DO </span><span class="n">R</span><span class="o">=</span><span class="n">RefPt</span><span class="p">,</span><span class="n">RefPt</span><span class="o">+</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-9896"></a>          <span class="n">IllumOut</span><span class="o">=</span><span class="nb">NINT</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllumAtMapPtHr</span><span class="p">(</span><span class="n">R</span><span class="p">))</span>
<a name="ln-9897"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtInBounds</span><span class="p">(</span><span class="n">R</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9898"></a><span class="k">            </span><span class="n">String</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumOut</span><span class="p">)</span>
<a name="ln-9899"></a>          <span class="k">ELSE</span>
<a name="ln-9900"></a><span class="k">            </span><span class="n">String</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">IllumOut</span><span class="p">)</span>
<a name="ln-9901"></a>            <span class="n">String</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="o">//</span><span class="n">String</span>
<a name="ln-9902"></a>          <span class="n">ENDIF</span>
<a name="ln-9903"></a>          <span class="n">mapLine</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">mapLine</span><span class="p">)</span><span class="o">//</span><span class="n">MapColSep</span><span class="o">//</span><span class="n">String</span>
<a name="ln-9904"></a>        <span class="n">ENDDO</span>
<a name="ln-9905"></a>
<a name="ln-9906"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">UnitNo</span><span class="p">,</span><span class="n">FmtA</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">mapLine</span><span class="p">)</span>
<a name="ln-9907"></a>
<a name="ln-9908"></a>        <span class="n">RefPt</span> <span class="o">=</span> <span class="n">RefPt</span> <span class="o">+</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span>
<a name="ln-9909"></a>      <span class="k">END DO</span> <span class="c">! X</span>
<a name="ln-9910"></a>
<a name="ln-9911"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WriteOutputToSQLite</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9912"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SQFirstTime</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9913"></a><span class="k">            ALLOCATE</span> <span class="p">(</span><span class="n">XValue</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotIllumMaps</span><span class="p">)%</span><span class="n">Xnum</span><span class="p">)))</span>
<a name="ln-9914"></a>            <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">YValue</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotIllumMaps</span><span class="p">)%</span><span class="n">Ynum</span><span class="p">)))</span>
<a name="ln-9915"></a>            <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">IllumValue</span><span class="p">(</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotIllumMaps</span><span class="p">)%</span><span class="n">Xnum</span><span class="p">),</span> <span class="nb">MAXVAL</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotIllumMaps</span><span class="p">)%</span><span class="n">Ynum</span><span class="p">)))</span>
<a name="ln-9916"></a>          <span class="n">SQFirstTime</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9917"></a>        <span class="n">ENDIF</span>
<a name="ln-9918"></a>
<a name="ln-9919"></a>        <span class="n">SQMonth</span><span class="o">=</span><span class="n">Month</span>
<a name="ln-9920"></a>        <span class="n">SQDayOfMonth</span><span class="o">=</span><span class="n">DayOfMonth</span>
<a name="ln-9921"></a>
<a name="ln-9922"></a>        <span class="k">DO </span><span class="n">Y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ynum</span>
<a name="ln-9923"></a>            <span class="n">YValue</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">=</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ymin</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Yinc</span>
<a name="ln-9924"></a>            <span class="k">DO </span><span class="n">X</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span>
<a name="ln-9925"></a>                <span class="n">XValue</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">=</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xmin</span> <span class="o">+</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xinc</span>
<a name="ln-9926"></a>                <span class="n">IllumIndex</span> <span class="o">=</span> <span class="n">X</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span>
<a name="ln-9927"></a>                <span class="n">IllumValue</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="o">=</span> <span class="nb">NINT</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllumAtMapPtHr</span><span class="p">(</span><span class="n">IllumIndex</span><span class="p">))</span>
<a name="ln-9928"></a>                <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">MapRefPtInBounds</span><span class="p">(</span><span class="n">IllumIndex</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9929"></a><span class="k">                    </span><span class="n">IllumValue</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">IllumValue</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<a name="ln-9930"></a>                <span class="n">ENDIF</span>
<a name="ln-9931"></a>            <span class="k">END DO</span> <span class="c">! X Loop</span>
<a name="ln-9932"></a>        <span class="k">END DO</span> <span class="c">! Y Loop</span>
<a name="ln-9933"></a>
<a name="ln-9934"></a>        <span class="k">CALL </span><span class="n">CreateSQLiteDaylightMap</span> <span class="p">(</span><span class="n">MapNum</span><span class="p">,</span> <span class="n">SQMonth</span><span class="p">,</span> <span class="n">SQDayOfMonth</span><span class="p">,</span> <span class="n">HourOfDay</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9935"></a>            <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Xnum</span><span class="p">,</span> <span class="n">XValue</span><span class="p">,</span> <span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Ynum</span><span class="p">,</span> <span class="n">YValue</span><span class="p">,</span> <span class="n">IllumValue</span><span class="p">)</span>
<a name="ln-9936"></a>
<a name="ln-9937"></a>      <span class="k">END IF</span> <span class="c">! WriteOutputToSQLite</span>
<a name="ln-9938"></a>    <span class="k">END IF</span> <span class="c">! end time step</span>
<a name="ln-9939"></a>  <span class="k">END IF</span> <span class="c">! not Warmup</span>
<a name="ln-9940"></a>
<a name="ln-9941"></a>  <span class="k">RETURN</span>
<a name="ln-9942"></a>
<a name="ln-9943"></a><span class="k">  </span><span class="mi">901</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;ReportIllumMap: Could not open file &quot;eplusmap.tab&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MapNoString</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; for output (write).&#39;</span><span class="p">)</span>
<a name="ln-9944"></a>  <span class="k">RETURN</span>
<a name="ln-9945"></a>
<a name="ln-9946"></a><span class="k">  </span><span class="mi">902</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;ReportIllumMap: Could not open file &quot;eplusmap.csv&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MapNoString</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; for output (write).&#39;</span><span class="p">)</span>
<a name="ln-9947"></a>  <span class="k">RETURN</span>
<a name="ln-9948"></a>
<a name="ln-9949"></a><span class="k">  </span><span class="mi">903</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;ReportIllumMap: Could not open file &quot;eplusmap.txt&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MapNoString</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; for output (write).&#39;</span><span class="p">)</span>
<a name="ln-9950"></a>  <span class="k">RETURN</span>
<a name="ln-9951"></a>
<a name="ln-9952"></a><span class="k">END SUBROUTINE </span><span class="n">ReportIllumMap</span>
<a name="ln-9953"></a>
<a name="ln-9954"></a><span class="k">SUBROUTINE </span><span class="n">CloseReportIllumMaps</span>
<a name="ln-9955"></a>
<a name="ln-9956"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9957"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-9958"></a>          <span class="c">!       DATE WRITTEN   June 2003</span>
<a name="ln-9959"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9960"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9961"></a>
<a name="ln-9962"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9963"></a>          <span class="c">! This subroutine &quot;closes&quot; out the created daylight illuminance maps by merging them</span>
<a name="ln-9964"></a>          <span class="c">! into the &quot;eplusout.map&quot; file.</span>
<a name="ln-9965"></a>
<a name="ln-9966"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9967"></a>          <span class="c">! na</span>
<a name="ln-9968"></a>
<a name="ln-9969"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9970"></a>          <span class="c">! na</span>
<a name="ln-9971"></a>
<a name="ln-9972"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9973"></a>  <span class="k">USE </span><span class="n">DataStringGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CharTab</span><span class="p">,</span> <span class="n">CharComma</span><span class="p">,</span> <span class="n">CharSpace</span>
<a name="ln-9974"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-9975"></a>  <span class="k">USE </span><span class="n">DataErrorTracking</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">AbortProcessing</span>
<a name="ln-9976"></a>
<a name="ln-9977"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9978"></a>
<a name="ln-9979"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9980"></a>          <span class="c">! na</span>
<a name="ln-9981"></a>
<a name="ln-9982"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9983"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FmtA</span><span class="o">=</span><span class="s2">&quot;(A)&quot;</span>
<a name="ln-9984"></a>
<a name="ln-9985"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9986"></a>          <span class="c">! na</span>
<a name="ln-9987"></a>
<a name="ln-9988"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9989"></a>          <span class="c">! na</span>
<a name="ln-9990"></a>
<a name="ln-9991"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9992"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span>       <span class="kd">::</span> <span class="n">MapOutputFile</span>
<a name="ln-9993"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">EXTERNAL</span>   <span class="kd">::</span> <span class="n">GetNewUnitNumber</span>
<a name="ln-9994"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MapNum</span>
<a name="ln-9995"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ios</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9996"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumLines</span>
<a name="ln-9997"></a>
<a name="ln-9998"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TotIllumMaps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9999"></a>
<a name="ln-10000"></a><span class="k">    </span><span class="n">MapOutputFile</span><span class="o">=</span><span class="n">GetNewUnitNumber</span><span class="p">()</span>  <span class="c">! can add this to DataGlobals with the others...</span>
<a name="ln-10001"></a>
<a name="ln-10002"></a>    <span class="c">! Write map header</span>
<a name="ln-10003"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MapColSep</span> <span class="o">==</span> <span class="n">CharTab</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10004"></a><span class="k">      OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">MapOutputFile</span><span class="p">,</span><span class="k">FILE</span><span class="o">=</span><span class="s1">&#39;eplusmap.tab&#39;</span><span class="p">,</span><span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;UNKNOWN&#39;</span><span class="p">,</span><span class="n">ACTION</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span><span class="n">ERR</span><span class="o">=</span><span class="mi">901</span><span class="p">)</span>
<a name="ln-10005"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">MapColSep</span> <span class="o">==</span> <span class="n">CharComma</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10006"></a><span class="k">      OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">MapOutputFile</span><span class="p">,</span><span class="k">FILE</span><span class="o">=</span><span class="s1">&#39;eplusmap.csv&#39;</span><span class="p">,</span><span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;UNKNOWN&#39;</span><span class="p">,</span><span class="n">ACTION</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span><span class="n">ERR</span><span class="o">=</span><span class="mi">902</span><span class="p">)</span>
<a name="ln-10007"></a>    <span class="k">ELSE</span>
<a name="ln-10008"></a><span class="k">      OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">MapOutputFile</span><span class="p">,</span><span class="k">FILE</span><span class="o">=</span><span class="s1">&#39;eplusmap.txt&#39;</span><span class="p">,</span><span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;UNKNOWN&#39;</span><span class="p">,</span><span class="n">ACTION</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span><span class="n">ERR</span><span class="o">=</span><span class="mi">903</span><span class="p">)</span>
<a name="ln-10009"></a>    <span class="n">ENDIF</span>
<a name="ln-10010"></a>
<a name="ln-10011"></a>    <span class="k">DO </span><span class="n">MapNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotIllumMaps</span>
<a name="ln-10012"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">UnitNo</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! fatal error processing</span>
<a name="ln-10013"></a>      <span class="n">NumLines</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-10014"></a>      <span class="k">REWIND</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">UnitNo</span><span class="p">)</span>
<a name="ln-10015"></a>      <span class="n">ios</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-10016"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">ios</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-10017"></a>        <span class="k">READ</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">UnitNo</span><span class="p">,</span><span class="n">FmtA</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">ios</span><span class="p">)</span> <span class="n">mapLine</span>
<a name="ln-10018"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ios</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! usually a read error</span>
<a name="ln-10019"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CloseReportIllumMaps: Failed to read map. IOError=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ios</span><span class="p">)))</span>
<a name="ln-10020"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">ios</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10021"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">NumLines</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10022"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;CloseReportIllumMaps: IllumMap=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; is empty.&#39;</span><span class="p">)</span>
<a name="ln-10023"></a>          <span class="n">ENDIF</span>
<a name="ln-10024"></a>          <span class="k">EXIT</span>
<a name="ln-10025"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-10026"></a>        <span class="n">NumLines</span><span class="o">=</span><span class="n">NumLines</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-10027"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">MapOutputFile</span><span class="p">,</span><span class="n">FmtA</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">mapLine</span><span class="p">)</span>
<a name="ln-10028"></a>      <span class="n">ENDDO</span>
<a name="ln-10029"></a>      <span class="k">CLOSE</span><span class="p">(</span><span class="n">IllumMap</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">UnitNo</span><span class="p">,</span><span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;DELETE&#39;</span><span class="p">)</span>
<a name="ln-10030"></a>    <span class="n">ENDDO</span>
<a name="ln-10031"></a>
<a name="ln-10032"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">mapResultsReported</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">AbortProcessing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10033"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;CloseReportIllumMaps: Illuminance maps requested but no data ever reported. &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10034"></a>         <span class="s1">&#39;Likely cause is no solar.&#39;</span><span class="p">)</span>
<a name="ln-10035"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">MapOutputFile</span><span class="p">,</span><span class="n">FmtA</span><span class="p">)</span> <span class="s1">&#39;CloseReportIllumMaps: Illuminance maps requested but no data ever reported. &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10036"></a>         <span class="s1">&#39;Likely cause is no solar.&#39;</span>
<a name="ln-10037"></a>    <span class="n">ENDIF</span>
<a name="ln-10038"></a>
<a name="ln-10039"></a>    <span class="k">CLOSE</span><span class="p">(</span><span class="n">MapOutputFile</span><span class="p">)</span>
<a name="ln-10040"></a>
<a name="ln-10041"></a>  <span class="n">ENDIF</span>
<a name="ln-10042"></a>
<a name="ln-10043"></a>  <span class="k">RETURN</span>
<a name="ln-10044"></a>
<a name="ln-10045"></a><span class="k">  </span><span class="mi">901</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CloseReportIllumMaps: Could not open file &quot;eplusmap.tab&quot; for output (write).&#39;</span><span class="p">)</span>
<a name="ln-10046"></a>  <span class="k">RETURN</span>
<a name="ln-10047"></a>
<a name="ln-10048"></a><span class="k">  </span><span class="mi">902</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CloseReportIllumMaps: Could not open file &quot;eplusmap.csv&quot; for output (write).&#39;</span><span class="p">)</span>
<a name="ln-10049"></a>  <span class="k">RETURN</span>
<a name="ln-10050"></a>
<a name="ln-10051"></a><span class="k">  </span><span class="mi">903</span> <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CloseReportIllumMaps: Could not open file &quot;eplusmap.txt&quot; for output (write).&#39;</span><span class="p">)</span>
<a name="ln-10052"></a>  <span class="k">RETURN</span>
<a name="ln-10053"></a>
<a name="ln-10054"></a><span class="k">END SUBROUTINE </span><span class="n">CloseReportIllumMaps</span>
<a name="ln-10055"></a>
<a name="ln-10056"></a><span class="k">SUBROUTINE </span><span class="n">CloseDFSFile</span>
<a name="ln-10057"></a>
<a name="ln-10058"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10059"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-10060"></a>          <span class="c">!       DATE WRITTEN   August 2010</span>
<a name="ln-10061"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10062"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10063"></a>
<a name="ln-10064"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10065"></a>          <span class="c">! Make sure DFSFile is closed at exit time.  Do not rely on operating system to</span>
<a name="ln-10066"></a>          <span class="c">! take care of it.</span>
<a name="ln-10067"></a>
<a name="ln-10068"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10069"></a>          <span class="c">! na</span>
<a name="ln-10070"></a>
<a name="ln-10071"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10072"></a>          <span class="c">! na</span>
<a name="ln-10073"></a>
<a name="ln-10074"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10075"></a>          <span class="c">! na</span>
<a name="ln-10076"></a>
<a name="ln-10077"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10078"></a>
<a name="ln-10079"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10080"></a>          <span class="c">! na</span>
<a name="ln-10081"></a>
<a name="ln-10082"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10083"></a>          <span class="c">! na</span>
<a name="ln-10084"></a>
<a name="ln-10085"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10086"></a>          <span class="c">! na</span>
<a name="ln-10087"></a>
<a name="ln-10088"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10089"></a>          <span class="c">! na</span>
<a name="ln-10090"></a>
<a name="ln-10091"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10092"></a>          <span class="c">! na</span>
<a name="ln-10093"></a>
<a name="ln-10094"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OutputFileDFS</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CLOSE</span><span class="p">(</span><span class="n">OutputFileDFS</span><span class="p">)</span>
<a name="ln-10095"></a>
<a name="ln-10096"></a>  <span class="k">RETURN</span>
<a name="ln-10097"></a>
<a name="ln-10098"></a><span class="k">END SUBROUTINE </span><span class="n">CloseDFSFile</span>
<a name="ln-10099"></a>
<a name="ln-10100"></a><span class="k">SUBROUTINE </span><span class="n">DayltgSetupAdjZoneListsAndPointers</span>
<a name="ln-10101"></a>
<a name="ln-10102"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10103"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-10104"></a>          <span class="c">!       DATE WRITTEN   Feb. 2004</span>
<a name="ln-10105"></a>          <span class="c">!       MODIFIED:      June 2010;LKL - Merged two routines.</span>
<a name="ln-10106"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10107"></a>
<a name="ln-10108"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10109"></a>          <span class="c">! For each Daylighting:Detailed zone, Z, creates a list of other zones, Zadj,</span>
<a name="ln-10110"></a>          <span class="c">! that have one or more exterior windows and that share one or more interior</span>
<a name="ln-10111"></a>          <span class="c">! windows with Z. Used in calculation of daylighting through interior windows.</span>
<a name="ln-10112"></a>
<a name="ln-10113"></a>          <span class="c">! Sets the daylighting factor pointers for each Daylighting:Detailed zone. The pointer</span>
<a name="ln-10114"></a>          <span class="c">! may be associated with an exterior window in a daylit target zone or an exterior window in</span>
<a name="ln-10115"></a>          <span class="c">! an adjacent zone, daylit or not, that shares interior windows with the target zone.</span>
<a name="ln-10116"></a>
<a name="ln-10117"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10118"></a>          <span class="c">! na</span>
<a name="ln-10119"></a>
<a name="ln-10120"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10121"></a>          <span class="c">! na</span>
<a name="ln-10122"></a>
<a name="ln-10123"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10124"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-10125"></a>
<a name="ln-10126"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10127"></a>
<a name="ln-10128"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10129"></a>          <span class="c">! na</span>
<a name="ln-10130"></a>
<a name="ln-10131"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10132"></a>          <span class="c">! na</span>
<a name="ln-10133"></a>
<a name="ln-10134"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-10135"></a>          <span class="c">! na</span>
<a name="ln-10136"></a>
<a name="ln-10137"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-10138"></a>          <span class="c">! na</span>
<a name="ln-10139"></a>
<a name="ln-10140"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10141"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">ZoneNum</span>            <span class="c">! Zone number</span>
<a name="ln-10142"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumList</span>            <span class="c">! Counter of adjacent zone numbers</span>
<a name="ln-10143"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">ZoneNumAdj</span>         <span class="c">! Zone number</span>
<a name="ln-10144"></a>  <span class="kt">LOGICAL</span>  <span class="kd">::</span> <span class="n">AdjZoneHasExtWins</span>  <span class="c">! True if adjacent zone has one or more exterior windows</span>
<a name="ln-10145"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">SurfNumAdj</span>         <span class="c">! Surface number</span>
<a name="ln-10146"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">SurfNumAdj2</span>         <span class="c">! Surface number</span>
<a name="ln-10147"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">ExtWinIndex</span>
<a name="ln-10148"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">IntWinIndex</span>
<a name="ln-10149"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">ZoneAdjLoop</span>
<a name="ln-10150"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumOfIntWindowsCount</span>
<a name="ln-10151"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">DayltgFacPtr</span>       <span class="c">! Daylighting factor pointer</span>
<a name="ln-10152"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">ZoneExtWinCtr</span>      <span class="c">! Exterior window counter</span>
<a name="ln-10153"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">SurfNum</span>            <span class="c">! Surface number</span>
<a name="ln-10154"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">loop</span>               <span class="c">! DO loop index</span>
<a name="ln-10155"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ZoneExtWin</span>
<a name="ln-10156"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">Winsize</span>
<a name="ln-10157"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">Refsize</span>
<a name="ln-10158"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">MapNum</span>
<a name="ln-10159"></a>
<a name="ln-10160"></a>          <span class="c">! FLOW:</span>
<a name="ln-10161"></a><span class="c">! Count number of exterior Windows (use to allocate arrays)</span>
<a name="ln-10162"></a>
<a name="ln-10163"></a>
<a name="ln-10164"></a>          <span class="c">! FLOW:</span>
<a name="ln-10165"></a>
<a name="ln-10166"></a><span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-10167"></a>  <span class="c">! Count exterior windows in this zone</span>
<a name="ln-10168"></a>    <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10169"></a>      <span class="k">IF</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10170"></a>             <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10171"></a><span class="k">        </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalExtWindows</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalExtWindows</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10172"></a>      <span class="k">END IF</span>
<a name="ln-10173"></a><span class="k">    END DO</span>
<a name="ln-10174"></a><span class="n">ENDDO</span>
<a name="ln-10175"></a>
<a name="ln-10176"></a><span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-10177"></a>  <span class="n">NumList</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10178"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10179"></a>  <span class="c">! This is a Daylighting:Detailed zone</span>
<a name="ln-10180"></a>  <span class="c">! Find adjacent zones</span>
<a name="ln-10181"></a>  <span class="k">DO </span><span class="n">ZoneNumAdj</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-10182"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ZoneNumAdj</span> <span class="o">==</span> <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10183"></a>    <span class="c">! Require that ZoneNumAdj have a least one exterior window</span>
<a name="ln-10184"></a>    <span class="n">AdjZoneHasExtWins</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10185"></a>    <span class="k">DO </span><span class="n">SurfNumAdj</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10186"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10187"></a><span class="k">        </span><span class="n">AdjZoneHasExtWins</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10188"></a>        <span class="k">EXIT</span>
<a name="ln-10189"></a><span class="k">      END iF</span>
<a name="ln-10190"></a><span class="k">    END DO</span>
<a name="ln-10191"></a><span class="k">    IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">AdjZoneHasExtWins</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10192"></a>    <span class="c">! Loop again through surfaces in ZoneNumAdj and see if any are interior windows adjacent to ZoneNum</span>
<a name="ln-10193"></a>    <span class="k">DO </span><span class="n">SurfNumAdj</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10194"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10195"></a>        <span class="c">! This is an interior window in ZoneNumAdj</span>
<a name="ln-10196"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10197"></a>          <span class="c">! This interior window is adjacent to ZoneNum</span>
<a name="ln-10198"></a>          <span class="n">NumList</span> <span class="o">=</span> <span class="n">NumList</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10199"></a>          <span class="k">EXIT</span>
<a name="ln-10200"></a><span class="k">        END IF</span>
<a name="ln-10201"></a><span class="k">      END If</span>
<a name="ln-10202"></a><span class="k">    END DO</span>
<a name="ln-10203"></a><span class="k">  END DO</span>
<a name="ln-10204"></a><span class="k">  ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AdjIntWinZoneNums</span><span class="p">(</span><span class="n">NumList</span><span class="p">))</span>
<a name="ln-10205"></a>  <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AdjIntWinZoneNums</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-10206"></a><span class="k">END DO</span>
<a name="ln-10207"></a>
<a name="ln-10208"></a><span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-10209"></a>  <span class="n">NumList</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10210"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10211"></a>  <span class="c">! This is a Daylighting:Detailed zone</span>
<a name="ln-10212"></a>  <span class="c">! Find adjacent zones</span>
<a name="ln-10213"></a>  <span class="k">DO </span><span class="n">ZoneNumAdj</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-10214"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ZoneNumAdj</span> <span class="o">==</span> <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10215"></a>    <span class="c">! Require that ZoneNumAdj have a least one exterior window</span>
<a name="ln-10216"></a>    <span class="n">AdjZoneHasExtWins</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10217"></a>    <span class="k">DO </span><span class="n">SurfNumAdj</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10218"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10219"></a><span class="k">        </span><span class="n">AdjZoneHasExtWins</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10220"></a>        <span class="k">EXIT</span>
<a name="ln-10221"></a><span class="k">      END iF</span>
<a name="ln-10222"></a><span class="k">    END DO</span>
<a name="ln-10223"></a><span class="k">    IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">AdjZoneHasExtWins</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10224"></a>    <span class="c">! Loop again through surfaces in ZoneNumAdj and see if any are interior windows adjacent to ZoneNum</span>
<a name="ln-10225"></a>    <span class="k">DO </span><span class="n">SurfNumAdj</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10226"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10227"></a>        <span class="c">! This is an interior window in ZoneNumAdj</span>
<a name="ln-10228"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10229"></a>          <span class="c">! This interior window is adjacent to ZoneNum</span>
<a name="ln-10230"></a>          <span class="n">NumList</span> <span class="o">=</span> <span class="n">NumList</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10231"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AdjIntWinZoneNums</span><span class="p">(</span><span class="n">NumList</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneNumAdj</span>
<a name="ln-10232"></a>          <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">AdjZoneHasDayltgCtrl</span> <span class="o">=</span> <span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-10233"></a>          <span class="k">EXIT</span>
<a name="ln-10234"></a><span class="k">        END IF</span>
<a name="ln-10235"></a><span class="k">      END If</span>
<a name="ln-10236"></a><span class="k">    END DO</span>
<a name="ln-10237"></a><span class="k">  END DO</span>
<a name="ln-10238"></a><span class="k">  </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfIntWinAdjZones</span> <span class="o">=</span> <span class="n">NumList</span>
<a name="ln-10239"></a><span class="k">END DO</span>
<a name="ln-10240"></a>
<a name="ln-10241"></a><span class="c">! now fill out information on relationship between adjacent exterior windows and associated interior windows</span>
<a name="ln-10242"></a><span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-10243"></a>    <span class="c">! first find count of exterior windows</span>
<a name="ln-10244"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfIntWinAdjZones</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10245"></a><span class="k">    </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfIntWinAdjZoneExtWins</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10246"></a>    <span class="k">CYCLE</span>
<a name="ln-10247"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-10248"></a>  <span class="k">DO </span><span class="n">ZoneAdjLoop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfIntWinAdjZones</span>
<a name="ln-10249"></a>    <span class="n">ZoneNumAdj</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AdjIntWinZoneNums</span><span class="p">(</span><span class="n">ZoneAdjLoop</span><span class="p">)</span>
<a name="ln-10250"></a>    <span class="k">DO </span><span class="n">SurfNumAdj</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10251"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10252"></a><span class="k">        </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfIntWinAdjZoneExtWins</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfIntWinAdjZoneExtWins</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10253"></a>      <span class="n">ENDIF</span>
<a name="ln-10254"></a>    <span class="n">ENDDO</span>
<a name="ln-10255"></a>  <span class="n">ENDDO</span>
<a name="ln-10256"></a>  <span class="c">! now allocate nested struct based on exterior window count</span>
<a name="ln-10257"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IntWinAdjZoneExtWin</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfIntWinAdjZoneExtWins</span><span class="p">))</span>
<a name="ln-10258"></a>
<a name="ln-10259"></a>  <span class="c">! now fill nested structure</span>
<a name="ln-10260"></a>  <span class="n">ExtWinIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10261"></a>  <span class="k">DO </span><span class="n">ZoneAdjLoop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfIntWinAdjZones</span>
<a name="ln-10262"></a>    <span class="n">ZoneNumAdj</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AdjIntWinZoneNums</span><span class="p">(</span><span class="n">ZoneAdjLoop</span><span class="p">)</span>
<a name="ln-10263"></a>    <span class="k">DO </span><span class="n">SurfNumAdj</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10264"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10265"></a><span class="k">        </span><span class="n">ExtWinIndex</span> <span class="o">=</span> <span class="n">ExtWinIndex</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10266"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IntWinAdjZoneExtWin</span><span class="p">(</span><span class="n">ExtWinIndex</span><span class="p">)%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfNumAdj</span>
<a name="ln-10267"></a>
<a name="ln-10268"></a>        <span class="c">! now count interior windows shared by both zones</span>
<a name="ln-10269"></a>        <span class="n">NumOfIntWindowsCount</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10270"></a>        <span class="k">DO </span><span class="n">SurfNumAdj2</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10271"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj2</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj2</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10272"></a>            <span class="c">! This is an interior window in ZoneNumAdj</span>
<a name="ln-10273"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj2</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10274"></a>              <span class="c">! This interior window is adjacent to ZoneNum and associated with this</span>
<a name="ln-10275"></a>              <span class="n">NumOfIntWindowsCount</span> <span class="o">=</span> <span class="n">NumOfIntWindowsCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10276"></a>            <span class="n">ENDIF</span>
<a name="ln-10277"></a>          <span class="n">ENDIF</span>
<a name="ln-10278"></a>        <span class="n">ENDDO</span>
<a name="ln-10279"></a>        <span class="c">! allocate nested array</span>
<a name="ln-10280"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IntWinAdjZoneExtWin</span><span class="p">(</span><span class="n">ExtWinIndex</span><span class="p">)%</span><span class="n">IntWinNum</span><span class="p">(</span><span class="n">NumOfIntWindowsCount</span><span class="p">))</span>
<a name="ln-10281"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IntWinAdjZoneExtWin</span><span class="p">(</span><span class="n">ExtWinIndex</span><span class="p">)%</span><span class="n">IntWinNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-10282"></a>        <span class="n">IntWinIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10283"></a>        <span class="k">DO </span><span class="n">SurfNumAdj2</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10284"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj2</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj2</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10285"></a>            <span class="c">! This is an interior window in ZoneNumAdj</span>
<a name="ln-10286"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj2</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10287"></a>              <span class="c">! This interior window is adjacent to ZoneNum and associated with this</span>
<a name="ln-10288"></a>              <span class="n">IntWinIndex</span> <span class="o">=</span> <span class="n">IntWinIndex</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10289"></a>              <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IntWinAdjZoneExtWin</span><span class="p">(</span><span class="n">ExtWinIndex</span><span class="p">)%</span><span class="n">IntWinNum</span><span class="p">(</span><span class="n">IntWinIndex</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfNumAdj2</span>
<a name="ln-10290"></a>            <span class="n">ENDIF</span>
<a name="ln-10291"></a>          <span class="n">ENDIF</span>
<a name="ln-10292"></a>        <span class="n">ENDDO</span>
<a name="ln-10293"></a>      <span class="n">ENDIF</span>
<a name="ln-10294"></a>    <span class="n">ENDDO</span>
<a name="ln-10295"></a>  <span class="n">ENDDO</span>
<a name="ln-10296"></a>
<a name="ln-10297"></a><span class="n">ENDDO</span>
<a name="ln-10298"></a>
<a name="ln-10299"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-10300"></a><span class="n">ZoneExtWin</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-10301"></a>
<a name="ln-10302"></a><span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-10303"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10304"></a>    <span class="c">! This is a Daylighting:Detailed zone</span>
<a name="ln-10305"></a>
<a name="ln-10306"></a>    <span class="c">! Get exterior windows in this zone</span>
<a name="ln-10307"></a>    <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10308"></a>      <span class="k">IF</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10309"></a>             <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10310"></a><span class="k">        </span><span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10311"></a>      <span class="k">END IF</span>
<a name="ln-10312"></a><span class="k">    END DO</span>
<a name="ln-10313"></a>
<a name="ln-10314"></a>    <span class="c">! Get exterior windows in adjacent zones that share interior windows with ZoneNum</span>
<a name="ln-10315"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfIntWinAdjZones</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10316"></a><span class="k">      DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfIntWinAdjZones</span>
<a name="ln-10317"></a>        <span class="n">ZoneNumAdj</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AdjIntWinZoneNums</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-10318"></a>        <span class="c">! Get exterior windows in ZoneNumAdj -- there must be at least one, otherwise</span>
<a name="ln-10319"></a>        <span class="c">! it would not be an &quot;AdjIntWinZone&quot;</span>
<a name="ln-10320"></a>        <span class="k">DO </span><span class="n">SurfNumAdj</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10321"></a>          <span class="k">IF</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10322"></a>                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10323"></a><span class="k">            </span><span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10324"></a>          <span class="k">END IF</span>
<a name="ln-10325"></a><span class="k">        END DO</span>
<a name="ln-10326"></a><span class="k">      END DO</span>
<a name="ln-10327"></a><span class="k">    END IF</span>
<a name="ln-10328"></a>
<a name="ln-10329"></a><span class="k">  END IF</span>  <span class="c">! End of check if a Daylighting:Detailed zone</span>
<a name="ln-10330"></a><span class="k">END DO</span>  <span class="c">! End of primary zone loop</span>
<a name="ln-10331"></a>
<a name="ln-10332"></a><span class="n">DayltgFacPtr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10333"></a><span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-10334"></a>  <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10335"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10336"></a>    <span class="c">! This is a Daylighting:Detailed zone</span>
<a name="ln-10337"></a>
<a name="ln-10338"></a>    <span class="c">! Get exterior windows in this zone</span>
<a name="ln-10339"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10340"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">ZoneDayLight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)))</span>
<a name="ln-10341"></a>    <span class="n">ZoneDayLight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-10342"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgFacPtrsForExtWins</span><span class="p">(</span><span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)))</span>
<a name="ln-10343"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgFacPtrsForExtWins</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-10344"></a>
<a name="ln-10345"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPt</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span><span class="p">,</span><span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)))</span>
<a name="ln-10346"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10347"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span><span class="p">,</span><span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)))</span>
<a name="ln-10348"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10349"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)))</span>
<a name="ln-10350"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10351"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)))</span>
<a name="ln-10352"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10353"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)))</span>
<a name="ln-10354"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10355"></a>
<a name="ln-10356"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MapCount</span>
<a name="ln-10357"></a>      <span class="n">MapNum</span><span class="o">=</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ZoneToMap</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span>
<a name="ln-10358"></a>
<a name="ln-10359"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">TotalMapRefPoints</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10360"></a>        <span class="c">! might be able to use TotalMapRefPoints for zone in below.</span>
<a name="ln-10361"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SolidAngAtMapPt</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">TotalMapRefPoints</span><span class="p">,</span><span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)))</span>
<a name="ln-10362"></a>        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SolidAngAtMapPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10363"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SolidAngAtMapPtWtd</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">TotalMapRefPoints</span><span class="p">,</span><span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)))</span>
<a name="ln-10364"></a>        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SolidAngAtMapPtWtd</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10365"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">IllumFromWinAtMapPt</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">TotalMapRefPoints</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)))</span>
<a name="ln-10366"></a>        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">IllumFromWinAtMapPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10367"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtMapPt</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">TotalMapRefPoints</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)))</span>
<a name="ln-10368"></a>        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">BackLumFromWinAtMapPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10369"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtMapPt</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">TotalMapRefPoints</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)))</span>
<a name="ln-10370"></a>        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">SourceLumFromWinAtMapPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10371"></a>      <span class="n">ENDIF</span>
<a name="ln-10372"></a>    <span class="n">ENDDO</span>
<a name="ln-10373"></a>
<a name="ln-10374"></a>    <span class="n">ZoneExtWinCtr</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10375"></a>
<a name="ln-10376"></a>    <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10377"></a>      <span class="k">IF</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10378"></a>             <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10379"></a><span class="k">        </span><span class="n">ZoneExtWinCtr</span> <span class="o">=</span> <span class="n">ZoneExtWinCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10380"></a>        <span class="n">DayltgFacPtr</span> <span class="o">=</span> <span class="n">DayltgFacPtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10381"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">ZoneExtWinCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfNum</span>
<a name="ln-10382"></a>        <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgFacPtrsForExtWins</span><span class="p">(</span><span class="n">ZoneExtWinCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">DayltgFacPtr</span>
<a name="ln-10383"></a>      <span class="k">END IF</span>
<a name="ln-10384"></a><span class="k">    END DO</span>
<a name="ln-10385"></a>
<a name="ln-10386"></a>    <span class="c">! Get exterior windows in adjacent zones that share interior windows with ZoneNum</span>
<a name="ln-10387"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfIntWinAdjZones</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10388"></a><span class="k">      DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfIntWinAdjZones</span>
<a name="ln-10389"></a>        <span class="n">ZoneNumAdj</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AdjIntWinZoneNums</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-10390"></a>        <span class="c">! Get exterior windows in ZoneNumAdj -- there must be at least one, otherwise</span>
<a name="ln-10391"></a>        <span class="c">! it would not be an &quot;AdjIntWinZone&quot;</span>
<a name="ln-10392"></a>        <span class="k">DO </span><span class="n">SurfNumAdj</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10393"></a>          <span class="k">IF</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10394"></a>                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10395"></a><span class="k">            </span><span class="n">ZoneExtWinCtr</span> <span class="o">=</span> <span class="n">ZoneExtWinCtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10396"></a>            <span class="n">DayltgFacPtr</span> <span class="o">=</span> <span class="n">DayltgFacPtr</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-10397"></a>            <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgExtWinSurfNums</span><span class="p">(</span><span class="n">ZoneExtWinCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">SurfNumAdj</span>
<a name="ln-10398"></a>            <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DayltgFacPtrsForExtWins</span><span class="p">(</span><span class="n">ZoneExtWinCtr</span><span class="p">)</span> <span class="o">=</span> <span class="n">DayltgFacPtr</span>
<a name="ln-10399"></a>
<a name="ln-10400"></a>            <span class="c">! If no daylighting in that zone, set up variables anyway:</span>
<a name="ln-10401"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNumAdj</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10402"></a><span class="k">              IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">SurfDayLightInit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10403"></a><span class="k">                ALLOCATE</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">SolidAngAtRefPt</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span><span class="p">))</span>
<a name="ln-10404"></a>                <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">SolidAngAtRefPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10405"></a>                <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span><span class="p">))</span>
<a name="ln-10406"></a>                <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">SolidAngAtRefPtWtd</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10407"></a>                <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-10408"></a>                <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">IllumFromWinAtRefPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10409"></a>                <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-10410"></a>                <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">BackLumFromWinAtRefPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10411"></a>                <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-10412"></a>                <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">SourceLumFromWinAtRefPt</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-10413"></a>                <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNumAdj</span><span class="p">)%</span><span class="n">SurfDayLightInit</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10414"></a>              <span class="n">ENDIF</span>
<a name="ln-10415"></a>            <span class="n">ENDIF</span>
<a name="ln-10416"></a>          <span class="k">END IF</span>
<a name="ln-10417"></a><span class="k">        END DO</span>
<a name="ln-10418"></a><span class="k">      END DO</span>
<a name="ln-10419"></a><span class="k">    END IF</span>
<a name="ln-10420"></a>
<a name="ln-10421"></a><span class="k">    </span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span> <span class="o">=</span> <span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-10422"></a>    <span class="n">WinSize</span><span class="o">=</span><span class="n">ZoneExtWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-10423"></a>    <span class="n">RefSize</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-10424"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span>         <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10425"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span>      <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10426"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span>        <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10427"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span>         <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10428"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span>     <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10429"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span>      <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10430"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span>  <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10431"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span>        <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10432"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span>    <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10433"></a>
<a name="ln-10434"></a>    <span class="k">DO </span><span class="n">Loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MapCount</span>
<a name="ln-10435"></a>      <span class="n">MapNum</span><span class="o">=</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ZoneToMap</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span>
<a name="ln-10436"></a>      <span class="n">RefSize</span><span class="o">=</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">TotalMapRefPoints</span>
<a name="ln-10437"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSky</span>         <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10438"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSky</span>      <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10439"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSky</span>        <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10440"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSun</span>         <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10441"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylIllFacSunDisk</span>     <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10442"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSun</span>      <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10443"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylSourceFacSunDisk</span>  <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10444"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSun</span>        <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10445"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">MapNum</span><span class="p">)%</span><span class="n">DaylBackFacSunDisk</span>    <span class="p">(</span><span class="n">WinSize</span><span class="p">,</span><span class="n">RefSize</span><span class="p">,</span><span class="n">MaxSlatAngs</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-10446"></a>    <span class="n">ENDDO</span>
<a name="ln-10447"></a>
<a name="ln-10448"></a>  <span class="k">END IF</span>  <span class="c">! End of check if a Daylighting:Detailed zone</span>
<a name="ln-10449"></a><span class="k">END DO</span>  <span class="c">! End of primary zone loop</span>
<a name="ln-10450"></a>
<a name="ln-10451"></a><span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">700</span><span class="p">)</span>
<a name="ln-10452"></a><span class="mi">700</span> <span class="k">Format</span><span class="p">(</span><span class="s1">&#39;! &lt;Zone/Window Adjacency Daylighting Counts&gt;, Zone Name, &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10453"></a>           <span class="s1">&#39;Number of Exterior Windows, Number of Exterior Windows in Adjacent Zones&#39;</span><span class="p">)</span>
<a name="ln-10454"></a><span class="k">DO </span><span class="n">ZoneNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-10455"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10456"></a><span class="k">  WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">701</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalExtWindows</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-10457"></a>    <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfDayltgExtWins</span><span class="o">-</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalExtWindows</span><span class="p">))</span>
<a name="ln-10458"></a><span class="k">END DO</span>
<a name="ln-10459"></a><span class="mi">701</span> <span class="k">Format</span><span class="p">(</span><span class="s1">&#39;Zone/Window Adjacency Daylighting Counts, &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-10460"></a>
<a name="ln-10461"></a><span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">702</span><span class="p">)</span>
<a name="ln-10462"></a><span class="mi">702</span> <span class="k">Format</span><span class="p">(</span><span class="s1">&#39;! &lt;Zone/Window Adjacency Daylighting Matrix&gt;, Zone Name, Number of Adjacent Zones with Windows,&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10463"></a>           <span class="s1">&#39;Adjacent Zone Names - 1st 100 (max)&#39;</span><span class="p">)</span>
<a name="ln-10464"></a><span class="k">DO </span><span class="n">ZoneNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-10465"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10466"></a><span class="k">  WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfIntWinAdjZones</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-10467"></a>    <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AdjIntWinZoneNums</span><span class="p">(</span><span class="n">loop</span><span class="p">))%</span><span class="n">Name</span><span class="p">),</span><span class="n">loop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfIntWinAdjZones</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<a name="ln-10468"></a><span class="k">END DO</span>
<a name="ln-10469"></a><span class="mi">703</span> <span class="k">Format</span><span class="p">(</span><span class="s1">&#39;Zone/Window Adjacency Daylighting Matrix, &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="mi">100</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">))</span>
<a name="ln-10470"></a>
<a name="ln-10471"></a><span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">ZoneExtWin</span><span class="p">)</span>
<a name="ln-10472"></a>
<a name="ln-10473"></a><span class="k">RETURN</span>
<a name="ln-10474"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgSetupAdjZoneListsAndPointers</span>
<a name="ln-10475"></a>
<a name="ln-10476"></a><span class="k">SUBROUTINE </span><span class="n">DayltgInterReflIllFrIntWins</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-10477"></a>
<a name="ln-10478"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10479"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-10480"></a>          <span class="c">!       DATE WRITTEN   Mar. 2004</span>
<a name="ln-10481"></a>          <span class="c">!       MODIFIED:na</span>
<a name="ln-10482"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10483"></a>
<a name="ln-10484"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10485"></a>          <span class="c">! Calculates the inter-reflected illuminance in a daylit zone from beam</span>
<a name="ln-10486"></a>          <span class="c">! and diffuse daylight entering the zone through interior windows. This illuminance</span>
<a name="ln-10487"></a>          <span class="c">! is determined by the split-flux method and is assumed to be uniform, i.e., the same</span>
<a name="ln-10488"></a>          <span class="c">! at all reference points.</span>
<a name="ln-10489"></a>
<a name="ln-10490"></a>          <span class="c">! METHODOLOGY EMPLOYED:na</span>
<a name="ln-10491"></a>          <span class="c">! REFERENCES:na</span>
<a name="ln-10492"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10493"></a>
<a name="ln-10494"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10495"></a>
<a name="ln-10496"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10497"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">ZoneNum</span>            <span class="c">! Zone number</span>
<a name="ln-10498"></a>
<a name="ln-10499"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10500"></a>          <span class="c">! na</span>
<a name="ln-10501"></a>
<a name="ln-10502"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-10503"></a>          <span class="c">! na</span>
<a name="ln-10504"></a>
<a name="ln-10505"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-10506"></a>          <span class="c">! na</span>
<a name="ln-10507"></a>
<a name="ln-10508"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10509"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IWin</span>               <span class="c">! Window number</span>
<a name="ln-10510"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ConstrNum</span>          <span class="c">! Window construction number</span>
<a name="ln-10511"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">AdjZoneNum</span>         <span class="c">! Adjacent zone number</span>
<a name="ln-10512"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QDifTrans</span>          <span class="c">! Luminous flux transmitted through an int win from adjacent zone (lumens)</span>
<a name="ln-10513"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QDifTransUp</span>        <span class="c">! Upgoing part of QDifTrans (lumens)</span>
<a name="ln-10514"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QDifTransDn</span>        <span class="c">! Downgoing part of QDifTrans (lumens)</span>
<a name="ln-10515"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DifInterReflIllThisWin</span> <span class="c">! Inter-reflected illuminance due to QDifTrans (lux)</span>
<a name="ln-10516"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BmInterReflIll</span>     <span class="c">! Inter-reflected illuminance due to beam solar entering ZoneNum</span>
<a name="ln-10517"></a>                                      <span class="c">!  through its interior windows (lux)</span>
<a name="ln-10518"></a>          <span class="c">! FLOW:</span>
<a name="ln-10519"></a>
<a name="ln-10520"></a><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InterReflIllFrIntWins</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10521"></a>
<a name="ln-10522"></a><span class="k">DO </span><span class="n">IWin</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10523"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10524"></a>    <span class="c">! This is an interior window in ZoneNum</span>
<a name="ln-10525"></a>    <span class="n">ConstrNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-10526"></a>    <span class="n">AdjZoneNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-10527"></a>    <span class="n">QDifTrans</span> <span class="o">=</span> <span class="n">QSDifSol</span><span class="p">(</span><span class="n">AdjZoneNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransDiffVis</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">PDIFLW</span>
<a name="ln-10528"></a>    <span class="n">QDifTransUp</span> <span class="o">=</span> <span class="n">QDifTrans</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span>
<a name="ln-10529"></a>    <span class="n">QDifTransDn</span> <span class="o">=</span> <span class="n">QDifTrans</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">FractionUpgoing</span><span class="p">)</span>
<a name="ln-10530"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotInsSurfArea</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span><span class="p">)</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10531"></a><span class="k">      </span><span class="n">DifInterReflIllThisWin</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-10532"></a>        <span class="p">(</span><span class="n">QDifTransDn</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">RhoFloorWall</span> <span class="o">+</span> <span class="n">QDifTransUp</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">RhoCeilingWall</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-10533"></a>        <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotInsSurfArea</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span><span class="p">))</span>
<a name="ln-10534"></a>    <span class="k">ELSE</span>
<a name="ln-10535"></a><span class="k">      </span><span class="n">DifInterReflIllThisWin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10536"></a>    <span class="n">ENDIF</span>
<a name="ln-10537"></a>    <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InterReflIllFrIntWins</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InterReflIllFrIntWins</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-10538"></a>      <span class="n">DifInterReflIllThisWin</span>
<a name="ln-10539"></a>  <span class="k">END IF</span>
<a name="ln-10540"></a><span class="k">END DO</span>
<a name="ln-10541"></a>
<a name="ln-10542"></a><span class="c">! Add inter-reflected illuminance from beam solar entering ZoneNum through interior windows</span>
<a name="ln-10543"></a><span class="c">! TH, CR 7873, 9/17/2009</span>
<a name="ln-10544"></a><span class="n">BmInterReflIll</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10545"></a><span class="k">IF</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotInsSurfArea</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10546"></a><span class="k">  </span><span class="n">BmInterReflIll</span> <span class="o">=</span> <span class="p">(</span><span class="n">DBZoneIntWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">PDIRLW</span> <span class="o">*</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorVisRefl</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-10547"></a>    <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotInsSurfArea</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AveVisDiffReflect</span><span class="p">))</span>
<a name="ln-10548"></a><span class="n">ENDIF</span>
<a name="ln-10549"></a>
<a name="ln-10550"></a><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InterReflIllFrIntWins</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InterReflIllFrIntWins</span> <span class="o">+</span> <span class="n">BmInterReflIll</span>
<a name="ln-10551"></a>
<a name="ln-10552"></a><span class="k">RETURN</span>
<a name="ln-10553"></a><span class="k">END SUBROUTINE </span><span class="n">DayltgInterReflIllFrIntWins</span>
<a name="ln-10554"></a>
<a name="ln-10555"></a><span class="k">SUBROUTINE </span><span class="n">CalcMinIntWinSolidAngs</span>
<a name="ln-10556"></a>
<a name="ln-10557"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10558"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-10559"></a>          <span class="c">!       DATE WRITTEN   Feb. 2004</span>
<a name="ln-10560"></a>          <span class="c">!       MODIFIED:na</span>
<a name="ln-10561"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10562"></a>
<a name="ln-10563"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10564"></a>          <span class="c">! For each Daylighting:Detailed zone finds the minimum solid angle subtended</span>
<a name="ln-10565"></a>          <span class="c">! by interior windows through which daylight can pass from adjacent zones with</span>
<a name="ln-10566"></a>          <span class="c">! exterior windows.</span>
<a name="ln-10567"></a>
<a name="ln-10568"></a>          <span class="c">! METHODOLOGY EMPLOYED:na</span>
<a name="ln-10569"></a>          <span class="c">! REFERENCES:na</span>
<a name="ln-10570"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10571"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-10572"></a>
<a name="ln-10573"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10574"></a>
<a name="ln-10575"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS: na</span>
<a name="ln-10576"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS: na</span>
<a name="ln-10577"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS: na</span>
<a name="ln-10578"></a>          <span class="c">! DERIVED TYPE DEFINITIONS: na</span>
<a name="ln-10579"></a>
<a name="ln-10580"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10581"></a>
<a name="ln-10582"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ZoneNum</span>            <span class="c">! Zone number</span>
<a name="ln-10583"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ZoneNumAdj</span>         <span class="c">! Adjacent zone number</span>
<a name="ln-10584"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IWin</span>               <span class="c">! Window surface number</span>
<a name="ln-10585"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IL</span>                 <span class="c">! Reference point number</span>
<a name="ln-10586"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">loop</span>               <span class="c">! DO loop index</span>
<a name="ln-10587"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">Triangle</span>           <span class="c">! True if window is a triangle</span>
<a name="ln-10588"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">Rectangle</span>          <span class="c">! True if window is a rectangle</span>
<a name="ln-10589"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">IntWinNextToIntWinAdjZone</span>  <span class="c">! True if an interior window is next to a zone with</span>
<a name="ln-10590"></a>                                         <span class="c">! one or more exterior windows</span>
<a name="ln-10591"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IntWinSolidAng</span>     <span class="c">! Approximation to solid angle subtended by an interior window</span>
<a name="ln-10592"></a>                             <span class="c">! from a point a distance sqrt(zone floor area) away.</span>
<a name="ln-10593"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W1</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">W2</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">W3</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c">! Window vertices</span>
<a name="ln-10594"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>              <span class="c">! Center point of window</span>
<a name="ln-10595"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W21</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">W23</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>      <span class="c">! Unit vectors from window vertex 2 to 1 and 2 to 3</span>
<a name="ln-10596"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HW</span><span class="p">,</span><span class="n">WW</span>              <span class="c">! Window height and width (m)</span>
<a name="ln-10597"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RREF</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>            <span class="c">! Location of a reference point in absolute coordinate system</span>
<a name="ln-10598"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RAY</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>             <span class="c">! Unit vector along ray from reference point to window center</span>
<a name="ln-10599"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">REFWC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>           <span class="c">! Vector from reference point to center of window</span>
<a name="ln-10600"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WNORM</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>           <span class="c">! Unit vector normal to window (pointing away from room)</span>
<a name="ln-10601"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DIS</span>                <span class="c">! Distance from ref point to window center (m)</span>
<a name="ln-10602"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">COSB</span>               <span class="c">! Cosine of angle between ray from ref pt to center of window</span>
<a name="ln-10603"></a>                                  <span class="c">!  and window outward normal</span>
<a name="ln-10604"></a>
<a name="ln-10605"></a>          <span class="c">! FLOW:</span>
<a name="ln-10606"></a>
<a name="ln-10607"></a><span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-10608"></a>  <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinIntWinSolidAng</span> <span class="o">=</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Pi</span>
<a name="ln-10609"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10610"></a><span class="k">  IF</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfIntWinAdjZones</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10611"></a><span class="k">  DO </span><span class="n">IWin</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10612"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10613"></a><span class="k">      </span><span class="n">ZoneNumAdj</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">ExtBoundCond</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-10614"></a>      <span class="n">IntWinNextToIntWinAdjZone</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10615"></a>      <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumOfIntWinAdjZones</span>
<a name="ln-10616"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ZoneNumAdj</span> <span class="o">==</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">AdjIntWinZoneNums</span><span class="p">(</span><span class="n">loop</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10617"></a><span class="k">          </span><span class="n">IntWinNextToIntWinAdjZone</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10618"></a>          <span class="k">EXIT</span>
<a name="ln-10619"></a><span class="k">        END IF</span>
<a name="ln-10620"></a><span class="k">      END DO</span>
<a name="ln-10621"></a><span class="k">      IF</span><span class="p">(</span><span class="n">IntWinNextToIntWinAdjZone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10622"></a><span class="k">        DO </span><span class="n">IL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span>
<a name="ln-10623"></a>          <span class="c">! Reference point in absolute coordinate system</span>
<a name="ln-10624"></a>          <span class="n">RREF</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-10625"></a>          <span class="n">Rectangle</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10626"></a>          <span class="n">Triangle</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10627"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="n">Triangle</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10628"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="n">Rectangle</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10629"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Rectangle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10630"></a>            <span class="c">! Vertices of window numbered counter-clockwise starting at upper left as viewed</span>
<a name="ln-10631"></a>            <span class="c">! from inside of room. Assumes original vertices are numbered counter-clockwise from</span>
<a name="ln-10632"></a>            <span class="c">! upper left as viewed from outside.</span>
<a name="ln-10633"></a>            <span class="n">W3</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-10634"></a>            <span class="n">W2</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-10635"></a>            <span class="n">W1</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-10636"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Triangle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10637"></a><span class="k">            </span><span class="n">W3</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-10638"></a>            <span class="n">W2</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-10639"></a>            <span class="n">W1</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10640"></a>          <span class="k">END IF</span>
<a name="ln-10641"></a>          <span class="c">! Unit vectors from window vertex 2 to 1 and 2 to 3, center point of window,</span>
<a name="ln-10642"></a>          <span class="c">! and vector from ref pt to center of window</span>
<a name="ln-10643"></a>          <span class="n">W21</span> <span class="o">=</span> <span class="n">W1</span> <span class="o">-</span> <span class="n">W2</span>
<a name="ln-10644"></a>          <span class="n">W23</span> <span class="o">=</span> <span class="n">W3</span> <span class="o">-</span> <span class="n">W2</span>
<a name="ln-10645"></a>          <span class="n">HW</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">W21</span><span class="p">,</span><span class="n">W21</span><span class="p">))</span>
<a name="ln-10646"></a>          <span class="n">WW</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">W23</span><span class="p">,</span><span class="n">W23</span><span class="p">))</span>
<a name="ln-10647"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Rectangle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10648"></a><span class="k">            </span><span class="n">WC</span>  <span class="o">=</span> <span class="n">W2</span> <span class="o">+</span> <span class="p">(</span><span class="n">W23</span> <span class="o">+</span> <span class="n">W21</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-10649"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Triangle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10650"></a><span class="k">            </span><span class="n">WC</span>  <span class="o">=</span> <span class="n">W2</span> <span class="o">+</span> <span class="p">(</span><span class="n">W23</span> <span class="o">+</span> <span class="n">W21</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
<a name="ln-10651"></a>          <span class="k">END IF</span>
<a name="ln-10652"></a>          <span class="c">! Vector from ref point to center of window</span>
<a name="ln-10653"></a>          <span class="n">REFWC</span> <span class="o">=</span> <span class="n">WC</span> <span class="o">-</span> <span class="n">RREF</span>
<a name="ln-10654"></a>          <span class="n">W21</span> <span class="o">=</span> <span class="n">W21</span><span class="o">/</span><span class="n">HW</span>
<a name="ln-10655"></a>          <span class="n">W23</span> <span class="o">=</span> <span class="n">W23</span><span class="o">/</span><span class="n">WW</span>
<a name="ln-10656"></a>          <span class="c">! Unit vector normal to window (pointing away from room)</span>
<a name="ln-10657"></a>          <span class="n">WNORM</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">OutNormVec</span>
<a name="ln-10658"></a>          <span class="c">! Distance from ref point to center of window</span>
<a name="ln-10659"></a>          <span class="n">DIS</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">REFWC</span><span class="p">,</span><span class="n">REFWC</span><span class="p">))</span>
<a name="ln-10660"></a>          <span class="c">! Unit vector from ref point to center of window</span>
<a name="ln-10661"></a>          <span class="n">RAY</span> <span class="o">=</span> <span class="n">REFWC</span><span class="o">/</span><span class="n">DIS</span>
<a name="ln-10662"></a>          <span class="c">! Cosine of angle between ray from ref pt to center of window and window outward normal</span>
<a name="ln-10663"></a>          <span class="n">COSB</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">WNORM</span><span class="p">,</span> <span class="n">RAY</span><span class="p">)</span>
<a name="ln-10664"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">COSB</span> <span class="o">&gt;</span> <span class="mf">0.01765d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! 0 &lt;= B &lt; 89 deg</span>
<a name="ln-10665"></a>            <span class="c">! Above test avoids case where ref point cannot receive daylight directly from the</span>
<a name="ln-10666"></a>            <span class="c">! interior window</span>
<a name="ln-10667"></a>            <span class="n">IntWinSolidAng</span> <span class="o">=</span> <span class="n">COSB</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">IWin</span><span class="p">)%</span><span class="n">Area</span> <span class="o">/</span> <span class="p">(</span><span class="n">DIS</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.001d0</span><span class="p">)</span>
<a name="ln-10668"></a>            <span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinIntWinSolidAng</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-10669"></a>             <span class="nb">MIN</span><span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MinIntWinSolidAng</span><span class="p">,</span><span class="n">IntWinSolidAng</span><span class="p">)</span>
<a name="ln-10670"></a>          <span class="k">END IF</span>
<a name="ln-10671"></a><span class="k">        END DO</span>  <span class="c">! End of loop over reference points</span>
<a name="ln-10672"></a>      <span class="k">END IF</span>
<a name="ln-10673"></a><span class="k">    END IF</span>
<a name="ln-10674"></a><span class="k">  END DO</span>  <span class="c">! End of loop over surfaces in zone</span>
<a name="ln-10675"></a><span class="k">END DO</span>  <span class="c">! End of loop over zones</span>
<a name="ln-10676"></a>
<a name="ln-10677"></a><span class="k">RETURN</span>
<a name="ln-10678"></a><span class="k">END SUBROUTINE </span><span class="n">CalcMinIntWinSolidAngs</span>
<a name="ln-10679"></a>
<a name="ln-10680"></a><span class="k">SUBROUTINE </span><span class="n">CheckForGeometricTransform</span><span class="p">(</span><span class="n">DoTransform</span><span class="p">,</span><span class="n">OldAspectRatio</span><span class="p">,</span><span class="n">NewAspectRatio</span><span class="p">)</span>
<a name="ln-10681"></a>
<a name="ln-10682"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10683"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-10684"></a>          <span class="c">!       DATE WRITTEN   February 2009</span>
<a name="ln-10685"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10686"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10687"></a>
<a name="ln-10688"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10689"></a>          <span class="c">! check for geometrytransform in the daylighting access for reference and map points</span>
<a name="ln-10690"></a>          <span class="c">!</span>
<a name="ln-10691"></a>
<a name="ln-10692"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10693"></a>          <span class="c">! once reference points  have been converted to WCS,</span>
<a name="ln-10694"></a>          <span class="c">!  change them to reflect a different aspect</span>
<a name="ln-10695"></a>          <span class="c">! ratio for the entire building based on user input.</span>
<a name="ln-10696"></a>
<a name="ln-10697"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10698"></a>          <span class="c">! na</span>
<a name="ln-10699"></a>
<a name="ln-10700"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10701"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-10702"></a>  <span class="k">USE </span><span class="n">InputProcessor</span>
<a name="ln-10703"></a>  <span class="k">USE </span><span class="n">DataDaylighting</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneDaylight</span>
<a name="ln-10704"></a>
<a name="ln-10705"></a> <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10706"></a>
<a name="ln-10707"></a>
<a name="ln-10708"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10709"></a>  <span class="kt">Logical</span><span class="p">,</span>  <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">doTransform</span>
<a name="ln-10710"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OldAspectRatio</span>
<a name="ln-10711"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NewAspectRatio</span>
<a name="ln-10712"></a>
<a name="ln-10713"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10714"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;GeometryTransform&#39;</span>
<a name="ln-10715"></a>
<a name="ln-10716"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-10717"></a>          <span class="c">! na</span>
<a name="ln-10718"></a>
<a name="ln-10719"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-10720"></a>          <span class="c">! na</span>
<a name="ln-10721"></a>
<a name="ln-10722"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10723"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cAlphas</span>
<a name="ln-10724"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rNumerics</span>
<a name="ln-10725"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">NAlphas</span>
<a name="ln-10726"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">NNum</span>
<a name="ln-10727"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">IOSTAT</span>
<a name="ln-10728"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">transformPlane</span>
<a name="ln-10729"></a>
<a name="ln-10730"></a>  <span class="c">!begin execution</span>
<a name="ln-10731"></a>  <span class="c">!get user input...</span>
<a name="ln-10732"></a>  <span class="n">doTransform</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-10733"></a>  <span class="n">OldAspectRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10734"></a>  <span class="n">NewAspectRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10735"></a>
<a name="ln-10736"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-10737"></a><span class="k">     CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">cAlphas</span><span class="p">,</span><span class="n">NAlphas</span><span class="p">,</span><span class="n">rNumerics</span><span class="p">,</span><span class="n">NNum</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10738"></a>                 <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10739"></a>                 <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-10740"></a>     <span class="n">OldAspectRatio</span> <span class="o">=</span> <span class="n">rNumerics</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10741"></a>     <span class="n">NewAspectRatio</span> <span class="o">=</span> <span class="n">rNumerics</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-10742"></a>     <span class="n">transformPlane</span> <span class="o">=</span> <span class="n">cAlphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10743"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">transformPlane</span> <span class="o">/=</span> <span class="s1">&#39;XY&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-10744"></a><span class="k">       CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10745"></a>         <span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;...ignored.&#39;</span><span class="p">)</span>
<a name="ln-10746"></a>     <span class="n">ENDIF</span>
<a name="ln-10747"></a>     <span class="n">doTransform</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10748"></a>     <span class="n">AspectTransform</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10749"></a>  <span class="n">Endif</span>
<a name="ln-10750"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WorldCoordSystem</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10751"></a><span class="k">    </span><span class="n">doTransform</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-10752"></a>    <span class="n">AspectTransform</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-10753"></a>  <span class="n">ENDIF</span>
<a name="ln-10754"></a>
<a name="ln-10755"></a>  <span class="k">Return</span>
<a name="ln-10756"></a>
<a name="ln-10757"></a><span class="k">END SUBROUTINE </span><span class="n">CheckForGeometricTransform</span>
<a name="ln-10758"></a>
<a name="ln-10759"></a><span class="k">SUBROUTINE </span><span class="n">WriteDaylightMapTitle</span> <span class="p">(</span><span class="n">mapNum</span><span class="p">,</span> <span class="n">unitNo</span><span class="p">,</span> <span class="n">mapName</span><span class="p">,</span> <span class="n">environmentName</span><span class="p">,</span> <span class="n">zonenum</span><span class="p">,</span> <span class="n">refPt1</span><span class="p">,</span> <span class="n">refPt2</span><span class="p">,</span> <span class="n">zcoord</span><span class="p">)</span>
<a name="ln-10760"></a>    <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10761"></a>    <span class="c">!       AUTHOR         Greg Stark</span>
<a name="ln-10762"></a>    <span class="c">!       DATE WRITTEN   Sept 2008</span>
<a name="ln-10763"></a>    <span class="c">!       MODIFIED       na</span>
<a name="ln-10764"></a>    <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10765"></a>
<a name="ln-10766"></a>    <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10767"></a>    <span class="c">! The purpose of the routine is to allow the daylighting map data to be written in various formats</span>
<a name="ln-10768"></a>
<a name="ln-10769"></a>    <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10770"></a>    <span class="c">! na</span>
<a name="ln-10771"></a>
<a name="ln-10772"></a>    <span class="c">! REFERENCES:</span>
<a name="ln-10773"></a>    <span class="c">! na</span>
<a name="ln-10774"></a>
<a name="ln-10775"></a>    <span class="c">! USE STATEMENTS:</span>
<a name="ln-10776"></a>    <span class="k">USE </span><span class="n">SQLiteProcedures</span>
<a name="ln-10777"></a>
<a name="ln-10778"></a>    <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10779"></a>
<a name="ln-10780"></a>
<a name="ln-10781"></a>    <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10782"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mapNum</span>
<a name="ln-10783"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">unitNo</span>
<a name="ln-10784"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mapName</span>
<a name="ln-10785"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">environmentName</span>
<a name="ln-10786"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">zonenum</span>
<a name="ln-10787"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">zcoord</span>
<a name="ln-10788"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">refPt1</span>
<a name="ln-10789"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">refPt2</span>
<a name="ln-10790"></a>
<a name="ln-10791"></a>    <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10792"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FmtA</span><span class="o">=</span><span class="s2">&quot;(A)&quot;</span>
<a name="ln-10793"></a>
<a name="ln-10794"></a>    <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-10795"></a>    <span class="c">! na</span>
<a name="ln-10796"></a>
<a name="ln-10797"></a>    <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-10798"></a>    <span class="c">! na</span>
<a name="ln-10799"></a>
<a name="ln-10800"></a>    <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10801"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fullmapName</span>  <span class="c">! for output to map units as well as SQL</span>
<a name="ln-10802"></a>
<a name="ln-10803"></a>    <span class="c">! must add correct number of commas at end</span>
<a name="ln-10804"></a>    <span class="n">fullmapName</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">environmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">mapName</span><span class="p">)</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-10805"></a>        <span class="s1">&#39; Illuminance [lux] (Hourly)&#39;</span>
<a name="ln-10806"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">unitNo</span><span class="p">,</span> <span class="n">FmtA</span><span class="p">)</span> <span class="s1">&#39;Date/Time,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">fullmapName</span><span class="p">)</span><span class="o">//</span><span class="n">MapColSep</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">refPt1</span><span class="p">)</span><span class="o">//</span><span class="n">MapColSep</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10807"></a>        <span class="nb">TRIM</span><span class="p">(</span><span class="n">refPt2</span><span class="p">)</span><span class="o">//</span><span class="n">MapColSep</span><span class="o">//</span><span class="n">MapColSep</span>
<a name="ln-10808"></a>
<a name="ln-10809"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WriteOutputToSQLite</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10810"></a><span class="k">        CALL </span><span class="n">CreateSQLiteDaylightMapTitle</span> <span class="p">(</span><span class="n">mapNum</span><span class="p">,</span> <span class="n">fullmapName</span><span class="p">,</span> <span class="n">environmentName</span><span class="p">,</span> <span class="n">zonenum</span><span class="p">,</span> <span class="n">refPt1</span><span class="p">,</span> <span class="n">refPt2</span><span class="p">,</span> <span class="n">zcoord</span><span class="p">)</span>
<a name="ln-10811"></a>    <span class="k">END IF</span>
<a name="ln-10812"></a>
<a name="ln-10813"></a><span class="k">RETURN</span>
<a name="ln-10814"></a>
<a name="ln-10815"></a><span class="k">END SUBROUTINE </span><span class="n">WriteDaylightMapTitle</span>
<a name="ln-10816"></a>
<a name="ln-10817"></a><span class="c">!     NOTICE</span>
<a name="ln-10818"></a><span class="c">!</span>
<a name="ln-10819"></a><span class="c">!     Copyright  1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-10820"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-10821"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-10822"></a><span class="c">!</span>
<a name="ln-10823"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-10824"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-10825"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-10826"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-10827"></a><span class="c">!</span>
<a name="ln-10828"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-10829"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-10830"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-10831"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-10832"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-10833"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-10834"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-10835"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-10836"></a><span class="c">!     permit others to do so.</span>
<a name="ln-10837"></a><span class="c">!</span>
<a name="ln-10838"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-10839"></a><span class="c">!</span>
<a name="ln-10840"></a>
<a name="ln-10841"></a><span class="k">END MODULE </span><span class="n">DaylightingManager</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
