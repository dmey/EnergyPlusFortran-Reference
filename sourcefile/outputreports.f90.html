<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>OutputReports.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>OutputReports.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 0.5% of total for source files.">1767 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/OutputReports.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">OutputReports.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-0">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-0" class="panel-collapse collapse">

      <a class="list-group-item" href="../proc/reportsurfaces.html">ReportSurfaces</a>

      <a class="list-group-item" href="../proc/linesout.html">LinesOut</a>

      <a class="list-group-item" href="../proc/dxfout.html">DXFOut</a>

      <a class="list-group-item" href="../proc/dxfoutlines.html">DXFOutLines</a>

      <a class="list-group-item" href="../proc/dxfoutwireframe.html">DXFOutWireFrame</a>

      <a class="list-group-item" href="../proc/detailsforsurfaces.html">DetailsForSurfaces</a>

      <a class="list-group-item" href="../proc/costinfoout.html">CostInfoOut</a>

      <a class="list-group-item" href="../proc/vrmlout.html">VRMLOut</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/outputreports.f90.html#src">OutputReports.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~outputreports.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileoutputreportsf90EfferentGraph" width="641pt" height="588pt"
 viewBox="0.00 0.00 641.00 588.44" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~outputreports.f90~~EfferentGraph" class="graph" transform="scale(.5139 .5139) rotate(0) translate(4 1141.0192)">
<title>sourcefile~~outputreports.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1141.0192 1243.2952,-1141.0192 1243.2952,4 -4,4"/>
<!-- sourcefile~outputreports.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~outputreports.f90</title>
<polygon fill="none" stroke="#000000" points="1239.1952,-586.344 1141.5956,-586.344 1141.5956,-564.3331 1239.1952,-564.3331 1239.1952,-586.344"/>
<text text-anchor="middle" x="1190.3954" y="-572.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">OutputReports.f90</text>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1105.5781,-625.344 991.2483,-625.344 991.2483,-603.3331 1105.5781,-603.3331 1105.5781,-625.344"/>
<text text-anchor="middle" x="1048.4132" y="-611.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputreports.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1088.7198,-603.267C1104.7568,-598.8619 1123.3807,-593.7463 1140.274,-589.106"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1141.2722,-592.4615 1149.988,-586.4377 1139.4181,-585.7115 1141.2722,-592.4615"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-966.344 166.6166,-966.344 166.6166,-944.3331 281.0645,-944.3331 281.0645,-966.344"/>
<text text-anchor="middle" x="223.8406" y="-952.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputreports.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M231.1865,-966.7285C248.8292,-993.6872 293.8549,-1060.0656 317.2024,-1072.3385 423.1016,-1128.0062 466.1056,-1093.8104 585.7192,-1091.3385"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-975.3385C482.6183,-961.0912 502.0139,-949.5451 585.7192,-936.3385"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="782.952,-472.344 716.2145,-472.344 716.2145,-450.3331 782.952,-450.3331 782.952,-472.344"/>
<text text-anchor="middle" x="749.5833" y="-458.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-975.3385C435.5399,-967.1761 449.1279,-975.8845 480.9653,-956.3385 506.5411,-940.6368 639.8673,-775.5556 654.4731,-749.3385 706.0643,-656.7337 735.3313,-531.6714 745.4804,-482.4698"/>
<polygon fill="#7fff00" stroke="#7fff00" points="748.9643,-482.8982 747.5056,-472.4043 742.1018,-481.5174 748.9643,-482.8982"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M264.0392,-966.3525C299.6744,-974.5898 353.0505,-983.1898 399.0839,-975.3385"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-947.344 334.3841,-947.344 334.3841,-925.3331 463.7837,-925.3331 463.7837,-947.344"/>
<text text-anchor="middle" x="399.0839" y="-933.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M281.2218,-949.1172C294.877,-947.6367 309.649,-946.0351 323.9664,-944.4828"/>
<polygon fill="#7fff00" stroke="#7fff00" points="324.7243,-947.9212 334.2888,-943.3637 323.9697,-940.962 324.7243,-947.9212"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.2783,-740.344 536.1602,-740.344 536.1602,-718.3331 635.2783,-718.3331 635.2783,-740.344"/>
<text text-anchor="middle" x="585.7192" y="-726.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M243.6601,-944.1605C287.4324,-919.2589 395.2685,-856.7278 480.9653,-797.3385 497.6255,-785.7928 500.1674,-780.6828 516.9653,-769.3385 529.4592,-760.9009 543.8007,-752.3853 556.1418,-745.3927"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="558.1059,-748.3046 565.1255,-740.3689 554.6892,-742.195 558.1059,-748.3046"/>
</g>
<!-- sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~vectorutilities.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/vectorutilities.f90.html" xlink:title="VectorUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="946.6359,-356.344 853.3882,-356.344 853.3882,-334.3331 946.6359,-334.3331 946.6359,-356.344"/>
<text text-anchor="middle" x="900.0121" y="-342.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VectorUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~outputreports.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~outputreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1048.4132,-575.3385C1075.3244,-581.1319 1105.7756,-581.8708 1131.5571,-580.8625"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1131.7398,-584.3579 1141.5581,-580.3764 1131.3999,-577.3661 1131.7398,-584.3579"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.4109,-356.7902C923.194,-368.9617 941.7352,-389.0726 955.3308,-408.3385 1004.3241,-477.7653 965.3433,-557.4554 1048.4132,-575.3385"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputreports.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.0067,-472.4475C782.8283,-495.9774 839.9923,-550.697 900.0121,-575.3385"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M900.0121,-575.3385C961.0261,-600.3883 983.9344,-561.4577 1048.4132,-575.3385"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M900.0121,-575.3385C926.2337,-586.104 956.2957,-594.6579 982.4755,-600.9789"/>
<polygon fill="#ff0000" stroke="#ff0000" points="981.767,-604.4078 992.303,-603.2921 983.3709,-597.594 981.767,-604.4078"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M758.8681,-450.2813C774.8519,-431.7857 809.2761,-394.2522 844.6934,-370.3385 849.9095,-366.8166 855.7024,-363.5774 861.5191,-360.6806"/>
<polygon fill="#ffff00" stroke="#ffff00" points="863.034,-363.836 870.5997,-356.4191 860.06,-357.4991 863.034,-363.836"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1104.23,-434.344 992.5964,-434.344 992.5964,-412.3331 1104.23,-412.3331 1104.23,-434.344"/>
<text text-anchor="middle" x="1048.4132" y="-420.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M761.3912,-450.275C785.4668,-428.9274 842.802,-384.1545 900.0121,-384.3385"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="955.1501,-472.344 844.874,-472.344 844.874,-450.3331 955.1501,-450.3331 955.1501,-472.344"/>
<text text-anchor="middle" x="900.0121" y="-458.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M782.9683,-461.3385C798.1632,-461.3385 816.6978,-461.3385 834.4956,-461.3385"/>
<polygon fill="#00ffff" stroke="#00ffff" points="834.8588,-464.8386 844.8588,-461.3385 834.8587,-457.8386 834.8588,-464.8386"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3482,-167.344 539.0902,-167.344 539.0902,-145.3331 632.3482,-145.3331 632.3482,-167.344"/>
<text text-anchor="middle" x="585.7192" y="-153.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~outputreports.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~outputreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M632.3853,-154.7829C665.1997,-154.0694 710.1177,-153.856 749.5833,-156.3385"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M749.5833,-156.3385C841.465,-162.1182 876.7072,-132.4428 955.3308,-180.3385 1101.2301,-269.2171 1167.4976,-485.6791 1185.2874,-554.1841"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1181.9745,-555.361 1187.8131,-564.2019 1188.7621,-553.6497 1181.9745,-555.361"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M604.4385,-167.5953C657.6089,-199.5694 809.7392,-291.053 872.4635,-328.7722"/>
<polygon fill="#ffff00" stroke="#ffff00" points="871.0174,-331.9866 881.391,-334.1407 874.6248,-325.9878 871.0174,-331.9866"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M590.2147,-167.4005C601.4193,-195.065 631.3483,-269.5402 654.4731,-332.3385 671.3754,-378.2385 657.062,-400.6147 690.4731,-436.3385 695.1265,-441.314 700.9288,-445.3389 707.0658,-448.5835"/>
<polygon fill="#7fff00" stroke="#7fff00" points="705.6553,-451.7873 716.2018,-452.7986 708.5879,-445.4311 705.6553,-451.7873"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M749.5833,-156.3385C783.994,-158.5031 870.2682,-176.9006 900.0121,-194.3385"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="806.9864,-1101.344 692.1801,-1101.344 692.1801,-1079.3331 806.9864,-1079.3331 806.9864,-1101.344"/>
<text text-anchor="middle" x="749.5833" y="-1087.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~outputreports.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~outputreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M807.0862,-1090.3385C835.1181,-1090.3385 869.3256,-1090.3385 900.0121,-1090.3385"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-497.344 -.2403,-497.344 -.2403,-475.3331 130.719,-475.3331 130.719,-497.344"/>
<text text-anchor="middle" x="65.2394" y="-483.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreports.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1129.3385C726.3107,-1122.5134 765.1446,-1130.6287 900.0121,-1090.3385"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M65.7767,-497.5474C68.7594,-552.3432 86.19,-796.6108 166.4788,-975.3385 183.9657,-1014.2656 190.6872,-1025.4691 223.8406,-1052.3385"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1052.3385C229.5535,-1056.9686 474.0685,-991.89 480.9653,-989.3385 529.9009,-971.2346 534.1797,-944.4702 585.7192,-936.3385"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M585.7192,-346.3385C658.1799,-353.6487 676.7694,-344.8782 749.5833,-346.3385"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M223.8406,-428.3385C270.4617,-412.9814 270.679,-384.9893 317.2024,-369.3385 430.7285,-331.1476 466.5463,-334.3159 585.7192,-346.3385"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-467.3385C511.5579,-483.8307 541.4062,-493.0979 654.4731,-481.3385 671.4067,-479.5774 689.7667,-476.0976 705.7981,-472.5276"/>
<polygon fill="#7fff00" stroke="#7fff00" points="707.0001,-475.8424 715.9585,-470.1857 705.4278,-469.0213 707.0001,-475.8424"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-78.3385C316.0827,-10.3526 376.1166,-51.1061 480.9653,-97.3385 501.1024,-106.2179 498.2353,-119.7829 516.9653,-131.3385 523.2077,-135.1898 530.1326,-138.5757 537.1143,-141.5103"/>
<polygon fill="#00ff00" stroke="#00ff00" points="536.0236,-144.842 546.6112,-145.2334 538.5786,-138.3249 536.0236,-144.842"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M223.8406,-1052.3385C351.1959,-1156.3562 421.572,-1139.0711 585.7192,-1129.3385"/>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M585.7192,-1129.3385C628.4691,-1127.2632 675.8979,-1114.8134 708.6824,-1104.5299"/>
<polygon fill="#00ff7f" stroke="#00ff7f" points="709.9135,-1107.8107 718.3653,-1101.4219 707.7741,-1101.1456 709.9135,-1107.8107"/>
</g>
<!-- sourcefile~datasurfacecolors.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~datasurfacecolors.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/datasurfacecolors.f90.html" xlink:title="DataSurfaceColors.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="808.8037,-778.344 690.3628,-778.344 690.3628,-756.3331 808.8037,-756.3331 808.8037,-778.344"/>
<text text-anchor="middle" x="749.5833" y="-764.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaceColors.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfacecolors.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfacecolors.f90</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M223.8406,-821.3385C292.2895,-858.4998 324.4673,-799.0095 399.0839,-821.3385"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-556.344 180.0456,-556.344 180.0456,-534.3331 267.6355,-534.3331 267.6355,-556.344"/>
<text text-anchor="middle" x="223.8406" y="-542.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M95.0711,-497.436C120.4358,-506.8717 157.043,-520.4897 184.7476,-530.7958"/>
<polygon fill="#0000ff" stroke="#0000ff" points="183.5498,-534.0846 194.1427,-534.2908 185.9905,-527.5238 183.5498,-534.0846"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-439.344 350.2841,-439.344 350.2841,-417.3331 447.8836,-417.3331 447.8836,-439.344"/>
<text text-anchor="middle" x="399.0839" y="-425.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M223.8406,-428.3385C261.1874,-416.0363 305.4903,-416.1557 340.2068,-419.2901"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="339.8907,-422.7759 350.1915,-420.2974 340.5934,-415.8112 339.8907,-422.7759"/>
</g>
<!-- sourcefile~datadaylighting.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~datadaylighting.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/datadaylighting.f90.html" xlink:title="DataDaylighting.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="450.7236,-1063.344 347.4441,-1063.344 347.4441,-1041.3331 450.7236,-1041.3331 450.7236,-1063.344"/>
<text text-anchor="middle" x="399.0839" y="-1049.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataDaylighting.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadaylighting.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadaylighting.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M223.8406,-1052.3385C260.6126,-1082.3721 317.6731,-1075.7894 356.6224,-1066.0718"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="357.8395,-1069.3698 366.6029,-1063.4154 356.0391,-1062.6053 357.8395,-1069.3698"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M223.8406,-78.3385C355.3929,20.1644 421.3756,-2.3385 585.7192,-2.3385 585.7192,-2.3385 585.7192,-2.3385 749.5833,-2.3385 947.9368,-2.3385 1026.665,-316.9425 1044.3634,-402.2302"/>
<polygon fill="#ff007f" stroke="#ff007f" points="1040.9409,-402.9642 1046.3439,-412.0778 1047.8035,-401.584 1040.9409,-402.9642"/>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M65.524,-475.156C67.2673,-427.257 79.6119,-236.3851 166.4788,-116.3385 184.4061,-91.5636 199.2065,-96.4589 223.8406,-78.3385"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-755.344 344.7839,-755.344 344.7839,-733.3331 453.3838,-733.3331 453.3838,-755.344"/>
<text text-anchor="middle" x="399.0839" y="-741.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-821.3385C265.5819,-844.0001 273.4973,-787.933 317.2024,-769.3385 326.7378,-765.2817 337.1525,-761.5803 347.2604,-758.3416"/>
<polygon fill="#ff0000" stroke="#ff0000" points="348.3015,-761.6833 356.8186,-755.3818 346.2308,-754.9965 348.3015,-761.6833"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M223.8406,-821.3385C274.492,-848.8375 267.5243,-882.1179 317.2024,-911.3385 324.2157,-915.4637 331.9736,-918.9678 339.8372,-921.9279"/>
<polygon fill="#7fff00" stroke="#7fff00" points="338.8435,-925.288 349.4384,-925.2738 341.1471,-918.6779 338.8435,-925.288"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-346.3385C637.4347,-351.5558 643.0813,-376.991 690.4731,-398.3385 716.3255,-409.9836 722.0471,-415.5774 749.5833,-422.3385"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M749.5833,-422.3385C782.6307,-430.4529 819.6295,-440.0385 848.664,-447.676"/>
<polygon fill="#00ffff" stroke="#00ffff" points="848.0204,-451.1258 858.5822,-450.2906 849.8048,-444.357 848.0204,-451.1258"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M223.8406,-821.3385C236.6993,-828.3196 466.8651,-768.2455 480.9653,-764.3385 502.6219,-758.3378 526.4047,-750.4958 545.8278,-743.7561"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="546.9876,-747.0585 555.2678,-740.4488 544.673,-740.4522 546.9876,-747.0585"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-714.344 358.7923,-714.344 358.7923,-692.3331 439.3754,-692.3331 439.3754,-714.344"/>
<text text-anchor="middle" x="399.0839" y="-700.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-821.3385C276.4265,-849.8877 265.5086,-754.473 317.2024,-724.3385 326.8124,-718.7365 337.9098,-714.6108 348.7714,-711.5783"/>
<polygon fill="#0000ff" stroke="#0000ff" points="349.7912,-714.9307 358.6305,-709.0898 348.078,-708.1436 349.7912,-714.9307"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M66.1163,-497.5093C70.7426,-547.6609 97.1647,-752.5655 223.8406,-821.3385"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-147.344 168.8556,-147.344 168.8556,-125.3331 278.8255,-125.3331 278.8255,-147.344"/>
<text text-anchor="middle" x="223.8406" y="-133.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M70.3367,-475.0898C93.0351,-424.9992 185.0921,-221.8484 214.6537,-156.6122"/>
<polygon fill="#ff0000" stroke="#ff0000" points="217.9018,-157.9239 218.8413,-147.3708 211.5258,-155.0347 217.9018,-157.9239"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="456.7769,-517.344 341.3908,-517.344 341.3908,-495.3331 456.7769,-495.3331 456.7769,-517.344"/>
<text text-anchor="middle" x="399.0839" y="-503.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-428.3385C269.1592,-413.4104 273.3733,-462.4803 317.2024,-481.3385 326.5207,-485.3479 336.6903,-488.9964 346.5949,-492.1914"/>
<polygon fill="#ff0000" stroke="#ff0000" points="345.7816,-495.6038 356.37,-495.2319 347.8608,-488.9196 345.7816,-495.6038"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="654.2279,-472.344 517.2105,-472.344 517.2105,-450.3331 654.2279,-450.3331 654.2279,-472.344"/>
<text text-anchor="middle" x="585.7192" y="-458.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-428.3385C226.2089,-427.5584 396.6168,-466.9768 399.0839,-467.3385"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-467.3385C434.2569,-472.496 473.5413,-472.1342 506.9613,-470.0352"/>
<polygon fill="#00ffff" stroke="#00ffff" points="507.3989,-473.5134 517.1338,-469.3322 506.9162,-466.5301 507.3989,-473.5134"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-128.344 340.6161,-128.344 340.6161,-106.3331 457.5516,-106.3331 457.5516,-128.344"/>
<text text-anchor="middle" x="399.0839" y="-114.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-78.3385C234.2567,-70.6615 304.8972,-89.3543 353.2478,-103.4366"/>
<polygon fill="#ff0000" stroke="#ff0000" points="352.3154,-106.8106 362.8965,-106.2714 354.2886,-100.0944 352.3154,-106.8106"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-244.344 323.0941,-244.344 323.0941,-222.3331 475.0737,-222.3331 475.0737,-244.344"/>
<text text-anchor="middle" x="399.0839" y="-230.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-428.3385C307.1969,-400.8806 248.1242,-308.4718 317.2024,-254.3385 319.6643,-252.4093 322.2837,-250.6557 325.0175,-249.062"/>
<polygon fill="#ff0000" stroke="#ff0000" points="326.7269,-252.1199 334.0842,-244.4963 323.5785,-245.8679 326.7269,-252.1199"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M93.6962,-475.2998C125.2891,-463.193 177.8939,-443.4736 223.8406,-428.3385"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-285.344 317.3208,-285.344 317.3208,-263.3331 480.847,-263.3331 480.847,-285.344"/>
<text text-anchor="middle" x="399.0839" y="-271.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-428.3385C291.0609,-406.1959 259.6148,-340.479 317.2024,-299.3385 322.7279,-295.3911 328.8892,-292.0564 335.2832,-289.2414"/>
<polygon fill="#00ffff" stroke="#00ffff" points="336.7659,-292.4187 344.7709,-285.4782 334.1849,-285.9118 336.7659,-292.4187"/>
</g>
<!-- sourcefile~datasurfacecolors.f90&#45;&gt;sourcefile~outputreports.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~datasurfacecolors.f90&#45;&gt;sourcefile~outputreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M770.8835,-756.1265C799.9205,-740.913 853.6274,-713.0265 900.0121,-690.3385"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreports.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M900.0121,-690.3385C974.968,-653.6757 966.8402,-557.7777 1048.4132,-575.3385"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-690.3385C724.3671,-707.3349 774.5324,-751.7139 900.0121,-690.3385"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.0667,-556.4244C235.8707,-604.2776 276.5204,-792.6422 317.2024,-835.3385 339.1911,-858.4161 554.3064,-941.7528 585.7192,-936.3385"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M230.0132,-533.9332C246.48,-503.9409 291.9152,-424.0865 317.2024,-408.3385 381.4639,-368.3186 579.5498,-371.1843 654.4731,-360.3385 696.7591,-354.2173 706.8568,-346.4805 749.5833,-346.3385"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-545.3385C440.9873,-548.7583 544.3102,-583.6105 585.7192,-576.3385"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M231.7817,-534.2256C244.3998,-515.9849 268.8595,-478.1362 281.2024,-442.3385 314.7857,-344.9379 246.3158,-288.1035 317.2024,-213.3385 331.7057,-198.0417 454.4202,-176.6626 528.8432,-164.9151"/>
<polygon fill="#00ff00" stroke="#00ff00" points="529.6699,-168.3284 539.0078,-163.323 528.5866,-161.4127 529.6699,-168.3284"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfacecolors.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfacecolors.f90</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M399.0839,-821.3385C453.5895,-840.2232 616.0903,-802.5304 699.2866,-780.9676"/>
<polygon fill="#007fff" stroke="#007fff" points="700.2363,-784.3371 709.0268,-778.4229 698.4668,-777.5644 700.2363,-784.3371"/>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M225.8424,-556.4204C235.0391,-603.3709 278.0952,-785.1326 399.0839,-821.3385"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadaylighting.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadaylighting.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M226.3819,-556.557C234.5729,-592.7953 260.9253,-710.0153 281.2024,-807.3385 298.0208,-888.0612 273.7431,-919.265 317.2024,-989.3385 329.5192,-1009.1982 350.5081,-1025.1614 368.1514,-1036.0502"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="366.6178,-1039.2091 377.0092,-1041.2756 370.1745,-1033.18 366.6178,-1039.2091"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M230.2204,-534.3111C241.0098,-515.5688 263.4211,-476.2327 281.2024,-442.3385 298.0081,-410.304 290.3165,-393.5417 317.2024,-369.3385 364.4684,-326.7888 523.2439,-282.2295 585.7192,-270.3385"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.3425,-556.5586C233.9745,-588.081 260.0096,-678.0834 317.2024,-723.3385 322.5377,-727.5602 328.6259,-730.9415 335.0193,-733.6484"/>
<polygon fill="#ff0000" stroke="#ff0000" points="333.959,-736.9876 344.5526,-737.1511 336.3732,-730.4171 333.959,-736.9876"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-545.3385C436.3187,-548.3773 451.0718,-541.9321 480.9653,-564.3385 507.0796,-583.9123 496.5791,-602.8535 516.9653,-628.3385 542.6681,-660.4699 545.117,-683.6664 585.7192,-690.3385"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-690.3385C621.2836,-696.1828 628.9318,-672.7673 654.4731,-647.3385 675.7069,-626.1984 669.8904,-612.113 690.4731,-590.3385 748.3075,-529.1555 769.8306,-518.858 844.6934,-480.3385 847.5828,-478.8518 850.6142,-477.4399 853.707,-476.1073"/>
<polygon fill="#00ffff" stroke="#00ffff" points="855.1055,-479.3176 863.0887,-472.3521 852.5042,-472.8189 855.1055,-479.3176"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M230.8086,-556.3602C244.6016,-577.215 277.5097,-622.408 317.2024,-645.3385 381.8997,-682.7142 411.5238,-655.7603 480.9653,-683.3385 498.1807,-690.1755 500.1939,-696.4753 516.9653,-704.3385 524.9865,-708.0992 533.7407,-711.6665 542.233,-714.8666"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="541.0631,-718.1654 551.6568,-718.3143 543.4682,-711.5915 541.0631,-718.1654"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-636.344 334.8633,-636.344 334.8633,-614.3331 463.3044,-614.3331 463.3044,-636.344"/>
<text text-anchor="middle" x="399.0839" y="-622.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M238.2375,-556.4683C255.9233,-569.645 287.2735,-591.4258 317.2024,-604.3385 323.2682,-606.9556 329.7326,-609.3017 336.2678,-611.391"/>
<polygon fill="#ff0000" stroke="#ff0000" points="335.271,-614.746 345.8552,-614.2702 337.2845,-608.0418 335.271,-614.746"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~outputreports.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-595.344 354.6193,-595.344 354.6193,-573.3331 443.5485,-573.3331 443.5485,-595.344"/>
<text text-anchor="middle" x="399.0839" y="-581.1885" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M267.6098,-555.0793C290.9546,-560.2746 319.8949,-566.7152 344.6753,-572.23"/>
<polygon fill="#00ff00" stroke="#00ff00" points="344.134,-575.6951 354.6555,-574.4511 345.6547,-568.8623 344.134,-575.6951"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M228.5609,-556.5072C239.9245,-582.0417 271.3013,-645.044 317.2024,-678.3385 326.6011,-685.1559 337.8881,-690.1405 349.0359,-693.7761"/>
<polygon fill="#0000ff" stroke="#0000ff" points="348.1642,-697.168 358.7456,-696.636 350.1419,-690.4532 348.1642,-697.168"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M267.6098,-535.5978C289.3428,-530.7612 315.9254,-524.8453 339.4864,-519.6018"/>
<polygon fill="#ff0000" stroke="#ff0000" points="340.3752,-522.9897 349.3761,-517.4009 338.8545,-516.1569 340.3752,-522.9897"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-545.3385C464.1032,-550.6447 531.8545,-505.137 564.9782,-478.97"/>
<polygon fill="#00ffff" stroke="#00ffff" points="567.4359,-481.4833 573.002,-472.4684 563.029,-476.0447 567.4359,-481.4833"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M267.4913,-543.3715C302.9945,-542.2445 354.3569,-541.6884 399.0839,-545.3385"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M231.9329,-534.2762C244.7633,-516.1066 269.5148,-478.3555 281.2024,-442.3385 301.9272,-378.4721 274.1034,-193.8256 317.2024,-142.3385 321.1751,-137.5926 326.0218,-133.7292 331.3532,-130.5867"/>
<polygon fill="#ff0000" stroke="#ff0000" points="333.3064,-133.5251 340.7141,-125.9503 330.1995,-127.2524 333.3064,-133.5251"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M231.6447,-534.1771C244.0704,-515.8683 268.2658,-477.9259 281.2024,-442.3385 310.2674,-362.3838 258.9353,-316.3262 317.2024,-254.3385 318.597,-252.8549 320.081,-251.4703 321.6406,-250.1785"/>
<polygon fill="#ff0000" stroke="#ff0000" points="323.7228,-252.9948 330.0043,-244.463 319.7732,-247.2154 323.7228,-252.9948"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M231.4101,-534.088C243.5067,-515.6542 267.2494,-477.5398 281.2024,-442.3385 305.3524,-381.4116 272.0256,-346.8187 317.2024,-299.3385 320.5482,-295.8221 324.3728,-292.7961 328.4996,-290.1924"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.2022,-293.2508 337.3383,-285.4197 326.8762,-287.0914 330.2022,-293.2508"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputreports.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M749.5833,-384.3385C773.1484,-381.6155 935.9823,-427.6139 955.3308,-441.3385 1014.4762,-483.2928 977.5229,-560.0774 1048.4132,-575.3385"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.1586,-434.7095C460.241,-438.4153 472.2094,-444.231 480.9653,-453.3385 524.5972,-498.7227 467.9919,-550.7777 516.9653,-590.3385 660.4017,-706.2068 903.333,-655.9498 1003.3407,-628.2072"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1004.4605,-631.5278 1013.129,-625.4361 1002.5537,-624.7925 1004.4605,-631.5278"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M585.7192,-422.3385C660.4718,-421.2133 675.3164,-392.9204 749.5833,-384.3385"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M749.5833,-384.3385C787.0264,-380.0118 828.4028,-368.7925 858.2681,-359.4922"/>
<polygon fill="#ffff00" stroke="#ffff00" points="859.4603,-362.7859 867.9327,-356.4244 857.3424,-356.114 859.4603,-362.7859"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M448.1924,-426.3016C485.8237,-424.8518 539.0416,-423.0412 585.7192,-422.3385"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M585.7192,-422.3385C630.1046,-421.6704 679.4669,-435.5069 712.2982,-446.8818"/>
<polygon fill="#7fff00" stroke="#7fff00" points="711.338,-450.2551 721.9327,-450.3141 713.6872,-443.661 711.338,-450.2551"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datasurfacecolors.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datasurfacecolors.f90</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M448.297,-438.4409C459.5837,-442.0631 471.1418,-446.9062 480.9653,-453.3385 545.1777,-495.3839 689.7136,-686.5148 735.4356,-748.1317"/>
<polygon fill="#007fff" stroke="#007fff" points="732.6811,-750.2934 741.4431,-756.2498 738.308,-746.1294 732.6811,-750.2934"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M749.5833,-384.3385C815.9986,-376.664 833.1552,-384.1235 900.0121,-384.3385"/>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M900.0121,-384.3385C939.7413,-384.4663 983.547,-397.6818 1013.1952,-408.6924"/>
<polygon fill="#ff007f" stroke="#ff007f" points="1012.0903,-412.017 1022.6808,-412.3198 1014.5906,-405.4787 1012.0903,-412.017"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-422.3385C658.5394,-421.2424 678.8556,-404.9724 749.5833,-422.3385"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M448.0222,-433.8009C460.3996,-437.4865 472.5515,-443.5191 480.9653,-453.3385 554.2935,-538.9167 445.9052,-616.8679 516.9653,-704.3385 519.8822,-707.929 523.3608,-711.0039 527.1822,-713.6371"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="525.5988,-716.7642 536.0106,-718.7252 529.0942,-710.6994 525.5988,-716.7642"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M448.1201,-437.0089C468.0692,-440.5362 491.533,-444.685 513.3793,-448.5477"/>
<polygon fill="#00ffff" stroke="#00ffff" points="512.8278,-452.0044 523.2845,-450.2991 514.0467,-445.1113 512.8278,-452.0044"/>
</g>
<!-- sourcefile~datadaylighting.f90&#45;&gt;sourcefile~outputreports.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~datadaylighting.f90&#45;&gt;sourcefile~outputreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.4294,-1063.445C485.4143,-1075.6274 557.8122,-1093.2296 585.7192,-1091.3385"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M900.0121,-1090.3385C1130.556,-1090.3385 1180.086,-693.902 1188.7668,-596.6727"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1192.2657,-596.8317 1189.6145,-586.574 1185.2902,-596.2461 1192.2657,-596.8317"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1091.3385C633.0942,-1088.1283 643.2217,-1075.0281 690.4731,-1070.3385 742.7586,-1065.1493 756.4561,-1064.6852 808.6934,-1070.3385 850.0003,-1074.8089 859.998,-1101.524 900.0121,-1090.3385"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputreports.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.0849,-434.7632C1083.4607,-460.8588 1143.4072,-525.035 1173.1224,-556.8468"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1170.6018,-559.2757 1179.9857,-564.1943 1175.7172,-554.4974 1170.6018,-559.2757"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M406.1977,-755.4822C434.0391,-798.4335 536.4919,-950.1762 585.7192,-936.3385"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-936.3385C738.4012,-893.4202 755.2135,-832.0468 900.0121,-767.3385"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M453.2337,-735.9002C462.9609,-732.9031 472.6405,-728.8417 480.9653,-723.3385 502.9153,-708.8284 497.4995,-694.0424 516.9653,-676.3385 570.2918,-627.8389 601.5931,-639.3246 654.4731,-590.3385 690.4691,-556.9932 722.0041,-508.3762 738.1437,-481.3496"/>
<polygon fill="#7fff00" stroke="#7fff00" points="741.3309,-482.8337 743.3731,-472.4375 735.2935,-479.2911 741.3309,-482.8337"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M453.3172,-739.9798C476.0991,-738.1488 502.6742,-736.0129 526.0122,-734.1372"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="526.4501,-737.6134 536.1375,-733.3234 525.8892,-730.6359 526.4501,-737.6134"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M463.8944,-941.7231C500.0089,-943.3805 545.6456,-943.2456 585.7192,-936.3385"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M419.6763,-925.1923C438.1287,-914.2352 464.7188,-895.8987 480.9653,-873.3385 509.5493,-833.6466 485.8846,-807.1073 516.9653,-769.3385 525.2741,-759.2418 536.8425,-751.1419 548.1224,-744.9429"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="549.7334,-748.0502 557.0391,-740.3771 546.5429,-741.8195 549.7334,-748.0502"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M905.3054,-472.4573C917.3701,-496.7451 949.1578,-555.0981 991.3308,-589.3385 995.6879,-592.8761 1000.623,-596.0064 1005.7231,-598.7495"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1004.47,-602.0325 1014.992,-603.2728 1007.5401,-595.7416 1004.47,-602.0325"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M943.3348,-450.2452C959.6404,-446.0699 978.3674,-441.2746 995.4535,-436.8995"/>
<polygon fill="#ff007f" stroke="#ff007f" points="996.474,-440.2512 1005.2932,-434.38 994.7375,-433.47 996.474,-440.2512"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M900.0121,-767.3385C964.4932,-740.0515 1014.7257,-669.5201 1036.5475,-634.5749"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1039.7236,-636.0888 1041.9372,-625.7278 1033.7455,-632.4469 1039.7236,-636.0888"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.5322,-731.4315C680.8657,-733.793 749.5394,-738.5144 808.6934,-747.3385 849.7868,-753.4685 861.7491,-783.5307 900.0121,-767.3385"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M632.8518,-718.2984C640.7715,-714.8271 648.3832,-710.2822 654.4731,-704.3385 671.3397,-687.8773 723.6276,-537.6219 742.6085,-481.957"/>
<polygon fill="#7fff00" stroke="#7fff00" points="745.9408,-483.0286 745.8449,-472.4342 739.3131,-480.7761 745.9408,-483.0286"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datasurfacecolors.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datasurfacecolors.f90</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M633.556,-740.4319C651.8972,-744.6852 673.0129,-749.5819 692.1613,-754.0224"/>
<polygon fill="#007fff" stroke="#007fff" points="691.4381,-757.4475 701.9703,-756.2971 693.0195,-750.6285 691.4381,-757.4475"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M622.2505,-718.2554C632.9138,-714.4399 644.4016,-709.745 654.4731,-704.3385 729.5729,-664.0249 741.2187,-642.4186 808.6934,-590.3385 824.9577,-577.7849 828.1741,-573.5548 844.6934,-561.3385 906.8583,-515.3665 982.95,-465.4205 1022.2038,-440.0982"/>
<polygon fill="#ff007f" stroke="#ff007f" points="1024.3924,-442.852 1030.9082,-434.4976 1020.6047,-436.9653 1024.3924,-442.852"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M454.0098,-636.3787C463.5586,-639.85 472.9751,-644.3949 480.9653,-650.3385 504.1089,-667.5541 494.281,-686.5223 516.9653,-704.3385 521.7006,-708.0576 527.0397,-711.2565 532.5968,-714.0005"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="531.5255,-717.3537 542.0865,-718.2002 534.3585,-710.9526 531.5255,-717.3537"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M443.6762,-587.7913C456.9917,-590.7792 470.746,-596.072 480.9653,-605.3385 515.6485,-636.7881 483.8591,-671.2329 516.9653,-704.3385 520.4848,-707.8579 524.5378,-710.8857 528.8786,-713.4898"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="527.6232,-716.7807 538.114,-718.262 530.8367,-710.5619 527.6232,-716.7807"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M439.581,-708.9801C464.7885,-712.4918 497.6632,-717.0715 525.8471,-720.9978"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="525.6082,-724.4982 535.9955,-722.4116 526.5741,-717.5652 525.6082,-724.4982"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M399.0839,-156.3385C442.0447,-167.3161 451.862,-179.885 480.9653,-213.3385 504.187,-240.0313 489.4771,-262.0642 516.9653,-284.3385 537.7475,-301.1788 722.8379,-345.9108 749.5833,-346.3385"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M749.5833,-346.3385C780.5131,-346.9588 815.0265,-346.791 843.1852,-346.4316"/>
<polygon fill="#ffff00" stroke="#ffff00" points="843.3032,-349.9304 853.2536,-346.2916 843.2058,-342.9311 843.3032,-349.9304"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-156.3385C441.5531,-167.1905 491.2554,-166.5732 528.6867,-163.5779"/>
<polygon fill="#00ff00" stroke="#00ff00" points="529.2486,-167.042 538.9027,-162.6775 528.634,-160.069 529.2486,-167.042"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M278.6107,-138.7422C313.5217,-141.2138 359.4765,-146.2179 399.0839,-156.3385"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M900.0121,-194.3385C979.3513,-246.0717 1025.2789,-356.6696 1041.5921,-402.6374"/>
<polygon fill="#ff007f" stroke="#ff007f" points="1038.3009,-403.8297 1044.8669,-412.1446 1044.9192,-401.5498 1038.3009,-403.8297"/>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M585.7192,-117.3385C684.9244,-127.4642 713.8685,-111.4769 808.6934,-142.3385 853.1054,-156.7929 860.8893,-168.8285 900.0121,-194.3385"/>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M243.8618,-125.2306C262.2806,-115.689 290.6785,-102.6558 317.2024,-97.3385 388.566,-83.0322 408.5054,-90.4833 480.9653,-97.3385 528.1529,-101.8028 538.8347,-110.3793 585.7192,-117.3385"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M278.8078,-130.3789C295.254,-128.5958 313.4912,-126.6185 330.689,-124.754"/>
<polygon fill="#ff0000" stroke="#ff0000" points="331.1089,-128.229 340.6733,-123.6714 330.3543,-121.2698 331.1089,-128.229"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M585.7192,-576.3385C649.2375,-565.1839 706.7657,-509.7822 733.6169,-480.1363"/>
<polygon fill="#7fff00" stroke="#7fff00" points="736.3533,-482.3253 740.3563,-472.5158 731.1097,-477.688 736.3533,-482.3253"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M441.8372,-517.3543C454.6439,-521.1945 468.5726,-525.9198 480.9653,-531.3385 527.3925,-551.6389 535.8117,-585.1029 585.7192,-576.3385"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M654.2629,-461.3385C671.8168,-461.3385 690.2135,-461.3385 706.1113,-461.3385"/>
<polygon fill="#7fff00" stroke="#7fff00" points="706.1636,-464.8386 716.1636,-461.3385 706.1636,-457.8386 706.1636,-464.8386"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M452.0668,-128.41C476.1254,-133.4374 504.613,-139.3903 529.0936,-144.5058"/>
<polygon fill="#00ff00" stroke="#00ff00" points="528.4574,-147.9484 538.9619,-146.568 529.8893,-141.0964 528.4574,-147.9484"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M457.6622,-114.2948C494.5129,-113.1324 543.0085,-112.9791 585.7192,-117.3385"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M447.846,-222.3033C558.7225,-198.345 825.8691,-147.3568 900.0121,-194.3385"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~outputreports.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M585.7192,-270.3385C603.648,-269.2142 884.515,-185.2531 900.0121,-194.3385"/>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M481.0011,-278.4422C513.8157,-278.5684 551.8119,-276.7922 585.7192,-270.3385"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileoutputreportsf90EfferentGraph = svgPanZoom('#sourcefileoutputreportsf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-1">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-1" class="panel-collapse collapse">

      <a class="list-group-item" href="../proc/reportsurfaces.html">ReportSurfaces</a>

      <a class="list-group-item" href="../proc/linesout.html">LinesOut</a>

      <a class="list-group-item" href="../proc/dxfout.html">DXFOut</a>

      <a class="list-group-item" href="../proc/dxfoutlines.html">DXFOutLines</a>

      <a class="list-group-item" href="../proc/dxfoutwireframe.html">DXFOutWireFrame</a>

      <a class="list-group-item" href="../proc/detailsforsurfaces.html">DetailsForSurfaces</a>

      <a class="list-group-item" href="../proc/costinfoout.html">CostInfoOut</a>

      <a class="list-group-item" href="../proc/vrmlout.html">VRMLOut</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/outputreports.f90.html#src">OutputReports.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">SUBROUTINE </span><span class="n">ReportSurfaces</span>
<a name="ln-2"></a>
<a name="ln-3"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-5"></a>          <span class="c">!       DATE WRITTEN   February 1999</span>
<a name="ln-6"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8"></a>
<a name="ln-9"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10"></a>          <span class="c">! This subroutine calls several optional routines to report</span>
<a name="ln-11"></a>          <span class="c">! the surfaces to output formats that can render the data</span>
<a name="ln-12"></a>          <span class="c">! into a descriptive picture.</span>
<a name="ln-13"></a>
<a name="ln-14"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-15"></a>          <span class="c">! Use a REPORT command to determine if there should be</span>
<a name="ln-16"></a>          <span class="c">! a file created.</span>
<a name="ln-17"></a>
<a name="ln-18"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-19"></a>          <span class="c">! na</span>
<a name="ln-20"></a>
<a name="ln-21"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-22"></a>  <span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-23"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MaxNameLength</span>
<a name="ln-24"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowWarningError</span>
<a name="ln-25"></a>  <span class="k">USE </span><span class="n">DataErrorTracking</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">AskForSurfacesReport</span>
<a name="ln-26"></a>  <span class="k">USE </span><span class="n">DataSurfaceColors</span>
<a name="ln-27"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ScanForReports</span>
<a name="ln-28"></a>
<a name="ln-29"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-30"></a>
<a name="ln-31"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-32"></a>          <span class="c">! na</span>
<a name="ln-33"></a>
<a name="ln-34"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-35"></a>
<a name="ln-36"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-37"></a>          <span class="c">! na</span>
<a name="ln-38"></a>
<a name="ln-39"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-40"></a>          <span class="c">! na</span>
<a name="ln-41"></a>
<a name="ln-42"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-43"></a>  <span class="kt">INTEGER </span><span class="n">SurfDetails</span>
<a name="ln-44"></a>  <span class="kt">LOGICAL </span><span class="n">SurfVert</span>
<a name="ln-45"></a>  <span class="kt">LOGICAL </span><span class="n">SurfDet</span>
<a name="ln-46"></a>  <span class="kt">LOGICAL </span><span class="n">DXFDone</span>
<a name="ln-47"></a>  <span class="kt">LOGICAL </span><span class="n">VRMLDone</span>
<a name="ln-48"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Option1</span>
<a name="ln-49"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Option2</span>
<a name="ln-50"></a>  <span class="kt">LOGICAL </span><span class="n">DoReport</span>
<a name="ln-51"></a>
<a name="ln-52"></a>  <span class="n">AskForSurfacesReport</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-53"></a>
<a name="ln-54"></a>  <span class="n">SurfDetails</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-55"></a>  <span class="n">SurfVert</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-56"></a>  <span class="n">SurfDet</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-57"></a>  <span class="n">DXFDone</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-58"></a>  <span class="n">VRMLDone</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-59"></a>  <span class="n">Option1</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-60"></a>  <span class="n">Option2</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-61"></a>
<a name="ln-62"></a>  <span class="k">CALL </span><span class="n">ScanForReports</span><span class="p">(</span><span class="s1">&#39;Surfaces&#39;</span><span class="p">,</span><span class="n">DoReport</span><span class="p">,</span><span class="s1">&#39;Lines&#39;</span><span class="p">,</span><span class="n">Option1</span><span class="p">)</span>
<a name="ln-63"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DoReport</span><span class="p">)</span> <span class="k">CALL </span><span class="n">LinesOut</span><span class="p">(</span><span class="n">Option1</span><span class="p">)</span>
<a name="ln-64"></a>
<a name="ln-65"></a>  <span class="k">CALL </span><span class="n">ScanForReports</span><span class="p">(</span><span class="s1">&#39;Surfaces&#39;</span><span class="p">,</span><span class="n">DoReport</span><span class="p">,</span><span class="s1">&#39;Vertices&#39;</span><span class="p">)</span>
<a name="ln-66"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DoReport</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-67"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfVert</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-68"></a><span class="k">      </span><span class="n">SurfDetails</span><span class="o">=</span><span class="n">SurfDetails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-69"></a>      <span class="n">SurfVert</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-70"></a>    <span class="n">ENDIF</span>
<a name="ln-71"></a>  <span class="n">ENDIF</span>
<a name="ln-72"></a>
<a name="ln-73"></a>  <span class="k">CALL </span><span class="n">ScanForReports</span><span class="p">(</span><span class="s1">&#39;Surfaces&#39;</span><span class="p">,</span><span class="n">DoReport</span><span class="p">,</span><span class="s1">&#39;Details&#39;</span><span class="p">)</span>
<a name="ln-74"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DoReport</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-75"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfDet</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-76"></a><span class="k">      </span><span class="n">SurfDetails</span><span class="o">=</span><span class="n">SurfDetails</span><span class="o">+</span><span class="mi">10</span>
<a name="ln-77"></a>      <span class="n">SurfDet</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-78"></a>    <span class="n">ENDIF</span>
<a name="ln-79"></a>  <span class="n">ENDIF</span>
<a name="ln-80"></a>
<a name="ln-81"></a>  <span class="k">CALL </span><span class="n">ScanForReports</span><span class="p">(</span><span class="s1">&#39;Surfaces&#39;</span><span class="p">,</span><span class="n">DoReport</span><span class="p">,</span><span class="s1">&#39;DetailsWithVertices&#39;</span><span class="p">)</span>
<a name="ln-82"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DoReport</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-83"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfDet</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-84"></a><span class="k">      </span><span class="n">SurfDetails</span><span class="o">=</span><span class="n">SurfDetails</span><span class="o">+</span><span class="mi">10</span>
<a name="ln-85"></a>      <span class="n">SurfDet</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-86"></a>    <span class="n">ENDIF</span>
<a name="ln-87"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SurfVert</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-88"></a><span class="k">      </span><span class="n">SurfDetails</span><span class="o">=</span><span class="n">SurfDetails</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-89"></a>      <span class="n">SurfVert</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-90"></a>    <span class="n">ENDIF</span>
<a name="ln-91"></a>  <span class="n">ENDIF</span>
<a name="ln-92"></a>
<a name="ln-93"></a>  <span class="k">CALL </span><span class="n">ScanForReports</span><span class="p">(</span><span class="s1">&#39;Surfaces&#39;</span><span class="p">,</span><span class="n">DoReport</span><span class="p">,</span><span class="s1">&#39;DXF&#39;</span><span class="p">,</span><span class="n">Option1</span><span class="o">=</span><span class="n">Option1</span><span class="p">,</span><span class="n">Option2</span><span class="o">=</span><span class="n">Option2</span><span class="p">)</span>
<a name="ln-94"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DoReport</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-95"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DXFDone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-96"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Option2</span> <span class="o">/=</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-97"></a><span class="k">        CALL </span><span class="n">SetUpSchemeColors</span><span class="p">(</span><span class="n">Option2</span><span class="p">,</span><span class="s1">&#39;DXF&#39;</span><span class="p">)</span>
<a name="ln-98"></a>      <span class="n">ENDIF</span>
<a name="ln-99"></a>      <span class="k">CALL </span><span class="n">DXFOut</span><span class="p">(</span><span class="n">Option1</span><span class="p">,</span><span class="n">Option2</span><span class="p">)</span>
<a name="ln-100"></a>      <span class="n">DXFDone</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-101"></a>    <span class="k">ELSE</span>
<a name="ln-102"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;ReportSurfaces: DXF output already generated.  DXF with option=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Option1</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-103"></a>                   <span class="s1">&#39;] will not be generated.&#39;</span><span class="p">)</span>
<a name="ln-104"></a>    <span class="n">ENDIF</span>
<a name="ln-105"></a>  <span class="n">ENDIF</span>
<a name="ln-106"></a>
<a name="ln-107"></a>  <span class="k">CALL </span><span class="n">ScanForReports</span><span class="p">(</span><span class="s1">&#39;Surfaces&#39;</span><span class="p">,</span><span class="n">DoReport</span><span class="p">,</span><span class="s1">&#39;DXF:WireFrame&#39;</span><span class="p">,</span><span class="n">Option1</span><span class="o">=</span><span class="n">Option1</span><span class="p">,</span><span class="n">Option2</span><span class="o">=</span><span class="n">Option2</span><span class="p">)</span>
<a name="ln-108"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DoReport</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-109"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DXFDone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-110"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Option2</span> <span class="o">/=</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-111"></a><span class="k">        CALL </span><span class="n">SetUpSchemeColors</span><span class="p">(</span><span class="n">Option2</span><span class="p">,</span><span class="s1">&#39;DXF&#39;</span><span class="p">)</span>
<a name="ln-112"></a>      <span class="n">ENDIF</span>
<a name="ln-113"></a>      <span class="k">CALL </span><span class="n">DXFOutWireFrame</span><span class="p">(</span><span class="n">Option2</span><span class="p">)</span>
<a name="ln-114"></a>      <span class="n">DXFDone</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-115"></a>    <span class="k">ELSE</span>
<a name="ln-116"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;ReportSurfaces: DXF output already generated.  DXF:WireFrame will not be generated.&#39;</span><span class="p">)</span>
<a name="ln-117"></a>    <span class="n">ENDIF</span>
<a name="ln-118"></a>  <span class="n">ENDIF</span>
<a name="ln-119"></a>
<a name="ln-120"></a>  <span class="k">CALL </span><span class="n">ScanForReports</span><span class="p">(</span><span class="s1">&#39;Surfaces&#39;</span><span class="p">,</span><span class="n">DoReport</span><span class="p">,</span><span class="s1">&#39;VRML&#39;</span><span class="p">,</span><span class="n">Option1</span><span class="p">,</span><span class="n">Option2</span><span class="p">)</span>
<a name="ln-121"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DoReport</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-122"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">VRMLDone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-123"></a><span class="k">      CALL </span><span class="n">VRMLOut</span><span class="p">(</span><span class="n">Option1</span><span class="p">,</span><span class="n">Option2</span><span class="p">)</span>
<a name="ln-124"></a>      <span class="n">VRMLDone</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-125"></a>    <span class="k">ELSE</span>
<a name="ln-126"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;ReportSurfaces: VRML output already generated.  VRML with option=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Option1</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-127"></a>                    <span class="s1">&#39;] will not be generated.&#39;</span><span class="p">)</span>
<a name="ln-128"></a>    <span class="n">ENDIF</span>
<a name="ln-129"></a>  <span class="n">ENDIF</span>
<a name="ln-130"></a>
<a name="ln-131"></a>  <span class="k">CALL </span><span class="n">ScanForReports</span><span class="p">(</span><span class="s1">&#39;Surfaces&#39;</span><span class="p">,</span><span class="n">DoReport</span><span class="p">,</span><span class="s1">&#39;CostInfo&#39;</span><span class="p">)</span>
<a name="ln-132"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DoReport</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-133"></a><span class="k">    CALL </span><span class="n">CostInfoOut</span>
<a name="ln-134"></a>  <span class="n">ENDIF</span>
<a name="ln-135"></a>
<a name="ln-136"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SurfDet</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SurfVert</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-137"></a><span class="k">    CALL </span><span class="n">DetailsForSurfaces</span><span class="p">(</span><span class="n">SurfDetails</span><span class="p">)</span>
<a name="ln-138"></a>  <span class="n">ENDIF</span>
<a name="ln-139"></a>
<a name="ln-140"></a> <span class="k">RETURN</span>
<a name="ln-141"></a>
<a name="ln-142"></a><span class="k">END SUBROUTINE </span><span class="n">ReportSurfaces</span>
<a name="ln-143"></a>
<a name="ln-144"></a><span class="k">SUBROUTINE </span><span class="n">LinesOut</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
<a name="ln-145"></a>
<a name="ln-146"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-147"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-148"></a>          <span class="c">!       DATE WRITTEN   March 1999</span>
<a name="ln-149"></a>          <span class="c">!       MODIFIED       March 2006 -- add option for &quot;IDF segments out&quot;</span>
<a name="ln-150"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-151"></a>
<a name="ln-152"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-153"></a>          <span class="c">! This subroutine produces a file of lines in the surfaces.</span>
<a name="ln-154"></a>
<a name="ln-155"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-156"></a>          <span class="c">! Use the surface absolute coordinate information to produce</span>
<a name="ln-157"></a>          <span class="c">! lines.</span>
<a name="ln-158"></a>
<a name="ln-159"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-160"></a>          <span class="c">! na</span>
<a name="ln-161"></a>
<a name="ln-162"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-163"></a>  <span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-164"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span>
<a name="ln-165"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span>
<a name="ln-166"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowContinueError</span><span class="p">,</span> <span class="n">ShowFatalError</span>
<a name="ln-167"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-168"></a>
<a name="ln-169"></a>
<a name="ln-170"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-171"></a>
<a name="ln-172"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-173"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">option</span>
<a name="ln-174"></a>
<a name="ln-175"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-176"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">fmt700</span><span class="o">=</span><span class="s2">&quot;(5(f10.2,&#39;,&#39;),f10.2)&quot;</span>
<a name="ln-177"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">fmta</span><span class="o">=</span><span class="s2">&quot;(A)&quot;</span>
<a name="ln-178"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">fmtcoord</span><span class="o">=</span><span class="s2">&quot;(2X,2(f10.2,&#39;,&#39;),f10.2,A,A)&quot;</span>
<a name="ln-179"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">vertexstring</span><span class="o">=</span><span class="s1">&#39;X,Y,Z ==&gt; Vertex&#39;</span>
<a name="ln-180"></a>
<a name="ln-181"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-182"></a>          <span class="c">! na</span>
<a name="ln-183"></a>
<a name="ln-184"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-185"></a>          <span class="c">! na</span>
<a name="ln-186"></a>
<a name="ln-187"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-188"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">optiondone</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-189"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">lastoption</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-190"></a>  <span class="kt">integer </span><span class="n">unit</span>              <span class="c">! Unit number on which to write file</span>
<a name="ln-191"></a>  <span class="kt">integer </span><span class="n">surf</span>              <span class="c">! Loop variable for surfaces</span>
<a name="ln-192"></a>  <span class="kt">integer </span><span class="n">vert</span>              <span class="c">! Loop counter</span>
<a name="ln-193"></a>  <span class="kt">integer</span><span class="p">,</span><span class="k">external</span> <span class="kd">::</span> <span class="n">getnewunitnumber</span>  <span class="c">! External function for a new unit number</span>
<a name="ln-194"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">optcommasemi</span>
<a name="ln-195"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">write_stat</span>
<a name="ln-196"></a>
<a name="ln-197"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">totsurfaces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">surface</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-198"></a>    <span class="c">! no error needed, probably in end processing, just return</span>
<a name="ln-199"></a>    <span class="k">return</span>
<a name="ln-200"></a><span class="k">  </span><span class="n">endif</span>
<a name="ln-201"></a>
<a name="ln-202"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">optiondone</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-203"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Report of Surfaces/Lines Option has already been completed with option=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">lastoption</span><span class="p">))</span>
<a name="ln-204"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..option=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Option</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; will not be done this time.&#39;</span><span class="p">)</span>
<a name="ln-205"></a>    <span class="k">return</span>
<a name="ln-206"></a><span class="k">  </span><span class="n">endif</span>
<a name="ln-207"></a>
<a name="ln-208"></a>  <span class="n">lastoption</span><span class="o">=</span><span class="n">option</span>
<a name="ln-209"></a>  <span class="n">optiondone</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-210"></a>
<a name="ln-211"></a>  <span class="n">unit</span><span class="o">=</span><span class="n">getnewunitnumber</span><span class="p">()</span>
<a name="ln-212"></a>  <span class="k">open</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;eplusout.sln&#39;</span><span class="p">,</span> <span class="n">Action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">write_stat</span><span class="p">)</span>
<a name="ln-213"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">write_stat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-214"></a><span class="k">   CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;LinesOut: Could not open file &quot;eplusout.sln&quot; for output (write).&#39;</span><span class="p">)</span>
<a name="ln-215"></a>  <span class="n">endif</span>
<a name="ln-216"></a>
<a name="ln-217"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">option</span> <span class="o">/=</span> <span class="s1">&#39;IDF&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-218"></a><span class="k">    do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-219"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-220"></a><span class="k">      if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-221"></a><span class="k">      write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-222"></a>      <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-223"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">vert</span> <span class="o">/=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-224"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="n">fmt700</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-225"></a>            <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-226"></a>        <span class="k">else</span>
<a name="ln-227"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="n">fmt700</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-228"></a>            <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-229"></a>        <span class="n">endif</span>
<a name="ln-230"></a>      <span class="n">enddo</span>
<a name="ln-231"></a>    <span class="n">enddo</span>
<a name="ln-232"></a>  <span class="k">else</span>
<a name="ln-233"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39; Building North Axis = 0&#39;</span>
<a name="ln-234"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;GlobalGeometryRules,UpperLeftCorner,CounterClockwise,WorldCoordinates;&#39;</span>
<a name="ln-235"></a>    <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-236"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-237"></a><span class="k">      if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-238"></a>      <span class="c">! process heat transfer surfaces</span>
<a name="ln-239"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39; Surface=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Name=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-240"></a>        <span class="s1">&#39;, Azimuth=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">roundsigdigits</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-241"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;  &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">roundsigdigits</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,  !- Number of (X,Y,Z) groups in this surface&#39;</span>
<a name="ln-242"></a>      <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-243"></a>        <span class="n">optcommasemi</span><span class="o">=</span><span class="s1">&#39;,&#39;</span>
<a name="ln-244"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">vert</span> <span class="o">==</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span> <span class="n">optcommasemi</span><span class="o">=</span><span class="s1">&#39;;&#39;</span>
<a name="ln-245"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="n">fmtcoord</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-246"></a>           <span class="n">optcommasemi</span><span class="p">,</span><span class="s1">&#39;  !- &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">vertexstring</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">roundsigdigits</span><span class="p">(</span><span class="n">vert</span><span class="p">))</span>
<a name="ln-247"></a>      <span class="n">enddo</span>
<a name="ln-248"></a>    <span class="n">enddo</span>
<a name="ln-249"></a>  <span class="n">endif</span>
<a name="ln-250"></a>
<a name="ln-251"></a>  <span class="k">close</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
<a name="ln-252"></a>
<a name="ln-253"></a>  <span class="k">return</span>
<a name="ln-254"></a>
<a name="ln-255"></a><span class="k">END SUBROUTINE </span><span class="n">LinesOut</span>
<a name="ln-256"></a>
<a name="ln-257"></a><span class="k">SUBROUTINE </span><span class="n">DXFOut</span><span class="p">(</span><span class="n">PolygonAction</span><span class="p">,</span><span class="n">ColorScheme</span><span class="p">)</span>
<a name="ln-258"></a>
<a name="ln-259"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-260"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-261"></a>          <span class="c">!       DATE WRITTEN   March 1999</span>
<a name="ln-262"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-263"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-264"></a>
<a name="ln-265"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-266"></a>          <span class="c">! This subroutine produces a file of DXF objects for the surfaces.</span>
<a name="ln-267"></a>
<a name="ln-268"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-269"></a>          <span class="c">! Use the surface absolute coordinate information to produce</span>
<a name="ln-270"></a>          <span class="c">! lines.</span>
<a name="ln-271"></a>
<a name="ln-272"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-273"></a>          <span class="c">! na</span>
<a name="ln-274"></a>
<a name="ln-275"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-276"></a>  <span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-277"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">BuildingName</span><span class="p">,</span><span class="n">Zone</span>
<a name="ln-278"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span>
<a name="ln-279"></a>  <span class="k">USE </span><span class="n">DataSurfaceColors</span>
<a name="ln-280"></a>  <span class="k">USE </span><span class="n">DataDaylighting</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneDaylight</span><span class="p">,</span><span class="n">TotIllumMaps</span><span class="p">,</span><span class="n">IllumMapCalc</span>
<a name="ln-281"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DegToRadians</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-282"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowContinueError</span><span class="p">,</span> <span class="n">ShowFatalError</span>
<a name="ln-283"></a>  <span class="k">USE </span><span class="n">DataStringGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">VerString</span>
<a name="ln-284"></a>  <span class="k">USE </span><span class="n">DXFEarClipping</span>
<a name="ln-285"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-286"></a>
<a name="ln-287"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-288"></a>
<a name="ln-289"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-290"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PolygonAction</span>
<a name="ln-291"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ColorScheme</span>    <span class="c">! Name from user for color scheme or blank</span>
<a name="ln-292"></a>
<a name="ln-293"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-294"></a>          <span class="c">! na</span>
<a name="ln-295"></a>
<a name="ln-296"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-297"></a>          <span class="c">! na</span>
<a name="ln-298"></a>
<a name="ln-299"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-300"></a>          <span class="c">! na</span>
<a name="ln-301"></a>
<a name="ln-302"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-303"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StemX</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-304"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StemY</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-305"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StemZ</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-306"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head1X</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-307"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head1Y</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">2.133975d0</span><span class="p">,</span><span class="mf">2.133975d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-308"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head1Z</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-309"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head2X</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-310"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head2Y</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">2.133975d0</span><span class="p">,</span><span class="mf">2.133975d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-311"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head2Z</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-312"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide1X</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-313"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide1Y</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-314"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide1Z</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-315"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide2X</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-316"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide2Y</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-317"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide2Z</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-318"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide3X</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mf">9.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-319"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide3Y</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-320"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide3Z</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-321"></a><span class="c">!  integer, dimension(7) :: colorno=(/3,4,5,6,2,8,9/)</span>
<a name="ln-322"></a>  <span class="kt">integer </span><span class="n">unit</span>              <span class="c">! Unit number on which to write file</span>
<a name="ln-323"></a>  <span class="kt">integer </span><span class="n">surf</span>              <span class="c">! Loop variable for surfaces</span>
<a name="ln-324"></a>  <span class="kt">integer </span><span class="n">vert</span>              <span class="c">! Loop counter</span>
<a name="ln-325"></a>  <span class="kt">integer</span><span class="p">,</span><span class="k">external</span> <span class="kd">::</span> <span class="n">getnewunitnumber</span>  <span class="c">! External function for a new unit number</span>
<a name="ln-326"></a>  <span class="kt">integer </span><span class="n">colorindex</span>        <span class="c">! color index by surface type</span>
<a name="ln-327"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">minx</span>                 <span class="c">! minimum x in surface data</span>
<a name="ln-328"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">miny</span>                 <span class="c">! minimum y in surface data</span>
<a name="ln-329"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">minz</span>                 <span class="c">! minimum z in surface data (for polygon output)</span>
<a name="ln-330"></a>  <span class="kt">integer </span><span class="n">zones</span>             <span class="c">! loop counter for zone loop</span>
<a name="ln-331"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span> <span class="n">zonenum</span>
<a name="ln-332"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="n">TempZoneName</span>
<a name="ln-333"></a>  <span class="kt">integer </span><span class="n">pos</span>
<a name="ln-334"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span> <span class="n">ShadeType</span>
<a name="ln-335"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ThickPolyline</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-336"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">RegularPolyline</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-337"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PolylineWidth</span><span class="o">=</span><span class="s1">&#39; 0.55&#39;</span>
<a name="ln-338"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">TriangulateFace</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-339"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ntri</span>
<a name="ln-340"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">svert</span>
<a name="ln-341"></a>  <span class="k">type</span> <span class="p">(</span><span class="n">dTriangle</span><span class="p">),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">mytriangles</span>
<a name="ln-342"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">vv0</span>
<a name="ln-343"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">vv1</span>
<a name="ln-344"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">vv2</span>
<a name="ln-345"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">refpt</span>  <span class="c">! for daylighting ref points</span>
<a name="ln-346"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">curcolorno</span> <span class="c">! again for daylighting ref pts</span>
<a name="ln-347"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">write_stat</span>
<a name="ln-348"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">mapnum</span>
<a name="ln-349"></a>
<a name="ln-350"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">PolygonAction</span> <span class="o">==</span> <span class="s1">&#39;TRIANGULATE3DFACE&#39;</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">PolygonAction</span> <span class="o">==</span> <span class="s1">&#39;TRIANGULATE&#39;</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">PolygonAction</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-351"></a><span class="k">    </span><span class="n">TriangulateFace</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-352"></a>    <span class="n">RegularPolyline</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-353"></a>    <span class="n">ThickPolyline</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-354"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">PolygonAction</span> <span class="o">==</span> <span class="s1">&#39;THICKPOLYLINE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-355"></a><span class="k">    </span><span class="n">ThickPolyline</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-356"></a>    <span class="n">RegularPolyline</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-357"></a>    <span class="n">TriangulateFace</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-358"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">PolygonAction</span> <span class="o">==</span> <span class="s1">&#39;REGULARPOLYLINE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-359"></a><span class="k">    </span><span class="n">RegularPolyline</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-360"></a>    <span class="n">TriangulateFace</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-361"></a>    <span class="n">ThickPolyline</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-362"></a>    <span class="n">PolylineWidth</span><span class="o">=</span><span class="s1">&#39; 0&#39;</span>
<a name="ln-363"></a>  <span class="k">ELSE</span>
<a name="ln-364"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;DXFOut: Illegal key specified for Surfaces with &gt; 4 sides=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolygonAction</span><span class="p">))</span>
<a name="ln-365"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Valid keys are: &quot;ThickPolyline&quot;, &quot;RegularPolyline&quot;, &quot;Triangulate3DFace&quot;.&#39;</span><span class="p">)</span>
<a name="ln-366"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;&quot;Triangulate3DFace&quot; will be used for any surfaces with &gt; 4 sides.&#39;</span><span class="p">)</span>
<a name="ln-367"></a>    <span class="n">TriangulateFace</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-368"></a>    <span class="n">RegularPolyline</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-369"></a>    <span class="n">ThickPolyline</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-370"></a>  <span class="n">ENDIF</span>
<a name="ln-371"></a>
<a name="ln-372"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">totsurfaces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">surface</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-373"></a>    <span class="c">! no error needed, probably in end processing, just return</span>
<a name="ln-374"></a>    <span class="k">return</span>
<a name="ln-375"></a><span class="k">  </span><span class="n">endif</span>
<a name="ln-376"></a>
<a name="ln-377"></a>  <span class="n">unit</span><span class="o">=</span><span class="n">getnewunitnumber</span><span class="p">()</span>
<a name="ln-378"></a>  <span class="k">open</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;eplusout.dxf&#39;</span><span class="p">,</span> <span class="n">Action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">write_stat</span><span class="p">)</span>
<a name="ln-379"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">write_stat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-380"></a><span class="k">   CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;DXFOut: Could not open file &quot;eplusout.dxf&quot; for output (write).&#39;</span><span class="p">)</span>
<a name="ln-381"></a>  <span class="n">endif</span>
<a name="ln-382"></a>
<a name="ln-383"></a>
<a name="ln-384"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">702</span><span class="p">)</span>   <span class="c">! Start of Entities section</span>
<a name="ln-385"></a>  <span class="mi">702</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;SECTION&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  2&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;ENTITIES&#39;</span><span class="p">)</span>
<a name="ln-386"></a>
<a name="ln-387"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">707</span><span class="p">)</span>    <span class="c">! Comment</span>
<a name="ln-388"></a>  <span class="mi">707</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;999&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;DXF created from EnergyPlus&#39;</span><span class="p">)</span>
<a name="ln-389"></a>
<a name="ln-390"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">708</span><span class="p">)</span> <span class="s1">&#39;Program Version&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VerString</span><span class="p">)</span>
<a name="ln-391"></a>  <span class="mi">708</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;999&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-392"></a>
<a name="ln-393"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">PolygonAction</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-394"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">708</span><span class="p">)</span> <span class="s1">&#39;Polygon Action&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;ThickPolyline&#39;</span>
<a name="ln-395"></a>  <span class="k">ELSE</span>
<a name="ln-396"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">708</span><span class="p">)</span> <span class="s1">&#39;Polygon Action&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolygonAction</span><span class="p">)</span>
<a name="ln-397"></a>  <span class="n">ENDIF</span>
<a name="ln-398"></a>
<a name="ln-399"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ColorScheme</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-400"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">708</span><span class="p">)</span> <span class="s1">&#39;Color Scheme&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;Default&#39;</span>
<a name="ln-401"></a>  <span class="k">ELSE</span>
<a name="ln-402"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">708</span><span class="p">)</span> <span class="s1">&#39;Color Scheme&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ColorScheme</span><span class="p">)</span>
<a name="ln-403"></a>  <span class="n">ENDIF</span>
<a name="ln-404"></a>
<a name="ln-405"></a>  <span class="n">minx</span><span class="o">=</span><span class="mi">9999</span><span class="mf">9.d0</span>
<a name="ln-406"></a>  <span class="n">miny</span><span class="o">=</span><span class="mi">9999</span><span class="mf">9.d0</span>
<a name="ln-407"></a>  <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-408"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-409"></a><span class="k">    do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-410"></a>      <span class="n">minx</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">minx</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-411"></a>      <span class="n">miny</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">miny</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-412"></a>    <span class="n">enddo</span>
<a name="ln-413"></a>  <span class="n">enddo</span>
<a name="ln-414"></a>
<a name="ln-415"></a>  <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-416"></a>    <span class="n">StemX</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">StemX</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-417"></a>    <span class="n">StemY</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">StemY</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-418"></a>    <span class="n">Head1X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">Head1X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-419"></a>    <span class="n">Head1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">Head1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-420"></a>    <span class="n">Head2X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">Head2X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-421"></a>    <span class="n">Head2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">Head2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-422"></a>    <span class="n">NSide1X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide1X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-423"></a>    <span class="n">NSide1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-424"></a>    <span class="n">NSide2X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide2X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-425"></a>    <span class="n">NSide2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-426"></a>    <span class="n">NSide3X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide3X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-427"></a>    <span class="n">NSide3Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide3Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-428"></a>  <span class="n">enddo</span>
<a name="ln-429"></a>
<a name="ln-430"></a>  <span class="c">! This writes &quot;True North&quot; above the Arrow Head</span>
<a name="ln-431"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Text - True North&#39;</span>
<a name="ln-432"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">800</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),</span><span class="n">StemX</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0d0</span> <span class="p">,</span><span class="n">StemY</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">StemZ</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-433"></a>  <span class="mi">800</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;TEXT&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  6&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;Continuous&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-434"></a>    <span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-435"></a>    <span class="s1">&#39; 40&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; .25&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  1&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;True North&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 41&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  7&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;MONOTXT&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-436"></a>    <span class="s1">&#39;210&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;220&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;230&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
<a name="ln-437"></a>
<a name="ln-438"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Text - Building Title&#39;</span>
<a name="ln-439"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">801</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),</span><span class="n">StemX</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">4.0d0</span><span class="p">,</span><span class="n">StemY</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">4.0d0</span> <span class="p">,</span><span class="n">StemZ</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;Building - &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BuildingName</span><span class="p">)</span>
<a name="ln-440"></a>  <span class="mi">801</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;TEXT&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  6&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;Continuous&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-441"></a>    <span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-442"></a>    <span class="s1">&#39; 40&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; .4&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  1&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 41&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  7&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;MONOTXT&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-443"></a>    <span class="s1">&#39;210&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;220&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;230&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
<a name="ln-444"></a>
<a name="ln-445"></a>  <span class="c">! We want to point the north arrow to true north</span>
<a name="ln-446"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Stem&#39;</span>
<a name="ln-447"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">StemX</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">StemY</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">StemZ</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-448"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Head 1&#39;</span>
<a name="ln-449"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">Head1X</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">Head1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">Head1Z</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-450"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Head 2&#39;</span>
<a name="ln-451"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">Head2X</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">Head2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">Head2Z</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-452"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Side 1&#39;</span>
<a name="ln-453"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">NSide1X</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide1Z</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-454"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Side 2&#39;</span>
<a name="ln-455"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">NSide2X</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide2Z</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-456"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Side 3&#39;</span>
<a name="ln-457"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">NSide3X</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide3Y</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide3Z</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-458"></a>
<a name="ln-459"></a>  <span class="mi">703</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;3DFACE&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-460"></a>    <span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-461"></a>    <span class="s1">&#39; 11&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 21&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 31&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-462"></a>    <span class="s1">&#39; 12&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 22&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 32&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-463"></a>    <span class="s1">&#39; 13&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 23&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 33&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-464"></a>
<a name="ln-465"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Zone Names&#39;</span>
<a name="ln-466"></a>  <span class="k">do </span><span class="n">zones</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-467"></a>    <span class="k">write</span><span class="p">(</span><span class="n">zonenum</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">zones</span>
<a name="ln-468"></a>    <span class="n">zonenum</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)</span>
<a name="ln-469"></a>    <span class="n">TempZoneName</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">Zones</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-470"></a>    <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-471"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-472"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-473"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-474"></a>    <span class="k">END DO</span>
<a name="ln-475"></a><span class="k">    </span><span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-476"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-477"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-478"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-479"></a>    <span class="k">END DO</span>
<a name="ln-480"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Zone=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)</span>
<a name="ln-481"></a>  <span class="n">enddo</span>
<a name="ln-482"></a>
<a name="ln-483"></a>  <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_ShdDetFix</span>
<a name="ln-484"></a>  <span class="c">!  Do all detached shading surfaces first</span>
<a name="ln-485"></a>  <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-486"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">heattranssurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-487"></a><span class="k">    if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_Shading</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-488"></a><span class="k">    if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-489"></a><span class="k">    if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Detached_F</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_ShdDetFix</span>
<a name="ln-490"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Detached_B</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_ShdDetBldg</span>
<a name="ln-491"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">isPV</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_PV</span>
<a name="ln-492"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Detached_F</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-493"></a><span class="k">      </span><span class="n">ShadeType</span><span class="o">=</span><span class="s1">&#39;Fixed Shading&#39;</span>
<a name="ln-494"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Fixed Shading:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-495"></a>    <span class="n">elseif</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Detached_B</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-496"></a><span class="k">      </span><span class="n">ShadeType</span><span class="o">=</span><span class="s1">&#39;Building Shading&#39;</span>
<a name="ln-497"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Building Shading:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-498"></a>    <span class="n">endif</span>
<a name="ln-499"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-500"></a><span class="k">      write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">704</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ShadeType</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">),(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-501"></a>                      <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-502"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-503"></a><span class="k">        write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-504"></a>      <span class="k">else</span>
<a name="ln-505"></a><span class="k">        write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-506"></a>      <span class="n">endif</span>
<a name="ln-507"></a>    <span class="k">else</span>  <span class="c">! polygon</span>
<a name="ln-508"></a>      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TriangulateFace</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-509"></a><span class="k">        </span><span class="n">minz</span><span class="o">=</span><span class="mi">9999</span><span class="mf">9.d0</span>
<a name="ln-510"></a>        <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-511"></a>          <span class="n">minz</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">minz</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-512"></a>        <span class="n">enddo</span>
<a name="ln-513"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">715</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ShadeType</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">),</span><span class="n">minz</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">)</span>
<a name="ln-514"></a>        <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-515"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">716</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ShadeType</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-516"></a>                          <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-517"></a>        <span class="n">enddo</span>
<a name="ln-518"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">717</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ShadeType</span><span class="p">)</span>
<a name="ln-519"></a>      <span class="k">else</span>
<a name="ln-520"></a><span class="k">        </span><span class="n">ntri</span><span class="o">=</span><span class="n">triangulate</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">,</span><span class="n">mytriangles</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">azimuth</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-521"></a>                   <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">tilt</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">name</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span><span class="p">)</span>
<a name="ln-522"></a>        <span class="k">do </span><span class="n">svert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntri</span>
<a name="ln-523"></a>            <span class="n">vv0</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv0</span>
<a name="ln-524"></a>            <span class="n">vv1</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv1</span>
<a name="ln-525"></a>            <span class="n">vv2</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv2</span>
<a name="ln-526"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">704</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ShadeType</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-527"></a>            <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv0</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv0</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv0</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-528"></a>            <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv1</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv1</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv1</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-529"></a>            <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-530"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-531"></a>        <span class="n">enddo</span>
<a name="ln-532"></a>        <span class="k">deallocate</span><span class="p">(</span><span class="n">mytriangles</span><span class="p">)</span>
<a name="ln-533"></a>      <span class="n">endif</span>
<a name="ln-534"></a>    <span class="n">endif</span>
<a name="ln-535"></a>  <span class="n">enddo</span>
<a name="ln-536"></a>
<a name="ln-537"></a>  <span class="c">! now do zone surfaces, by zone</span>
<a name="ln-538"></a>  <span class="k">do </span><span class="n">zones</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-539"></a>    <span class="n">TempZoneName</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">Zones</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-540"></a>    <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-541"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-542"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-543"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-544"></a>    <span class="k">END DO</span>
<a name="ln-545"></a><span class="k">    </span><span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-546"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-547"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-548"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-549"></a>    <span class="k">END DO</span>
<a name="ln-550"></a><span class="k">    do </span><span class="n">surf</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">surfacefirst</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">surfacelast</span>
<a name="ln-551"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-552"></a><span class="k">      if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-553"></a><span class="k">      if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_Wall</span>
<a name="ln-554"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_Roof</span>
<a name="ln-555"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_Floor</span>
<a name="ln-556"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_Door</span>
<a name="ln-557"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-558"></a><span class="k">        if</span> <span class="p">(</span><span class="n">surfacewindow</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">originalclass</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_Window</span>
<a name="ln-559"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">surfacewindow</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">originalclass</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_GlassDoor</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_GlassDoor</span>
<a name="ln-560"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">surfacewindow</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">originalclass</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_TDDDome</span>
<a name="ln-561"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">surfacewindow</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">originalclass</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_TDDDiffuser</span>
<a name="ln-562"></a>      <span class="n">endif</span>
<a name="ln-563"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">isPV</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_PV</span>
<a name="ln-564"></a>
<a name="ln-565"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-566"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-567"></a><span class="k">        write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">704</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">),(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-568"></a>                        <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-569"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-570"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-571"></a>        <span class="k">else</span>
<a name="ln-572"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-573"></a>        <span class="n">endif</span>
<a name="ln-574"></a>      <span class="k">else</span>  <span class="c">! polygon surface</span>
<a name="ln-575"></a>        <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TriangulateFace</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-576"></a><span class="k">          </span><span class="n">minz</span><span class="o">=</span><span class="mi">9999</span><span class="mf">9.d0</span>
<a name="ln-577"></a>          <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-578"></a>            <span class="n">minz</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">minz</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-579"></a>          <span class="n">enddo</span>
<a name="ln-580"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">715</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">),</span><span class="n">minz</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">)</span>
<a name="ln-581"></a>          <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-582"></a>            <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">716</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-583"></a>                          <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-584"></a>          <span class="n">enddo</span>
<a name="ln-585"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">717</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)</span>
<a name="ln-586"></a>        <span class="k">else</span>
<a name="ln-587"></a><span class="k">          </span><span class="n">ntri</span><span class="o">=</span><span class="n">triangulate</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">,</span><span class="n">mytriangles</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">azimuth</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-588"></a>                   <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">tilt</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">name</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span><span class="p">)</span>
<a name="ln-589"></a>          <span class="k">do </span><span class="n">svert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntri</span>
<a name="ln-590"></a>            <span class="n">vv0</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv0</span>
<a name="ln-591"></a>            <span class="n">vv1</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv1</span>
<a name="ln-592"></a>            <span class="n">vv2</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv2</span>
<a name="ln-593"></a>            <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">704</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-594"></a>              <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv0</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv0</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv0</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-595"></a>              <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv1</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv1</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv1</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-596"></a>              <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-597"></a>            <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-598"></a>          <span class="n">enddo</span>
<a name="ln-599"></a>          <span class="k">deallocate</span><span class="p">(</span><span class="n">mytriangles</span><span class="p">)</span>
<a name="ln-600"></a>        <span class="n">endif</span>
<a name="ln-601"></a>      <span class="n">endif</span>
<a name="ln-602"></a> <span class="mi">715</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;POLYLINE&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 66&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  1&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-603"></a>    <span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-604"></a>    <span class="s1">&#39; 70&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;   9&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 40&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 41&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-605"></a> <span class="mi">716</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="s1">&#39;VERTEX&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-606"></a>    <span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-607"></a> <span class="mi">717</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="s1">&#39;SEQEND&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-608"></a>
<a name="ln-609"></a>    <span class="n">enddo</span>
<a name="ln-610"></a>    <span class="c">! still have to do shading surfaces for zone</span>
<a name="ln-611"></a>    <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-612"></a>      <span class="c">!if (surface(surf)%heattranssurf) CYCLE ! Shading with a construction is allowed to be HT surf for daylighting shelves</span>
<a name="ln-613"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">SurfaceClass_Shading</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-614"></a><span class="k">      if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">zonename</span> <span class="o">/=</span> <span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-615"></a><span class="k">      if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-616"></a><span class="k">      </span><span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_ShdAtt</span>
<a name="ln-617"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">isPV</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_PV</span>
<a name="ln-618"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-619"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-620"></a><span class="k">        write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">704</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">),(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-621"></a>                        <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-622"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-623"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-624"></a>        <span class="k">else</span>
<a name="ln-625"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="mi">4</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-626"></a>        <span class="n">endif</span>
<a name="ln-627"></a>      <span class="k">else</span>  <span class="c">! polygon attached shading</span>
<a name="ln-628"></a>        <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TriangulateFace</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-629"></a><span class="k">          </span><span class="n">minz</span><span class="o">=</span><span class="mi">9999</span><span class="mf">9.d0</span>
<a name="ln-630"></a>          <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-631"></a>            <span class="n">minz</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">minz</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-632"></a>          <span class="n">enddo</span>
<a name="ln-633"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">715</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">),</span><span class="n">minz</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">)</span>
<a name="ln-634"></a>          <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-635"></a>            <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">716</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-636"></a>                          <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-637"></a>          <span class="n">enddo</span>
<a name="ln-638"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">717</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)</span>
<a name="ln-639"></a>        <span class="k">else</span>
<a name="ln-640"></a><span class="k">          if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="nb">shape</span> <span class="o">==</span> <span class="n">RectangularOverhang</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-641"></a><span class="k">            </span><span class="n">ntri</span><span class="o">=</span><span class="n">triangulate</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">,</span><span class="n">mytriangles</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">azimuth</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-642"></a>                   <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">tilt</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">name</span><span class="p">,</span><span class="n">SurfaceClass_Overhang</span><span class="p">)</span>
<a name="ln-643"></a>          <span class="k">else</span>
<a name="ln-644"></a><span class="k">            </span><span class="n">ntri</span><span class="o">=</span><span class="n">triangulate</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">,</span><span class="n">mytriangles</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">azimuth</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-645"></a>                   <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">tilt</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">name</span><span class="p">,</span><span class="n">SurfaceClass_Fin</span><span class="p">)</span>
<a name="ln-646"></a>          <span class="n">endif</span>
<a name="ln-647"></a>          <span class="k">do </span><span class="n">svert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntri</span>
<a name="ln-648"></a>            <span class="n">vv0</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv0</span>
<a name="ln-649"></a>            <span class="n">vv1</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv1</span>
<a name="ln-650"></a>            <span class="n">vv2</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv2</span>
<a name="ln-651"></a>            <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">704</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-652"></a>              <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv0</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv0</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv0</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-653"></a>              <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv1</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv1</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv1</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-654"></a>              <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-655"></a>            <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vv2</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-656"></a>          <span class="n">enddo</span>
<a name="ln-657"></a>          <span class="k">deallocate</span><span class="p">(</span><span class="n">mytriangles</span><span class="p">)</span>
<a name="ln-658"></a>        <span class="n">endif</span>
<a name="ln-659"></a>      <span class="n">endif</span>
<a name="ln-660"></a>    <span class="n">enddo</span>
<a name="ln-661"></a>  <span class="n">enddo</span>
<a name="ln-662"></a>
<a name="ln-663"></a>  <span class="mi">704</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;3DFACE&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-664"></a>    <span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-665"></a>    <span class="s1">&#39; 11&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 21&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 31&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-666"></a>    <span class="s1">&#39; 12&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 22&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 32&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-667"></a>
<a name="ln-668"></a>  <span class="mi">705</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39; 13&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 23&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 33&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-669"></a>
<a name="ln-670"></a><span class="c">!  711 format(&#39;  0&#39;,/,&#39;LINE&#39;,/,&#39;  8&#39;,/,A,/,&#39; 62&#39;,/,I3)</span>
<a name="ln-671"></a><span class="c">!  712 format(&#39; 10&#39;,/,f15.5,/,&#39; 20&#39;,/,f15.5,/,&#39; 30&#39;,/,f15.5,/,  &amp;</span>
<a name="ln-672"></a><span class="c">!             &#39; 11&#39;,/,f15.5,/,&#39; 21&#39;,/,f15.5,/,&#39; 31&#39;,/,f15.5)</span>
<a name="ln-673"></a>
<a name="ln-674"></a>
<a name="ln-675"></a>
<a name="ln-676"></a>  <span class="c">! Do any daylighting reference points on layer for zone</span>
<a name="ln-677"></a>  <span class="k">do </span><span class="n">zones</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">numofzones</span>
<a name="ln-678"></a>    <span class="n">curcolorno</span><span class="o">=</span><span class="n">colorno_DaylSensor1</span>
<a name="ln-679"></a>    <span class="n">TempZoneName</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">Zones</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-680"></a>    <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-681"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-682"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-683"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-684"></a>    <span class="k">END DO</span>
<a name="ln-685"></a><span class="k">    </span><span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-686"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-687"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-688"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-689"></a>    <span class="k">END DO</span>
<a name="ln-690"></a><span class="k">    do </span><span class="n">refpt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span>
<a name="ln-691"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:DayRefPt:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">refpt</span><span class="p">))</span>
<a name="ln-692"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">709</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">curcolorno</span><span class="p">),</span><span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-693"></a>                      <span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>             <span class="p">&amp;</span>
<a name="ln-694"></a>                      <span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">3</span><span class="p">),.</span><span class="mi">2</span>
<a name="ln-695"></a>      <span class="n">curcolorno</span><span class="o">=</span><span class="n">colorno_DaylSensor2</span>  <span class="c">! ref pts 2 and later are this color</span>
<a name="ln-696"></a>    <span class="n">enddo</span>
<a name="ln-697"></a>  <span class="n">enddo</span>
<a name="ln-698"></a>
<a name="ln-699"></a>  <span class="k">do </span><span class="n">zones</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">numofzones</span>
<a name="ln-700"></a>    <span class="n">curcolorno</span><span class="o">=</span><span class="n">colorno_DaylSensor1</span>
<a name="ln-701"></a>    <span class="n">TempZoneName</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">Zones</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-702"></a>    <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-703"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-704"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-705"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-706"></a>    <span class="k">END DO</span>
<a name="ln-707"></a><span class="k">    </span><span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-708"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-709"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-710"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-711"></a>    <span class="k">END DO</span>
<a name="ln-712"></a><span class="k">    do </span><span class="n">mapnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totillummaps</span>
<a name="ln-713"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">mapnum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">/=</span> <span class="n">zones</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-714"></a><span class="k">      do </span><span class="n">refpt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">mapnum</span><span class="p">)%</span><span class="n">TotalMapRefPoints</span>
<a name="ln-715"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:MapRefPt:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">refpt</span><span class="p">))</span>
<a name="ln-716"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">709</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">curcolorno</span><span class="p">),</span><span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">mapnum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-717"></a>                        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">mapnum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>             <span class="p">&amp;</span>
<a name="ln-718"></a>                        <span class="n">IllumMapCalc</span><span class="p">(</span><span class="n">mapnum</span><span class="p">)%</span><span class="n">MapRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">3</span><span class="p">),.</span><span class="mi">05</span>
<a name="ln-719"></a>      <span class="n">enddo</span>
<a name="ln-720"></a>    <span class="n">enddo</span>
<a name="ln-721"></a>  <span class="n">enddo</span>
<a name="ln-722"></a>
<a name="ln-723"></a>  <span class="c">! now do DElight reference points</span>
<a name="ln-724"></a>  <span class="k">do </span><span class="n">zones</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">numofzones</span>
<a name="ln-725"></a>    <span class="n">curcolorno</span><span class="o">=</span><span class="n">colorno_DaylSensor1</span>
<a name="ln-726"></a>    <span class="n">TempZoneName</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">Zones</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-727"></a>    <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-728"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-729"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-730"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-731"></a>    <span class="k">END DO</span>
<a name="ln-732"></a><span class="k">    </span><span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-733"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-734"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-735"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-736"></a>    <span class="k">END DO</span>
<a name="ln-737"></a><span class="k">    do </span><span class="n">refpt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">TotalDElightRefPts</span>
<a name="ln-738"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:DEDayRefPt:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">refpt</span><span class="p">))</span>
<a name="ln-739"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">709</span><span class="p">)</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">curcolorno</span><span class="p">),</span><span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-740"></a>                      <span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>             <span class="p">&amp;</span>
<a name="ln-741"></a>                      <span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">3</span><span class="p">),.</span><span class="mi">2</span>
<a name="ln-742"></a>      <span class="n">curcolorno</span><span class="o">=</span><span class="n">colorno_DaylSensor2</span>  <span class="c">! ref pts 2 and later are this color</span>
<a name="ln-743"></a>    <span class="n">enddo</span>
<a name="ln-744"></a>  <span class="n">enddo</span>
<a name="ln-745"></a>
<a name="ln-746"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">706</span><span class="p">)</span>
<a name="ln-747"></a>  <span class="mi">706</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;ENDSEC&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;EOF&#39;</span><span class="p">)</span>
<a name="ln-748"></a>
<a name="ln-749"></a>  <span class="mi">709</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;CIRCLE&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-750"></a>    <span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-751"></a>    <span class="s1">&#39; 40&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-752"></a>
<a name="ln-753"></a>
<a name="ln-754"></a>  <span class="mi">710</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;999&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-755"></a>
<a name="ln-756"></a>  <span class="k">close</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
<a name="ln-757"></a>
<a name="ln-758"></a>  <span class="k">return</span>
<a name="ln-759"></a>
<a name="ln-760"></a><span class="k">END SUBROUTINE </span><span class="n">DXFOut</span>
<a name="ln-761"></a>
<a name="ln-762"></a><span class="k">SUBROUTINE </span><span class="n">DXFOutLines</span><span class="p">(</span><span class="n">ColorScheme</span><span class="p">)</span>
<a name="ln-763"></a>
<a name="ln-764"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-765"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-766"></a>          <span class="c">!       DATE WRITTEN   August 2005</span>
<a name="ln-767"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-768"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-769"></a>
<a name="ln-770"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-771"></a>          <span class="c">! This subroutine produces a points file of lines in the surfaces.</span>
<a name="ln-772"></a>
<a name="ln-773"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-774"></a>          <span class="c">! Use the surface absolute coordinate information to produce</span>
<a name="ln-775"></a>          <span class="c">! lines.</span>
<a name="ln-776"></a>
<a name="ln-777"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-778"></a>          <span class="c">! na</span>
<a name="ln-779"></a>
<a name="ln-780"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-781"></a>  <span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-782"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">BuildingName</span><span class="p">,</span><span class="n">Zone</span>
<a name="ln-783"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span>
<a name="ln-784"></a>  <span class="k">USE </span><span class="n">DataSurfaceColors</span>
<a name="ln-785"></a>  <span class="k">USE </span><span class="n">DataDaylighting</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneDaylight</span>
<a name="ln-786"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DegToRadians</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-787"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowContinueError</span><span class="p">,</span> <span class="n">ShowFatalError</span>
<a name="ln-788"></a>  <span class="k">USE </span><span class="n">DataStringGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">VerString</span>
<a name="ln-789"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-790"></a>
<a name="ln-791"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-792"></a>
<a name="ln-793"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-794"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ColorScheme</span>
<a name="ln-795"></a>
<a name="ln-796"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-797"></a>          <span class="c">! na</span>
<a name="ln-798"></a>
<a name="ln-799"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-800"></a>          <span class="c">! na</span>
<a name="ln-801"></a>
<a name="ln-802"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-803"></a>          <span class="c">! na</span>
<a name="ln-804"></a>
<a name="ln-805"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-806"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StemX</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-807"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StemY</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-808"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StemZ</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-809"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head1X</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-810"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head1Y</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">2.133975d0</span><span class="p">,</span><span class="mf">2.133975d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-811"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head1Z</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-812"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head2X</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-813"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head2Y</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">2.133975d0</span><span class="p">,</span><span class="mf">2.133975d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-814"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head2Z</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-815"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide1X</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-816"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide1Y</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-817"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide1Z</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-818"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide2X</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-819"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide2Y</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-820"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide2Z</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-821"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide3X</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mf">9.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-822"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide3Y</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-823"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide3Z</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-824"></a><span class="c">!  integer, dimension(7) :: colorno=(/3,4,5,6,2,8,9/)</span>
<a name="ln-825"></a>  <span class="kt">integer </span><span class="n">unit</span>              <span class="c">! Unit number on which to write file</span>
<a name="ln-826"></a>  <span class="kt">integer </span><span class="n">surf</span>              <span class="c">! Loop variable for surfaces</span>
<a name="ln-827"></a>  <span class="kt">integer </span><span class="n">vert</span>              <span class="c">! Loop counter</span>
<a name="ln-828"></a>  <span class="kt">integer</span><span class="p">,</span><span class="k">external</span> <span class="kd">::</span> <span class="n">getnewunitnumber</span>  <span class="c">! External function for a new unit number</span>
<a name="ln-829"></a>  <span class="kt">integer </span><span class="n">colorindex</span>        <span class="c">! color index by surface type</span>
<a name="ln-830"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">minx</span>                 <span class="c">! minimum x in surface data</span>
<a name="ln-831"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">miny</span>                 <span class="c">! minimum y in surface data</span>
<a name="ln-832"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">minz</span>                 <span class="c">! minimum z in surface data (for polygon output)</span>
<a name="ln-833"></a>  <span class="kt">integer </span><span class="n">zones</span>             <span class="c">! loop counter for zone loop</span>
<a name="ln-834"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span> <span class="n">zonenum</span>
<a name="ln-835"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="n">TempZoneName</span>
<a name="ln-836"></a>  <span class="kt">integer </span><span class="n">pos</span>
<a name="ln-837"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span> <span class="n">ShadeType</span>
<a name="ln-838"></a><span class="c">!unused  character(len=5) :: PolylineWidth=&#39; 0.55&#39;</span>
<a name="ln-839"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span> <span class="n">cSurfNum</span>
<a name="ln-840"></a>  <span class="kt">integer </span><span class="n">surfcount</span>
<a name="ln-841"></a>  <span class="kt">integer </span><span class="n">sptr</span>
<a name="ln-842"></a>  <span class="kt">integer </span><span class="n">refpt</span>
<a name="ln-843"></a>  <span class="kt">integer </span><span class="n">curcolorno</span>
<a name="ln-844"></a>  <span class="kt">integer </span><span class="n">write_stat</span>
<a name="ln-845"></a>
<a name="ln-846"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">totsurfaces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">surface</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-847"></a>    <span class="c">! no error needed, probably in end processing, just return</span>
<a name="ln-848"></a>    <span class="k">return</span>
<a name="ln-849"></a><span class="k">  </span><span class="n">endif</span>
<a name="ln-850"></a>
<a name="ln-851"></a>  <span class="n">unit</span><span class="o">=</span><span class="n">getnewunitnumber</span><span class="p">()</span>
<a name="ln-852"></a>  <span class="k">open</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;eplusout.dxf&#39;</span><span class="p">,</span> <span class="n">Action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">write_stat</span><span class="p">)</span>
<a name="ln-853"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">write_stat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-854"></a><span class="k">   CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;DXFOutLines: Could not open file &quot;eplusout.dxf&quot; for output (write).&#39;</span><span class="p">)</span>
<a name="ln-855"></a>  <span class="n">endif</span>
<a name="ln-856"></a>
<a name="ln-857"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">702</span><span class="p">)</span>   <span class="c">! Start of Entities section</span>
<a name="ln-858"></a>  <span class="mi">702</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;SECTION&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  2&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;ENTITIES&#39;</span><span class="p">)</span>
<a name="ln-859"></a>
<a name="ln-860"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">707</span><span class="p">)</span>    <span class="c">! Comment</span>
<a name="ln-861"></a>  <span class="mi">707</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;999&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;DXF created from EnergyPlus&#39;</span><span class="p">)</span>
<a name="ln-862"></a>
<a name="ln-863"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">708</span><span class="p">)</span> <span class="s1">&#39;Program Version&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VerString</span><span class="p">)</span>
<a name="ln-864"></a>  <span class="mi">708</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;999&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-865"></a>
<a name="ln-866"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">708</span><span class="p">)</span> <span class="s1">&#39;DXF using Lines&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span>
<a name="ln-867"></a>
<a name="ln-868"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ColorScheme</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-869"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">708</span><span class="p">)</span> <span class="s1">&#39;Color Scheme&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;Default&#39;</span>
<a name="ln-870"></a>  <span class="k">ELSE</span>
<a name="ln-871"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">708</span><span class="p">)</span> <span class="s1">&#39;Color Scheme&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ColorScheme</span><span class="p">)</span>
<a name="ln-872"></a>  <span class="n">ENDIF</span>
<a name="ln-873"></a>
<a name="ln-874"></a>
<a name="ln-875"></a>  <span class="n">minx</span><span class="o">=</span><span class="mi">9999</span><span class="mf">9.d0</span>
<a name="ln-876"></a>  <span class="n">miny</span><span class="o">=</span><span class="mi">9999</span><span class="mf">9.d0</span>
<a name="ln-877"></a>  <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-878"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-879"></a><span class="k">    do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-880"></a>      <span class="n">minx</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">minx</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-881"></a>      <span class="n">miny</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">miny</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-882"></a>    <span class="n">enddo</span>
<a name="ln-883"></a>  <span class="n">enddo</span>
<a name="ln-884"></a>
<a name="ln-885"></a>  <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-886"></a>    <span class="n">StemX</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">StemX</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-887"></a>    <span class="n">StemY</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">StemY</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-888"></a>    <span class="n">Head1X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">Head1X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-889"></a>    <span class="n">Head1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">Head1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-890"></a>    <span class="n">Head2X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">Head2X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-891"></a>    <span class="n">Head2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">Head2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-892"></a>    <span class="n">NSide1X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide1X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-893"></a>    <span class="n">NSide1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-894"></a>    <span class="n">NSide2X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide2X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-895"></a>    <span class="n">NSide2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-896"></a>    <span class="n">NSide3X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide3X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-897"></a>    <span class="n">NSide3Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide3Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-898"></a>  <span class="n">enddo</span>
<a name="ln-899"></a>
<a name="ln-900"></a>  <span class="c">! This writes &quot;True North&quot; above the Arrow Head</span>
<a name="ln-901"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Text - True North&#39;</span>
<a name="ln-902"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">800</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),</span><span class="n">StemX</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0d0</span> <span class="p">,</span><span class="n">StemY</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">StemZ</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-903"></a>  <span class="mi">800</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;TEXT&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  6&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;Continuous&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-904"></a>    <span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-905"></a>    <span class="s1">&#39; 40&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; .25&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  1&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;True North&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 41&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  7&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;MONOTXT&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-906"></a>    <span class="s1">&#39;210&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;220&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;230&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
<a name="ln-907"></a>
<a name="ln-908"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Text - Building Title&#39;</span>
<a name="ln-909"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">801</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),</span><span class="n">StemX</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">4.0d0</span><span class="p">,</span><span class="n">StemY</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">4.0d0</span> <span class="p">,</span><span class="n">StemZ</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;Building - &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BuildingName</span><span class="p">)</span>
<a name="ln-910"></a>  <span class="mi">801</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;TEXT&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  6&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;Continuous&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-911"></a>    <span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-912"></a>    <span class="s1">&#39; 40&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; .4&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  1&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 41&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  7&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;MONOTXT&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-913"></a>    <span class="s1">&#39;210&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;220&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;230&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
<a name="ln-914"></a>
<a name="ln-915"></a>  <span class="c">! We want to point the north arrow to true north</span>
<a name="ln-916"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Stem&#39;</span>
<a name="ln-917"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">StemX</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">StemY</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">StemZ</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-918"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Head 1&#39;</span>
<a name="ln-919"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">Head1X</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">Head1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">Head1Z</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-920"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Head 2&#39;</span>
<a name="ln-921"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">Head2X</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">Head2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">Head2Z</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-922"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Side 1&#39;</span>
<a name="ln-923"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">NSide1X</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide1Z</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-924"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Side 2&#39;</span>
<a name="ln-925"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">NSide2X</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide2Z</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-926"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Side 3&#39;</span>
<a name="ln-927"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">NSide3X</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide3Y</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide3Z</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-928"></a>
<a name="ln-929"></a>  <span class="mi">703</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;3DFACE&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-930"></a>    <span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-931"></a>    <span class="s1">&#39; 11&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 21&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 31&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-932"></a>    <span class="s1">&#39; 12&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 22&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 32&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-933"></a>    <span class="s1">&#39; 13&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 23&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 33&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-934"></a>
<a name="ln-935"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Zone Names&#39;</span>
<a name="ln-936"></a>  <span class="k">do </span><span class="n">zones</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-937"></a>    <span class="k">write</span><span class="p">(</span><span class="n">zonenum</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">zones</span>
<a name="ln-938"></a>    <span class="n">zonenum</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)</span>
<a name="ln-939"></a>    <span class="n">TempZoneName</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">Zones</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-940"></a>    <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-941"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-942"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-943"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-944"></a>    <span class="k">END DO</span>
<a name="ln-945"></a><span class="k">    </span><span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-946"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-947"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-948"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-949"></a>    <span class="k">END DO</span>
<a name="ln-950"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Zone=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)</span>
<a name="ln-951"></a>  <span class="n">enddo</span>
<a name="ln-952"></a>
<a name="ln-953"></a>  <span class="c">!  Do all detached shading surfaces first</span>
<a name="ln-954"></a>  <span class="n">surfcount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-955"></a>  <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-956"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">heattranssurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-957"></a><span class="k">    if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_Shading</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-958"></a><span class="k">    if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Detached_F</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_ShdDetFix</span>
<a name="ln-959"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Detached_B</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_ShdDetBldg</span>
<a name="ln-960"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">isPV</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_PV</span>
<a name="ln-961"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Detached_F</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-962"></a><span class="k">      </span><span class="n">ShadeType</span><span class="o">=</span><span class="s1">&#39;Fixed Shading&#39;</span>
<a name="ln-963"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Fixed Shading:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-964"></a>    <span class="n">elseif</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Detached_B</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-965"></a><span class="k">      </span><span class="n">ShadeType</span><span class="o">=</span><span class="s1">&#39;Building Shading&#39;</span>
<a name="ln-966"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Building Shading:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-967"></a>    <span class="n">endif</span>
<a name="ln-968"></a>    <span class="n">surfcount</span><span class="o">=</span><span class="n">surfcount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-969"></a>    <span class="k">write</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">surfcount</span>
<a name="ln-970"></a>    <span class="n">cSurfNum</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">)</span>
<a name="ln-971"></a>    <span class="n">ShadeType</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ShadeType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;_&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">)</span>
<a name="ln-972"></a>    <span class="n">minz</span><span class="o">=</span><span class="mi">9999</span><span class="mf">9.d0</span>
<a name="ln-973"></a>    <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-974"></a>      <span class="n">minz</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">minz</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-975"></a>    <span class="n">enddo</span>
<a name="ln-976"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-977"></a><span class="c">!      write(unit,711) TRIM(ShadeType),colorno(colorindex) !,minz ,TRIM(PolylineWidth),TRIM(PolylineWidth)</span>
<a name="ln-978"></a>      <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-979"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">vert</span> <span class="o">/=</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-980"></a><span class="k">          </span><span class="n">sptr</span><span class="o">=</span><span class="n">vert</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-981"></a>        <span class="k">else</span>
<a name="ln-982"></a><span class="k">          </span><span class="n">sptr</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-983"></a>        <span class="n">endif</span>
<a name="ln-984"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">711</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ShadeType</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">)</span> <span class="c">!,minz ,TRIM(PolylineWidth),TRIM(PolylineWidth)</span>
<a name="ln-985"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">712</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-986"></a>                        <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-987"></a>      <span class="n">enddo</span>
<a name="ln-988"></a>    <span class="k">else</span>  <span class="c">! polygon</span>
<a name="ln-989"></a>      <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-990"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">vert</span> <span class="o">/=</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-991"></a><span class="k">          </span><span class="n">sptr</span><span class="o">=</span><span class="n">vert</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-992"></a>        <span class="k">else</span>
<a name="ln-993"></a><span class="k">          </span><span class="n">sptr</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-994"></a>        <span class="n">endif</span>
<a name="ln-995"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">711</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ShadeType</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">)</span> <span class="c">!,minz ,TRIM(PolylineWidth),TRIM(PolylineWidth)</span>
<a name="ln-996"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">712</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-997"></a>                        <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-998"></a>      <span class="n">enddo</span>
<a name="ln-999"></a>    <span class="n">endif</span>
<a name="ln-1000"></a>  <span class="n">enddo</span>
<a name="ln-1001"></a>
<a name="ln-1002"></a>  <span class="c">! now do zone surfaces, by zone</span>
<a name="ln-1003"></a>  <span class="k">do </span><span class="n">zones</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-1004"></a>    <span class="n">TempZoneName</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">Zones</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-1005"></a>    <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1006"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1007"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-1008"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1009"></a>    <span class="k">END DO</span>
<a name="ln-1010"></a><span class="k">    </span><span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-1011"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1012"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-1013"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-1014"></a>    <span class="k">END DO</span>
<a name="ln-1015"></a>
<a name="ln-1016"></a><span class="k">    </span><span class="n">surfcount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1017"></a>    <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">surfacefirst</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">surfacelast</span>
<a name="ln-1018"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1019"></a><span class="k">      if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_Wall</span>
<a name="ln-1020"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_Roof</span>
<a name="ln-1021"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_Floor</span>
<a name="ln-1022"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_Door</span>
<a name="ln-1023"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1024"></a><span class="k">        if</span> <span class="p">(</span><span class="n">surfacewindow</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">originalclass</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_Window</span>
<a name="ln-1025"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">surfacewindow</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">originalclass</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_GlassDoor</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_GlassDoor</span>
<a name="ln-1026"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">surfacewindow</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">originalclass</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_TDDDome</span>
<a name="ln-1027"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">surfacewindow</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">originalclass</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_TDDDiffuser</span>
<a name="ln-1028"></a>      <span class="n">endif</span>
<a name="ln-1029"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">isPV</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_PV</span>
<a name="ln-1030"></a>      <span class="n">surfcount</span><span class="o">=</span><span class="n">surfcount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1031"></a>      <span class="n">surfcount</span><span class="o">=</span><span class="n">surfcount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1032"></a>      <span class="k">write</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">surfcount</span>
<a name="ln-1033"></a>      <span class="n">cSurfNum</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">)</span>
<a name="ln-1034"></a>
<a name="ln-1035"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1036"></a>      <span class="n">TempZoneName</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;_&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">)</span>
<a name="ln-1037"></a>      <span class="n">minz</span><span class="o">=</span><span class="mi">9999</span><span class="mf">9.d0</span>
<a name="ln-1038"></a>      <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-1039"></a>        <span class="n">minz</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">minz</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-1040"></a>      <span class="n">enddo</span>
<a name="ln-1041"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1042"></a><span class="k">        do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-1043"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">vert</span> <span class="o">/=</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1044"></a><span class="k">            </span><span class="n">sptr</span><span class="o">=</span><span class="n">vert</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1045"></a>          <span class="k">else</span>
<a name="ln-1046"></a><span class="k">            </span><span class="n">sptr</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1047"></a>          <span class="n">endif</span>
<a name="ln-1048"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">711</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">)</span> <span class="c">!,minz,TRIM(PolylineWidth),TRIM(PolylineWidth)</span>
<a name="ln-1049"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">712</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1050"></a>                        <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-1051"></a>        <span class="n">enddo</span>
<a name="ln-1052"></a>      <span class="k">else</span>  <span class="c">! polygon</span>
<a name="ln-1053"></a>        <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-1054"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">vert</span> <span class="o">/=</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1055"></a><span class="k">            </span><span class="n">sptr</span><span class="o">=</span><span class="n">vert</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1056"></a>          <span class="k">else</span>
<a name="ln-1057"></a><span class="k">            </span><span class="n">sptr</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1058"></a>          <span class="n">endif</span>
<a name="ln-1059"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">711</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">)</span> <span class="c">!,minz,TRIM(PolylineWidth),TRIM(PolylineWidth)</span>
<a name="ln-1060"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">712</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1061"></a>                        <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-1062"></a>        <span class="n">enddo</span>
<a name="ln-1063"></a>      <span class="n">endif</span>
<a name="ln-1064"></a><span class="c">! 715 format(&#39;  0&#39;,/,&#39;POLYLINE&#39;,/,&#39;  8&#39;,/,A,/,&#39; 62&#39;,/,I3,/,&#39; 66&#39;,/,&#39;  1&#39;,/,  &amp;</span>
<a name="ln-1065"></a><span class="c">!    &#39; 10&#39;,/,&#39; 0.0&#39;,/,&#39; 20&#39;,/,&#39; 0.0&#39;,/,&#39; 30&#39;,/,f15.5,/,  &amp;</span>
<a name="ln-1066"></a><span class="c">!    &#39; 70&#39;,/,&#39;   1&#39;,/,&#39; 40&#39;,/,A,/,&#39; 41&#39;,/,A)</span>
<a name="ln-1067"></a><span class="c">! 716 format(&#39;  0&#39;,/&#39;VERTEX&#39;,/,&#39;  8&#39;,/,A,/,  &amp;</span>
<a name="ln-1068"></a><span class="c">!    &#39; 10&#39;,/,f15.5,/,&#39; 20&#39;,/,f15.5,/,&#39; 30&#39;,/,f15.5)</span>
<a name="ln-1069"></a><span class="c">! 717 format(&#39;  0&#39;,/&#39;SEQEND&#39;,/,&#39;  8&#39;,/,A)</span>
<a name="ln-1070"></a>
<a name="ln-1071"></a>    <span class="n">enddo</span>
<a name="ln-1072"></a>    <span class="c">! still have to do shading surfaces for zone</span>
<a name="ln-1073"></a>    <span class="n">surfcount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1074"></a>    <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-1075"></a>      <span class="c">!if (surface(surf)%heattranssurf) CYCLE ! Shading with a construction is allowed to be HT surf for daylighting shelves</span>
<a name="ln-1076"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">SurfaceClass_Shading</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1077"></a><span class="k">      if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">zonename</span> <span class="o">/=</span> <span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1078"></a><span class="k">      </span><span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_ShdAtt</span>
<a name="ln-1079"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">isPV</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_PV</span>
<a name="ln-1080"></a>      <span class="n">surfcount</span><span class="o">=</span><span class="n">surfcount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1081"></a>      <span class="k">write</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">surfcount</span>
<a name="ln-1082"></a>      <span class="n">cSurfNum</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">)</span>
<a name="ln-1083"></a>
<a name="ln-1084"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1085"></a>      <span class="n">TempZoneName</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;_&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">)</span>
<a name="ln-1086"></a>      <span class="n">minz</span><span class="o">=</span><span class="mi">9999</span><span class="mf">9.d0</span>
<a name="ln-1087"></a>      <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-1088"></a>        <span class="n">minz</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">minz</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-1089"></a>      <span class="n">enddo</span>
<a name="ln-1090"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1091"></a><span class="k">        do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-1092"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">vert</span> <span class="o">/=</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1093"></a><span class="k">            </span><span class="n">sptr</span><span class="o">=</span><span class="n">vert</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1094"></a>          <span class="k">else</span>
<a name="ln-1095"></a><span class="k">            </span><span class="n">sptr</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1096"></a>          <span class="n">endif</span>
<a name="ln-1097"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">711</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">)</span> <span class="c">!,minz,TRIM(PolylineWidth),TRIM(PolylineWidth)</span>
<a name="ln-1098"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">712</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1099"></a>                        <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-1100"></a>        <span class="n">enddo</span>
<a name="ln-1101"></a>      <span class="k">else</span>  <span class="c">! polygon attached shading</span>
<a name="ln-1102"></a>        <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-1103"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">vert</span> <span class="o">/=</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1104"></a><span class="k">            </span><span class="n">sptr</span><span class="o">=</span><span class="n">vert</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1105"></a>          <span class="k">else</span>
<a name="ln-1106"></a><span class="k">            </span><span class="n">sptr</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-1107"></a>          <span class="n">endif</span>
<a name="ln-1108"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">711</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">)</span> <span class="c">!,minz,TRIM(PolylineWidth),TRIM(PolylineWidth)</span>
<a name="ln-1109"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">712</span><span class="p">)</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1110"></a>                        <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">sptr</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-1111"></a>        <span class="n">enddo</span>
<a name="ln-1112"></a>      <span class="n">endif</span>
<a name="ln-1113"></a>    <span class="n">enddo</span>
<a name="ln-1114"></a>  <span class="n">enddo</span>
<a name="ln-1115"></a>
<a name="ln-1116"></a>  <span class="mi">704</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;3DFACE&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1117"></a>    <span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1118"></a>    <span class="s1">&#39; 11&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 21&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 31&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1119"></a>    <span class="s1">&#39; 12&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 22&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 32&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1120"></a>
<a name="ln-1121"></a>  <span class="mi">705</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39; 13&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 23&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 33&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1122"></a>
<a name="ln-1123"></a>  <span class="mi">711</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;LINE&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">)</span>
<a name="ln-1124"></a>  <span class="mi">712</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1125"></a>             <span class="s1">&#39; 11&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 21&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 31&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1126"></a>
<a name="ln-1127"></a>
<a name="ln-1128"></a>
<a name="ln-1129"></a>  <span class="c">! Do any daylighting reference points on layer for zone</span>
<a name="ln-1130"></a>  <span class="k">do </span><span class="n">zones</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">numofzones</span>
<a name="ln-1131"></a>    <span class="n">curcolorno</span><span class="o">=</span><span class="n">colorno_DaylSensor1</span>
<a name="ln-1132"></a>    <span class="n">TempZoneName</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">Zones</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-1133"></a>    <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1134"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1135"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-1136"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1137"></a>    <span class="k">END DO</span>
<a name="ln-1138"></a><span class="k">    </span><span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-1139"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1140"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-1141"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-1142"></a>    <span class="k">END DO</span>
<a name="ln-1143"></a><span class="k">    do </span><span class="n">refpt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span>
<a name="ln-1144"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:DayRefPt:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">refpt</span><span class="p">))</span>
<a name="ln-1145"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">709</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">curcolorno</span><span class="p">),</span><span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1146"></a>                      <span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>             <span class="p">&amp;</span>
<a name="ln-1147"></a>                      <span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">3</span><span class="p">),.</span><span class="mi">2</span>
<a name="ln-1148"></a>      <span class="n">curcolorno</span><span class="o">=</span><span class="n">colorno_DaylSensor2</span>  <span class="c">! ref pts 2 and later are this color</span>
<a name="ln-1149"></a>    <span class="n">enddo</span>
<a name="ln-1150"></a>  <span class="n">enddo</span>
<a name="ln-1151"></a>
<a name="ln-1152"></a>  <span class="c">! now do DElight reference points</span>
<a name="ln-1153"></a>  <span class="k">do </span><span class="n">zones</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">numofzones</span>
<a name="ln-1154"></a>    <span class="n">curcolorno</span><span class="o">=</span><span class="n">colorno_DaylSensor1</span>
<a name="ln-1155"></a>    <span class="n">TempZoneName</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">Zones</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-1156"></a>    <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1157"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1158"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-1159"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1160"></a>    <span class="k">END DO</span>
<a name="ln-1161"></a><span class="k">    </span><span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-1162"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1163"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-1164"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-1165"></a>    <span class="k">END DO</span>
<a name="ln-1166"></a><span class="k">    do </span><span class="n">refpt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">TotalDElightRefPts</span>
<a name="ln-1167"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:DEDayRefPt:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">refpt</span><span class="p">))</span>
<a name="ln-1168"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">709</span><span class="p">)</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">curcolorno</span><span class="p">),</span><span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1169"></a>                      <span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>             <span class="p">&amp;</span>
<a name="ln-1170"></a>                      <span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">3</span><span class="p">),.</span><span class="mi">2</span>
<a name="ln-1171"></a>      <span class="n">curcolorno</span><span class="o">=</span><span class="n">colorno_DaylSensor2</span>  <span class="c">! ref pts 2 and later are this color</span>
<a name="ln-1172"></a>    <span class="n">enddo</span>
<a name="ln-1173"></a>  <span class="n">enddo</span>
<a name="ln-1174"></a>
<a name="ln-1175"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">706</span><span class="p">)</span>
<a name="ln-1176"></a>  <span class="mi">706</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;ENDSEC&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;EOF&#39;</span><span class="p">)</span>
<a name="ln-1177"></a>
<a name="ln-1178"></a>  <span class="mi">709</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;CIRCLE&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1179"></a>    <span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1180"></a>    <span class="s1">&#39; 40&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1181"></a>
<a name="ln-1182"></a>
<a name="ln-1183"></a>  <span class="mi">710</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;999&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-1184"></a>
<a name="ln-1185"></a>  <span class="k">close</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
<a name="ln-1186"></a>
<a name="ln-1187"></a>  <span class="k">return</span>
<a name="ln-1188"></a>
<a name="ln-1189"></a><span class="k">END SUBROUTINE </span><span class="n">DXFOutLines</span>
<a name="ln-1190"></a>
<a name="ln-1191"></a><span class="k">SUBROUTINE </span><span class="n">DXFOutWireFrame</span><span class="p">(</span><span class="n">ColorScheme</span><span class="p">)</span>
<a name="ln-1192"></a>
<a name="ln-1193"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1194"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-1195"></a>          <span class="c">!       DATE WRITTEN   August 2005</span>
<a name="ln-1196"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1197"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1198"></a>
<a name="ln-1199"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1200"></a>          <span class="c">! This subroutine produces a file of DXF objects for the surfaces (all lines -- wireframe).</span>
<a name="ln-1201"></a>
<a name="ln-1202"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1203"></a>          <span class="c">! Use the surface absolute coordinate information to produce</span>
<a name="ln-1204"></a>          <span class="c">! lines.</span>
<a name="ln-1205"></a>
<a name="ln-1206"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1207"></a>          <span class="c">! na</span>
<a name="ln-1208"></a>
<a name="ln-1209"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1210"></a>  <span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-1211"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">BuildingName</span><span class="p">,</span><span class="n">Zone</span>
<a name="ln-1212"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span>
<a name="ln-1213"></a>  <span class="k">USE </span><span class="n">DataSurfaceColors</span>
<a name="ln-1214"></a>  <span class="k">USE </span><span class="n">DataDaylighting</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneDaylight</span>
<a name="ln-1215"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DegToRadians</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-1216"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowContinueError</span><span class="p">,</span> <span class="n">ShowFatalError</span>
<a name="ln-1217"></a>  <span class="k">USE </span><span class="n">DataStringGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">VerString</span>
<a name="ln-1218"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-1219"></a>
<a name="ln-1220"></a>
<a name="ln-1221"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1222"></a>
<a name="ln-1223"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1224"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ColorScheme</span>
<a name="ln-1225"></a>
<a name="ln-1226"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1227"></a>          <span class="c">! na</span>
<a name="ln-1228"></a>
<a name="ln-1229"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1230"></a>          <span class="c">! na</span>
<a name="ln-1231"></a>
<a name="ln-1232"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1233"></a>          <span class="c">! na</span>
<a name="ln-1234"></a>
<a name="ln-1235"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1236"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StemX</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1237"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StemY</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1238"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StemZ</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1239"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head1X</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1240"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head1Y</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">2.133975d0</span><span class="p">,</span><span class="mf">2.133975d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1241"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head1Z</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1242"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head2X</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1243"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head2Y</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">3.d0</span><span class="p">,</span><span class="mf">2.133975d0</span><span class="p">,</span><span class="mf">2.133975d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1244"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Head2Z</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1245"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide1X</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1246"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide1Y</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1247"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide1Z</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1248"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide2X</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="mf">0.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1249"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide2Y</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1250"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide2Z</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1251"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide3X</span> <span class="o">=</span><span class="p">(</span><span class="o">/-</span><span class="mf">9.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="p">,</span><span class="o">-</span><span class="mf">9.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1252"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide3Y</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="p">,</span><span class="mf">3.5d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1253"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSide3Z</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="p">.</span><span class="mi">1</span><span class="n">d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">,.</span><span class="mi">1</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1254"></a><span class="c">!  integer, dimension(7) :: colorno=(/3,4,5,6,2,8,9/)</span>
<a name="ln-1255"></a>  <span class="kt">integer </span><span class="n">unit</span>              <span class="c">! Unit number on which to write file</span>
<a name="ln-1256"></a>  <span class="kt">integer </span><span class="n">surf</span>              <span class="c">! Loop variable for surfaces</span>
<a name="ln-1257"></a>  <span class="kt">integer </span><span class="n">vert</span>              <span class="c">! Loop counter</span>
<a name="ln-1258"></a>  <span class="kt">integer</span><span class="p">,</span><span class="k">external</span> <span class="kd">::</span> <span class="n">getnewunitnumber</span>  <span class="c">! External function for a new unit number</span>
<a name="ln-1259"></a>  <span class="kt">integer </span><span class="n">colorindex</span>        <span class="c">! color index by surface type</span>
<a name="ln-1260"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">minx</span>                 <span class="c">! minimum x in surface data</span>
<a name="ln-1261"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">miny</span>                 <span class="c">! minimum y in surface data</span>
<a name="ln-1262"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">minz</span>                 <span class="c">! minimum z in surface data (for polygon output)</span>
<a name="ln-1263"></a>  <span class="kt">integer </span><span class="n">zones</span>             <span class="c">! loop counter for zone loop</span>
<a name="ln-1264"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span> <span class="n">zonenum</span>
<a name="ln-1265"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="n">TempZoneName</span>
<a name="ln-1266"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="n">SaveZoneName</span>
<a name="ln-1267"></a>  <span class="kt">integer </span><span class="n">pos</span>
<a name="ln-1268"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span> <span class="n">ShadeType</span>
<a name="ln-1269"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PolylineWidth</span><span class="o">=</span><span class="s1">&#39; 0.55&#39;</span>
<a name="ln-1270"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span> <span class="n">cSurfNum</span>
<a name="ln-1271"></a>  <span class="kt">integer </span><span class="n">surfcount</span>
<a name="ln-1272"></a>  <span class="kt">integer </span><span class="n">refpt</span>
<a name="ln-1273"></a>  <span class="kt">integer </span><span class="n">curcolorno</span>
<a name="ln-1274"></a>  <span class="kt">integer </span><span class="n">write_stat</span>
<a name="ln-1275"></a>
<a name="ln-1276"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">totsurfaces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">surface</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1277"></a>    <span class="c">! no error needed, probably in end processing, just return</span>
<a name="ln-1278"></a>    <span class="k">return</span>
<a name="ln-1279"></a><span class="k">  </span><span class="n">endif</span>
<a name="ln-1280"></a>
<a name="ln-1281"></a>  <span class="n">unit</span><span class="o">=</span><span class="n">getnewunitnumber</span><span class="p">()</span>
<a name="ln-1282"></a>  <span class="k">open</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;eplusout.dxf&#39;</span><span class="p">,</span> <span class="n">Action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">write_stat</span><span class="p">)</span>
<a name="ln-1283"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">write_stat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1284"></a><span class="k">   CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;DXFOutWireFrame: Could not open file &quot;eplusout.dxf&quot; for output (write).&#39;</span><span class="p">)</span>
<a name="ln-1285"></a>  <span class="n">endif</span>
<a name="ln-1286"></a>
<a name="ln-1287"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">702</span><span class="p">)</span>   <span class="c">! Start of Entities section</span>
<a name="ln-1288"></a>  <span class="mi">702</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;SECTION&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  2&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;ENTITIES&#39;</span><span class="p">)</span>
<a name="ln-1289"></a>
<a name="ln-1290"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">707</span><span class="p">)</span>    <span class="c">! Comment</span>
<a name="ln-1291"></a>  <span class="mi">707</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;999&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;DXF created from EnergyPlus&#39;</span><span class="p">)</span>
<a name="ln-1292"></a>
<a name="ln-1293"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">708</span><span class="p">)</span> <span class="s1">&#39;Program Version&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VerString</span><span class="p">)</span>
<a name="ln-1294"></a>  <span class="mi">708</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;999&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-1295"></a>
<a name="ln-1296"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">708</span><span class="p">)</span> <span class="s1">&#39;DXF using Wireframe&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span>
<a name="ln-1297"></a>
<a name="ln-1298"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ColorScheme</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1299"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">708</span><span class="p">)</span> <span class="s1">&#39;Color Scheme&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;Default&#39;</span>
<a name="ln-1300"></a>  <span class="k">ELSE</span>
<a name="ln-1301"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">708</span><span class="p">)</span> <span class="s1">&#39;Color Scheme&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ColorScheme</span><span class="p">)</span>
<a name="ln-1302"></a>  <span class="n">ENDIF</span>
<a name="ln-1303"></a>
<a name="ln-1304"></a>  <span class="n">minx</span><span class="o">=</span><span class="mi">9999</span><span class="mf">9.d0</span>
<a name="ln-1305"></a>  <span class="n">miny</span><span class="o">=</span><span class="mi">9999</span><span class="mf">9.d0</span>
<a name="ln-1306"></a>  <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-1307"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1308"></a><span class="k">    do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-1309"></a>      <span class="n">minx</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">minx</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">)</span>
<a name="ln-1310"></a>      <span class="n">miny</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">miny</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">)</span>
<a name="ln-1311"></a>    <span class="n">enddo</span>
<a name="ln-1312"></a>  <span class="n">enddo</span>
<a name="ln-1313"></a>
<a name="ln-1314"></a>  <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-1315"></a>    <span class="n">StemX</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">StemX</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-1316"></a>    <span class="n">StemY</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">StemY</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-1317"></a>    <span class="n">Head1X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">Head1X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-1318"></a>    <span class="n">Head1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">Head1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-1319"></a>    <span class="n">Head2X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">Head2X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-1320"></a>    <span class="n">Head2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">Head2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-1321"></a>    <span class="n">NSide1X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide1X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-1322"></a>    <span class="n">NSide1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-1323"></a>    <span class="n">NSide2X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide2X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-1324"></a>    <span class="n">NSide2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-1325"></a>    <span class="n">NSide3X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide3X</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">minx</span>
<a name="ln-1326"></a>    <span class="n">NSide3Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">=</span><span class="n">NSide3Y</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">+</span><span class="n">miny</span>
<a name="ln-1327"></a>  <span class="n">enddo</span>
<a name="ln-1328"></a>
<a name="ln-1329"></a>  <span class="c">! This writes &quot;True North&quot; above the Arrow Head</span>
<a name="ln-1330"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Text - True North&#39;</span>
<a name="ln-1331"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">800</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),</span><span class="n">StemX</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0d0</span> <span class="p">,</span><span class="n">StemY</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">StemZ</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1332"></a>  <span class="mi">800</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;TEXT&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  6&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;Continuous&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1333"></a>    <span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1334"></a>    <span class="s1">&#39; 40&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; .25&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  1&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;True North&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 41&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  7&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;MONOTXT&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1335"></a>    <span class="s1">&#39;210&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;220&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;230&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
<a name="ln-1336"></a>
<a name="ln-1337"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Text - Building Title&#39;</span>
<a name="ln-1338"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">801</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),</span><span class="n">StemX</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">4.0d0</span><span class="p">,</span><span class="n">StemY</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">4.0d0</span> <span class="p">,</span><span class="n">StemZ</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;Building - &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">BuildingName</span><span class="p">)</span>
<a name="ln-1339"></a>  <span class="mi">801</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;TEXT&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  6&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;Continuous&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1340"></a>    <span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1341"></a>    <span class="s1">&#39; 40&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; .4&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  1&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 41&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  7&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;MONOTXT&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1342"></a>    <span class="s1">&#39;210&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;220&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;230&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
<a name="ln-1343"></a>
<a name="ln-1344"></a>  <span class="c">! We want to point the north arrow to true north</span>
<a name="ln-1345"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Stem&#39;</span>
<a name="ln-1346"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">StemX</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">StemY</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">StemZ</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1347"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Head 1&#39;</span>
<a name="ln-1348"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">Head1X</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">Head1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">Head1Z</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1349"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Head 2&#39;</span>
<a name="ln-1350"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">Head2X</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">Head2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">Head2Z</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1351"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Side 1&#39;</span>
<a name="ln-1352"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">NSide1X</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide1Y</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide1Z</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1353"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Side 2&#39;</span>
<a name="ln-1354"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">NSide2X</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide2Y</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide2Z</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1355"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;North Arrow Side 3&#39;</span>
<a name="ln-1356"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorno_Text</span><span class="p">),(</span><span class="n">NSide3X</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide3Y</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">NSide3Z</span><span class="p">(</span><span class="n">vert</span><span class="p">),</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1357"></a>
<a name="ln-1358"></a>  <span class="mi">703</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;3DFACE&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1359"></a>    <span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1360"></a>    <span class="s1">&#39; 11&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 21&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 31&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1361"></a>    <span class="s1">&#39; 12&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 22&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 32&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1362"></a>    <span class="s1">&#39; 13&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 23&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 33&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1363"></a>
<a name="ln-1364"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Zone Names&#39;</span>
<a name="ln-1365"></a>  <span class="k">do </span><span class="n">zones</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-1366"></a>    <span class="k">write</span><span class="p">(</span><span class="n">zonenum</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">zones</span>
<a name="ln-1367"></a>    <span class="n">zonenum</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)</span>
<a name="ln-1368"></a>    <span class="n">TempZoneName</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">Zones</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-1369"></a>    <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1370"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1371"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-1372"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1373"></a>    <span class="k">END DO</span>
<a name="ln-1374"></a><span class="k">    </span><span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-1375"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1376"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-1377"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-1378"></a>    <span class="k">END DO</span>
<a name="ln-1379"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Zone=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)</span>
<a name="ln-1380"></a>  <span class="n">enddo</span>
<a name="ln-1381"></a>
<a name="ln-1382"></a>  <span class="c">!  Do all detached shading surfaces first</span>
<a name="ln-1383"></a>  <span class="n">surfcount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1384"></a>  <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-1385"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">heattranssurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1386"></a><span class="k">    if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_Shading</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1387"></a><span class="k">    if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Detached_F</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_ShdDetFix</span>
<a name="ln-1388"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Detached_B</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_ShdDetBldg</span>
<a name="ln-1389"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">isPV</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_PV</span>
<a name="ln-1390"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Detached_F</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1391"></a><span class="k">      </span><span class="n">ShadeType</span><span class="o">=</span><span class="s1">&#39;Fixed Shading&#39;</span>
<a name="ln-1392"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Fixed Shading:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1393"></a>    <span class="n">elseif</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Detached_B</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1394"></a><span class="k">      </span><span class="n">ShadeType</span><span class="o">=</span><span class="s1">&#39;Building Shading&#39;</span>
<a name="ln-1395"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;Building Shading:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1396"></a>    <span class="n">endif</span>
<a name="ln-1397"></a>    <span class="n">surfcount</span><span class="o">=</span><span class="n">surfcount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1398"></a>    <span class="k">write</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">surfcount</span>
<a name="ln-1399"></a>    <span class="n">cSurfNum</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">)</span>
<a name="ln-1400"></a>    <span class="n">ShadeType</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ShadeType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;_&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">)</span>
<a name="ln-1401"></a>    <span class="n">minz</span><span class="o">=</span><span class="mi">9999</span><span class="mf">9.d0</span>
<a name="ln-1402"></a>    <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-1403"></a>      <span class="n">minz</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">minz</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-1404"></a>    <span class="n">enddo</span>
<a name="ln-1405"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1406"></a><span class="k">      write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">715</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ShadeType</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">),</span><span class="n">minz</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">)</span>
<a name="ln-1407"></a>      <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-1408"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">716</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ShadeType</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1409"></a>                        <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-1410"></a>      <span class="n">enddo</span>
<a name="ln-1411"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">717</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ShadeType</span><span class="p">)</span>
<a name="ln-1412"></a>    <span class="k">else</span>  <span class="c">! polygon</span>
<a name="ln-1413"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">715</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ShadeType</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">),</span><span class="n">minz</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">)</span>
<a name="ln-1414"></a>      <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-1415"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">716</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ShadeType</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1416"></a>                        <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-1417"></a>      <span class="n">enddo</span>
<a name="ln-1418"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">717</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ShadeType</span><span class="p">)</span>
<a name="ln-1419"></a>    <span class="n">endif</span>
<a name="ln-1420"></a>  <span class="n">enddo</span>
<a name="ln-1421"></a>
<a name="ln-1422"></a>  <span class="c">! now do zone surfaces, by zone</span>
<a name="ln-1423"></a>  <span class="k">do </span><span class="n">zones</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-1424"></a>    <span class="n">SaveZoneName</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">Zones</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-1425"></a>    <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">SaveZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">SaveZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1426"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1427"></a>      <span class="n">SaveZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-1428"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">SaveZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">SaveZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1429"></a>    <span class="k">END DO</span>
<a name="ln-1430"></a><span class="k">    </span><span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">SaveZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">SaveZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-1431"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1432"></a>      <span class="n">SaveZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-1433"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">SaveZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">SaveZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-1434"></a>    <span class="k">END DO</span>
<a name="ln-1435"></a>
<a name="ln-1436"></a><span class="k">    </span><span class="n">surfcount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1437"></a>    <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">surfacefirst</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">surfacelast</span>
<a name="ln-1438"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1439"></a><span class="k">      if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_Wall</span>
<a name="ln-1440"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_Roof</span>
<a name="ln-1441"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_Floor</span>
<a name="ln-1442"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_Door</span>
<a name="ln-1443"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1444"></a><span class="k">        if</span> <span class="p">(</span><span class="n">surfacewindow</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">originalclass</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_Window</span>
<a name="ln-1445"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">surfacewindow</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">originalclass</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_GlassDoor</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_GlassDoor</span>
<a name="ln-1446"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">surfacewindow</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">originalclass</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_TDDDome</span>
<a name="ln-1447"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">surfacewindow</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">originalclass</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_TDDDiffuser</span>
<a name="ln-1448"></a>      <span class="n">endif</span>
<a name="ln-1449"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">isPV</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_PV</span>
<a name="ln-1450"></a>      <span class="n">surfcount</span><span class="o">=</span><span class="n">surfcount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1451"></a>      <span class="k">write</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">surfcount</span>
<a name="ln-1452"></a>      <span class="n">cSurfNum</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">)</span>
<a name="ln-1453"></a>
<a name="ln-1454"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1455"></a>      <span class="n">TempZoneName</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SaveZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;_&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">)</span>
<a name="ln-1456"></a>      <span class="n">minz</span><span class="o">=</span><span class="mi">9999</span><span class="mf">9.d0</span>
<a name="ln-1457"></a>      <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-1458"></a>        <span class="n">minz</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">minz</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-1459"></a>      <span class="n">enddo</span>
<a name="ln-1460"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1461"></a><span class="k">        write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">715</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">),</span><span class="n">minz</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">)</span>
<a name="ln-1462"></a>        <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-1463"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">716</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1464"></a>                        <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-1465"></a>        <span class="n">enddo</span>
<a name="ln-1466"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">717</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)</span>
<a name="ln-1467"></a>      <span class="k">else</span>  <span class="c">! polygon</span>
<a name="ln-1468"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">715</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">),</span><span class="n">minz</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">)</span>
<a name="ln-1469"></a>        <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-1470"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">716</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1471"></a>                        <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-1472"></a>        <span class="n">enddo</span>
<a name="ln-1473"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">717</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)</span>
<a name="ln-1474"></a>      <span class="n">endif</span>
<a name="ln-1475"></a> <span class="mi">715</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;POLYLINE&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 66&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  1&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1476"></a>    <span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 0.0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1477"></a>    <span class="s1">&#39; 70&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;   9&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 40&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 41&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-1478"></a> <span class="mi">716</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="s1">&#39;VERTEX&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1479"></a>    <span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1480"></a> <span class="mi">717</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="s1">&#39;SEQEND&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-1481"></a>
<a name="ln-1482"></a>    <span class="n">enddo</span>
<a name="ln-1483"></a>    <span class="c">! still have to do shading surfaces for zone</span>
<a name="ln-1484"></a>    <span class="n">surfcount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1485"></a>    <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-1486"></a>      <span class="c">!if (surface(surf)%heattranssurf) CYCLE ! Shading with a construction is allowed to be HT surf for daylighting shelves</span>
<a name="ln-1487"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">SurfaceClass_Shading</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1488"></a><span class="k">      if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">zonename</span> <span class="o">/=</span> <span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1489"></a><span class="k">      </span><span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_ShdAtt</span>
<a name="ln-1490"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">isPV</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="n">colorno_PV</span>
<a name="ln-1491"></a>      <span class="n">surfcount</span><span class="o">=</span><span class="n">surfcount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1492"></a>      <span class="k">write</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">surfcount</span>
<a name="ln-1493"></a>      <span class="n">cSurfNum</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">)</span>
<a name="ln-1494"></a>
<a name="ln-1495"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1496"></a>      <span class="n">TempZoneName</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SaveZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;_&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfNum</span><span class="p">)</span>
<a name="ln-1497"></a>      <span class="n">minz</span><span class="o">=</span><span class="mi">9999</span><span class="mf">9.d0</span>
<a name="ln-1498"></a>      <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-1499"></a>        <span class="n">minz</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">minz</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">)</span>
<a name="ln-1500"></a>      <span class="n">enddo</span>
<a name="ln-1501"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1502"></a><span class="k">        write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">715</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">),</span><span class="n">minz</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">)</span>
<a name="ln-1503"></a>        <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-1504"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">716</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1505"></a>                        <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-1506"></a>        <span class="n">enddo</span>
<a name="ln-1507"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">717</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)</span>
<a name="ln-1508"></a>      <span class="k">else</span>  <span class="c">! polygon attached shading</span>
<a name="ln-1509"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">715</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">colorindex</span><span class="p">),</span><span class="n">minz</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolylineWidth</span><span class="p">)</span>
<a name="ln-1510"></a>        <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-1511"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">716</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1512"></a>                        <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span>
<a name="ln-1513"></a>        <span class="n">enddo</span>
<a name="ln-1514"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">717</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)</span>
<a name="ln-1515"></a>      <span class="n">endif</span>
<a name="ln-1516"></a>    <span class="n">enddo</span>
<a name="ln-1517"></a>  <span class="n">enddo</span>
<a name="ln-1518"></a>
<a name="ln-1519"></a>  <span class="mi">704</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;3DFACE&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1520"></a>    <span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1521"></a>    <span class="s1">&#39; 11&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 21&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 31&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1522"></a>    <span class="s1">&#39; 12&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 22&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 32&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1523"></a>
<a name="ln-1524"></a>  <span class="mi">705</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39; 13&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 23&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 33&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1525"></a>
<a name="ln-1526"></a><span class="c">!  711 format(&#39;  0&#39;,/,&#39;LINE&#39;,/,&#39;  8&#39;,/,A,/,&#39; 62&#39;,/,I3)</span>
<a name="ln-1527"></a><span class="c">!  712 format(&#39; 10&#39;,/,f15.5,/,&#39; 20&#39;,/,f15.5,/,&#39; 30&#39;,/,f15.5,/,  &amp;</span>
<a name="ln-1528"></a><span class="c">!             &#39; 11&#39;,/,f15.5,/,&#39; 21&#39;,/,f15.5,/,&#39; 31&#39;,/,f15.5)</span>
<a name="ln-1529"></a>
<a name="ln-1530"></a>
<a name="ln-1531"></a>
<a name="ln-1532"></a>  <span class="c">! Do any daylighting reference points on layer for zone</span>
<a name="ln-1533"></a>  <span class="k">do </span><span class="n">zones</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">numofzones</span>
<a name="ln-1534"></a>    <span class="n">curcolorno</span><span class="o">=</span><span class="n">colorno_DaylSensor1</span>
<a name="ln-1535"></a>    <span class="n">TempZoneName</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">Zones</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-1536"></a>    <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1537"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1538"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-1539"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1540"></a>    <span class="k">END DO</span>
<a name="ln-1541"></a><span class="k">    </span><span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-1542"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1543"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-1544"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-1545"></a>    <span class="k">END DO</span>
<a name="ln-1546"></a><span class="k">    do </span><span class="n">refpt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span>
<a name="ln-1547"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:DayRefPt:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">refpt</span><span class="p">))</span>
<a name="ln-1548"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">709</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">curcolorno</span><span class="p">),</span><span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1549"></a>                      <span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>             <span class="p">&amp;</span>
<a name="ln-1550"></a>                      <span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">3</span><span class="p">),.</span><span class="mi">2</span>
<a name="ln-1551"></a>      <span class="n">curcolorno</span><span class="o">=</span><span class="n">colorno_DaylSensor2</span>  <span class="c">! ref pts 2 and later are this color</span>
<a name="ln-1552"></a>    <span class="n">enddo</span>
<a name="ln-1553"></a>  <span class="n">enddo</span>
<a name="ln-1554"></a>
<a name="ln-1555"></a>  <span class="c">! now do DElight reference points</span>
<a name="ln-1556"></a>  <span class="k">do </span><span class="n">zones</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">numofzones</span>
<a name="ln-1557"></a>    <span class="n">curcolorno</span><span class="o">=</span><span class="n">colorno_DaylSensor1</span>
<a name="ln-1558"></a>    <span class="n">TempZoneName</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">Zones</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-1559"></a>    <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1560"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1561"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-1562"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-1563"></a>    <span class="k">END DO</span>
<a name="ln-1564"></a><span class="k">    </span><span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-1565"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-1566"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-1567"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-1568"></a>    <span class="k">END DO</span>
<a name="ln-1569"></a><span class="k">    do </span><span class="n">refpt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">TotalDElightRefPts</span>
<a name="ln-1570"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:DEDayRefPt:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">refpt</span><span class="p">))</span>
<a name="ln-1571"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">709</span><span class="p">)</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">),</span><span class="n">DXFcolorno</span><span class="p">(</span><span class="n">curcolorno</span><span class="p">),</span><span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1572"></a>                      <span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>             <span class="p">&amp;</span>
<a name="ln-1573"></a>                      <span class="n">zonedaylight</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">DaylRefPtAbsCoord</span><span class="p">(</span><span class="n">refpt</span><span class="p">,</span><span class="mi">3</span><span class="p">),.</span><span class="mi">2</span>
<a name="ln-1574"></a>      <span class="n">curcolorno</span><span class="o">=</span><span class="n">colorno_DaylSensor2</span>  <span class="c">! ref pts 2 and later are this color</span>
<a name="ln-1575"></a>    <span class="n">enddo</span>
<a name="ln-1576"></a>  <span class="n">enddo</span>
<a name="ln-1577"></a>
<a name="ln-1578"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">706</span><span class="p">)</span>
<a name="ln-1579"></a>  <span class="mi">706</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;ENDSEC&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;EOF&#39;</span><span class="p">)</span>
<a name="ln-1580"></a>
<a name="ln-1581"></a>  <span class="mi">709</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;  0&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;CIRCLE&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;  8&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 62&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">I3</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1582"></a>    <span class="s1">&#39; 10&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 20&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39; 30&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1583"></a>    <span class="s1">&#39; 40&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">f15</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1584"></a>
<a name="ln-1585"></a>
<a name="ln-1586"></a>  <span class="mi">710</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;999&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-1587"></a>
<a name="ln-1588"></a>  <span class="k">close</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
<a name="ln-1589"></a>
<a name="ln-1590"></a>  <span class="k">return</span>
<a name="ln-1591"></a>
<a name="ln-1592"></a><span class="k">END SUBROUTINE </span><span class="n">DXFOutWireFrame</span>
<a name="ln-1593"></a>
<a name="ln-1594"></a><span class="k">SUBROUTINE </span><span class="n">DetailsForSurfaces</span><span class="p">(</span><span class="n">RptType</span><span class="p">)</span>
<a name="ln-1595"></a>
<a name="ln-1596"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1597"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-1598"></a>          <span class="c">!       DATE WRITTEN   February 2002</span>
<a name="ln-1599"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1600"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1601"></a>
<a name="ln-1602"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1603"></a>          <span class="c">! This subroutine provides an optional detailed surface report</span>
<a name="ln-1604"></a>          <span class="c">! for each surface in the input file.</span>
<a name="ln-1605"></a>
<a name="ln-1606"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1607"></a>          <span class="c">! na</span>
<a name="ln-1608"></a>
<a name="ln-1609"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1610"></a>          <span class="c">! na</span>
<a name="ln-1611"></a>
<a name="ln-1612"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1613"></a>  <span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-1614"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span>
<a name="ln-1615"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span>
<a name="ln-1616"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">NumOfZones</span><span class="p">,</span><span class="n">OutputFileInits</span>
<a name="ln-1617"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span><span class="p">,</span><span class="n">TrimSigDigits</span>
<a name="ln-1618"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleName</span><span class="p">,</span><span class="n">GetScheduleMinValue</span><span class="p">,</span><span class="n">GetScheduleMaxValue</span>
<a name="ln-1619"></a>
<a name="ln-1620"></a>
<a name="ln-1621"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1622"></a>
<a name="ln-1623"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1624"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RptType</span> <span class="c">! (1=Vertices only, 10=Details only, 11=Details with vertices)</span>
<a name="ln-1625"></a>
<a name="ln-1626"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1627"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">9</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConvCoeffCalcs</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="s1">&#39;ASHRAESimple               &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1628"></a>                                                                  <span class="s1">&#39;ASHRAETARP                 &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1629"></a>                                                                  <span class="s1">&#39;CeilingDiffuser            &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1630"></a>                                                                  <span class="s1">&#39;TrombeWall                 &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1631"></a>                                                                  <span class="s1">&#39;TARP                       &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1632"></a>                                                                  <span class="s1">&#39;MoWitt                     &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1633"></a>                                                                  <span class="s1">&#39;DOE-2                      &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1634"></a>                                                                  <span class="s1">&#39;BLAST                      &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1635"></a>                                                                  <span class="s1">&#39;AdaptiveConvectionAlgorithm&#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1636"></a>
<a name="ln-1637"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1638"></a>          <span class="c">! na</span>
<a name="ln-1639"></a>
<a name="ln-1640"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1641"></a>          <span class="c">! na</span>
<a name="ln-1642"></a>
<a name="ln-1643"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1644"></a>  <span class="kt">integer </span><span class="n">unit</span>              <span class="c">! Unit number on which to write file</span>
<a name="ln-1645"></a>  <span class="kt">integer </span><span class="n">surf</span>              <span class="c">! Loop variable for surfaces</span>
<a name="ln-1646"></a>  <span class="kt">integer </span><span class="n">vert</span>              <span class="c">! Loop counter</span>
<a name="ln-1647"></a>  <span class="kt">integer </span><span class="n">zonenum</span>           <span class="c">! Loop counter</span>
<a name="ln-1648"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BaseSurfName</span>
<a name="ln-1649"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConstructionName</span>
<a name="ln-1650"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scheduleName</span>
<a name="ln-1651"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IntConvCoeffCalc</span>
<a name="ln-1652"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ExtConvCoeffCalc</span>
<a name="ln-1653"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NominalUwithConvCoeffs</span>
<a name="ln-1654"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cNominalU</span>
<a name="ln-1655"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cNominalUwithConvCoeffs</span>
<a name="ln-1656"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cSchedMin</span>
<a name="ln-1657"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cSchedMax</span>
<a name="ln-1658"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SolarDiffusing</span>
<a name="ln-1659"></a>  <span class="kt">integer </span><span class="n">fd</span>
<a name="ln-1660"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AlgoName</span>
<a name="ln-1661"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">isWithConvCoefValid</span>
<a name="ln-1662"></a>
<a name="ln-1663"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">totsurfaces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">surface</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1664"></a>    <span class="c">! no error needed, probably in end processing, just return</span>
<a name="ln-1665"></a>    <span class="k">return</span>
<a name="ln-1666"></a><span class="k">  </span><span class="n">endif</span>
<a name="ln-1667"></a>
<a name="ln-1668"></a>  <span class="n">unit</span><span class="o">=</span><span class="n">OutputFileInits</span>
<a name="ln-1669"></a>
<a name="ln-1670"></a><span class="c">!!!!    Write Header lines for report</span>
<a name="ln-1671"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">RptType</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span> <span class="k">then</span>  <span class="c">! Details only</span>
<a name="ln-1672"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">700</span><span class="p">)</span>
<a name="ln-1673"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">701</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>
<a name="ln-1674"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">7011</span><span class="p">)</span>
<a name="ln-1675"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">702</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>
<a name="ln-1676"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">7021</span><span class="p">)</span>
<a name="ln-1677"></a>  <span class="n">elseif</span> <span class="p">(</span><span class="n">RptType</span> <span class="o">==</span> <span class="mi">11</span><span class="p">)</span> <span class="k">then</span> <span class="c">! Details with Vertices</span>
<a name="ln-1678"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">700</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>
<a name="ln-1679"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span>
<a name="ln-1680"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">701</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>
<a name="ln-1681"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">7011</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>
<a name="ln-1682"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">707</span><span class="p">)</span>
<a name="ln-1683"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">702</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>
<a name="ln-1684"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">7021</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>
<a name="ln-1685"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">708</span><span class="p">)</span>
<a name="ln-1686"></a>  <span class="k">else</span>     <span class="c">! Vertices only</span>
<a name="ln-1687"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">700</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>
<a name="ln-1688"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span>
<a name="ln-1689"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">701</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>
<a name="ln-1690"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">7012</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>
<a name="ln-1691"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">707</span><span class="p">)</span>
<a name="ln-1692"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">702</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>
<a name="ln-1693"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">708</span><span class="p">)</span>
<a name="ln-1694"></a>  <span class="n">endif</span>
<a name="ln-1695"></a>
<a name="ln-1696"></a>  <span class="c">! Do just &quot;detached&quot; shading first</span>
<a name="ln-1697"></a>  <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-1698"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-1699"></a><span class="k">  </span><span class="n">enddo</span>
<a name="ln-1700"></a>  <span class="k">if</span> <span class="p">((</span><span class="n">surf</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1701"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="s1">&#39;Shading_Surfaces&#39;</span><span class="p">,</span><span class="s1">&#39;Number of Shading Surfaces&#39;</span><span class="p">,</span><span class="n">surf</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1702"></a>    <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-1703"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-1704"></a><span class="k">      </span><span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>
<a name="ln-1705"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">704</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;Shading&#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">trim</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1706"></a>                                                          <span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">BaseSurfName</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlgoName</span><span class="p">)</span>
<a name="ln-1707"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">RptType</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1708"></a><span class="k">        if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1709"></a><span class="k">          </span><span class="n">scheduleName</span><span class="o">=</span><span class="n">GetScheduleName</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="p">)</span>
<a name="ln-1710"></a>          <span class="n">cSchedMin</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">GetScheduleMinValue</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1711"></a>          <span class="n">cSchedMax</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">GetScheduleMaxValue</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1712"></a>        <span class="k">else</span>
<a name="ln-1713"></a><span class="k">          </span><span class="n">scheduleName</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1714"></a>          <span class="n">cSchedMin</span><span class="o">=</span><span class="s1">&#39;0.0&#39;</span>
<a name="ln-1715"></a>          <span class="n">cSchedMax</span><span class="o">=</span><span class="s1">&#39;0.0&#39;</span>
<a name="ln-1716"></a>        <span class="n">endif</span>
<a name="ln-1717"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">7044</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">scheduleName</span><span class="p">),</span><span class="nb">trim</span><span class="p">(</span><span class="n">cSchedMin</span><span class="p">),</span><span class="nb">trim</span><span class="p">(</span><span class="n">cSchedMax</span><span class="p">),</span><span class="s1">&#39; &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1718"></a>                                      <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1719"></a>                                      <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1720"></a>                                      <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Tilt</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>   <span class="p">&amp;</span>
<a name="ln-1721"></a>                                      <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Width</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Height</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1722"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">7061</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-1723"></a>      <span class="n">elseif</span> <span class="p">(</span><span class="n">RptType</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1724"></a><span class="k">        write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">7042</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-1725"></a>      <span class="k">else</span>
<a name="ln-1726"></a><span class="k">        if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1727"></a><span class="k">          </span><span class="n">scheduleName</span><span class="o">=</span><span class="n">GetScheduleName</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="p">)</span>
<a name="ln-1728"></a>          <span class="n">cSchedMin</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">GetScheduleMinValue</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1729"></a>          <span class="n">cSchedMax</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">GetScheduleMaxValue</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1730"></a>        <span class="k">else</span>
<a name="ln-1731"></a><span class="k">          </span><span class="n">scheduleName</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1732"></a>          <span class="n">cSchedMin</span><span class="o">=</span><span class="s1">&#39;0.0&#39;</span>
<a name="ln-1733"></a>          <span class="n">cSchedMax</span><span class="o">=</span><span class="s1">&#39;0.0&#39;</span>
<a name="ln-1734"></a>        <span class="n">endif</span>
<a name="ln-1735"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">7044</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">scheduleName</span><span class="p">),</span><span class="nb">trim</span><span class="p">(</span><span class="n">cSchedMin</span><span class="p">),</span><span class="nb">trim</span><span class="p">(</span><span class="n">cSchedMax</span><span class="p">),</span><span class="s1">&#39; &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1736"></a>                                      <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-1737"></a>                                      <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1738"></a>                                      <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Tilt</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>   <span class="p">&amp;</span>
<a name="ln-1739"></a>                                      <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Width</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Height</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1740"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">7061</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-1741"></a>      <span class="n">endif</span>
<a name="ln-1742"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">RptType</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1743"></a><span class="k">      do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-1744"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">vert</span> <span class="o">/=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1745"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">709</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1746"></a>                                       <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1747"></a>                                       <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1748"></a>        <span class="k">else</span>
<a name="ln-1749"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">709</span><span class="p">)</span>  <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1750"></a>                           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1751"></a>                           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1752"></a>        <span class="n">endif</span>
<a name="ln-1753"></a>      <span class="n">enddo</span>
<a name="ln-1754"></a>      <span class="c">!  This shouldn&#39;t happen with shading surface -- always have vertices</span>
<a name="ln-1755"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">711</span><span class="p">)</span>
<a name="ln-1756"></a>    <span class="n">enddo</span>
<a name="ln-1757"></a>  <span class="n">endif</span>
<a name="ln-1758"></a>
<a name="ln-1759"></a>  <span class="k">do </span><span class="n">zonenum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-1760"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="s1">&#39;Zone_Surfaces&#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),(</span><span class="n">Zone</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)%</span><span class="n">SurfaceLast</span><span class="o">-</span><span class="n">Zone</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1761"></a>    <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-1762"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">/=</span> <span class="n">zonenum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1763"></a><span class="k">      </span><span class="n">SolarDiffusing</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1764"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">RptType</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">RptType</span> <span class="o">==</span> <span class="mi">11</span><span class="p">)</span> <span class="k">then</span>  <span class="c">! Details and Details with Vertices</span>
<a name="ln-1765"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">surf</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1766"></a><span class="k">          </span><span class="n">BaseSurfName</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1767"></a>        <span class="k">else</span>
<a name="ln-1768"></a><span class="k">          </span><span class="n">BaseSurfName</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">BaseSurfName</span>
<a name="ln-1769"></a>        <span class="n">endif</span>
<a name="ln-1770"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span><span class="p">)</span>
<a name="ln-1771"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_None</span><span class="p">)</span>
<a name="ln-1772"></a>          <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>
<a name="ln-1773"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_CTF</span><span class="p">)</span>
<a name="ln-1774"></a>          <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;CTF - ConductionTransferFunction&#39;</span>
<a name="ln-1775"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_CondFD</span><span class="p">)</span>
<a name="ln-1776"></a>          <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;CondFD - ConductionFiniteDifference&#39;</span>
<a name="ln-1777"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_EMPD</span><span class="p">)</span>
<a name="ln-1778"></a>          <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;EMPD - MoisturePenetrationDepthConductionTransferFunction&#39;</span>
<a name="ln-1779"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_HAMT</span><span class="p">)</span>
<a name="ln-1780"></a>          <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;HAMT - CombinedHeatAndMoistureFiniteElement&#39;</span>
<a name="ln-1781"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_Window5</span><span class="p">)</span>
<a name="ln-1782"></a>          <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;Window5 Detailed Fenestration&#39;</span>
<a name="ln-1783"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_ComplexFenestration</span><span class="p">)</span>
<a name="ln-1784"></a>          <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;Window7 Complex Fenestration&#39;</span>
<a name="ln-1785"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_TDD</span><span class="p">)</span>
<a name="ln-1786"></a>          <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;Tubular Daylighting Device&#39;</span>
<a name="ln-1787"></a>        <span class="k">END SELECT</span>
<a name="ln-1788"></a>        <span class="c">! Default Convection Coefficient Calculation Algorithms</span>
<a name="ln-1789"></a>        <span class="n">IntConvCoeffCalc</span><span class="o">=</span><span class="n">ConvCoeffCalcs</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)%</span><span class="n">InsideConvectionAlgo</span><span class="p">)</span>
<a name="ln-1790"></a>        <span class="n">ExtConvCoeffCalc</span><span class="o">=</span><span class="n">ConvCoeffCalcs</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)%</span><span class="n">OutsideConvectionAlgo</span><span class="p">)</span>
<a name="ln-1791"></a>
<a name="ln-1792"></a>
<a name="ln-1793"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">704</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;HeatTransfer&#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">trim</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1794"></a>                                                                              <span class="nb">trim</span><span class="p">(</span><span class="n">BaseSurfName</span><span class="p">),</span> <span class="nb">trim</span><span class="p">(</span><span class="n">AlgoName</span><span class="p">)</span>
<a name="ln-1795"></a>
<a name="ln-1796"></a>        <span class="c">! NOTE - THIS CODE IS REPEATED IN SurfaceGeometry.F90 IN SetupZoneGeometry</span>
<a name="ln-1797"></a>        <span class="c">! Calculate Nominal U-value with convection/film coefficients for reporting by adding on</span>
<a name="ln-1798"></a>        <span class="c">! prescribed R-values for interior and exterior convection coefficients as found in ASHRAE 90.1-2004, Appendix A</span>
<a name="ln-1799"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">&lt;=</span> <span class="n">TotConstructs</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1800"></a><span class="k">          </span><span class="n">NominalUwithConvCoeffs</span> <span class="o">=</span> <span class="n">ComputeNominalUwithConvCoeffs</span><span class="p">(</span><span class="n">surf</span><span class="p">,</span><span class="n">isWithConvCoefValid</span><span class="p">)</span>
<a name="ln-1801"></a>          <span class="n">ConstructionName</span><span class="o">=</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-1802"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">isWithConvCoefValid</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1803"></a><span class="k">            </span><span class="n">cNominalUwithConvCoeffs</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NominalUwithConvCoeffs</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1804"></a>          <span class="k">ELSE</span>
<a name="ln-1805"></a><span class="k">            </span><span class="n">cNominalUwithConvCoeffs</span> <span class="o">=</span> <span class="s1">&#39;[invalid]&#39;</span>
<a name="ln-1806"></a>          <span class="k">END IF</span>
<a name="ln-1807"></a><span class="k">          IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1808"></a>            <span class="c">! SurfaceClass_Window also covers glass doors and TDD:Diffusers</span>
<a name="ln-1809"></a>            <span class="n">cNominalU</span><span class="o">=</span><span class="s1">&#39;N/A&#39;</span>
<a name="ln-1810"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1811"></a><span class="k">              </span><span class="n">SolarDiffusing</span><span class="o">=</span><span class="s1">&#39;Yes&#39;</span>
<a name="ln-1812"></a>            <span class="k">ELSE</span>
<a name="ln-1813"></a><span class="k">              </span><span class="n">SolarDiffusing</span><span class="o">=</span><span class="s1">&#39;No&#39;</span>
<a name="ln-1814"></a>            <span class="n">ENDIF</span>
<a name="ln-1815"></a>          <span class="k">ELSE</span>
<a name="ln-1816"></a><span class="k">            </span><span class="n">cNominalU</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NominalU</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Construction</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1817"></a>          <span class="k">END IF</span>
<a name="ln-1818"></a><span class="k">        else</span>
<a name="ln-1819"></a><span class="k">          </span><span class="n">CNominalUwithConvCoeffs</span> <span class="o">=</span> <span class="s1">&#39;**&#39;</span>
<a name="ln-1820"></a>          <span class="n">CNominalU</span> <span class="o">=</span> <span class="s1">&#39;**&#39;</span>
<a name="ln-1821"></a>          <span class="n">ConstructionName</span><span class="o">=</span><span class="s1">&#39;**invalid**&#39;</span>
<a name="ln-1822"></a>        <span class="n">endif</span>
<a name="ln-1823"></a>
<a name="ln-1824"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">7041</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span><span class="nb">trim</span><span class="p">(</span><span class="n">ConstructionName</span><span class="p">),</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNominalU</span><span class="p">),</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNominalUwithConvCoeffs</span><span class="p">),</span><span class="nb">trim</span><span class="p">(</span><span class="n">SolarDiffusing</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1825"></a>                            <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">GrossArea</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>   <span class="p">&amp;</span>
<a name="ln-1826"></a>                            <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1827"></a>                            <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Azimuth</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Tilt</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>    <span class="p">&amp;</span>
<a name="ln-1828"></a>                            <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Width</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Height</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>    <span class="p">&amp;</span>
<a name="ln-1829"></a>                            <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Reveal</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1830"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">IntConvCoeff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1831"></a><span class="k">          SELECT CASE</span> <span class="p">(</span><span class="n">UserIntConvectionCoeffs</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="p">)</span>
<a name="ln-1832"></a>          <span class="k">CASE</span> <span class="p">(</span> <span class="n">ConvCoefValue</span><span class="p">)</span>
<a name="ln-1833"></a>            <span class="n">IntConvCoeffCalc</span><span class="o">=</span><span class="s1">&#39;User Supplied Value&#39;</span>
<a name="ln-1834"></a>          <span class="k">CASE</span> <span class="p">(</span> <span class="n">ConvCoefSchedule</span> <span class="p">)</span>
<a name="ln-1835"></a>            <span class="n">IntConvCoeffCalc</span><span class="o">=</span><span class="s1">&#39;User Supplied Schedule&#39;</span>
<a name="ln-1836"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">ConvCoefUserCurve</span><span class="p">)</span>
<a name="ln-1837"></a>            <span class="n">ExtConvCoeffCalc</span><span class="o">=</span><span class="s1">&#39;User Supplied Curve&#39;</span>
<a name="ln-1838"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">ConvCoefSpecifiedModel</span><span class="p">)</span>
<a name="ln-1839"></a>            <span class="n">ExtConvCoeffCalc</span><span class="o">=</span><span class="s1">&#39;User Specified Model&#39;</span>
<a name="ln-1840"></a>          <span class="k">END SELECT</span>
<a name="ln-1841"></a><span class="k">        </span><span class="n">elseif</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">IntConvCoeff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! not in use yet.</span>
<a name="ln-1842"></a>          <span class="n">IntConvCoeffCalc</span><span class="o">=</span><span class="n">ConvCoeffCalcs</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">IntConvCoeff</span><span class="p">))</span>
<a name="ln-1843"></a>        <span class="n">endif</span>
<a name="ln-1844"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ExtConvCoeff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1845"></a><span class="k">          SELECT CASE</span> <span class="p">(</span><span class="n">UserExtConvectionCoeffs</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="p">)%</span><span class="n">OverrideType</span><span class="p">)</span>
<a name="ln-1846"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">ConvCoefValue</span><span class="p">)</span>
<a name="ln-1847"></a>            <span class="n">ExtConvCoeffCalc</span><span class="o">=</span><span class="s1">&#39;User Supplied Value&#39;</span>
<a name="ln-1848"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">ConvCoefSchedule</span><span class="p">)</span>
<a name="ln-1849"></a>            <span class="n">ExtConvCoeffCalc</span><span class="o">=</span><span class="s1">&#39;User Supplied Schedule&#39;</span>
<a name="ln-1850"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">ConvCoefUserCurve</span><span class="p">)</span>
<a name="ln-1851"></a>            <span class="n">ExtConvCoeffCalc</span><span class="o">=</span><span class="s1">&#39;User Supplied Curve&#39;</span>
<a name="ln-1852"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">ConvCoefSpecifiedModel</span><span class="p">)</span>
<a name="ln-1853"></a>            <span class="n">ExtConvCoeffCalc</span><span class="o">=</span><span class="s1">&#39;User Specified Model&#39;</span>
<a name="ln-1854"></a>          <span class="k">END SELECT</span>
<a name="ln-1855"></a><span class="k">        </span><span class="n">elseif</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ExtConvCoeff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1856"></a><span class="k">          </span><span class="n">ExtConvCoeffCalc</span><span class="o">=</span><span class="n">ConvCoeffCalcs</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ExtConvCoeff</span><span class="p">))</span>
<a name="ln-1857"></a>        <span class="n">endif</span>
<a name="ln-1858"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">extboundcond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1859"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;ExternalEnvironment&#39;</span>
<a name="ln-1860"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">ExtConvCoeffCalc</span><span class="p">)</span>
<a name="ln-1861"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">IntConvCoeffCalc</span><span class="p">)</span>
<a name="ln-1862"></a>        <span class="n">elseif</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">extboundcond</span> <span class="o">==</span> <span class="n">Ground</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1863"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;Ground&#39;</span>
<a name="ln-1864"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;N/A-Ground&#39;</span>
<a name="ln-1865"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">IntConvCoeffCalc</span><span class="p">)</span>
<a name="ln-1866"></a>        <span class="n">elseif</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">extboundcond</span> <span class="o">==</span> <span class="n">GroundFCfactorMethod</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1867"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;FCGround&#39;</span>
<a name="ln-1868"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;N/A-FCGround&#39;</span>
<a name="ln-1869"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">IntConvCoeffCalc</span><span class="p">)</span>
<a name="ln-1870"></a>        <span class="n">elseif</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">extboundcond</span> <span class="o">==</span> <span class="n">OtherSideCoefNoCalcExt</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">extboundcond</span> <span class="o">==</span> <span class="n">OtherSideCoefCalcExt</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1871"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">OSC</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">OSCPtr</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1872"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;N/A-OSC&#39;</span>
<a name="ln-1873"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">IntConvCoeffCalc</span><span class="p">)</span>
<a name="ln-1874"></a>        <span class="n">elseif</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">extboundcond</span> <span class="o">==</span> <span class="n">OtherSideCondModeledExt</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1875"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">OSCM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">OSCMPtr</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1876"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;N/A-OSCM&#39;</span>
<a name="ln-1877"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">IntConvCoeffCalc</span><span class="p">)</span>
<a name="ln-1878"></a>        <span class="k">else</span>
<a name="ln-1879"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ExtBoundCondName</span><span class="p">)</span>
<a name="ln-1880"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;Other/Same Surface Int Conv&#39;</span>
<a name="ln-1881"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">IntConvCoeffCalc</span><span class="p">)</span>
<a name="ln-1882"></a>        <span class="n">endif</span>
<a name="ln-1883"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1884"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;SunExposed&#39;</span>
<a name="ln-1885"></a>        <span class="k">else</span>
<a name="ln-1886"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;NoSun&#39;</span>
<a name="ln-1887"></a>        <span class="n">endif</span>
<a name="ln-1888"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ExtWind</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1889"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;WindExposed&#39;</span>
<a name="ln-1890"></a>        <span class="k">else</span>
<a name="ln-1891"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">705</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;NoWind&#39;</span>
<a name="ln-1892"></a>        <span class="n">endif</span>
<a name="ln-1893"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">RptType</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1894"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">706</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ViewFactorGround</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>    <span class="p">&amp;</span>
<a name="ln-1895"></a>                          <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ViewFactorSky</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>       <span class="p">&amp;</span>
<a name="ln-1896"></a>                          <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ViewFactorGroundIR</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1897"></a>                          <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>     <span class="p">&amp;</span>
<a name="ln-1898"></a>                          <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-1899"></a>        <span class="k">else</span>
<a name="ln-1900"></a><span class="k">          write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">706</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>  <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ViewFactorGround</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>    <span class="p">&amp;</span>
<a name="ln-1901"></a>                          <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ViewFactorSky</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>       <span class="p">&amp;</span>
<a name="ln-1902"></a>                          <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ViewFactorGroundIR</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1903"></a>                          <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>     <span class="p">&amp;</span>
<a name="ln-1904"></a>                          <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-1905"></a>          <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-1906"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">vert</span> <span class="o">/=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1907"></a><span class="k">              write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">709</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1908"></a>                                       <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1909"></a>                                       <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1910"></a>            <span class="k">else</span>
<a name="ln-1911"></a><span class="k">              write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">709</span><span class="p">)</span>  <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1912"></a>                           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1913"></a>                           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1914"></a>            <span class="n">endif</span>
<a name="ln-1915"></a>          <span class="n">enddo</span>
<a name="ln-1916"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">711</span><span class="p">)</span>
<a name="ln-1917"></a>        <span class="n">endif</span>
<a name="ln-1918"></a><span class="c">! if window, report frame/divider as appropriate</span>
<a name="ln-1919"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">FrameDivider</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1920"></a><span class="k">          </span><span class="n">fd</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">FrameDivider</span>
<a name="ln-1921"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">fd</span><span class="p">)%</span><span class="n">FrameWidth</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1922"></a><span class="k">            SELECT CASE</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span><span class="p">)</span>
<a name="ln-1923"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_None</span><span class="p">)</span>
<a name="ln-1924"></a>              <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>
<a name="ln-1925"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_CTF</span><span class="p">)</span>
<a name="ln-1926"></a>              <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;CTF - ConductionTransferFunction&#39;</span>
<a name="ln-1927"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_CondFD</span><span class="p">)</span>
<a name="ln-1928"></a>              <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;CondFD - ConductionFiniteDifference&#39;</span>
<a name="ln-1929"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_EMPD</span><span class="p">)</span>
<a name="ln-1930"></a>              <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;EMPD - MoisturePenetrationDepthConductionTransferFunction&#39;</span>
<a name="ln-1931"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_HAMT</span><span class="p">)</span>
<a name="ln-1932"></a>              <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;HAMT - CombinedHeatAndMoistureFiniteElement&#39;</span>
<a name="ln-1933"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_Window5</span><span class="p">)</span>
<a name="ln-1934"></a>              <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;Window5 Detailed Fenestration&#39;</span>
<a name="ln-1935"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_ComplexFenestration</span><span class="p">)</span>
<a name="ln-1936"></a>              <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;Window7 Complex Fenestration&#39;</span>
<a name="ln-1937"></a>            <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_TDD</span><span class="p">)</span>
<a name="ln-1938"></a>              <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;Tubular Daylighting Device&#39;</span>
<a name="ln-1939"></a>            <span class="k">END SELECT</span>
<a name="ln-1940"></a><span class="k">            write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">704</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;Frame/Divider&#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">fd</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="s1">&#39;Frame&#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1941"></a>                           <span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="n">AlgoName</span><span class="p">)</span>
<a name="ln-1942"></a>            <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">7045</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">FrameArea</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1943"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">FrameArea</span><span class="o">/</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Multiplier</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1944"></a>                             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">fd</span><span class="p">)%</span><span class="n">FrameWidth</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="s1">&#39;N/A&#39;</span>
<a name="ln-1945"></a>          <span class="n">endif</span>
<a name="ln-1946"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">fd</span><span class="p">)%</span><span class="n">DividerWidth</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1947"></a><span class="k">            if</span> <span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">fd</span><span class="p">)%</span><span class="n">DividerType</span> <span class="o">==</span> <span class="n">DividedLite</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1948"></a><span class="k">              write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">704</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;Frame/Divider&#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">fd</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1949"></a>                                          <span class="s1">&#39;Divider:DividedLite&#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1950"></a>            <span class="k">else</span>
<a name="ln-1951"></a><span class="k">              write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">704</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;Frame/Divider&#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">fd</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1952"></a>                                          <span class="s1">&#39;Divider:Suspended&#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1953"></a>            <span class="n">endif</span>
<a name="ln-1954"></a>            <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">7045</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">DividerArea</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1955"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">DividerArea</span><span class="o">/</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Multiplier</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1956"></a>                             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">fd</span><span class="p">)%</span><span class="n">DividerWidth</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="s1">&#39;N/A&#39;</span>
<a name="ln-1957"></a>          <span class="n">endif</span>
<a name="ln-1958"></a>        <span class="n">endif</span>
<a name="ln-1959"></a>      <span class="k">else</span>  <span class="c">! RptType=1  Vertices only</span>
<a name="ln-1960"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">surf</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1961"></a><span class="k">          </span><span class="n">BaseSurfName</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1962"></a>        <span class="k">else</span>
<a name="ln-1963"></a><span class="k">          </span><span class="n">BaseSurfName</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">BaseSurfName</span>
<a name="ln-1964"></a>        <span class="n">endif</span>
<a name="ln-1965"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">HeatTransferAlgorithm</span><span class="p">)</span>
<a name="ln-1966"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_None</span><span class="p">)</span>
<a name="ln-1967"></a>          <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>
<a name="ln-1968"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_CTF</span><span class="p">)</span>
<a name="ln-1969"></a>          <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;CTF - ConductionTransferFunction&#39;</span>
<a name="ln-1970"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_CondFD</span><span class="p">)</span>
<a name="ln-1971"></a>          <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;CondFD - ConductionFiniteDifference&#39;</span>
<a name="ln-1972"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_EMPD</span><span class="p">)</span>
<a name="ln-1973"></a>          <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;EMPD - MoisturePenetrationDepthConductionTransferFunction&#39;</span>
<a name="ln-1974"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_HAMT</span><span class="p">)</span>
<a name="ln-1975"></a>          <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;HAMT - CombinedHeatAndMoistureFiniteElement&#39;</span>
<a name="ln-1976"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_Window5</span><span class="p">)</span>
<a name="ln-1977"></a>          <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;Window5 Detailed Fenestration&#39;</span>
<a name="ln-1978"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_ComplexFenestration</span><span class="p">)</span>
<a name="ln-1979"></a>          <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;Window7 Complex Fenestration&#39;</span>
<a name="ln-1980"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatTransferModel_TDD</span><span class="p">)</span>
<a name="ln-1981"></a>          <span class="n">AlgoName</span> <span class="o">=</span> <span class="s1">&#39;Tubular Daylighting Device&#39;</span>
<a name="ln-1982"></a>        <span class="k">END SELECT</span>
<a name="ln-1983"></a><span class="k">        write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">704</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39;HeatTransfer&#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="nb">trim</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1984"></a>                                                                                <span class="nb">trim</span><span class="p">(</span><span class="n">BaseSurfName</span><span class="p">),</span> <span class="nb">trim</span><span class="p">(</span><span class="n">AlgoName</span><span class="p">)</span>
<a name="ln-1985"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">7042</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">))</span>
<a name="ln-1986"></a>        <span class="k">do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-1987"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">vert</span> <span class="o">/=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">Surf</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1988"></a><span class="k">            write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">709</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1989"></a>                                       <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1990"></a>                                       <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1991"></a>          <span class="k">else</span>
<a name="ln-1992"></a><span class="k">            write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">709</span><span class="p">)</span>  <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1993"></a>                           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-1994"></a>                           <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1995"></a>          <span class="n">endif</span>
<a name="ln-1996"></a>        <span class="n">enddo</span>
<a name="ln-1997"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">711</span><span class="p">)</span>
<a name="ln-1998"></a>      <span class="n">endif</span>
<a name="ln-1999"></a>    <span class="n">enddo</span>  <span class="c">! surfaces</span>
<a name="ln-2000"></a>  <span class="n">enddo</span> <span class="c">! zones</span>
<a name="ln-2001"></a>
<a name="ln-2002"></a>  <span class="mi">700</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;! &lt;Zone/Shading Surfaces&gt;,&lt;Zone Name&gt;/#Shading Surfaces,# Surfaces&#39;</span><span class="p">)</span>
<a name="ln-2003"></a>  <span class="mi">701</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;! &lt;HeatTransfer/Shading/Frame/Divider_Surface&gt;,Surface Name,Surface Class,Base Surface,Heat Transfer Algorithm&#39;</span><span class="p">)</span>
<a name="ln-2004"></a>  <span class="mi">7011</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;,Construction/Transmittance Schedule,Nominal U (w/o film coefs)/Min Schedule Value,&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2005"></a>             <span class="s1">&#39;Nominal U (with film coefs)/Max Schedule Value,Solar Diffusing,&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2006"></a>             <span class="s1">&#39;Area (Net),Area (Gross),Area (Sunlit Calc),Azimuth,Tilt,~Width,~Height,Reveal,&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2007"></a>             <span class="s1">&#39;&lt;ExtBoundCondition&gt;,&lt;ExtConvCoeffCalc&gt;,&lt;IntConvCoeffCalc&gt;,&lt;SunExposure&gt;,&lt;WindExposure&gt;,&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2008"></a>             <span class="s1">&#39;ViewFactorToGround,ViewFactorToSky,ViewFactorToGround-IR,ViewFactorToSky-IR,#Sides&#39;</span><span class="p">)</span>
<a name="ln-2009"></a>  <span class="mi">7012</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;,#Sides&#39;</span><span class="p">)</span>
<a name="ln-2010"></a>  <span class="mi">702</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;! &lt;Units&gt;,,,,&#39;</span><span class="p">)</span>
<a name="ln-2011"></a>  <span class="mi">7021</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;,{W/m2-K}/{},{W/m2-K}/{},{},{m2},{m2},{m2},{deg},{deg},{m},{m},{m},,,,,,,,,,&#39;</span><span class="p">)</span>
<a name="ln-2012"></a>  <span class="mi">7022</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-2013"></a>  <span class="mi">703</span> <span class="k">format</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">I5</span><span class="p">)</span>
<a name="ln-2014"></a>  <span class="mi">704</span> <span class="k">format</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;_Surface,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-2015"></a>  <span class="mi">7041</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">),</span><span class="n">A</span><span class="p">)</span>
<a name="ln-2016"></a>  <span class="mi">7042</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-2017"></a>  <span class="mi">7044</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
<a name="ln-2018"></a>  <span class="mi">7045</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;,,,,,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-2019"></a>  <span class="mi">705</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-2020"></a>  <span class="mi">706</span> <span class="k">format</span><span class="p">(</span><span class="mi">4</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">),</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-2021"></a>  <span class="mi">7061</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;,,,,,,,,,,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-2022"></a>
<a name="ln-2023"></a>  <span class="mi">707</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;,{Vertex 1},,,{Vertex 2},,,{Vertex 3},,,{Vertex 4},,,{etc}&#39;</span><span class="p">)</span>
<a name="ln-2024"></a>  <span class="mi">708</span> <span class="k">format</span><span class="p">(</span><span class="mi">4</span><span class="p">(</span><span class="s1">&#39;,X {m},Y {m},Z {m}&#39;</span><span class="p">))</span>
<a name="ln-2025"></a>  <span class="mi">709</span> <span class="k">format</span><span class="p">(</span><span class="mi">3</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">))</span>
<a name="ln-2026"></a>
<a name="ln-2027"></a>  <span class="mi">710</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;, Vertices are shown starting at Upper-Left-Corner =&gt; Counter-Clockwise =&gt; World Coordinates&#39;</span><span class="p">)</span>
<a name="ln-2028"></a>  <span class="mi">711</span> <span class="k">format</span><span class="p">(</span><span class="mi">1</span><span class="n">X</span><span class="p">)</span>
<a name="ln-2029"></a>
<a name="ln-2030"></a>  <span class="k">RETURN</span>
<a name="ln-2031"></a>
<a name="ln-2032"></a><span class="k">END SUBROUTINE </span><span class="n">DetailsForSurfaces</span>
<a name="ln-2033"></a>
<a name="ln-2034"></a><span class="k">SUBROUTINE </span><span class="n">CostInfoOut</span>
<a name="ln-2035"></a>
<a name="ln-2036"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2037"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-2038"></a>          <span class="c">!       DATE WRITTEN   April 2003</span>
<a name="ln-2039"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2040"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2041"></a>
<a name="ln-2042"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2043"></a>          <span class="c">! This subroutine produces a file with information about surfaces.</span>
<a name="ln-2044"></a>          <span class="c">! for the purpose of producing first cost estimates to include in objective value functions</span>
<a name="ln-2045"></a>          <span class="c">! for design optimization</span>
<a name="ln-2046"></a>
<a name="ln-2047"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2048"></a>          <span class="c">! Access data in DataSurfaces and report</span>
<a name="ln-2049"></a>
<a name="ln-2050"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2051"></a>          <span class="c">! na</span>
<a name="ln-2052"></a>
<a name="ln-2053"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2054"></a>  <span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-2055"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span>
<a name="ln-2056"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span>
<a name="ln-2057"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowFatalError</span>
<a name="ln-2058"></a>
<a name="ln-2059"></a>
<a name="ln-2060"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2061"></a>
<a name="ln-2062"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2063"></a>          <span class="c">! na</span>
<a name="ln-2064"></a>
<a name="ln-2065"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2066"></a>          <span class="c">! na</span>
<a name="ln-2067"></a>
<a name="ln-2068"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2069"></a>          <span class="c">! na</span>
<a name="ln-2070"></a>
<a name="ln-2071"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2072"></a>          <span class="c">! na</span>
<a name="ln-2073"></a>
<a name="ln-2074"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2075"></a>  <span class="kt">integer </span><span class="n">unit</span>              <span class="c">! Unit number on which to write file</span>
<a name="ln-2076"></a>  <span class="kt">integer </span><span class="n">surf</span>              <span class="c">! Loop variable for surfaces</span>
<a name="ln-2077"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">external</span> <span class="kd">::</span> <span class="n">getnewunitnumber</span>  <span class="c">! External function for a new unit number</span>
<a name="ln-2078"></a>  <span class="kt">Logical</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">uniqueSurf</span>
<a name="ln-2079"></a>  <span class="kt">integer </span><span class="n">write_stat</span>
<a name="ln-2080"></a>
<a name="ln-2081"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">totsurfaces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">surface</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2082"></a>    <span class="c">! no error needed, probably in end processing, just return</span>
<a name="ln-2083"></a>    <span class="k">return</span>
<a name="ln-2084"></a><span class="k">  </span><span class="n">endif</span>
<a name="ln-2085"></a>
<a name="ln-2086"></a>  <span class="c">! need to determine unique surfacs... some surfaces are shared by zones and hence doubled</span>
<a name="ln-2087"></a>  <span class="k">Allocate</span><span class="p">(</span><span class="n">uniqueSurf</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-2088"></a>  <span class="n">uniqueSurf</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2089"></a>
<a name="ln-2090"></a>  <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-2091"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2092"></a><span class="k">        If</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&lt;</span> <span class="n">surf</span><span class="p">)</span> <span class="k">then</span> <span class="c">!already cycled through</span>
<a name="ln-2093"></a>          <span class="n">uniqueSurf</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2094"></a>
<a name="ln-2095"></a>        <span class="n">endif</span>
<a name="ln-2096"></a>
<a name="ln-2097"></a>    <span class="n">endif</span>
<a name="ln-2098"></a>    <span class="k">If</span> <span class="p">(</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>  <span class="c">!throw out others for now</span>
<a name="ln-2099"></a>         <span class="n">uniqueSurf</span><span class="p">(</span><span class="n">surf</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2100"></a>    <span class="n">endif</span>
<a name="ln-2101"></a>  <span class="n">enddo</span>
<a name="ln-2102"></a>
<a name="ln-2103"></a>  <span class="n">unit</span><span class="o">=</span><span class="n">getnewunitnumber</span><span class="p">()</span>
<a name="ln-2104"></a>  <span class="c">! .sci = surface cost info</span>
<a name="ln-2105"></a>  <span class="k">open</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;eplusout.sci&#39;</span><span class="p">,</span> <span class="n">Action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">write_stat</span><span class="p">)</span>
<a name="ln-2106"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">write_stat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2107"></a><span class="k">   CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CostInfoOut: Could not open file &quot;eplusout.sci&quot; for output (write).&#39;</span><span class="p">)</span>
<a name="ln-2108"></a>  <span class="n">endif</span>
<a name="ln-2109"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span>  <span class="n">totsurfaces</span> <span class="p">,</span> <span class="nb">count</span><span class="p">(</span><span class="n">uniqueSurf</span><span class="p">)</span>
<a name="ln-2110"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;data for surfaces useful for cost information&#39;</span>
<a name="ln-2111"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Number, Name, Construction, class, area, grossarea&#39;</span>
<a name="ln-2112"></a>
<a name="ln-2113"></a>  <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-2114"></a>    <span class="c">!if (surface(surf)%class .eq. SurfaceClass_IntMass) CYCLE</span>
<a name="ln-2115"></a>    <span class="k">If</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">uniqueSurf</span><span class="p">(</span><span class="n">surf</span><span class="p">))</span> <span class="k">cycle</span>
<a name="ln-2116"></a>    <span class="c">! why the heck are constructions == 0 ?</span>
<a name="ln-2117"></a>    <span class="k">If</span> <span class="p">(</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Construction</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2118"></a><span class="k">      write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="mi">801</span><span class="p">)</span> <span class="n">surf</span><span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">name</span><span class="p">),</span> <span class="nb">trim</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">name</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2119"></a>            <span class="nb">trim</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span><span class="p">)),</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Area</span><span class="p">,</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">GrossArea</span>
<a name="ln-2120"></a>    <span class="n">endif</span>
<a name="ln-2121"></a>
<a name="ln-2122"></a>  <span class="n">enddo</span>
<a name="ln-2123"></a>
<a name="ln-2124"></a>  <span class="mi">801</span> <span class="k">format</span><span class="p">(</span><span class="n">I5</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">f14</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">f14</span><span class="p">.</span><span class="mi">5</span> <span class="p">)</span>
<a name="ln-2125"></a>
<a name="ln-2126"></a>  <span class="k">close</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
<a name="ln-2127"></a>
<a name="ln-2128"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">uniqueSurf</span><span class="p">)</span>
<a name="ln-2129"></a>  <span class="k">return</span>
<a name="ln-2130"></a>
<a name="ln-2131"></a><span class="k">END SUBROUTINE </span><span class="n">CostInfoOut</span>
<a name="ln-2132"></a>
<a name="ln-2133"></a><span class="k">SUBROUTINE </span><span class="n">VRMLOut</span><span class="p">(</span><span class="n">PolygonAction</span><span class="p">,</span><span class="n">ColorScheme</span><span class="p">)</span>
<a name="ln-2134"></a>
<a name="ln-2135"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2136"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-2137"></a>          <span class="c">!       DATE WRITTEN   August 2006</span>
<a name="ln-2138"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2139"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2140"></a>
<a name="ln-2141"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2142"></a>          <span class="c">! This subroutine produces a file of VRML output for the surfaces.</span>
<a name="ln-2143"></a>
<a name="ln-2144"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2145"></a>          <span class="c">! Use the surface absolute coordinate information to produce</span>
<a name="ln-2146"></a>          <span class="c">! lines.</span>
<a name="ln-2147"></a>
<a name="ln-2148"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2149"></a>          <span class="c">! na</span>
<a name="ln-2150"></a>
<a name="ln-2151"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2152"></a>  <span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-2153"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">BuildingName</span><span class="p">,</span><span class="n">Zone</span>
<a name="ln-2154"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span>
<a name="ln-2155"></a>  <span class="k">USE </span><span class="n">DataDaylighting</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneDaylight</span>
<a name="ln-2156"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DegToRadians</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-2157"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowContinueError</span><span class="p">,</span> <span class="n">ShowFatalError</span>
<a name="ln-2158"></a>  <span class="k">USE </span><span class="n">DataStringGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">VerString</span>
<a name="ln-2159"></a>  <span class="k">USE </span><span class="n">DXFEarClipping</span>
<a name="ln-2160"></a>
<a name="ln-2161"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2162"></a>
<a name="ln-2163"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2164"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PolygonAction</span>
<a name="ln-2165"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ColorScheme</span>
<a name="ln-2166"></a>
<a name="ln-2167"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2168"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">parameter</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="kd">::</span> <span class="n">colorstring</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-2169"></a>        <span class="p">(</span><span class="o">/</span><span class="s1">&#39;WALL      &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2170"></a>          <span class="s1">&#39;WINDOW    &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2171"></a>          <span class="s1">&#39;FIXEDSHADE&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2172"></a>          <span class="s1">&#39;SUBSHADE  &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2173"></a>          <span class="s1">&#39;ROOF      &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2174"></a>          <span class="s1">&#39;FLOOR     &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2175"></a>          <span class="s1">&#39;BLDGSHADE &#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-2176"></a>
<a name="ln-2177"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2178"></a>          <span class="c">! na</span>
<a name="ln-2179"></a>
<a name="ln-2180"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2181"></a>          <span class="c">! na</span>
<a name="ln-2182"></a>
<a name="ln-2183"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2184"></a>  <span class="kt">integer </span><span class="n">unit</span>              <span class="c">! Unit number on which to write file</span>
<a name="ln-2185"></a>  <span class="kt">integer </span><span class="n">surf</span>              <span class="c">! Loop variable for surfaces</span>
<a name="ln-2186"></a>  <span class="kt">integer </span><span class="n">vert</span>              <span class="c">! Loop counter</span>
<a name="ln-2187"></a>  <span class="kt">integer</span><span class="p">,</span><span class="k">external</span> <span class="kd">::</span> <span class="n">getnewunitnumber</span>  <span class="c">! External function for a new unit number</span>
<a name="ln-2188"></a>  <span class="kt">integer </span><span class="n">colorindex</span>        <span class="c">! color index by surface type</span>
<a name="ln-2189"></a><span class="c">!  REAL(r64) minx                 ! minimum x in surface data</span>
<a name="ln-2190"></a><span class="c">!  REAL(r64) miny                 ! minimum y in surface data</span>
<a name="ln-2191"></a><span class="c">!  REAL(r64) minz                 ! minimum z in surface data (for polygon output)</span>
<a name="ln-2192"></a>  <span class="kt">integer </span><span class="n">zones</span>             <span class="c">! loop counter for zone loop</span>
<a name="ln-2193"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span> <span class="n">zonenum</span>
<a name="ln-2194"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="n">TempZoneName</span>
<a name="ln-2195"></a>  <span class="kt">integer </span><span class="n">pos</span>
<a name="ln-2196"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span> <span class="n">ShadeType</span>
<a name="ln-2197"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ThickPolyline</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2198"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">RegularPolyline</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2199"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PolylineWidth</span><span class="o">=</span><span class="s1">&#39; 0.55&#39;</span>
<a name="ln-2200"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">TriangulateFace</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2201"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ntri</span>
<a name="ln-2202"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">svert</span>
<a name="ln-2203"></a>  <span class="k">type</span> <span class="p">(</span><span class="n">dTriangle</span><span class="p">),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">mytriangles</span>
<a name="ln-2204"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">vv0</span>
<a name="ln-2205"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">vv1</span>
<a name="ln-2206"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">vv2</span>
<a name="ln-2207"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span> <span class="kd">::</span> <span class="n">csurfnumber</span>
<a name="ln-2208"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span> <span class="kd">::</span> <span class="n">csidenumber</span>
<a name="ln-2209"></a>  <span class="kt">integer </span><span class="n">write_stat</span>
<a name="ln-2210"></a>
<a name="ln-2211"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">PolygonAction</span> <span class="o">==</span> <span class="s1">&#39;TRIANGULATE3DFACE&#39;</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">PolygonAction</span> <span class="o">==</span> <span class="s1">&#39;TRIANGULATE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2212"></a><span class="k">    </span><span class="n">TriangulateFace</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2213"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">PolygonAction</span> <span class="o">==</span> <span class="s1">&#39;THICKPOLYLINE&#39;</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">PolygonAction</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2214"></a><span class="k">    </span><span class="n">ThickPolyline</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2215"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">PolygonAction</span> <span class="o">==</span> <span class="s1">&#39;REGULARPOLYLINE&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2216"></a><span class="k">    </span><span class="n">RegularPolyline</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2217"></a>    <span class="n">PolylineWidth</span><span class="o">=</span><span class="s1">&#39; 0&#39;</span>
<a name="ln-2218"></a>  <span class="k">ELSE</span>
<a name="ln-2219"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;VRMLOut: Illegal key specified for Surfaces with &gt; 4 sides=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PolygonAction</span><span class="p">))</span>
<a name="ln-2220"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;&quot;TRIANGULATE 3DFACE&quot; will be used for any surfaces with &gt; 4 sides.&#39;</span><span class="p">)</span>
<a name="ln-2221"></a>    <span class="n">TriangulateFace</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2222"></a>  <span class="n">ENDIF</span>
<a name="ln-2223"></a>
<a name="ln-2224"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">totsurfaces</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">surface</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2225"></a>    <span class="c">! no error needed, probably in end processing, just return</span>
<a name="ln-2226"></a>    <span class="k">return</span>
<a name="ln-2227"></a><span class="k">  </span><span class="n">endif</span>
<a name="ln-2228"></a>
<a name="ln-2229"></a>  <span class="n">unit</span><span class="o">=</span><span class="n">getnewunitnumber</span><span class="p">()</span>
<a name="ln-2230"></a>  <span class="k">open</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;eplusout.wrl&#39;</span><span class="p">,</span> <span class="n">Action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">write_stat</span><span class="p">)</span>
<a name="ln-2231"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">write_stat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2232"></a><span class="k">   CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;VRMLOut: Could not open file &quot;eplusout.wrl&quot; for output (write).&#39;</span><span class="p">)</span>
<a name="ln-2233"></a>  <span class="n">endif</span>
<a name="ln-2234"></a>
<a name="ln-2235"></a>
<a name="ln-2236"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">702</span><span class="p">)</span>   <span class="c">! Beginning</span>
<a name="ln-2237"></a>  <span class="mi">702</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;#VRML V2.0 utf8&#39;</span><span class="p">)</span>
<a name="ln-2238"></a>
<a name="ln-2239"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ColorScheme</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2240"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">707</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">BuildingName</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VerString</span><span class="p">),</span><span class="s1">&#39;Default&#39;</span>   <span class="c">! World Info</span>
<a name="ln-2241"></a>  <span class="k">else</span>
<a name="ln-2242"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">707</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">BuildingName</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VerString</span><span class="p">),</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ColorScheme</span><span class="p">)</span>   <span class="c">! World Info</span>
<a name="ln-2243"></a>  <span class="n">endif</span>
<a name="ln-2244"></a>  <span class="mi">707</span> <span class="k">format</span><span class="p">(</span><span class="s1">&#39;WorldInfo {&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="mi">3</span><span class="n">X</span><span class="p">,</span><span class="s1">&#39;title &quot;Building - &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-2245"></a>              <span class="mi">3</span><span class="n">X</span><span class="p">,</span><span class="s1">&#39;info [&quot;EnergyPlus Program Version &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;&quot;]&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2246"></a>              <span class="mi">3</span><span class="n">X</span><span class="p">,</span><span class="s1">&#39;info [&quot;Surface Color Scheme &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;&quot;]&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2247"></a>             <span class="s1">&#39;}&#39;</span><span class="p">)</span>
<a name="ln-2248"></a>
<a name="ln-2249"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;# Zone Names&#39;</span>
<a name="ln-2250"></a>  <span class="k">do </span><span class="n">zones</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-2251"></a>    <span class="k">write</span><span class="p">(</span><span class="n">zonenum</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">zones</span>
<a name="ln-2252"></a>    <span class="n">zonenum</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)</span>
<a name="ln-2253"></a>    <span class="n">TempZoneName</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">Zones</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-2254"></a>    <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-2255"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-2256"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-2257"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-2258"></a>    <span class="k">END DO</span>
<a name="ln-2259"></a><span class="k">    </span><span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-2260"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-2261"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-2262"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-2263"></a>    <span class="k">END DO</span>
<a name="ln-2264"></a><span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;# Zone=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">zonenum</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)</span>
<a name="ln-2265"></a>  <span class="n">enddo</span>
<a name="ln-2266"></a>
<a name="ln-2267"></a>  <span class="c">! Define the colors:</span>
<a name="ln-2268"></a>  <span class="mi">800</span> <span class="k">Format</span> <span class="p">(</span><span class="s1">&#39;Shape {&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;appearance DEF &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39; Appearance {&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2269"></a>       <span class="s1">&#39;material Material { diffuseColor &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39; }&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;}&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;}&#39;</span><span class="p">)</span>
<a name="ln-2270"></a>
<a name="ln-2271"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">800</span><span class="p">)</span> <span class="s1">&#39;FLOOR&#39;</span><span class="p">,</span><span class="s1">&#39;0.502 0.502 0.502&#39;</span>
<a name="ln-2272"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">800</span><span class="p">)</span> <span class="s1">&#39;ROOF&#39;</span><span class="p">,</span><span class="s1">&#39;1 1 0&#39;</span>
<a name="ln-2273"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">800</span><span class="p">)</span> <span class="s1">&#39;WALL&#39;</span><span class="p">,</span><span class="s1">&#39;0 1 0&#39;</span>
<a name="ln-2274"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">800</span><span class="p">)</span> <span class="s1">&#39;WINDOW&#39;</span><span class="p">,</span><span class="s1">&#39;0 1 1&#39;</span>
<a name="ln-2275"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">800</span><span class="p">)</span> <span class="s1">&#39;DOOR&#39;</span><span class="p">,</span><span class="s1">&#39;0 1 1&#39;</span>
<a name="ln-2276"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">800</span><span class="p">)</span> <span class="s1">&#39;GLASSDOOR&#39;</span><span class="p">,</span><span class="s1">&#39;0 1 1&#39;</span>
<a name="ln-2277"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">800</span><span class="p">)</span> <span class="s1">&#39;FIXEDSHADE&#39;</span><span class="p">,</span><span class="s1">&#39;1 0 1&#39;</span>
<a name="ln-2278"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">800</span><span class="p">)</span> <span class="s1">&#39;BLDGSHADE&#39;</span><span class="p">,</span><span class="s1">&#39;0 0 1&#39;</span>
<a name="ln-2279"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">800</span><span class="p">)</span> <span class="s1">&#39;SUBSHADE&#39;</span><span class="p">,</span><span class="s1">&#39;1 0 1&#39;</span>
<a name="ln-2280"></a>  <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">800</span><span class="p">)</span> <span class="s1">&#39;BACKCOLOR&#39;</span><span class="p">,</span><span class="s1">&#39;0.502 0.502 0.784&#39;</span>
<a name="ln-2281"></a>
<a name="ln-2282"></a>  <span class="mi">801</span> <span class="k">Format</span><span class="p">(</span><span class="s1">&#39;Shape {&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;appearance USE &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-2283"></a>    <span class="s1">&#39;geometry IndexedFaceSet {&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>                    <span class="p">&amp;</span>
<a name="ln-2284"></a>    <span class="s1">&#39;solid TRUE&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>                                   <span class="p">&amp;</span>
<a name="ln-2285"></a>    <span class="s1">&#39;coord DEF &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39; Coordinate {&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span>                 <span class="p">&amp;</span>
<a name="ln-2286"></a>    <span class="s1">&#39;point [&#39;</span><span class="p">)</span>
<a name="ln-2287"></a>
<a name="ln-2288"></a>  <span class="mi">802</span> <span class="k">Format</span><span class="p">(</span><span class="n">F15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="n">X</span><span class="p">,</span><span class="n">F15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="n">X</span><span class="p">,</span><span class="n">F15</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<a name="ln-2289"></a>
<a name="ln-2290"></a>  <span class="mi">803</span> <span class="k">Format</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;}&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;coordIndex [&#39;</span><span class="p">)</span>
<a name="ln-2291"></a>
<a name="ln-2292"></a>  <span class="mi">804</span> <span class="k">Format</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<a name="ln-2293"></a>
<a name="ln-2294"></a>  <span class="mi">805</span> <span class="k">Format</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;ccw TRUE&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;solid TRUE&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;}&#39;</span><span class="p">,</span><span class="o">/</span><span class="p">,</span><span class="s1">&#39;}&#39;</span><span class="p">)</span>
<a name="ln-2295"></a>
<a name="ln-2296"></a>
<a name="ln-2297"></a>  <span class="c">!  Do all detached shading surfaces first</span>
<a name="ln-2298"></a>  <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-2299"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">heattranssurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2300"></a><span class="k">    if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="o">==</span> <span class="n">SurfaceClass_Shading</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2301"></a><span class="k">    if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2302"></a><span class="k">    if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Detached_F</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-2303"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Detached_B</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="mi">7</span>
<a name="ln-2304"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Detached_F</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2305"></a><span class="k">      </span><span class="n">ShadeType</span><span class="o">=</span><span class="s1">&#39;Fixed Shading&#39;</span>
<a name="ln-2306"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;# Fixed Shading:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2307"></a>    <span class="n">elseif</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Detached_B</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2308"></a><span class="k">      </span><span class="n">ShadeType</span><span class="o">=</span><span class="s1">&#39;Building Shading&#39;</span>
<a name="ln-2309"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;# Building Shading:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2310"></a>    <span class="n">endif</span>
<a name="ln-2311"></a>    <span class="k">write</span><span class="p">(</span><span class="n">csurfnumber</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">surf</span>
<a name="ln-2312"></a>    <span class="n">csurfnumber</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">csurfnumber</span><span class="p">)</span>
<a name="ln-2313"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">801</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">colorstring</span><span class="p">(</span><span class="n">colorindex</span><span class="p">)),</span><span class="s1">&#39;Surf&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">csurfnumber</span><span class="p">)</span>
<a name="ln-2314"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">802</span><span class="p">)</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2315"></a>                    <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">)</span>
<a name="ln-2316"></a>    <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">803</span><span class="p">)</span>
<a name="ln-2317"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TriangulateFace</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2318"></a><span class="k">      do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-2319"></a>        <span class="k">write</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">vert</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2320"></a>        <span class="n">csidenumber</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2321"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2322"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">vert</span> <span class="o">==</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">)</span> <span class="s1">&#39; -1&#39;</span>
<a name="ln-2323"></a>      <span class="n">enddo</span>
<a name="ln-2324"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">805</span><span class="p">)</span>
<a name="ln-2325"></a>    <span class="k">else</span>  <span class="c">! will be &gt;4 sided polygon with triangulate option</span>
<a name="ln-2326"></a>      <span class="n">ntri</span><span class="o">=</span><span class="n">triangulate</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">,</span><span class="n">mytriangles</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">azimuth</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2327"></a>                  <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">tilt</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">name</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span><span class="p">)</span>
<a name="ln-2328"></a>      <span class="k">do </span><span class="n">svert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntri</span>
<a name="ln-2329"></a>        <span class="n">vv0</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv0</span>
<a name="ln-2330"></a>        <span class="k">write</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">vv0</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2331"></a>        <span class="n">csidenumber</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2332"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2333"></a>        <span class="n">vv1</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv1</span>
<a name="ln-2334"></a>        <span class="k">write</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">vv1</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2335"></a>        <span class="n">csidenumber</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2336"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2337"></a>        <span class="n">vv2</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv2</span>
<a name="ln-2338"></a>        <span class="k">write</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">vv2</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2339"></a>        <span class="n">csidenumber</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2340"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2341"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">)</span> <span class="s1">&#39; -1&#39;</span>
<a name="ln-2342"></a>      <span class="n">enddo</span>
<a name="ln-2343"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">805</span><span class="p">)</span>
<a name="ln-2344"></a>      <span class="k">deallocate</span><span class="p">(</span><span class="n">mytriangles</span><span class="p">)</span>
<a name="ln-2345"></a>    <span class="n">endif</span>
<a name="ln-2346"></a>  <span class="n">enddo</span>
<a name="ln-2347"></a><span class="c">!</span>
<a name="ln-2348"></a><span class="c">!  ! now do zone surfaces, by zone</span>
<a name="ln-2349"></a>  <span class="k">do </span><span class="n">zones</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-2350"></a>    <span class="n">TempZoneName</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">Zones</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-2351"></a>    <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-2352"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-2353"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-2354"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-2355"></a>    <span class="k">END DO</span>
<a name="ln-2356"></a><span class="k">    </span><span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-2357"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">pos</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-2358"></a>      <span class="n">TempZoneName</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span><span class="n">pos</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
<a name="ln-2359"></a>      <span class="n">pos</span><span class="o">=</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">TempZoneName</span><span class="p">)),</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-2360"></a>    <span class="k">END DO</span>
<a name="ln-2361"></a><span class="k">    do </span><span class="n">surf</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">surfacefirst</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">surfacelast</span>
<a name="ln-2362"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2363"></a><span class="k">      if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2364"></a><span class="k">      if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Wall</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-2365"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Roof</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="mi">5</span>
<a name="ln-2366"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-2367"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Floor</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="mi">6</span>
<a name="ln-2368"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-2369"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">SurfaceClass_Door</span><span class="p">)</span> <span class="n">colorindex</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-2370"></a><span class="c">!</span>
<a name="ln-2371"></a>      <span class="k">write</span><span class="p">(</span><span class="n">csurfnumber</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">surf</span>
<a name="ln-2372"></a>      <span class="n">csurfnumber</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">csurfnumber</span><span class="p">)</span>
<a name="ln-2373"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;# &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2374"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">801</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">colorstring</span><span class="p">(</span><span class="n">colorindex</span><span class="p">)),</span><span class="s1">&#39;Surf&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">csurfnumber</span><span class="p">)</span>
<a name="ln-2375"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">802</span><span class="p">)</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2376"></a>                      <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">)</span>
<a name="ln-2377"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">803</span><span class="p">)</span>
<a name="ln-2378"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TriangulateFace</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2379"></a><span class="k">        do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-2380"></a>          <span class="k">write</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">vert</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2381"></a>          <span class="n">csidenumber</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2382"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2383"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">vert</span> <span class="o">==</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">)</span> <span class="s1">&#39; -1&#39;</span>
<a name="ln-2384"></a>        <span class="n">enddo</span>
<a name="ln-2385"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">805</span><span class="p">)</span>
<a name="ln-2386"></a>      <span class="k">else</span>  <span class="c">! will be &gt;4 sided polygon with triangulate option</span>
<a name="ln-2387"></a>        <span class="n">ntri</span><span class="o">=</span><span class="n">triangulate</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">,</span><span class="n">mytriangles</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">azimuth</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2388"></a>                    <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">tilt</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">name</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span><span class="p">)</span>
<a name="ln-2389"></a>        <span class="k">do </span><span class="n">svert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntri</span>
<a name="ln-2390"></a>          <span class="n">vv0</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv0</span>
<a name="ln-2391"></a>          <span class="k">write</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">vv0</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2392"></a>          <span class="n">csidenumber</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2393"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2394"></a>          <span class="n">vv1</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv1</span>
<a name="ln-2395"></a>          <span class="k">write</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">vv1</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2396"></a>          <span class="n">csidenumber</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2397"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2398"></a>          <span class="n">vv2</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv2</span>
<a name="ln-2399"></a>          <span class="k">write</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">vv2</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2400"></a>          <span class="n">csidenumber</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2401"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2402"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">)</span> <span class="s1">&#39; -1&#39;</span>
<a name="ln-2403"></a>        <span class="n">enddo</span>
<a name="ln-2404"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">805</span><span class="p">)</span>
<a name="ln-2405"></a>        <span class="k">deallocate</span><span class="p">(</span><span class="n">mytriangles</span><span class="p">)</span>
<a name="ln-2406"></a>      <span class="n">endif</span>
<a name="ln-2407"></a>    <span class="n">enddo</span>
<a name="ln-2408"></a>    <span class="c">! still have to do shading surfaces for zone</span>
<a name="ln-2409"></a>    <span class="n">colorindex</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-2410"></a>    <span class="k">do </span><span class="n">surf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-2411"></a><span class="c">!      !if (surface(surf)%heattranssurf) CYCLE ! Shading with a construction is allowed to be HT surf for daylighting shelves</span>
<a name="ln-2412"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">SurfaceClass_Shading</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2413"></a><span class="k">      if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">zonename</span> <span class="o">/=</span> <span class="n">zone</span><span class="p">(</span><span class="n">zones</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2414"></a><span class="k">      if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2415"></a><span class="k">      write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">710</span><span class="p">)</span> <span class="s1">&#39;# &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2416"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">801</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="n">colorstring</span><span class="p">(</span><span class="n">colorindex</span><span class="p">)),</span><span class="s1">&#39;Surf&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">csurfnumber</span><span class="p">)</span>
<a name="ln-2417"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">802</span><span class="p">)</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">x</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">y</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2418"></a>                      <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">(</span><span class="n">vert</span><span class="p">)%</span><span class="n">z</span><span class="p">,</span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">)</span>
<a name="ln-2419"></a>      <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">803</span><span class="p">)</span>
<a name="ln-2420"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TriangulateFace</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2421"></a><span class="k">        do </span><span class="n">vert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span>
<a name="ln-2422"></a>          <span class="k">write</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">vert</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2423"></a>          <span class="n">csidenumber</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2424"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2425"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">vert</span> <span class="o">==</span> <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">)</span> <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">)</span> <span class="s1">&#39; -1&#39;</span>
<a name="ln-2426"></a>        <span class="n">enddo</span>
<a name="ln-2427"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">805</span><span class="p">)</span>
<a name="ln-2428"></a>      <span class="k">else</span>  <span class="c">! will be &gt;4 sided polygon with triangulate option</span>
<a name="ln-2429"></a>        <span class="n">ntri</span><span class="o">=</span><span class="n">triangulate</span><span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">sides</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">vertex</span><span class="p">,</span><span class="n">mytriangles</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">azimuth</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2430"></a>                    <span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">tilt</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="n">name</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">surf</span><span class="p">)%</span><span class="k">class</span><span class="p">)</span>
<a name="ln-2431"></a>        <span class="k">do </span><span class="n">svert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntri</span>
<a name="ln-2432"></a>          <span class="n">vv0</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv0</span>
<a name="ln-2433"></a>          <span class="k">write</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">vv0</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2434"></a>          <span class="n">csidenumber</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2435"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2436"></a>          <span class="n">vv1</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv1</span>
<a name="ln-2437"></a>          <span class="k">write</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">vv1</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2438"></a>          <span class="n">csidenumber</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2439"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2440"></a>          <span class="n">vv2</span><span class="o">=</span><span class="n">mytriangles</span><span class="p">(</span><span class="n">svert</span><span class="p">)%</span><span class="n">vv2</span>
<a name="ln-2441"></a>          <span class="k">write</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">vv2</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2442"></a>          <span class="n">csidenumber</span><span class="o">=</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2443"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">,</span><span class="n">advance</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">)</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">csidenumber</span><span class="p">)</span>
<a name="ln-2444"></a>          <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">804</span><span class="p">)</span> <span class="s1">&#39; -1&#39;</span>
<a name="ln-2445"></a>        <span class="n">enddo</span>
<a name="ln-2446"></a>        <span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="mi">805</span><span class="p">)</span>
<a name="ln-2447"></a>        <span class="k">deallocate</span><span class="p">(</span><span class="n">mytriangles</span><span class="p">)</span>
<a name="ln-2448"></a>      <span class="n">endif</span>
<a name="ln-2449"></a>    <span class="n">enddo</span>
<a name="ln-2450"></a>  <span class="n">enddo</span>
<a name="ln-2451"></a>
<a name="ln-2452"></a><span class="c">! vrml does not have daylighting reference points included</span>
<a name="ln-2453"></a>
<a name="ln-2454"></a>  <span class="mi">710</span> <span class="k">format</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<a name="ln-2455"></a>
<a name="ln-2456"></a>  <span class="k">close</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
<a name="ln-2457"></a>
<a name="ln-2458"></a>  <span class="k">return</span>
<a name="ln-2459"></a>
<a name="ln-2460"></a><span class="k">END SUBROUTINE </span><span class="n">VRMLOut</span>
<a name="ln-2461"></a>
<a name="ln-2462"></a>
<a name="ln-2463"></a><span class="c">!     NOTICE</span>
<a name="ln-2464"></a><span class="c">!</span>
<a name="ln-2465"></a><span class="c">!     Copyright  1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-2466"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-2467"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-2468"></a><span class="c">!</span>
<a name="ln-2469"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-2470"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-2471"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-2472"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-2473"></a><span class="c">!</span>
<a name="ln-2474"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-2475"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-2476"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-2477"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-2478"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-2479"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-2480"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-2481"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-2482"></a><span class="c">!     permit others to do so.</span>
<a name="ln-2483"></a><span class="c">!</span>
<a name="ln-2484"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-2485"></a><span class="c">!</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
