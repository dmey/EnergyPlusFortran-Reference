<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>HVACMultiSpeedHeatPump.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>HVACMultiSpeedHeatPump.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 0.7% of total for source files.">2709 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/HVACMultiSpeedHeatPump.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">HVACMultiSpeedHeatPump.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/hvacmultispeedheatpump.html">HVACMultiSpeedHeatPump</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html#src">HVACMultiSpeedHeatPump.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilehvacmultispeedheatpumpf90EfferentGraph" width="641pt" height="1476pt"
 viewBox="0.00 0.00 641.00 1475.83" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph" class="graph" transform="scale(.2034 .2034) rotate(0) translate(4 7252.8487)">
<title>sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-7252.8487 3147.8704,-7252.8487 3147.8704,4 -4,4"/>
<!-- sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~hvacmultispeedheatpump.f90</title>
<polygon fill="none" stroke="#000000" points="3143.8959,-4346.9922 2983.7938,-4346.9922 2983.7938,-4324.9813 3143.8959,-4324.9813 3143.8959,-4346.9922"/>
<text text-anchor="middle" x="3063.8448" y="-4332.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HVACMultiSpeedHeatPump.f90</text>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643.4123,-4765.9922 528.0262,-4765.9922 528.0262,-4743.9813 643.4123,-4743.9813 643.4123,-4765.9922"/>
<text text-anchor="middle" x="585.7192" y="-4751.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge440" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.9881,-4766.1239C598.5403,-4816.9278 644.2625,-5026.1866 690.4731,-5071.9867 707.6639,-5089.0247 1503.0413,-5320.9241 1520.2075,-5337.9867 1556.6914,-5374.2504 1524.3102,-5407.6298 1556.2075,-5447.9867 1661.2368,-5580.8715 1742.7601,-5549.4388 1881.23,-5646.9867 2047.4696,-5764.0976 2104.8358,-5779.9222 2237.5562,-5933.9867 2350.4853,-6065.0772 2354.1233,-6116.5998 2434.1865,-6269.9867 2533.4067,-6460.0751 2455.8428,-6592.4444 2636.4756,-6707.9867 2695.5947,-6745.8025 2742.2408,-6754.963 2794.3784,-6707.9867 2944.9329,-6572.3363 2756.3972,-5954.1467 2889.0989,-5800.9867"/>
</g>
<!-- sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~hvacfancomponent.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/hvacfancomponent.f90.html" xlink:title="HVACFanComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2600.6204,-5050.9922 2470.0417,-5050.9922 2470.0417,-5028.9813 2600.6204,-5028.9813 2600.6204,-5050.9922"/>
<text text-anchor="middle" x="2535.3311" y="-5036.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFanComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M918.1154,-4829.9867C1103.6081,-4722.6425 1669.3215,-4747.9688 1881.23,-4779.9867 1944.8186,-4789.5946 2378.0841,-4919.5489 2434.1865,-4950.9867 2467.7228,-4969.7793 2499.8875,-5001.1259 2518.6187,-5021.1608"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2516.2262,-5023.7304 2525.5644,-5028.7353 2521.3855,-5018.9994 2516.2262,-5023.7304"/>
</g>
<!-- sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~datazoneequipment.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/datazoneequipment.f90.html" xlink:title="DataZoneEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1880.5522,-4235.9922 1754.905,-4235.9922 1754.905,-4213.9813 1880.5522,-4213.9813 1880.5522,-4235.9922"/>
<text text-anchor="middle" x="1817.7286" y="-4221.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M755.1332,-4677.9867C952.7428,-4575.8192 962.3499,-4481.1272 1166.6023,-4392.9867 1224.1297,-4368.1621 1659.1865,-4296.9595 1718.2273,-4275.9867 1743.9664,-4266.8435 1771.4724,-4252.3429 1791.0262,-4241.137"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1792.8011,-4244.1536 1799.6795,-4236.0952 1789.2771,-4238.1054 1792.8011,-4244.1536"/>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M608.4613,-4743.8815C640.7222,-4728.3052 701.7897,-4699.4712 755.1332,-4677.9867"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~hvacheatingcoils.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/hvacheatingcoils.f90.html" xlink:title="HVACHeatingCoils.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2948.0406,-4346.9922 2830.1571,-4346.9922 2830.1571,-4324.9813 2948.0406,-4324.9813 2948.0406,-4346.9922"/>
<text text-anchor="middle" x="2889.0989" y="-4332.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACHeatingCoils.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M755.1332,-5000.9867C1070.2825,-5153.5807 1188.1984,-5077.7484 1520.2075,-5188.9867 1630.3303,-5225.8829 2356.7246,-5600.1929 2470.1865,-5624.9867 2526.7578,-5637.3488 2556.0344,-5662.1097 2600.4756,-5624.9867 2669.4557,-5567.3658 2583.8489,-5498.8486 2636.4756,-5425.9867 2683.2662,-5361.205 2750.3792,-5406.6959 2794.3784,-5339.9867 2850.4594,-5254.9598 2882.8518,-4494.8998 2888.282,-4357.2965"/>
<polygon fill="#a4ff00" stroke="#a4ff00" points="2891.7834,-4357.3249 2888.6759,-4347.1961 2884.7887,-4357.052 2891.7834,-4357.3249"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~hvacwatercoilcomponent.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/hvacwatercoilcomponent.f90.html" xlink:title="HVACWaterCoilComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2794.3299,-2692.9922 2636.5241,-2692.9922 2636.5241,-2670.9813 2794.3299,-2670.9813 2794.3299,-2692.9922"/>
<text text-anchor="middle" x="2715.427" y="-2678.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACWaterCoilComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge295" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M755.1332,-5000.9867C848.4541,-5040.1453 880.6599,-5017.057 980.4375,-5033.9867 1472.8045,-5117.5289 1586.5888,-5199.4374 2083.7241,-5246.9867 2151.7833,-5253.4964 2170.4016,-5259.8199 2237.5562,-5246.9867 2409.6604,-5214.0979 2504.295,-5239.4478 2600.4756,-5092.9867 2655.2869,-5009.5217 2629.0974,-3395.5672 2636.4756,-3295.9867 2653.7709,-3062.5581 2698.7802,-2781.9167 2711.8312,-2703.3394"/>
<polygon fill="#0020ff" stroke="#0020ff" points="2715.3224,-2703.6819 2713.5177,-2693.2419 2708.418,-2702.5286 2715.3224,-2703.6819"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="788.502,-2941.9922 721.7644,-2941.9922 721.7644,-2919.9813 788.502,-2919.9813 788.502,-2941.9922"/>
<text text-anchor="middle" x="755.1332" y="-2927.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge322" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M587.0876,-4743.9405C594.9374,-4680.171 634.5924,-4352.5889 654.4731,-4083.9867 680.3513,-3734.3556 651.8146,-3644.4363 690.4731,-3295.9867 705.1092,-3164.0646 738.1322,-3007.7928 750.4146,-2952.0366"/>
<polygon fill="#1000ff" stroke="#1000ff" points="753.834,-2952.7832 752.583,-2942.2625 747.0001,-2951.2671 753.834,-2952.7832"/>
</g>
<!-- sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~dxcoil.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/dxcoil.f90.html" xlink:title="DXCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2746.615,-1855.9922 2684.239,-1855.9922 2684.239,-1833.9813 2746.615,-1833.9813 2746.615,-1855.9922"/>
<text text-anchor="middle" x="2715.427" y="-1841.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DXCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge341" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M755.1332,-5000.9867C890.9145,-5059.0373 925.8499,-4905.9867 1073.5199,-4905.9867 1073.5199,-4905.9867 1073.5199,-4905.9867 1250.8191,-4905.9867 1373.5556,-4905.9867 2262.7739,-4882.734 2353.8713,-4964.9867"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~hvacsteamcoilcomponent.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/hvacsteamcoilcomponent.f90.html" xlink:title="HVACSteamCoilComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2434.0021,-4134.9922 2273.7405,-4134.9922 2273.7405,-4112.9813 2434.0021,-4112.9813 2434.0021,-4134.9922"/>
<text text-anchor="middle" x="2353.8713" y="-4120.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACSteamCoilComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge411" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M643.4284,-4751.2259C743.3731,-4744.066 954.8467,-4726.0629 1130.6023,-4691.9867 1239.3888,-4670.8948 1262.2833,-4647.2528 1371.0359,-4625.9867 1561.3471,-4588.7724 2101.1003,-4660.7658 2237.5562,-4522.9867 2289.466,-4470.5735 2239.1746,-4258.253 2273.5562,-4192.9867 2285.2631,-4170.7635 2307.354,-4152.6061 2325.4086,-4140.5055"/>
<polygon fill="#ff0094" stroke="#ff0094" points="2327.3627,-4143.4102 2333.8844,-4135.0605 2323.5792,-4137.5208 2327.3627,-4143.4102"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~runtimelanguageprocessor.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/runtimelanguageprocessor.f90.html" xlink:title="RuntimeLanguageProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1718.2372,-1723.9922 1556.1976,-1723.9922 1556.1976,-1701.9813 1718.2372,-1701.9813 1718.2372,-1723.9922"/>
<text text-anchor="middle" x="1637.2174" y="-1709.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RuntimeLanguageProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M595.5102,-4743.821C630.376,-4703.5796 750.1149,-4561.2052 819.7932,-4425.9867 842.1985,-4382.5069 838.978,-4367.9187 855.7932,-4321.9867 996.6556,-3937.2122 1428.9554,-3001.4447 1520.2075,-2601.9867 1564.4958,-2408.1141 1530.2885,-2353.1574 1556.2075,-2155.9867 1577.6925,-1992.5468 1618.7375,-1797.8319 1632.5499,-1734.2213"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1636.0206,-1734.7328 1634.7332,-1724.2165 1629.1815,-1733.2403 1636.0206,-1734.7328"/>
</g>
<!-- sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node53" class="node">
<title>sourcefile~refrigeratedcase.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node53"><a xlink:href="../sourcefile/refrigeratedcase.f90.html" xlink:title="RefrigeratedCase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2409.6779,-3738.9922 2298.0648,-3738.9922 2298.0648,-3716.9813 2409.6779,-3716.9813 2409.6779,-3738.9922"/>
<text text-anchor="middle" x="2353.8713" y="-3724.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RefrigeratedCase.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.1154,-4677.9867C1029.3361,-4661.2015 1055.566,-4647.9517 1166.6023,-4629.9867 1196.219,-4625.195 2216.7376,-4511.59 2237.5562,-4489.9867 2297.3363,-4427.9532 2260.5357,-4189.1472 2273.5562,-4103.9867 2294.4109,-3967.5863 2333.9548,-3806.301 2348.4068,-3749.2594"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2351.8722,-3749.8338 2350.9496,-3739.2793 2345.0889,-3748.1055 2351.8722,-3749.8338"/>
</g>
<!-- sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node54" class="node">
<title>sourcefile~watermanager.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node54"><a xlink:href="../sourcefile/watermanager.f90.html" xlink:title="WaterManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1299.8186,-1533.9922 1201.8196,-1533.9922 1201.8196,-1511.9813 1299.8186,-1511.9813 1299.8186,-1533.9922"/>
<text text-anchor="middle" x="1250.8191" y="-1519.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WaterManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.1498,-4743.9449C595.346,-4680.1997 636.6037,-4352.7302 654.4731,-4083.9867 663.1243,-3953.8793 655.858,-3036.703 690.4731,-2910.9867 721.9138,-2796.7997 786.2664,-2791.5788 819.7932,-2677.9867 887.1296,-2449.8444 763.6051,-2363.2684 855.7932,-2143.9867 897.3493,-2045.14 944.4227,-2043.4315 1016.4375,-1963.9867 1041.5933,-1936.2356 1051.8477,-1932.536 1073.5199,-1901.9867"/>
</g>
<!-- sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node59" class="node">
<title>sourcefile~setpointmanager.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node59"><a xlink:href="../sourcefile/setpointmanager.f90.html" xlink:title="SetPointManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2590.4046,-2597.9922 2480.2575,-2597.9922 2480.2575,-2575.9813 2590.4046,-2575.9813 2590.4046,-2597.9922"/>
<text text-anchor="middle" x="2535.3311" y="-2583.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SetPointManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge274" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.7505,-4766.1639C600.881,-4808.2555 650.4135,-4957.0451 755.1332,-5000.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-5000.9867C829.8481,-5032.338 790.8457,-4897.4331 855.7932,-4848.9867 879.0044,-4831.6728 894.1263,-4846.2057 918.1154,-4829.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.1154,-4829.9867C960.9129,-4801.0514 967.9794,-4785.895 1016.4375,-4767.9867 1450.9516,-4607.4072 1592.9609,-4705.1833 2047.7241,-4616.9867 2132.9477,-4600.4585 2179.933,-4635.916 2237.5562,-4570.9867 2327.28,-4469.8866 2206.8593,-4386.5586 2273.5562,-4268.9867 2295.8065,-4229.7642 2340.287,-4249.9862 2353.8713,-4206.9867"/>
</g>
<!-- sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node60" class="node">
<title>sourcefile~standardratings.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node60"><a xlink:href="../sourcefile/standardratings.f90.html" xlink:title="StandardRatings.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2214.3709,-4480.9922 2106.9093,-4480.9922 2106.9093,-4458.9813 2214.3709,-4458.9813 2214.3709,-4480.9922"/>
<text text-anchor="middle" x="2160.6401" y="-4466.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">StandardRatings.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge333" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-4677.9867C822.3247,-4650.9248 846.795,-4690.6538 918.1154,-4677.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.1154,-4677.9867C1047.9198,-4654.9325 1041.3365,-4557.0863 1166.6023,-4515.9867 1252.8742,-4487.6811 1891.8147,-4465.0487 1982.4771,-4469.9867"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node61" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node61"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1881.2313,-5677.9922 1754.226,-5677.9922 1754.226,-5655.9813 1881.2313,-5655.9813 1881.2313,-5677.9922"/>
<text text-anchor="middle" x="1817.7286" y="-5663.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge372" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.9931,-4766.1784C594.1594,-4827.327 631.2561,-5120.6616 690.4731,-5185.9867 719.2697,-5217.7536 1387.2549,-5425.6468 1445.6217,-5437.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1445.6217,-5437.9867C1479.1586,-5444.7288 1496.1689,-5432.649 1520.2075,-5456.9867 1568.0823,-5505.4573 1509.2768,-5556.6016 1556.2075,-5605.9867 1582.0752,-5633.2073 1605.1718,-5610.4119 1637.2174,-5629.9867"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge441" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2536.2405,-5051.2434C2540.3517,-5096.27 2560.4466,-5266.3592 2636.4756,-5377.9867 2661.5912,-5414.8621 2698.7141,-5398.6194 2715.427,-5439.9867"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge342" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2535.7295,-5028.5993C2541.1893,-4872.9167 2601.4701,-3165.4167 2636.4756,-2661.9867 2658.5375,-2344.7035 2702.1418,-1959.6553 2712.9561,-1866.1708"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2716.4578,-1866.358 2714.1342,-1856.0211 2709.5045,-1865.5508 2716.4578,-1866.358"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge442" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1823.6974,-4236.0664C1835.8691,-4259.0107 1863.8698,-4313.6258 1881.23,-4361.9867 1941.4434,-4529.7256 2004.1211,-4978.5335 2083.7241,-5137.9867 2207.1426,-5385.2072 2250.0276,-5458.0133 2470.1865,-5624.9867 2510.4129,-5655.4953 2849.8336,-5832.7227 2889.0989,-5800.9867"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M2160.6401,-4282.9867C2203.494,-4280.2635 2322.9647,-4253.1766 2353.8713,-4282.9867"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1819.5792,-4213.8742C1826.2825,-4176.635 1852.4012,-4054.4157 1917.23,-3979.9867 1977.2713,-3911.0543 2230.0485,-3786.8317 2321.0516,-3743.4452"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2322.8088,-3746.4853 2330.3378,-3739.0311 2319.8036,-3740.1632 2322.8088,-3746.4853"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge275" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2353.8713,-4206.9867C2367.5379,-4163.727 2413.829,-4184.53 2434.1865,-4143.9867 2505.8558,-4001.2529 2428.9412,-2861.286 2470.1865,-2706.9867 2480.4092,-2668.7435 2505.0149,-2629.3319 2520.8893,-2606.5492"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2523.939,-2608.3006 2526.893,-2598.1259 2518.2388,-2604.2377 2523.939,-2608.3006"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2160.6401,-4282.9867C2206.6894,-4280.0604 2339.9713,-4250.9855 2353.8713,-4206.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1851.5242,-4236.015C1912.7167,-4254.7893 2046.1513,-4290.2623 2160.6401,-4282.9867"/>
</g>
<!-- sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~plantutilities.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/plantutilities.f90.html" xlink:title="PlantUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2204.4248,-5964.9922 2116.8555,-5964.9922 2116.8555,-5942.9813 2204.4248,-5942.9813 2204.4248,-5964.9922"/>
<text text-anchor="middle" x="2160.6401" y="-5950.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge443" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2164.4925,-5965.0145C2196.2583,-6055.78 2415.1292,-6677.8995 2470.1865,-6745.9867 2513.8133,-6799.9383 2544.1609,-6791.4561 2600.4756,-6831.9867 2653.1395,-6869.8899 2662.0427,-6958.8684 2715.427,-6921.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2715.427,-6921.9867C2745.3342,-6900.7591 2771.2915,-6926.4832 2794.3784,-6897.9867 2948.4076,-6707.8665 2722.2807,-5979.9906 2889.0989,-5800.9867"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge298" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M2181.5858,-5942.8622C2248.1935,-5906.1629 2455.4324,-5781.481 2535.3311,-5610.9867"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge420" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M2161.9137,-5942.966C2170.1056,-5871.6573 2215.7272,-5468.1008 2237.5562,-5137.9867 2244.4892,-5033.1396 2227.8937,-4287.6226 2273.5562,-4192.9867 2284.403,-4170.5065 2306.3379,-4152.4621 2324.5472,-4140.4721"/>
<polygon fill="#ff0094" stroke="#ff0094" points="2326.5202,-4143.366 2333.1222,-4135.0796 2322.7937,-4137.4403 2326.5202,-4143.366"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2161.9274,-5942.9669C2170.2049,-5871.6638 2216.2677,-5468.1361 2237.5562,-5137.9867 2267.1454,-4679.1057 2217.3116,-4560.368 2273.5562,-4103.9867 2290.4338,-3967.0373 2332.4236,-3806.0897 2347.9646,-3749.1984"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2351.4248,-3749.8158 2350.7049,-3739.2455 2344.6759,-3747.9576 2351.4248,-3749.8158"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-6093.9922 358.7923,-6093.9922 358.7923,-6071.9813 439.3754,-6071.9813 439.3754,-6093.9922"/>
<text text-anchor="middle" x="399.0839" y="-6079.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge444" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1250.8191,-7206.9867C1910.5194,-7274.5049 2175.4281,-7306.908 2715.427,-6921.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.4876,-6083.6203C454.7979,-6086.0569 470.9378,-6091.7123 480.9653,-6103.9867 531.3608,-6165.6745 474.3646,-6752.6795 516.9653,-6819.9867 566.2655,-6897.8787 1159.1154,-7197.6012 1250.8191,-7206.9867"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M755.1332,-6537.9867C832.6895,-6576.4701 1062.7844,-6588.1659 1130.6023,-6641.9867 1156.7751,-6662.7577 1137.8703,-6690.9305 1166.6023,-6707.9867 1230.9738,-6746.1998 1260.5595,-6715.5498 1335.0359,-6707.9867 1418.6196,-6699.4989 1438.8923,-6691.1083 1520.2075,-6669.9867 1683.067,-6627.6841 1751.3132,-6662.9184 1881.23,-6555.9867 1907.0284,-6534.7526 1893.8718,-6513.879 1917.23,-6489.9867 2004.4737,-6400.748 2075.3468,-6441.0914 2160.6401,-6349.9867"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M439.3274,-6085.712C515.1648,-6089.7332 683.8344,-6093.3548 819.7932,-6057.9867 968.2359,-6019.3712 1028.8051,-6022.72 1130.6023,-5907.9867 1163.3438,-5871.0846 1130.8118,-5836.9399 1166.6023,-5802.9867 1223.0738,-5749.4143 1280.6647,-5810.6896 1335.0359,-5754.9867 1379.6115,-5709.3194 1336.3074,-5669.5258 1371.0359,-5615.9867 1417.1891,-5544.8347 1478.9067,-5571.0608 1520.2075,-5496.9867 1585.3893,-5380.0817 1530.7715,-5329.3963 1556.2075,-5197.9867 1631.3325,-4809.8705 1777.6359,-4348.6996 1810.8919,-4245.9489"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1814.2311,-4246.998 1813.9898,-4236.4059 1807.5731,-4244.8367 1814.2311,-4246.998"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff9400" stroke-dasharray="5,2" d="M755.1332,-6385.9867C1008.9203,-6365.1075 1575.0781,-6317.1023 1718.2273,-6213.9867 1745.339,-6194.4572 1729.0279,-6169.9283 1754.2273,-6147.9867 1799.7361,-6108.3614 1832.5235,-6135.6084 1881.23,-6099.9867 1939.7772,-6057.168 1914.4152,-5997.063 1982.4771,-5971.9867"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M439.2296,-6083.8356C454.5005,-6086.3052 470.6806,-6091.9271 480.9653,-6103.9867 537.1547,-6169.8732 492.2419,-6408.9986 516.9653,-6491.9867 564.0517,-6650.0396 566.7959,-6710.8916 690.4731,-6819.9867 860.1307,-6969.6409 949.0166,-6938.0473 1166.6023,-6999.9867 1624.4281,-7130.3147 1788.6509,-7145.3344 2237.5562,-6986.9867 2320.3406,-6957.7852 2530.0293,-6883.3635 2600.4756,-6830.9867 2664.2607,-6783.5625 2679.8238,-6765.0501 2715.427,-6693.9867"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge299" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M439.482,-6084.0538C454.6026,-6086.5803 470.6066,-6092.1852 480.9653,-6103.9867 568.3884,-6203.5863 461.6541,-6279.5561 516.9653,-6399.9867 564.6939,-6503.9074 610.0119,-6508.7247 690.4731,-6589.9867 1017.7356,-6920.5062 1172.0896,-7035.9867 1637.2174,-7035.9867 1637.2174,-7035.9867 1637.2174,-7035.9867 1817.7286,-7035.9867 2120.5125,-7035.9867 2242.0921,-6980.0334 2434.1865,-6745.9867 2576.0914,-6573.0907 2561.659,-6491.2668 2600.4756,-6270.9867 2657.8448,-5945.423 2613.3566,-3625.7571 2636.4756,-3295.9867 2652.8451,-3062.4914 2698.5038,-2781.8968 2711.7693,-2703.3349"/>
<polygon fill="#0020ff" stroke="#0020ff" points="2715.26,-2703.6844 2713.4841,-2693.2394 2708.3589,-2702.5121 2715.26,-2703.6844"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge343" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M755.1332,-6537.9867C782.0433,-6552.6662 793.2691,-6546.6208 819.7932,-6561.9867 837.8148,-6572.427 838.1211,-6580.9652 855.7932,-6591.9867 984.1912,-6672.0641 1018.613,-6699.4022 1166.6023,-6730.9867 1328.2114,-6765.4781 2061.8826,-6812.0331 2237.5562,-6669.9867 2484.8502,-6470.0294 2347.557,-6287.9812 2434.1865,-5981.9867 2508.7489,-5718.6161 2561.3855,-5659.903 2600.4756,-5388.9867 2643.7506,-5089.0663 2619.8876,-2964.5588 2636.4756,-2661.9867 2653.886,-2344.4143 2700.9495,-1959.5812 2712.7269,-1866.1565"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2716.2273,-1866.374 2714.0117,-1856.0135 2709.2828,-1865.4943 2716.2273,-1866.374"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2020.1035,-5470.9922 1944.8506,-5470.9922 1944.8506,-5448.9813 2020.1035,-5448.9813 2020.1035,-5470.9922"/>
<text text-anchor="middle" x="1982.4771" y="-5456.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge388" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M755.1332,-6385.9867C904.132,-6368.8467 1231.0045,-6163.705 1371.0359,-6109.9867 1436.0617,-6085.0418 1458.6315,-6094.529 1520.2075,-6061.9867 1538.1285,-6052.5157 1538.1774,-6043.2485 1556.2075,-6033.9867 1589.6096,-6016.8287 1603.1179,-6025.7131 1637.2174,-6009.9867"/>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M585.7192,-6385.9867C647.9096,-6428.4332 680.0916,-6392.1605 755.1332,-6385.9867"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge421" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M585.7192,-6385.9867C669.2719,-6443.0135 660.6613,-6501.8181 755.1332,-6537.9867"/>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M755.1332,-6537.9867C797.3158,-6554.1364 810.8259,-6528.2439 855.7932,-6523.9867 1030.8026,-6507.4182 1075.0272,-6503.9867 1250.8191,-6503.9867 1250.8191,-6503.9867 1250.8191,-6503.9867 1637.2174,-6503.9867 1643.6679,-6503.9867 2129.7219,-6145.117 2160.6401,-6094.9867"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.2783,-2484.9922 536.1602,-2484.9922 536.1602,-2462.9813 635.2783,-2462.9813 635.2783,-2484.9922"/>
<text text-anchor="middle" x="585.7192" y="-2470.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge436" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M439.4639,-6080.5491C454.9645,-6077.4089 471.2507,-6070.9521 480.9653,-6057.9867 532.6367,-5989.0247 510.367,-3041.9062 516.9653,-2955.9867 530.7317,-2776.7283 569.0834,-2562.6173 581.6645,-2495.3092"/>
<polygon fill="#ff0031" stroke="#ff0031" points="585.1689,-2495.6116 583.5795,-2485.1367 578.2898,-2494.3166 585.1689,-2495.6116"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge379" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-6385.9867C643.8002,-6424.3375 1084.7274,-6129.3286 1130.6023,-6076.9867 1158.7263,-6044.8981 1135.0323,-6016.6917 1166.6023,-5987.9867 1300.2768,-5866.4436 1380.3057,-5913.2201 1556.2075,-5871.9867 1591.7813,-5863.6478 1606.9713,-5878.4856 1637.2174,-5857.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1637.2174,-5857.9867C1712.3947,-5808.0268 1683.2488,-5747.7511 1754.2273,-5691.9867 1758.9424,-5688.2823 1764.275,-5685.0655 1769.7967,-5682.2883"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1771.5347,-5685.3431 1779.1922,-5678.021 1768.6399,-5678.9696 1771.5347,-5685.3431"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.409,-6085.6035C453.9833,-6088.3926 469.6235,-6093.7734 480.9653,-6103.9867 505.804,-6126.354 558.1114,-6367.1437 585.7192,-6385.9867"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-4498.9922 350.2841,-4498.9922 350.2841,-4476.9813 447.8836,-4476.9813 447.8836,-4498.9922"/>
<text text-anchor="middle" x="399.0839" y="-4484.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge445" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M404.9409,-4499.1762C420.8684,-4530.2793 464.8525,-4620.8294 480.9653,-4701.9867 539.667,-4997.6553 442.9666,-5765.7711 516.9653,-6057.9867 558.8063,-6223.2138 588.9666,-6263.0668 690.4731,-6399.9867 737.8956,-6463.9538 781.7368,-6454.0412 819.7932,-6523.9867 860.2435,-6598.3321 794.7295,-6652.3806 855.7932,-6710.9867 884.5254,-6738.5627 2233.8425,-6921.0202 2273.5562,-6923.9867 2344.7491,-6929.3048 2362.7987,-6924.6925 2434.1865,-6923.9867 2479.1462,-6923.5423 2490.3964,-6920.4203 2535.3311,-6921.9867"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M2160.6401,-6349.9867C2379.3156,-6114.0158 2179.4243,-5942.6236 2273.5562,-5634.9867 2314.6348,-5500.7356 2389.1132,-5495.95 2434.1865,-5362.9867 2455.6015,-5299.8141 2429.1686,-5117.5882 2470.1865,-5064.9867 2472.7123,-5061.7477 2475.7118,-5058.9281 2479.0152,-5056.4737"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2481.0742,-5059.3162 2487.7558,-5051.0938 2477.4051,-5053.3549 2481.0742,-5059.3162"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M585.7192,-5853.9867C598.2531,-5883.8268 624.9152,-5864.8014 654.4731,-5877.9867 891.7722,-5983.8418 930.1456,-6052.2634 1166.6023,-6159.9867 1254.6742,-6200.11 1277.2189,-6211.2188 1371.0359,-6234.9867 1414.008,-6245.8735 2130.8428,-6382.8081 2160.6401,-6349.9867"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M404.918,-4499.1808C420.7869,-4530.2956 464.635,-4620.8729 480.9653,-4701.9867 493.3399,-4763.452 479.8534,-5779.4514 516.9653,-5829.9867 536.1228,-5856.0735 572.1301,-5824.6123 585.7192,-5853.9867"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M755.1332,-4411.9867C1124.975,-4333.3985 1572.2189,-4262.481 1744.8649,-4235.9976"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1745.4978,-4239.4415 1754.8527,-4234.4681 1744.4381,-4232.5222 1745.4978,-4239.4415"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff9400" stroke-dasharray="5,2" d="M1073.5199,-5741.9867C1196.4524,-5794.4873 1087.3992,-5920.304 1166.6023,-6027.9867 1197.1691,-6069.5447 1321.0107,-6125.3825 1371.0359,-6137.9867 1567.418,-6187.4666 1619.9198,-6091.4133 1817.7286,-6047.9867"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M585.7192,-5853.9867C591.0684,-5865.5496 682.1976,-6048.3003 690.4731,-6057.9867 996.5504,-6416.2455 1111.8808,-6513.1226 1556.2075,-6669.9867 1842.3515,-6771.0064 1976.1728,-6868.1363 2237.5562,-6713.9867 2678.0758,-6454.1925 2649.5866,-6197.4824 2794.3784,-5706.9867 2873.6253,-5438.5307 2887.176,-4510.4507 2888.8857,-4357.4265"/>
<polygon fill="#a4ff00" stroke="#a4ff00" points="2892.3892,-4357.107 2888.9962,-4347.0702 2885.3896,-4357.0323 2892.3892,-4357.107"/>
</g>
<!-- sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~reportsizingmanager.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/reportsizingmanager.f90.html" xlink:title="ReportSizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2047.9721,-2521.9922 1916.982,-2521.9922 1916.982,-2499.9813 2047.9721,-2499.9813 2047.9721,-2521.9922"/>
<text text-anchor="middle" x="1982.4771" y="-2507.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ReportSizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#73ff00" stroke-dasharray="5,2" d="M404.8127,-4499.2027C420.4126,-4530.3734 463.6369,-4621.0802 480.9653,-4701.9867 510.612,-4840.4071 471.1705,-5204.0392 516.9653,-5337.9867 534.4137,-5389.0222 552.1607,-5395.7626 585.7192,-5437.9867"/>
<path fill="none" stroke="#73ff00" stroke-dasharray="5,2" d="M1817.7286,-5705.9867C1839.089,-5685.6995 1863.5,-5710.513 1881.23,-5686.9867 1933.2768,-5617.9246 1882.978,-2653.3923 1917.23,-2573.9867 1925.3109,-2555.2529 1941.9262,-2539.3439 1956.3667,-2528.1993"/>
<polygon fill="#73ff00" stroke="#73ff00" points="1958.5461,-2530.9414 1964.5368,-2522.2028 1954.4042,-2525.2982 1958.5461,-2530.9414"/>
<path fill="none" stroke="#73ff00" stroke-dasharray="5,2" d="M585.7192,-5437.9867C591.5015,-5445.2622 908.822,-5475.9867 918.1154,-5475.9867 918.1154,-5475.9867 918.1154,-5475.9867 1073.5199,-5475.9867 1160.0687,-5475.9867 1754.9734,-5765.5894 1817.7286,-5705.9867"/>
</g>
<!-- sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~globalnames.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/globalnames.f90.html" xlink:title="GlobalNames.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2207.264,-1193.9922 2114.0163,-1193.9922 2114.0163,-1171.9813 2207.264,-1171.9813 2207.264,-1193.9922"/>
<text text-anchor="middle" x="2160.6401" y="-1179.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GlobalNames.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#41ff00" stroke-dasharray="5,2" d="M585.7192,-4069.9867C610.0171,-4043.3673 625.4096,-4048.301 654.4731,-4026.9867 814.8257,-3909.3894 1240.5151,-3620.9378 1335.0359,-3445.9867 1395.304,-3334.4349 1293.5534,-3263.3486 1371.0359,-3162.9867 1414.7056,-3106.4221 1462.8568,-3145.6189 1520.2075,-3102.9867 1540.7629,-3087.7067 1534.5511,-3071.6615 1556.2075,-3057.9867 1618.7463,-3018.4974 1654.0923,-3056.827 1718.2273,-3019.9867 1738.4005,-3008.3989 1734.4129,-2994.178 1754.2273,-2981.9867 1804.4079,-2951.112 1845.3839,-2990.7457 1881.23,-2943.9867 1924.6466,-2887.3524 1899.5791,-1729.1307 1917.23,-1659.9867 1966.226,-1468.0543 2102.2716,-1265.1937 2146.5296,-1202.5436"/>
<polygon fill="#41ff00" stroke="#41ff00" points="2149.6466,-1204.2003 2152.5957,-1194.0242 2143.9443,-1200.1401 2149.6466,-1204.2003"/>
<path fill="none" stroke="#41ff00" stroke-dasharray="5,2" d="M403.1751,-4476.7449C415.4435,-4442.9205 452.8144,-4339.056 480.9653,-4251.9867 498.095,-4199.0055 487.1887,-4179.0377 516.9653,-4131.9867 538.9692,-4097.2177 555.2701,-4097.6618 585.7192,-4069.9867"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1495.0116,-5219.9922 1396.2318,-5219.9922 1396.2318,-5197.9813 1495.0116,-5197.9813 1495.0116,-5219.9922"/>
<text text-anchor="middle" x="1445.6217" y="-5205.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge230" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M585.7192,-5323.9867C651.8066,-5369.3314 1202.4544,-5259.7721 1386.2014,-5221.5513"/>
<polygon fill="#00ff52" stroke="#00ff52" points="1387.1487,-5224.9291 1396.2237,-5219.4616 1385.7198,-5218.0765 1387.1487,-5224.9291"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="973.2534,-2255.9922 862.9773,-2255.9922 862.9773,-2233.9813 973.2534,-2233.9813 973.2534,-2255.9922"/>
<text text-anchor="middle" x="918.1154" y="-2241.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge234" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M585.7192,-2283.9867C617.7881,-2249.6664 643.6055,-2294.8688 690.4731,-2297.9867 747.822,-2301.802 765.4286,-2316.6397 819.7932,-2297.9867 838.9659,-2291.4085 838.2155,-2280.0807 855.7932,-2269.9867 862.1875,-2266.3148 869.2265,-2262.9313 876.2013,-2259.9177"/>
<polygon fill="#00ff83" stroke="#00ff83" points="877.6918,-2263.0892 885.606,-2256.0453 875.0266,-2256.6164 877.6918,-2263.0892"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1129.3367,-1227.9922 1017.7031,-1227.9922 1017.7031,-1205.9813 1129.3367,-1205.9813 1129.3367,-1227.9922"/>
<text text-anchor="middle" x="1073.5199" y="-1213.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge247" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M585.7192,-2283.9867C634.5176,-2225.7948 628.4852,-2192.8625 690.4731,-2148.9867 739.9116,-2113.9937 781.017,-2152.5172 819.7932,-2105.9867 856.5714,-2061.8539 842.389,-1905.8497 855.7932,-1849.9867 915.0908,-1602.8606 1031.9567,-1316.0367 1064.7688,-1237.6648"/>
<polygon fill="#00ffb4" stroke="#00ffb4" points="1068.0182,-1238.9666 1068.6673,-1228.3916 1061.5653,-1236.2537 1068.0182,-1238.9666"/>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M401.5926,-4476.9046C413.2955,-4424.6291 462.7218,-4197.3184 480.9653,-4007.9867 514.0963,-3664.1533 447.0732,-2792.268 516.9653,-2453.9867 533.4559,-2374.1716 533.4654,-2346.5322 585.7192,-2283.9867"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1495.1706,-3093.9922 1396.0728,-3093.9922 1396.0728,-3071.9813 1495.1706,-3071.9813 1495.1706,-3093.9922"/>
<text text-anchor="middle" x="1445.6217" y="-3079.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge256" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00e6ff" stroke-dasharray="5,2" d="M755.1332,-3774.9867C853.6662,-3651.208 1252.6446,-3497.0483 1335.0359,-3361.9867 1393.2677,-3266.5291 1301.9518,-3200.91 1371.0359,-3112.9867 1375.6008,-3107.177 1381.4671,-3102.4872 1387.9014,-3098.7026"/>
<polygon fill="#00e6ff" stroke="#00e6ff" points="1389.6409,-3101.7444 1396.9586,-3094.0827 1386.4602,-3095.5088 1389.6409,-3101.7444"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1518.8763,-4156.9922 1372.3671,-4156.9922 1372.3671,-4134.9813 1518.8763,-4134.9813 1518.8763,-4156.9922"/>
<text text-anchor="middle" x="1445.6217" y="-4142.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge261" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M755.1332,-4411.9867C876.9543,-4368.5892 896.5011,-4332.35 1016.4375,-4283.9867 1150.0916,-4230.0919 1313.506,-4182.3356 1394.7314,-4159.7677"/>
<polygon fill="#00b4ff" stroke="#00b4ff" points="1395.9889,-4163.0514 1404.6936,-4157.0118 1394.1224,-4156.3048 1395.9889,-4163.0514"/>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M438.9961,-4476.9631C504.4269,-4459.4599 638.8694,-4425.8744 755.1332,-4411.9867"/>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1130.6848,-2255.9922 1016.355,-2255.9922 1016.355,-2233.9813 1130.6848,-2233.9813 1130.6848,-2255.9922"/>
<text text-anchor="middle" x="1073.5199" y="-2241.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge273" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M401.5466,-4476.9C413.0423,-4424.604 461.6765,-4197.2147 480.9653,-4007.9867 504.6864,-3775.278 458.9404,-3182.5903 516.9653,-2955.9867 559.4421,-2790.1031 587.219,-2748.5893 690.4731,-2611.9867 705.5196,-2592.0806 834.5925,-2473.1466 855.7932,-2459.9867 881.0115,-2444.3331 894.1181,-2453.4546 918.1154,-2435.9867"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge301" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M755.1332,-5171.9867C912.6195,-5100.9647 1389.2972,-5197.2546 1520.2075,-5309.9867 1557.909,-5342.453 1515.763,-5387.0092 1556.2075,-5415.9867 1717.1363,-5531.2883 2251.3309,-5340.8571 2434.1865,-5264.9867 2513.2149,-5232.1963 2557.1493,-5241.7671 2600.4756,-5167.9867 2653.1487,-5078.2898 2628.8312,-3399.7247 2636.4756,-3295.9867 2653.6772,-3062.5512 2698.7522,-2781.9147 2711.8249,-2703.3389"/>
<polygon fill="#0020ff" stroke="#0020ff" points="2715.3161,-2703.6821 2713.5143,-2693.2416 2708.412,-2702.5269 2715.3161,-2703.6821"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge330" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M447.9038,-4483.3702C460.5907,-4479.7226 472.9342,-4473.4983 480.9653,-4462.9867 560.9384,-4358.3138 465.8994,-3399.4132 516.9653,-3277.9867 551.1464,-3196.7097 603.8106,-3207.1505 654.4731,-3134.9867 697.8247,-3073.2368 732.5303,-2990.0439 747.3522,-2951.7991"/>
<polygon fill="#1000ff" stroke="#1000ff" points="750.6974,-2952.8498 750.9961,-2942.2592 744.1582,-2950.352 750.6974,-2952.8498"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge345" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M404.3554,-4499.3136C418.7867,-4530.7677 459.301,-4622.1319 480.9653,-4701.9867 517.6659,-4837.2655 470.8334,-5243.6841 585.7192,-5323.9867"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M585.7192,-5323.9867C648.8323,-5368.1014 625.5356,-5227.3687 690.4731,-5185.9867 715.2699,-5170.1848 729.5357,-5186.4555 755.1332,-5171.9867"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M755.1332,-5171.9867C862.9285,-5111.0563 1150.5155,-5111.8127 1166.6023,-5110.9867 1642.1067,-5086.573 1763.7007,-5184.4788 2237.5562,-5137.9867 2241.7522,-5137.5751 2531.6492,-5081.041 2535.3311,-5078.9867"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge389" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M755.1332,-5551.9867C976.5303,-5690.7995 1077.3456,-5605.612 1335.0359,-5648.9867 1521.3754,-5680.3517 1565.9311,-5704.1533 1754.2273,-5719.9867 1810.4744,-5724.7165 1838.5032,-5756.8721 1881.23,-5719.9867 1964.2062,-5648.3547 1843.4451,-5557.0545 1917.23,-5475.9867 1921.9771,-5470.771 1928.122,-5467.1266 1934.7395,-5464.6021"/>
<polygon fill="#7300ff" stroke="#7300ff" points="1936.0766,-5467.8561 1944.6652,-5461.6523 1934.0825,-5461.1461 1936.0766,-5467.8561"/>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M585.7192,-5437.9867C642.1866,-5509.0353 679.7661,-5501.4272 755.1332,-5551.9867"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1696.553,-3435.9922 1577.8818,-3435.9922 1577.8818,-3413.9813 1696.553,-3413.9813 1696.553,-3435.9922"/>
<text text-anchor="middle" x="1637.2174" y="-3421.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge403" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M755.1332,-4069.9867C801.7927,-4055.607 809.731,-4042.1782 855.7932,-4025.9867 990.7893,-3978.5339 1027.6548,-3976.1818 1166.6023,-3941.9867 1170.4571,-3941.0381 1444.3697,-3883.7539 1445.6217,-3879.9867"/>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M585.7192,-4069.9867C636.4806,-4014.3753 680.5938,-4080.6274 755.1332,-4069.9867"/>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M1445.6217,-3879.9867C1445.6217,-3879.9867 1556.2075,-3449.9867 1556.2075,-3449.9867 1559.8592,-3446.1568 1564.0831,-3442.9095 1568.6463,-3440.1568"/>
<polygon fill="#ff00c5" stroke="#ff00c5" points="1570.4937,-3443.1422 1577.7788,-3435.4495 1567.2865,-3436.9201 1570.4937,-3443.1422"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge422" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M404.8493,-4499.1949C420.5428,-4530.3458 463.9842,-4621.0066 480.9653,-4701.9867 515.21,-4865.2935 448.7443,-5299.7117 516.9653,-5451.9867 682.4216,-5821.299 847.1036,-5841.6161 1166.6023,-6089.9867 1250.5007,-6155.2073 1268.6933,-6185.3746 1371.0359,-6213.9867 1563.5256,-6267.8016 1617.8865,-6165.3684 1817.7286,-6161.9867"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1495.749,-3929.9922 1395.4944,-3929.9922 1395.4944,-3907.9813 1495.749,-3907.9813 1495.749,-3929.9922"/>
<text text-anchor="middle" x="1445.6217" y="-3915.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge429" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0062" stroke-dasharray="5,2" d="M755.1332,-4069.9867C1007.6193,-4001.7726 1085.29,-4047.6359 1335.0359,-3969.9867 1363.8777,-3961.0195 1394.9674,-3946.1784 1416.8144,-3934.8117"/>
<polygon fill="#ff0062" stroke="#ff0062" points="1418.6647,-3937.7926 1425.8689,-3930.0241 1415.3926,-3931.6044 1418.6647,-3937.7926"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge439" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M401.5648,-4476.9019C413.1424,-4424.6141 462.0895,-4197.2564 480.9653,-4007.9867 534.1802,-3474.395 453.7119,-3334.4818 516.9653,-2801.9867 530.9332,-2684.3994 566.1474,-2546.4679 579.9974,-2494.8606"/>
<polygon fill="#ff0031" stroke="#ff0031" points="583.3788,-2495.764 582.6132,-2485.1968 576.6219,-2493.935 583.3788,-2495.764"/>
</g>
<!-- sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~emsmanager.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/emsmanager.f90.html" xlink:title="EMSManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2400.5055,-1570.9922 2307.2372,-1570.9922 2307.2372,-1548.9813 2400.5055,-1548.9813 2400.5055,-1570.9922"/>
<text text-anchor="middle" x="2353.8713" y="-1556.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EMSManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-5057.9867C798.9419,-5052.9472 2212.2886,-4526.1274 2237.5562,-4489.9867 2274.7414,-4436.8 2268.6998,-2218.7014 2273.5562,-2153.9867 2290.479,-1928.4781 2336.5455,-1657.7959 2350.0824,-1581.1335"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2353.5335,-1581.717 2351.8363,-1571.259 2346.6414,-1580.4928 2353.5335,-1581.717"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M403.2309,-4499.0647C420.5935,-4545.2811 487.8893,-4722.7418 516.9653,-4774.9867 596.9085,-4918.6317 591.3565,-5072.1984 755.1332,-5057.9867"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3385.9867C696.6288,-3242.9826 854.2836,-3415.7416 980.4375,-3285.9867 1031.5498,-3233.4155 984.7521,-3191.1096 1016.4375,-3124.9867 1051.5812,-3051.6467 1082.2533,-3047.3796 1130.6023,-2981.9867 1313.0325,-2735.2467 1409.3451,-2698.1178 1520.2075,-2411.9867 1561.718,-2304.8501 1537.8696,-2269.4112 1556.2075,-2155.9867 1582.5175,-1993.2538 1620.4398,-1798.0814 1633.0003,-1734.2873"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1636.4782,-1734.7412 1634.9805,-1724.2527 1629.6106,-1733.3859 1636.4782,-1734.7412"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1499.3474,-1723.9922 1391.896,-1723.9922 1391.896,-1701.9813 1499.3474,-1701.9813 1499.3474,-1723.9922"/>
<text text-anchor="middle" x="1445.6217" y="-1709.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M404.3042,-4476.5096C419.3333,-4442.865 462.7867,-4341.2273 480.9653,-4251.9867 519.6581,-4062.0404 463.4895,-3536.4415 585.7192,-3385.9867"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M585.7192,-3385.9867C736.5719,-3200.2996 849.6905,-3220.3401 980.4375,-3019.9867 1007.1689,-2979.0242 994.1301,-2959.5169 1016.4375,-2915.9867 1056.6087,-2837.5979 1084.0668,-2828.773 1130.6023,-2753.9867 1148.2551,-2725.6173 1148.9213,-2716.3386 1166.6023,-2687.9867 1235.1749,-2578.0292 1292.4781,-2572.3865 1335.0359,-2449.9867 1384.2945,-2308.3147 1304.2615,-1910.2945 1371.0359,-1775.9867 1380.7773,-1756.3933 1399.6605,-1740.5404 1415.9885,-1729.638"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1418.1526,-1732.41 1424.7224,-1724.0981 1414.4032,-1726.4989 1418.1526,-1732.41"/>
</g>
<!-- sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~outairnodemanager.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/outairnodemanager.f90.html" xlink:title="OutAirNodeManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1880.4679,-2749.9922 1754.9894,-2749.9922 1754.9894,-2727.9813 1880.4679,-2727.9813 1880.4679,-2749.9922"/>
<text text-anchor="middle" x="1817.7286" y="-2735.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutAirNodeManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M403.6219,-4476.876C417.1381,-4443.4174 457.6349,-4340.4696 480.9653,-4251.9867 503.5465,-4166.3454 467.1921,-4129.2464 516.9653,-4055.9867 557.4741,-3996.3632 609.5657,-4026.3716 654.4731,-3969.9867 684.9459,-3931.7258 668.0812,-3909.4735 690.4731,-3865.9867 713.1862,-3821.8763 725.8862,-3815.0645 755.1332,-3774.9867"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M755.1332,-3774.9867C833.1079,-3663.5445 778.3651,-3597.8095 855.7932,-3485.9867 946.2988,-3355.2772 1042.8213,-3389.5414 1130.6023,-3256.9867 1161.111,-3210.9167 1133.1519,-3181.9675 1166.6023,-3137.9867 1210.509,-3080.2582 1660.9511,-2833.482 1718.2273,-2788.9867 1735.607,-2775.4852 1734.9329,-2765.5732 1754.2273,-2754.9867 1754.6509,-2754.7543 1755.078,-2754.5252 1755.5082,-2754.2993"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1757.2764,-2757.3405 1764.9356,-2750.0201 1754.3831,-2750.9664 1757.2764,-2757.3405"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="654.2279,-1505.9922 517.2105,-1505.9922 517.2105,-1483.9813 654.2279,-1483.9813 654.2279,-1505.9922"/>
<text text-anchor="middle" x="585.7192" y="-1491.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M401.6183,-4476.907C413.4373,-4424.6425 463.3072,-4197.3738 480.9653,-4007.9867 568.45,-3069.6983 427.4947,-2826.0879 516.9653,-1887.9867 530.6499,-1744.5042 567.5146,-1574.6173 580.834,-1516.0533"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="584.2803,-1516.6834 583.1034,-1506.1541 577.4573,-1515.1192 584.2803,-1516.6834"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node47" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node47"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1319.2168,-2369.9922 1182.4213,-2369.9922 1182.4213,-2347.9813 1319.2168,-2347.9813 1319.2168,-2369.9922"/>
<text text-anchor="middle" x="1250.8191" y="-2355.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M918.1154,-2701.9867C944.6041,-2676.236 953.3364,-2672.0922 980.4375,-2646.9867 996.8081,-2631.8216 1000.0012,-2627.0806 1016.4375,-2611.9867 1065.9044,-2566.5603 1091.7676,-2567.781 1130.6023,-2512.9867 1155.7523,-2477.5011 1140.1895,-2456.5427 1166.6023,-2421.9867 1181.238,-2402.8388 1203.1696,-2386.6882 1220.9828,-2375.5344"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1223.1143,-2378.3358 1229.8621,-2370.1677 1219.4934,-2372.345 1223.1143,-2378.3358"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M401.5174,-4476.897C412.8818,-4424.5873 461.0137,-4197.146 480.9653,-4007.9867 491.1487,-3911.4399 480.0611,-3224.7814 516.9653,-3134.9867 551.4694,-3051.0322 603.3407,-3058.9825 654.4731,-2983.9867 674.8517,-2954.0977 669.9887,-2940.8033 690.4731,-2910.9867 738.4384,-2841.17 767.6807,-2837.765 819.7932,-2770.9867 837.767,-2747.9547 831.7819,-2732.6297 855.7932,-2715.9867 879.1254,-2699.8144 898.7413,-2722.7372 918.1154,-2701.9867"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1073.5199,-5741.9867C1118.2254,-5762.578 1119.3858,-5695.8858 1166.6023,-5681.9867 1238.4149,-5660.8474 1260.253,-5678.6041 1335.0359,-5681.9867 1578.1271,-5692.9824 1698.5208,-5880.7087 1881.23,-5719.9867 1928.3335,-5678.5517 1904.9795,-5501.5134 1917.23,-5439.9867 1972.3592,-5163.1071 1875.7807,-5017.9347 2083.7241,-4826.9867 2109.3173,-4803.4854 2151.6729,-4846.5563 2160.6401,-4812.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-5551.9867C802.5898,-5583.8228 807.6719,-5601.1646 855.7932,-5631.9867 947.0879,-5690.4619 975.5927,-5695.4645 1073.5199,-5741.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2160.6401,-4812.9867C2176.912,-4752.1503 2217.9034,-4753.8166 2237.5562,-4693.9867 2278.5485,-4569.1919 2255.787,-4234.1343 2273.5562,-4103.9867 2292.2222,-3967.2696 2333.1122,-3806.1791 2348.1635,-3749.2242"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2351.6257,-3749.8235 2350.815,-3739.2598 2344.8611,-3748.0234 2351.6257,-3749.8235"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-2283.9867C657.7034,-2197.825 746.5102,-2274.0464 819.7932,-2188.9867 864.2611,-2137.3729 816.127,-2095.376 855.7932,-2039.9867 922.4982,-1946.8409 1002.5162,-1991.8988 1073.5199,-1901.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1073.5199,-1901.9867C1142.7753,-1809.8816 1115.5272,-1763.2873 1166.6023,-1659.9867 1188.1872,-1616.3308 1219.4572,-1568.5611 1237.1924,-1542.5524"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1240.0827,-1544.5262 1242.863,-1534.3027 1234.3141,-1540.561 1240.0827,-1544.5262"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge278" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-5057.9867C851.8934,-5085.8848 880.9764,-5049.7452 980.4375,-5033.9867 1563.3795,-4941.6263 1888.7343,-5082.0909 2237.5562,-4605.9867 2326.5799,-4484.4789 2200.0345,-4400.4552 2273.5562,-4268.9867 2295.5664,-4229.6289 2339.6684,-4249.7858 2353.8713,-4206.9867"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge339" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.1193,-4484.1328C642.7232,-4469.5347 1379.3211,-4420.8897 1982.4771,-4469.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1982.4771,-4469.9867C2020.3165,-4470.446 2062.6799,-4470.4663 2096.6009,-4470.3623"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2096.8551,-4473.8616 2106.8427,-4470.3264 2096.8305,-4466.8616 2096.8551,-4473.8616"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge380" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5323.9867C902.9776,-5543.0185 1067.6609,-5362.0037 1445.6217,-5437.9867"/>
</g>
<!-- sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~datazonecontrols.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/datazonecontrols.f90.html" xlink:title="DataZoneControls.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2217.8641,-735.9922 2103.4162,-735.9922 2103.4162,-713.9813 2217.8641,-713.9813 2217.8641,-735.9922"/>
<text text-anchor="middle" x="2160.6401" y="-721.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneControls.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge446" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2164.2157,-713.8973C2174.8925,-682.8871 2209.8203,-595.3696 2273.5562,-561.9867 2376.7667,-507.9283 2429.6388,-526.9573 2535.3311,-575.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2715.427,-689.9867C2741.0137,-716.2617 2770.229,-686.3849 2794.3784,-713.9867 2880.3723,-812.2744 2763.6606,-1257.6462 2889.0989,-1293.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2535.3311,-575.9867C2625.151,-606.0916 2649.3369,-622.119 2715.427,-689.9867"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2163.9513,-736.0072C2175.2349,-773.7962 2212.851,-901.7135 2237.5562,-1008.9867 2256.7469,-1092.3157 2256.2935,-1114.2371 2273.5562,-1197.9867 2300.3045,-1327.7564 2335.9575,-1482.8544 2348.9067,-1538.6713"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2345.5768,-1539.8049 2351.2494,-1548.7532 2352.3951,-1538.2205 2345.5768,-1539.8049"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge277" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2162.5792,-736.1415C2170.7991,-781.6164 2205.5119,-956.6306 2273.5562,-1083.9867 2300.4188,-1134.2648 2334.5822,-1130.3452 2353.8713,-1183.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2353.8713,-1183.9867C2382.966,-1264.8965 2414.5816,-1276.2697 2434.1865,-1359.9867 2491.2694,-1603.7422 2395.6281,-2246.9968 2470.1865,-2485.9867 2480.0925,-2517.7395 2502.9215,-2549.1104 2518.7382,-2568.2629"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2516.0978,-2570.5608 2525.2347,-2575.9245 2521.4369,-2566.0337 2516.0978,-2570.5608"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge447" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2948.2599,-4335.9867C2956.444,-4335.9867 2964.9981,-4335.9867 2973.5894,-4335.9867"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2973.6719,-4339.4868 2983.6719,-4335.9867 2973.6719,-4332.4868 2973.6719,-4339.4868"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge448" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1983.6739,-2499.8017C1988.7594,-2456.5262 2011.726,-2297.2605 2083.7241,-2191.9867 2133.2978,-2119.5015 2177.6035,-2132.1533 2237.5562,-2067.9867 2341.6202,-1956.6084 2377.7297,-1928.5745 2434.1865,-1786.9867 2474.2987,-1686.3895 2429.0911,-1646.1863 2470.1865,-1545.9867 2493.9828,-1487.9662 2581.982,-1349.0204 2636.4756,-1317.9867 2734.4799,-1262.1741 2780.7708,-1262.6032 2889.0989,-1293.9867"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1996.5673,-2522.1313C2010.7852,-2533.8998 2032.7249,-2553.5486 2047.7241,-2573.9867 2061.6864,-2593.0119 2227.607,-2932.5878 2237.5562,-2953.9867 2330.6049,-3154.1191 2382.8946,-3195.3239 2434.1865,-3409.9867 2512.1255,-3736.1706 2532.3905,-4851.4101 2535.0183,-5018.8682"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2531.519,-5018.944 2535.172,-5028.8891 2538.5181,-5018.8366 2531.519,-5018.944"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M2160.6401,-2435.9867C2344.4814,-2336.0323 2422.8188,-2157.4129 2600.4756,-2267.9867 2766.1713,-2371.116 2744.7835,-2473.2248 2794.3784,-2661.9867 2881.962,-2995.3362 2888.5612,-4144.3893 2889.0584,-4314.7946"/>
<polygon fill="#a4ff00" stroke="#a4ff00" points="2885.5587,-4314.9779 2889.0839,-4324.969 2892.5587,-4314.9602 2885.5587,-4314.9779"/>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M2003.4599,-2499.8791C2023.6968,-2489.3955 2055.3483,-2473.5962 2083.7241,-2461.9867 2117.1221,-2448.3225 2127.4328,-2450.108 2160.6401,-2435.9867"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge302" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M2160.6401,-2435.9867C2312.5779,-2365.9659 2395.682,-2379.8665 2535.3311,-2471.9867"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge346" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1991.3766,-2499.7188C2032.164,-2448.327 2202.2876,-2236.7435 2273.5562,-2191.9867 2305.1059,-2172.1734 2316.6161,-2167.9867 2353.8713,-2167.9867"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge413" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1999.8191,-2522.1225C2015.3928,-2533.1961 2037.3528,-2551.7195 2047.7241,-2573.9867 2096.8174,-2679.39 2059.8323,-2982.1923 2083.7241,-3095.9867 2125.2581,-3293.8095 2187.1167,-3328.2451 2237.5562,-3523.9867 2262.7172,-3621.6301 2255.0185,-3648.8723 2273.5562,-3747.9867 2298.9816,-3883.9279 2335.8593,-4046.1109 2348.9981,-4103.0167"/>
<polygon fill="#ff0094" stroke="#ff0094" points="2345.6336,-4104.0022 2351.2989,-4112.9552 2352.4532,-4102.4234 2345.6336,-4104.0022"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge449" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2168.4082,-1171.6422C2183.5269,-1149.1387 2217.2043,-1096.8804 2237.5562,-1048.9867 2259.9997,-996.1708 2229.4728,-961.7277 2273.5562,-924.9867 2385.3794,-831.7884 2481.1114,-821.6646 2600.4756,-904.9867 2721.9937,-989.8124 2594.9841,-1131.6412 2715.427,-1217.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2715.427,-1217.9867C2745.1471,-1237.6516 2761.2512,-1218.8499 2794.3784,-1231.9867 2841.1496,-1250.5342 2840.7716,-1279.9859 2889.0989,-1293.9867"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M2715.427,-1331.9867C2834.2563,-1519.3915 2772.6114,-1604.1539 2794.3784,-1824.9867 2845.7997,-2346.6717 2884.1525,-4101.8341 2888.6555,-4314.7733"/>
<polygon fill="#a4ff00" stroke="#a4ff00" points="2885.1598,-4315.0192 2888.8696,-4324.9433 2892.1583,-4314.8718 2885.1598,-4315.0192"/>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M2168.7143,-1171.8979C2215.152,-1109.3696 2451.3418,-808.3257 2600.4756,-941.9867 2655.0805,-990.9264 2600.8583,-1205.8915 2636.4756,-1269.9867 2658.1471,-1308.9858 2691.5351,-1294.307 2715.427,-1331.9867"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge303" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M2187.4188,-1194.0776C2237.7489,-1215.4581 2349.0509,-1265.3044 2434.1865,-1321.9867 2458.7445,-1338.3372 2523.5534,-1380.9365 2535.3311,-1407.9867"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge347" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2207.3784,-1175.8457C2296.1642,-1163.3496 2484.8639,-1142.2436 2535.3311,-1179.9867"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2535.3311,-1179.9867C2567.8902,-1203.1707 2581.3394,-1206.8955 2600.4756,-1241.9867 2657.5959,-1346.7317 2702.7309,-1729.5094 2713.1523,-1823.8605"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2709.6836,-1824.3384 2714.2495,-1833.8989 2716.6421,-1823.5777 2709.6836,-1824.3384"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge407" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M2161.4722,-1194.0161C2168.2555,-1284.3325 2214.7977,-1911.7157 2237.5562,-2421.9867 2263.8244,-3010.9517 2203.6868,-3162.5911 2273.5562,-3747.9867 2289.9092,-3884.9998 2332.2216,-4045.9083 2347.9063,-4102.7822"/>
<polygon fill="#ff0094" stroke="#ff0094" points="2344.6218,-4104.0349 2350.6726,-4112.7319 2351.366,-4102.1598 2344.6218,-4104.0349"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1300.972,-6018.9922 1200.6661,-6018.9922 1200.6661,-5996.9813 1300.972,-5996.9813 1300.972,-6018.9922"/>
<text text-anchor="middle" x="1250.8191" y="-6004.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge450" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1253.0659,-6019.1021C1261.7931,-6060.031 1296.7066,-6204.7428 1371.0359,-6296.9867 1739.5363,-6754.3023 1948.1908,-6907.9736 2535.3311,-6921.9867"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1445.6217,-6123.9867C1785.2719,-6217.455 2018.9046,-6433.1934 2237.5562,-6156.9867 2278.8717,-6104.7958 2259.0641,-5623.9548 2273.5562,-5558.9867 2279.9871,-5530.1567 2449.1707,-5085.744 2470.1865,-5064.9867 2473.7175,-5061.4992 2477.7868,-5058.4876 2482.1316,-5055.889"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2484.0816,-5058.8207 2491.3527,-5051.1148 2480.8631,-5052.6045 2484.0816,-5058.8207"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M1260.3324,-5996.9132C1276.1124,-5978.4711 1308.5838,-5940.2067 1335.0359,-5906.9867 1436.2279,-5779.9045 1455.918,-5743.7823 1556.2075,-5615.9867 1626.8312,-5525.9934 1675.7204,-5522.1925 1718.2273,-5415.9867 1755.1744,-5323.6725 1746.0049,-5069.0797 1754.2273,-4969.9867 1777.9822,-4683.7029 1808.1203,-4335.6545 1815.8541,-4246.5602"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1819.3612,-4246.6294 1816.7396,-4236.364 1812.3874,-4246.0237 1819.3612,-4246.6294"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff9400" stroke-dasharray="5,2" d="M1637.2174,-6047.9867C1717.3954,-6050.7964 1739.3676,-6065.19 1817.7286,-6047.9867"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M2353.8713,-6655.9867C2395.3839,-6638.3744 2407.8636,-6630.6008 2434.1865,-6593.9867 2462.7386,-6554.2719 2452.2906,-6535.5085 2470.1865,-6489.9867 2522.6267,-6356.5953 2564.1213,-6333.6288 2600.4756,-6194.9867 2642.3826,-6035.1688 2584.8143,-5981.9233 2636.4756,-5824.9867 2679.225,-5695.1226 2752.9182,-5691.2682 2794.3784,-5560.9867 2869.8759,-5323.7488 2886.4455,-4500.6457 2888.7804,-4357.3439"/>
<polygon fill="#a4ff00" stroke="#a4ff00" points="2892.2818,-4357.2762 2888.9397,-4347.2224 2885.2827,-4357.166 2892.2818,-4357.2762"/>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M1255.7062,-6019.0548C1270.2449,-6051.268 1315.6741,-6146.9293 1371.0359,-6213.9867 1440.6527,-6298.3107 1461.7601,-6320.8803 1556.2075,-6375.9867 1637.3387,-6423.3237 2265.1937,-6686.9598 2353.8713,-6655.9867"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge223" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M1254.7846,-5996.9802C1268.2323,-5959.2191 1312.5152,-5831.234 1335.0359,-5721.9867 1361.9707,-5591.3267 1341.0025,-5553.9695 1371.0359,-5423.9867 1387.9463,-5350.7991 1420.8779,-5267.7339 1436.7064,-5229.8307"/>
<polygon fill="#00ff52" stroke="#00ff52" points="1440.0296,-5230.9576 1440.6897,-5220.3833 1433.5795,-5228.2379 1440.0296,-5230.9576"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge257" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M1255.1006,-5996.7586C1269.3615,-5958.8031 1315.4514,-5831.5354 1335.0359,-5721.9867 1376.8195,-5488.2637 1354.5681,-5425.8436 1371.0359,-5188.9867 1399.6156,-4777.9232 1436.1496,-4275.8577 1444.0654,-4167.3106"/>
<polygon fill="#00b4ff" stroke="#00b4ff" points="1447.578,-4167.2641 1444.8149,-4157.0359 1440.5965,-4166.7547 1447.578,-4167.2641"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge304" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M1445.6217,-6199.9867C1501.9232,-6249.8078 1494.6884,-6284.7734 1556.2075,-6327.9867 1633.3465,-6382.1722 1661.5372,-6386.8103 1754.2273,-6403.9867 1859.8366,-6423.5572 2147.2566,-6460.1445 2237.5562,-6401.9867 2557.9932,-6195.6082 2514.9899,-5996.4221 2600.4756,-5624.9867 2658.5228,-5372.7716 2617.9427,-3554.131 2636.4756,-3295.9867 2653.2369,-3062.5192 2698.6208,-2781.9051 2711.7955,-2703.3368"/>
<polygon fill="#0020ff" stroke="#0020ff" points="2715.2864,-2703.6833 2713.4984,-2693.2405 2708.3839,-2702.5191 2715.2864,-2703.6833"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge348" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1260.3309,-6019.2295C1280.076,-6042.3466 1327.3218,-6096.5222 1371.0359,-6137.9867 1402.311,-6167.6524 1412.6846,-6172.1779 1445.6217,-6199.9867"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1445.6217,-6199.9867C1514.2821,-6257.9567 2166.6368,-6419.1702 2237.5562,-6363.9867 2288.9407,-6324.0037 2255.9061,-6284.6564 2273.5562,-6221.9867 2281.8661,-6192.4808 2595.6657,-5198.2608 2600.4756,-5167.9867 2644.1713,-4892.9631 2621.0698,-2940.0334 2636.4756,-2661.9867 2654.0708,-2344.4245 2700.9969,-1959.5838 2712.736,-1866.157"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2716.2364,-1866.3734 2714.0166,-1856.0137 2709.2916,-1865.4966 2716.2364,-1866.3734"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge383" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M1287.7321,-6019.0332C1326.5933,-6029.8404 1389.7655,-6045.0886 1445.6217,-6047.9867"/>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M1637.2174,-6009.9867C1754.9148,-5946.5245 1814.2834,-5949.7377 1881.23,-5833.9867 1959.3,-5699.0033 1822.3848,-5608.7601 1917.23,-5484.9867 1921.8968,-5478.8966 1928.2405,-5474.2897 1935.1475,-5470.8049"/>
<polygon fill="#7300ff" stroke="#7300ff" points="1936.9662,-5473.8358 1944.8108,-5466.7146 1934.2375,-5467.3895 1936.9662,-5473.8358"/>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M1445.6217,-6047.9867C1488.9696,-6050.2358 1597.8012,-6028.1652 1637.2174,-6009.9867"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge394" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M1255.3021,-5996.7921C1270.2,-5958.9427 1318.0692,-5831.9713 1335.0359,-5721.9867 1350.4798,-5621.8734 1308.0876,-3978.3511 1371.0359,-3898.9867 1392.2934,-3872.1856 1434.8335,-3912.449 1445.6217,-3879.9867"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge409" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M2160.6401,-6094.9867C2182.9339,-6063.0487 2217.3584,-6086.2899 2237.5562,-6052.9867 2291.1512,-5964.6162 2229.5161,-4286.4867 2273.5562,-4192.9867 2284.1921,-4170.4059 2306.1397,-4152.3676 2324.4076,-4140.4056"/>
<polygon fill="#ff0094" stroke="#ff0094" points="2326.3881,-4143.2952 2333.0142,-4135.0281 2322.6789,-4137.3587 2326.3881,-4143.2952"/>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1817.7286,-6161.9867C1856.0315,-6155.661 2138.4194,-6126.8202 2160.6401,-6094.9867"/>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1637.2174,-6047.9867C1674.7456,-6049.3018 1685.4852,-6053.6007 1718.2273,-6071.9867 1770.22,-6101.1829 1758.1078,-6162.9956 1817.7286,-6161.9867"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1445.6217,-5971.9867C1569.6418,-5936.2993 1610.4215,-5942.9268 1718.2273,-5871.9867 1737.6616,-5859.1983 1737.5572,-5850.2146 1754.2273,-5833.9867 1808.5773,-5781.0784 1845.9631,-5787.1393 1881.23,-5719.9867 1939.5674,-5608.9049 1893.4112,-5563.1739 1917.23,-5439.9867 1973.1075,-5150.9971 1965.3268,-5068.4666 2083.7241,-4798.9867 2134.3867,-4683.6755 2201.0121,-4681.5185 2237.5562,-4560.9867 2276.3597,-4433.0027 2263.5785,-2287.3512 2273.5562,-2153.9867 2290.4278,-1928.4742 2336.53,-1657.7948 2350.0789,-1581.1333"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2353.5299,-1581.7171 2351.8344,-1571.2588 2346.638,-1580.4918 2353.5299,-1581.7171"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1254.6131,-5996.6219C1274.0352,-5938.4969 1361.7798,-5676.5766 1371.0359,-5660.9867 1421.3382,-5576.2639 1478.0016,-5586.0201 1520.2075,-5496.9867 1584.4418,-5361.4846 1705.0377,-4311.3618 1718.2273,-4161.9867 1742.5916,-3886.0559 1702.8178,-3188.1788 1754.2273,-2915.9867 1765.3259,-2857.2244 1793.0534,-2791.9334 1807.9305,-2759.542"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1811.2179,-2760.7737 1812.2718,-2750.2314 1804.8737,-2757.8155 1811.2179,-2760.7737"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1637.2174,-6047.9867C1762.3944,-6052.3733 1818.9007,-6015.631 1881.23,-5906.9867 1923.8801,-5832.6446 1863.8068,-5590.0072 1917.23,-5522.9867 1955.293,-5475.2359 2009.6495,-5527.7283 2047.7241,-5479.9867 2100.8877,-5413.3252 2058.1093,-5179.3133 2083.7241,-5097.9867 2125.3304,-4965.8875 2198.88,-4959.9734 2237.5562,-4826.9867 2282.4791,-4672.5209 2252.6871,-4263.493 2273.5562,-4103.9867 2291.457,-3967.1673 2332.8175,-3806.1397 2348.0784,-3749.2128"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2351.5397,-3749.8202 2350.7679,-3739.2535 2344.7818,-3747.9951 2351.5397,-3749.8202"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1445.6217,-6047.9867C1530.661,-6052.399 1552.1081,-6045.2392 1637.2174,-6047.9867"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge279" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1300.2262,-6019.0682C1311.9975,-6022.6712 1324.262,-6027.2601 1335.0359,-6032.9867 1363.138,-6047.924 1415.253,-6114.4688 1445.6217,-6123.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1445.6217,-6123.9867C1562.0284,-6160.4699 1602.1259,-6118.5433 1718.2273,-6155.9867 1735.6471,-6161.6047 1736.5091,-6171.3955 1754.2273,-6175.9867 1808.8683,-6190.1456 1824.9172,-6179.858 1881.23,-6175.9867 1955.7542,-6170.8636 1974.2648,-6166.5453 2047.7241,-6152.9867 2132.892,-6137.2671 2182.4274,-6175.7812 2237.5562,-6108.9867 2306.4207,-6025.55 2206.1115,-5220.5754 2273.5562,-5135.9867 2319.6299,-5078.2013 2388.7481,-5151.2731 2434.1865,-5092.9867 2474.9402,-5040.7098 2453.3881,-2771.1082 2470.1865,-2706.9867 2480.2186,-2668.6931 2504.8824,-2629.2968 2520.8202,-2606.5309"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2523.8712,-2608.282 2526.8498,-2598.1144 2518.1808,-2604.2053 2523.8712,-2608.282"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge370" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1445.6217,-5971.9867C1540.8448,-5944.5858 1555.1934,-5913.5774 1637.2174,-5857.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1301.0821,-6001.4498C1340.7918,-5995.629 1397.3667,-5985.8724 1445.6217,-5971.9867"/>
</g>
<!-- sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~dataairsystems.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/dataairsystems.f90.html" xlink:title="DataAirSystems.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2212.9228,-1039.9922 2108.3574,-1039.9922 2108.3574,-1017.9813 2212.9228,-1017.9813 2212.9228,-1039.9922"/>
<text text-anchor="middle" x="2160.6401" y="-1025.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirSystems.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge451" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2212.9496,-1020.0639C2222.1718,-1016.4004 2230.9267,-1011.2431 2237.5562,-1003.9867 2286.1346,-950.8144 2232.7823,-905.3555 2273.5562,-845.9867 2350.2311,-734.3441 2400.615,-703.941 2535.3311,-689.9867"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M2213.0324,-1018.4716C2221.9249,-1014.9495 2230.538,-1010.2515 2237.5562,-1003.9867 2266.3411,-978.292 2242.2042,-947.4778 2273.5562,-924.9867 2391.8377,-840.1348 2492.0568,-807.8489 2600.4756,-904.9867 2654.9241,-953.7699 2595.7499,-1171.2754 2636.4756,-1231.9867 2680.9933,-1298.351 2752.4915,-1249.9315 2794.3784,-1317.9867 2877.8448,-1453.5978 2888.2008,-4051.2896 2889.0367,-4314.5184"/>
<polygon fill="#a4ff00" stroke="#a4ff00" points="2885.5372,-4314.7054 2889.0679,-4324.6945 2892.5371,-4314.6838 2885.5372,-4314.7054"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge305" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M2212.9418,-1036.3916C2267.3211,-1044.659 2345.6811,-1058.4001 2353.8713,-1069.9867"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge349" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2197.6912,-1017.9286C2288.4787,-991.3564 2516.0635,-928.116 2535.3311,-955.9867"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2180.4309,-1040.1097C2198.0728,-1051.0507 2223.2524,-1069.3767 2237.5562,-1091.9867 2262.3196,-1131.1304 2331.1892,-1452.3245 2349.4044,-1538.6795"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2346.0157,-1539.5728 2351.4997,-1548.6379 2352.8657,-1538.1315 2346.0157,-1539.5728"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge280" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2207.9845,-1040.0433C2218.205,-1043.5899 2228.6159,-1048.1603 2237.5562,-1053.9867 2253.7943,-1064.5694 2347.3128,-1165.7479 2353.8713,-1183.9867"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge452" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1637.2174,-5401.9867C1666.8317,-5423.3882 1688.5842,-5394.6251 1718.2273,-5415.9867 1745.6523,-5435.75 1735.8152,-5454.6369 1754.2273,-5482.9867 1804.4401,-5560.3015 1846.8323,-5561.4549 1881.23,-5646.9867 1937.7627,-5787.5588 1885.0649,-5837.9265 1917.23,-5985.9867 1966.8631,-6214.4546 1975.9446,-6277.5149 2083.7241,-6484.9867 2149.1872,-6611.0009 2171.4605,-6643.2879 2273.5562,-6741.9867 2375.0705,-6840.1237 2394.2218,-6917.0677 2535.3311,-6921.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2535.3311,-6921.9867C2615.3509,-6923.8966 2650.2484,-6968.4472 2715.427,-6921.9867"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1495.1715,-5208.4349C1550.0323,-5207.1937 1640.9364,-5203.2655 1718.2273,-5190.9867 1883.7705,-5164.6879 1919.8098,-5133.0334 2083.7241,-5097.9867 2167.4665,-5080.0817 2188.6849,-5076.3992 2273.5562,-5064.9867 2336.1237,-5056.5735 2407.4773,-5049.9549 2459.8695,-5045.6469"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2460.4034,-5049.1152 2470.0869,-5044.8163 2459.8362,-5042.1382 2460.4034,-5049.1152"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M1637.2174,-5401.9867C1666.0974,-5424.3693 1684.0888,-5402.9638 1718.2273,-5415.9867 1897.1114,-5484.2265 1909.2764,-5565.0933 2083.7241,-5643.9867 2163.9886,-5680.2861 2186.4004,-5688.1841 2273.5562,-5700.9867 2417.311,-5722.1034 2472.0489,-5768.9424 2600.4756,-5700.9867 2735.8901,-5629.3336 2742.9331,-5560.2942 2794.3784,-5415.9867 2867.6911,-5210.3398 2885.9163,-4490.5051 2888.6902,-4357.2807"/>
<polygon fill="#a4ff00" stroke="#a4ff00" points="2892.192,-4357.2227 2888.8943,-4347.1541 2885.1934,-4357.0815 2892.192,-4357.2227"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge352" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1495.0968,-5217.8251C1504.4669,-5221.4878 1513.4398,-5226.6662 1520.2075,-5233.9867 1564.9903,-5282.4275 1510.5746,-5330.3461 1556.2075,-5377.9867 1582.1827,-5405.1047 1607.2981,-5379.2947 1637.2174,-5401.9867"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1637.2174,-5401.9867C1664.291,-5422.5205 2205.5165,-5296.3039 2237.5562,-5284.9867 2409.617,-5224.2107 2505.1744,-5248.6028 2600.4756,-5092.9867 2635.7464,-5035.3936 2632.7244,-2729.4177 2636.4756,-2661.9867 2654.1412,-2344.4284 2701.0149,-1959.5848 2712.7395,-1866.1572"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2716.2399,-1866.3731 2714.0185,-1856.0138 2709.2949,-1865.4974 2716.2399,-1866.3731"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1446.6366,-5197.9495C1454.1326,-5115.9221 1501.1456,-4592.6311 1520.2075,-4165.9867 1540.1473,-3719.6937 1511.88,-2600.5204 1556.2075,-2155.9867 1572.5643,-1991.9542 1616.9283,-1797.6229 1632.0712,-1734.166"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1635.5359,-1734.7272 1634.4703,-1724.1861 1628.7298,-1733.091 1635.5359,-1734.7272"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1494.853,-5209.7169C1553.3523,-5208.1992 1651.4225,-5197.8791 1718.2273,-5149.9867 1788.1352,-5099.8698 1761.5999,-5049.1663 1817.7286,-4983.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1817.7286,-4983.9867C2005.6609,-4797.3285 2127.107,-4801.7373 2237.5562,-4560.9867 2280.0343,-4468.3955 2258.8844,-4204.7948 2273.5562,-4103.9867 2293.4294,-3967.4398 2333.5769,-3806.2447 2348.2977,-3749.2431"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2351.7616,-3749.8291 2350.8892,-3739.2702 2344.9866,-3748.0685 2351.7616,-3749.8291"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge282" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1817.7286,-4983.9867C1820.2428,-4982.1517 2235.6627,-4829.4572 2237.5562,-4826.9867 2288.8863,-4760.015 2244.2777,-4528.1244 2273.5562,-4448.9867 2316.5668,-4332.7317 2395.3396,-4338.6986 2434.1865,-4220.9867 2486.921,-4061.1938 2426.836,-2869.5766 2470.1865,-2706.9867 2480.3849,-2668.737 2504.998,-2629.3274 2520.8805,-2606.5468"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2523.9304,-2608.2982 2526.8875,-2598.1244 2518.2313,-2604.2335 2523.9304,-2608.2982"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge335" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1454.8082,-5197.8651C1501.7022,-5141.2936 1719.8618,-4880.5236 1917.23,-4684.9867 1995.3358,-4607.6056 2095.6826,-4523.3635 2139.0695,-4487.6104"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2141.4603,-4490.1759 2146.9639,-4481.1227 2137.0158,-4484.7678 2141.4603,-4490.1759"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge373" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1464.4723,-5220.0423C1481.587,-5231.0593 1506.2248,-5249.5442 1520.2075,-5271.9867 1555.0927,-5327.978 1525.613,-5357.5404 1556.2075,-5415.9867 1587.1747,-5475.1449 1699.6185,-5603.561 1754.2273,-5641.9867 1759.5052,-5645.7005 1765.4118,-5648.9657 1771.4408,-5651.8051"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1770.3754,-5655.1577 1780.9428,-5655.9197 1773.157,-5648.7341 1770.3754,-5655.1577"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge453" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2160.6401,-989.9867C2213.9546,-944.891 2211.9737,-917.9606 2237.5562,-852.9867 2262.3571,-789.9976 2221.5497,-748.3232 2273.5562,-704.9867 2363.0829,-630.385 2419.6192,-703.8152 2535.3311,-689.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1073.5199,-2205.9867C1104.6582,-2195.4802 1107.2696,-2182.1291 1130.6023,-2158.9867 1148.2987,-2141.4347 1150.5745,-2135.0746 1166.6023,-2115.9867 1241.3323,-2026.9891 1271.7039,-2013.4251 1335.0359,-1915.9867 1354.9678,-1885.3208 1342.6826,-1865.0902 1371.0359,-1841.9867 1424.0735,-1798.7694 1461.2099,-1838.6279 1520.2075,-1803.9867 1540.2693,-1792.2072 1535.8659,-1777.2763 1556.2075,-1765.9867 1620.4621,-1730.3254 1665.1322,-1783.7931 1718.2273,-1732.9867 1765.8909,-1687.3777 1736.882,-1652.6353 1754.2273,-1588.9867 1821.4861,-1342.181 1727.8433,-1208.9446 1917.23,-1036.9867 1937.6231,-1018.4704 2139.6362,-1007.8073 2160.6401,-989.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M973.2977,-2234.2108C1003.4018,-2227.571 1041.0453,-2218.018 1073.5199,-2205.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2535.3311,-689.9867C2614.8326,-680.6958 2659.5843,-632.642 2715.427,-689.9867"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1637.2174,-2169.9867C1850.0052,-2188.8038 1873.9736,-2295.7148 2047.7241,-2419.9867 2064.6644,-2432.103 2066.9784,-2437.603 2083.7241,-2449.9867 2233.3256,-2560.6195 2342.152,-2517.2775 2434.1865,-2678.9867 2464.8231,-2732.8166 2527.6922,-4787.0043 2534.6933,-5018.7756"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2531.1998,-5019.0473 2534.9996,-5028.9372 2538.1966,-5018.8362 2531.1998,-5019.0473"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M1250.8191,-2129.9867C1304.7908,-2108.4612 1308.42,-2081.6383 1335.0359,-2029.9867 1364.4645,-1972.8767 1326.9811,-1936.7498 1371.0359,-1889.9867 1418.7934,-1839.2933 1456.3115,-1869.6977 1520.2075,-1841.9867 1536.9997,-1834.7042 1539.4945,-1829.4491 1556.2075,-1821.9867 1625.7765,-1790.9241 1654.3627,-1807.5324 1718.2273,-1765.9867 1737.1953,-1753.6475 2252.8993,-1179.2245 2273.5562,-1169.9867 2406.2046,-1110.6662 2484.1881,-1078.8561 2600.4756,-1165.9867 2646.0596,-1200.1414 2600.7302,-1244.6391 2636.4756,-1288.9867 2661.5502,-1320.0957 2693.8562,-1298.3533 2715.427,-1331.9867"/>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M1073.5199,-2205.9867C1118.4205,-2190.8365 1122.837,-2172.158 1166.6023,-2153.9867 1202.5471,-2139.0626 1214.6683,-2144.4048 1250.8191,-2129.9867"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge248" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M920.7353,-2233.6972C930.3396,-2191.8664 963.9174,-2041.6371 980.4375,-1915.9867 1008.5558,-1702.1219 980.6079,-1644.6955 1016.4375,-1431.9867 1028.6401,-1359.5441 1054.2254,-1276.0507 1066.5677,-1237.9273"/>
<polygon fill="#00ffb4" stroke="#00ffb4" points="1070.0266,-1238.6107 1069.8099,-1228.0181 1063.3737,-1236.4338 1070.0266,-1238.6107"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge255" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00e6ff" stroke-dasharray="5,2" d="M1250.8191,-2205.9867C1282.793,-2228.1774 1310.2506,-2199.9793 1335.0359,-2229.9867 1393.2813,-2300.5041 1359.4342,-2549.2639 1371.0359,-2639.9867 1391.8947,-2803.0978 1428.9874,-2998.0255 1441.4249,-3061.7215"/>
<polygon fill="#00e6ff" stroke="#00e6ff" points="1438.0306,-3062.6007 1443.3897,-3071.7401 1444.8997,-3061.2535 1438.0306,-3062.6007"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge271" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M973.3428,-2244.9867C984.0299,-2244.9867 995.3376,-2244.9867 1006.3572,-2244.9867"/>
<polygon fill="#0052ff" stroke="#0052ff" points="1006.3702,-2248.4868 1016.3702,-2244.9867 1006.3701,-2241.4868 1006.3702,-2248.4868"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge308" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M2535.3311,-2281.9867C2561.7416,-2314.1823 2674.4783,-2583.3292 2706.7588,-2661.0501"/>
<polygon fill="#0020ff" stroke="#0020ff" points="2703.6979,-2662.806 2710.7624,-2670.7018 2710.1637,-2660.1239 2703.6979,-2662.806"/>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M1250.8191,-2129.9867C1426.8391,-2064.7991 1872.2193,-1783.4245 2047.7241,-1849.9867 2318.4406,-1952.6592 2351.7018,-2058.1356 2535.3311,-2281.9867"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge355" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1250.8191,-2129.9867C1327.0584,-2101.6306 1306.1165,-2040.9968 1371.0359,-1991.9867 1521.2081,-1878.6162 1576.4699,-1873.6867 1754.2273,-1811.9867 1878.4866,-1768.8561 1933.9609,-1707.9674 2047.7241,-1773.9867 2075.6166,-1790.1734 2055.8316,-1820.8001 2083.7241,-1836.9867 2142.8578,-1871.3034 2175.9395,-1866.6147 2237.5562,-1836.9867 2274.8625,-1819.0482 2432.8802,-1563.9253 2470.1865,-1545.9867 2522.3732,-1520.8931 2552.7451,-1513.2005 2600.4756,-1545.9867 2648.9093,-1579.256 2695.707,-1761.3255 2710.5692,-1823.876"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2707.2038,-1824.8553 2712.8943,-1833.7922 2714.019,-1823.2573 2707.2038,-1824.8553"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge406" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M968.7626,-2256.022C984.0414,-2259.1528 1000.8853,-2262.4078 1016.4375,-2264.9867 1086.8593,-2276.6645 1286.8633,-2253.3084 1335.0359,-2305.9867 1404.8218,-2382.2999 1321.8191,-3145.039 1371.0359,-3235.9867 1420.5806,-3327.5404 1536.0537,-3385.0108 1597.347,-3410.1766"/>
<polygon fill="#ff00c5" stroke="#ff00c5" points="1596.1168,-3413.4542 1606.7006,-3413.9384 1598.7288,-3406.9598 1596.1168,-3413.4542"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge425" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1250.8191,-2205.9867C1282.7884,-2228.1841 1309.5081,-2200.6083 1335.0359,-2229.9867 1373.2942,-2274.016 1357.3492,-2433.2862 1371.0359,-2489.9867 1429.5845,-2732.5389 1406.232,-2820.5706 1556.2075,-3019.9867 1609.2836,-3090.5597 1655.0703,-3073.2712 1718.2273,-3134.9867 1856.3766,-3269.983 2143.3102,-3663.384 2237.5562,-3831.9867 2291.2708,-3928.0804 2332.5606,-4054.0609 2347.65,-4103.1462"/>
<polygon fill="#ff0094" stroke="#ff0094" points="2344.3627,-4104.3664 2350.6181,-4112.9174 2351.0605,-4102.3319 2344.3627,-4104.3664"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1250.8191,-1901.9867C1277.9592,-1874.091 1304.4817,-1902.0948 1335.0359,-1877.9867 1360.6566,-1857.7713 1345.7593,-1834.6309 1371.0359,-1813.9867 1398.0067,-1791.9589 1413.7373,-1803.9879 1445.6217,-1789.9867"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1250.8191,-1901.9867C1305.6353,-1847.3432 1314.675,-1829.0356 1371.0359,-1775.9867 1388.115,-1759.9113 1408.5224,-1742.8076 1423.67,-1730.484"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1425.9108,-1733.1732 1431.4897,-1724.1662 1421.5116,-1727.7283 1425.9108,-1733.1732"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M937.7646,-2233.8078C984.4244,-2207.0031 1100.2536,-2138.8641 1130.6023,-2105.9867 1153.266,-2081.4347 1149.8945,-2068.9228 1166.6023,-2039.9867 1202.5311,-1977.7623 1199.9317,-1952.7138 1250.8191,-1901.9867"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1250.8191,-2205.9867C1282.793,-2228.1774 1308.6714,-2201.3569 1335.0359,-2229.9867 1390.8921,-2290.6423 1328.6866,-2341.2368 1371.0359,-2411.9867 1425.7209,-2503.3451 1470.7115,-2500.5263 1556.2075,-2563.9867 1639.6594,-2625.9299 1743.5013,-2692.4507 1791.3441,-2722.5388"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1789.545,-2725.5418 1799.8761,-2727.8913 1793.265,-2719.6121 1789.545,-2725.5418"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1073.5199,-2205.9867C1110.8519,-2193.3903 1218.4556,-2183.5157 1250.8191,-2205.9867"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1073.5199,-2397.9867C1117.5824,-2393.2265 1166.7338,-2381.9286 1202.0887,-2372.7115"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1203.366,-2375.994 1212.1371,-2370.0511 1201.5744,-2369.2271 1203.366,-2375.994"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M929.0884,-2256.0121C964.0985,-2291.1609 1071.0026,-2398.2587 1073.5199,-2397.9867"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1250.8191,-2129.9867C1288.0707,-2118.714 1306.839,-2127.1597 1335.0359,-2153.9867 1371.0819,-2188.2816 1335.8821,-2224.7779 1371.0359,-2259.9867 1483.3041,-2372.4307 1943.5125,-2371.0379 2047.7241,-2490.9867 2091.5706,-2541.4546 2143.205,-3017.4458 2160.6401,-3081.9867"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M931.6808,-2233.821C945.3463,-2222.0356 966.3692,-2202.3736 980.4375,-2181.9867 1008.7388,-2140.9744 1050.315,-2022.0834 1073.5199,-1977.9867"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge283" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1637.2174,-2169.9867C2002.3802,-2098.1081 2152.5294,-2183.7181 2434.1865,-2426.9867 2457.4339,-2447.0656 2453.8602,-2459.9664 2470.1865,-2485.9867 2488.0742,-2514.4954 2509.2823,-2547.1747 2522.5256,-2567.4516"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2519.6064,-2569.3827 2528.0093,-2575.8358 2525.4646,-2565.551 2519.6064,-2569.3827"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1250.8191,-2129.9867C1415.3874,-2077.7814 1466.9993,-2198.8648 1637.2174,-2169.9867"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge454" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1445.6217,-343.9867C1674.1309,-273.2768 1743.2777,-305.9867 1982.4771,-305.9867 1982.4771,-305.9867 1982.4771,-305.9867 2353.8713,-305.9867 2514.5627,-305.9867 2635.3176,-166.6877 2715.427,-305.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.4108,-1205.9676C1080.2512,-1135.3405 1114.4564,-745.792 1166.6023,-639.9867 1246.5249,-477.8221 1270.4908,-388.8661 1445.6217,-343.9867"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M1122.5187,-1205.9531C1178.8484,-1196.1789 1271.6731,-1189.299 1335.0359,-1231.9867 1366.0333,-1252.8698 1342.3343,-1284.0461 1371.0359,-1307.9867 1423.7467,-1351.9539 1465.8082,-1306.1268 1520.2075,-1347.9867 1660.3221,-1455.804 1671.3593,-1522.5167 1718.2273,-1692.9867 1786.4245,-1941.036 1715.7541,-3753.6266 1754.2273,-4007.9867 1765.4423,-4082.133 1795.2818,-4166.4603 1809.7035,-4204.4826"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1806.4803,-4205.8526 1813.334,-4213.932 1813.0146,-4203.342 1806.4803,-4205.8526"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M1445.6217,-343.9867C1604.3831,-297.6657 1652.3478,-343.9867 1817.7286,-343.9867 1817.7286,-343.9867 1817.7286,-343.9867 2535.3311,-343.9867 2751.2536,-343.9867 2731.7214,-548.3551 2794.3784,-754.9867 2821.9269,-845.8366 2883.1259,-4022.8096 2888.6918,-4314.5752"/>
<polygon fill="#a4ff00" stroke="#a4ff00" points="2885.1949,-4314.7783 2888.8849,-4324.7098 2892.1937,-4314.6449 2885.1949,-4314.7783"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge357" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2535.3311,-955.9867C2581.027,-1023.7652 2579.4205,-1049.0012 2600.4756,-1127.9867 2605.1256,-1145.4307 2693.5313,-1705.9867 2712.045,-1823.5095"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2708.643,-1824.4061 2713.6563,-1833.7397 2715.5577,-1823.3169 2708.643,-1824.4061"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1073.8018,-1205.9643C1075.5004,-1156.9561 1087.2285,-955.1676 1166.6023,-816.9867 1228.8405,-708.637 1259.7704,-680.8483 1371.0359,-623.9867 1713.9753,-448.7297 1879.0209,-478.3635 2237.5562,-618.9867 2333.5198,-656.6252 2365.7016,-664.9446 2434.1865,-741.9867 2504.0789,-820.6122 2476.5231,-868.7599 2535.3311,-955.9867"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1087.8254,-1205.9439C1116.8997,-1184.6714 1185.6699,-1140.2419 1250.8191,-1141.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2160.6401,-1559.9867C2206.3259,-1559.3971 2258.0925,-1559.4348 2296.5391,-1559.5993"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2296.9972,-1563.1014 2307.0136,-1559.6486 2297.0303,-1556.1015 2296.9972,-1563.1014"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1982.4771,-1331.9867C2090.9487,-1401.0692 2032.0488,-1561.6465 2160.6401,-1559.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1250.8191,-1141.9867C1418.7423,-1146.484 1840.7884,-1241.7494 1982.4771,-1331.9867"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1129.5636,-1226.4921C1185.806,-1238.1949 1272.7974,-1262.386 1335.0359,-1307.9867 1374.0519,-1336.5729 1570.1018,-1616.4668 1623.6724,-1693.4681"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1620.8976,-1695.6084 1629.4789,-1701.8222 1626.6455,-1691.6132 1620.8976,-1695.6084"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1083.9474,-1228.1426C1100.6913,-1245.8297 1134.9143,-1281.06 1166.6023,-1307.9867 1237.4394,-1368.1803 1279.9166,-1357.1334 1335.0359,-1431.9867 1364.0389,-1471.3735 1353.5295,-1490.3138 1371.0359,-1535.9867 1393.0052,-1593.3033 1421.9441,-1659.7085 1436.4705,-1692.4968"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1433.3932,-1694.1908 1440.6534,-1701.9071 1439.7898,-1691.3475 1433.3932,-1694.1908"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1077.3535,-1227.9982C1088.0819,-1259.3873 1118.418,-1352.1968 1130.6023,-1431.9867 1158.3372,-1613.6111 1100.2838,-2086.6435 1166.6023,-2257.9867 1179.6976,-2291.8202 1208.9846,-2322.5665 1229.3164,-2341.0221"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1227.068,-2343.7059 1236.8809,-2347.7004 1231.7008,-2338.4583 1227.068,-2343.7059"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1250.8191,-1141.9867C1289.7357,-1142.4974 1299.0307,-1151.2088 1335.0359,-1165.9867 1424.8664,-1202.8568 1650.3423,-1306.5566 1718.2273,-1375.9867 1839.689,-1500.2131 1991.4657,-1920.6087 2047.7241,-2084.9867 2067.8317,-2143.7378 2056.3945,-2164.2275 2083.7241,-2219.9867 2133.3897,-2321.3169 2199.5899,-2315.718 2237.5562,-2421.9867 2313.5644,-2634.7362 2239.1703,-3214.6994 2273.5562,-3437.9867 2289.4533,-3541.2164 2329.5049,-3660.0811 2346.2876,-3707.1998"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2343.0854,-3708.6383 2349.7635,-3716.8634 2349.6723,-3706.269 2343.0854,-3708.6383"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1079.4823,-1228.0064C1094.0495,-1254.8573 1132.7363,-1325.7349 1166.6023,-1383.9867 1191.4839,-1426.7848 1221.8182,-1476.21 1238.4436,-1503.075"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1235.6693,-1505.2426 1243.913,-1511.8979 1241.6189,-1501.5544 1235.6693,-1505.2426"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge284" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1080.5926,-1205.9239C1095.3422,-1183.1936 1130.9822,-1130.0118 1166.6023,-1089.9867 1176.9102,-1078.4041 1356.9026,-906.3634 1371.0359,-899.9867 1474.667,-853.2307 1770.1355,-837.8298 1881.23,-861.9867 1960.7148,-879.2703 1993.5949,-877.2695 2047.7241,-937.9867 2082.2364,-976.6995 2048.8752,-1010.5767 2083.7241,-1048.9867 2133.8328,-1104.2159 2184.748,-1063.3328 2237.5562,-1115.9867 2265.7415,-1144.0898 2254.3453,-1163.1279 2273.5562,-1197.9867 2335.1511,-1309.7531 2394.7727,-1314.6105 2434.1865,-1435.9867 2506.2936,-1658.0431 2400.3976,-2263.191 2470.1865,-2485.9867 2480.1292,-2517.728 2502.9492,-2549.1017 2518.7539,-2568.258"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2516.1109,-2570.5529 2525.245,-2575.9213 2521.4523,-2566.0285 2516.1109,-2570.5529"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~datazoneenergydemands.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/datazoneenergydemands.f90.html" xlink:title="DataZoneEnergyDemands.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2237.4723,-6475.9922 2083.808,-6475.9922 2083.808,-6453.9813 2237.4723,-6453.9813 2237.4723,-6475.9922"/>
<text text-anchor="middle" x="2160.6401" y="-6461.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEnergyDemands.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge455" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2164.6956,-6476.3602C2176.9019,-6509.3903 2216.0351,-6606.9623 2273.5562,-6669.9867 2311.6575,-6711.7334 2669.337,-6954.7007 2715.427,-6921.9867"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2163.4039,-6453.9421C2175.1593,-6406.3676 2221.1489,-6214.0522 2237.5562,-6052.9867 2325.3563,-5191.0772 2174.6119,-4964.6882 2273.5562,-4103.9867 2289.3149,-3966.904 2331.9928,-3806.0384 2347.8402,-3749.1836"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2351.2994,-3749.8113 2350.636,-3739.2373 2344.5605,-3747.917 2351.2994,-3749.8113"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge286" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2165.1449,-6453.7162C2178.8706,-6418.7992 2220.2841,-6309.0526 2237.5562,-6213.9867 2283.6455,-5960.3094 2226.0494,-5888.4025 2273.5562,-5634.9867 2316.875,-5403.9106 2396.338,-5363.0217 2434.1865,-5130.9867 2477.5508,-4865.1372 2401.9538,-2967.5644 2470.1865,-2706.9867 2480.2141,-2668.6919 2504.8793,-2629.296 2520.8185,-2606.5305"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2523.8696,-2608.2815 2526.8488,-2598.1142 2518.1794,-2604.2045 2523.8696,-2608.2815"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge456" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1637.2174,-3005.9867C1673.6234,-2996.7835 1684.8252,-2999.1448 1718.2273,-2981.9867 1736.2574,-2972.725 1736.5488,-2963.9032 1754.2273,-2953.9867 1780.5415,-2939.2263 1791.9876,-2945.7254 1817.7286,-2929.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1817.7286,-2929.9867C1839.7576,-2916.5177 1892.7874,-2878.3084 1917.23,-2869.9867 2206.5585,-2771.4828 2306.2493,-2874.7208 2600.4756,-2791.9867 2691.9381,-2766.2682 2740.5984,-2780.31 2794.3784,-2701.9867 2883.1337,-2572.7268 2738.4816,-1250.3971 2889.0989,-1293.9867"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1637.2174,-3005.9867C1744.9585,-2979.7688 1780.0307,-3012.6631 1881.23,-3057.9867 2123.7043,-3166.5824 2214.1319,-3198.0228 2353.8713,-3423.9867"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M2535.3311,-3157.9867C2563.452,-3175.0006 2574.1841,-3173.2632 2600.4756,-3192.9867 2658.7888,-3236.7327 2676.1402,-3248.5809 2715.427,-3309.9867"/>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M1817.7286,-2929.9867C2111.1013,-2768.9896 2249.0117,-2984.7562 2535.3311,-3157.9867"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge310" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M2535.3311,-2777.9867C2566.5665,-2762.8916 2572.2858,-2755.2069 2600.4756,-2734.9867 2616.9464,-2723.1725 2618.5326,-2716.4161 2636.4756,-2706.9867 2644.2432,-2702.9048 2652.7944,-2699.3482 2661.3141,-2696.2985"/>
<polygon fill="#0020ff" stroke="#0020ff" points="2662.5217,-2699.585 2670.8764,-2693.0697 2660.2822,-2692.9529 2662.5217,-2699.585"/>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M1637.2174,-2929.9867C1666.2342,-2906.1515 1689.7064,-2930.4132 1718.2273,-2905.9867 1746.6148,-2881.6745 1728.704,-2857.2906 1754.2273,-2829.9867 1798.3877,-2782.7456 1836.4384,-2805.6298 1881.23,-2758.9867 1905.7359,-2733.4678 1887.0817,-2706.5026 1917.23,-2687.9867 2038.5445,-2613.4804 2096.7193,-2667.1684 2237.5562,-2687.9867 2374.3271,-2708.2041 2410.8483,-2838.1455 2535.3311,-2777.9867"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge358" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1452.6265,-3071.8797C1469.758,-3044.8345 1515.3605,-2973.5584 1556.2075,-2915.9867 1584.2567,-2876.4529 2042.5795,-2246.615 2083.7241,-2220.9867 2113.2871,-2202.5725 2127.3534,-2216.2358 2160.6401,-2205.9867"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge400" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M1458.4204,-3094.0712C1474.552,-3108.582 1502.3282,-3135.4278 1520.2075,-3162.9867 1542.5365,-3197.4044 1539.6689,-3210.4416 1556.2075,-3247.9867 1581.2851,-3304.9168 1612.1838,-3371.4913 1627.566,-3404.4053"/>
<polygon fill="#ff00c5" stroke="#ff00c5" points="1624.5791,-3406.2804 1631.988,-3413.854 1630.9192,-3403.3132 1624.5791,-3406.2804"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge416" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1468.9843,-3094.0175C1533.519,-3124.5811 1710.0259,-3208.8412 1718.2273,-3219.9867 1776.4292,-3299.0816 1708.8356,-3350.906 1754.2273,-3437.9867 1790.6919,-3507.9416 1841.8388,-3493.6371 1881.23,-3561.9867 1939.4465,-3663.0012 1877.7829,-3752.6817 1982.4771,-3803.9867"/>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1982.4771,-3803.9867C2088.9348,-3858.8892 2147.3652,-3812.1634 2237.5562,-3890.9867 2305.173,-3950.0812 2337.8849,-4057.7367 2349.1516,-4103.0256"/>
<polygon fill="#ff0094" stroke="#ff0094" points="2345.7812,-4103.9807 2351.5087,-4112.894 2352.5897,-4102.3544 2345.7812,-4103.9807"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1457.4006,-3071.9238C1474.8647,-3054.6591 1506.9842,-3019.39 1520.2075,-2981.9867 1581.4478,-2808.7636 1535.6341,-2338.561 1556.2075,-2155.9867 1574.6664,-1992.1774 1617.6699,-1797.7016 1632.2674,-1734.1868"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1635.7343,-1734.7291 1634.5781,-1724.1976 1628.9144,-1733.1515 1635.7343,-1734.7291"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1637.2174,-2929.9867C1666.2342,-2906.1515 1691.081,-2931.9323 1718.2273,-2905.9867 1753.5872,-2872.1908 1728.1913,-2843.3948 1754.2273,-2801.9867 1765.1801,-2784.5672 1781.8062,-2768.3028 1795.2988,-2756.6641"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1797.7882,-2759.145 1803.2161,-2750.0462 1793.2988,-2753.7742 1797.7882,-2759.145"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1495.3839,-3073.3781C1504.5122,-3069.7706 1513.3175,-3064.8094 1520.2075,-3057.9867 1554.9639,-3023.5703 1520.8476,-2987.7827 1556.2075,-2953.9867 1583.3538,-2928.0411 1608.2006,-2953.822 1637.2174,-2929.9867"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1637.2174,-3005.9867C1691.4154,-2992.5223 2012.6875,-3252.4994 2047.7241,-3295.9867 2073.4635,-3327.9343 2060.1795,-3347.389 2083.7241,-3380.9867 2137.2953,-3457.4319 2179.5861,-3450.8211 2237.5562,-3523.9867 2285.9238,-3585.0329 2326.8771,-3668.5724 2344.5468,-3707.0384"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2341.5819,-3708.975 2348.8999,-3716.6365 2347.9569,-3706.0837 2341.5819,-3708.975"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge285" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1486.9177,-3071.8983C1498.0433,-3068.18 1509.8569,-3063.5373 1520.2075,-3057.9867 1538.0709,-3048.4074 1538.1774,-3039.2485 1556.2075,-3029.9867 1589.6096,-3012.8287 1600.8495,-3015.3391 1637.2174,-3005.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1637.2174,-3005.9867C1673.5854,-2996.6344 1689.0223,-3005.591 1718.2273,-2981.9867 1744.2141,-2960.9836 1731.7599,-2940.7185 1754.2273,-2915.9867 1800.0649,-2865.5292 1842.0703,-2885.7861 1881.23,-2829.9867 1918.631,-2776.6934 1866.9624,-2729.3653 1917.23,-2687.9867 2067.2858,-2564.4658 2164.0033,-2705.5115 2353.8713,-2663.9867"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge457" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2715.427,-5838.9867C2794.3586,-5842.5851 2836.9775,-5860.3711 2889.0989,-5800.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1447.9901,-4157.236C1457.5784,-4201.6105 1495.9101,-4368.2287 1556.2075,-4493.9867 1624.9585,-4637.3756 1664.0302,-4661.0228 1754.2273,-4791.9867 1809.3508,-4872.0247 1828.2606,-4888.5072 1881.23,-4969.9867 1898.3882,-4996.3801 1898.8952,-5005.3968 1917.23,-5030.9867 2136.7539,-5337.3777 2188.4135,-5423.6467 2470.1865,-5673.9867 2568.3947,-5761.2393 2584.1941,-5833.004 2715.427,-5838.9867"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1519.0678,-4143.332C1554.8189,-4142.9106 1598.3685,-4143.6848 1637.2174,-4147.9867"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1637.2174,-4147.9867C1657.3515,-4150.2163 2339.291,-4268.9237 2353.8713,-4282.9867"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M2353.8713,-4282.9867C2469.7212,-4384.7202 2523.2084,-4906.4372 2533.4705,-5018.6912"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2529.9955,-5019.1274 2534.3756,-5028.7744 2536.9674,-5018.5015 2529.9955,-5019.1274"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M1637.2174,-4147.9867C1674.5405,-4152.1197 1684.8252,-4154.8287 1718.2273,-4171.9867 1736.2574,-4181.2485 1736.6172,-4189.9494 1754.2273,-4199.9867 1760.6672,-4203.6573 1767.752,-4207.0269 1774.7819,-4210.0234"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1773.6861,-4213.3559 1784.2684,-4213.8716 1776.3174,-4206.8692 1773.6861,-4213.3559"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M1451.8333,-4157.2255C1506.3691,-4255.6372 1905.809,-4971.0963 2083.7241,-5137.9867 2227.078,-5272.4576 2279.9331,-5303.6272 2470.1865,-5352.9867 2576.3269,-5380.5239 2640.5935,-5406.1367 2715.427,-5325.9867"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge311" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M1518.9947,-4136.9008C1531.3966,-4135.6876 1544.1554,-4134.6387 1556.2075,-4133.9867 1628.1112,-4130.0969 1646.4358,-4128.3973 1718.2273,-4133.9867 1798.1217,-4140.2071 2372.6389,-4272.3063 2434.1865,-4220.9867 2496.221,-4169.2613 2685.8326,-2884.6254 2712.3377,-2703.2079"/>
<polygon fill="#0020ff" stroke="#0020ff" points="2715.8348,-2703.4815 2713.8151,-2693.081 2708.9081,-2702.4709 2715.8348,-2703.4815"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge359" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1449.5121,-4134.9483C1466.9463,-4085.6462 1537.8316,-3886.9996 1556.2075,-3863.9867 1721.0113,-3657.5971 1841.9965,-3695.6161 2047.7241,-3529.9867 2382.9332,-3260.1132 2460.7066,-3142.0021 2600.4756,-2734.9867 2658.5047,-2566.0025 2704.8257,-1985.399 2713.8371,-1866.401"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2717.3533,-1866.3151 2714.6123,-1856.081 2710.373,-1865.7907 2717.3533,-1866.3151"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge404" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M1450.7681,-4134.595C1464.4573,-4103.7814 1501.9629,-4015.9255 1520.2075,-3938.9867 1551.0908,-3808.7497 1524.3807,-3769.9964 1556.2075,-3639.9867 1574.2403,-3566.3246 1610.1705,-3483.4897 1627.4678,-3445.7364"/>
<polygon fill="#ff00c5" stroke="#ff00c5" points="1630.798,-3446.8738 1631.8221,-3436.3286 1624.4455,-3443.9336 1630.798,-3446.8738"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge423" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1449.0277,-4134.8405C1459.232,-4103.6698 1492.8394,-4015.6859 1556.2075,-3981.9867 1591.7308,-3963.0955 1920.1023,-3982.4105 1982.4771,-3993.9867"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1449.6791,-4134.7728C1461.3439,-4104.0641 1497.9151,-4017.7867 1556.2075,-3970.9867 1777.4065,-3793.3975 1882.75,-3822.9426 2160.6401,-3765.9867"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge381" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1447.1395,-4157.1588C1455.6259,-4218.9191 1498.8808,-4524.6463 1556.2075,-4769.9867 1639.2755,-5125.4918 1778.4166,-5549.2099 1810.8333,-5646.4287"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1807.531,-5647.59 1814.0204,-5655.9648 1814.17,-5645.3711 1807.531,-5647.59"/>
</g>
<!-- sourcefile~dataairloop.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~dataairloop.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/dataairloop.f90.html" xlink:title="DataAirLoop.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2204.5242,-5128.9922 2116.756,-5128.9922 2116.756,-5106.9813 2204.5242,-5106.9813 2204.5242,-5128.9922"/>
<text text-anchor="middle" x="2160.6401" y="-5114.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirLoop.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge458" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2204.8182,-5125.3163C2216.5611,-5129.0215 2228.4846,-5134.5973 2237.5562,-5142.9867 2268.2783,-5171.3991 2246.5317,-5198.0369 2273.5562,-5229.9867 2340.1261,-5308.6894 2377.3651,-5308.1552 2470.1865,-5352.9867 2574.327,-5403.2853 2665.6282,-5335.6064 2715.427,-5439.9867"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M2204.5619,-5107.92C2243.5933,-5099.2623 2302.2909,-5086.9462 2353.8713,-5078.9867"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M2353.8713,-5078.9867C2396.9529,-5072.3388 2445.175,-5061.8262 2481.0742,-5053.3898"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2481.9354,-5056.7827 2490.8584,-5051.0703 2480.3207,-5049.9715 2481.9354,-5056.7827"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M2195.9963,-5129.0579C2209.1008,-5133.2717 2224.054,-5138.2107 2237.5562,-5142.9867 2451.9655,-5218.8288 2557.392,-5489.5358 2715.427,-5325.9867"/>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M2715.427,-5325.9867C2853.278,-5178.3424 2883.8351,-4488.0772 2888.4196,-4357.3755"/>
<polygon fill="#a4ff00" stroke="#a4ff00" points="2891.927,-4357.213 2888.766,-4347.1008 2884.931,-4356.9771 2891.927,-4357.213"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge360" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2353.8713,-5078.9867C2433.5767,-5066.6873 2462.7096,-5114.063 2535.3311,-5078.9867"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2164.1954,-5106.7818C2177.1726,-5065.2462 2222.037,-4915.9165 2237.5562,-4788.9867 2308.627,-4207.7052 2230.2439,-2737.993 2273.5562,-2153.9867 2290.2819,-1928.4634 2336.4859,-1657.7915 2350.0689,-1581.1325"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2353.5198,-1581.7174 2351.8289,-1571.2584 2346.6284,-1580.4891 2353.5198,-1581.7174"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge287" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2203.635,-5106.9102C2214.9907,-5103.2136 2227.0124,-5098.5789 2237.5562,-5092.9867 2255.4632,-5083.4893 2257.5336,-5077.4021 2273.5562,-5064.9867 2344.8471,-5009.7459 2393.764,-5021.6091 2434.1865,-4940.9867 2489.8204,-4830.0253 2438.6679,-2827.0457 2470.1865,-2706.9867 2480.2383,-2668.6982 2504.8961,-2629.3004 2520.8273,-2606.5328"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2523.8782,-2608.2839 2526.8543,-2598.1156 2518.1867,-2604.2086 2523.8782,-2608.2839"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge459" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1102.6672,-2233.8726C1111.8461,-2229.9409 1121.8635,-2225.1885 1130.6023,-2219.9867 1148.0199,-2209.6189 1148.5243,-2201.1546 1166.6023,-2191.9867 1201.3138,-2174.3837 1215.295,-2183.8863 1250.8191,-2167.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1250.8191,-2167.9867C1286.3432,-2152.0872 1308.1424,-2172.1203 1335.0359,-2143.9867 1383.0079,-2093.8027 1333.009,-2050.0704 1371.0359,-1991.9867 1416.4469,-1922.6242 1458.3302,-1935.1638 1520.2075,-1879.9867 1537.5712,-1864.5033 1537.3479,-1855.6084 1556.2075,-1841.9867 1620.6856,-1795.4166 1661.8763,-1822.1184 1718.2273,-1765.9867 1982.9223,-1502.3219 1788.4345,-1237.868 2083.7241,-1008.9867 2111.5551,-987.4147 2137.4654,-1016.498 2160.6401,-989.9867"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1445.6217,-2397.9867C1557.9607,-2445.2836 1597.6931,-2409.8605 1718.2273,-2427.9867 1865.6653,-2450.1589 1929.1019,-2400.6632 2047.7241,-2490.9867 2076.5055,-2512.902 2058.4196,-2538.1348 2083.7241,-2563.9867 2137.6293,-2619.0582 2183.2369,-2589.3237 2237.5562,-2643.9867 2372.7086,-2779.9946 2384.5719,-2842.7768 2434.1865,-3027.9867 2488.396,-3230.3488 2529.7322,-4816.3678 2534.8063,-5018.7613"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2531.3124,-5019.0541 2535.0606,-5028.9638 2538.3102,-5018.8796 2531.3124,-5019.0541"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M1445.6217,-3221.9867C1584.1057,-3620.1119 1769.5071,-4100.6454 1809.7939,-4204.5584"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1806.5432,-4205.8565 1813.4234,-4213.9134 1813.0693,-4203.3245 1806.5432,-4205.8565"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M1250.8191,-2167.9867C1286.578,-2152.6225 1298.618,-2157.7161 1335.0359,-2143.9867 1463.4789,-2095.5646 2352.6602,-1690.4212 2434.1865,-1579.9867 2484.1954,-1512.2454 2412.3512,-1455.182 2470.1865,-1393.9867 2479.8392,-1383.7733 2707.8608,-1320.1443 2715.427,-1331.9867"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge312" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M1250.8191,-2167.9867C1267.8021,-2162.2978 2523.688,-2268.3769 2535.3311,-2281.9867"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge361" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1250.8191,-2167.9867C1304.3884,-2151.6369 1698.2371,-2143.4317 1754.2273,-2141.9867 1810.6541,-2140.5305 1824.7866,-2141.4783 1881.23,-2141.9867 1955.2364,-2142.6534 1973.7947,-2141.5464 2047.7241,-2144.9867 2184.0255,-2151.3295 2217.4448,-2170.457 2353.8713,-2167.9867"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2353.8713,-2167.9867C2533.5188,-2143.5031 2666.8279,-1931.5362 2704.5883,-1864.929"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2707.6448,-1866.6341 2709.4603,-1856.196 2701.5318,-1863.2237 2707.6448,-1866.6341"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge393" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M1445.6217,-3221.9867C1452.1342,-3240.7095 1542.1376,-3348.0229 1556.2075,-3361.9867 1573.6528,-3379.3005 1595.8208,-3396.2489 1612.5557,-3408.1978"/>
<polygon fill="#ff00c5" stroke="#ff00c5" points="1610.5647,-3411.0765 1620.7579,-3413.9661 1614.5915,-3405.3507 1610.5647,-3411.0765"/>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M1250.8191,-2243.9867C1282.5543,-2266.5176 1310.9946,-2237.38 1335.0359,-2267.9867 1399.2569,-2349.7459 1305.6691,-3122.1407 1371.0359,-3202.9867 1392.5435,-3229.5876 1434.3833,-3189.6776 1445.6217,-3221.9867"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge408" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1250.8191,-2243.9867C1282.3633,-2266.382 1309.0274,-2237.3486 1335.0359,-2265.9867 1402.8261,-2340.6312 1329.1044,-2398.2858 1371.0359,-2489.9867 1419.6626,-2596.3296 1996.5518,-3190.8451 2047.7241,-3295.9867 2081.7123,-3365.8209 2054.7535,-3394.9263 2083.7241,-3466.9867 2131.9652,-3586.98 2185.2086,-3595.7272 2237.5562,-3713.9867 2300.4283,-3856.0226 2338.4039,-4040.8243 2350.0352,-4102.734"/>
<polygon fill="#ff0094" stroke="#ff0094" points="2346.6412,-4103.6285 2351.9005,-4112.8258 2353.5246,-4102.3561 2346.6412,-4103.6285"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1250.8191,-2167.9867C1287.5963,-2155.2511 1300.4718,-2161.8777 1335.0359,-2143.9867 1349.0431,-2136.7364 1543.8004,-1975.7249 1556.2075,-1965.9867 1627.5381,-1910.0006 1647.3773,-1898.5798 1718.2273,-1841.9867 1734.5004,-1828.9882 1737.2675,-1824.0757 1754.2273,-1811.9867 1850.7583,-1743.1791 1874.4768,-1722.8608 1982.4771,-1673.9867"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1110.8151,-2233.9643C1118.1098,-2230.4388 1125.1708,-2225.8685 1130.6023,-2219.9867 1163.7863,-2184.0519 1142.4434,-2158.5172 1166.6023,-2115.9867 1224.001,-2014.9395 1281.8041,-2019.2899 1335.0359,-1915.9867 1364.4645,-1858.8767 1336.8792,-1830.4011 1371.0359,-1775.9867 1382.8973,-1757.0906 1402.2789,-1740.971 1418.3119,-1729.7682"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1420.4554,-1732.5448 1426.8056,-1724.0638 1416.5526,-1726.7337 1420.4554,-1732.5448"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M1090.8429,-2256.1251C1122.1706,-2276.2682 1188.3851,-2318.8429 1225.043,-2342.4132"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1223.3825,-2345.5066 1233.6868,-2347.971 1227.1684,-2339.6187 1223.3825,-2345.5066"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1445.6217,-2397.9867C1477.098,-2410.1041 1489.7659,-2397.4644 1520.2075,-2411.9867 1710.3082,-2502.6754 1727.9929,-2574.4838 1881.23,-2718.9867 1959.1004,-2792.4187 1999.3041,-2797.5322 2047.7241,-2892.9867 2089.176,-2974.7045 2045.6884,-3012.6241 2083.7241,-3095.9867 2128.8258,-3194.8358 2189.654,-3188.4641 2237.5562,-3285.9867 2268.1638,-3348.2999 2256.2883,-3370.7441 2273.5562,-3437.9867 2299.5952,-3539.3856 2334.081,-3659.7333 2347.8345,-3707.2336"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2344.5098,-3708.3353 2350.6574,-3716.9642 2351.2326,-3706.385 2344.5098,-3708.3353"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1114.1183,-2233.9354C1120.5513,-2230.4652 1126.4433,-2225.9235 1130.6023,-2219.9867 1202.1517,-2117.854 1128.836,-1778.8317 1166.6023,-1659.9867 1181.2758,-1613.8113 1214.7556,-1567.2836 1234.8016,-1542.1003"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1237.6954,-1544.0887 1241.2791,-1534.1183 1232.26,-1539.6778 1237.6954,-1544.0887"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge288" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1250.8191,-2243.9867C1282.8867,-2265.626 1306.7902,-2239.5525 1335.0359,-2265.9867 1371.9779,-2300.5597 1335.0726,-2338.3968 1371.0359,-2373.9867 1395.7877,-2398.4816 1412.8906,-2386.0987 1445.6217,-2397.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1445.6217,-2397.9867C1492.187,-2414.8994 1506.7641,-2387.104 1556.2075,-2383.9867 1858.8987,-2364.9028 1941.3438,-2356.8377 2237.5562,-2421.9867 2328.7516,-2442.0443 2354.4018,-2447.4758 2434.1865,-2495.9867 2467.3582,-2516.1559 2499.6265,-2547.9358 2518.4785,-2568.1046"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2516.1311,-2570.7229 2525.474,-2575.7191 2521.286,-2565.9871 2516.1311,-2570.7229"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1108.8428,-2233.9281C1147.2343,-2224.2047 1208.7183,-2215.5771 1250.8191,-2243.9867"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge460" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2716.53,-2670.7287C2729.5323,-2538.3758 2853.7455,-1283.7446 2889.0989,-1293.9867"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge461" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.1154,-2853.9867C1012.888,-2810.2591 1061.9049,-2832.5655 1130.6023,-2753.9867 1165.5736,-2713.9852 1127.4875,-2675.9471 1166.6023,-2639.9867 1223.0965,-2588.0486 1268.3305,-2639.9282 1335.0359,-2601.9867 1355.258,-2590.4846 1352.4008,-2577.9139 1371.0359,-2563.9867 1430.637,-2519.4431 1474.231,-2546.4896 1520.2075,-2487.9867 1563.1052,-2433.4016 1514.9418,-2391.8159 1556.2075,-2335.9867 1605.8245,-2268.859 1649.1322,-2287.8252 1718.2273,-2240.9867 1960.2825,-2076.9013 2034.6501,-2047.5666 2237.5562,-1836.9867 2256.5562,-1817.2681 2257.1598,-1808.9181 2273.5562,-1786.9867 2343.2843,-1693.7199 2389.9479,-1687.707 2434.1865,-1579.9867 2459.6943,-1517.8756 2425.8466,-1330.4091 2470.1865,-1279.9867 2544.4277,-1195.5614 2621.668,-1155.9494 2715.427,-1217.9867"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1073.5199,-3138.9867C1203.4968,-3188.4757 1236.3518,-3201.2972 1371.0359,-3235.9867 1397.9534,-3242.9197 2338.4516,-3400.86 2353.8713,-3423.9867"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M755.514,-2942.1143C757.7042,-2993.4507 771.7736,-3211.325 855.7932,-3361.9867 893.8524,-3430.2334 941.7367,-3418.1018 980.4375,-3485.9867 1012.6831,-3542.5485 983.8369,-3571.6289 1016.4375,-3627.9867 1071.4098,-3723.0193 1277.8225,-3913.9833 1371.0359,-3971.9867 1510.1541,-4058.5551 1602.9337,-3979.5592 1718.2273,-4095.9867 1752.6444,-4130.7424 1720.3711,-4164.6845 1754.2273,-4199.9867 1757.5871,-4203.4901 1761.4979,-4206.5124 1765.6972,-4209.1179"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1764.1696,-4212.27 1774.6382,-4213.9012 1767.4718,-4206.0978 1764.1696,-4212.27"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff9400" stroke-dasharray="5,2" d="M757.3653,-2941.9922C766.2784,-2986.2352 799.802,-3155.4999 819.7932,-3295.9867 840.8273,-3443.8019 820.5446,-3484.903 855.7932,-3629.9867 900.967,-3815.9228 1077.042,-4263.8955 1166.6023,-4432.9867 1381.5642,-4838.8383 1476.9963,-4916.8351 1754.2273,-5282.9867 1822.8258,-5373.588 1837.9573,-5398.5608 1917.23,-5479.9867 1944.0905,-5507.5769 1969.5213,-5500.7259 1982.4771,-5536.9867"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M2715.427,-3309.9867C2828.1298,-3486.1428 2879.0241,-4182.7931 2887.7293,-4314.4554"/>
<polygon fill="#a4ff00" stroke="#a4ff00" points="2884.2606,-4315.0513 2888.4028,-4324.8028 2891.2458,-4314.5966 2884.2606,-4315.0513"/>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M1073.5199,-2967.9867C1552.5267,-2768.5686 1735.4579,-2748.1723 2237.5562,-2878.9867 2514.327,-2951.0954 2561.2882,-3069.0656 2715.427,-3309.9867"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#73ff00" stroke-dasharray="5,2" d="M1073.5199,-2967.9867C1126.3959,-2945.2799 1121.1614,-2913.294 1166.6023,-2877.9867 1248.751,-2814.1578 1275.6266,-2805.4548 1371.0359,-2763.9867 1434.9099,-2736.225 1472.5363,-2766.7613 1520.2075,-2715.9867 1564.7722,-2668.521 1511.093,-2620.9303 1556.2075,-2573.9867 1582.2275,-2546.9118 1600.6772,-2558.6418 1637.2174,-2549.9867"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge224" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M757.6738,-2942.2636C767.6036,-2986.8534 804.0189,-3155.2879 819.7932,-3295.9867 856.9745,-3627.6261 795.6593,-3717.7322 855.7932,-4045.9867 858.3933,-4060.1801 1009.8107,-4527.1689 1016.4375,-4539.9867 1125.3439,-4750.6387 1219.228,-4761.0486 1335.0359,-4967.9867 1356.0749,-5005.5815 1353.4828,-5018.6435 1371.0359,-5057.9867 1392.2426,-5105.5193 1420.0208,-5159.9595 1434.9774,-5188.7177"/>
<polygon fill="#00ff52" stroke="#00ff52" points="1431.9704,-5190.5208 1439.7013,-5197.7654 1438.1756,-5187.281 1431.9704,-5190.5208"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge232" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M772.3658,-2919.8347C787.8324,-2908.7495 809.6171,-2890.2184 819.7932,-2867.9867 875.202,-2746.9358 777.9301,-2377.9719 855.7932,-2269.9867 858.1423,-2266.7288 860.988,-2263.895 864.1539,-2261.4302"/>
<polygon fill="#00ff83" stroke="#00ff83" points="866.0496,-2264.3724 872.583,-2256.0318 862.2744,-2258.4777 866.0496,-2264.3724"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge241" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M758.8549,-2919.5439C770.2057,-2884.1112 804.5373,-2772.8793 819.7932,-2677.9867 856.8472,-2447.5085 804.113,-2381.6321 855.7932,-2153.9867 889.0343,-2007.5639 945.7768,-1986.0801 980.4375,-1839.9867 1022.4596,-1662.8655 984.9656,-1611.2834 1016.4375,-1431.9867 1029.1383,-1359.6298 1054.4814,-1276.0947 1066.6663,-1237.9443"/>
<polygon fill="#00ffb4" stroke="#00ffb4" points="1070.1262,-1238.6192 1069.8653,-1228.0276 1063.4642,-1236.4701 1070.1262,-1238.6192"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge252" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00e6ff" stroke-dasharray="5,2" d="M1073.5199,-3138.9867C1132.2523,-3157.1906 1305.8096,-3118.3427 1393.5655,-3096.504"/>
<polygon fill="#00e6ff" stroke="#00e6ff" points="1394.4692,-3099.8858 1403.3179,-3094.0591 1392.7669,-3093.096 1394.4692,-3099.8858"/>
<path fill="none" stroke="#00e6ff" stroke-dasharray="5,2" d="M918.1154,-3005.9867C1003.0702,-3038.3485 988.5601,-3106.6381 1073.5199,-3138.9867"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge258" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M757.1376,-2942.0278C765.1841,-2986.4066 795.8563,-3156.1181 819.7932,-3295.9867 836.3583,-3392.7806 818.5739,-3423.1122 855.7932,-3513.9867 980.3315,-3818.0594 1323.2593,-4064.2818 1419.944,-4129.2023"/>
<polygon fill="#00b4ff" stroke="#00b4ff" points="1418.2538,-4132.2819 1428.5163,-4134.9149 1422.1356,-4126.4568 1418.2538,-4132.2819"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge266" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M771.8302,-2919.9341C787.1406,-2908.7924 809.0191,-2890.1094 819.7932,-2867.9867 884.7792,-2734.5496 765.31,-2653.6363 855.7932,-2535.9867 873.8883,-2512.4588 902.9061,-2537.4755 918.1154,-2511.9867"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge313" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M2535.3311,-2471.9867C2609.3463,-2529.9625 2675.471,-2622.062 2702.4957,-2662.201"/>
<polygon fill="#0020ff" stroke="#0020ff" points="2699.6288,-2664.2106 2708.0844,-2670.5944 2705.4553,-2660.3309 2699.6288,-2664.2106"/>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M788.8047,-2940.5999C798.9148,-2943.838 809.9348,-2947.7238 819.7932,-2951.9867 865.5538,-2971.7743 871.5256,-2988.2393 918.1154,-3005.9867"/>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M1073.5199,-2967.9867C1105.128,-2954.6195 1112.8788,-2945.3744 1130.6023,-2915.9867 1163.5596,-2861.3396 1122.3097,-2822.9286 1166.6023,-2776.9867 1232.4123,-2708.7263 1279.6457,-2741.2507 1371.0359,-2715.9867 1436.9785,-2697.7575 1471.8579,-2726.3917 1520.2075,-2677.9867 1566.2192,-2631.9223 1509.3605,-2581.2015 1556.2075,-2535.9867 1627.3903,-2467.2841 2341.1377,-2354.3867 2434.1865,-2387.9867 2489.1473,-2407.8331 2489.3291,-2435.9536 2535.3311,-2471.9867"/>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M918.1154,-3005.9867C918.2451,-3006.0362 1073.3917,-2968.0401 1073.5199,-2967.9867"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge362" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2160.6401,-2205.9867C2243.5739,-2178.0101 2272.7586,-2200.8717 2353.8713,-2167.9867"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M918.1154,-2853.9867C1006.1282,-2818.1234 1056.9115,-2890.0043 1130.6023,-2829.9867 1170.4879,-2797.5019 1132.0765,-2758.1193 1166.6023,-2719.9867 1281.8922,-2592.6527 1400.6502,-2687.3227 1520.2075,-2563.9867 1549.9061,-2533.3495 1528.4922,-2507.4291 1556.2075,-2474.9867 1677.8076,-2332.6471 1743.3717,-2327.4161 1917.23,-2257.9867 1987.6268,-2229.8741 2009.5186,-2236.465 2083.7241,-2220.9867 2117.8192,-2213.875 2127.6384,-2217.1194 2160.6401,-2205.9867"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge385" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M755.4351,-2942.117C757.2405,-2988.9434 769.7512,-3172.7507 855.7932,-3285.9867 895.0479,-3337.648 942.4361,-3309.3967 980.4375,-3361.9867 1021.859,-3419.3099 981.6761,-3455.3968 1016.4375,-3516.9867 1051.222,-3578.6175 1080.8862,-3577.6218 1130.6023,-3627.9867 1146.9458,-3644.5435 1149.4857,-3650.2306 1166.6023,-3665.9867 1237.1871,-3730.9615 1282.849,-3720.4855 1335.0359,-3800.9867 1369.5159,-3854.1742 1325.3835,-3895.0136 1371.0359,-3938.9867 1419.9404,-3986.0925 1454.0597,-3956.6546 1520.2075,-3971.9867 1608.4262,-3992.4346 1640.7033,-3973.182 1718.2273,-4019.9867 1812.0403,-4076.6259 1838.4157,-4104.1116 1881.23,-4204.9867 1906.4064,-4264.3053 1971.1237,-5279.4485 1981.1607,-5438.967"/>
<polygon fill="#7300ff" stroke="#7300ff" points="1977.6675,-5439.1878 1981.7875,-5448.9487 1984.6538,-5438.749 1977.6675,-5439.1878"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge397" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M1073.5199,-3242.9867C1218.3703,-3268.6 1230.6035,-3344.2096 1371.0359,-3387.9867 1435.8963,-3408.2057 1513.0918,-3417.3944 1567.6045,-3421.5592"/>
<polygon fill="#ff00c5" stroke="#ff00c5" points="1567.6251,-3425.0699 1577.8524,-3422.3035 1568.1322,-3418.0882 1567.6251,-3425.0699"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge412" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M759.4777,-2942.4116C772.6469,-2976.7267 813.7969,-3081.6579 855.7932,-3164.9867 880.5617,-3214.1322 882.5263,-3230.0085 918.1154,-3271.9867"/>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M918.1154,-3271.9867C979.8328,-3344.784 1045.0038,-3260.7803 1130.6023,-3302.9867 1150.6169,-3312.8554 1148.9448,-3324.3416 1166.6023,-3337.9867 1235.851,-3391.4999 1263.6983,-3389.2917 1335.0359,-3439.9867 1357.5571,-3455.9912 1702.3045,-3734.4077 1718.2273,-3756.9867 1745.2096,-3795.2484 1728.8416,-3816.6476 1754.2273,-3855.9867 1775.6143,-3889.1294 1784.7577,-3896.336 1817.7286,-3917.9867"/>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1817.7286,-3917.9867C1887.7495,-3957.9794 1903.9207,-3975.787 1982.4771,-3993.9867"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge426" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0062" stroke-dasharray="5,2" d="M918.1154,-3271.9867C941.2083,-3303.5025 957.8074,-3302.137 980.4375,-3333.9867 1001.8533,-3364.1276 997.9282,-3376.9786 1016.4375,-3408.9867 1075.5162,-3511.1518 1070.804,-3559.0616 1166.6023,-3627.9867 1229.7875,-3673.4473 1283.2187,-3617.9005 1335.0359,-3675.9867 1400.4074,-3749.2672 1307.3593,-3819.2288 1371.0359,-3893.9867 1375.2202,-3898.8992 1380.4007,-3902.8499 1386.0672,-3906.0265"/>
<polygon fill="#ff0062" stroke="#ff0062" points="1384.7636,-3909.282 1395.2984,-3910.4082 1387.7653,-3902.9582 1384.7636,-3909.282"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2160.6401,-1822.9867C2230.5514,-1733.9575 2309.0319,-1623.7057 2340.1258,-1579.5812"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2343.1302,-1581.3933 2346.0215,-1571.2006 2337.405,-1577.3656 2343.1302,-1581.3933"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M776.3692,-2919.8936C807.1167,-2904.0774 866.0583,-2874.6742 918.1154,-2853.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.1154,-2853.9867C953.8464,-2839.7873 957.3023,-2824.6966 980.4375,-2793.9867 1001.0137,-2766.6737 992.7925,-2750.691 1016.4375,-2725.9867 1057.1171,-2683.4847 1086.5247,-2697.9537 1130.6023,-2658.9867 1150.3157,-2641.559 1144.847,-2626.7871 1166.6023,-2611.9867 1230.9608,-2568.2029 1266.0816,-2600.1024 1335.0359,-2563.9867 1340.9309,-2560.8992 1516.6396,-2417.6041 1520.2075,-2411.9867 1555.1154,-2357.0281 1516.004,-2321.1989 1556.2075,-2269.9867 1606.5482,-2205.8617 1652.1825,-2231.781 1718.2273,-2183.9867 1767.8846,-2148.0515 1869.8494,-2031.8746 1917.23,-1992.9867 2019.2285,-1909.2708 2079.1447,-1926.768 2160.6401,-1822.9867"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1250.8191,-2435.9867C1269.9163,-2402.3433 1305.6895,-2439.1934 1335.0359,-2413.9867 1449.2464,-2315.8876 1598.7595,-1839.7296 1630.9446,-1733.8692"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1634.3681,-1734.6398 1633.9141,-1724.0547 1627.6681,-1732.6126 1634.3681,-1734.6398"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1250.8191,-2435.9867C1269.3072,-2401.7384 1310.7192,-2442.3752 1335.0359,-2411.9867 1423.4806,-2301.4578 1307.8136,-1902.644 1371.0359,-1775.9867 1380.8084,-1756.4088 1399.6914,-1740.5558 1416.0114,-1729.6494"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1418.1744,-1732.422 1424.7403,-1724.107 1414.4222,-1726.5126 1418.1744,-1732.422"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M788.8229,-2922.9451C799.6092,-2919.1404 811.0178,-2913.6864 819.7932,-2905.9867 844.9092,-2883.9497 835.4076,-2866.4607 855.7932,-2839.9867 915.7618,-2762.1079 941.3661,-2751.4347 1016.4375,-2687.9867 1064.9555,-2646.9809 1095.4316,-2654.8876 1130.6023,-2601.9867 1166.6491,-2547.7683 1121.2443,-2506.695 1166.6023,-2459.9867 1193.7163,-2432.0656 1232.331,-2470.2351 1250.8191,-2435.9867"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M788.6748,-2924.5962C799.9663,-2920.8953 811.7315,-2915.0848 819.7932,-2905.9867 862.9721,-2857.257 823.5477,-2820.5485 855.7932,-2763.9867 875.1436,-2730.0443 890.1006,-2729.221 918.1154,-2701.9867"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.4931,-2942.1224C786.1979,-2993.8175 902.6776,-3209.3075 1073.5199,-3242.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1073.5199,-3242.9867C1184.6158,-3279.194 1231.5296,-3215.7677 1335.0359,-3269.9867 1356.8143,-3281.3948 1350.2312,-3298.8868 1371.0359,-3311.9867 1506.2173,-3397.1054 1578.1765,-3328.1429 1718.2273,-3404.9867 1737.2562,-3415.4276 1735.7339,-3426.6243 1754.2273,-3437.9867 1887.5445,-3519.8972 1932.9227,-3520.2526 2083.7241,-3561.9867 2117.2119,-3571.2545 2132.3178,-3555.858 2160.6401,-3575.9867"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1073.5199,-1977.9867C1090.9626,-1944.8402 1114.5834,-1949.8444 1130.6023,-1915.9867 1179.7408,-1812.1273 1127.6967,-1768.0966 1166.6023,-1659.9867 1183.0083,-1614.3981 1215.8717,-1567.6616 1235.3409,-1542.2829"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1238.2288,-1544.2713 1241.6199,-1534.2338 1232.7095,-1539.9658 1238.2288,-1544.2713"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M772.3872,-2919.8444C787.8689,-2908.7662 809.6638,-2890.2398 819.7932,-2867.9867 879.0837,-2737.7336 784.035,-2348.8092 855.7932,-2224.9867 888.92,-2167.8247 935.2689,-2192.2016 980.4375,-2143.9867 1038.2663,-2082.2578 1034.1298,-2052.8403 1073.5199,-1977.9867"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge289" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1073.5199,-2967.9867C1192.0701,-2918.0635 1233.7262,-2923.2511 1335.0359,-2843.9867 1354.9358,-2828.4171 1350.07,-2814.0882 1371.0359,-2799.9867 1428.605,-2761.2664 1455.3343,-2778.5822 1520.2075,-2753.9867 1701.3671,-2685.3036 1730.0976,-2624.1628 1917.23,-2573.9867 2022.228,-2545.8335 2054.3987,-2526.9661 2160.6401,-2549.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2160.6401,-2549.9867C2258.3189,-2570.0225 2256.2812,-2684.45 2353.8713,-2663.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2353.8713,-2663.9867C2410.9694,-2652.0141 2472.4887,-2621.8424 2507.2218,-2603.0185"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2509.2071,-2605.9211 2516.2821,-2598.0347 2505.8333,-2599.7878 2509.2071,-2605.9211"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge332" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1817.7286,-3993.9867C1837.2987,-4022.8228 1857.2198,-4014.7278 1881.23,-4039.9867 2011.94,-4177.4953 2118.6486,-4384.0312 2150.7422,-4449.392"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2147.7196,-4451.1794 2155.2446,-4458.6376 2154.0131,-4448.1146 2147.7196,-4451.1794"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.1154,-3271.9867C935.9119,-3294.105 954.9196,-3273.5459 980.4375,-3285.9867 1057.9833,-3323.793 1064.1304,-3353.9945 1130.6023,-3408.9867 1392.8325,-3625.9298 1463.8278,-3673.9118 1718.2273,-3899.9867 1740.9646,-3920.1925 1796.9964,-3971.7284 1817.7286,-3993.9867"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge371" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M757.7664,-2942.2537C768.0428,-2986.8067 805.5803,-3155.1216 819.7932,-3295.9867 835.3696,-3450.3656 794.3874,-4549.4919 855.7932,-4691.9867 886.7179,-4763.7487 925.8858,-4760.0383 980.4375,-4815.9867 1156.8121,-4996.8771 1185.0313,-5058.0141 1371.0359,-5228.9867 1433.4755,-5286.3803 1475.9873,-5275.6176 1520.2075,-5347.9867 1562.2915,-5416.8598 1522.5122,-5452.6438 1556.2075,-5525.9867 1580.6673,-5579.2271 1587.2331,-5599.4191 1637.2174,-5629.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1637.2174,-5629.9867C1655.225,-5640.9866 1702.61,-5650.4752 1744.3123,-5657.089"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1743.7962,-5660.5507 1754.2143,-5658.6235 1744.8683,-5653.6333 1743.7962,-5660.5507"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge462" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2716.4561,-1833.8098C2724.1801,-1752.9158 2775.9022,-1261.1927 2889.0989,-1293.9867"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M2718.7657,-1856.2339C2731.377,-1899.2818 2776.3107,-2057.8944 2794.3784,-2191.9867 2853.8303,-2633.2189 2884.83,-4119.1615 2888.6873,-4314.6898"/>
<polygon fill="#a4ff00" stroke="#a4ff00" points="2885.1904,-4314.8905 2888.8855,-4324.8201 2892.1891,-4314.7535 2885.1904,-4314.8905"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge463" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1998.6112,-5471.0091C2013.7618,-5482.2596 2035.8275,-5501.1364 2047.7241,-5522.9867 2087.3614,-5595.7878 2035.4324,-5638.6145 2083.7241,-5705.9867 2140.4031,-5785.0602 2182.3696,-5781.073 2273.5562,-5814.9867 2530.0373,-5910.3763 2702.5364,-6001.1771 2889.0989,-5800.9867"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff9400" stroke-dasharray="5,2" d="M1999.3212,-5471.0057C2014.7675,-5482.1229 2036.8424,-5500.7889 2047.7241,-5522.9867 2112.6656,-5655.4621 2029.0333,-5715.9611 2083.7241,-5852.9867 2096.7352,-5885.5855 2123.323,-5916.711 2141.5612,-5935.5813"/>
<polygon fill="#ff9400" stroke="#ff9400" points="2139.2769,-5938.2485 2148.8025,-5942.8868 2144.2485,-5933.3206 2139.2769,-5938.2485"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge221" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff20" stroke-dasharray="5,2" d="M1982.7308,-5448.8146C1988.1865,-5208.656 2079.8295,-1176.9329 2083.7241,-1162.9867 2096.1256,-1118.578 2126.5502,-1073.3927 2145.2036,-1048.495"/>
<polygon fill="#00ff20" stroke="#00ff20" points="2148.1925,-1050.3484 2151.4881,-1040.2791 2142.6325,-1046.0954 2148.1925,-1050.3484"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge315" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M2020.1261,-5469.3409C2129.5029,-5494.0088 2449.0496,-5547.8469 2600.4756,-5377.9867 2638.966,-5334.8106 2632.2807,-3353.6764 2636.4756,-3295.9867 2653.4509,-3062.5346 2698.6847,-2781.9097 2711.8098,-2703.3378"/>
<polygon fill="#0020ff" stroke="#0020ff" points="2715.3008,-2703.6827 2713.5061,-2693.241 2708.3976,-2702.5229 2715.3008,-2703.6827"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge414" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1984.8408,-5448.7625C1996.8207,-5392.2419 2051.5216,-5138.6019 2083.7241,-5064.9867 2134.2018,-4949.5945 2198.5032,-4946.7291 2237.5562,-4826.9867 2281.3116,-4692.8259 2211.05,-4319.5042 2273.5562,-4192.9867 2284.6121,-4170.6086 2306.5342,-4152.5579 2324.6855,-4140.5396"/>
<polygon fill="#ff0094" stroke="#ff0094" points="2326.6515,-4143.4375 2333.2291,-4135.1318 2322.9076,-4137.5228 2326.6515,-4143.4375"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1985.3626,-5448.9647C1995.3197,-5410.591 2028.6708,-5279.1861 2047.7241,-5168.9867 2070.1521,-5039.2687 2019.7923,-4990.0628 2083.7241,-4874.9867 2105.0479,-4836.6043 2149.3086,-4855.4074 2160.6401,-4812.9867"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge290" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1984.7185,-5448.8182C1995.692,-5394.793 2044.7934,-5160.6157 2083.7241,-5097.9867 2132.2136,-5019.9805 2185.4322,-5035.6128 2237.5562,-4959.9867 2375.6537,-4759.6226 2387.274,-4687.7668 2434.1865,-4448.9867 2471.5086,-4259.0214 2420.6021,-2894.1261 2470.1865,-2706.9867 2480.3254,-2668.7212 2504.9566,-2629.3164 2520.8589,-2606.5411"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2523.9092,-2608.2924 2526.874,-2598.1208 2518.2132,-2604.2234 2523.9092,-2608.2924"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge334" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1983.8826,-5448.6139C1991.891,-5384.3819 2033.1885,-5060.5891 2083.7241,-4798.9867 2106.3721,-4681.7475 2141.6357,-4542.9334 2155.1316,-4490.9856"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2158.5999,-4491.5561 2157.7372,-4480.9964 2151.8265,-4489.7892 2158.5999,-4491.5561"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-1797.9922 -.2403,-1797.9922 -.2403,-1775.9813 130.719,-1775.9813 130.719,-1797.9922"/>
<text text-anchor="middle" x="65.2394" y="-1783.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge464" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1073.5199,-7206.9867C1152.2707,-7204.2141 1172.8277,-7195.7297 1250.8191,-7206.9867"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-5475.9867C336.5249,-5509.4671 401.487,-5500.6002 480.9653,-5413.9867 516.9821,-5374.7366 508.6821,-5229.6096 516.9653,-5176.9867 541.1962,-5023.0487 571.922,-4837.7958 582.1954,-4776.1091"/>
<polygon fill="#ff0000" stroke="#ff0000" points="585.6778,-4776.5036 583.8695,-4766.0643 578.7731,-4775.3528 585.6778,-4776.5036"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M755.1332,-7206.9867C824.216,-7228.7724 846.199,-7215.6517 918.1154,-7206.9867"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M918.1154,-7206.9867C1242.7233,-7167.8758 2041.118,-6817.3525 2237.5562,-6555.9867 2399.5732,-6340.4191 2384.6793,-6247.0678 2434.1865,-5981.9867 2452.9065,-5881.7525 2410.7904,-5147.8689 2470.1865,-5064.9867 2472.4358,-5061.8481 2475.1348,-5059.1035 2478.1369,-5056.7035"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2480.2287,-5059.5177 2486.69,-5051.1211 2476.4028,-5053.6557 2480.2287,-5059.5177"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M755.1332,-6575.9867C1065.917,-6504.2104 978.2043,-6245.3671 1166.6023,-5987.9867 1234.2446,-5895.577 1281.206,-5894.0678 1335.0359,-5792.9867 1363.619,-5739.3138 1334.4948,-5709.5926 1371.0359,-5660.9867 1417.7033,-5598.911 1475.7718,-5633.679 1520.2075,-5569.9867 1567.3869,-5502.3619 1535.4155,-5467.7784 1556.2075,-5387.9867 1614.8982,-5162.7555 1664.8178,-5116.5284 1718.2273,-4889.9867 1777.0707,-4640.3965 1808.1923,-4329.504 1815.8407,-4246.2862"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1819.3483,-4246.3599 1816.7646,-4236.0849 1812.3768,-4245.7285 1819.3483,-4246.3599"/>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M223.8406,-5475.9867C295.5531,-5496.2763 337.6765,-6763.7553 399.0839,-6805.9867"/>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M399.0839,-6805.9867C476.6961,-6859.3627 662.988,-6595.5295 755.1332,-6575.9867"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff9400" stroke-dasharray="5,2" d="M755.1332,-6805.9867C1198.8921,-6730.0029 1368.3636,-6775.3434 1718.2273,-6491.9867 1855.4853,-6380.8207 1801.9409,-6281.8003 1917.23,-6147.9867 1984.3315,-6070.1035 2086.1223,-6000.8411 2133.9901,-5970.3963"/>
<polygon fill="#ff9400" stroke="#ff9400" points="2135.9558,-5973.2946 2142.5495,-5965.0017 2132.2234,-5967.3727 2135.9558,-5973.2946"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ffc500" stroke-dasharray="5,2" d="M223.8406,-5475.9867C349.4024,-5513.2932 231.1509,-5959.2311 317.2024,-6057.9867 325.3649,-6067.3543 336.9274,-6073.2698 348.7992,-6076.9888"/>
<polygon fill="#ffc500" stroke="#ffc500" points="348.2141,-6080.4543 358.7763,-6079.6238 350.0016,-6073.6863 348.2141,-6080.4543"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#fff600" stroke-dasharray="5,2" d="M223.8406,-5475.9867C306.8763,-5500.658 296.3813,-4786.0706 317.2024,-4701.9867 335.3813,-4628.5732 371.7213,-4546.1692 389.2199,-4508.6212"/>
<polygon fill="#fff600" stroke="#fff600" points="392.5318,-4509.8033 393.625,-4499.265 386.1986,-4506.8214 392.5318,-4509.8033"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M1073.5199,-305.9867C1143.6546,-270.0631 1172.5266,-314.9121 1250.8191,-305.9867"/>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M1250.8191,-305.9867C1308.6583,-299.393 1314.0306,-265.7873 1371.0359,-253.9867 1435.958,-240.5474 1454.5164,-245.0334 1520.2075,-253.9867 1689.7901,-277.1 1739.8638,-291.5083 1881.23,-387.9867 1964.4868,-444.8072 1983.671,-464.1571 2047.7241,-541.9867 2092.2029,-596.032 2132.0978,-669.0734 2150.2649,-704.296"/>
<polygon fill="#d5ff00" stroke="#d5ff00" points="2147.3317,-706.2485 2154.9932,-713.5665 2153.5675,-703.068 2147.3317,-706.2485"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M1073.5199,-7206.9867C1115.2956,-7204.7547 1125.145,-7198.5977 1166.6023,-7192.9867 1483.6159,-7150.0811 1564.8715,-7154.4826 1881.23,-7106.9867 1955.5857,-7095.8235 1974.6843,-7094.8354 2047.7241,-7076.9867 2222.4341,-7034.2931 2266.6561,-7022.4074 2434.1865,-6956.9867 2615.4683,-6886.1961 2710.6005,-6883.6446 2794.3784,-6707.9867 2838.4649,-6615.5503 2826.3079,-5889.3173 2830.3784,-5786.9867 2853.577,-5203.7928 2882.8382,-4488.7851 2888.226,-4357.2835"/>
<polygon fill="#a4ff00" stroke="#a4ff00" points="2891.723,-4357.4251 2888.6355,-4347.2901 2884.7289,-4357.1384 2891.723,-4357.4251"/>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M918.1154,-7206.9867C987.0875,-7203.3355 1004.494,-7209.417 1073.5199,-7206.9867"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#73ff00" stroke-dasharray="5,2" d="M399.0839,-6043.9867C423.729,-6065.8308 739.9805,-6069.6557 819.7932,-6057.9867 893.5258,-6047.2067 912.3351,-6040.2319 980.4375,-6009.9867 991.4948,-6005.0761 1155.5505,-5901.9097 1166.6023,-5896.9867 1291.1805,-5841.4946 1622.2513,-5754.3589 1754.2273,-5719.9867 1782.1949,-5712.7028 1797.0508,-5726.1776 1817.7286,-5705.9867"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge217" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#41ff00" stroke-dasharray="5,2" d="M1817.7286,-875.9867C1842.7971,-892.776 1856.8768,-882.1759 1881.23,-899.9867 1895.8668,-910.6914 2068.9612,-1145.4567 2083.7241,-1155.9867 2090.4409,-1160.7777 2098.0872,-1164.7868 2105.8914,-1168.1217"/>
<polygon fill="#41ff00" stroke="#41ff00" points="2104.8496,-1171.4725 2115.4373,-1171.8623 2107.4036,-1164.955 2104.8496,-1171.4725"/>
<path fill="none" stroke="#41ff00" stroke-dasharray="5,2" d="M755.1332,-571.9867C800.0057,-566.8249 810.7326,-561.1053 855.7932,-557.9867 911.0585,-554.1619 925.1497,-554.5029 980.4375,-557.9867 1047.5764,-562.2173 1065.1839,-561.3035 1130.6023,-576.9867 1400.4489,-641.679 1479.4289,-646.6445 1718.2273,-787.9867 1769.0318,-818.0574 1774.4611,-835.8213 1817.7286,-875.9867"/>
<path fill="none" stroke="#41ff00" stroke-dasharray="5,2" d="M585.7192,-571.9867C659.1699,-555.4234 679.858,-573.7178 755.1332,-571.9867"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge219" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#10ff00" stroke-dasharray="5,2" d="M399.0839,-6043.9867C425.538,-6070.3656 453.3747,-6037.7989 480.9653,-6062.9867 518.644,-6097.3841 475.6183,-6142.0989 516.9653,-6171.9867 583.2395,-6219.8933 840.1483,-6146.1992 980.4375,-6115.9867 1047.8461,-6101.4697 1066.7628,-6103.0477 1130.6023,-6076.9867 1165.5698,-6062.7121 1202.8473,-6040.0054 1226.4591,-6024.5713"/>
<polygon fill="#10ff00" stroke="#10ff00" points="1228.4003,-6027.4837 1234.8062,-6019.0448 1224.5359,-6021.647 1228.4003,-6027.4837"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge222" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff20" stroke-dasharray="5,2" d="M1250.8191,-305.9867C1653.4429,-262.0784 1862.267,-387.9318 2047.7241,-747.9867 2100.3363,-850.1305 2009.8703,-915.9697 2083.7241,-1003.9867 2087.9294,-1008.9985 2093.1518,-1013.014 2098.8819,-1016.23"/>
<polygon fill="#00ff20" stroke="#00ff20" points="2097.6947,-1019.5402 2108.2308,-1020.6538 2100.6887,-1013.2128 2097.6947,-1019.5402"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge226" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M399.0839,-6043.9867C449.5328,-6090.9495 598.5399,-5908.2617 654.4731,-5867.9867 869.3273,-5713.2802 926.8957,-5679.1022 1130.6023,-5509.9867 1186.3239,-5463.7271 1194.1806,-5445.1192 1250.8191,-5399.9867"/>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M223.8406,-5475.9867C325.8842,-5504.8578 271.8873,-5848.1067 317.2024,-5943.9867 341.7478,-5995.9212 356.0963,-6005.8851 399.0839,-6043.9867"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge235" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M399.0839,-1212.9867C436.9327,-1210.6197 452.9504,-1211.427 480.9653,-1236.9867 513.0961,-1266.3017 492.9057,-1291.7529 516.9653,-1327.9867 576.685,-1417.9248 612.9522,-1422.8482 690.4731,-1497.9867 747.6507,-1553.407 782.9192,-1551.4107 819.7932,-1621.9867 834.1798,-1649.5223 900.3488,-2117.9875 915.1659,-2223.8453"/>
<polygon fill="#00ff83" stroke="#00ff83" points="911.7253,-2224.5145 916.5761,-2233.9337 918.6579,-2223.5454 911.7253,-2224.5145"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge243" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M918.1154,-989.9867C998.8716,-1040.9369 1048.2744,-1150.755 1066.0419,-1196.4187"/>
<polygon fill="#00ffb4" stroke="#00ffb4" points="1062.8038,-1197.7509 1069.6179,-1205.8637 1069.3503,-1195.2723 1062.8038,-1197.7509"/>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M223.8406,-761.9867C255.5076,-726.5878 273.4981,-795.3905 317.2024,-813.9867 476.8166,-881.9029 523.8216,-879.8561 690.4731,-927.9867 740.8443,-942.5344 873.7732,-962.0107 918.1154,-989.9867"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge251" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90</title>
<path fill="none" stroke="#00ffe6" stroke-dasharray="5,2" d="M1073.5199,-7073.9867C1187.8205,-7039.289 1221.1052,-7047.8806 1335.0359,-7011.9867 1509.7851,-6956.932 1556.9127,-6946.8541 1718.2273,-6859.9867 1796.0644,-6818.0717 1813.5724,-6802.8896 1881.23,-6745.9867 1988.7635,-6655.5465 2102.5573,-6530.5599 2144.1787,-6483.7134"/>
<polygon fill="#00ffe6" stroke="#00ffe6" points="2146.8709,-6485.9525 2150.8782,-6476.1447 2141.6293,-6481.3129 2146.8709,-6485.9525"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge253" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00e6ff" stroke-dasharray="5,2" d="M223.8406,-5475.9867C271.7645,-5489.5651 271.4631,-5433.7095 317.2024,-5413.9867 385.813,-5384.4019 432.8628,-5433.1604 480.9653,-5375.9867 526.89,-5321.4017 488.1579,-4800.2457 516.9653,-4734.9867 594.6186,-4559.075 718.5861,-4589.4862 819.7932,-4425.9867 845.5376,-4384.3968 835.986,-4366.71 855.7932,-4321.9867 1035.5043,-3916.2134 1198.149,-3868.1361 1335.0359,-3445.9867 1374.1448,-3325.3777 1317.2073,-3277.7845 1371.0359,-3162.9867 1382.8134,-3137.8694 1405.4392,-3115.366 1422.6959,-3100.6731"/>
<polygon fill="#00e6ff" stroke="#00e6ff" points="1425.1706,-3103.1693 1430.6651,-3094.1105 1420.7207,-3097.7657 1425.1706,-3103.1693"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge264" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#0083ff" stroke-dasharray="5,2" d="M585.7192,-6805.9867C600.3807,-6805.9867 1508.1382,-6323.3108 1520.2075,-6314.9867 1616.8939,-6248.3034 1631.7791,-6219.4954 1718.2273,-6139.9867 1792.0343,-6072.1045 1826.7604,-6068.1802 1881.23,-5983.9867 2074.7765,-5684.8226 2144.165,-5240.5979 2157.9354,-5139.1374"/>
<polygon fill="#0083ff" stroke="#0083ff" points="2161.4085,-5139.571 2159.2532,-5129.1977 2154.4692,-5138.6509 2161.4085,-5139.571"/>
<path fill="none" stroke="#0083ff" stroke-dasharray="5,2" d="M399.0839,-6805.9867C462.7979,-6859.1005 502.7742,-6806.8027 585.7192,-6805.9867"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge267" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M918.1154,-2283.9867C961.037,-2305.704 1016.8835,-2280.2849 1048.6076,-2261.5015"/>
<polygon fill="#0052ff" stroke="#0052ff" points="1050.5733,-2264.4017 1057.2615,-2256.1847 1046.9089,-2258.4374 1050.5733,-2264.4017"/>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M223.8406,-1327.9867C277.9221,-1304.6986 273.104,-1382.9678 317.2024,-1421.9867 528.9503,-1609.3449 685.462,-1563.1989 819.7932,-1811.9867 867.7718,-1900.8453 792.5238,-2186.28 855.7932,-2264.9867 873.9358,-2287.5561 892.2772,-2270.9133 918.1154,-2283.9867"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge316" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M1817.7286,-115.9867C1913.1557,-121.0184 2362.9902,-529.0449 2434.1865,-668.9867 2495.2799,-789.0704 2435.7511,-839.7305 2470.1865,-969.9867 2508.3844,-1114.4747 2566.4524,-1134.4592 2600.4756,-1279.9867 2659.7773,-1533.6387 2615.9444,-1605.3053 2636.4756,-1864.9867 2661.5433,-2182.0467 2702.9123,-2567.2609 2713.1043,-2660.7917"/>
<polygon fill="#0020ff" stroke="#0020ff" points="2709.6482,-2661.3857 2714.2134,-2670.9465 2716.6068,-2660.6256 2709.6482,-2661.3857"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge324" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M223.8406,-5475.9867C331.7177,-5507.8323 292.965,-4577.8237 317.2024,-4467.9867 363.9652,-4256.0712 439.6563,-4221.0326 480.9653,-4007.9867 499.5297,-3912.2434 473.9611,-3218.5199 516.9653,-3130.9867 561.5485,-3040.2398 668.341,-2975.2403 722.4798,-2946.8754"/>
<polygon fill="#1000ff" stroke="#1000ff" points="724.3458,-2949.8515 731.6372,-2942.1648 721.1437,-2943.6268 724.3458,-2949.8515"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge364" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M585.7192,-571.9867C642.8657,-559.1001 640.5669,-522.6648 690.4731,-491.9867 786.2001,-433.142 806.2608,-392.7073 918.1154,-381.9867"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M918.1154,-381.9867C966.4863,-371.7907 971.7595,-351.1428 1016.4375,-329.9867 1041.3109,-318.2086 1049.025,-318.5332 1073.5199,-305.9867"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1817.7286,-115.9867C1973.2563,-129.3803 2004.5368,-39.9867 2160.6401,-39.9867 2160.6401,-39.9867 2160.6401,-39.9867 2353.8713,-39.9867 2650.8106,-39.9867 2604.7904,-1050.7429 2636.4756,-1345.9867 2656.4675,-1532.2721 2698.0654,-1755.1035 2711.2938,-1823.7937"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2707.894,-1824.6471 2713.2307,-1833.7996 2714.7664,-1823.3167 2707.894,-1824.6471"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M223.8406,-761.9867C280.486,-699.0883 246.1133,-641.9352 317.2024,-595.9867 417.8293,-530.9465 467.6604,-592.4346 585.7192,-571.9867"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M65.3302,-1775.816C66.3779,-1674.915 79.031,-920.848 223.8406,-761.9867"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1073.5199,-305.9867C1142.3465,-270.7331 1109.4547,-211.0835 1166.6023,-158.9867 1197.6602,-130.6738 1214.141,-136.5034 1250.8191,-115.9867"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1250.8191,-115.9867C1470.7144,7.0165 1568.6299,-78.1243 1817.7286,-115.9867"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge386" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M755.1332,-6575.9867C782.4632,-6562.1048 791.1544,-6562.9163 819.7932,-6551.9867 891.4443,-6524.6422 916.5589,-6531.4264 980.4375,-6488.9867 999.5481,-6476.2901 997.767,-6465.3221 1016.4375,-6451.9867 1217.9433,-6308.0612 1308.8426,-6342.9985 1520.2075,-6213.9867 1614.9078,-6156.1841 1633.9053,-6134.0915 1718.2273,-6061.9867 1794.2066,-5997.016 1837.5648,-5996.9167 1881.23,-5906.9867 1956.1009,-5752.7873 1842.9487,-5677.4711 1917.23,-5522.9867 1926.1282,-5504.4808 1942.8918,-5488.481 1957.1985,-5477.2361"/>
<polygon fill="#7300ff" stroke="#7300ff" points="1959.3658,-5479.9856 1965.2601,-5471.1817 1955.1621,-5474.3883 1959.3658,-5479.9856"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-2351.9922 180.0456,-2351.9922 180.0456,-2329.9813 267.6355,-2329.9813 267.6355,-2351.9922"/>
<text text-anchor="middle" x="223.8406" y="-2337.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge392" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#ff00f6" stroke-dasharray="5,2" d="M65.9865,-1798.272C70.7532,-1867.2146 98.8907,-2231.4496 166.4788,-2315.9867 169.1499,-2319.3277 172.3563,-2322.2323 175.8702,-2324.7558"/>
<polygon fill="#ff00f6" stroke="#ff00f6" points="174.1504,-2327.8059 184.5201,-2329.9783 177.7684,-2321.8134 174.1504,-2327.8059"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge401" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M399.0839,-5551.9867C513.8523,-5545.3581 558.8605,-5574.8144 654.4731,-5510.9867 770.8706,-5433.2838 756.404,-5367.7582 819.7932,-5242.9867 828.9316,-5224.9992 1355.7871,-3912.198 1371.0359,-3898.9867 1396.8901,-3876.5871 1434.8447,-3912.4527 1445.6217,-3879.9867"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge417" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M755.1332,-7206.9867C826.0322,-7236.1894 1001.3251,-7099.8203 1073.5199,-7073.9867"/>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M399.0839,-6805.9867C582.1528,-6958.5978 542.2141,-7099.8895 755.1332,-7206.9867"/>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1073.5199,-7073.9867C1118.2276,-7050.0465 1125.1236,-7037.1661 1166.6023,-7007.9867 1420.7424,-6829.2045 2115.2185,-6394.6155 2237.5562,-6108.9867 2321.3888,-5913.2579 2182.8796,-4385.6404 2273.5562,-4192.9867 2284.1857,-4170.4029 2306.1337,-4152.3648 2324.4034,-4140.4036"/>
<polygon fill="#ff0094" stroke="#ff0094" points="2326.3841,-4143.2931 2333.011,-4135.0266 2322.6754,-4137.3563 2326.3841,-4143.2931"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge427" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0062" stroke-dasharray="5,2" d="M399.0839,-5551.9867C520.9586,-5549.6298 576.1787,-5545.4158 654.4731,-5451.9867 706.8745,-5389.456 645.0377,-5339.7482 690.4731,-5271.9867 728.9139,-5214.6571 785.1138,-5245.6669 819.7932,-5185.9867 878.2125,-5085.4522 813.8261,-4772.4246 855.7932,-4663.9867 987.8834,-4322.6819 1333.9761,-4013.4488 1423.9781,-3937.0071"/>
<polygon fill="#ff0062" stroke="#ff0062" points="1426.4889,-3939.468 1431.8727,-3930.343 1421.9735,-3934.1189 1426.4889,-3939.468"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge433" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M67.642,-1797.996C77.0266,-1840.0311 113.3328,-1993.9777 166.4788,-2111.9867 193.039,-2170.9629 268.2523,-2318.7076 317.2024,-2360.9867 378.2616,-2413.7248 467.488,-2444.6144 526.0691,-2460.4067"/>
<polygon fill="#ff0031" stroke="#ff0031" points="525.3556,-2463.838 535.917,-2462.9973 527.1364,-2457.0683 525.3556,-2463.838"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.1154,-381.9867C1277.9901,-350.6083 1382.132,-392.5692 1718.2273,-524.9867 1796.6619,-555.889 1815.7362,-568.9066 1881.23,-621.9867 1899.5561,-636.8393 1900.603,-644.2539 1917.23,-660.9867 1973.193,-717.3063 2011.288,-712.4448 2047.7241,-782.9867 2102.4727,-888.9824 2012.8185,-953.0446 2083.7241,-1048.9867 2128.4788,-1109.5442 2189.1376,-1062.3168 2237.5562,-1119.9867 2265.5749,-1153.3591 2331.6736,-1455.9307 2349.4203,-1538.9826"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2346.0043,-1539.7457 2351.5105,-1548.7974 2352.8507,-1538.2876 2346.0043,-1539.7457"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1322.6566,-847.9922 1178.9815,-847.9922 1178.9815,-825.9813 1322.6566,-825.9813 1322.6566,-847.9922"/>
<text text-anchor="middle" x="1250.8191" y="-833.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M918.1154,-571.9867C1016.5223,-578.6056 1052.8171,-575.3468 1130.6023,-635.9867 1193.0092,-684.6381 1230.006,-775.4771 1244.1613,-816.247"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1240.9063,-817.5484 1247.4108,-825.9115 1247.5413,-815.3175 1240.9063,-817.5484"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M755.1332,-571.9867C827.0951,-563.7086 846.813,-559.2187 918.1154,-571.9867"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1520.2934,-3193.9922 1370.95,-3193.9922 1370.95,-3171.9813 1520.2934,-3171.9813 1520.2934,-3193.9922"/>
<text text-anchor="middle" x="1445.6217" y="-3179.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-5475.9867C269.5428,-5488.9172 273.3938,-5509.6375 317.2024,-5527.9867 352.1809,-5542.6375 361.1613,-5552.1055 399.0839,-5551.9867"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-5551.9867C518.7206,-5551.612 477.0876,-5422.7824 516.9653,-5309.9867 618.9184,-5021.6088 721.6885,-4981.6965 819.7932,-4691.9867 845.9606,-4614.7128 827.821,-4588.6259 855.7932,-4511.9867 1007.417,-4096.5627 1207.3786,-4063.3903 1335.0359,-3639.9867 1362.844,-3547.7549 1311.5731,-3283.7771 1371.0359,-3207.9867 1373.5715,-3204.7549 1376.5408,-3201.9375 1379.8071,-3199.4815"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1381.8223,-3202.3497 1388.4595,-3194.0915 1378.1211,-3196.4083 1381.8223,-3202.3497"/>
</g>
<!-- sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~dataairflownetwork.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/dataairflownetwork.f90.html" xlink:title="DataAirflowNetwork.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="459.7908,-6134.9922 338.377,-6134.9922 338.377,-6112.9813 459.7908,-6112.9813 459.7908,-6134.9922"/>
<text text-anchor="middle" x="399.0839" y="-6120.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirflowNetwork.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M223.8406,-5475.9867C358.8758,-5516.1079 222.8649,-5998.37 317.2024,-6102.9867 320.5869,-6106.74 324.5426,-6109.8635 328.8545,-6112.4588"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="327.6244,-6115.756 338.1367,-6117.0765 330.7423,-6109.4887 327.6244,-6115.756"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-761.9867C659.5028,-788.9051 781.3637,-686.9507 980.4375,-856.9867 1019.231,-890.1217 980.404,-929.8695 1016.4375,-965.9867 1054.2074,-1003.8445 1082.0669,-981.5349 1130.6023,-1003.9867 1227.0499,-1048.602 1254.3216,-1058.8647 1335.0359,-1127.9867 1432.1076,-1211.1169 1458.3827,-1236.1332 1520.2075,-1347.9867 1587.0543,-1468.926 1622.4443,-1633.825 1633.4267,-1691.7921"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1630.0387,-1692.7188 1635.2998,-1701.915 1636.9218,-1691.4451 1630.0387,-1692.7188"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-761.9867C276.0008,-704.1462 321.6211,-753.8793 399.0839,-761.9867"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M585.7192,-839.9867C761.1223,-879.22 847.0658,-807.4982 980.4375,-927.9867 1008.1716,-953.0418 988.4586,-979.2053 1016.4375,-1003.9867 1056.4695,-1039.4439 1093.0815,-1003.8821 1130.6023,-1041.9867 1167.8818,-1079.8463 1137.5784,-1111.4814 1166.6023,-1155.9867 1221.0376,-1239.458 1282.3574,-1219.3958 1335.0359,-1303.9867 1417.0317,-1435.6554 1438.9786,-1627.9246 1444.1681,-1691.616"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1440.7069,-1692.2618 1444.9527,-1701.9686 1447.6869,-1691.7327 1440.7069,-1692.2618"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-761.9867C436.8057,-765.8859 445.7554,-771.9013 480.9653,-785.9867 529.5975,-805.4417 535.6545,-824.5887 585.7192,-839.9867"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M223.8406,-761.9867C333.9016,-639.94 421.3756,-685.9867 585.7192,-685.9867 585.7192,-685.9867 585.7192,-685.9867 755.1332,-685.9867 782.8825,-685.9867 892.3557,-729.43 980.4375,-776.9867 1044.9212,-811.8025 1480.0645,-1094.6775 1520.2075,-1155.9867 1558.2373,-1214.0685 1511.3245,-1255.0219 1556.2075,-1307.9867 1606.6953,-1367.5656 1673.9441,-1311.6622 1718.2273,-1375.9867 1753.2138,-1426.8072 1745.6685,-2424.8842 1754.2273,-2485.9867 1766.5047,-2573.6369 1797.0463,-2674.9119 1810.8097,-2717.9241"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1807.5187,-2719.1226 1813.9261,-2727.5604 1814.1791,-2716.9686 1807.5187,-2719.1226"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3482,-1267.9922 539.0902,-1267.9922 539.0902,-1245.9813 632.3482,-1245.9813 632.3482,-1267.9922"/>
<text text-anchor="middle" x="585.7192" y="-1253.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-1212.9867C453.0685,-1209.6106 513.7087,-1228.2446 550.8093,-1242.3095"/>
<polygon fill="#0066ff" stroke="#0066ff" points="549.5813,-1245.5873 560.1699,-1245.9517 552.1197,-1239.0637 549.5813,-1245.5873"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M223.8406,-1327.9867C277.0602,-1305.0697 267.1743,-1266.2221 317.2024,-1236.9867 349.9444,-1217.853 361.235,-1215.3538 399.0839,-1212.9867"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M223.8406,-1327.9867C329.0561,-1282.5106 382.0729,-1250.0327 480.9653,-1307.9867 489.1143,-1312.7623 550.2419,-1427.6131 575.1769,-1474.9135"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="572.1614,-1476.6988 579.9164,-1483.9176 578.3557,-1473.4384 572.1614,-1476.6988"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-1951.9922 334.3841,-1951.9922 334.3841,-1929.9813 463.7837,-1929.9813 463.7837,-1951.9922"/>
<text text-anchor="middle" x="399.0839" y="-1937.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1327.9867C314.7938,-1288.675 285.8344,-1669.9977 317.2024,-1763.9867 336.9213,-1823.0712 370.5848,-1888.6436 387.9676,-1920.8663"/>
<polygon fill="#ff0000" stroke="#ff0000" points="384.9499,-1922.6433 392.8061,-1929.7517 391.0975,-1919.2956 384.9499,-1922.6433"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node46" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node46"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-5049.9922 344.7839,-5049.9922 344.7839,-5027.9813 453.3838,-5027.9813 453.3838,-5049.9922"/>
<text text-anchor="middle" x="399.0839" y="-5035.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M223.8406,-5475.9867C267.4672,-5488.9489 367.8174,-5148.6194 393.1779,-5059.8905"/>
<polygon fill="#00ff66" stroke="#00ff66" points="396.5804,-5060.7212 395.9503,-5050.1451 389.8475,-5058.8058 396.5804,-5060.7212"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M65.4249,-1798.1507C69.1328,-2019.2104 128.2022,-5449.4134 223.8406,-5475.9867"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M223.8406,-5475.9867C311.501,-5500.3434 303.4169,-3930.9176 317.2024,-3840.9867 362.2774,-3546.9359 430.3613,-3485.1367 480.9653,-3191.9867 495.3565,-3108.6184 470.7529,-2883.8514 516.9653,-2812.9867 565.2239,-2738.9845 609.0239,-2750.2103 690.4731,-2715.9867 745.7014,-2692.7808 776.3159,-2719.1984 819.7932,-2677.9867 854.6836,-2644.9145 822.7638,-2610.9176 855.7932,-2575.9867 876.4134,-2554.1795 894.5102,-2568.5218 918.1154,-2549.9867"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node49" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node49"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.0438,-3871.9922 353.1239,-3871.9922 353.1239,-3849.9813 445.0438,-3849.9813 445.0438,-3871.9922"/>
<text text-anchor="middle" x="399.0839" y="-3857.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-5475.9867C383.4885,-5523.4208 262.8401,-4137.4103 317.2024,-3979.9867 330.8483,-3940.4707 361.4433,-3901.9583 381.127,-3879.8988"/>
<polygon fill="#ff0000" stroke="#ff0000" points="383.9225,-3882.0277 388.0786,-3872.282 378.7522,-3877.3088 383.9225,-3882.0277"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node50" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node50"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-1184.9922 168.8556,-1184.9922 168.8556,-1162.9813 278.8255,-1162.9813 278.8255,-1184.9922"/>
<text text-anchor="middle" x="223.8406" y="-1170.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M66.8782,-1775.8C74.7565,-1723.0875 110.6654,-1494.5058 166.4788,-1313.9867 179.9633,-1270.3732 201.5766,-1221.452 214.0665,-1194.5312"/>
<polygon fill="#ff0000" stroke="#ff0000" points="217.296,-1195.8878 218.3707,-1185.3477 210.9576,-1192.9171 217.296,-1195.8878"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node51" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node51"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-1184.9922 340.6161,-1184.9922 340.6161,-1162.9813 457.5516,-1162.9813 457.5516,-1184.9922"/>
<text text-anchor="middle" x="399.0839" y="-1170.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M66.9242,-1775.8149C77.2453,-1709.2615 134.4539,-1366.6214 223.8406,-1327.9867"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1327.9867C288.8055,-1299.9077 259.6148,-1240.1272 317.2024,-1198.9867 322.7279,-1195.0393 328.8892,-1191.7046 335.2832,-1188.8896"/>
<polygon fill="#00ffff" stroke="#00ffff" points="336.7659,-1192.0669 344.7709,-1185.1264 334.1849,-1185.56 336.7659,-1192.0669"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node52" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node52"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1323.4046,-5712.9922 1178.2336,-5712.9922 1178.2336,-5690.9813 1323.4046,-5690.9813 1323.4046,-5712.9922"/>
<text text-anchor="middle" x="1250.8191" y="-5698.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-6043.9867C428.4525,-6073.2718 544.6315,-6049.6378 585.7192,-6043.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-6043.9867C724.8399,-6024.8525 731.7642,-5945.8464 855.7932,-5879.9867 949.8422,-5830.0466 973.4768,-5816.4643 1073.5199,-5779.9867"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-6805.9867C632.6882,-6805.5247 643.6055,-6816.8688 690.4731,-6819.9867 747.822,-6823.802 762.4727,-6824.2055 819.7932,-6819.9867 1137.2883,-6796.6192 1224.3432,-6787.5175 1520.2075,-6669.9867 1613.1761,-6633.0554 1642.3137,-6628.1343 1718.2273,-6562.9867 1922.2468,-6387.9012 1879.8909,-6256.2891 2083.7241,-6080.9867 2113.2545,-6055.5898 2139.6813,-6071.8163 2160.6401,-6038.9867"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-839.9867C608.2039,-845.6787 962.7222,-961.0159 980.4375,-975.9867 1005.9582,-997.5538 998.4886,-1013.8038 1016.4375,-1041.9867 1062.3978,-1114.1523 1090.0299,-1121.6601 1130.6023,-1196.9867 1189.0883,-1305.5718 1230.8347,-1448.6535 1245.2742,-1501.8678"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1241.97,-1503.0597 1247.9372,-1511.8143 1248.7318,-1501.2493 1241.97,-1503.0597"/>
</g>
<!-- sourcefile~datawater.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node55" class="node">
<title>sourcefile~datawater.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node55"><a xlink:href="../sourcefile/datawater.f90.html" xlink:title="DataWater.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1112.7579,-469.9922 1034.2819,-469.9922 1034.2819,-447.9813 1112.7579,-447.9813 1112.7579,-469.9922"/>
<text text-anchor="middle" x="1073.5199" y="-455.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataWater.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M918.1154,-381.9867C971.6683,-377.3173 1026.1078,-416.6096 1054.1519,-440.8179"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1052.1803,-443.7485 1061.9776,-447.7811 1056.8335,-438.5189 1052.1803,-443.7485"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node56" class="node">
<title>sourcefile~dataheatbalfansys.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node56"><a xlink:href="../sourcefile/dataheatbalfansys.f90.html" xlink:title="DataHeatBalFanSys.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="980.2601,-6701.9922 855.9706,-6701.9922 855.9706,-6679.9813 980.2601,-6679.9813 980.2601,-6701.9922"/>
<text text-anchor="middle" x="918.1154" y="-6687.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalFanSys.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-6805.9867C661.0143,-6805.9867 680.9182,-6818.6944 755.1332,-6805.9867"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M755.1332,-6805.9867C818.4693,-6795.1418 875.6162,-6739.6008 902.2712,-6709.8548"/>
<polygon fill="#0000ff" stroke="#0000ff" points="905.011,-6712.0387 908.9605,-6702.2075 899.7422,-6707.43 905.011,-6712.0387"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node57" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node57"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-1379.9922 323.0941,-1379.9922 323.0941,-1357.9813 475.0737,-1357.9813 475.0737,-1379.9922"/>
<text text-anchor="middle" x="399.0839" y="-1365.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge237" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1327.9867C226.7059,-1326.7483 294.3138,-1343.0408 344.6981,-1355.4547"/>
<polygon fill="#ff0000" stroke="#ff0000" points="343.9736,-1358.8809 354.521,-1357.8794 345.6512,-1352.0848 343.9736,-1358.8809"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node58" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node58"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-1338.9922 317.3208,-1338.9922 317.3208,-1316.9813 480.847,-1316.9813 480.847,-1338.9922"/>
<text text-anchor="middle" x="399.0839" y="-1324.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge239" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1327.9867C257.7547,-1313.3284 298.9271,-1312.5769 332.8402,-1315.8368"/>
<polygon fill="#00ffff" stroke="#00ffff" points="332.7933,-1319.3526 343.1159,-1316.9663 333.5582,-1312.3946 332.7933,-1319.3526"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge291" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1250.8191,-115.9867C1415.8952,-24.4488 1912.495,-278.2962 2047.7241,-409.9867 2159.4219,-518.7617 2164.7415,-567.123 2237.5562,-704.9867 2342.3495,-903.3972 2386.599,-950.7066 2434.1865,-1169.9867 2496.2314,-1455.8856 2383.7033,-2206.5079 2470.1865,-2485.9867 2480.0193,-2517.7623 2502.8662,-2549.1276 2518.7069,-2568.2726"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2516.0718,-2570.5766 2525.2142,-2575.9309 2521.4061,-2566.044 2516.0718,-2570.5766"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge336" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M918.1154,-571.9867C985.8111,-584.1089 1089.0581,-742.1803 1130.6023,-796.9867 1149.3882,-821.7698 1141.3005,-838.9055 1166.6023,-856.9867 1228.8838,-901.4944 1270.7484,-851.4291 1335.0359,-892.9867 1357.7305,-907.6573 1351.0801,-923.7648 1371.0359,-941.9867 1428.2152,-994.1981 1474.3366,-969.606 1520.2075,-1031.9867 1560.0556,-1086.1769 1519.9508,-1122.3308 1556.2075,-1178.9867 1605.822,-1256.516 1676.1291,-1226.1325 1718.2273,-1307.9867 1753.644,-1376.8497 1742.2989,-1927.4743 1754.2273,-2003.9867 1788.3526,-2222.8765 1847.3971,-2267.0516 1881.23,-2485.9867 1931.1109,-2808.7697 1886.7443,-2894.7982 1917.23,-3219.9867 1936.9143,-3429.9582 1944.042,-3482.6266 1982.4771,-3689.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1982.4771,-3689.9867C2013.2641,-3862.1209 2019.0425,-3905.4893 2047.7241,-4077.9867 2063.9031,-4175.2905 2055.4573,-4202.484 2083.7241,-4296.9867 2100.893,-4354.3863 2132.6059,-4417.7509 2149.4482,-4449.4875"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2146.5436,-4451.4767 2154.3567,-4458.6326 2152.7113,-4448.1663 2146.5436,-4451.4767"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge376" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-6043.9867C859.7746,-6030.2625 885.9566,-6016.0137 980.4375,-5968.9867 1070.3284,-5924.2445 1075.7533,-5883.75 1166.6023,-5840.9867 1166.6023,-5840.9867 1556.2075,-5729.9867 1556.2075,-5729.9867 1625.7985,-5711.6995 1706.3496,-5692.605 1759.462,-5680.2988"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1760.4244,-5683.6687 1769.379,-5678.006 1758.8476,-5676.8486 1760.4244,-5683.6687"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node62" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node62"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1503.0248,-5487.9922 1388.2186,-5487.9922 1388.2186,-5465.9813 1503.0248,-5465.9813 1503.0248,-5487.9922"/>
<text text-anchor="middle" x="1445.6217" y="-5473.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge369" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-6043.9867C853.1066,-6022.7864 1054.3487,-5859.0532 1130.6023,-5793.9867 1148.5466,-5778.6751 1146.0084,-5766.4905 1166.6023,-5754.9867 1233.1989,-5717.7856 1282.1179,-5776.9297 1335.0359,-5721.9867 1406.5072,-5647.7805 1300.2294,-5567.8277 1371.0359,-5492.9867 1373.4023,-5490.4855 1376.0574,-5488.3272 1378.9182,-5486.4681"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1380.7656,-5489.4529 1388.0341,-5481.7445 1377.5451,-5483.2377 1380.7656,-5489.4529"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-6043.9867C660.3808,-6034.2399 680.4775,-6053.7782 755.1332,-6043.9867"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1335.2532,-4423.9922 1166.3849,-4423.9922 1166.3849,-4401.9813 1335.2532,-4401.9813 1335.2532,-4423.9922"/>
<text text-anchor="middle" x="1250.8191" y="-4409.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge465" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1325.9195,-4424.0909C1329.0829,-4425.5383 1332.139,-4427.1633 1335.0359,-4428.9867 1600.8639,-4596.3147 1556.9028,-4753.5972 1754.2273,-4997.9867 2110.8202,-5439.6326 2148.0304,-5822.5343 2715.427,-5838.9867"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge259" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M1258.9415,-4401.854C1288.8922,-4360.8031 1393.3814,-4217.5883 1431.536,-4165.2928"/>
<polygon fill="#00b4ff" stroke="#00b4ff" points="1434.398,-4167.3083 1437.4646,-4157.167 1428.7431,-4163.1825 1434.398,-4167.3083"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge365" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2535.3311,-5078.9867C2562.4886,-5065.8696 2582.1993,-5083.9777 2600.4756,-5059.9867 2640.8458,-5006.9935 2632.7686,-2728.5021 2636.4756,-2661.9867 2654.1735,-2344.4302 2701.0232,-1959.5852 2712.7411,-1866.1573"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2716.2415,-1866.373 2714.0193,-1856.0139 2709.2965,-1865.4978 2716.2415,-1866.373"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1335.1089,-4403.9611C1547.8389,-4383.0419 2099.368,-4340.9329 2237.5562,-4449.9867 2331.4429,-4524.0793 2393.5691,-4838.4939 2434.1865,-4950.9867 2451.5127,-4998.9729 2433.4817,-5024.552 2470.1865,-5059.9867 2491.8846,-5080.934 2508.1735,-5092.1039 2535.3311,-5078.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge466" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M227.6096,-2329.7234C238.4416,-2296.7336 269.623,-2197.2733 281.2024,-2111.9867 292.2077,-2030.9282 263.3714,-701.5808 317.2024,-639.9867 367.1518,-582.8341 584.8574,-616.2358 654.4731,-585.9867 673.0638,-577.9088 673.6705,-569.3242 690.4731,-557.9867 760.905,-510.4634 781.497,-503.2079 855.7932,-461.9867 910.6062,-431.5753 930.524,-433.9073 980.4375,-395.9867 998.9622,-381.913 996.8119,-370.4796 1016.4375,-357.9867 1061.5499,-329.2701 1089.7909,-354.544 1130.6023,-319.9867 1156.6995,-297.8888 1139.7331,-273.1393 1166.6023,-251.9867 1524.546,29.8012 1705.0876,-1.9867 2160.6401,-1.9867 2160.6401,-1.9867 2160.6401,-1.9867 2353.8713,-1.9867 2472.9946,-1.9867 2513.3247,-25.7767 2600.4756,-106.9867 2675.2014,-176.6187 2667.2496,-215.9229 2715.427,-305.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2715.427,-305.9867C2737.6567,-343.1202 2772.7451,-325.5027 2794.3784,-362.9867 2898.3277,-543.0996 2689.1648,-1236.7817 2889.0989,-1293.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2889.0989,-1293.9867C3043.7468,-1338.2346 3062.2771,-4045.1209 3063.7386,-4314.4593"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3060.2405,-4314.857 3063.7928,-4324.8386 3067.2404,-4314.8204 3060.2405,-4314.857"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-4715.9867C429.4025,-4747.243 477.8439,-4756.6745 517.777,-4758.4578"/>
<polygon fill="#ff0000" stroke="#ff0000" points="517.8956,-4761.9627 527.9944,-4758.759 518.1019,-4754.9658 517.8956,-4761.9627"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M585.7192,-3955.9867C627.6334,-3962.1023 628.3042,-3988.6794 654.4731,-4021.9867 674.1589,-4047.0423 665.2728,-4064.4867 690.4731,-4083.9867 695.9033,-4088.1886 1159.8989,-4215.5011 1166.6023,-4216.9867 1447.9667,-4279.3421 2260.3852,-4261.1015 2434.1865,-4490.9867 2499.2055,-4576.9866 2527.6055,-4928.1644 2533.9274,-5018.643"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2530.4464,-5019.0417 2534.6185,-5028.7804 2537.4302,-5018.5655 2530.4464,-5019.0417"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M224.1354,-2352.1074C227.6548,-2483.0017 262.4672,-3728.1043 317.2024,-3880.9867 338.1079,-3939.3785 353.4777,-3951.9545 399.0839,-3993.9867"/>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M399.0839,-3993.9867C399.0839,-3993.9867 585.7192,-3955.9867 585.7192,-3955.9867"/>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M585.7192,-3955.9867C944.8123,-3995.7986 1016.6819,-4095.5166 1371.0359,-4165.9867 1501.6097,-4191.9539 1655.9952,-4209.4709 1744.8223,-4218.2965"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1744.5003,-4221.7817 1754.7951,-4219.2782 1745.1861,-4214.8153 1744.5003,-4221.7817"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff9400" stroke-dasharray="5,2" d="M585.7192,-5815.9867C755.3874,-5760.3515 1193.4924,-5966.99 1371.0359,-5985.9867 1436.9581,-5993.0403 1454.0265,-5989.9319 1520.2075,-5985.9867 1572.49,-5982.8701 1586.7649,-5957.9254 1637.2174,-5971.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ffc500" stroke-dasharray="5,2" d="M224.031,-2352.1948C227.8122,-2574.134 286.9653,-6018.1944 317.2024,-6057.9867 324.9367,-6068.1652 336.7164,-6074.3263 348.9502,-6078.0205"/>
<polygon fill="#ffc500" stroke="#ffc500" points="348.2396,-6081.4505 358.7903,-6080.4839 349.9396,-6074.6601 348.2396,-6081.4505"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M399.0839,-1407.9867C420.621,-1377.461 454.4888,-1415.3431 480.9653,-1388.9867 530.1674,-1340.008 473.767,-1291.3343 516.9653,-1236.9867 570.5194,-1169.6105 612.7526,-1187.9613 690.4731,-1150.9867 974.8026,-1015.7206 1072.5186,-1030.8396 1335.0359,-856.9867 1353.1324,-845.0023 1351.337,-833.1008 1371.0359,-823.9867 1617.8289,-709.8037 1951.8841,-712.6777 2093.1341,-720.1074"/>
<polygon fill="#d5ff00" stroke="#d5ff00" points="2093.1942,-723.616 2103.3718,-720.672 2093.5797,-716.6266 2093.1942,-723.616"/>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M227.4428,-2329.6991C237.8227,-2296.6432 267.9011,-2197.0217 281.2024,-2111.9867 319.3345,-1868.2095 248.4732,-1794.9629 317.2024,-1557.9867 338.3588,-1485.0401 355.7907,-1470.3927 399.0839,-1407.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M399.0839,-5929.9867C443.941,-5992.9874 456.6099,-6009.6291 516.9653,-6057.9867 772.5832,-6262.7913 860.5892,-6289.1905 1166.6023,-6405.9867 1336.7555,-6470.9292 1380.998,-6483.2751 1556.2075,-6532.9867 1643.3263,-6557.7047 1665.1511,-6564.6745 1754.2273,-6580.9867 1820.2752,-6593.0819 2294.1006,-6686.5822 2353.8713,-6655.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#73ff00" stroke-dasharray="5,2" d="M585.7192,-2969.9867C686.3872,-2900.9384 734.2316,-3008.8289 855.7932,-3019.9867 1073.8167,-3039.9985 1138.0702,-3001.5861 1335.0359,-2905.9867 1465.8312,-2842.5039 1852.7569,-2594.6103 1956.5879,-2527.7051"/>
<polygon fill="#73ff00" stroke="#73ff00" points="1958.6928,-2530.5124 1965.2007,-2522.1519 1954.8995,-2524.6293 1958.6928,-2530.5124"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#41ff00" stroke-dasharray="5,2" d="M227.5555,-2329.7159C238.2408,-2296.7056 269.0643,-2197.1955 281.2024,-2111.9867 296.2246,-2006.5318 265.737,-1247.2484 317.2024,-1153.9867 359.8057,-1076.7842 422.8154,-1108.2729 480.9653,-1041.9867 504.2973,-1015.3902 493.12,-997.1239 516.9653,-970.9867 578.3435,-903.7094 606.3617,-896.8979 690.4731,-861.9867 1032.4969,-720.0269 1154.178,-729.815 1520.2075,-785.9867 1656.7581,-806.9421 1703.3425,-798.5206 1817.7286,-875.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge218" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#10ff00" stroke-dasharray="5,2" d="M399.0839,-5929.9867C497.2743,-6052.0954 1012.4354,-6025.8831 1190.3341,-6012.9119"/>
<polygon fill="#10ff00" stroke="#10ff00" points="1190.8443,-6016.3837 1200.5581,-6012.1537 1190.3266,-6009.4029 1190.8443,-6016.3837"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge220" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff20" stroke-dasharray="5,2" d="M755.1332,-723.9867C1028.9414,-631.6125 1846.7226,-658.3757 2047.7241,-865.9867 2091.814,-911.5264 2040.2468,-957.8619 2083.7241,-1003.9867 2088.0852,-1008.6133 2093.3099,-1012.3854 2098.9563,-1015.4605"/>
<polygon fill="#00ff20" stroke="#00ff20" points="2097.5716,-1018.6767 2108.1128,-1019.7417 2100.5365,-1012.3356 2097.5716,-1018.6767"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge227" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M399.0839,-5361.9867C427.2927,-5397.8745 444.7528,-5396.196 480.9653,-5423.9867 497.0456,-5436.3273 498.6118,-5443.3838 516.9653,-5451.9867 588.4448,-5485.4917 611.9891,-5481.493 690.4731,-5489.9867 941.2434,-5517.1258 1055.4242,-5559.4956 1250.8191,-5399.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge233" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M230.7281,-2329.8932C244.6252,-2308.3187 278.0564,-2260.3438 317.2024,-2231.9867 353.5366,-2205.6666 646.4634,-2086.7087 690.4731,-2077.9867 746.8522,-2066.8134 769.896,-2049.461 819.7932,-2077.9867 875.3546,-2109.7506 902.6324,-2186.5161 912.9819,-2223.8678"/>
<polygon fill="#00ff83" stroke="#00ff83" points="909.6376,-2224.9126 915.5629,-2233.6956 916.408,-2223.1346 909.6376,-2224.9126"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge244" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M399.0839,-1407.9867C420.621,-1377.461 446.9253,-1404.3797 480.9653,-1388.9867 533.1388,-1365.3938 530.8838,-1330.4722 585.7192,-1313.9867"/>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M585.7192,-1313.9867C618.9511,-1303.9961 626.9125,-1298.0718 654.4731,-1276.9867 672.9504,-1262.8508 670.8022,-1251.408 690.4731,-1238.9867 716.0214,-1222.8543 725.1829,-1221.9806 755.1332,-1217.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge254" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00e6ff" stroke-dasharray="5,2" d="M918.1154,-3499.9867C1048.8181,-3521.0348 1257.8111,-3181.5897 1371.0359,-3112.9867 1380.6321,-3107.1724 1391.5564,-3102.0514 1402.0285,-3097.7617"/>
<polygon fill="#00e6ff" stroke="#00e6ff" points="1403.4358,-3100.9693 1411.4675,-3094.0597 1400.8799,-3094.4526 1403.4358,-3100.9693"/>
<path fill="none" stroke="#00e6ff" stroke-dasharray="5,2" d="M399.0839,-3177.9867C511.6118,-3209.2992 565.2902,-3164.5587 654.4731,-3239.9867 685.4859,-3266.2163 665.6094,-3291.8687 690.4731,-3323.9867 768.7582,-3425.1125 793.9492,-3469.3646 918.1154,-3499.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge260" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M585.7192,-3736.9867C619.4024,-3753.8028 738.7258,-3703.1026 755.1332,-3736.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge263" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#0083ff" stroke-dasharray="5,2" d="M224.0997,-2352.3496C227.7486,-2511.0756 269.4356,-4282.8228 317.2024,-4507.9867 337.8198,-4605.1735 329.9108,-4644.6746 399.0839,-4715.9867"/>
<path fill="none" stroke="#0083ff" stroke-dasharray="5,2" d="M399.0839,-4715.9867C418.8959,-4736.4115 626.2648,-4731.2482 654.4731,-4734.9867 1204.7999,-4807.9227 1357.5363,-4785.8017 1881.23,-4969.9867 1980.7167,-5004.9766 2088.2432,-5070.8019 2135.7122,-5101.4749"/>
<polygon fill="#0083ff" stroke="#0083ff" points="2133.8333,-5104.428 2144.1236,-5106.9498 2137.6519,-5098.5613 2133.8333,-5104.428"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge268" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M918.1154,-2435.9867C986.628,-2389.5629 1040.3909,-2304.1243 1062.5315,-2265.2276"/>
<polygon fill="#0052ff" stroke="#0052ff" points="1065.6454,-2266.8302 1067.4689,-2256.3935 1059.5349,-2263.4151 1065.6454,-2266.8302"/>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M399.0839,-2245.9867C506.9137,-2208.9706 567.8742,-2195.8377 654.4731,-2269.9867 703.9288,-2312.3324 641.2584,-2369.3613 690.4731,-2411.9867 728.9237,-2445.2892 876.0046,-2464.5208 918.1154,-2435.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge318" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M399.0839,-799.9867C418.9564,-779.0117 626.3125,-757.456 654.4731,-750.9867 699.6165,-740.616 711.9622,-740.7718 755.1332,-723.9867"/>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M755.1332,-723.9867C802.222,-711.0821 808.6113,-692.547 855.7932,-679.9867 1078.3863,-620.7306 1141.028,-636.4494 1371.0359,-623.9867 1670.499,-607.7607 2207.2381,-635.6023 2237.5562,-660.9867 2291.7815,-706.3882 2245.4294,-751.0979 2273.5562,-815.9867 2324.6029,-933.7523 2381.5563,-938.9203 2434.1865,-1055.9867 2460.1774,-1113.7989 2444.5553,-1136.0142 2470.1865,-1193.9867 2491.6355,-1242.5 2519.6161,-1243.3248 2535.3311,-1293.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge325" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M585.7192,-2969.9867C623.097,-2944.3493 674.9214,-2935.3699 711.3802,-2932.3272"/>
<polygon fill="#1000ff" stroke="#1000ff" points="711.9743,-2935.7937 721.6992,-2931.5893 711.475,-2928.8116 711.9743,-2935.7937"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge366" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M227.6016,-2329.7223C238.4119,-2296.7295 269.5405,-2197.262 281.2024,-2111.9867 291.4734,-2036.8816 271.7695,-808.6672 317.2024,-747.9867 457.8635,-560.1191 612.3246,-695.6982 819.7932,-585.9867 837.7119,-576.5112 839.6482,-570.2425 855.7932,-557.9867 926.5649,-504.2634 944.5019,-491.1413 1016.4375,-438.9867 1066.8059,-402.4688 1089.2748,-404.4903 1130.6023,-357.9867 1152.7982,-333.011 1139.5566,-311.6076 1166.6023,-291.9867 1241.4063,-237.7187 1279.0101,-262.467 1371.0359,-253.9867 1755.6758,-218.542 1869.868,-202.6243 2237.5562,-320.9867 2332.2626,-351.4737 2377.9208,-345.9323 2434.1865,-427.9867 2504.1455,-530.0106 2393.0031,-607.3129 2470.1865,-703.9867 2489.4381,-728.0998 2525.8924,-698.6104 2535.3311,-727.9867"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2535.3311,-727.9867C2571.78,-820.4847 2581.4856,-844.3968 2600.4756,-941.9867 2634.9078,-1118.9348 2614.3772,-1167.0793 2636.4756,-1345.9867 2659.4429,-1531.9287 2699.0509,-1754.9898 2711.5386,-1823.7654"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2708.1282,-1824.5738 2713.3645,-1833.7842 2715.0148,-1823.3187 2708.1282,-1824.5738"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge387" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M223.8466,-2352.0562C223.9916,-2546.5447 227.6177,-5240.2962 317.2024,-5375.9867 361.4116,-5442.9488 413.5291,-5408.5042 480.9653,-5451.9867 498.7108,-5463.429 499.0547,-5471.8048 516.9653,-5482.9867 573.3767,-5518.2054 596.0053,-5510.299 654.4731,-5541.9867 671.3794,-5551.1494 672.0686,-5560.4143 690.4731,-5565.9867 745.4826,-5582.6423 762.5458,-5571.1028 819.7932,-5565.9867 959.5977,-5553.4927 994.9902,-5546.1909 1130.6023,-5509.9867 1240.2516,-5480.7138 1259.2162,-5443.3832 1371.0359,-5423.9867 1436.3589,-5412.6557 1457.8689,-5401.4171 1520.2075,-5423.9867 1539.7909,-5431.0769 1536.6746,-5446.759 1556.2075,-5453.9867 1686.1772,-5502.0794 1854.0631,-5483.0307 1934.8712,-5469.3288"/>
<polygon fill="#7300ff" stroke="#7300ff" points="1935.5019,-5472.7717 1944.752,-5467.6058 1934.2993,-5465.8758 1935.5019,-5472.7717"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge391" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#d500ff" stroke-dasharray="5,2" d="M399.0839,-3993.9867C485.9208,-4072.1043 561.8287,-3984.8531 654.4731,-4055.9867 680.9754,-4076.3355 671.3949,-4094.5557 690.4731,-4121.9867 754.386,-4213.8817 760.514,-4253.2382 855.7932,-4311.9867 948.4335,-4369.1081 1072.2841,-4394.0479 1156.4404,-4404.8579"/>
<polygon fill="#d500ff" stroke="#d500ff" points="1156.1466,-4408.3482 1166.5018,-4406.1074 1157.0094,-4401.4016 1156.1466,-4408.3482"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge402" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M399.0839,-3177.9867C430.0874,-3186.8819 633.0588,-3291.8669 654.4731,-3315.9867 683.35,-3348.5119 662.9036,-3373.3464 690.4731,-3406.9867 745.9507,-3474.6804 771.8559,-3489.1934 855.7932,-3513.9867 1132.5786,-3595.7435 1485.0156,-3481.8191 1599.4867,-3439.6126"/>
<polygon fill="#ff00c5" stroke="#ff00c5" points="1601.0449,-3442.7671 1609.1924,-3435.9945 1598.5997,-3436.2081 1601.0449,-3442.7671"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge418" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M223.8669,-2352.4422C224.3062,-2520.3931 231.2646,-4487.019 317.2024,-5058.9867 337.9291,-5196.9356 311.9358,-5253.0616 399.0839,-5361.9867"/>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M399.0839,-5361.9867C416.8897,-5384.242 626.6282,-5344.0694 654.4731,-5337.9867 804.4147,-5305.2326 837.3851,-5279.5865 980.4375,-5223.9867 1273.8546,-5109.9452 2065.1714,-4834.3925 2237.5562,-4570.9867 2329.9694,-4429.7784 2195.9268,-4342.8323 2273.5562,-4192.9867 2285.1105,-4170.6837 2307.2117,-4152.5318 2325.3091,-4140.4535"/>
<polygon fill="#ff0094" stroke="#ff0094" points="2327.2676,-4143.3557 2333.8079,-4135.0205 2323.4972,-4137.4578 2327.2676,-4143.3557"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge428" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0062" stroke-dasharray="5,2" d="M224.2248,-2352.3651C229.0333,-2486.126 282.6166,-3753.9303 585.7192,-3736.9867"/>
<path fill="none" stroke="#ff0062" stroke-dasharray="5,2" d="M585.7192,-3736.9867C628.37,-3756.6643 643.6055,-3726.1047 690.4731,-3722.9867 747.822,-3719.1715 764.5325,-3707.1851 819.7932,-3722.9867 994.384,-3772.9106 992.0115,-3889.0629 1166.6023,-3938.9867 1245.0094,-3961.4071 1340.6037,-3945.8102 1397.1039,-3932.4232"/>
<polygon fill="#ff0062" stroke="#ff0062" points="1397.9616,-3935.8166 1406.846,-3930.0444 1396.3012,-3929.0164 1397.9616,-3935.8166"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge434" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M225.0229,-2352.1569C235.4898,-2449.7292 313.9218,-3154.1748 399.0839,-3177.9867"/>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M399.0839,-3177.9867C514.8652,-3210.36 481.8926,-2764.9791 516.9653,-2649.9867 534.4954,-2592.5112 562.1398,-2527.1775 576.4491,-2494.6577"/>
<polygon fill="#ff0031" stroke="#ff0031" points="579.7427,-2495.8643 580.5967,-2485.3039 573.3436,-2493.0268 579.7427,-2495.8643"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-2969.9867C759.2759,-2854.2379 835.8022,-2866.3208 980.4375,-2715.9867 1002.2633,-2693.301 994.6112,-2677.6721 1016.4375,-2654.9867 1074.8087,-2594.318 1277.6985,-2511.6335 1335.0359,-2449.9867 1357.792,-2425.5203 1352.4259,-2411.7376 1371.0359,-2383.9867 1443.7439,-2275.5661 1467.6065,-2251.8583 1556.2075,-2155.9867 1607.3887,-2100.6057 1995.425,-1742.3133 2047.7241,-1687.9867 2100.3363,-1633.3349 2084.788,-1561.136 2160.6401,-1559.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-3177.9867C495.9296,-3206.2721 434.4334,-3042.0182 516.9653,-2983.9867 542.4749,-2966.05 558.8734,-2985.8538 585.7192,-2969.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-1250.9867C415.482,-1216.7926 452.4259,-1251.9595 480.9653,-1226.9867 510.613,-1201.0442 489.7681,-1174.4878 516.9653,-1145.9867 687.7975,-966.9654 784.1788,-985.3577 1016.4375,-899.9867 1073.8516,-878.8831 1141.5221,-861.4547 1189.3529,-850.3198"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1190.2886,-853.696 1199.2476,-848.0402 1188.717,-846.8747 1190.2886,-853.696"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M918.1154,-3499.9867C1133.1126,-3534.0201 1176.4752,-3392.1195 1335.0359,-3242.9867 1351.2911,-3227.6981 1351.9808,-3219.6005 1371.0359,-3207.9867 1377.4498,-3204.0776 1384.5505,-3200.6941 1391.7467,-3197.791"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1393.4195,-3200.9025 1401.5635,-3194.1257 1390.971,-3194.3447 1393.4195,-3200.9025"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M224.0215,-2351.9951C227.6723,-2573.4827 285.6858,-6063.3913 317.2024,-6102.9867 320.544,-6107.185 324.6014,-6110.6123 329.1018,-6113.4034"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="327.7279,-6116.6307 338.231,-6118.022 330.8879,-6110.3846 327.7279,-6116.6307"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.9455,-2329.6057C235.9776,-2296.2969 262.7669,-2196.0582 281.2024,-2111.9867 299.7053,-2027.608 290.3214,-2003.0814 317.2024,-1920.9867 343.4237,-1840.9068 351.787,-1819.7246 399.0839,-1749.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1749.9867C418.7746,-1720.9533 484.1809,-1657.4706 516.9653,-1644.9867 572.7636,-1623.7395 401.0356,-1623.3678 1250.8191,-1673.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1073.5199,-1787.9867C1151.7537,-1797.4129 1177.3503,-1816.4773 1250.8191,-1787.9867"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-1749.9867C589.1849,-1517.6153 775.4509,-1752.0734 1073.5199,-1787.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M399.0839,-1407.9867C426.1203,-1369.6665 773.2188,-1436.4883 819.7932,-1441.9867 891.5517,-1450.4583 910.8175,-1447.6448 980.4375,-1466.9867 1066.5452,-1490.9093 1081.9559,-1514.3194 1166.6023,-1542.9867 1286.9238,-1583.7362 1639.2461,-1593.4892 1718.2273,-1692.9867 1786.1795,-1778.5904 1710.3622,-2575.8801 1754.2273,-2675.9867 1762.2792,-2694.3624 1778.3758,-2710.2355 1792.3472,-2721.4523"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1790.6087,-2724.5285 1800.6808,-2727.8153 1794.8568,-2718.9648 1790.6087,-2724.5285"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-1407.9867C420.621,-1377.461 452.5662,-1413.2594 480.9653,-1388.9867 513.4012,-1361.2639 489.5381,-1332.673 516.9653,-1299.9867 526.196,-1288.9862 538.9858,-1279.9253 551.0332,-1273.0049"/>
<polygon fill="#0066ff" stroke="#0066ff" points="552.9029,-1275.9727 560.0299,-1268.1333 549.5698,-1269.8172 552.9029,-1275.9727"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M227.3171,-2329.6784C237.3563,-2296.5666 266.6032,-2196.8085 281.2024,-2111.9867 309.6777,-1946.5441 245.2966,-1887.6828 317.2024,-1735.9867 369.412,-1625.8427 497.3937,-1543.899 555.7908,-1510.9232"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="557.5059,-1513.9743 564.5434,-1506.0544 554.1031,-1507.857 557.5059,-1513.9743"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node44"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-2141.9922 334.8633,-2141.9922 334.8633,-2119.9813 463.3044,-2119.9813 463.3044,-2141.9922"/>
<text text-anchor="middle" x="399.0839" y="-2127.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.2029,-2329.9275C233.6098,-2297.9641 259.4126,-2204.6505 317.2024,-2155.9867 321.7181,-2152.1841 326.8037,-2148.9597 332.1735,-2146.2255"/>
<polygon fill="#ff0000" stroke="#ff0000" points="333.7385,-2149.3595 341.4285,-2142.0715 330.8721,-2142.9733 333.7385,-2149.3595"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node45" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node45"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-2351.9922 354.6193,-2351.9922 354.6193,-2329.9813 443.5485,-2329.9813 443.5485,-2351.9922"/>
<text text-anchor="middle" x="399.0839" y="-2337.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M267.6098,-2340.9867C290.8508,-2340.9867 319.6377,-2340.9867 344.3447,-2340.9867"/>
<polygon fill="#cbff00" stroke="#cbff00" points="344.6556,-2344.4868 354.6555,-2340.9867 344.6555,-2337.4868 344.6556,-2344.4868"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M223.9368,-2352.4551C225.3043,-2509.2399 241.9284,-4228.6983 317.2024,-4729.9867 333.8632,-4840.9396 375.2744,-4969.3569 391.9543,-5018.4599"/>
<polygon fill="#00ff66" stroke="#00ff66" points="388.6535,-5019.6246 395.2069,-5027.9494 395.2753,-5017.3548 388.6535,-5019.6246"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M918.1154,-2549.9867C943.3358,-2534.3366 958.7804,-2546.2837 980.4375,-2525.9867 1008.2961,-2499.8778 993.5772,-2478.5675 1016.4375,-2447.9867 1036.6307,-2420.9739 1040.0278,-2401.9542 1073.5199,-2397.9867"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-3177.9867C614.8013,-3238.3028 366.2988,-2853.7325 516.9653,-2687.9867 580.3768,-2618.2289 838.0125,-2599.6931 918.1154,-2549.9867"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node48" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node48"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="819.9536,-2179.9922 690.3127,-2179.9922 690.3127,-2157.9813 819.9536,-2157.9813 819.9536,-2179.9922"/>
<text text-anchor="middle" x="755.1332" y="-2165.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M240.4566,-2329.7806C270.69,-2309.9045 337.29,-2268.46 399.0839,-2245.9867"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M399.0839,-2245.9867C452.8982,-2226.4155 461.6274,-2208.7087 516.9653,-2193.9867 570.4926,-2179.7465 632.8096,-2173.5571 680.2713,-2170.8957"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="680.665,-2174.3801 690.4696,-2170.3651 680.3012,-2167.3895 680.665,-2174.3801"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.1997,-2352.3137C228.2384,-2478.1017 265.9426,-3611.8594 317.2024,-3750.9867 330.6447,-3787.4713 360.2616,-3822.1744 379.9443,-3842.5196"/>
<polygon fill="#ff0000" stroke="#ff0000" points="377.6698,-3845.1967 387.1963,-3849.8333 382.6405,-3840.2679 377.6698,-3845.1967"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M227.5478,-2329.7148C238.2125,-2296.7016 268.9855,-2197.1843 281.2024,-2111.9867 295.6129,-2011.4914 255.2026,-1279.3795 317.2024,-1198.9867 321.1339,-1193.889 326.0789,-1189.8005 331.5819,-1186.5258"/>
<polygon fill="#00ffff" stroke="#00ffff" points="333.2333,-1189.6135 340.6234,-1182.0216 330.1119,-1183.3479 333.2333,-1189.6135"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8633,-2352.236C224.2759,-2534.6145 231.2356,-4882.4108 317.2024,-5565.9867 337.8931,-5730.5112 295.1721,-5800.7631 399.0839,-5929.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-5929.9867C440.3902,-5981.3549 458.9289,-5871.2385 516.9653,-5839.9867 545.4619,-5824.6417 555.6489,-5827.9575 585.7192,-5815.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1073.5199,-5779.9867C1100.0582,-5772.6976 1106.9698,-5770.0906 1130.6023,-5755.9867 1148.2449,-5745.4576 1148.4102,-5736.5352 1166.6023,-5726.9867 1174.6353,-5722.7705 1183.4822,-5719.1638 1192.3311,-5716.1111"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1193.4604,-5719.4244 1201.8954,-5713.0133 1191.3034,-5712.765 1193.4604,-5719.4244"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5815.9867C787.6934,-5735.5828 863.8934,-5837.5638 1073.5199,-5779.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-3177.9867C445.6004,-3191.5726 446.5018,-3215.9188 480.9653,-3249.9867 497.9749,-3266.8011 498.4863,-3274.802 516.9653,-3289.9867 571.9415,-3335.1621 608.948,-3317.2999 654.4731,-3371.9867 683.8936,-3407.328 658.8698,-3435.5832 690.4731,-3468.9867 745.5514,-3527.2023 778.8219,-3518.669 855.7932,-3540.9867 1063.549,-3601.2254 1634.0582,-3575.7224 1817.7286,-3689.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1073.5199,-1445.9867C1099.9941,-1453.5054 1106.8503,-1456.0852 1130.6023,-1469.9867 1148.0961,-1480.2255 1148.5747,-1488.7201 1166.6023,-1497.9867 1174.7707,-1502.1855 1183.7561,-1505.7922 1192.7222,-1508.8531"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1191.813,-1512.2371 1202.4043,-1511.9625 1193.9534,-1505.5724 1191.813,-1512.2371"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M227.5752,-2329.7187C238.3141,-2296.716 269.2682,-2197.2243 281.2024,-2111.9867 321.7919,-1822.0844 201.3571,-1015.8455 399.0839,-799.9867"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-799.9867C424.6991,-772.0225 445.0194,-788.071 480.9653,-775.9867 484.4829,-774.8042 977.4852,-588.2353 980.4375,-585.9867 1018.9812,-556.6307 1048.7709,-507.05 1063.4534,-479.3192"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1066.6989,-480.6617 1068.1674,-470.1692 1060.4762,-477.4558 1066.6989,-480.6617"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge236" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M227.5038,-2329.7084C238.0489,-2296.6777 268.5304,-2197.1178 281.2024,-2111.9867 292.9629,-2032.9792 268.084,-1456.9778 317.2024,-1393.9867 319.7015,-1390.7818 322.601,-1387.9762 325.7867,-1385.5213"/>
<polygon fill="#ff0000" stroke="#ff0000" points="327.6968,-1388.4544 334.2301,-1380.1137 323.9215,-1382.5596 327.6968,-1388.4544"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge238" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M227.5159,-2329.7102C238.094,-2296.6844 268.656,-2197.1364 281.2024,-2111.9867 293.5743,-2028.0212 263.6085,-1414.7968 317.2024,-1348.9867 318.216,-1347.7421 319.2924,-1346.5655 320.4245,-1345.4534"/>
<polygon fill="#00ffff" stroke="#00ffff" points="322.9241,-1347.9407 328.6272,-1339.0118 318.6007,-1342.4354 322.9241,-1347.9407"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge292" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1250.9867C415.1984,-1216.658 455.5977,-1255.1758 480.9653,-1226.9867 540.796,-1160.5015 460.303,-1098.1921 516.9653,-1028.9867 613.167,-911.4895 1016.3477,-838.9844 1166.6023,-816.9867 1411.5349,-781.1279 1499.956,-777.2156 1718.2273,-893.9867 1815.6516,-946.107 1827.0075,-979.2065 1917.23,-1042.9867 1974.149,-1083.224 2001.7373,-1077.6033 2047.7241,-1129.9867 2071.5901,-1157.1724 2060.8768,-1174.9396 2083.7241,-1202.9867 2208.4233,-1356.0665 2344.3598,-1300.1617 2434.1865,-1475.9867 2485.2748,-1575.9858 2436.5471,-2378.8503 2470.1865,-2485.9867 2480.1507,-2517.7213 2502.9654,-2549.0967 2518.7631,-2568.2551"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2516.1185,-2570.5482 2525.251,-2575.9194 2521.4613,-2566.0255 2516.1185,-2570.5482"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M227.5258,-2329.7116C238.1308,-2296.6898 268.7582,-2197.1514 281.2024,-2111.9867 294.1315,-2023.5035 274.04,-1386.3031 317.2024,-1307.9867 338.6049,-1269.1529 380.1953,-1291.1036 399.0839,-1250.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge338" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1313.9867C604.8578,-1308.233 614.066,-1315.5025 1073.5199,-1445.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1073.5199,-1445.9867C1356.4909,-1532.8175 1535.2949,-1380.2897 1718.2273,-1612.9867 1778.227,-1689.3087 1728.3198,-2392.425 1754.2273,-2485.9867 1785.7009,-2599.6497 1848.0257,-2605.8172 1881.23,-2718.9867 1944.0802,-2933.1976 1893.8688,-2997.9717 1917.23,-3219.9867 1939.2989,-3429.721 1943.6607,-3482.6976 1982.4771,-3689.9867"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge377" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.0022,-2351.9976C226.9439,-2551.0666 269.6183,-5383.474 317.2024,-5451.9867 342.7476,-5488.7673 646.5263,-5595.382 690.4731,-5603.9867 973.5547,-5659.4141 1104.1243,-5700.8658 1335.0359,-5527.9867 1363.3579,-5506.7826 1343.4251,-5479.109 1371.0359,-5456.9867 1397.7319,-5435.5974 1412.1576,-5430.8922 1445.6217,-5437.9867"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge467" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2889.0989,-5800.9867C3007.5694,-5706.2072 3056.4294,-4532.0271 3063.0523,-4357.5923"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3066.5582,-4357.497 3063.435,-4347.373 3059.5631,-4357.235 3066.5582,-4357.497"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1645.7643,-3436.359C1669.1907,-3466.4402 1738.0149,-3547.7245 1817.7286,-3575.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1817.7286,-3575.9867C2085.1586,-3670.803 2210.0307,-3236.0239 2434.1865,-3409.9867 2669.4192,-3592.5461 2539.1293,-3767.6125 2600.4756,-4058.9867 2610.5808,-4106.9831 2850.7989,-5831.6278 2889.0989,-5800.9867"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1817.7286,-3575.9867C1824.6461,-3578.9581 2076.2305,-3627.2611 2083.7241,-3627.9867 2151.7756,-3634.5761 2178.4387,-3662.3314 2237.5562,-3627.9867 2327.8011,-3575.5584 2301.9739,-3333.4354 2353.8713,-3423.9867"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M1640.4322,-3436.2597C1652.2508,-3478.0324 1693.8688,-3628.0849 1718.2273,-3753.9867 1739.8848,-3865.928 1730.1539,-3896.54 1754.2273,-4007.9867 1770.0605,-4081.2858 1797.6256,-4166.0303 1810.5956,-4204.319"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1807.3021,-4205.5051 1813.8449,-4213.8383 1813.9268,-4203.2438 1807.3021,-4205.5051"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M1696.6372,-3432.8764C1715.0596,-3434.9756 1735.452,-3436.947 1754.2273,-3437.9867 1810.5866,-3441.1079 1824.9802,-3442.6851 1881.23,-3437.9867 2255.0217,-3406.7651 2496.481,-3005.4252 2715.427,-3309.9867"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge319" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M1817.7286,-3423.9867C1995.1969,-3337.2959 1922.4919,-3182.0677 2083.7241,-3067.9867 2142.1899,-3026.6189 2169.9318,-3043.5768 2237.5562,-3019.9867 2326.02,-2989.1271 2362.2978,-3004.0716 2434.1865,-2943.9867 2500.4757,-2888.582 2457.2833,-2815.034 2535.3311,-2777.9867"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge367" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1817.7286,-3423.9867C1883.9394,-3386.3326 1870.5295,-3156.1596 1917.23,-3095.9867 1929.5428,-3080.1219 2523.2475,-2737.0268 2535.3311,-2720.9867"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1679.732,-3436.0482C1718.4231,-3443.6261 1775.7402,-3448.4117 1817.7286,-3423.9867"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge419" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1645.2997,-3436.3202C1661.3633,-3459.3264 1697.5359,-3513.6042 1718.2273,-3563.9867 1742.6343,-3623.4165 1717.6288,-3651.1838 1754.2273,-3703.9867 1895.1434,-3907.2952 2045.1754,-3824.4833 2237.5562,-3979.9867 2283.1119,-4016.8099 2322.762,-4074.1976 2341.8215,-4104.1981"/>
<polygon fill="#ff0094" stroke="#ff0094" points="2339.0008,-4106.2888 2347.2676,-4112.9154 2344.9375,-4102.5799 2339.0008,-4106.2888"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1643.8552,-3413.8734C1659.7494,-3386.6716 1700.02,-3314.1298 1718.2273,-3247.9867 1757.618,-3104.8888 1720.9348,-3060.6251 1754.2273,-2915.9867 1767.6414,-2857.7094 1794.3708,-2792.2093 1808.4926,-2759.6598"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1811.7864,-2760.8639 1812.6018,-2750.3005 1805.3769,-2758.0498 1811.7864,-2760.8639"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1817.7286,-3689.9867C1894.1324,-3738.1333 2161.4966,-3735.1972 2287.3776,-3730.9005"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2287.7817,-3734.3885 2297.6513,-3730.536 2287.5334,-3727.3929 2287.7817,-3734.3885"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1659.0343,-3436.1221C1677.7384,-3446.8371 1703.8705,-3464.8144 1718.2273,-3487.9867 1760.7367,-3556.5981 1701.9533,-3604.4888 1754.2273,-3665.9867 1773.7678,-3688.9753 1792.1103,-3674.0492 1817.7286,-3689.9867"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge293" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1644.9918,-3413.7416C1708.3664,-3322.5801 2143.1313,-2706.8494 2353.8713,-2663.9867"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge378" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1638.8088,-3436.2148C1648.1361,-3502.4791 1696.0597,-3849.2793 1718.2273,-4133.9867 1748.0616,-4517.1602 1728.0593,-4614.5454 1754.2273,-4997.9867 1771.6767,-5253.674 1805.9361,-5563.1453 1815.309,-5645.8369"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1811.8538,-5646.4305 1816.462,-5655.9707 1818.809,-5645.6391 1811.8538,-5646.4305"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge468" class="edge">
<title>sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2361.5049,-4135.0935C2377.3746,-4158.6821 2414.1165,-4215.9669 2434.1865,-4268.9867 2555.2136,-4588.7088 2546.3264,-4682.4403 2600.4756,-5019.9867 2613.1403,-5098.9341 2597.9561,-5307.9201 2636.4756,-5377.9867 2657.9695,-5417.084 2698.7141,-5398.6194 2715.427,-5439.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2715.427,-5439.9867C2753.7598,-5520.334 2828.4059,-5866.1132 2889.0989,-5800.9867"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge469" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1478.5725,-3907.9715C1500.3329,-3901.2906 1529.6326,-3893.4133 1556.2075,-3889.9867 1627.6251,-3880.7782 1646.2846,-3886.9029 1718.2273,-3889.9867 2050.037,-3904.2098 2200.2038,-3868.2919 2434.1865,-4103.9867 2532.9447,-4203.4675 2559.5518,-4237.9165 2600.4756,-4371.9867 2631.8974,-4474.9278 2579.795,-5248.4908 2636.4756,-5339.9867 2678.5596,-5407.9203 2745.3987,-5362.8439 2794.3784,-5425.9867 2899.7394,-5561.8141 2775.704,-5930.1828 2889.0989,-5800.9867"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff9400" stroke-dasharray="5,2" d="M1982.4771,-5536.9867C2029.7593,-5676.6789 2015.5623,-5722.2064 2083.7241,-5852.9867 2100.0357,-5884.2833 2126.0342,-5915.9434 2143.2198,-5935.2679"/>
<polygon fill="#ff9400" stroke="#ff9400" points="2140.6887,-5937.6873 2149.9915,-5942.7576 2145.8811,-5932.9926 2140.6887,-5937.6873"/>
<path fill="none" stroke="#ff9400" stroke-dasharray="5,2" d="M1469.2265,-3930.1725C1523.0625,-3957.0043 1655.1314,-4030.5597 1718.2273,-4133.9867 1767.514,-4214.7778 1868.8193,-4876.1659 1881.23,-4969.9867 1896.1293,-5082.6209 1866.6263,-5378.263 1917.23,-5479.9867 1934.3803,-5514.4624 1970.1318,-5500.5135 1982.4771,-5536.9867"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge320" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M1495.8764,-3910.3495C1505.0785,-3906.6703 1513.7872,-3901.4344 1520.2075,-3893.9867 1580.0356,-3824.5846 1495.6153,-3759.7227 1556.2075,-3690.9867 1656.2369,-3577.5133 1753.3344,-3670.7631 1881.23,-3589.9867 2187.5623,-3396.5133 2189.3677,-3258.0733 2434.1865,-2990.9867 2534.7328,-2881.2952 2654.723,-2748.9921 2698.4373,-2700.7456"/>
<polygon fill="#0020ff" stroke="#0020ff" points="2701.1197,-2702.9978 2705.2398,-2693.2369 2695.932,-2698.2981 2701.1197,-2702.9978"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge396" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M1496.0513,-3910.9608C1505.3571,-3907.2434 1514.0624,-3901.8373 1520.2075,-3893.9867 1581.2237,-3816.0371 1494.2572,-3527.196 1556.2075,-3449.9867 1559.7193,-3445.61 1563.9818,-3441.9823 1568.6936,-3438.9778"/>
<polygon fill="#ff00c5" stroke="#ff00c5" points="1570.4286,-3442.019 1577.5947,-3434.2154 1567.1263,-3435.8469 1570.4286,-3442.019"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge410" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1495.7604,-3908.5155C1514.6207,-3905.0674 1536.3125,-3901.6834 1556.2075,-3899.9867 1614.2501,-3895.0368 1771.1062,-3883.0612 1817.7286,-3917.9867"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2160.6401,-3765.9867C2202.8889,-3757.3275 2250.4171,-3747.9757 2287.7645,-3740.7163"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2288.8657,-3744.0679 2298.0156,-3738.7265 2287.5318,-3737.1962 2288.8657,-3744.0679"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1495.7384,-3910.229C1504.9505,-3906.5586 1513.6982,-3901.3567 1520.2075,-3893.9867 1573.6385,-3833.4913 1493.7336,-3767.0904 1556.2075,-3715.9867 1611.9442,-3670.3941 1646.3481,-3711.668 1718.2273,-3715.9867 1915.7508,-3727.8545 1966.7902,-3805.7179 2160.6401,-3765.9867"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge331" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1495.7953,-3910.1171C1580.6996,-3898.3946 1750.063,-3890.0064 1817.7286,-3993.9867"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge470" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M591.5448,-2462.8518C605.4607,-2435.6164 640.5139,-2363.0999 654.4731,-2297.9867 671.2638,-2219.6664 649.7467,-1646.9604 690.4731,-1577.9867 724.8361,-1519.7903 765.0345,-1537.5988 819.7932,-1497.9867 965.9445,-1392.2619 1029.4004,-1386.3056 1130.6023,-1236.9867 1159.2256,-1194.7544 1130.9707,-1164.5005 1166.6023,-1127.9867 1343.1255,-947.0929 2051.0644,-915.5853 2237.5562,-744.9867 2265.7278,-719.2159 2245.2702,-692.6321 2273.5562,-666.9867 2364.8084,-584.2534 2418.5427,-536.8429 2535.3311,-575.9867"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M2353.8713,-3423.9867C2424.7647,-3534.3514 2411.2584,-3578.8336 2434.1865,-3707.9867 2481.695,-3975.6002 2526.9978,-4869.8063 2534.3065,-5018.8423"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2530.8163,-5019.1314 2534.7997,-5028.9488 2537.808,-5018.7901 2530.8163,-5019.1314"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1073.5199,-2739.9867C1118.1518,-2758.3966 1121.316,-2779.251 1166.6023,-2795.9867 1468.693,-2907.6256 1572.1429,-2825.5036 1881.23,-2915.9867 2046.4692,-2964.3594 2127.9668,-2935.1933 2237.5562,-3067.9867 2285.8841,-3126.5474 2250.6056,-3162.6113 2273.5562,-3234.9867 2301.1443,-3321.9872 2304.5438,-3347.195 2353.8713,-3423.9867"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M587.5014,-2485.1719C595.8666,-2537.9213 631.7807,-2767.1583 654.4731,-2955.9867 674.0812,-3119.1491 638.4941,-3168.0874 690.4731,-3323.9867 773.6736,-3573.5274 818.7351,-3644.4742 1016.4375,-3817.9867 1151.1365,-3936.2047 1207.3675,-3936.9663 1371.0359,-4009.9867 1380.3882,-4014.1592 1710.4426,-4127.3329 1718.2273,-4133.9867 1743.6266,-4155.6966 1729.1788,-4177.873 1754.2273,-4199.9867 1758.3352,-4203.6134 1763.0315,-4206.7456 1767.9695,-4209.4437"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1766.5189,-4212.6301 1777.0439,-4213.8444 1769.5734,-4206.3316 1766.5189,-4212.6301"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M609.9922,-2485.0398C656.4957,-2505.5394 761.8822,-2548.7511 855.7932,-2563.9867 1071.9076,-2599.0482 1166.3539,-2589.5615 1335.0359,-2449.9867 1360.7791,-2428.6857 1352.4259,-2411.7376 1371.0359,-2383.9867 1443.7439,-2275.5661 1453.3427,-2236.3629 1556.2075,-2155.9867 1911.0952,-1878.6857 2190.4389,-2028.7059 2434.1865,-1649.9867 2460.6586,-1608.8562 2442.8399,-1586.5411 2470.1865,-1545.9867 2490.4057,-1516.0022 2695.423,-1301.8582 2715.427,-1331.9867"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#41ff00" stroke-dasharray="5,2" d="M591.4446,-2462.8297C605.1379,-2435.5451 639.7342,-2362.9279 654.4731,-2297.9867 678.4423,-2192.3767 639.405,-1907.4857 690.4731,-1811.9867 734.4214,-1729.8021 777.6792,-1733.8195 855.7932,-1682.9867 971.8891,-1607.4373 1022.1075,-1622.0963 1130.6023,-1535.9867 1194.0537,-1485.627 1301.7882,-1304.0218 1371.0359,-1261.9867 1584.7027,-1132.2857 1669.0845,-1157.9813 1917.23,-1127.9867 1974.8083,-1121.027 1992.8659,-1109.1645 2047.7241,-1127.9867 2066.8968,-1134.565 2065.9291,-1146.281 2083.7241,-1155.9867 2092.4834,-1160.7642 2102.2515,-1164.958 2111.8085,-1168.5273"/>
<polygon fill="#41ff00" stroke="#41ff00" points="2110.6553,-1171.8318 2121.25,-1171.8869 2113.002,-1165.2369 2110.6553,-1171.8318"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge231" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M587.7744,-2485.1436C597.3695,-2537.7657 637.9865,-2766.5156 654.4731,-2955.9867 665.3434,-3080.9118 655.5937,-3963.5381 690.4731,-4083.9867 747.4872,-4280.8729 1045.7466,-4708.4311 1166.6023,-4873.9867 1214.3404,-4939.3814 1377.1522,-5129.4347 1429.3655,-5190.1233"/>
<polygon fill="#00ff52" stroke="#00ff52" points="1426.7989,-5192.5066 1435.9756,-5197.8018 1432.1039,-5187.9396 1426.7989,-5192.5066"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge249" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M591.5721,-2462.8576C605.5485,-2435.635 640.7258,-2363.145 654.4731,-2297.9867 692.4938,-2117.7801 620.6134,-1640.3969 690.4731,-1469.9867 747.7235,-1330.3349 767.1849,-1218.4723 918.1154,-1217.9867"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge262" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M755.1332,-3736.9867C768.4924,-3764.576 799.7787,-3737.7691 819.7932,-3760.9867 870.5033,-3819.8126 805.4423,-3872.8531 855.7932,-3931.9867 894.2784,-3977.185 928.7542,-3950.7836 980.4375,-3979.9867 998.085,-3989.9583 998.5155,-3998.5176 1016.4375,-4007.9867 1138.0889,-4072.2616 1295.0418,-4113.3349 1381.4525,-4132.7633"/>
<polygon fill="#00b4ff" stroke="#00b4ff" points="1380.857,-4136.2163 1391.3782,-4134.9694 1382.3758,-4129.3831 1380.857,-4136.2163"/>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M587.6989,-2485.1506C596.9539,-2537.8037 636.2702,-2766.6728 654.4731,-2955.9867 662.1289,-3035.6085 657.2581,-3602.22 690.4731,-3674.9867 707.0058,-3711.2061 737.7816,-3701.1525 755.1332,-3736.9867"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge272" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M635.4304,-2475.5016C669.216,-2476.1593 714.9064,-2476.3236 755.1332,-2473.9867"/>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M755.1332,-2473.9867C792.2602,-2471.83 888.0479,-2457.8732 918.1154,-2435.9867"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge321" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M588.574,-2462.8172C597.8237,-2428.5554 629.9344,-2323.4321 690.4731,-2259.9867 735.7375,-2212.5491 778.5014,-2239.9199 819.7932,-2188.9867 854.5909,-2146.0641 826.8276,-2117.0423 855.7932,-2069.9867 1066.4784,-1727.7216 1189.6035,-1662.7143 1556.2075,-1497.9867 1755.0731,-1408.6297 2416.5738,-1377.151 2535.3311,-1559.9867"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge329" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M589.907,-2485.2834C612.2899,-2545.6619 717.8886,-2830.5182 747.4348,-2910.22"/>
<polygon fill="#1000ff" stroke="#1000ff" points="744.1824,-2911.516 750.9401,-2919.6758 750.7459,-2909.0828 744.1824,-2911.516"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge368" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M591.5019,-2462.8425C605.3223,-2435.5863 640.1797,-2363.0274 654.4731,-2297.9867 683.0004,-2168.1767 619.3094,-1813.2372 690.4731,-1700.9867 809.8856,-1512.631 945.9029,-1584.9801 1130.6023,-1459.9867 1245.2475,-1382.4019 1246.749,-1322.9433 1371.0359,-1261.9867 1446.8028,-1224.8268 1472.8219,-1232.9605 1556.2075,-1219.9867 1715.3378,-1195.2281 1756.3328,-1195.882 1917.23,-1188.9867 1975.1742,-1186.5036 1990.7211,-1178.2929 2047.7241,-1188.9867 2064.5971,-1192.1521 2066.8512,-1199.8214 2083.7241,-1202.9867 2181.8122,-1221.3882 2535.042,-1179.7809 2535.3311,-1179.9867"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge390" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M587.7273,-2485.1479C597.1106,-2537.7889 636.9175,-2766.6116 654.4731,-2955.9867 671.5762,-3140.4796 634.408,-3612.3888 690.4731,-3788.9867 748.1573,-3970.6842 1274.0076,-4771.716 1754.2273,-5225.9867 1803.7497,-5272.8331 1832.9127,-5263.8984 1881.23,-5311.9867 1921.2756,-5351.8426 1955.4266,-5409.5696 1971.9149,-5439.7988"/>
<polygon fill="#7300ff" stroke="#7300ff" points="1969.0017,-5441.7724 1976.8124,-5448.9308 1975.1705,-5438.4639 1969.0017,-5441.7724"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge405" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M586.9573,-2485.1815C596.8828,-2573.5819 665.4502,-3159.5795 755.1332,-3309.9867"/>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M755.1332,-3309.9867C772.9194,-3339.8159 1336.4836,-3413.484 1371.0359,-3416.9867 1437.5827,-3423.7329 1513.9268,-3425.409 1567.7407,-3425.5911"/>
<polygon fill="#ff00c5" stroke="#ff00c5" points="1567.8499,-3429.0912 1577.856,-3425.6087 1567.8622,-3422.0912 1567.8499,-3429.0912"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge424" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1982.4771,-3993.9867C2109.7137,-4023.4646 2254.0456,-4081.4192 2318.974,-4108.8757"/>
<polygon fill="#ff0094" stroke="#ff0094" points="2317.7603,-4112.1628 2328.3325,-4112.855 2320.4994,-4105.7209 2317.7603,-4112.1628"/>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M590.2977,-2485.1233C603.5216,-2516.7178 643.8183,-2609.0872 690.4731,-2677.9867 753.2343,-2770.672 776.7165,-2788.763 855.7932,-2867.9867 1070.5812,-3083.1741 1141.3455,-3118.7838 1371.0359,-3317.9867 1524.8804,-3451.4111 1613.4268,-3442.3813 1718.2273,-3616.9867 1755.7381,-3679.4826 1718.2644,-3713.5875 1754.2273,-3776.9867 1762.86,-3792.2054 1966.2115,-3987.5396 1982.4771,-3993.9867"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge430" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0062" stroke-dasharray="5,2" d="M755.1332,-3309.9867C810.556,-3394.5457 790.904,-3436.4541 855.7932,-3513.9867 1038.4137,-3732.1901 1118.5768,-3762.7336 1371.0359,-3893.9867 1378.7,-3897.9713 1387.13,-3901.513 1395.4795,-3904.5875"/>
<polygon fill="#ff0062" stroke="#ff0062" points="1394.5986,-3907.9871 1405.1935,-3907.9806 1396.907,-3901.3787 1394.5986,-3907.9871"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M600.1144,-2462.8014C640.6211,-2430.5952 756.7264,-2333.1401 819.7932,-2226.9867 846.2832,-2182.3991 819.3541,-2152.8916 855.7932,-2115.9867 901.0907,-2070.1104 1088.1222,-2071.4836 1130.6023,-2022.9867 1185.2202,-1960.6329 1108.8047,-1899.4051 1166.6023,-1839.9867 1220.1109,-1784.9777 1265.0806,-1833.5369 1335.0359,-1801.9867 1353.0273,-1793.8725 1353.2906,-1784.6259 1371.0359,-1775.9867 1433.0726,-1745.7845 1461.7235,-1769.5975 1520.2075,-1732.9867 1540.4805,-1720.2959 1535.5385,-1705.0218 1556.2075,-1692.9867 1793.9107,-1554.5779 1885.5998,-1563.5368 2160.6401,-1559.9867"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M626.2738,-2462.978C663.0372,-2451.4412 717.1259,-2430.422 755.1332,-2397.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-2397.9867C785.4184,-2372.1415 799.8141,-2370.4252 819.7932,-2335.9867 852.8973,-2278.9243 815.2353,-2244.0162 855.7932,-2191.9867 905.5823,-2128.1151 942.0496,-2138.0019 1016.4375,-2105.9867 1065.5582,-2084.8461 1095.2025,-2108.0695 1130.6023,-2067.9867 1184.6082,-2006.8365 1111.2733,-1947.9426 1166.6023,-1887.9867 1219.3919,-1830.7827 1264.9979,-1873.9531 1335.0359,-1839.9867 1352.7942,-1831.3745 1353.4251,-1822.897 1371.0359,-1813.9867 1402.1083,-1798.2655 1413.7373,-1803.9879 1445.6217,-1789.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1445.6217,-1789.9867C1477.5061,-1775.9856 1489.4195,-1782.2579 1520.2075,-1765.9867 1538.1285,-1756.5157 1538.2301,-1747.3503 1556.2075,-1737.9867 1564.0798,-1733.8865 1572.7385,-1730.3307 1581.3763,-1727.2904"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1582.6857,-1730.5437 1591.0767,-1724.0753 1580.4834,-1723.8992 1582.6857,-1730.5437"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M918.1154,-2473.9867C929.908,-2472.5659 1327.3549,-2388.047 1335.0359,-2378.9867 1421.8424,-2276.5923 1310.8979,-1896.001 1371.0359,-1775.9867 1380.8386,-1756.4239 1399.7213,-1740.5708 1416.0337,-1729.6606"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1418.1956,-1732.4337 1424.7577,-1724.1157 1414.4407,-1726.526 1418.1956,-1732.4337"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M593.259,-2485.2741C615.0011,-2517.1081 681.0173,-2608.8649 755.1332,-2663.9867"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M755.1332,-2663.9867C871.8685,-2750.8057 946.7756,-2668.5686 1073.5199,-2739.9867"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1073.5199,-2739.9867C1314.9272,-2838.4433 1638.1433,-2781.0669 1764.2151,-2752.3493"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1765.0637,-2755.7455 1774.0184,-2750.0829 1763.487,-2748.9254 1765.0637,-2755.7455"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M918.1154,-2473.9867C947.5838,-2470.4362 953.5644,-2462.5897 980.4375,-2449.9867 1023.3414,-2429.8657 1026.4063,-2403.0766 1073.5199,-2397.9867"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M755.1332,-2473.9867C827.4478,-2469.7859 846.199,-2482.6517 918.1154,-2473.9867"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M589.8686,-2462.8691C605.588,-2421.0202 662.0245,-2273.263 690.4731,-2231.9867 702.2582,-2214.8878 719.1654,-2198.612 732.7356,-2186.8879"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="735.2767,-2189.3242 740.678,-2180.2096 730.7716,-2183.9665 735.2767,-2189.3242"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-2663.9867C1012.7457,-2877.4674 1146.8186,-2867.3779 1335.0359,-3143.9867 1359.7368,-3180.2878 1339.3081,-3205.6346 1371.0359,-3235.9867 1414.3154,-3277.3898 1827.1304,-3384.2853 1881.23,-3409.9867 1960.0363,-3447.4258 1983.4608,-3454.9754 2047.7241,-3513.9867 2067.3658,-3532.0232 2061.0414,-3547.9651 2083.7241,-3561.9867 2113.2796,-3580.2569 2131.6039,-3556.9022 2160.6401,-3575.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2160.6401,-3575.9867C2229.6503,-3616.2082 2301.0254,-3678.8513 2334.4297,-3709.641"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2332.3716,-3712.5064 2342.0797,-3716.7495 2337.1366,-3707.3785 2332.3716,-3712.5064"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M591.078,-2462.738C603.9576,-2435.2497 636.8836,-2362.2144 654.4731,-2297.9867 680.6433,-2202.4272 658.3543,-2171.7144 690.4731,-2077.9867 690.6679,-2077.4184 855.3758,-1774.4188 855.7932,-1773.9867 954.2984,-1672.0149 1012.3966,-1690.2743 1130.6023,-1611.9867 1165.8889,-1588.6164 1204.9724,-1558.9293 1228.7153,-1540.4413"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1231.0133,-1543.0874 1236.7331,-1534.1691 1226.7003,-1537.5739 1231.0133,-1543.0874"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge294" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-2397.9867C790.5797,-2369.6637 797.0195,-2358.2297 819.7932,-2318.9867 842.2479,-2280.2935 823.7127,-2256.1673 855.7932,-2224.9867 882.0363,-2199.4799 1131.4241,-2126.0761 1166.6023,-2115.9867 1256.1242,-2090.3111 1278.4745,-2080.2719 1371.0359,-2069.9867 1671.7769,-2036.5693 1749.5934,-2093.2189 2047.7241,-2144.9867 2132.5862,-2159.7223 2156.9515,-2153.629 2237.5562,-2183.9867 2331.6758,-2219.4346 2375.738,-2214.1404 2434.1865,-2295.9867 2484.1347,-2365.9299 2438.303,-2406.1726 2470.1865,-2485.9867 2482.5375,-2516.9049 2504.8001,-2548.5187 2519.8204,-2567.9495"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2517.2089,-2570.2902 2526.1504,-2575.9737 2522.7047,-2565.9548 2517.2089,-2570.2902"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge382" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.8209,-2485.1397C597.6259,-2537.7441 639.0449,-2766.4265 654.4731,-2955.9867 662.2985,-3052.134 651.4831,-4603.7523 690.4731,-4691.9867 859.0355,-5073.4432 1036.8195,-5088.544 1371.0359,-5337.9867 1432.365,-5383.7598 1475.6458,-5361.7719 1520.2075,-5423.9867 1568.2215,-5491.0216 1500.6676,-5545.0415 1556.2075,-5605.9867 1581.5009,-5633.7417 1605.1718,-5610.4119 1637.2174,-5629.9867"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M2355.0193,-1571.0973C2362.9744,-1648.4823 2410.2854,-2115.0886 2434.1865,-2495.9867 2467.45,-3026.0883 2527.3991,-4802.9479 2534.6143,-5018.5121"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2531.1262,-5018.93 2534.9585,-5028.8074 2538.1223,-5018.696 2531.1262,-5018.93"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M2356.6831,-1548.8114C2369.0522,-1502.5501 2423.0728,-1328.6142 2535.3311,-1331.9867"/>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M2535.3311,-1331.9867C2615.3376,-1334.3904 2672.5641,-1264.388 2715.427,-1331.9867"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge300" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M2380.1139,-1548.8877C2422.3758,-1532.9262 2503.9455,-1510.5046 2535.3311,-1559.9867"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge344" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2535.3311,-1331.9867C2641.288,-1335.17 2699.9521,-1727.6644 2712.7465,-1823.879"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2709.2859,-1824.4087 2714.0507,-1833.8716 2716.227,-1823.5027 2709.2859,-1824.4087"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge276" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2355.1937,-1571.0683C2367.5104,-1674.2188 2461.9037,-2463.2184 2470.1865,-2485.9867 2481.5067,-2517.1046 2503.8258,-2548.4546 2519.1572,-2567.791"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2516.626,-2570.2264 2525.645,-2575.7859 2522.0615,-2565.8155 2516.626,-2570.2264"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1322.7873,-827.1088C1360.2712,-824.4972 1406.3539,-825.3181 1445.6217,-837.9867"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1445.6217,-837.9867C1522.2948,-862.7231 2003.4758,-1174.6611 2047.7241,-1241.9867 2092.5325,-1310.1645 2029.1439,-1361.3485 2083.7241,-1421.9867 2131.6387,-1475.2195 2169.6216,-1447.3056 2237.5562,-1469.9867 2325.5456,-1499.3636 2379.8789,-1464.7816 2434.1865,-1539.9867 2460.7329,-1576.7482 2468.8963,-3126.6607 2470.1865,-3171.9867 2491.8288,-3932.2922 2528.4519,-4866.314 2534.4797,-5018.5613"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2530.9942,-5018.9982 2534.8877,-5028.8517 2537.9887,-5018.7208 2530.9942,-5018.9982"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M1253.932,-825.8272C1264.3049,-790.6915 1301.0592,-681.289 1371.0359,-623.9867 1509.6351,-510.4912 1577.3096,-527.1134 1754.2273,-498.9867 2137.4733,-438.0578 2341.1451,-425.3043 2600.4756,-713.9867 2763.6412,-895.6201 2746.9245,-988.4835 2794.3784,-1227.9867 2858.0568,-1549.3761 2886.1431,-4056.2406 2888.8763,-4314.5135"/>
<polygon fill="#a4ff00" stroke="#a4ff00" points="2885.3795,-4314.8498 2888.9844,-4324.8124 2892.3791,-4314.7762 2885.3795,-4314.8498"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#73ff00" stroke-dasharray="5,2" d="M1445.6217,-837.9867C1487.3446,-852.6471 1696.9932,-1089.1945 1718.2273,-1127.9867 1860.4053,-1387.73 1824.7706,-1483.3091 1881.23,-1773.9867 1935.7265,-2054.5588 1971.6634,-2400.7923 1980.4045,-2489.4996"/>
<polygon fill="#73ff00" stroke="#73ff00" points="1976.9406,-2490.0406 1981.3964,-2499.6529 1983.9074,-2489.3599 1976.9406,-2490.0406"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge309" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M2353.8713,-1069.9867C2386.7754,-1116.5357 2409.9468,-1118.3929 2434.1865,-1169.9867 2468.1373,-1242.2506 2431.4925,-1276.1477 2470.1865,-1345.9867 2489.5573,-1380.9491 2519.7654,-1371.1723 2535.3311,-1407.9867"/>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M2535.3311,-1407.9867C2561.744,-1470.4561 2582.3229,-1480.6374 2600.4756,-1545.9867 2608.2638,-1574.0243 2698.5216,-2506.8439 2713.3665,-2660.6242"/>
<polygon fill="#0020ff" stroke="#0020ff" points="2709.8924,-2661.0617 2714.3368,-2670.6793 2716.86,-2660.3893 2709.8924,-2661.0617"/>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M1257.4777,-825.6055C1273.3307,-799.7163 1316.1236,-736.6056 1371.0359,-709.9867 1477.9224,-658.1733 1518.4346,-685.9867 1637.2174,-685.9867 1637.2174,-685.9867 1637.2174,-685.9867 1982.4771,-685.9867 2096.1596,-685.9867 2155.9408,-625.8498 2237.5562,-704.9867 2292.2611,-758.0305 2224.8883,-987.3547 2273.5562,-1045.9867 2297.3509,-1074.6532 2332.3668,-1039.5645 2353.8713,-1069.9867"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge356" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1254.8112,-825.7402C1266.6659,-794.2945 1305.012,-705.572 1371.0359,-671.9867 1542.6665,-584.681 2073.1823,-571.6842 2237.5562,-671.9867 2267.4196,-690.2097 2251.5516,-714.7893 2273.5562,-741.9867 2368.0756,-858.8123 2448.0624,-833.6498 2535.3311,-955.9867"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1254.5001,-848.2543C1267.0334,-886.8958 1308.726,-1017.7427 1335.0359,-1127.9867 1387.0699,-1346.0203 1430.305,-1614.4656 1442.3072,-1691.4412"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1438.9145,-1692.4038 1443.9056,-1701.7494 1445.8319,-1691.3311 1438.9145,-1692.4038"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge340" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1296.1915,-848.0814C1309.0014,-851.8464 1322.7821,-856.5115 1335.0359,-861.9867 1423.2728,-901.4127 1455.1447,-904.5236 1520.2075,-975.9867 1544.5613,-1002.7362 1537.7669,-1017.8646 1556.2075,-1048.9867 1620.1323,-1156.8725 1672.3453,-1163.2796 1718.2273,-1279.9867 1724.7322,-1296.5329 2045.9442,-3657.6714 2047.7241,-3675.9867 2074.4659,-3951.1537 2018.5101,-4028.325 2083.7241,-4296.9867 2097.8566,-4355.2083 2130.857,-4418.2244 2148.6927,-4449.692"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2145.8862,-4451.8325 2153.9075,-4458.7542 2151.9534,-4448.3411 2145.8862,-4451.8325"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1637.2174,-3233.9867C1777.07,-3237.6706 2321.0465,-3366.0515 2353.8713,-3423.9867"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M1637.2174,-3233.9867C2037.0203,-3259.0576 2179.736,-2973.5333 2535.3311,-3157.9867"/>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M1478.3895,-3194.0325C1516.1764,-3206.2229 1580.3984,-3225.2702 1637.2174,-3233.9867"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge314" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M1483.8994,-3171.9071C1536.9679,-3156.2894 1635.6878,-3126.3064 1718.2273,-3095.9867 1808.1805,-3062.9438 1828.2086,-3048.4637 1917.23,-3012.9867 2190.2449,-2904.1845 2270.9126,-2906.2755 2535.3311,-2777.9867"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge363" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1470.6466,-3171.9125C1485.8976,-3164.4601 1505.2606,-3153.6906 1520.2075,-3140.9867 1539.7234,-3124.3996 1534.5511,-3109.6615 1556.2075,-3095.9867 1618.7463,-3056.4974 1652.8343,-3092.5448 1718.2273,-3057.9867 1737.4175,-3047.8454 1735.5463,-3036.038 1754.2273,-3024.9867 1805.5176,-2994.6445 1826.9942,-3006.6813 1881.23,-2981.9867 1898.088,-2974.311 1900.5445,-2969.0307 1917.23,-2960.9867 1919.3039,-2959.9869 2533.7427,-2722.6534 2535.3311,-2720.9867"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2535.3311,-2720.9867C2570.7476,-2674.6072 2581.3208,-2662.1092 2600.4756,-2606.9867 2698.1795,-2325.8204 2712.8812,-1957.8278 2715.056,-1866.2916"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2718.5594,-1866.164 2715.2719,-1856.0922 2711.561,-1866.0158 2718.5594,-1866.164"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge398" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M1500.5121,-3194.0299C1507.8975,-3197.4885 1514.7832,-3202.0284 1520.2075,-3207.9867 1567.5257,-3259.964 1518.2931,-3302.7994 1556.2075,-3361.9867 1568.8105,-3381.661 1589.7598,-3397.7107 1607.197,-3408.6863"/>
<polygon fill="#ff00c5" stroke="#ff00c5" points="1605.562,-3411.7875 1615.9326,-3413.9557 1609.1777,-3405.7936 1605.562,-3411.7875"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge415" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1491.128,-3194.1005C1501.1646,-3197.6573 1511.4154,-3202.2177 1520.2075,-3207.9867 1540.2045,-3221.1081 1539.6097,-3230.7658 1556.2075,-3247.9867 1625.7913,-3320.183 1670.449,-3316.831 1718.2273,-3404.9867 1758.1406,-3478.6307 1712.2721,-3517.4867 1754.2273,-3589.9867 1791.6294,-3654.6189 1826.9132,-3648.743 1881.23,-3699.9867 1928.1526,-3744.2547 1924.436,-3775.8333 1982.4771,-3803.9867"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1459.0916,-3171.8907C1475.6658,-3157.5714 1503.6399,-3131.1336 1520.2075,-3102.9867 1546.5157,-3058.2916 1519.0684,-3028.1871 1556.2075,-2991.9867 1609.9883,-2939.5653 1660.954,-2992.5681 1718.2273,-2943.9867 1776.9396,-2894.1847 1803.8877,-2801.6328 1813.436,-2760.1077"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1816.8713,-2760.7817 1815.5892,-2750.2647 1810.033,-2759.2858 1816.8713,-2760.7817"/>
</g>
<!-- sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M402.3573,-6135.1643C414.0099,-6173.9238 456.0566,-6305.3479 516.9653,-6399.9867 633.1047,-6580.4419 667.2521,-6641.4946 855.7932,-6743.9867 1195.588,-6928.7013 1349.3394,-6976.1833 1718.2273,-6859.9867 1730.4729,-6856.1295 2228.0738,-6499.8097 2237.5562,-6484.9867 2475.0666,-6113.7052 2372.7295,-5949.4318 2434.1865,-5512.9867 2448.113,-5414.086 2410.3586,-5144.9613 2470.1865,-5064.9867 2472.6073,-5061.7508 2475.5033,-5058.9338 2478.7097,-5056.4813"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2480.6377,-5059.4033 2487.2251,-5051.1053 2476.9008,-5053.4842 2480.6377,-5059.4033"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1982.4771,-1673.9867C2012.9233,-1668.7208 2020.7988,-1665.1435 2047.7241,-1649.9867 2103.6481,-1618.5061 2096.4644,-1559.9867 2160.6401,-1559.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1718.3882,-1702.3386C1730.3995,-1700.8333 1742.6321,-1699.3394 1754.2273,-1697.9867 1855.5438,-1686.1676 1881.9657,-1691.3709 1982.4771,-1673.9867"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge395" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M1447.1386,-1724.0268C1455.8355,-1787.7618 1499.6926,-2115.1843 1520.2075,-2383.9867 1534.8311,-2575.5961 1511.3818,-3061.1214 1556.2075,-3247.9867 1570.71,-3308.4434 1606.2043,-3373.4158 1625.0304,-3405.1923"/>
<polygon fill="#ff00c5" stroke="#ff00c5" points="1622.1424,-3407.1813 1630.2961,-3413.9464 1628.1408,-3403.5731 1622.1424,-3407.1813"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1459.6278,-1701.9335C1519.7666,-1654.4765 1753.1047,-1470.3757 1754.2273,-1469.9867 1929.0374,-1409.4237 1975.6362,-1559.9867 2160.6401,-1559.9867"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1499.5017,-1712.9867C1513.9379,-1712.9867 1529.9561,-1712.9867 1545.8134,-1712.9867"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1546.1925,-1716.4868 1556.1925,-1712.9867 1546.1924,-1709.4868 1546.1925,-1716.4868"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge351" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1982.4771,-2587.9867C2266.728,-2423.0534 2406.4036,-2447.1992 2600.4756,-2181.9867 2675.7816,-2079.076 2704.3644,-1923.1932 2712.6256,-1866.5329"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2716.1399,-1866.6721 2714.0522,-1856.2849 2709.2067,-1865.7068 2716.1399,-1866.6721"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1860.7906,-2727.8738C1868.3238,-2724.3979 1875.5535,-2719.8699 1881.23,-2713.9867 1914.6102,-2679.3909 1883.4613,-2646.2035 1917.23,-2611.9867 1938.9339,-2589.9949 1956.0093,-2603.9291 1982.4771,-2587.9867"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1818.9576,-2727.8512C1828.5875,-2645.3921 1898.6107,-2124.5088 2160.6401,-1822.9867"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1825.4929,-2750.017C1857.5299,-2796.0038 1980.8949,-2977.8184 2047.7241,-3143.9867 2072.0179,-3204.3923 2052.2863,-3228.972 2083.7241,-3285.9867 2131.667,-3372.9345 2183.4231,-3364.7519 2237.5562,-3447.9867 2295.3202,-3536.8047 2334.1544,-3659.0466 2348.1173,-3707.2492"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2344.7516,-3708.2095 2350.856,-3716.8689 2351.484,-3706.2927 2344.7516,-3708.2095"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge281" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1982.4771,-2587.9867C1999.9845,-2577.8283 2140.858,-2545.7003 2160.6401,-2549.9867"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge242" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M621.2917,-1245.9073C655.2656,-1236.0189 708.1091,-1222.434 755.1332,-1217.9867"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge323" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M616.2197,-1268.0793C630.4624,-1274.952 646.0932,-1285.3171 654.4731,-1299.9867 692.4591,-1366.4835 679.9256,-2602.1349 690.4731,-2677.9867 702.6762,-2765.7448 733.9323,-2866.9629 748.0379,-2909.9422"/>
<polygon fill="#1000ff" stroke="#1000ff" points="744.7615,-2911.1817 751.2325,-2919.5707 751.4053,-2908.9773 744.7615,-2911.1817"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M622.6908,-1245.9313C633.2553,-1242.1423 644.5797,-1237.4547 654.4731,-1231.9867 672.2137,-1222.1819 671.8806,-1212.0602 690.4731,-1203.9867 955.0615,-1089.094 1047.1295,-1110.1749 1335.0359,-1127.9867 1498.6298,-1138.1078 1944.2602,-1190.8623 2047.7241,-1317.9867 2088.8225,-1368.4836 2040.1953,-1411.5692 2083.7241,-1459.9867 2139.0714,-1521.5501 2235.7946,-1545.309 2297.2431,-1554.413"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2296.7758,-1557.8816 2307.1644,-1555.8012 2297.7459,-1550.9491 2296.7758,-1557.8816"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M632.6773,-1258.2295C680.1725,-1260.0866 755.5457,-1264.6824 819.7932,-1275.9867 943.0184,-1297.6682 1272.6231,-1394.5471 1335.0359,-1502.9867 1423.7395,-1657.1056 1304.0153,-2938.2774 1371.0359,-3102.9867 1381.43,-3128.5313 1404.0363,-3150.8402 1421.6528,-3165.3632"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1419.8156,-3168.3733 1429.8248,-3171.8472 1424.1666,-3162.8898 1419.8156,-3168.3733"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M614.2398,-1268.1404C628.5029,-1275.168 644.7544,-1285.6544 654.4731,-1299.9867 704.6713,-1374.0147 665.3029,-1412.1587 690.4731,-1497.9867 732.9461,-1642.8151 785.0459,-1665.1133 819.7932,-1811.9867 844.7256,-1917.3735 794.0125,-2209.0421 855.7932,-2297.9867 886.1673,-2341.7158 1020.585,-2403.7055 1073.5199,-2397.9867"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M632.3627,-1266.1767C729.3203,-1286.4979 957.9639,-1340.8099 1130.6023,-1431.9867 1148.5259,-1441.4529 1150.4862,-1447.6931 1166.6023,-1459.9867 1187.1243,-1475.6413 1210.6608,-1493.2167 1227.6254,-1505.8183"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1225.7305,-1508.7706 1235.8469,-1511.9183 1229.9015,-1503.1489 1225.7305,-1508.7706"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge327" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M588.2164,-1506.1663C598.4884,-1552.6697 637.7273,-1735.4805 654.4731,-1887.9867 692.836,-2237.3623 638.687,-2330.3473 690.4731,-2677.9867 703.5278,-2765.6221 734.3351,-2866.9049 748.1809,-2909.9216"/>
<polygon fill="#1000ff" stroke="#1000ff" points="744.8937,-2911.1313 751.3144,-2919.559 751.5507,-2908.9668 744.8937,-2911.1313"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-1483.9867C933.8446,-1423.9772 980.2763,-1409.6494 1166.6023,-1380.9867 1211.4824,-1374.0828 1944.0015,-1307.8719 1982.4771,-1331.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M654.6044,-1491.2686C685.3894,-1489.4126 722.1059,-1486.9317 755.1332,-1483.9867"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1250.8191,-1673.9867C1370.6532,-1670.3354 1403.0184,-1634.6835 1520.2075,-1659.9867 1552.7777,-1667.0192 1587.1877,-1683.8969 1610.1951,-1696.732"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1608.601,-1699.8521 1619.0207,-1701.7706 1612.0716,-1693.7731 1608.601,-1699.8521"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-1483.9867C977.7496,-1405.8392 1016.2965,-1648.2135 1250.8191,-1673.9867"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge229" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M585.7192,-1987.9867C688.083,-2007.2984 743.6373,-1928.9124 819.7932,-1999.9867 917.3243,-2091.0099 759.8293,-2205.3129 855.7932,-2297.9867 932.6805,-2372.238 1261.976,-2260.9665 1335.0359,-2338.9867 1369.7314,-2376.0379 1368.7248,-4115.2795 1371.0359,-4165.9867 1389.7967,-4577.6153 1433.9234,-5079.2439 1443.6868,-5187.6847"/>
<polygon fill="#00ff52" stroke="#00ff52" points="1440.2285,-5188.3047 1444.6143,-5197.9491 1447.2001,-5187.6747 1440.2285,-5188.3047"/>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M438.148,-1952.0395C475.7307,-1962.3837 534.2705,-1977.7393 585.7192,-1987.9867"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge270" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M585.7192,-1901.9867C690.9001,-1879.2024 749.1987,-1882.7552 819.7932,-1963.9867 908.1713,-2065.6814 769.3109,-2161.6751 855.7932,-2264.9867 874.3806,-2287.1912 892.3262,-2270.8168 918.1154,-2283.9867"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge438" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M405.7021,-1952.1019C421.2152,-1978.6376 460.1793,-2048.163 480.9653,-2110.9867 507.5513,-2191.34 493.4695,-2216.6762 516.9653,-2297.9867 533.6466,-2355.7144 561.6568,-2420.9394 576.2431,-2453.377"/>
<polygon fill="#ff0031" stroke="#ff0031" points="573.1565,-2455.0453 580.4758,-2462.7055 579.531,-2452.1529 573.1565,-2455.0453"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.0486,-1929.9233C485.6045,-1921.6399 538.7911,-1910.3448 585.7192,-1901.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1901.9867C638.7603,-1892.54 640.3935,-1860.8519 690.4731,-1840.9867 717.8954,-1830.1091 728.8944,-1839.4712 755.1332,-1825.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-1825.9867C782.3971,-1811.9754 793.014,-1816.9036 819.7932,-1801.9867 837.5011,-1792.1229 837.1912,-1782.0383 855.7932,-1773.9867 1068.5298,-1681.9072 1139.9309,-1711.0416 1371.0359,-1692.9867 1437.133,-1687.823 1454.1464,-1687.3816 1520.2075,-1692.9867 1537.8027,-1694.4797 1556.7276,-1697.2137 1574.1211,-1700.1908"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1573.7072,-1703.6718 1584.1635,-1701.9643 1574.9246,-1696.7785 1573.7072,-1703.6718"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M918.1154,-1787.9867C984.7934,-1769.9723 1004.9472,-1779.7246 1073.5199,-1787.9867"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M755.1332,-1825.9867C821.2878,-1791.9889 846.3105,-1807.3863 918.1154,-1787.9867"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M918.1154,-2397.9867C976.8902,-2434.2634 1004.9308,-2406.1118 1073.5199,-2397.9867"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M585.7192,-1987.9867C694.8376,-2010.7028 751.2474,-1990.0987 819.7932,-2077.9867 901.2952,-2182.4869 774.3186,-2269.4652 855.7932,-2373.9867 874.0411,-2397.3964 892.8574,-2382.3972 918.1154,-2397.9867"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-2102.9922 166.6166,-2102.9922 166.6166,-2080.9813 281.0645,-2080.9813 281.0645,-2102.9922"/>
<text text-anchor="middle" x="223.8406" y="-2088.8367" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge265" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M755.1332,-2091.9867C788.8334,-2110.2058 798.9719,-2116.8291 819.7932,-2148.9867 849.1319,-2194.2992 817.5273,-2226.9119 855.7932,-2264.9867 876.3203,-2285.4114 892.2772,-2270.9133 918.1154,-2283.9867"/>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M281.3831,-2085.25C401.6035,-2072.2488 674.9062,-2048.6142 755.1332,-2091.9867"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge328" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M226.3145,-2103.014C235.0445,-2140.6997 266.6357,-2267.2221 317.2024,-2360.9867 446.129,-2600.0525 672.3849,-2844.6318 737.2762,-2912.5413"/>
<polygon fill="#1000ff" stroke="#1000ff" points="734.9228,-2915.1438 744.3724,-2919.9349 739.973,-2910.2966 734.9228,-2915.1438"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge437" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M240.3866,-2103.1821C258.8043,-2115.4683 289.6139,-2135.5021 317.2024,-2150.9867 388.0114,-2190.7299 425.0255,-2173.1295 480.9653,-2231.9867 497.3357,-2249.2109 556.0539,-2397.6704 577.6632,-2453.1692"/>
<polygon fill="#ff0031" stroke="#ff0031" points="574.4746,-2454.6269 581.3576,-2462.6813 580.9997,-2452.0925 574.4746,-2454.6269"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M224.3716,-2080.5869C227.8248,-2010.945 249.1237,-1643.032 317.2024,-1557.9867 377.2848,-1482.9307 422.9615,-1495.1507 516.9653,-1474.9867 648.58,-1446.7552 691.9258,-1427.9226 819.7932,-1469.9867 932.8627,-1507.1828 1140.3173,-1832.2318 1250.8191,-1787.9867"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1250.8191,-1787.9867C1304.7711,-1767.0646 1316.8538,-1758.3058 1371.0359,-1737.9867 1380.7223,-1734.3542 1391.2068,-1730.6825 1401.1689,-1727.3128"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1402.5339,-1730.547 1410.908,-1724.0565 1400.3142,-1723.9082 1402.5339,-1730.547"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M236.7266,-2080.8834C266.8558,-2054.9223 342.1097,-1990.079 378.6009,-1958.6361"/>
<polygon fill="#ff0000" stroke="#ff0000" points="380.8879,-1961.2855 386.1789,-1952.1064 376.3186,-1955.9826 380.8879,-1961.2855"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M755.1332,-2091.9867C787.5284,-2112.4364 801.3101,-2115.4306 819.7932,-2148.9867 868.6533,-2237.6924 792.041,-2295.2997 855.7932,-2373.9867 874.4782,-2397.049 892.9191,-2382.2977 918.1154,-2397.9867"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge431" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M419.6763,-2142.133C438.1287,-2153.0901 464.7188,-2171.4266 480.9653,-2193.9867 509.5493,-2233.6787 500.0631,-2252.0868 516.9653,-2297.9867 537.8319,-2354.6524 564.2386,-2420.8257 577.4292,-2453.5352"/>
<polygon fill="#ff0031" stroke="#ff0031" points="574.2318,-2454.9646 581.2237,-2462.9248 580.7219,-2452.3418 574.2318,-2454.9646"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M404.698,-2119.8966C419.4306,-2091.7975 461.8923,-2016.9906 516.9653,-1973.9867 569.244,-1933.1648 593.7755,-1942.7314 654.4731,-1915.9867 728.4757,-1883.3796 754.0548,-1887.083 819.7932,-1839.9867 838.7052,-1826.4379 835.5658,-1813.4796 855.7932,-1801.9867 880.4762,-1787.9623 890.709,-1795.3911 918.1154,-1787.9867"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge432" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M417.2403,-2352.1716C434.0125,-2362.6364 459.5022,-2378.879 480.9653,-2393.9867 510.2402,-2414.5931 542.8559,-2439.8906 563.7962,-2456.45"/>
<polygon fill="#ff0031" stroke="#ff0031" points="561.739,-2459.2856 571.7474,-2462.7618 566.0912,-2453.8031 561.739,-2459.2856"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M414.3449,-2329.8606C436.1234,-2314.4452 477.8252,-2286.615 516.9653,-2269.9867 645.1947,-2215.5098 722.4818,-2288.6913 819.7932,-2188.9867 867.3781,-2140.2316 806.0996,-2086.5907 855.7932,-2039.9867 946.2312,-1955.1715 1041.8644,-2078.5791 1130.6023,-1991.9867 1188.9927,-1935.0081 1111.2733,-1871.9426 1166.6023,-1811.9867 1192.9971,-1783.3847 1214.7488,-1802.6051 1250.8191,-1787.9867"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M402.8727,-5050.0378C416.2974,-5089.7372 461.8165,-5229.0896 480.9653,-5347.9867 502.063,-5478.9845 449.1897,-5829.9166 516.9653,-5943.9867 553.7851,-6005.9564 609.0376,-5974.0265 654.4731,-6029.9867 683.721,-6066.0096 668.1676,-6087.2983 690.4731,-6127.9867 805.4147,-6337.6558 826.4978,-6410.7435 1016.4375,-6555.9867 1317.3413,-6786.082 2543.3151,-7031.4247 2715.427,-6693.9867"/>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M2715.427,-6693.9867C2826.1223,-6473.0408 2882.238,-4581.2464 2888.5065,-4357.5654"/>
<polygon fill="#a4ff00" stroke="#a4ff00" points="2892.009,-4357.5218 2888.7883,-4347.4283 2885.0117,-4357.3272 2892.009,-4357.5218"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge228" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M1250.8191,-5399.9867C1287.1495,-5370.9972 1300.9758,-5369.6126 1335.0359,-5337.9867 1373.2961,-5302.461 1411.512,-5254.3965 1431.4565,-5228.1125"/>
<polygon fill="#00ff52" stroke="#00ff52" points="1434.2812,-5230.1795 1437.4935,-5220.0834 1428.6863,-5225.9728 1434.2812,-5230.1795"/>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M399.6013,-5050.0213C402.3416,-5094.6565 419.0563,-5263.0184 516.9653,-5337.9867 581.9365,-5387.7347 1186.8565,-5451.025 1250.8191,-5399.9867"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge269" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M403.0241,-5027.9587C416.9602,-4988.3368 463.9919,-4849.2139 480.9653,-4729.9867 504.6658,-4563.5066 470.7407,-3378.6674 516.9653,-3216.9867 550.019,-3101.3744 616.6183,-3098.1172 654.4731,-2983.9867 701.4764,-2842.2742 612.6447,-2777.4013 690.4731,-2649.9867 726.3261,-2591.2912 764.2094,-2605.4966 819.7932,-2564.9867 836.3971,-2552.8857 837.9925,-2546.2463 855.7932,-2535.9867 881.5093,-2521.165 902.9061,-2537.4755 918.1154,-2511.9867"/>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M918.1154,-2511.9867C933.5206,-2486.616 959.813,-2509.3321 980.4375,-2487.9867 1014.4252,-2452.8111 999.1401,-2429.7393 1016.4375,-2383.9867 1032.4819,-2341.5484 1053.0713,-2292.6201 1064.6256,-2265.6058"/>
<polygon fill="#0052ff" stroke="#0052ff" points="1067.9894,-2266.6426 1068.7175,-2256.0728 1061.5569,-2263.8815 1067.9894,-2266.6426"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge297" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M402.8363,-5050.0437C416.1382,-5089.7632 461.2941,-5229.1749 480.9653,-5347.9867 499.8857,-5462.2632 466.2631,-5763.8408 516.9653,-5867.9867 552.987,-5941.9777 603.4877,-5927.3902 654.4731,-5991.9867 675.1745,-6018.2146 666.4406,-6034.7729 690.4731,-6057.9867 1000.0479,-6357.0155 1149.5999,-6350.8309 1556.2075,-6491.9867 1738.9566,-6555.429 1789.029,-6579.9867 1982.4771,-6579.9867 1982.4771,-6579.9867 1982.4771,-6579.9867 2160.6401,-6579.9867 2329.9102,-6579.9867 2346.2368,-6459.6146 2434.1865,-6314.9867 2463.1177,-6267.4112 2450.7017,-6247.1479 2470.1865,-6194.9867 2519.4899,-6063.0008 2569.9117,-6043.5257 2600.4756,-5905.9867 2663.3908,-5622.8654 2615.9478,-3585.287 2636.4756,-3295.9867 2653.0426,-3062.5053 2698.5628,-2781.901 2711.7825,-2703.3359"/>
<polygon fill="#0020ff" stroke="#0020ff" points="2715.2733,-2703.6838 2713.4913,-2693.2399 2708.3715,-2702.5156 2715.2733,-2703.6838"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge326" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M403.0129,-5027.9571C416.9109,-4988.3297 463.8301,-4849.1907 480.9653,-4729.9867 502.4421,-4580.5806 460.6157,-3512.0159 516.9653,-3371.9867 550.851,-3287.7807 608.088,-3299.008 654.4731,-3220.9867 709.4169,-3128.5695 740.2763,-3001.713 750.8891,-2952.0913"/>
<polygon fill="#1000ff" stroke="#1000ff" points="754.3352,-2952.7103 752.9513,-2942.2063 747.4828,-2951.2807 754.3352,-2952.7103"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge435" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M403.0386,-5027.9608C417.0237,-4988.3458 464.2005,-4849.2434 480.9653,-4729.9867 535.856,-4339.5227 485.0661,-3348.9977 516.9653,-2955.9867 531.5101,-2776.7898 569.3467,-2562.6381 581.7313,-2495.3145"/>
<polygon fill="#ff0031" stroke="#ff0031" points="585.236,-2495.6098 583.6157,-2485.1396 578.3531,-2494.335 585.236,-2495.6098"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M402.4759,-5027.862C414.561,-4987.9135 456.1177,-4847.8248 480.9653,-4729.9867 502.132,-4629.6054 490.2144,-4601.0263 516.9653,-4501.9867 572.4272,-4296.6512 601.5888,-4249.2179 690.4731,-4055.9867 804.6409,-3807.7904 905.5368,-3776.714 980.4375,-3513.9867 1014.6263,-3394.0637 962.6807,-3066.5062 1016.4375,-2953.9867 1046.1552,-2891.784 1084.0564,-2899.8374 1130.6023,-2848.9867 1231.2763,-2739.0019 1283.9193,-2723.0546 1335.0359,-2582.9867 1396.5771,-2414.3536 1291.8259,-1937.0775 1371.0359,-1775.9867 1380.6911,-1756.3507 1399.5751,-1740.4982 1415.925,-1729.6066"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1418.0924,-1732.3771 1424.6728,-1724.0736 1414.3505,-1726.4611 1418.0924,-1732.3771"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#73ff00" stroke-dasharray="5,2" d="M1266.8143,-2370.2591C1329.1955,-2413.6849 1556.6592,-2566.8988 1637.2174,-2549.9867"/>
<path fill="none" stroke="#73ff00" stroke-dasharray="5,2" d="M1637.2174,-2549.9867C1728.0138,-2525.6418 1836.2069,-2516.4843 1906.9716,-2513.0453"/>
<polygon fill="#73ff00" stroke="#73ff00" points="1907.3054,-2516.5337 1917.1341,-2512.5782 1906.984,-2509.5411 1907.3054,-2516.5337"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1264.2748,-2347.9219C1283.8478,-2330.9184 1319.5245,-2296.2886 1335.0359,-2257.9867 1415.6714,-2058.876 1273.3685,-1967.3195 1371.0359,-1775.9867 1380.9843,-1756.4976 1399.8658,-1740.6438 1416.1411,-1729.7149"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1418.2977,-1732.4905 1424.8416,-1724.1581 1414.5298,-1726.591 1418.2977,-1732.4905"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M800.4103,-2157.9397C807.6757,-2154.4734 814.5252,-2149.932 819.7932,-2143.9867 862.9721,-2095.257 811.0384,-2049.2733 855.7932,-2001.9867 943.7651,-1909.0383 1038.7627,-2005.1157 1130.6023,-1915.9867 1165.7032,-1881.9218 1131.0671,-1845.5984 1166.6023,-1811.9867 1194.8775,-1785.2422 1214.7663,-1802.6481 1250.8191,-1787.9867"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M401.901,-3849.9719C413.7061,-3803.3507 459.5695,-3617.5079 480.9653,-3461.9867 496.3292,-3350.31 464.3278,-3055.6715 516.9653,-2955.9867 597.1544,-2804.1249 686.9816,-2824.8599 819.7932,-2715.9867 976.0658,-2587.8814 1008.5576,-2547.8993 1166.6023,-2421.9867 1186.6684,-2406.0003 1210.0776,-2388.5839 1227.1152,-2376.1232"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1229.3712,-2378.81 1235.3926,-2370.0926 1225.2492,-2373.1523 1229.3712,-2378.81"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge245" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M399.0839,-1027.9867C514.4319,-1019.648 815.8165,-936.0456 918.1154,-989.9867"/>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M229.3406,-1162.6382C241.6219,-1138.5059 273.6584,-1081.8638 317.2024,-1051.9867 348.4723,-1030.5314 361.3518,-1031.7851 399.0839,-1027.9867"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-1027.9867C506.0122,-1020.2567 562.7527,-1177.8243 579.9747,-1235.9066"/>
<polygon fill="#0066ff" stroke="#0066ff" points="576.6974,-1237.1758 582.815,-1245.826 583.427,-1235.2489 576.6974,-1237.1758"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.8078,-1173.9867C295.1003,-1173.9867 313.1505,-1173.9867 330.2066,-1173.9867"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.6733,-1177.4868 340.6733,-1173.9867 330.6733,-1170.4868 330.6733,-1177.4868"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge240" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M420.5194,-1162.8074C443.6065,-1151.4476 481.7744,-1134.6097 516.9653,-1127.9867 649.2335,-1103.0938 687.1133,-1105.3915 819.7932,-1127.9867 902.4541,-1142.0638 994.0318,-1180.2033 1041.3169,-1201.7075"/>
<polygon fill="#00ffb4" stroke="#00ffb4" points="1039.8939,-1204.9054 1050.4418,-1205.9018 1042.8175,-1198.5451 1039.8939,-1204.9054"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M441.3408,-1185.0495C454.26,-1188.9192 468.3758,-1193.6492 480.9653,-1198.9867 508.974,-1210.8615 539.1925,-1228.1135 559.9415,-1240.7144"/>
<polygon fill="#0066ff" stroke="#0066ff" points="558.1407,-1243.7158 568.4929,-1245.9704 561.8062,-1237.7522 558.1407,-1243.7158"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff9400" stroke-dasharray="5,2" d="M1982.4771,-5971.9867C2022.3031,-5957.3135 2070.3213,-5953.1713 2106.4673,-5952.501"/>
<polygon fill="#ff9400" stroke="#ff9400" points="2106.8408,-5955.9975 2116.8051,-5952.3972 2106.7704,-5948.9979 2106.8408,-5955.9975"/>
<path fill="none" stroke="#ff9400" stroke-dasharray="5,2" d="M1817.7286,-6047.9867C1866.4657,-6037.2871 1871.6085,-6016.1972 1917.23,-5995.9867 1945.4803,-5983.4718 1953.484,-5982.6687 1982.4771,-5971.9867"/>
<path fill="none" stroke="#ff9400" stroke-dasharray="5,2" d="M1637.2174,-5971.9867C1722.5431,-5989.2165 1732.7055,-6066.6525 1817.7286,-6047.9867"/>
<path fill="none" stroke="#ff9400" stroke-dasharray="5,2" d="M1260.0321,-5713.1065C1299.3366,-5759.3909 1459.1323,-5936.0261 1637.2174,-5971.9867"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge225" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M1255.2538,-5690.7635C1280.2911,-5627.4 1404.0224,-5314.2648 1437.3441,-5229.9355"/>
<polygon fill="#00ff52" stroke="#00ff52" points="1440.6888,-5230.9948 1441.1086,-5220.4083 1434.1786,-5228.4223 1440.6888,-5230.9948"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge317" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M2535.3311,-5610.9867C2551.5863,-5584.7603 2582.6288,-5612.1573 2600.4756,-5586.9867 2637.2887,-5535.0666 2631.9098,-3359.4695 2636.4756,-3295.9867 2653.2668,-3062.5213 2698.6297,-2781.9057 2711.7975,-2703.3369"/>
<polygon fill="#0020ff" stroke="#0020ff" points="2715.2884,-2703.6832 2713.4994,-2693.2405 2708.3858,-2702.5196 2715.2884,-2703.6832"/>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M1274.2533,-5713.0667C1298.4368,-5724.4624 1337.2835,-5742.6604 1371.0359,-5757.9867 1437.047,-5787.9612 1463.4689,-5778.8574 1520.2075,-5823.9867 1541.0775,-5840.5865 1532.3561,-5860.061 1556.2075,-5871.9867 1620.6141,-5904.1901 1647.0772,-5883.0742 1718.2273,-5871.9867 1812.3992,-5857.3117 2485.1208,-5691.9968 2535.3311,-5610.9867"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge337" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1252.0729,-5690.7424C1258.6049,-5634.6638 1291.528,-5380.3158 1371.0359,-5188.9867 1486.9051,-4910.157 1513.673,-4810.4841 1754.2273,-4627.9867 1860.1018,-4547.6647 2011.8827,-4503.2049 2096.824,-4483.1936"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2097.64,-4486.5974 2106.5921,-4480.9309 2096.0602,-4479.7779 2097.64,-4486.5974"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge375" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1258.9837,-5690.8598C1275.256,-5668.2818 1312.1301,-5615.0584 1335.0359,-5565.9867 1356.6151,-5519.7569 1333.7279,-5491.7858 1371.0359,-5456.9867 1396.051,-5433.6538 1412.1536,-5430.9109 1445.6217,-5437.9867"/>
</g>
<!-- sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M2360.2687,-3716.742C2403.3271,-3641.617 2651.1086,-3218.2698 2715.427,-3309.9867"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge306" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M2535.3311,-1559.9867C2658.2828,-1753.8312 2706.5194,-2522.3796 2714.2791,-2660.6266"/>
<polygon fill="#0020ff" stroke="#0020ff" points="2710.7928,-2660.9728 2714.8384,-2670.7649 2717.7822,-2660.5872 2710.7928,-2660.9728"/>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M1270.0992,-1511.8962C1335.3785,-1475.0687 1555.1213,-1356.9728 1754.2273,-1317.9867 2052.8452,-1259.5157 2185.0477,-1223.2831 2434.1865,-1397.9867 2503.6836,-1446.7201 2489.8669,-1488.3084 2535.3311,-1559.9867"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge350" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1261.4513,-1511.7563C1278.2419,-1493.7034 1311.4137,-1456.7243 1335.0359,-1421.9867 1353.8248,-1394.3567 1344.8757,-1376.7735 1371.0359,-1355.9867 1568.3166,-1199.2288 1667.5692,-1238.078 1917.23,-1203.9867 1974.6941,-1196.14 1993.5127,-1183.3756 2047.7241,-1203.9867 2067.734,-1211.5945 2064.0553,-1227.5363 2083.7241,-1235.9867 2189.6139,-1281.481 2514.4039,-1203.3445 2600.4756,-1279.9867 2642.4959,-1317.4036 2699.3736,-1724.9059 2712.5992,-1823.5687"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2709.1404,-1824.1108 2713.9305,-1833.561 2716.0791,-1823.1863 2709.1404,-1824.1108"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1299.8804,-1517.7978C1394.5397,-1510.7117 1603.1695,-1509.7831 1718.2273,-1621.9867 1752.5661,-1655.4737 2034.457,-2373.8943 2047.7241,-2419.9867 2130.2833,-2706.8129 2086.0962,-2792.9739 2160.6401,-3081.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2160.6401,-3081.9867C2182.9028,-3164.3985 2211.9456,-3176.5532 2237.5562,-3257.9867 2262.0322,-3335.813 2254.6561,-3358.6218 2273.5562,-3437.9867 2297.7525,-3539.5919 2333.1405,-3659.3695 2347.4821,-3706.966"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2344.1905,-3708.1731 2350.4352,-3716.732 2350.8909,-3706.1469 2344.1905,-3708.1731"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge307" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M2535.3311,-1293.9867C2543.1261,-1323.8414 2582.0051,-1293.2703 2600.4756,-1317.9867 2636.9366,-1366.7775 2631.5456,-1804.2773 2636.4756,-1864.9867 2662.2182,-2181.9926 2703.0853,-2567.2471 2713.1375,-2660.789"/>
<polygon fill="#0020ff" stroke="#0020ff" points="2709.6805,-2661.3774 2714.2312,-2670.9451 2716.6403,-2660.6278 2709.6805,-2661.3774"/>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M1445.6217,-267.9867C1634.562,-226.6583 2106.4101,-486.8348 2237.5562,-628.9867 2368.9147,-771.3691 2370.517,-835.0277 2434.1865,-1017.9867 2460.4278,-1093.393 2439.8629,-1120.1275 2470.1865,-1193.9867 2490.3322,-1243.0555 2521.9307,-1242.664 2535.3311,-1293.9867"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge354" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1445.6217,-267.9867C1796.8102,-201.9061 1931.3767,-222.7202 2237.5562,-406.9867 2353.0742,-476.5084 2357.8061,-526.8845 2434.1865,-637.9867 2453.1157,-665.5209 2444.8955,-682.1508 2470.1865,-703.9867 2493.5415,-724.1512 2525.8682,-698.6181 2535.3311,-727.9867"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1102.6672,-447.8726C1111.8461,-443.9409 1121.8635,-439.1885 1130.6023,-433.9867 1148.0199,-423.6189 1149.4305,-416.7568 1166.6023,-405.9867 1173.9274,-401.3924 1437.1001,-269.4525 1445.6217,-267.9867"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1112.9553,-459.4995C1218.1299,-462.4539 1511.3743,-481.1762 1718.2273,-595.9867 1764.3641,-621.5943 2023.3092,-891.2079 2047.7241,-937.9867 2085.876,-1011.0856 2027.7149,-1059.4724 2083.7241,-1119.9867 2131.9452,-1172.0865 2194.1977,-1106.7755 2237.5562,-1162.9867 2276.1579,-1213.0312 2264.549,-3375.4295 2273.5562,-3437.9867 2288.4412,-3541.3672 2329.0615,-3660.1472 2346.142,-3707.2215"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2342.9531,-3708.6917 2349.6816,-3716.8756 2349.5252,-3706.282 2342.9531,-3708.6917"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.6139,-470.114C1081.1498,-535.7643 1116.455,-879.0938 1166.6023,-1155.9867 1190.6844,-1288.9584 1230.7876,-1446.4839 1245.3352,-1502.205"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1241.9697,-1503.1692 1247.8917,-1511.9545 1248.7407,-1501.3937 1241.9697,-1503.1692"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M948.1655,-6679.9069C994.7195,-6662.8688 1087.1927,-6629.5301 1166.6023,-6603.9867 1409.8482,-6525.7427 1496.2365,-6568.5205 1718.2273,-6441.9867 1804.2852,-6392.9341 1830.7866,-6375.2369 1881.23,-6289.9867 1914.3854,-6233.9535 1875.3348,-6197.8245 1917.23,-6147.9867 1955.3668,-6102.6199 2122.5435,-6084.3874 2160.6401,-6038.9867"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2160.6401,-6038.9867C2184.724,-6001.2622 2218.3222,-6014.4 2237.5562,-5973.9867 2282.2099,-5880.1628 2261.649,-4207.2104 2273.5562,-4103.9867 2289.3683,-3966.9102 2332.0134,-3806.0407 2347.8462,-3749.1842"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2351.3053,-3749.8115 2350.6393,-3739.2376 2344.566,-3747.919 2351.3053,-3749.8115"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge246" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M466.4547,-1357.9482C471.746,-1355.2816 476.6866,-1352.0058 480.9653,-1347.9867 518.7671,-1312.479 476.2622,-1269.1275 516.9653,-1236.9867 600.3043,-1171.179 649.4162,-1227.9848 755.1332,-1217.9867"/>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M755.1332,-1217.9867C826.9341,-1208.4122 846.1399,-1226.1466 918.1154,-1217.9867"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge250" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M918.1154,-1217.9867C947.2367,-1216.0242 979.4969,-1215.5418 1007.0428,-1215.639"/>
<polygon fill="#00ffb4" stroke="#00ffb4" points="1007.3313,-1219.1407 1017.3528,-1215.7027 1007.3747,-1212.1408 1007.3313,-1219.1407"/>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M419.5947,-1316.7813C437.9909,-1305.7834 464.5441,-1287.4201 480.9653,-1264.9867 508.6195,-1227.2078 478.6176,-1192.8466 516.9653,-1165.9867 567.0223,-1130.9255 593.648,-1160.0455 654.4731,-1165.9867 713.9062,-1171.792 858.5346,-1222.0019 918.1154,-1217.9867"/>
</g>
<!-- sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge296" class="edge">
<title>sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M2556.3428,-2598.0704C2588.1987,-2614.8743 2648.8625,-2646.8742 2685.3765,-2666.1352"/>
<polygon fill="#0020ff" stroke="#0020ff" points="2684.0712,-2669.4037 2694.5491,-2670.9737 2687.3372,-2663.2123 2684.0712,-2669.4037"/>
</g>
<!-- sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge353" class="edge">
<title>sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2353.8713,-4964.9867C2424.563,-5028.8148 2449.5674,-5120.4106 2535.3311,-5078.9867"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2161.4341,-4481.0052C2166.3107,-4540.2718 2197.4124,-4823.7186 2353.8713,-4964.9867"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge384" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M1820.828,-5655.8434C1830.1009,-5624.4782 1860.5572,-5534.5117 1917.23,-5484.9867 1922.5079,-5480.3745 1928.7273,-5476.5707 1935.1942,-5473.4453"/>
<polygon fill="#7300ff" stroke="#7300ff" points="1936.9568,-5476.4976 1944.7653,-5469.3366 1934.1955,-5470.0652 1936.9568,-5476.4976"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge399" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M1450.1076,-5465.8625C1463.7562,-5431.3963 1504.7863,-5323.0474 1520.2075,-5228.9867 1559.5977,-4988.7295 1538.3738,-4376.7975 1556.2075,-4133.9867 1576.2266,-3861.4224 1621.897,-3532.1425 1634.1464,-3446.2782"/>
<polygon fill="#ff00c5" stroke="#ff00c5" points="1637.6349,-3446.6074 1635.5888,-3436.212 1630.7057,-3445.6144 1637.6349,-3446.6074"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~EfferentGraph_edge374" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1498.8364,-5488.0336C1506.7137,-5491.4906 1514.1909,-5496.0289 1520.2075,-5501.9867 1554.9639,-5536.4032 1520.8476,-5572.1908 1556.2075,-5605.9867 1583.3538,-5631.9323 1605.1818,-5610.3956 1637.2174,-5629.9867"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilehvacmultispeedheatpumpf90EfferentGraph = svgPanZoom('#sourcefilehvacmultispeedheatpumpf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilehvacmultispeedheatpumpf90AfferentGraph" width="641pt" height="58pt"
 viewBox="0.00 0.00 641.00 58.04" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph" class="graph" transform="scale(.4465 .4465) rotate(0) translate(4 125.9768)">
<title>sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-125.9768 1431.5789,-125.9768 1431.5789,4 -4,4"/>
<!-- sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~hvacmultispeedheatpump.f90</title>
<polygon fill="none" stroke="#000000" points="160.0765,-74.9823 -.0255,-74.9823 -.0255,-52.9714 160.0765,-52.9714 160.0765,-74.9823"/>
<text text-anchor="middle" x="80.0255" y="-60.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HVACMultiSpeedHeatPump.f90</text>
</g>
<!-- sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~simairservingzones.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/simairservingzones.f90.html" xlink:title="SimAirServingZones.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="321.3713,-74.9823 195.9442,-74.9823 195.9442,-52.9714 321.3713,-52.9714 321.3713,-74.9823"/>
<text text-anchor="middle" x="258.6577" y="-60.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimAirServingZones.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmultispeedheatpump.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~hvacmultispeedheatpump.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M160.1975,-63.9768C168.7037,-63.9768 177.3216,-63.9768 185.7384,-63.9768"/>
<polygon fill="#ff0000" stroke="#ff0000" points="185.8843,-67.4769 195.8843,-63.9768 185.8842,-60.4769 185.8843,-67.4769"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1139.5433,-93.9823 1040.5858,-93.9823 1040.5858,-71.9714 1139.5433,-71.9714 1139.5433,-93.9823"/>
<text text-anchor="middle" x="1090.0646" y="-79.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M293.4777,-75.0227C349.7033,-91.8509 464.2487,-121.9768 563.7118,-121.9768 563.7118,-121.9768 563.7118,-121.9768 754.7256,-121.9768 866.0905,-121.9768 894.5088,-119.9335 1004.5752,-102.9768 1015.6479,-101.271 1027.4095,-98.896 1038.5517,-96.3768"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1039.63,-99.7193 1048.5726,-94.0377 1038.0388,-92.9025 1039.63,-99.7193"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="455.9329,-35.9823 357.3748,-35.9823 357.3748,-13.9714 455.9329,-13.9714 455.9329,-35.9823"/>
<text text-anchor="middle" x="406.6538" y="-21.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M300.6716,-52.9053C317.4593,-48.4814 336.9665,-43.3409 354.6351,-38.6848"/>
<polygon fill="#ff0000" stroke="#ff0000" points="356.0132,-41.9412 364.7912,-36.0085 354.2294,-35.1723 356.0132,-41.9412"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1295.1615,-73.9823 1175.351,-73.9823 1175.351,-51.9714 1295.1615,-51.9714 1295.1615,-73.9823"/>
<text text-anchor="middle" x="1235.2562" y="-59.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1139.6252,-76.1499C1147.8916,-75.0112 1156.6025,-73.8113 1165.2639,-72.6182"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1165.9505,-76.0568 1175.3794,-71.2248 1164.9953,-69.1222 1165.9505,-76.0568"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M939.323,-43.9768C1006.3192,-43.8861 1023.0683,-43.9274 1090.0646,-43.9768"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1090.0646,-43.9768C1115.4228,-43.9955 1143.0633,-46.8844 1167.3575,-50.4038"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1167.1371,-53.9102 1177.548,-51.9442 1168.1834,-46.9888 1167.1371,-53.9102"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M445.4294,-13.9071C459.9261,-10.2966 476.6156,-6.7594 492.0432,-4.9768 555.3276,2.3355 571.8944,.3059 635.3804,-4.9768 688.9771,-9.4366 701.224,-19.4926 754.7256,-24.9768"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M754.7256,-24.9768C836.9382,-31.5716 856.8463,-44.0885 939.323,-43.9768"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.5493,-35.9823 491.8742,-35.9823 491.8742,-13.9714 635.5493,-13.9714 635.5493,-35.9823"/>
<text text-anchor="middle" x="563.7118" y="-21.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M456.3479,-24.9768C464.4867,-24.9768 473.1054,-24.9768 481.7795,-24.9768"/>
<polygon fill="#00ffff" stroke="#00ffff" points="481.9623,-28.4769 491.9622,-24.9768 481.9622,-21.4769 481.9623,-28.4769"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1420.9772,-94.9823 1337.5602,-94.9823 1337.5602,-72.9714 1420.9772,-72.9714 1420.9772,-94.9823"/>
<text text-anchor="middle" x="1379.2687" y="-80.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1295.0794,-71.7003C1305.744,-73.2554 1316.7758,-74.8641 1327.2021,-76.3844"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1326.9902,-79.8905 1337.3906,-77.8701 1328.0003,-72.9637 1326.9902,-79.8905"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1427.3898,-53.9823 1331.1476,-53.9823 1331.1476,-31.9714 1427.3898,-31.9714 1427.3898,-53.9823"/>
<text text-anchor="middle" x="1379.2687" y="-39.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1295.0794,-54.6688C1303.5403,-53.4938 1312.2323,-52.2866 1320.6698,-51.1149"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1321.3793,-54.55 1330.8027,-49.7076 1320.4163,-47.6166 1321.3793,-54.55"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.5462,-21.5194C671.4339,-20.6698 715.4684,-20.9527 754.7256,-24.9768"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="837.9163,-74.9823 671.5349,-74.9823 671.5349,-52.9714 837.9163,-52.9714 837.9163,-74.9823"/>
<text text-anchor="middle" x="754.7256" y="-60.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M617.6828,-35.9963C640.3677,-40.628 666.9355,-46.0524 690.6084,-50.8858"/>
<polygon fill="#ff0000" stroke="#ff0000" points="690.0589,-54.3457 700.5569,-52.917 691.4593,-47.4872 690.0589,-54.3457"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M823.7845,-52.9685C858.3776,-48.354 900.9625,-44.0288 939.323,-43.9768"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1004.3283,-93.9823 874.3177,-93.9823 874.3177,-71.9714 1004.3283,-71.9714 1004.3283,-93.9823"/>
<text text-anchor="middle" x="939.323" y="-79.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M838.1132,-72.5596C846.8348,-73.4573 855.6636,-74.366 864.284,-75.2533"/>
<polygon fill="#ff0000" stroke="#ff0000" points="863.9832,-78.7408 874.289,-76.2831 864.7,-71.7775 863.9832,-78.7408"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1004.5637,-82.9768C1013.0491,-82.9768 1021.7089,-82.9768 1030.1024,-82.9768"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1030.1789,-86.4769 1040.1789,-82.9768 1030.1789,-79.4769 1030.1789,-86.4769"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacmultispeedheatpump.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M965.4778,-71.893C995.1306,-60.3519 1045.1913,-43.9437 1090.0646,-43.9768"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilehvacmultispeedheatpumpf90AfferentGraph = svgPanZoom('#sourcefilehvacmultispeedheatpumpf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/hvacmultispeedheatpump.html">HVACMultiSpeedHeatPump</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html#src">HVACMultiSpeedHeatPump.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">HVACMultiSpeedHeatPump</span>
<a name="ln-2"></a>
<a name="ln-3"></a>  <span class="c">! Module containing the Multi Speed Heat Pump simulation routines</span>
<a name="ln-4"></a>
<a name="ln-5"></a>  <span class="c">! MODULE INFORMATION:</span>
<a name="ln-6"></a>  <span class="c">!       AUTHOR         Lixing Gu, Florida Solar Energy Center</span>
<a name="ln-7"></a>  <span class="c">!       DATE WRITTEN   June 2007</span>
<a name="ln-8"></a>  <span class="c">!       MODIFIED       Bereket Nigusse, FSEC, June 2010 - deprecated supply air flow fraction through controlled</span>
<a name="ln-9"></a>  <span class="c">!                      zone from the furnace object input field. Now, the flow fraction is calculated internally</span>
<a name="ln-10"></a>  <span class="c">!                      Brent Griffith, NREL, Dec 2010 -- upgrade to new plant for heat recovery, general fluid props.</span>
<a name="ln-11"></a>  <span class="c">!                      Bereket Nigusse, FSEC, Jan. 2012 -- added hot water and steam heating coil</span>
<a name="ln-12"></a>
<a name="ln-13"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-14"></a>
<a name="ln-15"></a>  <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-16"></a>  <span class="c">! To encapsulate the data and algorithms required to simulate Multi Speed Heat Pump in</span>
<a name="ln-17"></a>  <span class="c">! EnergyPlus.</span>
<a name="ln-18"></a>
<a name="ln-19"></a>  <span class="c">! Module currently models air-cooled or evap-cooled direct expansion systems</span>
<a name="ln-20"></a>  <span class="c">! (split or packaged) with mulptiple speeds. Air-side performance is modeled to determine</span>
<a name="ln-21"></a>  <span class="c">! coil discharge air conditions. The module also determines the DX unit&#39;s energy</span>
<a name="ln-22"></a>  <span class="c">! usage. Neither the air-side performance nor the energy usage includes the effect</span>
<a name="ln-23"></a>  <span class="c">! of supply air fan heat/energy usage. The supply air fan is modeled by other modules.</span>
<a name="ln-24"></a>
<a name="ln-25"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-26"></a>  <span class="c">! na</span>
<a name="ln-27"></a>
<a name="ln-28"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-29"></a>  <span class="c">! na</span>
<a name="ln-30"></a>
<a name="ln-31"></a>  <span class="c">! OTHER NOTES:</span>
<a name="ln-32"></a>  <span class="c">! na</span>
<a name="ln-33"></a>
<a name="ln-34"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-35"></a>  <span class="c">! Use statements for data only modules</span>
<a name="ln-36"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-37"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-38"></a><span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-39"></a><span class="k">Use </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">StdBaroPress</span><span class="p">,</span> <span class="n">StdRhoAir</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="n">OutDryBulbTemp</span><span class="p">,</span> <span class="n">OutWetBulbTemp</span><span class="p">,</span> <span class="n">OutHumRat</span><span class="p">,</span> <span class="n">CurMnDy</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-40"></a>                           <span class="n">EnvironmentName</span><span class="p">,</span><span class="n">DayOfYear</span>
<a name="ln-41"></a><span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">OnOffFanPartLoadFraction</span><span class="p">,</span> <span class="n">SmallAirVolFLow</span><span class="p">,</span> <span class="n">SmallMassFlow</span><span class="p">,</span> <span class="n">SmallLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-42"></a>                           <span class="n">DXElecCoolingPower</span><span class="p">,</span> <span class="n">DXElecHeatingPower</span><span class="p">,</span> <span class="n">FanElecPower</span><span class="p">,</span> <span class="n">ElecHeatingCoilPower</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-43"></a>                           <span class="n">CycFanCycCoil</span><span class="p">,</span> <span class="n">ContFanCycCoil</span><span class="p">,</span> <span class="n">DrawThru</span><span class="p">,</span> <span class="n">BlowThru</span><span class="p">,</span> <span class="n">Coil_HeatingWater</span><span class="p">,</span> <span class="n">Coil_HeatingSteam</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-44"></a>                           <span class="n">Coil_HeatingGas</span><span class="p">,</span> <span class="n">Coil_HeatingElectric</span><span class="p">,</span> <span class="n">Coil_HeatingGas_MultiStage</span><span class="p">,</span> <span class="n">Coil_HeatingElectric_MultiStage</span>
<a name="ln-45"></a><span class="k">USE </span><span class="n">DataZoneEnergyDemands</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneSysEnergyDemand</span>
<a name="ln-46"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-47"></a><span class="k">USE </span><span class="n">Psychrometrics</span>
<a name="ln-48"></a>
<a name="ln-49"></a>  <span class="c">! Use statements for access to subroutines in other modules</span>
<a name="ln-50"></a><span class="k">USE </span><span class="n">ScheduleManager</span>
<a name="ln-51"></a>
<a name="ln-52"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-53"></a>
<a name="ln-54"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-55"></a>
<a name="ln-56"></a>  <span class="c">!MODULE PARAMETER DEFINITIONS</span>
<a name="ln-57"></a>
<a name="ln-58"></a><span class="c">! Heating coil types</span>
<a name="ln-59"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MultiSpeedHeatingCoil</span> <span class="o">=</span> <span class="mi">1</span>    <span class="c">! COIL:DX:MultiSpeed:Heating</span>
<a name="ln-60"></a><span class="c">! Cooling coil types</span>
<a name="ln-61"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MultiSpeedCoolingCoil</span> <span class="o">=</span> <span class="mi">2</span>    <span class="c">! COIL:DX:MultiSpeed:Cooling</span>
<a name="ln-62"></a><span class="c">! Supplymental heating coil types</span>
<a name="ln-63"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SuppHeatingCoilGas</span>  <span class="o">=</span> <span class="mi">1</span>     <span class="c">! Supplymental heating coil type: COIL:GAS:HEATING</span>
<a name="ln-64"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SuppHeatingCoilElec</span> <span class="o">=</span> <span class="mi">2</span>     <span class="c">! Supplymental heating coil type: COIL:ELECTRIC:HEATING</span>
<a name="ln-65"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SuppHeatingCoilRec</span>  <span class="o">=</span> <span class="mi">3</span>     <span class="c">! Supplymental heating coil type: COIL:ENGINEHEATRECOVERY:HEATING</span>
<a name="ln-66"></a>
<a name="ln-67"></a><span class="c">! Curve Types</span>
<a name="ln-68"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Linear</span>      <span class="o">=</span> <span class="mi">1</span>             <span class="c">! Linear curve type</span>
<a name="ln-69"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Bilinear</span>    <span class="o">=</span> <span class="mi">2</span>             <span class="c">! Bi-linear curve type</span>
<a name="ln-70"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Quadratic</span>   <span class="o">=</span> <span class="mi">3</span>             <span class="c">! Quadratic curve type</span>
<a name="ln-71"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Biquadratic</span> <span class="o">=</span> <span class="mi">4</span>             <span class="c">! Bi-quadratic curve type</span>
<a name="ln-72"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Cubic</span>       <span class="o">=</span> <span class="mi">5</span>             <span class="c">! Cubic curve type</span>
<a name="ln-73"></a>
<a name="ln-74"></a><span class="c">! Mode of operation</span>
<a name="ln-75"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoolingMode</span>         <span class="o">=</span> <span class="mi">1</span>    <span class="c">! System operating mode is cooling</span>
<a name="ln-76"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HeatingMode</span>         <span class="o">=</span> <span class="mi">2</span>    <span class="c">! System operating mode is heating</span>
<a name="ln-77"></a>
<a name="ln-78"></a><span class="c">! Airflow control for contant fan mode</span>
<a name="ln-79"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">UseCompressorOnFlow</span>  <span class="o">=</span> <span class="mi">1</span>    <span class="c">! set compressor OFF air flow rate equal to compressor ON air flow rate</span>
<a name="ln-80"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">UseCompressorOffFlow</span> <span class="o">=</span> <span class="mi">2</span>    <span class="c">! set compressor OFF air flow rate equal to user defined value</span>
<a name="ln-81"></a><span class="c">! Compressor operation</span>
<a name="ln-82"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">On</span>               <span class="o">=</span> <span class="mi">1</span>        <span class="c">! normal compressor operation</span>
<a name="ln-83"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Off</span>              <span class="o">=</span> <span class="mi">0</span>        <span class="c">! signal DXCoil that compressor shouldn&#39;t run</span>
<a name="ln-84"></a>
<a name="ln-85"></a>  <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-86"></a><span class="k">TYPE </span><span class="n">MSHeatPumpData</span>
<a name="ln-87"></a><span class="c">!          Some variables in this type are arrays (dimension=MaxSpeed) to support the number of speeds</span>
<a name="ln-88"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>           <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! Name of the engine driven heat pump</span>
<a name="ln-89"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AvaiSchedule</span>   <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! Availability Schedule name</span>
<a name="ln-90"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">AvaiSchedPtr</span>          <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Pointer to the correct schedule</span>
<a name="ln-91"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">AirInletNodeNum</span>       <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Node number of the heat pump air inlet</span>
<a name="ln-92"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">AirOutletNodeNum</span>      <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Node number of the heat pump air inlet</span>
<a name="ln-93"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirInletNodeName</span> <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! Node name of the heat pump air inlet</span>
<a name="ln-94"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirOutletNodeName</span> <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! Node name of the heat pump air outlet</span>
<a name="ln-95"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">ControlZoneNum</span>        <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Controlling zone or thermostat location</span>
<a name="ln-96"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">ZoneSequenceCoolingNum</span> <span class="o">=</span><span class="mi">0</span> <span class="c">! Index to cooling sequence/priority for this zone</span>
<a name="ln-97"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">ZoneSequenceHeatingNum</span> <span class="o">=</span><span class="mi">0</span> <span class="c">! Index to heating sequence/priority for this zone</span>
<a name="ln-98"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ControlZoneName</span> <span class="c">! Controlled zone name</span>
<a name="ln-99"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NodeNumofControlledZone</span> <span class="o">=</span><span class="mi">0</span> <span class="c">! Controlled zone node number</span>
<a name="ln-100"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">FlowFraction</span>          <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Fraction of the total volume flow that goes through the controlling zone</span>
<a name="ln-101"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanName</span>        <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! Name of supply air fan</span>
<a name="ln-102"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">FanType</span>               <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Supply fan type</span>
<a name="ln-103"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">FanNum</span>                <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Supply fan number</span>
<a name="ln-104"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">FanPlaceType</span>          <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Supply air fan placement: 1 Blow through; 2 Draw through</span>
<a name="ln-105"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">FanInletNode</span>          <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Fan Inlet node</span>
<a name="ln-106"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">FanOutletNode</span>         <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Fan Outlet node</span>
<a name="ln-107"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">FanVolFlow</span>            <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Supply fan volumetric flow rate</span>
<a name="ln-108"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanSchedule</span>    <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! Supply air fan operating mode schedule name</span>
<a name="ln-109"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">FanSchedPtr</span>           <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Pointer to the Supply air fan operating mode schedule</span>
<a name="ln-110"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">OpMode</span>                <span class="o">=</span> <span class="mi">0</span>  <span class="c">! mode of operation; 1=cycling fan, cycling compressor; 2=continuous fan, cycling compresor</span>
<a name="ln-111"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXHeatCoilName</span>  <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! COIL:DX:MultiSpeed:Heating name</span>
<a name="ln-112"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">HeatCoilType</span>          <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Heating coil type: 1 COIL:DX:MultiSpeed:Heating only</span>
<a name="ln-113"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">HeatCoilNum</span>           <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Heating coil number</span>
<a name="ln-114"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">DXHeatCoilIndex</span>       <span class="o">=</span> <span class="mi">0</span>  <span class="c">! DX heating coil index number</span>
<a name="ln-115"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MinOATCompressor</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Minimum outdoor dry-bulb temperature for compressor operation</span>
<a name="ln-116"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCoilName</span>  <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! Coil:Electric:MultiSpeed:Heating OR Coil:Gas:MultiSpeed:Heating name</span>
<a name="ln-117"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">HeatCoilIndex</span>       <span class="o">=</span> <span class="mi">0</span>  <span class="c">! heating coil index number (Coil:Electric:MultiSpeed:Heating OR Coil:Gas:MultiSpeed:Heating)</span>
<a name="ln-118"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoolCoilName</span>  <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! COIL:DX:MultiSpeed:Cooling name</span>
<a name="ln-119"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">CoolCoilType</span>          <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Cooling coil type: 1 COIL:DX:MultiSpeed:Cooling only</span>
<a name="ln-120"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">CoolCoilNum</span>           <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Cooling coil number</span>
<a name="ln-121"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">DXCoolCoilIndex</span>       <span class="o">=</span> <span class="mi">0</span>  <span class="c">! DX cooling coil index number</span>
<a name="ln-122"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SuppHeatCoilName</span>  <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! Supplymental heating coil name</span>
<a name="ln-123"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">SuppHeatCoilType</span>      <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Supplymental heating coil type: 1 Gas; 2 Electric; 3 Recovery</span>
<a name="ln-124"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">SuppHeatCoilNum</span>       <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Supplymental heating coil number</span>
<a name="ln-125"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Supplemental heating coil design capacity</span>
<a name="ln-126"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">SuppMaxAirTemp</span>        <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Maximum supply air temperature from supplemental heater</span>
<a name="ln-127"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">SuppMaxOATemp</span>         <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Maximum outdoor dry-bulb temperature for supplemental heater operation</span>
<a name="ln-128"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">AuxOnCyclePower</span>       <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Auxiliary On-Cycle Electric Power</span>
<a name="ln-129"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">AuxOffCyclePower</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Auxiliary Off-Cycle Electric Power</span>
<a name="ln-130"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">DesignHeatRecFlowRate</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Design water volume flow rate through heat recovery loop [m3/s]</span>
<a name="ln-131"></a>  <span class="kt">LOGICAL</span>  <span class="kd">::</span> <span class="n">HeatRecActive</span>    <span class="o">=</span> <span class="p">.</span><span class="n">False</span><span class="p">.</span> <span class="c">! True when entered Heat Rec Vol Flow Rate &gt; 0</span>
<a name="ln-132"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatRecName</span>  <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! heat recovery water inlet name</span>
<a name="ln-133"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">HeatRecInletNodeNum</span>   <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Node number on heat recovery water inlet</span>
<a name="ln-134"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">HeatRecOutletNodeNum</span>  <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Node number on heat recovery water outlet</span>
<a name="ln-135"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MaxHeatRecOutletTemp</span>  <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Maximum outlet water temperature for heat recovery</span>
<a name="ln-136"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">DesignHeatRecMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Design water mass flow rate through heat recovery loop [kg/s]</span>
<a name="ln-137"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">HRLoopNum</span>        <span class="o">=</span> <span class="mi">0</span>  <span class="c">! plant loop number for heat recovery</span>
<a name="ln-138"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">HRLoopSideNum</span>    <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Plant loop side for heat recovery</span>
<a name="ln-139"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">HRBranchNum</span>      <span class="o">=</span> <span class="mi">0</span>  <span class="c">! plant loop branch for heat recovery</span>
<a name="ln-140"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">HRCompNum</span>        <span class="o">=</span> <span class="mi">0</span>  <span class="c">! plant loop component for heat recovery</span>
<a name="ln-141"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">AuxElecPower</span>          <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Auxiliary Electric Power</span>
<a name="ln-142"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">IdleVolumeAirRate</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Supply air volumetric flow rate when no cooling or heating is needed</span>
<a name="ln-143"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">IdleMassFlowRate</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Supply air mass flow rate when no cooling or heating is needed</span>
<a name="ln-144"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">IdleSpeedRatio</span>        <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Fan speed ratio in idle mode</span>
<a name="ln-145"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumOfSpeedCooling</span>     <span class="o">=</span><span class="mi">0</span>   <span class="c">! The number of speeds for cooling</span>
<a name="ln-146"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumOfSpeedHeating</span>     <span class="o">=</span><span class="mi">0</span>   <span class="c">! The number of speeds for heating</span>
<a name="ln-147"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">HeatVolumeFlowRate</span> <span class="c">! Supply air volume flow rate during heating operation</span>
<a name="ln-148"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">HeatMassFlowRate</span> <span class="c">! Supply air mass flow rate during heating operation</span>
<a name="ln-149"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">CoolVolumeFlowRate</span> <span class="c">! Supply air volume flow rate during cooling operation</span>
<a name="ln-150"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">CoolMassFlowRate</span> <span class="c">! Supply air mass flow rate during cooling operation</span>
<a name="ln-151"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">HeatingSpeedRatio</span> <span class="c">! Fan speed ratio in heating mode</span>
<a name="ln-152"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">CoolingSpeedRatio</span> <span class="c">! Fan speed ratio in cooling mode</span>
<a name="ln-153"></a>  <span class="kt">LOGICAL</span>  <span class="kd">::</span> <span class="n">CheckFanFlow</span>      <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! Supply airflow check</span>
<a name="ln-154"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">LastMode</span>              <span class="o">=</span> <span class="mi">0</span>  <span class="c">! MSHP operation mode</span>
<a name="ln-155"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">HeatCoolMode</span>          <span class="o">=</span> <span class="mi">0</span>  <span class="c">! System operating mode (0 = floating, 1 = cooling, 2 = heating)</span>
<a name="ln-156"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">AirLoopNumber</span>         <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Air loop served by the engine driven heat pump system</span>
<a name="ln-157"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumControlledZones</span>    <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Number of controlled zones for this system</span>
<a name="ln-158"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">ZoneInletNode</span>         <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Zone inlet node number in the controlled zone</span>
<a name="ln-159"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">CompPartLoadRatio</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Compressor part load ratio</span>
<a name="ln-160"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">FanPartLoadRatio</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Fan part load ratio</span>
<a name="ln-161"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">TotCoolEnergyRate</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Total cooling enertgy rate</span>
<a name="ln-162"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">TotHeatEnergyRate</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Total heating enertgy rate</span>
<a name="ln-163"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">SensCoolEnergyRate</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sensible cooling enertgy rate</span>
<a name="ln-164"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">SensHeatEnergyRate</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sensible heating enertgy rate</span>
<a name="ln-165"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">LatCoolEnergyRate</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Latent cooling enertgy rate</span>
<a name="ln-166"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">LatHeatEnergyRate</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Latent heating enertgy rate</span>
<a name="ln-167"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">ElecPower</span>             <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Electric power (fan + supplemental electric coil)</span>
<a name="ln-168"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">LoadMet</span>               <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! met system load</span>
<a name="ln-169"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">HeatRecoveryRate</span>       <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Heat recovery rate [W]</span>
<a name="ln-170"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">HeatRecoveryInletTemp</span>  <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Inlet temperature for heat recovery rate [C]</span>
<a name="ln-171"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">HeatRecoveryOutletTemp</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Outlet temperature for heat recovery rate [C]</span>
<a name="ln-172"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">HeatRecoveryMassFlowRate</span><span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Mass flow rate for heat recovery rate [kg/s]</span>
<a name="ln-173"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">AirFlowControl</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! fan control mode, UseCompressorOnFlow or UseCompressorOffFlow</span>
<a name="ln-174"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">ErrIndexCyc</span>          <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Error index at low speed</span>
<a name="ln-175"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">ErrIndexVar</span>          <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Error index at high speed</span>
<a name="ln-176"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">LoadLoss</span>              <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Air distribution system loss</span>
<a name="ln-177"></a>
<a name="ln-178"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppCoilAirInletNode</span>          <span class="o">=</span><span class="mi">0</span>  <span class="c">! air inlet node number of supplemental heating coil</span>
<a name="ln-179"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppCoilAirOutletNode</span>         <span class="o">=</span><span class="mi">0</span>  <span class="c">! air outlet node number of supplemental heating coil</span>
<a name="ln-180"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppHeatCoilType_Num</span>          <span class="o">=</span><span class="mi">0</span>  <span class="c">! Numeric Equivalent for Supplemental Heat Coil Type</span>
<a name="ln-181"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppHeatCoilIndex</span>             <span class="o">=</span><span class="mi">0</span>  <span class="c">! Index to supplemental heater</span>
<a name="ln-182"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppCoilControlNode</span>           <span class="o">=</span><span class="mi">0</span>  <span class="c">! control node for simple water and steam heating coil</span>
<a name="ln-183"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxSuppCoilFluidFlow</span>          <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! water or steam mass flow rate for supplemental heating coil [kg/s]</span>
<a name="ln-184"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppCoilOutletNode</span>            <span class="o">=</span><span class="mi">0</span>  <span class="c">! outlet node for hot water and steam supplemental heating coil</span>
<a name="ln-185"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoilAirInletNode</span>              <span class="o">=</span><span class="mi">0</span>  <span class="c">! air inlet node number of supplemental heating coil</span>
<a name="ln-186"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoilControlNode</span>               <span class="o">=</span><span class="mi">0</span>  <span class="c">! control node for simple water and steam heating coil</span>
<a name="ln-187"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxCoilFluidFlow</span>              <span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! water or steam mass flow rate for supplemental heating coil [kg/s]</span>
<a name="ln-188"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoilOutletNode</span>                <span class="o">=</span><span class="mi">0</span>  <span class="c">! outlet node for hot water and steam supplemental heating coil</span>
<a name="ln-189"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HotWaterCoilControlNode</span>       <span class="o">=</span><span class="mi">0</span>
<a name="ln-190"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HotWaterCoilOutletNode</span>        <span class="o">=</span><span class="mi">0</span>
<a name="ln-191"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HotWaterCoilName</span>  <span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-192"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HotWaterCoilNum</span>               <span class="o">=</span><span class="mi">0</span>
<a name="ln-193"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoopNum</span>                       <span class="o">=</span><span class="mi">0</span>  <span class="c">! plant loop index for hot water and steam heating coil</span>
<a name="ln-194"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoopSide</span>                      <span class="o">=</span><span class="mi">0</span>  <span class="c">! plant loop side  index for hot water and steam heating coil</span>
<a name="ln-195"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">BranchNum</span>                     <span class="o">=</span><span class="mi">0</span>  <span class="c">! plant loop branch index for water and steam heating coil</span>
<a name="ln-196"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CompNum</span>                       <span class="o">=</span><span class="mi">0</span>  <span class="c">! plant loop component index for hot water and steam heating coil</span>
<a name="ln-197"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppLoopNum</span>                   <span class="o">=</span><span class="mi">0</span>  <span class="c">! plant loop index for hot water and steam supplemental heating coil</span>
<a name="ln-198"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppLoopSide</span>                  <span class="o">=</span><span class="mi">0</span>  <span class="c">! plant loop side  index for hot water and steam supplemental heating coil</span>
<a name="ln-199"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppBranchNum</span>                 <span class="o">=</span><span class="mi">0</span>  <span class="c">! plant loop branch index for water and steam supplemental heating coil</span>
<a name="ln-200"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppCompNum</span>                   <span class="o">=</span><span class="mi">0</span>  <span class="c">! plant loop component index for hot water and steam supplemental heating coil</span>
<a name="ln-201"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HotWaterLoopNum</span>               <span class="o">=</span><span class="mi">0</span>  <span class="c">! plant loop index for hot water and steam heating coil</span>
<a name="ln-202"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HotWaterLoopSide</span>              <span class="o">=</span><span class="mi">0</span>  <span class="c">! plant loop side  index for hot water and steam heating coil</span>
<a name="ln-203"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HotWaterBranchNum</span>             <span class="o">=</span><span class="mi">0</span>  <span class="c">! plant loop branch index for water and steam heating coil</span>
<a name="ln-204"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HotWaterCompNum</span>               <span class="o">=</span><span class="mi">0</span>  <span class="c">! plant loop component index for hot water and steam heating coil</span>
<a name="ln-205"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">HotWaterCoilMaxIterIndex</span>      <span class="o">=</span><span class="mi">0</span>  <span class="c">! Index to recurring warning message</span>
<a name="ln-206"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">HotWaterCoilMaxIterIndex2</span>     <span class="o">=</span><span class="mi">0</span>  <span class="c">! Index to recurring warning message</span>
<a name="ln-207"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">StageNum</span>                      <span class="o">=</span><span class="mi">0</span>  <span class="c">! Stage number specified by staged thermostat</span>
<a name="ln-208"></a>  <span class="kt">LOGICAL</span>  <span class="kd">::</span> <span class="n">Staged</span>      <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>                 <span class="c">! Using Staged thermostat</span>
<a name="ln-209"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoolCountAvail</span>                 <span class="o">=</span><span class="mi">0</span> <span class="c">! Counter used to minimize the occurrence of output warnings</span>
<a name="ln-210"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoolIndexAvail</span>                 <span class="o">=</span><span class="mi">0</span> <span class="c">! Index used to minimize the occurrence of output warnings</span>
<a name="ln-211"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatCountAvail</span>                 <span class="o">=</span><span class="mi">0</span> <span class="c">! Counter used to minimize the occurrence of output warnings</span>
<a name="ln-212"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatIndexAvail</span>                 <span class="o">=</span><span class="mi">0</span> <span class="c">! Index used to minimize the occurrence of output warnings</span>
<a name="ln-213"></a>
<a name="ln-214"></a><span class="k">END TYPE </span><span class="n">MSHeatPumpData</span>
<a name="ln-215"></a>
<a name="ln-216"></a><span class="k">TYPE </span><span class="n">MSHeatPumpReportData</span>
<a name="ln-217"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">ElecPowerConsumption</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Electricity power comsumption: CondenserFan+CrankcaseHeater+Defroster+aux</span>
<a name="ln-218"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">HeatRecoveryEnergy</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Heat recovery rate [J]</span>
<a name="ln-219"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">CycRatio</span>               <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Cycle ratio</span>
<a name="ln-220"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">SpeedRatio</span>             <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Speed ratio between two stages</span>
<a name="ln-221"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">SpeedNum</span>               <span class="o">=</span><span class="mi">0</span>   <span class="c">! Speed number</span>
<a name="ln-222"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">AuxElecCoolConsumption</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Auxiliary electricity power consumption during cooling</span>
<a name="ln-223"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">AuxElecHeatConsumption</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Auxiliary electricity power consumption during heating</span>
<a name="ln-224"></a><span class="k">END TYPE </span><span class="n">MSHeatPumpReportData</span>
<a name="ln-225"></a>
<a name="ln-226"></a>  <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-227"></a><span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">NumMSHeatPumps</span> <span class="o">=</span> <span class="mi">0</span>            <span class="c">! Number of multi speed heat pumps</span>
<a name="ln-228"></a><span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">AirLoopPass</span> <span class="o">=</span> <span class="mi">0</span>               <span class="c">! Number of air loop pass</span>
<a name="ln-229"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TempSteamIn</span> <span class="o">=</span> <span class="mi">10</span><span class="mf">0.0d0</span>           <span class="c">! steam coil steam inlet temperature</span>
<a name="ln-230"></a>
<a name="ln-231"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">MSHeatPumpData</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MSHeatPump</span>
<a name="ln-232"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">MSHeatPumpReportData</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MSHeatPumpReport</span>
<a name="ln-233"></a>
<a name="ln-234"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurrentModuleObject</span>   <span class="c">! Object type for getting and error messages</span>
<a name="ln-235"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CompOnMassFlow</span>         <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! System air mass flow rate w/ compressor ON</span>
<a name="ln-236"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CompOffMassFlow</span>        <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! System air mass flow rate w/ compressor OFF</span>
<a name="ln-237"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CompOnFlowRatio</span>        <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! fan flow ratio when coil on</span>
<a name="ln-238"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CompOffFlowRatio</span>       <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! fan flow ratio when coil off</span>
<a name="ln-239"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FanSpeedRatio</span>          <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! fan speed ratio passed to on/off fan object</span>
<a name="ln-240"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupHeaterLoad</span>          <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! load to be met by supplemental heater [W]</span>
<a name="ln-241"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SaveLoadResidual</span>       <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Saved load residual used to check convergence</span>
<a name="ln-242"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SaveCompressorPLR</span>      <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! holds compressor PLR from active DX coil</span>
<a name="ln-243"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckEquipName</span>
<a name="ln-244"></a>
<a name="ln-245"></a>  <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE</span>
<a name="ln-246"></a>
<a name="ln-247"></a><span class="k">PUBLIC  </span><span class="n">SimMSHeatPump</span>
<a name="ln-248"></a><span class="k">PRIVATE </span><span class="n">SimMSHP</span>
<a name="ln-249"></a><span class="k">PRIVATE </span><span class="n">GetMSHeatPumpInput</span>
<a name="ln-250"></a><span class="k">PRIVATE </span><span class="n">InitMSHeatPump</span>
<a name="ln-251"></a><span class="k">PRIVATE </span><span class="n">ControlMSHPOutput</span>
<a name="ln-252"></a><span class="k">PRIVATE </span><span class="n">MSHPCyclingResidual</span>
<a name="ln-253"></a><span class="k">PRIVATE </span><span class="n">MSHPVarSpeedResidual</span>
<a name="ln-254"></a><span class="k">PRIVATE </span><span class="n">CalcMSHeatPump</span>
<a name="ln-255"></a><span class="k">PRIVATE </span><span class="n">SizeMSHeatPump</span>
<a name="ln-256"></a><span class="k">PRIVATE </span><span class="n">MSHPHeatRecovery</span>
<a name="ln-257"></a><span class="k">PRIVATE </span><span class="n">UpdateMSHeatPump</span>
<a name="ln-258"></a><span class="k">PRIVATE </span><span class="n">ReportMSHeatPump</span>
<a name="ln-259"></a><span class="k">PRIVATE </span><span class="n">SetAverageAirFlow</span>
<a name="ln-260"></a><span class="k">PRIVATE </span><span class="n">CalcNonDXHeatingCoils</span>
<a name="ln-261"></a>
<a name="ln-262"></a>
<a name="ln-263"></a><span class="k">CONTAINS</span>
<a name="ln-264"></a>
<a name="ln-265"></a><span class="k">SUBROUTINE </span><span class="n">SimMSHeatPump</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">CompIndex</span><span class="p">)</span>
<a name="ln-266"></a>
<a name="ln-267"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-268"></a>          <span class="c">!       AUTHOR         Lixing Gu, Florida Solar Energy Center</span>
<a name="ln-269"></a>          <span class="c">!       DATE WRITTEN   June. 2007</span>
<a name="ln-270"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-271"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-272"></a>
<a name="ln-273"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-274"></a>          <span class="c">! Manages the simulation of multispeed heat pump.</span>
<a name="ln-275"></a>
<a name="ln-276"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-277"></a>          <span class="c">! NA</span>
<a name="ln-278"></a>
<a name="ln-279"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-280"></a>          <span class="c">! na</span>
<a name="ln-281"></a>
<a name="ln-282"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-283"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-284"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-285"></a>
<a name="ln-286"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-287"></a>
<a name="ln-288"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-289"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span>    <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompName</span>            <span class="c">! Name of the unitary engine driven heat pump system</span>
<a name="ln-290"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>          <span class="k">INTENT</span>    <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! TRUE if 1st HVAC simulation of system time step</span>
<a name="ln-291"></a>  <span class="kt">INTEGER</span><span class="p">,</span>          <span class="k">INTENT</span>    <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirLoopNum</span>          <span class="c">! air loop index</span>
<a name="ln-292"></a>  <span class="kt">INTEGER</span><span class="p">,</span>          <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompIndex</span>           <span class="c">! Index to changeover-bypass VAV system</span>
<a name="ln-293"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-294"></a>          <span class="c">! na</span>
<a name="ln-295"></a>
<a name="ln-296"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-297"></a>          <span class="c">! na</span>
<a name="ln-298"></a>
<a name="ln-299"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-300"></a>          <span class="c">! na</span>
<a name="ln-301"></a>
<a name="ln-302"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-303"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">MSHeatPumpNum</span>          <span class="c">! index of fan coil unit being simulated</span>
<a name="ln-304"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">GetInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! Get input flag</span>
<a name="ln-305"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>      <span class="c">! Ratio of compressor ON airflow to average airflow over timestep</span>
<a name="ln-306"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">QZnLoad</span>                <span class="c">! Zone load required by all zones served by this air loop system</span>
<a name="ln-307"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">QSensUnitOut</span>           <span class="c">! MSHP sensible capacity output [W]</span>
<a name="ln-308"></a>  <span class="c">! FLOW</span>
<a name="ln-309"></a>
<a name="ln-310"></a>  <span class="c">! First time SimMSHeatPump is called, get the input</span>
<a name="ln-311"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-312"></a><span class="k">    CALL </span><span class="n">GetMSHeatPumpInput</span>
<a name="ln-313"></a>    <span class="n">GetInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Set GetInputFlag false so you don&#39;t get coil inputs again</span>
<a name="ln-314"></a>  <span class="k">END IF</span>
<a name="ln-315"></a>
<a name="ln-316"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-317"></a><span class="k">    </span><span class="n">MSHeatPumpNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumMSheatPumps</span><span class="p">)</span>
<a name="ln-318"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPumpNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-319"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;MultiSpeed Heat Pump is not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-320"></a>    <span class="n">ENDIF</span>
<a name="ln-321"></a>    <span class="n">CompIndex</span><span class="o">=</span><span class="n">MSHeatPumpNum</span>
<a name="ln-322"></a>  <span class="k">ELSE</span>
<a name="ln-323"></a><span class="k">    </span><span class="n">MSHeatPumpNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-324"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPumpNum</span> <span class="o">&gt;</span> <span class="n">NumMSHeatPumps</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">MSHeatPumpNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-325"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimMSHeatPump: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-326"></a>                        <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-327"></a>                        <span class="s1">&#39;, Number of MultiSpeed Heat Pumps=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumMSHeatPumps</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-328"></a>                        <span class="s1">&#39;, Heat Pump name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-329"></a>    <span class="n">ENDIF</span>
<a name="ln-330"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-331"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">CompName</span> <span class="o">/=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-332"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimMSHeatPump: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-333"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-334"></a>                          <span class="s1">&#39;, Heat Pump name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-335"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-336"></a>      <span class="n">ENDIF</span>
<a name="ln-337"></a>      <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-338"></a>    <span class="n">ENDIF</span>
<a name="ln-339"></a>  <span class="n">ENDIF</span>
<a name="ln-340"></a>
<a name="ln-341"></a>  <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-342"></a>
<a name="ln-343"></a>  <span class="c">! Initialize the engine driven heat pump</span>
<a name="ln-344"></a>  <span class="k">CALL </span><span class="n">InitMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">QZnLoad</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-345"></a>
<a name="ln-346"></a>  <span class="k">CALL </span><span class="n">SimMSHP</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">QSensUnitOut</span><span class="p">,</span> <span class="n">QZnLoad</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-347"></a>
<a name="ln-348"></a>  <span class="c">! Update the unit outlet nodes</span>
<a name="ln-349"></a>  <span class="k">CALL </span><span class="n">UpdateMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span>
<a name="ln-350"></a>
<a name="ln-351"></a>  <span class="c">! Report the result of the simulation</span>
<a name="ln-352"></a>  <span class="k">CALL </span><span class="n">ReportMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span>
<a name="ln-353"></a>
<a name="ln-354"></a>
<a name="ln-355"></a><span class="k">RETURN</span>
<a name="ln-356"></a><span class="k">END SUBROUTINE </span><span class="n">SimMSHeatPump</span>
<a name="ln-357"></a>
<a name="ln-358"></a><span class="c">!******************************************************************************</span>
<a name="ln-359"></a>
<a name="ln-360"></a><span class="k">SUBROUTINE </span><span class="n">SimMSHP</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">QSensUnitOut</span><span class="p">,</span> <span class="n">QZnReq</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-361"></a>
<a name="ln-362"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-363"></a>          <span class="c">!       AUTHOR         Lixing Gu</span>
<a name="ln-364"></a>          <span class="c">!       DATE WRITTEN   June 2007</span>
<a name="ln-365"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-366"></a>          <span class="c">!       RE-ENGINEERED  Revised based on SimPTHP</span>
<a name="ln-367"></a>
<a name="ln-368"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-369"></a>          <span class="c">! Simulate a multispeed heat pump; adjust its output to match the</span>
<a name="ln-370"></a>          <span class="c">! required system load.</span>
<a name="ln-371"></a>
<a name="ln-372"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-373"></a>          <span class="c">! Calls ControlMSHPOutput to obtain the desired unit output</span>
<a name="ln-374"></a>
<a name="ln-375"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-376"></a>          <span class="c">! na</span>
<a name="ln-377"></a>
<a name="ln-378"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-379"></a>  <span class="k">USE </span><span class="n">DataZoneEnergyDemands</span>
<a name="ln-380"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SmallMassFlow</span><span class="p">,</span> <span class="n">SmallLoad</span>
<a name="ln-381"></a>  <span class="k">USE </span><span class="n">DataZoneEquipment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneEquipConfig</span>
<a name="ln-382"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">AirLoopControlInfo</span>
<a name="ln-383"></a>
<a name="ln-384"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-385"></a>
<a name="ln-386"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-387"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! TRUE if 1st HVAC simulation of system timestep</span>
<a name="ln-388"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MSHeatPumpNum</span>      <span class="c">! number of the current engine driven Heat Pump being simulated</span>
<a name="ln-389"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QZnReq</span>             <span class="c">! required zone load</span>
<a name="ln-390"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QSensUnitOut</span>       <span class="c">! cooling/heating deliveded to zones [W]</span>
<a name="ln-391"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! ratio of compressor ON airflow to AVERAGE airflow over timestep</span>
<a name="ln-392"></a>
<a name="ln-393"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-394"></a>          <span class="c">! na</span>
<a name="ln-395"></a>
<a name="ln-396"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-397"></a>          <span class="c">! na</span>
<a name="ln-398"></a>
<a name="ln-399"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-400"></a>          <span class="c">! na</span>
<a name="ln-401"></a>
<a name="ln-402"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-403"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PartLoadFrac</span>      <span class="c">! compressor part load fraction</span>
<a name="ln-404"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SpeedRatio</span>        <span class="c">! compressor speed ratio</span>
<a name="ln-405"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">UnitOn</span>            <span class="c">! TRUE if unit is on</span>
<a name="ln-406"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OutletNode</span>        <span class="c">! MSHP air outlet node</span>
<a name="ln-407"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">InletNode</span>         <span class="c">! MSHP air inlet node</span>
<a name="ln-408"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirMassFlow</span>       <span class="c">! air mass flow rate [kg/s]</span>
<a name="ln-409"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OpMode</span>            <span class="c">! operating mode (fan cycling or continious; DX coil always cycles)</span>
<a name="ln-410"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span>           <span class="c">! Controlled zone number</span>
<a name="ln-411"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QTotUnitOut</span>
<a name="ln-412"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SpeedNum</span>          <span class="c">! Speed number</span>
<a name="ln-413"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupHeaterLoad</span>
<a name="ln-414"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CompOp</span>            <span class="c">! compressor operation; 1=on, 0=off</span>
<a name="ln-415"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AirLoopNumber</span>     <span class="c">! Index to air loop</span>
<a name="ln-416"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SaveMassFlowRate</span>  <span class="c">! saved inlet air mass flow rate [kg/s]</span>
<a name="ln-417"></a>
<a name="ln-418"></a>  <span class="c">! zero the fan, DX coils, and supplemental electric heater electricity consumption</span>
<a name="ln-419"></a>  <span class="n">FanElecPower</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-420"></a>  <span class="n">DXElecHeatingPower</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-421"></a>  <span class="n">DXElecCoolingPower</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-422"></a>  <span class="n">SaveCompressorPLR</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-423"></a>  <span class="n">ElecHeatingCoilPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-424"></a>
<a name="ln-425"></a>  <span class="c">! initialize local variables</span>
<a name="ln-426"></a>  <span class="n">UnitOn</span>      <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-427"></a>  <span class="n">OutletNode</span>  <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>
<a name="ln-428"></a>  <span class="n">InletNode</span>   <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-429"></a>  <span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-430"></a>  <span class="n">OpMode</span>      <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span>
<a name="ln-431"></a>  <span class="n">ZoneNum</span>     <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span>
<a name="ln-432"></a>  <span class="n">CompOp</span>      <span class="o">=</span> <span class="n">On</span>
<a name="ln-433"></a>
<a name="ln-434"></a>  <span class="c">! set the on/off flags</span>
<a name="ln-435"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OPMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-436"></a>    <span class="c">! cycling unit only runs if there is a cooling or heating load.</span>
<a name="ln-437"></a>     <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">QZnReq</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SmallLoad</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">AirMassFlow</span> <span class="o">&lt;</span> <span class="n">SmallMassFlow</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurDeadbandOrSetback</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-438"></a><span class="k">       </span><span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-439"></a>     <span class="k">END IF</span>
<a name="ln-440"></a><span class="k">  ELSE IF</span>  <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OPMode</span> <span class="o">==</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-441"></a>    <span class="c">! continuous unit: fan runs if scheduled on; coil runs only if there is a cooling or heating load</span>
<a name="ln-442"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">AirMassFlow</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="n">SmallMassFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-443"></a><span class="k">      </span><span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-444"></a>    <span class="k">END IF</span>
<a name="ln-445"></a><span class="k">  END IF</span>
<a name="ln-446"></a>
<a name="ln-447"></a><span class="k">  </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-448"></a>
<a name="ln-449"></a>  <span class="n">AirLoopNumber</span> <span class="o">=</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span><span class="n">AirLoopNum</span>
<a name="ln-450"></a>  <span class="n">SaveMassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-451"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OPMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">&amp;</span>
<a name="ln-452"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">EconoActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-453"></a>       <span class="c">! for cycling fan, cooling load, check whether furnace can meet load with compressor off</span>
<a name="ln-454"></a>    <span class="n">CompOp</span> <span class="o">=</span> <span class="n">Off</span>
<a name="ln-455"></a>    <span class="k">CALL </span><span class="n">ControlMSHPOutput</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span><span class="n">ZoneNum</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-456"></a>                         <span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-457"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SpeedRatio</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-458"></a>      <span class="c">! compressor on (reset inlet air mass flow rate to starting value)</span>
<a name="ln-459"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">SaveMassFlowRate</span>
<a name="ln-460"></a>      <span class="n">CompOp</span> <span class="o">=</span> <span class="n">On</span>
<a name="ln-461"></a>      <span class="k">CALL </span><span class="n">ControlMSHPOutput</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span><span class="n">ZoneNum</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-462"></a>                         <span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-463"></a>    <span class="k">END IF</span>
<a name="ln-464"></a><span class="k">  ELSE</span>
<a name="ln-465"></a>     <span class="c">! compressor on</span>
<a name="ln-466"></a>     <span class="k">CALL </span><span class="n">ControlMSHPOutput</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span><span class="n">ZoneNum</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-467"></a>                         <span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-468"></a>  <span class="k">END IF</span>
<a name="ln-469"></a>
<a name="ln-470"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">MultiSpeedHeatingCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-471"></a><span class="k">    </span><span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-472"></a>  <span class="k">ELSE</span>
<a name="ln-473"></a><span class="k">    IF</span><span class="p">(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-474"></a><span class="k">      </span><span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-475"></a>    <span class="k">END IF</span>
<a name="ln-476"></a>
<a name="ln-477"></a><span class="k">    If</span> <span class="p">(</span><span class="n">PartLoadFrac</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SaveCompressorPLR</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Staged</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-478"></a><span class="k">      </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">SaveCompressorPLR</span>
<a name="ln-479"></a>    <span class="k">End If</span>
<a name="ln-480"></a><span class="k">  END IF</span>
<a name="ln-481"></a>
<a name="ln-482"></a><span class="k">  CALL </span><span class="n">CalcMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">QSensUnitOut</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-483"></a>                      <span class="n">QZnReq</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-484"></a>
<a name="ln-485"></a>  <span class="c">! calculate delivered capacity</span>
<a name="ln-486"></a>  <span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-487"></a>
<a name="ln-488"></a>  <span class="n">QTotUnitOut</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Enthalpy</span><span class="p">)</span>
<a name="ln-489"></a>
<a name="ln-490"></a>  <span class="c">! report variables</span>
<a name="ln-491"></a>  <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">SaveCompressorPLR</span>
<a name="ln-492"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-493"></a><span class="k">    If</span> <span class="p">(</span><span class="n">SupHeaterLoad</span> <span class="o">&gt;</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-494"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-495"></a>    <span class="k">Else</span>
<a name="ln-496"></a><span class="k">      If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-497"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-498"></a>      <span class="k">Else</span>
<a name="ln-499"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-500"></a>      <span class="k">End If</span>
<a name="ln-501"></a><span class="k">    End If</span>
<a name="ln-502"></a><span class="k">  ELSE</span>
<a name="ln-503"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-504"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-505"></a>    <span class="k">ELSE</span>
<a name="ln-506"></a><span class="k">      If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-507"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-508"></a>      <span class="k">Else</span>
<a name="ln-509"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-510"></a>      <span class="k">End If</span>
<a name="ln-511"></a><span class="k">    END IF</span>
<a name="ln-512"></a><span class="k">  END IF</span>
<a name="ln-513"></a>
<a name="ln-514"></a><span class="k">  If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">HeatingMode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-515"></a><span class="k">    </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">TotHeatEnergyRate</span>  <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">QTotUnitOut</span><span class="p">))</span>
<a name="ln-516"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SensHeatEnergyRate</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">QSensUnitOut</span><span class="p">))</span>
<a name="ln-517"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LatHeatEnergyRate</span>  <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">QTotUnitOut</span> <span class="o">-</span> <span class="n">QSensUnitOut</span><span class="p">)))</span>
<a name="ln-518"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">TotCoolEnergyRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-519"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SensCoolEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-520"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LatCoolEnergyRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-521"></a>  <span class="k">End If</span>
<a name="ln-522"></a><span class="k">  If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">CoolingMode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-523"></a><span class="k">    </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">TotCoolEnergyRate</span>  <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">QTotUnitOut</span><span class="p">))</span>
<a name="ln-524"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SensCoolEnergyRate</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">QSensUnitOut</span><span class="p">))</span>
<a name="ln-525"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LatCoolEnergyRate</span>  <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">QTotUnitOut</span> <span class="o">-</span> <span class="n">QSensUnitOut</span><span class="p">)))</span>
<a name="ln-526"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">TotHeatEnergyRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-527"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SensHeatEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-528"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LatHeatEnergyRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-529"></a>  <span class="k">End If</span>
<a name="ln-530"></a>
<a name="ln-531"></a><span class="k">  </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxElecPower</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxOnCyclePower</span><span class="o">*</span><span class="n">SaveCompressorPLR</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-532"></a>                                           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxOffCyclePower</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SaveCompressorPLR</span><span class="p">)</span>
<a name="ln-533"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">MultiSpeedHeatingCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-534"></a><span class="k">    SELECT CASE</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span><span class="p">)</span>
<a name="ln-535"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingGas_MultiStage</span><span class="p">,</span> <span class="n">Coil_HeatingElectric_MultiStage</span><span class="p">)</span>
<a name="ln-536"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ElecPower</span> <span class="o">=</span> <span class="n">FanElecPower</span> <span class="o">+</span> <span class="n">DXElecCoolingPower</span> <span class="o">+</span> <span class="n">ElecHeatingCoilPower</span>
<a name="ln-537"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">Coil_HeatingWater</span><span class="p">,</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span>
<a name="ln-538"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ElecPower</span> <span class="o">=</span> <span class="n">FanElecPower</span> <span class="o">+</span> <span class="n">DXElecCoolingPower</span>
<a name="ln-539"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-540"></a>    <span class="k">END SELECT</span>
<a name="ln-541"></a><span class="k">  ELSE</span>
<a name="ln-542"></a><span class="k">    </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ElecPower</span> <span class="o">=</span> <span class="n">FanElecPower</span> <span class="o">+</span> <span class="n">DXElecCoolingPower</span> <span class="o">+</span> <span class="n">DXElecHeatingPower</span> <span class="o">+</span> <span class="n">ElecHeatingCoilPower</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-543"></a>                                          <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxElecPower</span>
<a name="ln-544"></a>  <span class="n">ENDIF</span>
<a name="ln-545"></a>
<a name="ln-546"></a>  <span class="k">RETURN</span>
<a name="ln-547"></a><span class="k">END SUBROUTINE </span><span class="n">SimMSHP</span>
<a name="ln-548"></a>
<a name="ln-549"></a><span class="c">!******************************************************************************</span>
<a name="ln-550"></a>
<a name="ln-551"></a><span class="k">SUBROUTINE </span><span class="n">GetMSHeatPumpInput</span>
<a name="ln-552"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-553"></a>            <span class="c">!       AUTHOR:          Lixing Gu, FSEC</span>
<a name="ln-554"></a>            <span class="c">!       DATE WRITTEN:    July 2007</span>
<a name="ln-555"></a>            <span class="c">!       MODIFIED         na</span>
<a name="ln-556"></a>            <span class="c">!       RE-ENGINEERED    na</span>
<a name="ln-557"></a>
<a name="ln-558"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-559"></a>            <span class="c">!  This routine will get the input required by the multispeed heat pump model</span>
<a name="ln-560"></a>
<a name="ln-561"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-562"></a>            <span class="c">! na</span>
<a name="ln-563"></a>
<a name="ln-564"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-565"></a>
<a name="ln-566"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-567"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="n">SetupOutputVariable</span><span class="p">,</span> <span class="n">ShowContinueError</span>
<a name="ln-568"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">SameString</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">GetObjectItemNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-569"></a>                                   <span class="n">GetObjectDefMaxArgs</span>
<a name="ln-570"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-571"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-572"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindGlycol</span>
<a name="ln-573"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-574"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-575"></a>  <span class="k">USE </span><span class="n">GlobalNames</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">VerifyUniqueChillerName</span>
<a name="ln-576"></a>  <span class="k">USE </span><span class="n">DataSizing</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">Autosize</span>
<a name="ln-577"></a>  <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>                  <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetFanType</span><span class="p">,</span> <span class="n">GetFanIndex</span><span class="p">,</span> <span class="n">GetFanVolFlow</span><span class="p">,</span> <span class="n">GetFanInletNode</span><span class="p">,</span> <span class="n">GetFanOutletNode</span>
<a name="ln-578"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">Zone</span>
<a name="ln-579"></a>  <span class="k">USE </span><span class="n">DataZoneEquipment</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneEquipConfig</span>
<a name="ln-580"></a>  <span class="k">USE </span><span class="n">DataAirSystems</span><span class="p">,</span>        <span class="n">ONLY</span> <span class="p">:</span> <span class="n">PrimaryAirSystem</span>
<a name="ln-581"></a>  <span class="k">USE </span><span class="n">DataZoneControls</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">TempControlledZone</span><span class="p">,</span> <span class="n">NumTempControlledZones</span><span class="p">,</span> <span class="n">NumComfortControlledZones</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-582"></a>                                        <span class="n">ComfortControlledZone</span>
<a name="ln-583"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">FanType_SimpleOnOff</span><span class="p">,</span> <span class="n">FanType_SimpleConstVolume</span>
<a name="ln-584"></a>
<a name="ln-585"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurveIndex</span><span class="p">,</span> <span class="n">GetCurveType</span><span class="p">,</span> <span class="n">CurveValue</span>
<a name="ln-586"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetUpCompSets</span>
<a name="ln-587"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDXCoilIndex</span><span class="p">,</span> <span class="n">GetDXCoilInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-588"></a>                                   <span class="n">GetDXCoilOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilOutletNode</span><span class="p">,</span><span class="n">GetDXCoilNumberOfSpeeds</span><span class="p">,</span><span class="n">GetDXCoilNumberOfSpeeds</span>
<a name="ln-589"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetHeatingCoilInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilInletNode</span><span class="p">,</span> <span class="n">GetHeatingCoilOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-590"></a>                                   <span class="n">GetHeatingCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span><span class="p">,</span> <span class="n">GetHeatingCoilIndex</span><span class="p">,</span> <span class="n">GetCoilIndex</span><span class="p">,</span> <span class="n">GetCoilInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-591"></a>                                   <span class="n">GetCoilOutletNode</span><span class="p">,</span> <span class="n">GetHeatingCoilNumberOfStages</span>
<a name="ln-592"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCoilWaterInletNode</span><span class="p">,</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-593"></a>                                   <span class="n">GetWaterCoilInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilInletNode</span><span class="p">,</span><span class="n">GetWaterCoilOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilOutletNode</span>
<a name="ln-594"></a>  <span class="k">USE </span><span class="n">SteamCoils</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSteamCoilAirInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilAirInletNode</span><span class="p">,</span> <span class="n">GetSteamCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-595"></a>                                   <span class="n">GetSteamCoilAirOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilAirOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-596"></a>                                   <span class="n">GetSteamCoilSteamInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilSteamInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-597"></a>                                   <span class="n">GetCoilMaxSteamFlowRate</span><span class="o">=&gt;</span><span class="n">GetCoilMaxSteamFlowRate</span><span class="p">,</span> <span class="n">GetTypeOfCoil</span><span class="p">,</span> <span class="n">ZoneLoadControl</span>
<a name="ln-598"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSatDensityRefrig</span>
<a name="ln-599"></a>
<a name="ln-600"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-601"></a>
<a name="ln-602"></a>            <span class="c">! PARAMETERS</span>
<a name="ln-603"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">Len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;GetMSHeatPumpInput: &#39;</span> <span class="c">! include trailing blank space</span>
<a name="ln-604"></a>
<a name="ln-605"></a>
<a name="ln-606"></a>            <span class="c">! LOCAL VARIABLES</span>
<a name="ln-607"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">MSHPNum</span>                   <span class="c">! Engine driven heat pump count</span>
<a name="ln-608"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumAlphas</span>                 <span class="c">! Number of elements in the alpha array</span>
<a name="ln-609"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumNumbers</span>                <span class="c">! Number of Numbers for each GetObjectItem call</span>
<a name="ln-610"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">IOStatus</span>                  <span class="c">! Used in GetObjectItem</span>
<a name="ln-611"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>               <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>       <span class="c">! True when input errors found</span>
<a name="ln-612"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">IsNotOK</span>                   <span class="c">! Flag to verify name</span>
<a name="ln-613"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">IsBlank</span>                   <span class="c">! Flag for blank name</span>
<a name="ln-614"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>               <span class="kd">::</span> <span class="n">AllocatedFlag</span> <span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>    <span class="c">! True when arrays are allocated</span>
<a name="ln-615"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">AirNodeFound</span>              <span class="c">! True when an air node is found</span>
<a name="ln-616"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">AirLoopFound</span>              <span class="c">! True when an air loop is found</span>
<a name="ln-617"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">ControlledZoneNum</span>         <span class="c">! Controlled zone number</span>
<a name="ln-618"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">AirLoopNumber</span>             <span class="c">! Index to air loop</span>
<a name="ln-619"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">FanType</span>                   <span class="c">! Fan type</span>
<a name="ln-620"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">BranchNum</span>                 <span class="c">! Index to branch</span>
<a name="ln-621"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">CompNum</span>                   <span class="c">! Index to component</span>
<a name="ln-622"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">TstatZoneNum</span>              <span class="c">! Used to determine if control zone has a thermostat object</span>
<a name="ln-623"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">i</span>                         <span class="c">! Index to speeds</span>
<a name="ln-624"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">j</span>                         <span class="c">! Index to speeds</span>
<a name="ln-625"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">Found</span>                     <span class="c">! Flag to find autosize</span>
<a name="ln-626"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">HeatingCoilInletNode</span>      <span class="c">! Heating coil inlet node number</span>
<a name="ln-627"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">HeatingCoilOutletNode</span>     <span class="c">! Heating coil outlet node number</span>
<a name="ln-628"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">CoolingCoilInletNode</span>      <span class="c">! Cooling coil inlet node number</span>
<a name="ln-629"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">CoolingCoilOutletNode</span>     <span class="c">! Cooling coil outlet node number</span>
<a name="ln-630"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">SuppHeatCoilInletNode</span>     <span class="c">! Supplemental heating coil inlet node number</span>
<a name="ln-631"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">SuppHeatCoilOutletNode</span>    <span class="c">! Supplemental heating coil outlet node number</span>
<a name="ln-632"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">LocalError</span>                <span class="c">! Local error flag</span>
<a name="ln-633"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">SpeedInput</span>                <span class="c">! Status of number of speed input</span>
<a name="ln-634"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">Len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Alphas</span>         <span class="c">! Alpha input items for object</span>
<a name="ln-635"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">Len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cAlphaFields</span>   <span class="c">! Alpha field names</span>
<a name="ln-636"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">Len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cNumericFields</span> <span class="c">! Numeric field names</span>
<a name="ln-637"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Numbers</span>          <span class="c">! Numeric input items for object</span>
<a name="ln-638"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lAlphaBlanks</span>     <span class="c">! Logical array, alpha field input BLANK = .true.</span>
<a name="ln-639"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lNumericBlanks</span>   <span class="c">! Logical array, numeric field input BLANK = .true.</span>
<a name="ln-640"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">MaxNums</span><span class="o">=</span><span class="mi">0</span>              <span class="c">! Maximum number of numeric input fields</span>
<a name="ln-641"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">MaxAlphas</span><span class="o">=</span><span class="mi">0</span>            <span class="c">! Maximum number of alpha input fields</span>
<a name="ln-642"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">TotalArgs</span><span class="o">=</span><span class="mi">0</span>            <span class="c">! Total number of alpha and numeric arguments (max) for a</span>
<a name="ln-643"></a>                                                           <span class="c">!  certain object in the input file</span>
<a name="ln-644"></a>  <span class="kt">LOGICAL</span>                        <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-645"></a>  <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">SteamIndex</span>             <span class="c">! steam coil steam inlet density</span>
<a name="ln-646"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">SteamDensity</span>           <span class="c">! density of steam at 100C</span>
<a name="ln-647"></a>
<a name="ln-648"></a>  <span class="c">! FLOW</span>
<a name="ln-649"></a>
<a name="ln-650"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">AllocatedFlag</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-651"></a>
<a name="ln-652"></a><span class="k">  </span><span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed&#39;</span>   <span class="c">! Object type for getting and error messages</span>
<a name="ln-653"></a>
<a name="ln-654"></a>  <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">TotalArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-655"></a>  <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-656"></a>  <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-657"></a>
<a name="ln-658"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-659"></a>  <span class="n">Alphas</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-660"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-661"></a>  <span class="n">cAlphaFields</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-662"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-663"></a>  <span class="n">Numbers</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-664"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-665"></a>  <span class="n">cNumericFields</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-666"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-667"></a>  <span class="n">lAlphaBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-668"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-669"></a>  <span class="n">lNumericBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-670"></a>
<a name="ln-671"></a>  <span class="n">NumMSHeatPumps</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-672"></a>
<a name="ln-673"></a>
<a name="ln-674"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumMSHeatPumps</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-675"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;No &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; objects specified in input file.&#39;</span><span class="p">)</span>
<a name="ln-676"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-677"></a>  <span class="k">END IF</span>
<a name="ln-678"></a>
<a name="ln-679"></a>  <span class="c">! ALLOCATE ARRAYS</span>
<a name="ln-680"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">NumMSHeatPumps</span><span class="p">))</span>
<a name="ln-681"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">NumMSHeatPumps</span><span class="p">))</span>
<a name="ln-682"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">NumMSHeatPumps</span><span class="p">))</span>
<a name="ln-683"></a>  <span class="n">CheckEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-684"></a>  <span class="n">AllocatedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-685"></a>
<a name="ln-686"></a>  <span class="c">! Load arrays with reformulated electric EIR chiller data</span>
<a name="ln-687"></a>  <span class="k">DO </span><span class="n">MSHPNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumMSHeatPumps</span>
<a name="ln-688"></a>
<a name="ln-689"></a>    <span class="n">HeatingCoilInletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-690"></a>    <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-691"></a>    <span class="n">CoolingCoilInletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-692"></a>    <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-693"></a>    <span class="n">SuppHeatCoilInletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-694"></a>    <span class="n">SuppHeatCoilOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-695"></a>
<a name="ln-696"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">MSHPNum</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-697"></a>                    <span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span> <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-698"></a>                    <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-699"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-700"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-701"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">MSHeatPump</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">MSHPNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-702"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-703"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-704"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-705"></a>    <span class="k">END IF</span>
<a name="ln-706"></a><span class="k">    </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span>                <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-707"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-708"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AvaiSchedPtr</span>        <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-709"></a>    <span class="k">ELSE</span>
<a name="ln-710"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AvaiSchedPtr</span>        <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-711"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AvaiSchedPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-712"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-713"></a>                             <span class="s1">&#39;&quot; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; not found: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-714"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-715"></a>      <span class="n">ENDIF</span>
<a name="ln-716"></a>    <span class="n">ENDIF</span>
<a name="ln-717"></a>
<a name="ln-718"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AirInletNodeName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-719"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AirOutletNodeName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-720"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-721"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-722"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-723"></a>
<a name="ln-724"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-725"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-726"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-727"></a>
<a name="ln-728"></a>    <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-729"></a>
<a name="ln-730"></a>    <span class="c">!Get the Controlling Zone or Location of the engine driven heat pump Thermostat</span>
<a name="ln-731"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-732"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">ControlZoneName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-733"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-734"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-735"></a>                           <span class="s1">&#39;&quot; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; not found: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">ControlZoneName</span><span class="p">))</span>
<a name="ln-736"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-737"></a>    <span class="n">ENDIF</span>
<a name="ln-738"></a>
<a name="ln-739"></a>    <span class="c">! Get the node number for the zone with the thermostat</span>
<a name="ln-740"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">&gt;</span>  <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-741"></a><span class="k">      </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-742"></a>      <span class="n">AirLoopFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-743"></a>      <span class="k">DO </span><span class="n">ControlledZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-744"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="o">/=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-745"></a>        <span class="c">! Find the controlled zone number for the specified thermostat location</span>
<a name="ln-746"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="o">=</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ZoneNode</span>
<a name="ln-747"></a>        <span class="c">! Determine if furnace is on air loop served by the thermostat location specified</span>
<a name="ln-748"></a>        <span class="n">AirLoopNumber</span> <span class="o">=</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">AirLoopNum</span>
<a name="ln-749"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AirLoopNumber</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-750"></a><span class="k">          DO </span><span class="n">BranchNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">NumBranches</span>
<a name="ln-751"></a>            <span class="k">DO </span><span class="n">CompNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">TotalComponents</span>
<a name="ln-752"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-753"></a>                 <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-754"></a>                 <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">TypeOf</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-755"></a>                  <span class="n">CurrentModuleObject</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-756"></a><span class="k">              </span><span class="n">AirLoopFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-757"></a>              <span class="k">EXIT</span>
<a name="ln-758"></a><span class="k">            END DO</span>
<a name="ln-759"></a><span class="k">            IF</span><span class="p">(</span><span class="n">AirLoopFound</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-760"></a><span class="k">          END DO</span>
<a name="ln-761"></a><span class="k">          DO </span><span class="n">TstatZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumTempControlledZones</span>
<a name="ln-762"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">TempControlledZone</span><span class="p">(</span><span class="n">TstatZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-763"></a><span class="k">            </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-764"></a>          <span class="k">END DO</span>
<a name="ln-765"></a><span class="k">          DO </span><span class="n">TstatZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumComfortControlledZones</span>
<a name="ln-766"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ComfortControlledZone</span><span class="p">(</span><span class="n">TstatZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-767"></a><span class="k">            </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-768"></a>          <span class="k">END DO</span>
<a name="ln-769"></a><span class="k">        ELSE</span>
<a name="ln-770"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Did not find a AirLoopHVAC for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-771"></a>                               <span class="s1">&#39;&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-772"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-773"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-774"></a>        <span class="k">END IF</span>
<a name="ln-775"></a><span class="k">        EXIT</span>
<a name="ln-776"></a><span class="k">      </span><span class="n">ENDDO</span>
<a name="ln-777"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">AirNodeFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-778"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Did not find Air Node (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;), &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-779"></a>                             <span class="s1">&#39;&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-780"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-781"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-782"></a>      <span class="n">ENDIF</span>
<a name="ln-783"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">AirLoopFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-784"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Did not find correct AirLoopHVAC for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-785"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-786"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-787"></a>                               <span class="s1">&#39; is not served by this Primary Air Loop equipment.&#39;</span><span class="p">)</span>
<a name="ln-788"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-789"></a>      <span class="n">ENDIF</span>
<a name="ln-790"></a>    <span class="n">ENDIF</span>
<a name="ln-791"></a>
<a name="ln-792"></a><span class="c">!    MSHeatPump(MSHPNum)%FlowFraction = Numbers(1)</span>
<a name="ln-793"></a><span class="c">!    IF (MSHeatPump(MSHPNum)%FlowFraction .LE. 0.0 .AND. MSHeatPump(MSHPNum)%FlowFraction /= AutoSize) THEN</span>
<a name="ln-794"></a><span class="c">!      CALL ShowSevereError(TRIM(CurrentModuleObject)//&#39;, &quot;&#39;//TRIM(MSHeatPump(MSHPNum)%Name)//&amp;</span>
<a name="ln-795"></a><span class="c">!                           &#39;&quot;, &#39;//TRIM(cNumericFields(1))//&#39; must greater than zero.&#39;)</span>
<a name="ln-796"></a><span class="c">!      ErrorsFound = .TRUE.</span>
<a name="ln-797"></a><span class="c">!    END IF</span>
<a name="ln-798"></a><span class="c">!    IF (MSHeatPump(MSHPNum)%FlowFraction .GT. 1.0 .AND. MSHeatPump(MSHPNum)%FlowFraction /= AutoSize) THEN</span>
<a name="ln-799"></a><span class="c">!      CALL ShowSevereError(TRIM(CurrentModuleObject)//&#39;, &quot;&#39;//TRIM(MSHeatPump(MSHPNum)%Name)//&amp;</span>
<a name="ln-800"></a><span class="c">!                           &#39;&quot;, &#39;//TRIM(cNumericFields(1))//&#39; cannot be greater than 1.0.&#39;)</span>
<a name="ln-801"></a><span class="c">!      ErrorsFound = .TRUE.</span>
<a name="ln-802"></a><span class="c">!    END IF</span>
<a name="ln-803"></a>
<a name="ln-804"></a>    <span class="c">!Get supply fan data</span>
<a name="ln-805"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-806"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;Fan:OnOff&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;Fan:ConstantVolume&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-807"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;Fan:OnOff&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-808"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanType</span> <span class="o">=</span> <span class="n">FanType_SimpleOnOff</span>
<a name="ln-809"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-810"></a>                           <span class="s1">&#39;Fan:OnOff&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">,</span> <span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
<a name="ln-811"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanInletNode</span>  <span class="o">=</span> <span class="n">GetFanInletNode</span><span class="p">(</span><span class="s1">&#39;Fan:OnOff&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-812"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanOutletNode</span> <span class="o">=</span> <span class="n">GetFanOutletNode</span><span class="p">(</span><span class="s1">&#39;Fan:OnOff&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-813"></a>      <span class="k">Else</span>
<a name="ln-814"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanType</span> <span class="o">=</span> <span class="n">FanType_SimpleConstVolume</span>
<a name="ln-815"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-816"></a>                           <span class="s1">&#39;Fan:ConstantVolume&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">,</span> <span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
<a name="ln-817"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanInletNode</span> <span class="o">=</span> <span class="n">GetFanInletNode</span><span class="p">(</span><span class="s1">&#39;Fan:ConstantVolume&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-818"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanOutletNode</span> <span class="o">=</span> <span class="n">GetFanOutletNode</span><span class="p">(</span><span class="s1">&#39;Fan:ConstantVolume&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-819"></a>      <span class="k">End If</span>
<a name="ln-820"></a><span class="k">      CALL </span><span class="n">GetFanIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-821"></a>      <span class="k">CALL </span><span class="n">GetFanType</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">FanType</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-822"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">FanType</span> <span class="o">/=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanType</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-823"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-824"></a>                             <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; and &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; do not match in Fan objects.&#39;</span><span class="p">)</span>
<a name="ln-825"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The entered &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; and &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-826"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-827"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-828"></a>      <span class="k">End If</span>
<a name="ln-829"></a><span class="k">    ELSE</span>
<a name="ln-830"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-831"></a>                           <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not allowed = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-832"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Valid choices are Fan:OnOff or Fan:ConstantVolume&#39;</span><span class="p">)</span>
<a name="ln-833"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-834"></a>    <span class="k">END IF</span>
<a name="ln-835"></a>
<a name="ln-836"></a>    <span class="c">!Get supply fan placement data</span>
<a name="ln-837"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;BlowThrough&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;DrawThrough&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-838"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;BlowThrough&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-839"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanPlaceType</span> <span class="o">=</span> <span class="n">BlowThru</span>
<a name="ln-840"></a>      <span class="k">Else</span>
<a name="ln-841"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanPlaceType</span> <span class="o">=</span> <span class="n">DrawThru</span>
<a name="ln-842"></a>      <span class="k">End If</span>
<a name="ln-843"></a><span class="k">    ELSE</span>
<a name="ln-844"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-845"></a>                           <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not allowed = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-846"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Valid choices are BlowThrough or DrawThrough&#39;</span><span class="p">)</span>
<a name="ln-847"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-848"></a>    <span class="k">END IF</span>
<a name="ln-849"></a>
<a name="ln-850"></a><span class="k">    </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanSchedule</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-851"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<a name="ln-852"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-853"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-854"></a>                           <span class="s1">&#39;&quot; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; not found: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-855"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-856"></a>    <span class="n">ENDIF</span>
<a name="ln-857"></a>
<a name="ln-858"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanType</span> <span class="o">==</span> <span class="n">FanType_SimpleConstVolume</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-859"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CheckScheduleValueMinMax</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span><span class="p">,</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-860"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-861"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be continuous (fan operating mode schedule values &gt; 0)&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-862"></a>                               <span class="s1">&#39; for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Fan:ConstantVolume.&#39;</span><span class="p">)</span>
<a name="ln-863"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-864"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;schedule values must be (&gt;0., &lt;=1.)&#39;</span><span class="p">)</span>
<a name="ln-865"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-866"></a>      <span class="k">END IF</span>
<a name="ln-867"></a><span class="k">    END IF</span>
<a name="ln-868"></a>
<a name="ln-869"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;Coil:Heating:DX:MultiSpeed&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-870"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="o">=</span> <span class="n">MultiSpeedHeatingCoil</span>
<a name="ln-871"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span> <span class="o">=</span> <span class="n">GetObjectItemNum</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:DX:MultiSpeed&#39;</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<a name="ln-872"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">DXHeatCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-873"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-874"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Configuration error in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-875"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-876"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be Coil:Heating:DX:MultiSpeed &#39;</span><span class="p">)</span>
<a name="ln-877"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; input. &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-878"></a>                            <span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-879"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-880"></a>      <span class="k">End If</span>
<a name="ln-881"></a><span class="k">      </span><span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-882"></a>      <span class="k">CALL </span><span class="n">GetDXCoilIndex</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">DXHeatCoilName</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">DXHeatCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-883"></a>                              <span class="n">LocalError</span><span class="p">,</span> <span class="s1">&#39;Coil:Heating:DX:MultiSpeed&#39;</span><span class="p">)</span>
<a name="ln-884"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">LocalError</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-885"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The index of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not found &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-886"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-887"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-888"></a>        <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-889"></a>      <span class="k">End If</span>
<a name="ln-890"></a><span class="k">      </span><span class="n">HeatingCoilInletNode</span> <span class="o">=</span> <span class="n">GetDXCoilInletNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">LocalError</span><span class="p">)</span>
<a name="ln-891"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">LocalError</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-892"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The inlet node number of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not found &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-893"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-894"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-895"></a>        <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-896"></a>      <span class="k">End If</span>
<a name="ln-897"></a><span class="k">      </span><span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetDXCoilOutletNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">LocalError</span><span class="p">)</span>
<a name="ln-898"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">LocalError</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-899"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The outlet node number of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not found &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-900"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-901"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-902"></a>        <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-903"></a>      <span class="k">End If</span>
<a name="ln-904"></a><span class="k">      CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-905"></a>                         <span class="s1">&#39;Coil:Heating:DX:MultiSpeed&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">DXHeatCoilName</span><span class="p">,</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">,</span> <span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
<a name="ln-906"></a>    <span class="k">Else if</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;Coil:Heating:Electric:MultiStage&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-907"></a>             <span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;Coil:Heating:Gas:MultiStage&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-908"></a>
<a name="ln-909"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;Coil:Heating:Electric:MultiStage&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-910"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="o">=</span> <span class="n">Coil_HeatingElectric_MultiStage</span>
<a name="ln-911"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span> <span class="o">=</span> <span class="n">GetObjectItemNum</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Electric:MultiStage&#39;</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<a name="ln-912"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-913"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Configuration error in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-914"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-915"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be Coil:Heating:Electric:MultiStage &#39;</span><span class="p">)</span>
<a name="ln-916"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; input. &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-917"></a>                              <span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-918"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-919"></a>        <span class="k">End If</span>
<a name="ln-920"></a><span class="k">      ELSE</span>
<a name="ln-921"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="o">=</span> <span class="n">Coil_HeatingGas_MultiStage</span>
<a name="ln-922"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span> <span class="o">=</span> <span class="n">GetObjectItemNum</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Gas:MultiStage&#39;</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<a name="ln-923"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-924"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Configuration error in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-925"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-926"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be Coil:Heating:Gas:MultiStage &#39;</span><span class="p">)</span>
<a name="ln-927"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; input. &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-928"></a>                              <span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-929"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-930"></a>        <span class="k">End If</span>
<a name="ln-931"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-932"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-933"></a>      <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-934"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;Coil:Heating:Electric:MultiStage&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-935"></a><span class="k">        CALL </span><span class="n">GetCoilIndex</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilIndex</span><span class="p">,</span> <span class="n">LocalError</span><span class="p">)</span>
<a name="ln-936"></a>      <span class="k">ELSE</span>
<a name="ln-937"></a><span class="k">        CALL </span><span class="n">GetCoilIndex</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilIndex</span><span class="p">,</span> <span class="n">LocalError</span><span class="p">)</span>
<a name="ln-938"></a>      <span class="n">ENDIF</span>
<a name="ln-939"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">LocalError</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-940"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The index of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not found &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-941"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-942"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-943"></a>        <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-944"></a>      <span class="k">End If</span>
<a name="ln-945"></a><span class="k">      </span><span class="n">HeatingCoilInletNode</span> <span class="o">=</span> <span class="n">GetCoilInletNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">LocalError</span><span class="p">)</span>
<a name="ln-946"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">LocalError</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-947"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The inlet node number of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not found &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-948"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-949"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-950"></a>        <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-951"></a>      <span class="k">End If</span>
<a name="ln-952"></a><span class="k">      </span><span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetCoilOutletNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">LocalError</span><span class="p">)</span>
<a name="ln-953"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">LocalError</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-954"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The outlet node number of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not found &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-955"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-956"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-957"></a>        <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-958"></a>      <span class="k">End If</span>
<a name="ln-959"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;Coil:Heating:Electric:MultiStage&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-960"></a><span class="k">        CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-961"></a>                           <span class="s1">&#39;Coil:Heating:Electric:MultiStage&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">,</span> <span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
<a name="ln-962"></a>      <span class="k">ELSE</span>
<a name="ln-963"></a><span class="k">        CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-964"></a>                           <span class="s1">&#39;Coil:Heating:Gas:MultiStage&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">,</span> <span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
<a name="ln-965"></a>      <span class="n">ENDIF</span>
<a name="ln-966"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-967"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="o">=</span> <span class="n">Coil_HeatingWater</span>
<a name="ln-968"></a>        <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-969"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-970"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-971"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-972"></a>        <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-973"></a>
<a name="ln-974"></a>          <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-975"></a>          <span class="c">! Get the Heating Coil water Inlet or control Node number</span>
<a name="ln-976"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-977"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoilControlNode</span> <span class="o">=</span> <span class="n">GetCoilWaterInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-978"></a>                                                           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-979"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-980"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-981"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-982"></a>            <span class="k">END IF</span>
<a name="ln-983"></a>
<a name="ln-984"></a>            <span class="c">! Get the ReHeat Coil hot water max volume flow rate</span>
<a name="ln-985"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-986"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-987"></a>                                                        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-988"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-989"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-990"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-991"></a>            <span class="k">END IF</span>
<a name="ln-992"></a>
<a name="ln-993"></a>            <span class="c">! Get the lemental Heating Coil Inlet Node</span>
<a name="ln-994"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-995"></a>            <span class="n">HeatingCoilInletNode</span> <span class="o">=</span>  <span class="n">GetWaterCoilInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-996"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoilAirInletNode</span> <span class="o">=</span> <span class="n">HeatingCoilInletNode</span>
<a name="ln-997"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-998"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-999"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1000"></a>            <span class="k">END IF</span>
<a name="ln-1001"></a>
<a name="ln-1002"></a>            <span class="c">! Get the lemental Heating Coil Outlet Node</span>
<a name="ln-1003"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1004"></a>            <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetWaterCoilOutletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1005"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1006"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1007"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1008"></a>            <span class="k">END IF</span>
<a name="ln-1009"></a><span class="k">            CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1010"></a>                               <span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1011"></a>                                <span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">),</span> <span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">))</span>
<a name="ln-1012"></a>        <span class="n">ENDIF</span>
<a name="ln-1013"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1014"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="o">=</span> <span class="n">Coil_HeatingSteam</span>
<a name="ln-1015"></a>        <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-1016"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1017"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1018"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1019"></a>        <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-1020"></a>
<a name="ln-1021"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-1022"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1023"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span> <span class="o">=</span> <span class="n">GetSTeamCoilIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1024"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1025"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1026"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">))</span>
<a name="ln-1027"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1028"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1029"></a>            <span class="k">END IF</span>
<a name="ln-1030"></a>
<a name="ln-1031"></a>            <span class="c">! Get the lemental Heating Coil steam inlet node number</span>
<a name="ln-1032"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1033"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoilControlNode</span> <span class="o">=</span> <span class="n">GetSteamCoilSteamInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1034"></a>                                                      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1035"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1036"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1037"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1038"></a>            <span class="k">END IF</span>
<a name="ln-1039"></a>
<a name="ln-1040"></a>            <span class="c">! Get the lemental Heating Coil steam max volume flow rate</span>
<a name="ln-1041"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1042"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1043"></a><span class="k">                </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-1044"></a>                <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s2">&quot;STEAM&quot;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;GetMSHeatPumpInput&#39;</span><span class="p">)</span>
<a name="ln-1045"></a>                <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-1046"></a>            <span class="k">END IF</span>
<a name="ln-1047"></a>
<a name="ln-1048"></a>            <span class="c">! Get the lemental Heating Coil Inlet Node</span>
<a name="ln-1049"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1050"></a>            <span class="n">HeatingCoilInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1051"></a>                <span class="n">GetSteamCoilAirInletNode</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1052"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoilAirInletNode</span> <span class="o">=</span> <span class="n">HeatingCoilInletNode</span>
<a name="ln-1053"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1054"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1055"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1056"></a>            <span class="k">END IF</span>
<a name="ln-1057"></a>
<a name="ln-1058"></a>            <span class="c">! Get the lemental Heating Coil Outlet Node</span>
<a name="ln-1059"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1060"></a>            <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1061"></a>                <span class="n">GetSteamCoilAirOutletNode</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1062"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1063"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1064"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1065"></a>            <span class="k">END IF</span>
<a name="ln-1066"></a>
<a name="ln-1067"></a><span class="k">            CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1068"></a>                               <span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1069"></a>                                <span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">),</span> <span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">))</span>
<a name="ln-1070"></a>
<a name="ln-1071"></a>        <span class="n">ENDIF</span>
<a name="ln-1072"></a>    <span class="k">ELSE</span>
<a name="ln-1073"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The allowed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; are Coil:Heating:DX:MultiSpeed, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1074"></a>                           <span class="s1">&#39;Coil:Heating:Electric:MultiStage, and Coil:Heating:Gas:MultiStage  &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1075"></a>                           <span class="s1">&#39;in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1076"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The entered &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1077"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1078"></a>    <span class="n">ENDIF</span>
<a name="ln-1079"></a>
<a name="ln-1080"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1081"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">2</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1082"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1083"></a>                          <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is -20.0&#39;</span><span class="p">)</span>
<a name="ln-1084"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The input value is &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1085"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1086"></a>    <span class="k">End If</span>
<a name="ln-1087"></a>
<a name="ln-1088"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;Coil:Cooling:DX:MultiSpeed&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1089"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoolCoilType</span> <span class="o">=</span> <span class="n">MultiSpeedCoolingCoil</span>
<a name="ln-1090"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoolCoilNum</span> <span class="o">=</span> <span class="n">GetObjectItemNum</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:MultiSpeed&#39;</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<a name="ln-1091"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-1092"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoolCoilNum</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1093"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Configuration error in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1094"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-1095"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be Coil:Cooling:DX:MultiSpeed &#39;</span><span class="p">)</span>
<a name="ln-1096"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; input. &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1097"></a>                            <span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-1098"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1099"></a>      <span class="k">End If</span>
<a name="ln-1100"></a><span class="k">      </span><span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1101"></a>      <span class="k">CALL </span><span class="n">GetDXCoilIndex</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">DXCoolCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1102"></a>                              <span class="n">LocalError</span><span class="p">,</span> <span class="s1">&#39;Coil:Cooling:DX:MultiSpeed&#39;</span><span class="p">)</span>
<a name="ln-1103"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">LocalError</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1104"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The index of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not found &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1105"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1106"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1107"></a>        <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1108"></a>      <span class="k">End If</span>
<a name="ln-1109"></a><span class="k">      </span><span class="n">CoolingCoilInletNode</span> <span class="o">=</span> <span class="n">GetDXCoilInletNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="n">LocalError</span><span class="p">)</span>
<a name="ln-1110"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">LocalError</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1111"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The inlet node number of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not found &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1112"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1113"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1114"></a>        <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1115"></a>      <span class="k">End If</span>
<a name="ln-1116"></a><span class="k">      </span><span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetDXCoilOutletNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="n">LocalError</span><span class="p">)</span>
<a name="ln-1117"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">LocalError</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1118"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The outlet node number of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not found &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1119"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1120"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1121"></a>        <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1122"></a>      <span class="k">End If</span>
<a name="ln-1123"></a><span class="k">    Else</span>
<a name="ln-1124"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The allowed &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is Coil:Cooling:DX:MultiSpeed &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1125"></a>                           <span class="s1">&#39;in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1126"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The entered &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1127"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1128"></a>    <span class="k">End If</span>
<a name="ln-1129"></a><span class="k">    CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1130"></a>                       <span class="s1">&#39;Coil:Cooling:DX:MultiSpeed&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">,</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">,</span> <span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
<a name="ln-1131"></a>
<a name="ln-1132"></a>    <span class="c">! Get supplemental heating coil data</span>
<a name="ln-1133"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-1134"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="s1">&#39;Coil:Heating:Gas&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1135"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span> <span class="o">=</span> <span class="n">SuppHeatingCoilGas</span>
<a name="ln-1136"></a>      <span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1137"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span> <span class="o">=</span> <span class="n">GetHeatingCoilIndex</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Gas&#39;</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-1138"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">errFlag</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1139"></a><span class="k">        CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Configuration error in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1140"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; of type Coil:Heating:Gas &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-1141"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1142"></a>      <span class="k">End If</span>
<a name="ln-1143"></a>
<a name="ln-1144"></a>        <span class="c">! Get the Supplemental Heating Coil Node Numbers</span>
<a name="ln-1145"></a>        <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1146"></a>        <span class="n">SuppHeatCoilInletNode</span> <span class="o">=</span> <span class="n">GetHeatingCoilInletNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="n">LocalError</span><span class="p">)</span>
<a name="ln-1147"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">LocalError</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1148"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The inlet node number of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not found &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1149"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1150"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1151"></a>          <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1152"></a>        <span class="k">End If</span>
<a name="ln-1153"></a><span class="k">        </span><span class="n">SuppHeatCoilOutletNode</span> <span class="o">=</span> <span class="n">GetHeatingCoilOutletNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="n">LocalError</span><span class="p">)</span>
<a name="ln-1154"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">LocalError</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1155"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The outlet node number of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not found &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1156"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1157"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1158"></a>          <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1159"></a>        <span class="k">End If</span>
<a name="ln-1160"></a>
<a name="ln-1161"></a>        <span class="c">! Get supplemental heating coil capacity to see if it is autosize</span>
<a name="ln-1162"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="n">GetHeatingCoilCapacity</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="n">LocalError</span><span class="p">)</span>
<a name="ln-1163"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">LocalError</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1164"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The capacity &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not found &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1165"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1166"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1167"></a>          <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1168"></a>        <span class="k">End If</span>
<a name="ln-1169"></a><span class="k">      CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1170"></a>                         <span class="s1">&#39;Coil:Heating:Gas&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">,</span> <span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
<a name="ln-1171"></a>    <span class="k">End If</span>
<a name="ln-1172"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="s1">&#39;Coil:Heating:Electric&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1173"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span> <span class="o">=</span> <span class="n">SuppHeatingCoilElec</span>
<a name="ln-1174"></a>      <span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1175"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span> <span class="o">=</span> <span class="n">GetHeatingCoilIndex</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Electric&#39;</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-1176"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">errFlag</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1177"></a><span class="k">        CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Configuration error in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1178"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; of type Coil:Heating:Electric &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot; not found.&#39;</span><span class="p">)</span>
<a name="ln-1179"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1180"></a>      <span class="k">End If</span>
<a name="ln-1181"></a>
<a name="ln-1182"></a>        <span class="c">! Get the Supplemental Heating Coil Node Numbers</span>
<a name="ln-1183"></a>        <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1184"></a>        <span class="n">SuppHeatCoilInletNode</span> <span class="o">=</span> <span class="n">GetHeatingCoilInletNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="n">LocalError</span><span class="p">)</span>
<a name="ln-1185"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">LocalError</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1186"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The inlet node number of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not found &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1187"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1188"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1189"></a>          <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1190"></a>        <span class="k">End If</span>
<a name="ln-1191"></a><span class="k">        </span><span class="n">SuppHeatCoilOutletNode</span> <span class="o">=</span> <span class="n">GetHeatingCoilOutletNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="n">LocalError</span><span class="p">)</span>
<a name="ln-1192"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">LocalError</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1193"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The outlet node number of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not found &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1194"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1195"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1196"></a>          <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1197"></a>        <span class="k">End If</span>
<a name="ln-1198"></a>
<a name="ln-1199"></a>        <span class="c">! Get supplemental heating coil capacity to see if it is autosize</span>
<a name="ln-1200"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="n">GetHeatingCoilCapacity</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="n">LocalError</span><span class="p">)</span>
<a name="ln-1201"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">LocalError</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1202"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The capacity &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not found &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1203"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1204"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1205"></a>          <span class="n">LocalError</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1206"></a>        <span class="k">End If</span>
<a name="ln-1207"></a>
<a name="ln-1208"></a><span class="k">      CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1209"></a>                         <span class="s1">&#39;Coil:Heating:Electric&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">,</span> <span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
<a name="ln-1210"></a>    <span class="k">End If</span>
<a name="ln-1211"></a>
<a name="ln-1212"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1213"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span> <span class="o">=</span> <span class="n">Coil_HeatingWater</span>
<a name="ln-1214"></a>        <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-1215"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1216"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1217"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1218"></a>        <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-1219"></a>
<a name="ln-1220"></a>            <span class="c">! Get the Heating Coil water Inlet or control Node number</span>
<a name="ln-1221"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1222"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span> <span class="o">=</span> <span class="n">GetCoilWaterInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1223"></a>                                                           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1224"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1225"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1226"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1227"></a>            <span class="k">END IF</span>
<a name="ln-1228"></a>
<a name="ln-1229"></a>            <span class="c">! Get the ReHeat Coil hot water max volume flow rate</span>
<a name="ln-1230"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1231"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1232"></a>                                                        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1233"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1234"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1235"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1236"></a>            <span class="k">END IF</span>
<a name="ln-1237"></a>
<a name="ln-1238"></a>            <span class="c">! Get the Supplemental Heating Coil Inlet Node</span>
<a name="ln-1239"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1240"></a>            <span class="n">SuppHeatCoilInletNode</span> <span class="o">=</span>  <span class="n">GetWaterCoilInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1241"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span> <span class="o">=</span> <span class="n">SuppHeatCoilInletNode</span>
<a name="ln-1242"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1243"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1244"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1245"></a>            <span class="k">END IF</span>
<a name="ln-1246"></a>
<a name="ln-1247"></a>            <span class="c">! Get the Supplemental Heating Coil Outlet Node</span>
<a name="ln-1248"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1249"></a>            <span class="n">SuppHeatCoilOutletNode</span> <span class="o">=</span> <span class="n">GetWaterCoilOutletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1250"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span> <span class="o">=</span> <span class="n">SuppHeatCoilOutletNode</span>
<a name="ln-1251"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1252"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1253"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1254"></a>            <span class="k">END IF</span>
<a name="ln-1255"></a><span class="k">            CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1256"></a>                               <span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1257"></a>                                <span class="n">NodeID</span><span class="p">(</span><span class="n">SuppHeatCoilInletNode</span><span class="p">),</span> <span class="n">NodeID</span><span class="p">(</span><span class="n">SuppHeatCoilOutletNode</span><span class="p">))</span>
<a name="ln-1258"></a>        <span class="n">ENDIF</span>
<a name="ln-1259"></a>    <span class="n">ENDIF</span>
<a name="ln-1260"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1261"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span> <span class="o">=</span> <span class="n">Coil_HeatingSteam</span>
<a name="ln-1262"></a>        <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-1263"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1264"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1265"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1266"></a>        <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-1267"></a>
<a name="ln-1268"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1269"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span> <span class="o">=</span> <span class="n">GetSTeamCoilIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1270"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1271"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1272"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">))</span>
<a name="ln-1273"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1274"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1275"></a>            <span class="k">END IF</span>
<a name="ln-1276"></a>
<a name="ln-1277"></a>            <span class="c">! Get the Supplemental Heating Coil steam inlet node number</span>
<a name="ln-1278"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1279"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span> <span class="o">=</span> <span class="n">GetSteamCoilSteamInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1280"></a>                                                      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1281"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1282"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1283"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1284"></a>            <span class="k">END IF</span>
<a name="ln-1285"></a>
<a name="ln-1286"></a>            <span class="c">! Get the Supplemental Heating Coil steam max volume flow rate</span>
<a name="ln-1287"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1288"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1289"></a><span class="k">                </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-1290"></a>                <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s2">&quot;STEAM&quot;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;GetMSHeatPumpInput&#39;</span><span class="p">)</span>
<a name="ln-1291"></a>                <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-1292"></a>            <span class="k">END IF</span>
<a name="ln-1293"></a>
<a name="ln-1294"></a>            <span class="c">! Get the Supplemental Heating Coil Inlet Node</span>
<a name="ln-1295"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1296"></a>            <span class="n">SuppHeatCoilInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1297"></a>                <span class="n">GetSteamCoilAirInletNode</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1298"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span> <span class="o">=</span> <span class="n">SuppHeatCoilInletNode</span>
<a name="ln-1299"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1300"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1301"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1302"></a>            <span class="k">END IF</span>
<a name="ln-1303"></a>
<a name="ln-1304"></a>            <span class="c">! Get the Supplemental Heating Coil Outlet Node</span>
<a name="ln-1305"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1306"></a>            <span class="n">SuppHeatCoilOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1307"></a>                <span class="n">GetSteamCoilAirOutletNode</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1308"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span> <span class="o">=</span> <span class="n">SuppHeatCoilOutletNode</span>
<a name="ln-1309"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1310"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1311"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1312"></a>            <span class="k">END IF</span>
<a name="ln-1313"></a>
<a name="ln-1314"></a><span class="k">            CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1315"></a>                               <span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1316"></a>                                <span class="n">NodeID</span><span class="p">(</span><span class="n">SuppHeatCoilInletNode</span><span class="p">),</span> <span class="n">NodeID</span><span class="p">(</span><span class="n">SuppHeatCoilOutletNode</span><span class="p">))</span>
<a name="ln-1317"></a>
<a name="ln-1318"></a>        <span class="n">ENDIF</span>
<a name="ln-1319"></a>    <span class="n">ENDIF</span>
<a name="ln-1320"></a>
<a name="ln-1321"></a>
<a name="ln-1322"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1323"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1324"></a>                           <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not allowed = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">)))</span>
<a name="ln-1325"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Valid choices are Coil:Heating:Gas,Coil:Heating:Electric,Coil:Heating:Steam,or Coil:Heating:Water&#39;</span><span class="p">)</span>
<a name="ln-1326"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1327"></a>    <span class="k">End If</span>
<a name="ln-1328"></a>
<a name="ln-1329"></a><span class="k">    </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppMaxAirTemp</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1330"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppMaxOATemp</span>  <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1331"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SuppMaxOATemp</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1332"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1333"></a>                           <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is greater than 21.0&#39;</span><span class="p">)</span>
<a name="ln-1334"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The input value is &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1335"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1336"></a>    <span class="k">End If</span>
<a name="ln-1337"></a>
<a name="ln-1338"></a><span class="k">    </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AuxOnCyclePower</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1339"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AuxOffCyclePower</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1340"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AuxOnCyclePower</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1341"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1342"></a>                           <span class="s1">&#39;&quot;, A negative value for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not allowed &#39;</span><span class="p">)</span>
<a name="ln-1343"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1344"></a>    <span class="k">End If</span>
<a name="ln-1345"></a><span class="k">    If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AuxOffCyclePower</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1346"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1347"></a>                           <span class="s1">&#39;&quot;, A negative value for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not allowed &#39;</span><span class="p">)</span>
<a name="ln-1348"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1349"></a>    <span class="k">End If</span>
<a name="ln-1350"></a>
<a name="ln-1351"></a>    <span class="c">! Heat recovery</span>
<a name="ln-1352"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">DesignHeatRecFlowRate</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1353"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">DesignHeatRecFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1354"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="o">=</span><span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-1355"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span> <span class="o">=</span> <span class="n">RhoH2O</span><span class="p">(</span><span class="n">InitConvTemp</span><span class="p">)</span><span class="o">*</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">DesignHeatRecFlowRate</span>
<a name="ln-1356"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1357"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="s1">&#39;MSHP Heat receovery&#39;</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1358"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1359"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1360"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1361"></a>                             <span class="s1">&#39;&quot;, Missing &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-1362"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-1363"></a>      <span class="k">END IF</span>
<a name="ln-1364"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1365"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="s1">&#39;MSHP Heat receovery&#39;</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1366"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1367"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1368"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1369"></a>                             <span class="s1">&#39;&quot;, Missing &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-1370"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-1371"></a>      <span class="k">END IF</span>
<a name="ln-1372"></a><span class="k">      CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="s1">&#39;MSHP Heat receovery Nodes&#39;</span><span class="p">)</span>
<a name="ln-1373"></a>    <span class="k">ELSE</span>
<a name="ln-1374"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="o">=</span><span class="p">.</span><span class="n">False</span><span class="p">.</span>
<a name="ln-1375"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1376"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1377"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1378"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1379"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Since &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = 0.0, heat recovery is inactive for &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1380"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span> <span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1381"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;However, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; or &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; was specified.&#39;</span><span class="p">)</span>
<a name="ln-1382"></a>      <span class="k">END IF</span>
<a name="ln-1383"></a><span class="k">    End If</span>
<a name="ln-1384"></a><span class="k">    </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">MaxHeatRecOutletTemp</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1385"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">MaxHeatRecOutletTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1386"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1387"></a>                           <span class="s1">&#39;&quot;, The value for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is below 0.0&#39;</span><span class="p">)</span>
<a name="ln-1388"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-1389"></a>    <span class="k">END IF</span>
<a name="ln-1390"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">MaxHeatRecOutletTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">10</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1391"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1392"></a>                           <span class="s1">&#39;&quot;, The value for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is above 100.0&#39;</span><span class="p">)</span>
<a name="ln-1393"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-1394"></a>    <span class="k">END IF</span>
<a name="ln-1395"></a>
<a name="ln-1396"></a><span class="k">    </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1397"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1398"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1399"></a>                           <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be less than zero.&#39;</span><span class="p">)</span>
<a name="ln-1400"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1401"></a>    <span class="k">END IF</span>
<a name="ln-1402"></a>
<a name="ln-1403"></a><span class="c">!     AirFlowControl only valid if fan opmode = ContFanCycCoil</span>
<a name="ln-1404"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1405"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="o">=</span> <span class="n">UseCompressorOnFlow</span>
<a name="ln-1406"></a>    <span class="k">ELSE</span>
<a name="ln-1407"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="o">=</span> <span class="n">UseCompressorOffFlow</span>
<a name="ln-1408"></a>    <span class="k">END IF</span>
<a name="ln-1409"></a>
<a name="ln-1410"></a><span class="c">!   Initialize last mode of compressor operation</span>
<a name="ln-1411"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="o">=</span> <span class="n">HeatingMode</span>
<a name="ln-1412"></a>
<a name="ln-1413"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1414"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">2</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">4</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1415"></a><span class="k">      If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">MultiSpeedHeatingCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1416"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, The maximum &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is 4, and &#39;</span> <span class="p">&amp;</span>
<a name="ln-1417"></a>                             <span class="o">//</span><span class="s1">&#39;the minimum number is 2&#39;</span><span class="p">)</span>
<a name="ln-1418"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The input value is &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-1419"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1420"></a>      <span class="k">End If</span>
<a name="ln-1421"></a><span class="k">    End If</span>
<a name="ln-1422"></a><span class="k">    </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1423"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">2</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">4</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1424"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, The maximum &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is 4, and &#39;</span> <span class="p">&amp;</span>
<a name="ln-1425"></a>                           <span class="o">//</span><span class="s1">&#39;the minimum number is 2&#39;</span><span class="p">)</span>
<a name="ln-1426"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The input value is &#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-1427"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1428"></a>    <span class="k">End If</span>
<a name="ln-1429"></a>
<a name="ln-1430"></a>    <span class="c">! Generate a dynamic array for heating</span>
<a name="ln-1431"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1432"></a><span class="k">      ALLOCATE</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-1433"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-1434"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-1435"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1436"></a>      <span class="k">Do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-1437"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">10</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
<a name="ln-1438"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">MultiSpeedHeatingCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1439"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1440"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1441"></a>                                 <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">10</span><span class="o">+</span><span class="n">i</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than zero.&#39;</span><span class="p">)</span>
<a name="ln-1442"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1443"></a>          <span class="k">End If</span>
<a name="ln-1444"></a><span class="k">        End If</span>
<a name="ln-1445"></a><span class="k">      End Do</span>
<a name="ln-1446"></a>      <span class="c">! Ensure flow rate at high speed should be greater or equal to the flow rate at low speed</span>
<a name="ln-1447"></a>      <span class="k">Do </span><span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-1448"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">Cycle</span>
<a name="ln-1449"></a><span class="k">        </span><span class="n">found</span> <span class="o">=</span> <span class="p">.</span><span class="n">False</span><span class="p">.</span>
<a name="ln-1450"></a>        <span class="k">Do </span><span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1451"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1452"></a><span class="k">            </span><span class="n">Found</span> <span class="o">=</span> <span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-1453"></a>            <span class="k">Exit</span>
<a name="ln-1454"></a><span class="k">          End If</span>
<a name="ln-1455"></a><span class="k">        End Do</span>
<a name="ln-1456"></a><span class="k">        If</span> <span class="p">(</span><span class="n">Found</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1457"></a><span class="k">          If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-1458"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1459"></a>                                 <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">10</span><span class="o">+</span><span class="n">i</span><span class="p">)))</span>
<a name="ln-1460"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; cannot be less than &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">10</span><span class="o">+</span><span class="n">j</span><span class="p">)))</span>
<a name="ln-1461"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1462"></a>          <span class="k">End If</span>
<a name="ln-1463"></a><span class="k">        End If</span>
<a name="ln-1464"></a><span class="k">      End Do</span>
<a name="ln-1465"></a><span class="k">    End If</span>
<a name="ln-1466"></a>
<a name="ln-1467"></a>    <span class="c">! Generate a dynamic array for cooling</span>
<a name="ln-1468"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1469"></a><span class="k">      ALLOCATE</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span>
<a name="ln-1470"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span>
<a name="ln-1471"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span>
<a name="ln-1472"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1473"></a>      <span class="k">Do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-1474"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
<a name="ln-1475"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1476"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1477"></a>                               <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="n">i</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than zero.&#39;</span><span class="p">)</span>
<a name="ln-1478"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1479"></a>        <span class="k">End If</span>
<a name="ln-1480"></a><span class="k">      End Do</span>
<a name="ln-1481"></a>      <span class="c">! Ensure flow rate at high speed should be greater or equal to the flow rate at low speed</span>
<a name="ln-1482"></a>      <span class="k">Do </span><span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-1483"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">Cycle</span>
<a name="ln-1484"></a><span class="k">        </span><span class="n">found</span> <span class="o">=</span> <span class="p">.</span><span class="n">False</span><span class="p">.</span>
<a name="ln-1485"></a>        <span class="k">Do </span><span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1486"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1487"></a><span class="k">            </span><span class="n">Found</span> <span class="o">=</span> <span class="p">.</span><span class="n">True</span><span class="p">.</span>
<a name="ln-1488"></a>            <span class="k">Exit</span>
<a name="ln-1489"></a><span class="k">          End If</span>
<a name="ln-1490"></a><span class="k">        End Do</span>
<a name="ln-1491"></a><span class="k">        If</span> <span class="p">(</span><span class="n">Found</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1492"></a><span class="k">          If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-1493"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1494"></a>                                 <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="n">i</span><span class="p">)))</span>
<a name="ln-1495"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; cannot be less than &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">14</span><span class="o">+</span><span class="n">j</span><span class="p">)))</span>
<a name="ln-1496"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1497"></a>          <span class="k">End If</span>
<a name="ln-1498"></a><span class="k">        End If</span>
<a name="ln-1499"></a><span class="k">      End Do</span>
<a name="ln-1500"></a><span class="k">    End If</span>
<a name="ln-1501"></a>
<a name="ln-1502"></a>    <span class="c">! Check node integrity</span>
<a name="ln-1503"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanPlaceType</span> <span class="o">==</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1504"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanInletNode</span> <span class="o">/=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1505"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1506"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, the fan inlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1507"></a>                               <span class="s1">&#39;the same as the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1508"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan inlet node name           = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanInletNode</span><span class="p">)))</span>
<a name="ln-1509"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1510"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span><span class="p">)))</span>
<a name="ln-1511"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1512"></a>      <span class="k">END IF</span>
<a name="ln-1513"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">CoolingCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1514"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1515"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, the fan outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1516"></a>                               <span class="s1">&#39;the same as the cooling coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-1517"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name         = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-1518"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span><span class="p">)))</span>
<a name="ln-1519"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1520"></a>      <span class="k">END IF</span>
<a name="ln-1521"></a><span class="k">      IF</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span> <span class="o">/=</span> <span class="n">HeatingCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1522"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1523"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The cooling coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1524"></a>                               <span class="s1">&#39;the same as the heating coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-1525"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-1526"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-1527"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1528"></a>      <span class="k">END IF</span>
<a name="ln-1529"></a><span class="k">      IF</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">/=</span> <span class="n">SuppHeatCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1530"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1531"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, the heating coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1532"></a>                               <span class="s1">&#39;the same as the reheat coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-1533"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-1534"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Reheat coil inlet node name   = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">SuppHeatCoilInletNode</span><span class="p">)))</span>
<a name="ln-1535"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1536"></a>      <span class="k">END IF</span>
<a name="ln-1537"></a><span class="k">      IF</span><span class="p">(</span><span class="n">SuppHeatCoilOutletNode</span> <span class="o">/=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1538"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1539"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The supplemental heating coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1540"></a>                               <span class="s1">&#39;the same as the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1541"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Supplemental heating coil outlet node name   = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">SuppHeatCoilOutletNode</span><span class="p">)))</span>
<a name="ln-1542"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1543"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span><span class="p">)))</span>
<a name="ln-1544"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1545"></a>      <span class="k">END IF</span>
<a name="ln-1546"></a><span class="k">    Else</span>
<a name="ln-1547"></a><span class="k">      IF</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span> <span class="o">/=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1548"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1549"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the cooling coil inlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1550"></a>                               <span class="s1">&#39;the same as the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1551"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span><span class="p">)))</span>
<a name="ln-1552"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1553"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span><span class="p">)))</span>
<a name="ln-1554"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1555"></a>      <span class="k">END IF</span>
<a name="ln-1556"></a><span class="k">      IF</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span> <span class="o">/=</span> <span class="n">HeatingCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1557"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1558"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The cooling coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1559"></a>                               <span class="s1">&#39;the same as the heating coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-1560"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-1561"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-1562"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1563"></a>      <span class="k">END IF</span>
<a name="ln-1564"></a><span class="k">      IF</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">/=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1565"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1566"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the heating coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1567"></a>                               <span class="s1">&#39;the same as the fan inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-1568"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-1569"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan inlet node name           = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanInletNode</span><span class="p">)))</span>
<a name="ln-1570"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1571"></a>      <span class="k">END IF</span>
<a name="ln-1572"></a><span class="k">      IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">SuppHeatCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1573"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1574"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the fan outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1575"></a>                               <span class="s1">&#39;the same as the reheat coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-1576"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name        = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-1577"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Reheat coil inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">SuppheatCoilInletNode</span><span class="p">)))</span>
<a name="ln-1578"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1579"></a>      <span class="k">END IF</span>
<a name="ln-1580"></a><span class="k">      IF</span><span class="p">(</span><span class="n">SuppHeatCoilOutletNode</span> <span class="o">/=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1581"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1582"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The reheat coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1583"></a>                               <span class="s1">&#39;the same as the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1584"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Reheat coil outlet node name   = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">SuppHeatCoilOutletNode</span><span class="p">)))</span>
<a name="ln-1585"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1586"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span><span class="p">)))</span>
<a name="ln-1587"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1588"></a>      <span class="k">END IF</span>
<a name="ln-1589"></a><span class="k">    End If</span>
<a name="ln-1590"></a>
<a name="ln-1591"></a>    <span class="c">! Ensure the numbers of speeds defined in the parent object are equal to the numbers defined in coil objects</span>
<a name="ln-1592"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">MultiSpeedHeatingCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1593"></a><span class="k">      </span><span class="n">I</span> <span class="o">=</span> <span class="n">GetDXCoilNumberOfSpeeds</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1594"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="o">/=</span> <span class="n">I</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1595"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1596"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not equal to the number defined in &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1597"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
<a name="ln-1598"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1599"></a>      <span class="k">End If</span>
<a name="ln-1600"></a><span class="k">    </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingElectric_MultiStage</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1601"></a>           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingGas_MultiStage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1602"></a><span class="k">      </span><span class="n">I</span> <span class="o">=</span> <span class="n">GetHeatingCoilNumberOfStages</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1603"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="o">/=</span> <span class="n">I</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1604"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1605"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not equal to the number defined in &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1606"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
<a name="ln-1607"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1608"></a>      <span class="k">End If</span>
<a name="ln-1609"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-1610"></a>    <span class="n">I</span> <span class="o">=</span> <span class="n">GetDXCoilNumberOfSpeeds</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1611"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">/=</span> <span class="n">I</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1612"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1613"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is not equal to the number defined in &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1614"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">)))</span>
<a name="ln-1615"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1616"></a>    <span class="k">End If</span>
<a name="ln-1617"></a><span class="k">  END DO</span>
<a name="ln-1618"></a>
<a name="ln-1619"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1620"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; input.  &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1621"></a>                        <span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-1622"></a>  <span class="k">END IF</span>
<a name="ln-1623"></a>  <span class="c">! End of multispeed heat pump</span>
<a name="ln-1624"></a>
<a name="ln-1625"></a>  <span class="k">DO </span><span class="n">MSHPNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumMSHeatPumps</span>
<a name="ln-1626"></a>  <span class="c">! Setup Report Variables for MSHP Equipment</span>
<a name="ln-1627"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Ancillary Electric Power [W]&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AuxElecPower</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1628"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1629"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Cooling Ancillary Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1630"></a>                             <span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AuxElecCoolConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1631"></a>                              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1632"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Heating Ancillary Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1633"></a>                             <span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">AuxElecHeatConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1634"></a>                              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Heating&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1635"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Fan Part Load Ratio []&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1636"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1637"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Compressor Part Load Ratio []&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1638"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1639"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Electric Power [W]&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">ElecPower</span><span class="p">,&amp;</span>
<a name="ln-1640"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1641"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Electric Energy [J]&#39;</span><span class="p">,</span><span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">ElecPowerConsumption</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1642"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1643"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System DX Coil Cycling Ratio []&#39;</span><span class="p">,</span><span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">CycRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1644"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1645"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System DX Coil Speed Ratio []&#39;</span><span class="p">,</span><span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SpeedRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1646"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1647"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System DX Coil Speed Level []&#39;</span><span class="p">,</span><span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SpeedNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1648"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1649"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Total Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">TotCoolEnergyRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1650"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1651"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Total Heating Rate [W]&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">TotHeatEnergyRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1652"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1653"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Sensible Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SensCoolEnergyRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1654"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1655"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Sensible Heating Rate [W]&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">SensHeatEnergyRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1656"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1657"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Latent Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">LatCoolEnergyRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1658"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1659"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Latent Heating Rate [W]&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">LatHeatEnergyRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1660"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1661"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1662"></a><span class="k">      CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Heat Recovery Rate [W]&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatRecoveryRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1663"></a>                             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1664"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Heat Recovery Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1665"></a>                             <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatRecoveryInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1666"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Heat Recovery Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1667"></a>                             <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatRecoveryOutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1668"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Heat Recovery Fluid Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1669"></a>                             <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatRecoveryMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1670"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Heat Recovery Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1671"></a>                             <span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">HeatRecoveryEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1672"></a>    <span class="k">End If</span>
<a name="ln-1673"></a><span class="k">  END DO</span>
<a name="ln-1674"></a>
<a name="ln-1675"></a><span class="k">RETURN</span>
<a name="ln-1676"></a><span class="k">END SUBROUTINE </span><span class="n">GetMSHeatPumpInput</span>
<a name="ln-1677"></a>
<a name="ln-1678"></a><span class="c">!******************************************************************************</span>
<a name="ln-1679"></a>
<a name="ln-1680"></a><span class="k">SUBROUTINE </span><span class="n">InitMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">AirLoopNum</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-1681"></a>
<a name="ln-1682"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1683"></a>            <span class="c">!       AUTHOR:          Lixing Gu, FSEC</span>
<a name="ln-1684"></a>            <span class="c">!       DATE WRITTEN:    July 2007</span>
<a name="ln-1685"></a>            <span class="c">!       MODIFIED         Bereket Nigusse, June 2010 - added a procedure to calculate supply air flow fraction</span>
<a name="ln-1686"></a>            <span class="c">!                        through controlled zone</span>
<a name="ln-1687"></a>            <span class="c">!       RE-ENGINEERED    na</span>
<a name="ln-1688"></a>
<a name="ln-1689"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1690"></a>            <span class="c">! This subroutine is for initializations of the multispeed heat pump (MSHP) components.</span>
<a name="ln-1691"></a>
<a name="ln-1692"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1693"></a>            <span class="c">! Uses the status flags to trigger initializations. The MSHP system is simulated with no load (coils off) to</span>
<a name="ln-1694"></a>            <span class="c">! determine the outlet temperature. A setpoint temperature is calculated on FirstHVACIteration = TRUE.</span>
<a name="ln-1695"></a>            <span class="c">! Once the setpoint is calculated, the inlet mass flow rate on FirstHVACIteration = FALSE is used to</span>
<a name="ln-1696"></a>            <span class="c">! determine the bypass fraction. The simulation converges quickly on mass flow rate. If the zone</span>
<a name="ln-1697"></a>            <span class="c">! temperatures float in the deadband, additional iterations are required to converge on mass flow rate.</span>
<a name="ln-1698"></a>
<a name="ln-1699"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1700"></a>            <span class="c">!</span>
<a name="ln-1701"></a>
<a name="ln-1702"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-1703"></a>
<a name="ln-1704"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-1705"></a>  <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>                  <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetFanIndex</span><span class="p">,</span> <span class="n">GetFanVolFlow</span>
<a name="ln-1706"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-1707"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-1708"></a>  <span class="k">USE </span><span class="n">DataSizing</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">AutoSize</span>
<a name="ln-1709"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">StdBaroPress</span>
<a name="ln-1710"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyRhoAirFnPbTdbW</span>
<a name="ln-1711"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-1712"></a>  <span class="k">USE </span><span class="n">DataZoneEnergyDemands</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneSysEnergyDemand</span><span class="p">,</span> <span class="n">CurDeadbandOrSetback</span>
<a name="ln-1713"></a>  <span class="k">USE </span><span class="n">DataBranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">NodeConnections</span><span class="p">,</span> <span class="n">NumOfNodeConnections</span>
<a name="ln-1714"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>        <span class="n">ONLY</span> <span class="p">:</span> <span class="n">SameString</span><span class="p">,</span> <span class="n">MakeUPPERCase</span>
<a name="ln-1715"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">AirLoopControlInfo</span>
<a name="ln-1716"></a>  <span class="k">USE </span><span class="n">DataZoneEquipment</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneEquipConfig</span><span class="p">,</span> <span class="n">ZONEEQUIPLIST</span><span class="p">,</span> <span class="n">AirDistUnit_Num</span><span class="p">,</span> <span class="n">DirectAir_Num</span>
<a name="ln-1717"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span> <span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">AirToZoneNodeInfo</span>
<a name="ln-1718"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>             <span class="n">ONLY</span><span class="p">:</span> <span class="n">ScanPlantLoopsForObject</span><span class="p">,</span> <span class="n">TypeOf_MultiSpeedHeatPumpRecovery</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1719"></a>                                   <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">TypeOf_CoilSteamAirHeating</span><span class="p">,</span> <span class="n">TypeOf_CoilWaterSimpleHeating</span>
<a name="ln-1720"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">InitComponentNodes</span><span class="p">,</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-1721"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">AnyPlantInModel</span>
<a name="ln-1722"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSatDensityRefrig</span>
<a name="ln-1723"></a>  <span class="k">USE </span><span class="n">SteamCoils</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateSteamCoilComponents</span><span class="p">,</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="o">=&gt;</span><span class="n">GetCoilMaxSteamFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1724"></a>                                   <span class="n">GetSteamCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span>
<a name="ln-1725"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">,</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-1726"></a>  <span class="k">USE </span><span class="n">DataZoneControls</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">StageZoneLogic</span>
<a name="ln-1727"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDXCoilAvailSchPtr</span>
<a name="ln-1728"></a>
<a name="ln-1729"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1730"></a>
<a name="ln-1731"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1732"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MSHeatPumpNum</span>      <span class="c">! Engine driven heat pump number</span>
<a name="ln-1733"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! TRUE if first HVAC iteration</span>
<a name="ln-1734"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirLoopNum</span>         <span class="c">! air loop index</span>
<a name="ln-1735"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QZnReq</span>             <span class="c">! Heating/Cooling load for all served zones</span>
<a name="ln-1736"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! Ratio of compressor ON airflow to average airflow over timestep</span>
<a name="ln-1737"></a>
<a name="ln-1738"></a>
<a name="ln-1739"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1740"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">InNode</span>                           <span class="c">! Inlet node number in MSHP loop</span>
<a name="ln-1741"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">OutNode</span>                          <span class="c">! Outlet node number in MSHP loop</span>
<a name="ln-1742"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">ZoneInNode</span>                       <span class="c">! Zone inlet node number in the controlled zone for MSHP</span>
<a name="ln-1743"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HeatRecInNode</span>                    <span class="c">! Inlet node number of heat recovery</span>
<a name="ln-1744"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HeatRecOutNode</span>                   <span class="c">! Outlet node number of heat recovery</span>
<a name="ln-1745"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RhoAir</span>                           <span class="c">! Air density at InNode</span>
<a name="ln-1746"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>           <span class="c">! Initialization flag</span>
<a name="ln-1747"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span> <span class="c">! Used for initializations each begin environment flag</span>
<a name="ln-1748"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySizeFlag</span>  <span class="c">! Used for sizing MSHP inputs one time</span>
<a name="ln-1749"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyCheckFlag</span> <span class="c">! Used to obtain the zone inlet node number in the controlled zone</span>
<a name="ln-1750"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyFlowFracFlag</span> <span class="c">! Used for calculatig flow fraction once</span>
<a name="ln-1751"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyPlantScantFlag</span> <span class="c">! used for finding on heat recovery plant loop</span>
<a name="ln-1752"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyStagedFlag</span> <span class="c">! used for finding on staged thermostat</span>
<a name="ln-1753"></a>
<a name="ln-1754"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">QSensUnitOut</span>                     <span class="c">! Output of MSHP system with coils off</span>
<a name="ln-1755"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">PartLoadFrac</span>                     <span class="c">! Part-load ratio</span>
<a name="ln-1756"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">ZoneNum</span>
<a name="ln-1757"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">i</span>                                <span class="c">! Index to speed</span>
<a name="ln-1758"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">NumOfSpeedCooling</span>                <span class="c">! Number of speeds for cooling</span>
<a name="ln-1759"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">NumOfSpeedHeating</span>                <span class="c">! Number of speeds for heating</span>
<a name="ln-1760"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a name="ln-1761"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MinHumRat</span>                        <span class="c">! Minimum humidity ratio for sensible capacity calculation (kg/kg)</span>
<a name="ln-1762"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DeltaMassRate</span>                    <span class="c">! Difference of mass flow rate between inlet node and system outlet node</span>
<a name="ln-1763"></a>
<a name="ln-1764"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneInSysIndex</span> <span class="o">=</span> <span class="mi">0</span>                        <span class="c">! number of zone inlet nodes counter in an airloop</span>
<a name="ln-1765"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAirLoopZones</span> <span class="o">=</span> <span class="mi">0</span>                       <span class="c">! number of zone inlet nodes in an air loop</span>
<a name="ln-1766"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneInletNodeNum</span> <span class="o">=</span> <span class="mi">0</span>                      <span class="c">! zone inlet nodes node number</span>
<a name="ln-1767"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">FlowFracFlagReady</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>                <span class="c">! one time flag for calculating flow fraction through controlled zone</span>
<a name="ln-1768"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SumOfMassFlowRateMax</span> <span class="o">=</span> <span class="mf">0.0d0</span>              <span class="c">! the sum of mass flow rates at inlet to zones in an airloop</span>
<a name="ln-1769"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CntrlZoneTerminalUnitMassFlowRateMax</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Maximum mass flow rate through controlled zone terminal unit</span>
<a name="ln-1770"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-1771"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span> <span class="c">! local fluid density</span>
<a name="ln-1772"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MdotHR</span> <span class="c">! local temporary for heat recovery fluid mass flow rate (kg/s)</span>
<a name="ln-1773"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneLoadToCoolSPSequenced</span>
<a name="ln-1774"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneLoadToHeatSPSequenced</span>
<a name="ln-1775"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EquipNum</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">! local do loop index for equipment listed for a zone</span>
<a name="ln-1776"></a>
<a name="ln-1777"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">ErrorsFound</span>        <span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>   <span class="c">! flag returned from mining call</span>
<a name="ln-1778"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SteamIndex</span>         <span class="o">=</span><span class="mi">0</span>         <span class="c">! index of steam quality for steam heating coil</span>
<a name="ln-1779"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">mdot</span>               <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! local temporary for mass flow rate (kg/s)</span>
<a name="ln-1780"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SteamDensity</span>       <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! density of steam at 100C, used for steam heating coils</span>
<a name="ln-1781"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! coil fluid maximum volume flow rate</span>
<a name="ln-1782"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">QACTUAL</span>            <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! coil actual capacity</span>
<a name="ln-1783"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">CoilAvailSchPtr</span>    <span class="o">=</span><span class="mi">0</span>         <span class="c">! DX coil availability schedule pointer</span>
<a name="ln-1784"></a>
<a name="ln-1785"></a>  <span class="c">! FLOW</span>
<a name="ln-1786"></a>  <span class="n">InNode</span>  <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-1787"></a>  <span class="n">OutNode</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>
<a name="ln-1788"></a>  <span class="n">NumOfSpeedCooling</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-1789"></a>  <span class="n">NumOfSpeedHeating</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-1790"></a>
<a name="ln-1791"></a>  <span class="n">AirLoopPass</span> <span class="o">=</span> <span class="n">AirLoopPass</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1792"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">AirLoopPass</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="n">AirLoopPass</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1793"></a><span class="c">! Do the one time initializations</span>
<a name="ln-1794"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1795"></a>
<a name="ln-1796"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumMSHeatPumps</span><span class="p">))</span>
<a name="ln-1797"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MySizeFlag</span><span class="p">(</span><span class="n">NumMSHeatPumps</span><span class="p">))</span>
<a name="ln-1798"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyCheckFlag</span><span class="p">(</span><span class="n">NumMSHeatPumps</span><span class="p">))</span>
<a name="ln-1799"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyFlowFracFlag</span><span class="p">(</span><span class="n">NumMSHeatPumps</span><span class="p">))</span>
<a name="ln-1800"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyPlantScantFlag</span><span class="p">(</span><span class="n">NumMSHeatPumps</span><span class="p">))</span>
<a name="ln-1801"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyStagedFlag</span><span class="p">(</span><span class="n">NumMSHeatPumps</span><span class="p">))</span>
<a name="ln-1802"></a>
<a name="ln-1803"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1804"></a>    <span class="n">MySizeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1805"></a>    <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1806"></a>    <span class="n">MyCheckFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1807"></a>    <span class="n">MyFlowFracFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1808"></a>    <span class="n">MyPlantScantFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1809"></a>    <span class="n">MyStagedFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1810"></a>  <span class="k">END IF</span>
<a name="ln-1811"></a>
<a name="ln-1812"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">MyPlantScantFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1813"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1814"></a><span class="k">      </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1815"></a>      <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1816"></a>                                   <span class="n">TypeOf_MultiSpeedHeatPumpRecovery</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1817"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1818"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1819"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1820"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HRCompNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1821"></a>                                   <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-1822"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1823"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitMSHeatPump: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-1824"></a>      <span class="n">ENDIF</span>
<a name="ln-1825"></a>
<a name="ln-1826"></a>      <span class="n">MyPlantScantFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1827"></a>    <span class="k">ELSE</span>
<a name="ln-1828"></a><span class="k">      </span><span class="n">MyPlantScantFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1829"></a>    <span class="n">ENDIF</span>
<a name="ln-1830"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1831"></a><span class="k">        </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1832"></a>        <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1833"></a>                                      <span class="n">TypeOf_CoilWaterSimpleHeating</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1834"></a>                                      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1835"></a>                                      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1836"></a>                                      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1837"></a>                                      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1838"></a>                                      <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-1839"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1840"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitMSHeatPump: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-1841"></a>        <span class="n">ENDIF</span>
<a name="ln-1842"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1843"></a>                                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1844"></a>
<a name="ln-1845"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1846"></a><span class="k">            </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1847"></a>                                   <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1848"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1849"></a>                                   <span class="s1">&#39;InitMSHeatPump&#39;</span><span class="p">)</span>
<a name="ln-1850"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1851"></a>                                    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-1852"></a>        <span class="k">END IF</span>
<a name="ln-1853"></a>        <span class="c">! fill outlet node for coil</span>
<a name="ln-1854"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoilOutletNode</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1855"></a>            <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1856"></a>            <span class="p">%</span><span class="n">Branch</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">NodeNumOut</span>
<a name="ln-1857"></a>        <span class="n">MyPlantScantFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1858"></a>
<a name="ln-1859"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1860"></a><span class="k">        </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1861"></a>        <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1862"></a>                                     <span class="n">TypeOf_CoilSteamAirHeating</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1863"></a>                                     <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1864"></a>                                     <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1865"></a>                                     <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1866"></a>                                     <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1867"></a>                                     <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-1868"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1869"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitMSHeatPump: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-1870"></a>        <span class="n">ENDIF</span>
<a name="ln-1871"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-1872"></a>           <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1873"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1874"></a><span class="k">          </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-1875"></a>          <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;InitMSHeatPump&#39;</span><span class="p">)</span>
<a name="ln-1876"></a>          <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-1877"></a>        <span class="k">END IF</span>
<a name="ln-1878"></a>
<a name="ln-1879"></a>
<a name="ln-1880"></a>      <span class="c">! fill outlet node for coil</span>
<a name="ln-1881"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoilOutletNode</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1882"></a>            <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1883"></a>            <span class="p">%</span><span class="n">Branch</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">NodeNumOut</span>
<a name="ln-1884"></a>      <span class="n">MyPlantScantFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1885"></a>
<a name="ln-1886"></a>    <span class="n">ENDIF</span>
<a name="ln-1887"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1888"></a><span class="k">        </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1889"></a>        <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1890"></a>                                      <span class="n">TypeOf_CoilWaterSimpleHeating</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1891"></a>                                      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1892"></a>                                      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1893"></a>                                      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1894"></a>                                      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1895"></a>                                      <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-1896"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1897"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitMSHeatPump: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-1898"></a>        <span class="n">ENDIF</span>
<a name="ln-1899"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1900"></a>                                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1901"></a>
<a name="ln-1902"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1903"></a><span class="k">            </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1904"></a>                                   <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1905"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1906"></a>                                   <span class="s1">&#39;InitMSHeatPump&#39;</span><span class="p">)</span>
<a name="ln-1907"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1908"></a>                                    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-1909"></a>        <span class="k">END IF</span>
<a name="ln-1910"></a>        <span class="c">! fill outlet node for coil</span>
<a name="ln-1911"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCoilOutletNode</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1912"></a>            <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopSide</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1913"></a>            <span class="p">%</span><span class="n">Branch</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppBranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCompNum</span><span class="p">)%</span><span class="n">NodeNumOut</span>
<a name="ln-1914"></a>        <span class="n">MyPlantScantFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1915"></a>
<a name="ln-1916"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1917"></a><span class="k">        </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1918"></a>        <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1919"></a>                                     <span class="n">TypeOf_CoilSteamAirHeating</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1920"></a>                                     <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1921"></a>                                     <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1922"></a>                                     <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1923"></a>                                     <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1924"></a>                                     <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-1925"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1926"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitMSHeatPump: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-1927"></a>        <span class="n">ENDIF</span>
<a name="ln-1928"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-1929"></a>           <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-1930"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1931"></a><span class="k">          </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-1932"></a>          <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;InitMSHeatPump&#39;</span><span class="p">)</span>
<a name="ln-1933"></a>          <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-1934"></a>        <span class="k">END IF</span>
<a name="ln-1935"></a>
<a name="ln-1936"></a>
<a name="ln-1937"></a>      <span class="c">! fill outlet node for coil</span>
<a name="ln-1938"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCoilOutletNode</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1939"></a>            <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopSide</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1940"></a>            <span class="p">%</span><span class="n">Branch</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppBranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCompNum</span><span class="p">)%</span><span class="n">NodeNumOut</span>
<a name="ln-1941"></a>      <span class="n">MyPlantScantFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1942"></a>    <span class="n">ENDIF</span>
<a name="ln-1943"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">MyPlantScantFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">AnyPlantInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1944"></a><span class="k">    </span><span class="n">MyPlantScantFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1945"></a>  <span class="n">ENDIF</span>
<a name="ln-1946"></a>
<a name="ln-1947"></a>
<a name="ln-1948"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SysSizingCalc</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1949"></a><span class="k">    CALL </span><span class="n">GetFanVolFlow</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span><span class="p">)</span>
<a name="ln-1950"></a>    <span class="k">CALL </span><span class="n">SizeMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span>
<a name="ln-1951"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FlowFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1952"></a>    <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1953"></a>    <span class="c">! Pass the fan cycling schedule index up to the air loop. Set the air loop unitary system flag.</span>
<a name="ln-1954"></a>    <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">CycFanSchedPtr</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span>
<a name="ln-1955"></a>    <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">UnitarySys</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1956"></a>    <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span>
<a name="ln-1957"></a>  <span class="k">END IF</span>
<a name="ln-1958"></a>
<a name="ln-1959"></a><span class="k">  IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyCheckFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1960"></a><span class="k">    DO </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-1961"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">AirLoopNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">AirLoopNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1962"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">ActualZoneNum</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1963"></a><span class="k">        Do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">NumInletNodes</span>
<a name="ln-1964"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1965"></a><span class="k">            Do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">NumInletNodes</span>
<a name="ln-1966"></a>              <span class="k">If</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">InletNode</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">AirDistUnitCool</span><span class="p">(</span><span class="n">k</span><span class="p">)%</span><span class="n">OutNode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1967"></a><span class="k">                </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span> <span class="o">=</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">InletNode</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-1968"></a>                <span class="k">Exit</span>
<a name="ln-1969"></a><span class="k">              End If</span>
<a name="ln-1970"></a><span class="k">            end do</span>
<a name="ln-1971"></a><span class="k">          End If</span>
<a name="ln-1972"></a><span class="k">          If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1973"></a><span class="k">            Do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">NumInletNodes</span>
<a name="ln-1974"></a>              <span class="k">If</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">InletNode</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">AirDistUnitHeat</span><span class="p">(</span><span class="n">k</span><span class="p">)%</span><span class="n">OutNode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1975"></a><span class="k">                </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span> <span class="o">=</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">InletNode</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-1976"></a>                <span class="k">Exit</span>
<a name="ln-1977"></a><span class="k">              End If</span>
<a name="ln-1978"></a><span class="k">            End do</span>
<a name="ln-1979"></a><span class="k">          End If</span>
<a name="ln-1980"></a><span class="k">        End Do</span>
<a name="ln-1981"></a>        <span class="c">!setup furnace zone equipment sequence information based on finding an air terminal</span>
<a name="ln-1982"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1983"></a><span class="k">          DO </span><span class="n">EquipNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">NumOfEquipTypes</span>
<a name="ln-1984"></a>            <span class="k">IF</span> <span class="p">((</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipType_Num</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span> <span class="o">==</span> <span class="n">AirDistUnit_Num</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1985"></a>                <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipType_Num</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span> <span class="o">==</span> <span class="n">DirectAir_Num</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1986"></a><span class="k">              </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ZoneSequenceCoolingNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1987"></a>                         <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">CoolingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-1988"></a>              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ZoneSequenceHeatingNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1989"></a>                         <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">HeatingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-1990"></a>            <span class="n">ENDIF</span>
<a name="ln-1991"></a>          <span class="n">ENDDO</span>
<a name="ln-1992"></a>        <span class="n">ENDIF</span>
<a name="ln-1993"></a>      <span class="k">END IF</span>
<a name="ln-1994"></a><span class="k">    END DO</span>
<a name="ln-1995"></a><span class="k">    </span><span class="n">MyCheckFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1996"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1997"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed&#39;</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1998"></a>                             <span class="s1">&#39;&quot;, The zone inlet node in the controlled zone (&#39;</span> <span class="p">&amp;</span>
<a name="ln-1999"></a>                            <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ControlZoneName</span><span class="p">)</span> <span class="o">//</span><span class="s1">&#39;) is not found.&#39;</span><span class="p">)</span>
<a name="ln-2000"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Subroutine InitMSHeatPump: Errors found in getting &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2001"></a>           <span class="s1">&#39;AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed&#39;</span><span class="o">//</span><span class="s1">&#39; input.  &#39;</span><span class="o">//</span><span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-2002"></a>    <span class="k">End If</span>
<a name="ln-2003"></a><span class="k">  END IF</span>
<a name="ln-2004"></a>
<a name="ln-2005"></a>  <span class="c">! Find the number of zones (zone Inlet Nodes) attached to an air loop from the air loop number</span>
<a name="ln-2006"></a>  <span class="n">NumAirLoopZones</span> <span class="o">=</span> <span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">NumZonesCooled</span> <span class="o">+</span> <span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">NumZonesHeated</span>
<a name="ln-2007"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">AirToZoneNodeInfo</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyFlowFracFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2008"></a><span class="k">      </span><span class="n">FlowFracFlagReady</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2009"></a>      <span class="n">ZonesLoop</span><span class="p">:</span> <span class="k">DO </span><span class="n">ZoneInSysIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumAirLoopZones</span>
<a name="ln-2010"></a>        <span class="c">! zone inlet nodes for cooling</span>
<a name="ln-2011"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">NumZonesCooled</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2012"></a><span class="k">           IF</span><span class="p">(</span> <span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">TermUnitCoolInletNodes</span><span class="p">(</span><span class="n">ZoneInSysIndex</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">999</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-2013"></a>               <span class="c">! the data structure for the zones inlet nodes has not been filled</span>
<a name="ln-2014"></a>               <span class="n">FlowFracFlagReady</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2015"></a>           <span class="n">ENDIF</span>
<a name="ln-2016"></a>        <span class="n">ENDIF</span>
<a name="ln-2017"></a>        <span class="c">! zone inlet nodes for heating</span>
<a name="ln-2018"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">NumZonesHeated</span>  <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2019"></a><span class="k">           IF</span><span class="p">(</span> <span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">TermUnitHeatInletNodes</span><span class="p">(</span><span class="n">ZoneInSysIndex</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">999</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2020"></a>               <span class="c">! the data structure for the zones inlet nodes has not been filled</span>
<a name="ln-2021"></a>               <span class="n">FlowFracFlagReady</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2022"></a>           <span class="n">ENDIF</span>
<a name="ln-2023"></a>        <span class="n">ENDIF</span>
<a name="ln-2024"></a>      <span class="k">END DO </span><span class="n">ZonesLoop</span>
<a name="ln-2025"></a>  <span class="n">ENDIF</span>
<a name="ln-2026"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">AirToZoneNodeInfo</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">FlowFracFlagReady</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2027"></a><span class="k">      </span><span class="n">SumOfMassFlowRateMax</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! initialize the sum of the maximum flows</span>
<a name="ln-2028"></a>      <span class="k">DO </span><span class="n">ZoneInSysIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumAirLoopZones</span>
<a name="ln-2029"></a>         <span class="n">ZoneInletNodeNum</span> <span class="o">=</span> <span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">TermUnitCoolInletNodes</span><span class="p">(</span><span class="n">ZoneInSysIndex</span><span class="p">)</span>
<a name="ln-2030"></a>         <span class="n">SumOfMassFlowRateMax</span> <span class="o">=</span> <span class="n">SumOfMassFlowRateMax</span> <span class="o">+</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>
<a name="ln-2031"></a>         <span class="k">IF</span><span class="p">(</span><span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">CoolCtrlZoneNums</span><span class="p">(</span><span class="n">ZoneInSysIndex</span><span class="p">)</span> <span class="o">==</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-2032"></a><span class="k">            </span><span class="n">CntrlZoneTerminalUnitMassFlowRateMax</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>
<a name="ln-2033"></a>         <span class="n">ENDIF</span>
<a name="ln-2034"></a>      <span class="k">END DO</span>
<a name="ln-2035"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SumOfMassFlowRateMax</span> <span class="o">/=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyFlowFracFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2036"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">CntrlZoneTerminalUnitMassFlowRateMax</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2037"></a><span class="k">              </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FlowFraction</span> <span class="o">=</span> <span class="n">CntrlZoneTerminalUnitMassFlowRateMax</span><span class="o">/</span><span class="n">SumOfMassFlowRateMax</span>
<a name="ln-2038"></a>          <span class="k">ELSE</span>
<a name="ln-2039"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2040"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The Fraction of Supply Air Flow That Goes Through the Controlling Zone is set to 1.&#39;</span><span class="p">)</span>
<a name="ln-2041"></a>          <span class="k">END IF</span>
<a name="ln-2042"></a><span class="k">          CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-2043"></a>                                  <span class="s1">&#39;Fraction of Supply Air Flow That Goes Through the Controlling Zone&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2044"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FlowFraction</span><span class="p">)</span>
<a name="ln-2045"></a>          <span class="n">MyFlowFracFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2046"></a>      <span class="n">ENDIF</span>
<a name="ln-2047"></a>  <span class="n">ENDIF</span>
<a name="ln-2048"></a>
<a name="ln-2049"></a><span class="c">! Do the Begin Environment initializations</span>
<a name="ln-2050"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2051"></a><span class="k">    </span><span class="n">RhoAir</span> <span class="o">=</span> <span class="n">StdRhoAir</span>
<a name="ln-2052"></a>    <span class="c">! set the mass flow rates from the input volume flow rates</span>
<a name="ln-2053"></a>    <span class="k">Do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-2054"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">RhoAir</span><span class="o">*</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-2055"></a>    <span class="k">End Do</span>
<a name="ln-2056"></a><span class="k">    Do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-2057"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">RhoAir</span><span class="o">*</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-2058"></a>    <span class="k">End Do</span>
<a name="ln-2059"></a><span class="k">    </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAir</span><span class="o">*</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span>
<a name="ln-2060"></a>    <span class="c">! set the node max and min mass flow rates</span>
<a name="ln-2061"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2062"></a>                                       <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-2063"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2064"></a>                                            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-2065"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)%</span><span class="n">MassFlowRateMin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2066"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2067"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">OutNode</span><span class="p">)</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)</span>
<a name="ln-2068"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoadLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2069"></a>
<a name="ln-2070"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MyPlantScantFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2071"></a>
<a name="ln-2072"></a><span class="k">      </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2073"></a>                             <span class="mi">6</span><span class="mf">0.d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2074"></a>                             <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2075"></a>                             <span class="s1">&#39;InitMSHeatPump&#39;</span><span class="p">)</span>
<a name="ln-2076"></a>
<a name="ln-2077"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DesignHeatRecFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-2078"></a>
<a name="ln-2079"></a>      <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2080"></a>                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2081"></a>                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2082"></a>                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2083"></a>                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2084"></a>                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2085"></a>                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-2086"></a>    <span class="n">ENDIF</span>
<a name="ln-2087"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoilControlNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2088"></a><span class="k">       IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2089"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2090"></a><span class="k">              CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2091"></a>                                               <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span><span class="p">)</span>
<a name="ln-2092"></a>
<a name="ln-2093"></a>              <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2094"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-2095"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">CoilMaxVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2096"></a><span class="k">                 </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">fluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2097"></a>                                        <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2098"></a>                                        <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">fluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2099"></a>                                        <span class="s1">&#39;InitMSHeatPump&#39;</span><span class="p">)</span>
<a name="ln-2100"></a>                 <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span> <span class="o">=</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-2101"></a>              <span class="n">ENDIF</span>
<a name="ln-2102"></a>              <span class="k">Call </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2103"></a>                                            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2104"></a>                                            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2105"></a>                                            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2106"></a>                                            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2107"></a>                                            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2108"></a>                                            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CompNum</span> <span class="p">)</span>
<a name="ln-2109"></a>          <span class="n">ENDIF</span>
<a name="ln-2110"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2111"></a>
<a name="ln-2112"></a><span class="k">             CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2113"></a>                                              <span class="n">FirstHVACIteration</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2114"></a>                                              <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!QCoilReq, simulate any load &gt; 0 to get max capacity of steam coil</span>
<a name="ln-2115"></a>                                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-2116"></a>             <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-2117"></a>
<a name="ln-2118"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">CoilMaxVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2119"></a><span class="k">                </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-2120"></a>                <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;InitMSHeatPump&#39;</span><span class="p">)</span>
<a name="ln-2121"></a>                <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span> <span class="o">=</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-2122"></a>             <span class="n">ENDIF</span>
<a name="ln-2123"></a>             <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2124"></a>                                           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2125"></a>                                           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2126"></a>                                           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2127"></a>                                           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2128"></a>                                           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2129"></a>                                           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CompNum</span> <span class="p">)</span>
<a name="ln-2130"></a>          <span class="n">ENDIF</span>
<a name="ln-2131"></a>       <span class="n">ENDIF</span>
<a name="ln-2132"></a>    <span class="n">ENDIF</span>
<a name="ln-2133"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2134"></a><span class="k">       IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2135"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2136"></a><span class="k">              CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2137"></a>                                               <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span><span class="p">)</span>
<a name="ln-2138"></a>
<a name="ln-2139"></a>              <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2140"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-2141"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">CoilMaxVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2142"></a><span class="k">                 </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopNum</span><span class="p">)%</span><span class="n">fluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2143"></a>                                        <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2144"></a>                                        <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopNum</span><span class="p">)%</span><span class="n">fluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2145"></a>                                        <span class="s1">&#39;InitMSHeatPump&#39;</span><span class="p">)</span>
<a name="ln-2146"></a>                 <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-2147"></a>              <span class="n">ENDIF</span>
<a name="ln-2148"></a>              <span class="k">Call </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2149"></a>                                            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2150"></a>                                            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2151"></a>                                            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2152"></a>                                            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2153"></a>                                            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2154"></a>                                            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCompNum</span> <span class="p">)</span>
<a name="ln-2155"></a>          <span class="n">ENDIF</span>
<a name="ln-2156"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2157"></a>
<a name="ln-2158"></a><span class="k">             CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2159"></a>                                              <span class="n">FirstHVACIteration</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2160"></a>                                              <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!QCoilReq, simulate any load &gt; 0 to get max capacity of steam coil</span>
<a name="ln-2161"></a>                                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-2162"></a>             <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-2163"></a>
<a name="ln-2164"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">CoilMaxVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2165"></a><span class="k">                </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-2166"></a>                <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;InitMSHeatPump&#39;</span><span class="p">)</span>
<a name="ln-2167"></a>                <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-2168"></a>             <span class="n">ENDIF</span>
<a name="ln-2169"></a>             <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2170"></a>                                           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2171"></a>                                           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2172"></a>                                           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2173"></a>                                           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2174"></a>                                           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2175"></a>                                           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCompNum</span> <span class="p">)</span>
<a name="ln-2176"></a>          <span class="n">ENDIF</span>
<a name="ln-2177"></a>       <span class="n">ENDIF</span>
<a name="ln-2178"></a>    <span class="n">ENDIF</span>
<a name="ln-2179"></a>    <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2180"></a>  <span class="k">END IF</span> <span class="c">! end one time inits</span>
<a name="ln-2181"></a>
<a name="ln-2182"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2183"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2184"></a>  <span class="k">END IF</span>
<a name="ln-2185"></a>
<a name="ln-2186"></a><span class="c">! IF MSHP system was not autosized and the fan is autosized, check that fan volumetric flow rate is greater than MSHP flow rates</span>
<a name="ln-2187"></a>  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DoingSizing</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CheckFanFlow</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2188"></a><span class="k">    </span><span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed&#39;</span>
<a name="ln-2189"></a>    <span class="k">CALL </span><span class="n">GetFanVolFlow</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span><span class="p">)</span>
<a name="ln-2190"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2191"></a><span class="c">!     Check fan versus system supply air flow rates</span>
<a name="ln-2192"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2193"></a>         <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2194"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; - air flow rate = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2195"></a>                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; in fan object &#39;</span> <span class="p">&amp;</span>
<a name="ln-2196"></a>                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; is less than the MSHP system air flow rate&#39;</span> <span class="p">&amp;</span>
<a name="ln-2197"></a>                        <span class="o">//</span><span class="s1">&#39; when cooling is required (&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2198"></a>        <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">),</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-2199"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The MSHP system flow rate when cooling is required is reset to the&#39;</span> <span class="p">&amp;</span>
<a name="ln-2200"></a>                              <span class="o">//</span><span class="s1">&#39; fan flow rate and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2201"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2202"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span>
<a name="ln-2203"></a>        <span class="c">! Check flow rates in other speeds and ensure flow rates are not above the max flow rate</span>
<a name="ln-2204"></a>        <span class="k">Do </span><span class="n">i</span><span class="o">=</span><span class="n">NumOfSpeedCooling</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2205"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-2206"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The MSHP system flow rate when cooling is required is reset to the&#39;</span> <span class="p">&amp;</span>
<a name="ln-2207"></a>                 <span class="o">//</span><span class="s1">&#39; flow rate at higher speed and the simulation continues at Speed&#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-2208"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2209"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2210"></a>          <span class="k">End If</span>
<a name="ln-2211"></a><span class="k">        End Do</span>
<a name="ln-2212"></a><span class="k">      END IF</span>
<a name="ln-2213"></a><span class="k">      IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2214"></a>         <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2215"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; - air flow rate = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2216"></a>                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; in fan object &#39;</span> <span class="p">&amp;</span>
<a name="ln-2217"></a>                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; is less than the MSHP system air flow rate&#39;</span> <span class="p">&amp;</span>
<a name="ln-2218"></a>                        <span class="o">//</span><span class="s1">&#39; when heating is required (&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2219"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span><span class="p">),</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-2220"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The MSHP system flow rate when heating is required is reset to the&#39;</span> <span class="p">&amp;</span>
<a name="ln-2221"></a>                              <span class="o">//</span><span class="s1">&#39; fan flow rate and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2222"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2223"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span>
<a name="ln-2224"></a>        <span class="k">Do </span><span class="n">i</span><span class="o">=</span><span class="n">NumOfSpeedHeating</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2225"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-2226"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The MSHP system flow rate when heating is required is reset to the&#39;</span> <span class="p">&amp;</span>
<a name="ln-2227"></a>                 <span class="o">//</span><span class="s1">&#39; flow rate at higher speed and the simulation continues at Speed&#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-2228"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; system = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2229"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2230"></a>          <span class="k">End If</span>
<a name="ln-2231"></a><span class="k">        End Do</span>
<a name="ln-2232"></a><span class="k">      END IF</span>
<a name="ln-2233"></a><span class="k">      IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2234"></a>         <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2235"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; - air flow rate = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2236"></a>                   <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; in fan object &#39;</span> <span class="p">&amp;</span>
<a name="ln-2237"></a>                   <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; is less than the MSHP system air flow rate when no &#39;</span> <span class="p">&amp;</span>
<a name="ln-2238"></a>                   <span class="o">//</span><span class="s1">&#39;heating or cooling is needed (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-2239"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The MSHP system flow rate when no heating or cooling is needed is reset to the&#39;</span> <span class="p">&amp;</span>
<a name="ln-2240"></a>                              <span class="o">//</span><span class="s1">&#39; fan flow rate and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2241"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2242"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span>
<a name="ln-2243"></a>      <span class="k">END IF</span>
<a name="ln-2244"></a><span class="k">      </span><span class="n">RhoAir</span> <span class="o">=</span> <span class="n">StdRhoAir</span>
<a name="ln-2245"></a>      <span class="c">! set the mass flow rates from the reset volume flow rates</span>
<a name="ln-2246"></a>      <span class="k">Do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-2247"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">RhoAir</span><span class="o">*</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-2248"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2249"></a><span class="k">          </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2250"></a>              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span>
<a name="ln-2251"></a>        <span class="k">END IF</span>
<a name="ln-2252"></a><span class="k">      End Do</span>
<a name="ln-2253"></a><span class="k">      Do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-2254"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">RhoAir</span><span class="o">*</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-2255"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2256"></a><span class="k">          </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2257"></a>              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span>
<a name="ln-2258"></a>        <span class="k">END IF</span>
<a name="ln-2259"></a><span class="k">      End Do</span>
<a name="ln-2260"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAir</span><span class="o">*</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span>
<a name="ln-2261"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2262"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2263"></a>            <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">/</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span>
<a name="ln-2264"></a>      <span class="k">END IF</span>
<a name="ln-2265"></a>      <span class="c">! set the node max and min mass flow rates based on reset volume flow rates</span>
<a name="ln-2266"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2267"></a>                                         <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-2268"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2269"></a>                                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-2270"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)%</span><span class="n">MassFlowRateMin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2271"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2272"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">OutNode</span><span class="p">)</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)</span>
<a name="ln-2273"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CheckFanFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2274"></a>    <span class="k">END IF</span>
<a name="ln-2275"></a><span class="k">  END IF</span>
<a name="ln-2276"></a>
<a name="ln-2277"></a><span class="k">  IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2278"></a><span class="k">    IF</span><span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2279"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="o">=</span> <span class="n">CycFanCycCoil</span>
<a name="ln-2280"></a>    <span class="k">ELSE</span>
<a name="ln-2281"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="o">=</span> <span class="n">ContFanCycCoil</span>
<a name="ln-2282"></a>    <span class="k">END IF</span>
<a name="ln-2283"></a><span class="k">  END IF</span>
<a name="ln-2284"></a>
<a name="ln-2285"></a>  <span class="c">! Calcuate air distribution losses</span>
<a name="ln-2286"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">AirLoopPass</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2287"></a><span class="k">    </span><span class="n">ZoneInNode</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span>
<a name="ln-2288"></a>    <span class="n">MinHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneInNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-2289"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Node</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2290"></a>      <span class="n">MinHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-2291"></a>    <span class="n">DeltaMassRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutNode</span><span class="p">)%</span><span class="n">MassFlowrate</span><span class="o">-</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneInNode</span><span class="p">)%</span><span class="n">MassFlowrate</span><span class="o">/</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FlowFraction</span>
<a name="ln-2292"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">DeltaMassRate</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">DeltaMassRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2293"></a>    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoadLoss</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneInNode</span><span class="p">)%</span><span class="n">MassFlowrate</span><span class="o">/</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FlowFraction</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2294"></a>      <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRat</span><span class="p">)</span> <span class="o">-</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneInNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRat</span><span class="p">))</span> <span class="o">+</span> <span class="n">DeltaMassRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2295"></a>      <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRat</span><span class="p">)</span> <span class="o">-</span>   <span class="p">&amp;</span>
<a name="ln-2296"></a>         <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRat</span><span class="p">))</span>
<a name="ln-2297"></a>    <span class="k">If</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoadLoss</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">1.0d-6</span><span class="p">)</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoadLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2298"></a>  <span class="k">End If</span>
<a name="ln-2299"></a>
<a name="ln-2300"></a><span class="c">! Returns load only for zones requesting cooling (heating). If in deadband, Qzoneload = 0.</span>
<a name="ln-2301"></a>  <span class="n">ZoneNum</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span>
<a name="ln-2302"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ZoneSequenceCoolingNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ZoneSequenceHeatingNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2303"></a><span class="k">    </span><span class="n">ZoneLoadToCoolSPSequenced</span> <span class="o">=</span> <span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%&amp;</span>
<a name="ln-2304"></a>                  <span class="n">SequencedOutputRequiredToCoolingSP</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ZoneSequenceCoolingNum</span><span class="p">)</span>
<a name="ln-2305"></a>    <span class="n">ZoneLoadToHeatSPSequenced</span> <span class="o">=</span> <span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%&amp;</span>
<a name="ln-2306"></a>                  <span class="n">SequencedOutputRequiredToHeatingSP</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ZoneSequenceHeatingNum</span><span class="p">)</span>
<a name="ln-2307"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneLoadToHeatSPSequenced</span> <span class="o">&gt;</span> <span class="n">SmallLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZoneLoadToCoolSPSequenced</span> <span class="o">&gt;</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2308"></a><span class="k">      </span><span class="n">QZnReq</span> <span class="o">=</span> <span class="n">ZoneLoadToHeatSPSequenced</span>
<a name="ln-2309"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">ZoneLoadToHeatSPSequenced</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZoneLoadToCoolSPSequenced</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2310"></a><span class="k">      </span><span class="n">QZnReq</span> <span class="o">=</span> <span class="n">ZoneLoadToCoolSPSequenced</span>
<a name="ln-2311"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">ZoneLoadToHeatSPSequenced</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZoneLoadToCoolSPSequenced</span> <span class="o">&gt;=</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2312"></a><span class="k">      </span><span class="n">QZnReq</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2313"></a>    <span class="n">ENDIF</span>
<a name="ln-2314"></a>    <span class="n">QZnReq</span> <span class="o">=</span> <span class="n">QZnReq</span><span class="o">/</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FlowFraction</span>
<a name="ln-2315"></a>  <span class="k">ELSE</span>
<a name="ln-2316"></a><span class="k">    </span><span class="n">QZnReq</span> <span class="o">=</span> <span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">RemainingOutputRequired</span><span class="o">/</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FlowFraction</span>
<a name="ln-2317"></a>  <span class="n">ENDIF</span>
<a name="ln-2318"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">CurDeadbandOrSetback</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="n">QZnReq</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2319"></a>
<a name="ln-2320"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="o">&gt;</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2321"></a><span class="k">    </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">=</span> <span class="n">HeatingMode</span>
<a name="ln-2322"></a>  <span class="k">Else If</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2323"></a><span class="k">    </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">=</span> <span class="n">CoolingMode</span>
<a name="ln-2324"></a>  <span class="k">Else</span>
<a name="ln-2325"></a><span class="k">    </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2326"></a>  <span class="k">End If</span>
<a name="ln-2327"></a>
<a name="ln-2328"></a>  <span class="c">! Determine the staged status</span>
<a name="ln-2329"></a>  <span class="k">If</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">StageZoneLogic</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-2330"></a><span class="k">    If</span> <span class="p">(</span><span class="n">StageZoneLogic</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-2331"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Staged</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2332"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">StageNum</span> <span class="o">=</span> <span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">StageNum</span>
<a name="ln-2333"></a>    <span class="k">Else</span>
<a name="ln-2334"></a><span class="k">      If</span> <span class="p">(</span><span class="n">MyStagedFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-2335"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;ZoneControl:Thermostat:StagedDualSetpoint is found, but is not applied to &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2336"></a>             <span class="s1">&#39;this AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed object = &#39;</span><span class="p">)</span>
<a name="ln-2337"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="o">//</span><span class="s1">&#39;. Please make correction. Simulation continues...&#39;</span><span class="p">)</span>
<a name="ln-2338"></a>        <span class="n">MyStagedFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2339"></a>      <span class="k">End If</span>
<a name="ln-2340"></a><span class="k">    End If</span>
<a name="ln-2341"></a><span class="k">  End If</span>
<a name="ln-2342"></a>  <span class="c">! Set the inlet node mass flow rate</span>
<a name="ln-2343"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2344"></a>  <span class="c">! constant fan mode</span>
<a name="ln-2345"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="o">&gt;</span> <span class="n">SmallLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CurDeadbandOrSetback</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2346"></a><span class="k">      </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2347"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2348"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="o">=</span> <span class="n">HeatingMode</span>
<a name="ln-2349"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CurDeadbandOrSetback</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2350"></a><span class="k">      </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2351"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2352"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="o">=</span> <span class="n">CoolingMode</span>
<a name="ln-2353"></a>    <span class="k">ELSE</span>
<a name="ln-2354"></a><span class="k">      </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-2355"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-2356"></a>    <span class="k">END IF</span>
<a name="ln-2357"></a><span class="k">    </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-2358"></a>    <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-2359"></a>  <span class="k">ELSE</span>
<a name="ln-2360"></a>  <span class="c">! cycling fan mode</span>
<a name="ln-2361"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="o">&gt;</span> <span class="n">SmallLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CurDeadbandOrSetback</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2362"></a><span class="k">      </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2363"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2364"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CurDeadbandOrSetback</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2365"></a><span class="k">      </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2366"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2367"></a>    <span class="k">ELSE</span>
<a name="ln-2368"></a><span class="k">      </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2369"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2370"></a>    <span class="k">END IF</span>
<a name="ln-2371"></a><span class="k">    </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2372"></a>    <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2373"></a>  <span class="k">END IF</span>
<a name="ln-2374"></a>
<a name="ln-2375"></a>  <span class="c">! Set the inlet node mass flow rate</span>
<a name="ln-2376"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AvaiSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CompOnMassFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2377"></a><span class="k">    </span><span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2378"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2379"></a><span class="k">      </span><span class="n">Node</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span>
<a name="ln-2380"></a>      <span class="n">PartLoadFrac</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2381"></a>    <span class="k">ELSE</span>
<a name="ln-2382"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2383"></a><span class="k">        </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2384"></a>      <span class="k">ELSE</span>
<a name="ln-2385"></a><span class="k">        </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2386"></a>      <span class="k">END IF</span>
<a name="ln-2387"></a><span class="k">    END IF</span>
<a name="ln-2388"></a><span class="k">  ELSE</span>
<a name="ln-2389"></a><span class="k">    </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2390"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2391"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">OutNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2392"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">OutNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2393"></a>    <span class="n">OnOffAirFlowRatio</span>      <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2394"></a>  <span class="k">END IF</span>
<a name="ln-2395"></a>
<a name="ln-2396"></a>  <span class="c">! Check availability of DX coils</span>
<a name="ln-2397"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AvaiSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2398"></a><span class="k">    If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">CoolingMode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2399"></a><span class="k">      </span><span class="n">CoilAvailSchPtr</span><span class="o">=</span><span class="n">GetDXCoilAvailSchPtr</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:MultiSpeed&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2400"></a>                      <span class="n">ErrorsFound</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilIndex</span><span class="p">)</span>
<a name="ln-2401"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2402"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitMSHeatPump, The previous error causes termination.&#39;</span><span class="p">)</span>
<a name="ln-2403"></a>      <span class="k">End If</span>
<a name="ln-2404"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">CoilAvailSchPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2405"></a><span class="k">        If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolCountAvail</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2406"></a><span class="k">          </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolCountAvail</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolCountAvail</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2407"></a>          <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="o">//</span><span class="s1">&#39; is ready to perform cooling, but its DX cooling coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2408"></a>            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; is not available at Available Schedule = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2409"></a>            <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">GetScheduleName</span><span class="p">(</span><span class="n">CoilAvailSchPtr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-2410"></a>          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Availability schedule returned=&#39;</span> <span class="p">&amp;</span>
<a name="ln-2411"></a>             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">CoilAvailSchPtr</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-2412"></a>        <span class="k">Else</span>
<a name="ln-2413"></a><span class="k">          </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolCountAvail</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolCountAvail</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2414"></a>          <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2415"></a>            <span class="s1">&#39; Cooling coil is still not available ...&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolIndexAvail</span> <span class="p">&amp;</span>
<a name="ln-2416"></a>            <span class="p">,</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">CoilAvailSchPtr</span><span class="p">),</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">CoilAvailSchPtr</span><span class="p">))</span>
<a name="ln-2417"></a>        <span class="k">End If</span>
<a name="ln-2418"></a><span class="k">      End If</span>
<a name="ln-2419"></a><span class="k">    End If</span>
<a name="ln-2420"></a><span class="k">    If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">HeatingMode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2421"></a>       <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="o">==</span> <span class="n">MultiSpeedHeatingCoil</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2422"></a><span class="k">      </span><span class="n">CoilAvailSchPtr</span><span class="o">=</span><span class="n">GetDXCoilAvailSchPtr</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:DX:MultiSpeed&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2423"></a>                      <span class="n">ErrorsFound</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilIndex</span><span class="p">)</span>
<a name="ln-2424"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2425"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitMSHeatPump, The previous error causes termination.&#39;</span><span class="p">)</span>
<a name="ln-2426"></a>      <span class="k">End If</span>
<a name="ln-2427"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">CoilAvailSchPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2428"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCountAvail</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2429"></a><span class="k">          </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCountAvail</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCountAvail</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2430"></a>          <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="o">//</span><span class="s1">&#39; is ready to perform heating, but its DX heating coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2431"></a>            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; is not available at Available Schedule = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2432"></a>            <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">GetScheduleName</span><span class="p">(</span><span class="n">CoilAvailSchPtr</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-2433"></a>          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Availability schedule returned=&#39;</span> <span class="p">&amp;</span>
<a name="ln-2434"></a>             <span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">CoilAvailSchPtr</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-2435"></a>        <span class="k">Else</span>
<a name="ln-2436"></a><span class="k">          </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCountAvail</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCountAvail</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2437"></a>          <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2438"></a>            <span class="s1">&#39; Heating coil is still not available ...&#39;</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatIndexAvail</span> <span class="p">&amp;</span>
<a name="ln-2439"></a>            <span class="p">,</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">CoilAvailSchPtr</span><span class="p">),</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">CoilAvailSchPtr</span><span class="p">))</span>
<a name="ln-2440"></a>        <span class="k">End If</span>
<a name="ln-2441"></a><span class="k">      End If</span>
<a name="ln-2442"></a><span class="k">    End If</span>
<a name="ln-2443"></a><span class="k">  End If</span>
<a name="ln-2444"></a>
<a name="ln-2445"></a><span class="k">  </span><span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CycRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2446"></a>  <span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2447"></a>  <span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2448"></a>
<a name="ln-2449"></a>  <span class="k">CALL </span><span class="n">CalcMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">QSensUnitOut</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2450"></a>                       <span class="n">QZnReq</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-2451"></a>
<a name="ln-2452"></a><span class="c">! If unit is scheduled OFF, setpoint is equal to inlet node temperature.</span>
<a name="ln-2453"></a>  <span class="n">MSHeatPump</span><span class="p">%</span><span class="n">TotHeatEnergyRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2454"></a>  <span class="n">MSHeatPump</span><span class="p">%</span><span class="n">SensHeatEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2455"></a>  <span class="n">MSHeatPump</span><span class="p">%</span><span class="n">LatHeatEnergyRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2456"></a>  <span class="n">MSHeatPump</span><span class="p">%</span><span class="n">TotCoolEnergyRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2457"></a>  <span class="n">MSHeatPump</span><span class="p">%</span><span class="n">SensCoolEnergyRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2458"></a>  <span class="n">MSHeatPump</span><span class="p">%</span><span class="n">LatCoolEnergyRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2459"></a>
<a name="ln-2460"></a><span class="c">!!!LKL Discrepancy with &lt; 0</span>
<a name="ln-2461"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AvaiSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2462"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">OutNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2463"></a>    <span class="k">RETURN</span>
<a name="ln-2464"></a><span class="k">  END IF</span>
<a name="ln-2465"></a>
<a name="ln-2466"></a><span class="k">  IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-2467"></a>     <span class="n">CompOnMassFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2468"></a><span class="k">    </span><span class="n">QZnReq</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2469"></a>    <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2470"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2471"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">OutNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2472"></a>  <span class="k">END IF</span>
<a name="ln-2473"></a><span class="k">  </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoadMet</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2474"></a>  <span class="k">CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-2475"></a>
<a name="ln-2476"></a>  <span class="c">!Init maximum available Heat Recovery flow rate</span>
<a name="ln-2477"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MyPlantScantFlag</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2478"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">PartLoadFrac</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2479"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2480"></a><span class="k">        </span><span class="n">MdotHR</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span>
<a name="ln-2481"></a>      <span class="k">ELSE</span>
<a name="ln-2482"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecoveryMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2483"></a><span class="k">          </span><span class="n">MdotHR</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecoveryMassFlowRate</span>
<a name="ln-2484"></a>        <span class="k">ELSE</span>
<a name="ln-2485"></a><span class="k">          </span><span class="n">MdotHR</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DesignHeatRecMassFlowRate</span>
<a name="ln-2486"></a>        <span class="n">ENDIF</span>
<a name="ln-2487"></a>      <span class="n">ENDIF</span>
<a name="ln-2488"></a>    <span class="k">ELSE</span>
<a name="ln-2489"></a><span class="k">      </span><span class="n">MdotHR</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2490"></a>    <span class="n">ENDIF</span>
<a name="ln-2491"></a>
<a name="ln-2492"></a>    <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">MdotHR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2493"></a>                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2494"></a>                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2495"></a>                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2496"></a>                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HRLoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2497"></a>                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HRBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2498"></a>                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HRCompNum</span> <span class="p">)</span>
<a name="ln-2499"></a>  <span class="n">ENDIF</span>
<a name="ln-2500"></a>
<a name="ln-2501"></a>  <span class="c">! get operating capacity of water and steam coil</span>
<a name="ln-2502"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2503"></a><span class="k">    IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2504"></a>      <span class="c">!     set air-side and steam-side mass flow rates</span>
<a name="ln-2505"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoilAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span>
<a name="ln-2506"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span>
<a name="ln-2507"></a>      <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdot</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2508"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2509"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2510"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2511"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2512"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2513"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CompNum</span> <span class="p">)</span>
<a name="ln-2514"></a>      <span class="c">!     simulate water coil to find operating capacity</span>
<a name="ln-2515"></a>      <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2516"></a>                                       <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-2517"></a>    <span class="k">END IF</span> <span class="c">! from IF(MSHeatPump(MSHeatPumpNum)%HeatCoilType == Coil_HeatingWater) THEN</span>
<a name="ln-2518"></a>
<a name="ln-2519"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2520"></a>
<a name="ln-2521"></a>      <span class="c">!     set air-side and steam-side mass flow rates</span>
<a name="ln-2522"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoilAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span>
<a name="ln-2523"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span>
<a name="ln-2524"></a>      <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdot</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2525"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2526"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2527"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2528"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2529"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2530"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CompNum</span> <span class="p">)</span>
<a name="ln-2531"></a>
<a name="ln-2532"></a><span class="c">!     simulate steam coil to find operating capacity</span>
<a name="ln-2533"></a>      <span class="k">CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2534"></a>                                       <span class="n">FirstHVACIteration</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2535"></a>                                       <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!QCoilReq, simulate any load &gt; 0 to get max capacity of steam coil</span>
<a name="ln-2536"></a>                                       <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-2537"></a>
<a name="ln-2538"></a>    <span class="k">END IF</span> <span class="c">! from IF(MSHeatPump(MSHeatPumpNum)%HeatCoilType == Coil_HeatingSteam) THEN</span>
<a name="ln-2539"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2540"></a>      <span class="c">!     set air-side and steam-side mass flow rates</span>
<a name="ln-2541"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span>
<a name="ln-2542"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span>
<a name="ln-2543"></a>      <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdot</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2544"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2545"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2546"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2547"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2548"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2549"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCompNum</span> <span class="p">)</span>
<a name="ln-2550"></a>      <span class="c">!     simulate water coil to find operating capacity</span>
<a name="ln-2551"></a>      <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2552"></a>                                       <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-2553"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="n">QActual</span>
<a name="ln-2554"></a>
<a name="ln-2555"></a>    <span class="k">END IF</span> <span class="c">! from IF(MSHeatPump(MSHeatPumpNum)%SuppHeatCoilType == Coil_HeatingWater) THEN</span>
<a name="ln-2556"></a>
<a name="ln-2557"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2558"></a>
<a name="ln-2559"></a>      <span class="c">!     set air-side and steam-side mass flow rates</span>
<a name="ln-2560"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span>
<a name="ln-2561"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span>
<a name="ln-2562"></a>      <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdot</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2563"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2564"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2565"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2566"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2567"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2568"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCompNum</span> <span class="p">)</span>
<a name="ln-2569"></a>
<a name="ln-2570"></a><span class="c">!     simulate steam coil to find operating capacity</span>
<a name="ln-2571"></a>      <span class="k">CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2572"></a>                                       <span class="n">FirstHVACIteration</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2573"></a>                                       <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!QCoilReq, simulate any load &gt; 0 to get max capacity of steam coil</span>
<a name="ln-2574"></a>                                       <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-2575"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="n">GetSteamCoilCapacity</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2576"></a>                                                      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-2577"></a>
<a name="ln-2578"></a>    <span class="k">END IF</span> <span class="c">! from IF(MSHeatPump(MSHeatPumpNum)%SuppHeatCoilType == Coil_HeatingSteam) THEN</span>
<a name="ln-2579"></a><span class="k">END IF</span> <span class="c">! from IF( FirstHVACIteration ) THEN</span>
<a name="ln-2580"></a>
<a name="ln-2581"></a><span class="k">RETURN</span>
<a name="ln-2582"></a><span class="k">END SUBROUTINE </span><span class="n">InitMSHeatPump</span>
<a name="ln-2583"></a>
<a name="ln-2584"></a><span class="c">!******************************************************************************</span>
<a name="ln-2585"></a>
<a name="ln-2586"></a><span class="k">SUBROUTINE </span><span class="n">SizeMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span>
<a name="ln-2587"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2588"></a>            <span class="c">!       AUTHOR:          Lixing Gu, FSEC</span>
<a name="ln-2589"></a>            <span class="c">!       DATE WRITTEN:    June 2007</span>
<a name="ln-2590"></a>            <span class="c">!       MODIFIED         na</span>
<a name="ln-2591"></a>            <span class="c">!       RE-ENGINEERED    na</span>
<a name="ln-2592"></a>
<a name="ln-2593"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2594"></a>            <span class="c">! This subroutine is for sizing multispeed heat pump airflow rates and flow fraction.</span>
<a name="ln-2595"></a>
<a name="ln-2596"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2597"></a>            <span class="c">!</span>
<a name="ln-2598"></a>
<a name="ln-2599"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-2600"></a>
<a name="ln-2601"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-2602"></a>  <span class="k">USE </span><span class="n">DataSizing</span>
<a name="ln-2603"></a>  <span class="k">USE </span><span class="n">InputProcessor</span>
<a name="ln-2604"></a>  <span class="k">USE </span><span class="n">DataZoneEquipment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneEquipConfig</span>
<a name="ln-2605"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-2606"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-2607"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-2608"></a>
<a name="ln-2609"></a>
<a name="ln-2610"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2611"></a>
<a name="ln-2612"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2613"></a>  <span class="kt">INTEGER</span>         <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MSHeatPumpNum</span>      <span class="c">! Engine driven heat pump number</span>
<a name="ln-2614"></a>
<a name="ln-2615"></a>
<a name="ln-2616"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2617"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">ControlledZoneNum</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Index of Controllerd zone number</span>
<a name="ln-2618"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">ThisCtrlZoneNum</span> <span class="o">=</span> <span class="mi">0</span>          <span class="c">! Controllerd zone number</span>
<a name="ln-2619"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">ControlZoneVolFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Controlled zone volumetric flow</span>
<a name="ln-2620"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumOfSpeedCooling</span>            <span class="c">! Number of speeds for cooling</span>
<a name="ln-2621"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumOfSpeedHeating</span>            <span class="c">! Number of speeds for heating</span>
<a name="ln-2622"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">i</span>                            <span class="c">! Index to speed</span>
<a name="ln-2623"></a>
<a name="ln-2624"></a>  <span class="c">! FLOW</span>
<a name="ln-2625"></a>  <span class="n">NumOfSpeedCooling</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-2626"></a>  <span class="n">NumOfSpeedHeating</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-2627"></a>
<a name="ln-2628"></a><span class="k">Do </span><span class="n">I</span><span class="o">=</span><span class="n">NumOfSpeedCooling</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2629"></a>
<a name="ln-2630"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2631"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2632"></a><span class="k">      If</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">NumOfSpeedCooling</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2633"></a><span class="k">        CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2634"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2635"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2636"></a>          <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2637"></a><span class="k">          </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span>
<a name="ln-2638"></a>          <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-2639"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The supply air flow rate at high speed is less than the &#39;</span> <span class="p">&amp;</span>
<a name="ln-2640"></a>              <span class="o">//</span><span class="s1">&#39;autosized value for the supply air flow rate in cooling mode. Consider autosizing the fan for&#39;</span> <span class="p">&amp;</span>
<a name="ln-2641"></a>              <span class="o">//</span><span class="s1">&#39; this simulation.&#39;</span><span class="p">)</span>
<a name="ln-2642"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The air flow rate at high speed in cooling mode &#39;</span> <span class="p">&amp;</span>
<a name="ln-2643"></a>                             <span class="o">//</span><span class="s1">&#39;is reset to the supply air flow rate and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2644"></a>        <span class="k">END IF</span>
<a name="ln-2645"></a><span class="k">      Else</span>
<a name="ln-2646"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2647"></a>                                                          <span class="n">i</span><span class="o">/</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-2648"></a>      <span class="k">End If</span>
<a name="ln-2649"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2650"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2651"></a>      <span class="k">END IF</span>
<a name="ln-2652"></a>      <span class="c">! Ensure the flow rate at lower speed has to be less or equal to the flow rate at higher speed</span>
<a name="ln-2653"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">i</span> <span class="o">/=</span> <span class="n">NumOfSpeedCooling</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2654"></a><span class="k">        If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-2655"></a><span class="k">          </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2656"></a>        <span class="k">End If</span>
<a name="ln-2657"></a><span class="k">      End If</span>
<a name="ln-2658"></a><span class="k">      CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2659"></a>            <span class="s1">&#39;Speed &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; Supply Air Flow Rate During Cooling Operation [m3/s]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2660"></a>               <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-2661"></a>    <span class="k">END IF</span>
<a name="ln-2662"></a><span class="k">  END IF</span>
<a name="ln-2663"></a>
<a name="ln-2664"></a><span class="k">End Do</span>
<a name="ln-2665"></a>
<a name="ln-2666"></a><span class="k">Do </span><span class="n">I</span><span class="o">=</span><span class="n">NumOfSpeedHeating</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2667"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2668"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2669"></a><span class="k">      If</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">NumOfSpeedHeating</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2670"></a><span class="k">        CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2671"></a>        <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>   <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2672"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2673"></a>          <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2674"></a><span class="k">          </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span>
<a name="ln-2675"></a>          <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-2676"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The supply air flow rate at high speed is less than the &#39;</span> <span class="p">&amp;</span>
<a name="ln-2677"></a>              <span class="o">//</span><span class="s1">&#39;autosized value for the maximum air flow rate in heating mode. Consider autosizing the fan for&#39;</span> <span class="p">&amp;</span>
<a name="ln-2678"></a>              <span class="o">//</span><span class="s1">&#39; this simulation.&#39;</span><span class="p">)</span>
<a name="ln-2679"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The maximum air flow rate at high speed in heating mode &#39;</span> <span class="p">&amp;</span>
<a name="ln-2680"></a>                             <span class="o">//</span><span class="s1">&#39;is reset to the supply air flow rate and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2681"></a>        <span class="k">END IF</span>
<a name="ln-2682"></a><span class="k">      Else</span>
<a name="ln-2683"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2684"></a>                                                          <span class="n">i</span><span class="o">/</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-2685"></a>      <span class="k">End If</span>
<a name="ln-2686"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2687"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2688"></a>      <span class="k">END IF</span>
<a name="ln-2689"></a>      <span class="c">! Ensure the flow rate at lower speed has to be less or equal to the flow rate at higher speed</span>
<a name="ln-2690"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">i</span> <span class="o">/=</span> <span class="n">NumOfSpeedHeating</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2691"></a><span class="k">        If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-2692"></a><span class="k">          </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2693"></a>        <span class="k">End If</span>
<a name="ln-2694"></a><span class="k">      End If</span>
<a name="ln-2695"></a><span class="k">      CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2696"></a>           <span class="s1">&#39;Speed&#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;Supply Air Flow Rate During Heating Operation [m3/s]&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2697"></a>              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-2698"></a>    <span class="k">END IF</span>
<a name="ln-2699"></a><span class="k">  END IF</span>
<a name="ln-2700"></a><span class="k">End Do</span>
<a name="ln-2701"></a>
<a name="ln-2702"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2703"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2704"></a><span class="k">      CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2705"></a>      <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2706"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2707"></a>         <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2708"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanVolFlow</span>
<a name="ln-2709"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-2710"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The supply air flow rate is less than the autosized value&#39;</span> <span class="p">&amp;</span>
<a name="ln-2711"></a>                             <span class="o">//</span><span class="s1">&#39; for the maximum air flow rate when no heating or cooling is needed. Consider&#39;</span> <span class="p">&amp;</span>
<a name="ln-2712"></a>                             <span class="o">//</span><span class="s1">&#39; autosizing the fan for this simulation.&#39;</span><span class="p">)</span>
<a name="ln-2713"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The maximum air flow rate when no heating or cooling is needed &#39;</span> <span class="p">&amp;</span>
<a name="ln-2714"></a>                             <span class="o">//</span><span class="s1">&#39;is reset to the supply air flow rate and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2715"></a>      <span class="k">END IF</span>
<a name="ln-2716"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2717"></a><span class="k">        </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2718"></a>      <span class="k">END IF</span>
<a name="ln-2719"></a>
<a name="ln-2720"></a><span class="k">      CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2721"></a>                    <span class="s1">&#39;Supply Air Flow Rate When No Cooling or Heating is Needed [m3/s]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2722"></a>                     <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span><span class="p">)</span>
<a name="ln-2723"></a>    <span class="k">END IF</span>
<a name="ln-2724"></a><span class="k">  END IF</span>
<a name="ln-2725"></a>
<a name="ln-2726"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppMaxAirTemp</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2727"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2728"></a><span class="k">      If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span> <span class="c">! Gas</span>
<a name="ln-2729"></a>        <span class="k">CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Gas&#39;</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2730"></a>      <span class="k">Else</span>
<a name="ln-2731"></a><span class="k">        CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Electric&#39;</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2732"></a>      <span class="k">End If</span>
<a name="ln-2733"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppMaxAirTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatSupTemp</span>
<a name="ln-2734"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2735"></a>                              <span class="s1">&#39;Maximum Supply Air Temperature from Supplemental Heater [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2736"></a>                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppMaxAirTemp</span><span class="p">)</span>
<a name="ln-2737"></a>    <span class="k">END IF</span>
<a name="ln-2738"></a><span class="k">  END IF</span>
<a name="ln-2739"></a>
<a name="ln-2740"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2741"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2742"></a><span class="k">      If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span> <span class="c">! Gas</span>
<a name="ln-2743"></a>        <span class="k">CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Gas&#39;</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2744"></a>      <span class="k">Else</span>
<a name="ln-2745"></a><span class="k">        CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Electric&#39;</span><span class="p">,</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2746"></a>      <span class="k">End If</span>
<a name="ln-2747"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatCap</span>
<a name="ln-2748"></a>    <span class="k">ELSE</span>
<a name="ln-2749"></a><span class="k">      </span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2750"></a>    <span class="k">END IF</span>
<a name="ln-2751"></a><span class="k">    CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2752"></a>                              <span class="s1">&#39;Supplemental Heating Coil Nominal Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2753"></a>                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span><span class="p">)</span>
<a name="ln-2754"></a>  <span class="k">END IF</span>
<a name="ln-2755"></a><span class="k">  </span><span class="n">SuppHeatCap</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span>
<a name="ln-2756"></a>
<a name="ln-2757"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2758"></a><span class="k">    CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2759"></a>                              <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DesignHeatRecFlowRate</span> <span class="p">)</span>
<a name="ln-2760"></a>  <span class="n">ENDIF</span>
<a name="ln-2761"></a>
<a name="ln-2762"></a><span class="k">RETURN</span>
<a name="ln-2763"></a><span class="k">END SUBROUTINE </span><span class="n">SizeMSHeatPump</span>
<a name="ln-2764"></a>
<a name="ln-2765"></a><span class="c">!******************************************************************************</span>
<a name="ln-2766"></a>
<a name="ln-2767"></a><span class="k">SUBROUTINE </span><span class="n">ControlMSHPOutput</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span><span class="n">ZoneNum</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2768"></a>                             <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-2769"></a>
<a name="ln-2770"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2771"></a>          <span class="c">!       AUTHOR         Lixing Gu</span>
<a name="ln-2772"></a>          <span class="c">!       DATE WRITTEN   June 2007</span>
<a name="ln-2773"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2774"></a>          <span class="c">!       RE-ENGINEERED  Revised for multispeed heat pump use based on ControlPTHPOutput</span>
<a name="ln-2775"></a>
<a name="ln-2776"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2777"></a>          <span class="c">! Determine the part load fraction at low speed, and speed ratio at high speed for this time step.</span>
<a name="ln-2778"></a>
<a name="ln-2779"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2780"></a>          <span class="c">! Use RegulaFalsi technique to iterate on part-load ratio until convergence is achieved.</span>
<a name="ln-2781"></a>
<a name="ln-2782"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2783"></a>          <span class="c">! na</span>
<a name="ln-2784"></a>
<a name="ln-2785"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2786"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>                   <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span> <span class="n">RoundSigDigits</span><span class="p">,</span> <span class="n">TrimSigDigits</span>
<a name="ln-2787"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">WarmUpFlag</span><span class="p">,</span><span class="n">CurrentTime</span>
<a name="ln-2788"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>              <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span>
<a name="ln-2789"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyCpAirFnWTdb</span>
<a name="ln-2790"></a>
<a name="ln-2791"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2792"></a>
<a name="ln-2793"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2794"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MSHeatPumpNum</span>      <span class="c">! Unit index of engine driven heat pump</span>
<a name="ln-2795"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! flag for 1st HVAC iteration in the time step</span>
<a name="ln-2796"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CompOp</span>             <span class="c">! compressor operation; 1=on, 0=off</span>
<a name="ln-2797"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">OpMode</span>             <span class="c">! operating mode: CycFanCycCoil | ContFanCycCoil</span>
<a name="ln-2798"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedNum</span>           <span class="c">! Speed number</span>
<a name="ln-2799"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">QZnReq</span>             <span class="c">! cooling or heating output needed by zone [W]</span>
<a name="ln-2800"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ZoneNum</span>            <span class="c">! Index to zone number</span>
<a name="ln-2801"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>         <span class="c">! unit speed ratio for DX coils</span>
<a name="ln-2802"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadFrac</span>       <span class="c">! unit part load fraction</span>
<a name="ln-2803"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! ratio of compressor ON airflow to AVERAGE airflow over timestep</span>
<a name="ln-2804"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupHeaterLoad</span>      <span class="c">! Supplemental heater load [W]</span>
<a name="ln-2805"></a>
<a name="ln-2806"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2807"></a>          <span class="c">!</span>
<a name="ln-2808"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxIte</span>   <span class="o">=</span> <span class="mi">500</span>          <span class="c">! maximum number of iterations</span>
<a name="ln-2809"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>    <span class="kd">::</span> <span class="n">MinPLF</span>   <span class="o">=</span> <span class="mf">0.0d0</span>          <span class="c">! minimum part load factor allowed</span>
<a name="ln-2810"></a>
<a name="ln-2811"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2812"></a>          <span class="c">! na</span>
<a name="ln-2813"></a>
<a name="ln-2814"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2815"></a>          <span class="c">! na</span>
<a name="ln-2816"></a>
<a name="ln-2817"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2818"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FullOutput</span>    <span class="c">! unit full output when compressor is operating [W]</span>
<a name="ln-2819"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">LowOutput</span>     <span class="c">! unit full output at low speed [W]</span>
<a name="ln-2820"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">TempOutput</span>    <span class="c">! unit output when iteration limit exceeded [W]</span>
<a name="ln-2821"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">NoCompOutput</span>  <span class="c">! output when no active compressor [W]</span>
<a name="ln-2822"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ErrorToler</span>    <span class="c">! error tolerance</span>
<a name="ln-2823"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SolFla</span>        <span class="c">! Flag of RegulaFalsi solver</span>
<a name="ln-2824"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Par</span>           <span class="c">! Parameters passed to RegulaFalsi</span>
<a name="ln-2825"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CpAir</span>         <span class="c">! air specific heat</span>
<a name="ln-2826"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">OutsideDryBulbTemp</span> <span class="c">! Outside air temperature at external node height</span>
<a name="ln-2827"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">QCoilActual</span>   <span class="c">! coil load actually delivered returned to calling component</span>
<a name="ln-2828"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">i</span>             <span class="c">! Speed index</span>
<a name="ln-2829"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">SAVE</span>       <span class="kd">::</span> <span class="n">ErrCountCyc</span><span class="o">=</span><span class="mi">0</span> <span class="c">! Counter used to minimize the occurrence of output warnings</span>
<a name="ln-2830"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">SAVE</span>       <span class="kd">::</span> <span class="n">ErrCountVar</span><span class="o">=</span><span class="mi">0</span> <span class="c">! Counter used to minimize the occurrence of output warnings</span>
<a name="ln-2831"></a>
<a name="ln-2832"></a>  <span class="c">! FLOW</span>
<a name="ln-2833"></a>  <span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2834"></a>  <span class="n">PartLoadFrac</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2835"></a>  <span class="n">SpeedRatio</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2836"></a>  <span class="n">SpeedNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2837"></a>
<a name="ln-2838"></a>  <span class="n">OutsideDryBulbTemp</span> <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-2839"></a>
<a name="ln-2840"></a><span class="c">!!!LKL Discrepancy with &lt; 0</span>
<a name="ln-2841"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AvaiSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-2842"></a>
<a name="ln-2843"></a>  <span class="c">! Get result when DX coil is off</span>
<a name="ln-2844"></a>  <span class="k">CALL </span><span class="n">CalcMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">NoCompOutput</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2845"></a>                      <span class="n">QZnReq</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-2846"></a>
<a name="ln-2847"></a>  <span class="c">! If cooling and NoCompOutput &lt; QZnReq, the coil needs to be off</span>
<a name="ln-2848"></a>  <span class="c">! If heating and NoCompOutput &gt; QZnReq, the coil needs to be off</span>
<a name="ln-2849"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">QZnReq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NoCompOutput</span> <span class="o">&lt;</span> <span class="n">QZnReq</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="o">&gt;</span> <span class="n">SmallLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NoCompOutput</span> <span class="o">&gt;</span> <span class="n">QZnReq</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2850"></a>       <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">QZnReq</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2851"></a><span class="k">    RETURN</span>
<a name="ln-2852"></a><span class="k">  END IF</span>
<a name="ln-2853"></a>
<a name="ln-2854"></a>  <span class="c">! Get full load result</span>
<a name="ln-2855"></a>  <span class="n">PartLoadFrac</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2856"></a>  <span class="n">SpeedRatio</span>    <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2857"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">HeatingMode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2858"></a><span class="k">    </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-2859"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Staged</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">StageNum</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">SpeedNum</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2860"></a><span class="k">      </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">StageNum</span><span class="p">)</span>
<a name="ln-2861"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2862"></a>    <span class="k">End If</span>
<a name="ln-2863"></a><span class="k">  End If</span>
<a name="ln-2864"></a><span class="k">  If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">CoolingMode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2865"></a><span class="k">    </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-2866"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Staged</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">StageNum</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">SpeedNum</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2867"></a><span class="k">      </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">StageNum</span><span class="p">)</span>
<a name="ln-2868"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2869"></a>    <span class="k">End If</span>
<a name="ln-2870"></a><span class="k">  End If</span>
<a name="ln-2871"></a>
<a name="ln-2872"></a><span class="k">  CALL </span><span class="n">CalcMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">FullOutput</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2873"></a>                      <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-2874"></a>
<a name="ln-2875"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2876"></a>  <span class="c">! Since we are cooling, we expect FullOutput to be &lt; 0 and FullOutput &lt; NoCompOutput</span>
<a name="ln-2877"></a>  <span class="c">! Check that this is the case; if not set PartLoadFrac = 0.0 (off) and return</span>
<a name="ln-2878"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FullOutput</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">FullOutput</span> <span class="o">&gt;=</span> <span class="n">NoCompOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2879"></a><span class="k">      </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2880"></a>      <span class="n">SpeedRatio</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2881"></a>      <span class="n">SpeedNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2882"></a>      <span class="k">RETURN</span>
<a name="ln-2883"></a><span class="k">    END IF</span>
<a name="ln-2884"></a><span class="c">!  ! If the QZnReq &lt;= FullOutput the unit needs to run full out</span>
<a name="ln-2885"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="o">&lt;=</span> <span class="n">FullOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2886"></a><span class="k">      </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2887"></a>      <span class="n">SpeedRatio</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2888"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Staged</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2889"></a>      <span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CycRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-2890"></a>      <span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-2891"></a>      <span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-2892"></a>      <span class="k">RETURN</span>
<a name="ln-2893"></a><span class="k">    END IF</span>
<a name="ln-2894"></a><span class="k">    </span><span class="n">ErrorToler</span> <span class="o">=</span> <span class="mf">0.001d0</span> <span class="c">!Error tolerance for convergence from input deck</span>
<a name="ln-2895"></a>  <span class="k">ELSE</span>
<a name="ln-2896"></a>  <span class="c">! Since we are heating, we expect FullOutput to be &gt; 0 and FullOutput &gt; NoCompOutput</span>
<a name="ln-2897"></a>  <span class="c">! Check that this is the case; if not set PartLoadFrac = 0.0 (off)</span>
<a name="ln-2898"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FullOutput</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">FullOutput</span> <span class="o">&lt;=</span> <span class="n">NoCompOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2899"></a><span class="k">      </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2900"></a>      <span class="n">SpeedRatio</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2901"></a>  <span class="c">! may need supplemental heating so don&#39;t return in heating mode</span>
<a name="ln-2902"></a>    <span class="k">END IF</span>
<a name="ln-2903"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">QZnReq</span>  <span class="o">&gt;=</span>  <span class="n">FullOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2904"></a><span class="k">      </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2905"></a>      <span class="n">SpeedRatio</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2906"></a>  <span class="c">! may need supplemental heating so don&#39;t return in heating mode</span>
<a name="ln-2907"></a>    <span class="k">END IF</span>
<a name="ln-2908"></a><span class="k">    </span><span class="n">ErrorToler</span> <span class="o">=</span> <span class="mf">0.001d0</span> <span class="c">!Error tolerance for convergence from input deck</span>
<a name="ln-2909"></a>  <span class="k">END IF</span>
<a name="ln-2910"></a>
<a name="ln-2911"></a>  <span class="c">! Calculate the part load fraction</span>
<a name="ln-2912"></a>  <span class="k">IF</span> <span class="p">(((</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="o">&lt;</span> <span class="n">FullOutput</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="o">&gt;</span> <span class="n">FullOutput</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-2913"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Staged</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2914"></a>
<a name="ln-2915"></a><span class="k">    </span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSHeatPumpNum</span>
<a name="ln-2916"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneNum</span>
<a name="ln-2917"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2918"></a><span class="k">      </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2919"></a>    <span class="k">ELSE</span>
<a name="ln-2920"></a><span class="k">      </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2921"></a>    <span class="k">END IF</span>
<a name="ln-2922"></a><span class="k">    </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">OpMode</span>
<a name="ln-2923"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">QZnReq</span>
<a name="ln-2924"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-2925"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">SupHeaterLoad</span>
<a name="ln-2926"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="n">CompOp</span>
<a name="ln-2927"></a>    <span class="c">! Check whether the low speed coil can meet the load or not</span>
<a name="ln-2928"></a>    <span class="k">CALL </span><span class="n">CalcMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">LowOutput</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2929"></a>                        <span class="n">QZnReq</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-2930"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="o">&lt;=</span> <span class="n">LowOutput</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="o">&gt;=</span> <span class="n">LowOutput</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2931"></a><span class="k">      </span><span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2932"></a>      <span class="n">SpeedNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2933"></a>      <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">ErrorToler</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">MSHPCyclingResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-2934"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2935"></a><span class="k">        If</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2936"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ErrCountCyc</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2937"></a><span class="k">            </span><span class="n">ErrCountCyc</span> <span class="o">=</span> <span class="n">ErrCountCyc</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2938"></a>            <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded calculating DX unit cycling ratio, for unit=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2939"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2940"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Cycling ratio returned=&#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-2941"></a>          <span class="k">Else</span>
<a name="ln-2942"></a><span class="k">            </span><span class="n">ErrCountCyc</span> <span class="o">=</span> <span class="n">ErrCountCyc</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2943"></a>            <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2944"></a>          <span class="s1">&#39; Iteration limit warning exceeding calculating DX unit cycling ratio  continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-2945"></a>          <span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ErrIndexCyc</span> <span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-2946"></a>          <span class="k">End If</span>
<a name="ln-2947"></a><span class="k">        End If</span>
<a name="ln-2948"></a><span class="k">      ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2949"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;DX unit cycling ratio calculation failed: cycling limits exceeded, for unit=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2950"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">))</span>
<a name="ln-2951"></a>      <span class="k">END IF</span>
<a name="ln-2952"></a><span class="k">    Else</span>
<a name="ln-2953"></a>      <span class="c">! Check to see which speed to meet the load</span>
<a name="ln-2954"></a>      <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2955"></a>      <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2956"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">))</span> <span class="k">Then</span> <span class="c">! Cooling</span>
<a name="ln-2957"></a>        <span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-2958"></a>          <span class="k">CALL </span><span class="n">CalcMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">TempOutput</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2959"></a>                              <span class="n">QZnReq</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-2960"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="o">&gt;=</span> <span class="n">TempOutput</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2961"></a><span class="k">            </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="n">I</span>
<a name="ln-2962"></a>            <span class="k">Exit</span>
<a name="ln-2963"></a><span class="k">          End If</span>
<a name="ln-2964"></a><span class="k">        END DO</span>
<a name="ln-2965"></a><span class="k">      ELSE</span>
<a name="ln-2966"></a><span class="k">        DO </span><span class="n">I</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-2967"></a>          <span class="k">CALL </span><span class="n">CalcMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">TempOutput</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2968"></a>               <span class="n">QZnReq</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-2969"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="o">&lt;=</span> <span class="n">TempOutput</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2970"></a><span class="k">            </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="n">I</span>
<a name="ln-2971"></a>            <span class="k">Exit</span>
<a name="ln-2972"></a><span class="k">          End If</span>
<a name="ln-2973"></a><span class="k">        END DO</span>
<a name="ln-2974"></a><span class="k">      END IF</span>
<a name="ln-2975"></a><span class="k">      </span><span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-2976"></a>      <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">ErrorToler</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">MSHPVarSpeedResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-2977"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2978"></a><span class="k">        If</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2979"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ErrCountVar</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2980"></a><span class="k">            </span><span class="n">ErrCountVar</span> <span class="o">=</span> <span class="n">ErrCountVar</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2981"></a>            <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded calculating DX unit speed ratio, for unit=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2982"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2983"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Speed ratio returned=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;], Speed number =&#39;</span> <span class="p">&amp;</span>
<a name="ln-2984"></a>                                        <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-2985"></a>          <span class="k">Else</span>
<a name="ln-2986"></a><span class="k">            </span><span class="n">ErrCountVar</span> <span class="o">=</span> <span class="n">ErrCountVar</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2987"></a>            <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2988"></a>          <span class="s1">&#39; Iteration limit warning exceeding calculating DX unit speed ratio continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-2989"></a>          <span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ErrIndexVar</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">)</span>
<a name="ln-2990"></a>          <span class="k">End If</span>
<a name="ln-2991"></a><span class="k">        End If</span>
<a name="ln-2992"></a><span class="k">      ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2993"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;DX unit compressor speed calculation failed: speed limits exceeded, for unit=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2994"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">))</span>
<a name="ln-2995"></a>      <span class="k">END IF</span>
<a name="ln-2996"></a><span class="k">    End If</span>
<a name="ln-2997"></a><span class="k">  Else</span>
<a name="ln-2998"></a>    <span class="c">! Staged thermostat performance</span>
<a name="ln-2999"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">StageNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3000"></a><span class="k">      </span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">MSHeatPumpNum</span>
<a name="ln-3001"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneNum</span>
<a name="ln-3002"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3003"></a><span class="k">        </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3004"></a>      <span class="k">ELSE</span>
<a name="ln-3005"></a><span class="k">        </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3006"></a>      <span class="k">END IF</span>
<a name="ln-3007"></a><span class="k">      </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">OpMode</span>
<a name="ln-3008"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">QZnReq</span>
<a name="ln-3009"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-3010"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">SupHeaterLoad</span>
<a name="ln-3011"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="n">CompOp</span>
<a name="ln-3012"></a>      <span class="n">SpeedNum</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">StageNum</span><span class="p">)</span>
<a name="ln-3013"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-3014"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3015"></a><span class="k">        CALL </span><span class="n">CalcMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">LowOutput</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3016"></a>                      <span class="n">QZnReq</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-3017"></a>        <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3018"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="o">&lt;=</span> <span class="n">LowOutput</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="o">&gt;=</span> <span class="n">LowOutput</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3019"></a><span class="k">          CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">ErrorToler</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">MSHPCyclingResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-3020"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3021"></a><span class="k">            If</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3022"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">ErrCountCyc</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3023"></a><span class="k">                </span><span class="n">ErrCountCyc</span> <span class="o">=</span> <span class="n">ErrCountCyc</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3024"></a>                <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded calculating DX unit cycling ratio, for unit=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3025"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3026"></a>                <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Cycling ratio returned=&#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-3027"></a>              <span class="k">Else</span>
<a name="ln-3028"></a><span class="k">                </span><span class="n">ErrCountCyc</span> <span class="o">=</span> <span class="n">ErrCountCyc</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3029"></a>                <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3030"></a>                <span class="s1">&#39; Iteration limit warning exceeding calculating DX unit cycling ratio  continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-3031"></a>                <span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ErrIndexCyc</span> <span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-3032"></a>              <span class="k">End If</span>
<a name="ln-3033"></a><span class="k">            End If</span>
<a name="ln-3034"></a><span class="k">          ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3035"></a><span class="k">            CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;DX unit cycling ratio calculation failed: cycling limits exceeded, for unit=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3036"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">))</span>
<a name="ln-3037"></a>          <span class="k">END IF</span>
<a name="ln-3038"></a><span class="k">        Else</span>
<a name="ln-3039"></a><span class="k">          </span><span class="n">FullOutput</span> <span class="o">=</span> <span class="n">LowOutput</span>
<a name="ln-3040"></a>          <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3041"></a>        <span class="k">End If</span>
<a name="ln-3042"></a><span class="k">      Else</span>
<a name="ln-3043"></a><span class="k">        If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">StageNum</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3044"></a><span class="k">          </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">,</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">StageNum</span><span class="p">))</span>
<a name="ln-3045"></a>        <span class="k">Else</span>
<a name="ln-3046"></a><span class="k">          </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">,</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">StageNum</span><span class="p">))</span>
<a name="ln-3047"></a>        <span class="k">End If</span>
<a name="ln-3048"></a><span class="k">        CALL </span><span class="n">CalcMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">LowOutput</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3049"></a>                      <span class="n">QZnReq</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-3050"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="o">&gt;=</span> <span class="n">LowOutput</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="o">&lt;=</span> <span class="n">LowOutput</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3051"></a><span class="k">          CALL </span><span class="n">CalcMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">FullOutput</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3052"></a>                      <span class="n">QZnReq</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-3053"></a>          <span class="k">IF</span> <span class="p">((</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="o">&lt;=</span> <span class="n">FullOutput</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="o">&gt;=</span> <span class="n">FullOutput</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3054"></a><span class="k">            </span><span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-3055"></a>            <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">ErrorToler</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">MSHPVarSpeedResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-3056"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3057"></a><span class="k">              If</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3058"></a><span class="k">                IF</span> <span class="p">(</span><span class="n">ErrCountVar</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3059"></a><span class="k">                  </span><span class="n">ErrCountVar</span> <span class="o">=</span> <span class="n">ErrCountVar</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3060"></a>                  <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded calculating DX unit speed ratio, for unit=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3061"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3062"></a>                  <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Speed ratio returned=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3063"></a>                     <span class="s1">&#39;], Speed number =&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-3064"></a>                <span class="k">Else</span>
<a name="ln-3065"></a><span class="k">                  </span><span class="n">ErrCountVar</span> <span class="o">=</span> <span class="n">ErrCountVar</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3066"></a>                  <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3067"></a>                  <span class="s1">&#39; Iteration limit warning exceeding calculating DX unit speed ratio continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-3068"></a>                  <span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ErrIndexVar</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">)</span>
<a name="ln-3069"></a>                <span class="k">End If</span>
<a name="ln-3070"></a><span class="k">              End If</span>
<a name="ln-3071"></a><span class="k">            ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3072"></a><span class="k">              CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;DX unit compressor speed calculation failed: speed limits exceeded, for unit=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3073"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">))</span>
<a name="ln-3074"></a>            <span class="k">END IF</span>
<a name="ln-3075"></a><span class="k">          Else</span>
<a name="ln-3076"></a><span class="k">            </span><span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3077"></a>          <span class="k">End If</span>
<a name="ln-3078"></a><span class="k">        Else</span> <span class="c">! lowOutput provides a larger capacity than needed</span>
<a name="ln-3079"></a>          <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3080"></a>        <span class="k">End If</span>
<a name="ln-3081"></a><span class="k">      End If</span>
<a name="ln-3082"></a><span class="k">    End If</span>
<a name="ln-3083"></a><span class="k">  End If</span>
<a name="ln-3084"></a>
<a name="ln-3085"></a>  <span class="c">! if the DX heating coil cannot meet the load, trim with supplemental heater</span>
<a name="ln-3086"></a>  <span class="c">! occurs with constant fan mode when compressor is on or off</span>
<a name="ln-3087"></a>  <span class="c">! occurs with cycling fan mode when compressor PLR is equal to 1</span>
<a name="ln-3088"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">FullOutput</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-3089"></a><span class="k">    </span><span class="n">PartLoadFrac</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3090"></a>    <span class="n">SpeedRatio</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3091"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Staged</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3092"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">OutsideDryBulbTemp</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppMaxAirTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3093"></a><span class="k">      </span><span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="n">QZnReq</span> <span class="o">-</span> <span class="n">FullOutput</span>
<a name="ln-3094"></a>    <span class="k">ELSE</span>
<a name="ln-3095"></a><span class="k">      </span><span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3096"></a>    <span class="k">END IF</span>
<a name="ln-3097"></a><span class="k">    CALL </span><span class="n">CalcMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">TempOutput</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3098"></a>                        <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-3099"></a>  <span class="k">END IF</span>
<a name="ln-3100"></a>
<a name="ln-3101"></a><span class="c">! check the outlet of the supplemental heater to be lower than the maximum supplemental heater supply air temperature</span>
<a name="ln-3102"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppMaxAirTemp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3103"></a>                                                             <span class="n">SupHeaterLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3104"></a>
<a name="ln-3105"></a><span class="c">!   If the supply air temperature is to high, turn off the supplemental heater to recalculate the outlet temperature</span>
<a name="ln-3106"></a>    <span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3107"></a>    <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">SupHeaterLoad</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="n">QCoilActual</span><span class="p">)</span>
<a name="ln-3108"></a>
<a name="ln-3109"></a><span class="c">!   If the outlet temperature is below the maximum supplemental heater supply air temperature, reduce the load passed to</span>
<a name="ln-3110"></a><span class="c">!   the supplemental heater, otherwise leave the supplemental heater off. If the supplemental heater is to be turned on,</span>
<a name="ln-3111"></a><span class="c">!   use the outlet conditions when the supplemental heater was off (CALL above) as the inlet conditions for the calculation</span>
<a name="ln-3112"></a><span class="c">!   of supplemental heater load to just meet the maximum supply air temperature from the supplemental heater.</span>
<a name="ln-3113"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppMaxAirTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3114"></a><span class="k">      </span><span class="n">CpAir</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3115"></a>                             <span class="n">Node</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-3116"></a>      <span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">CpAir</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3117"></a>                      <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppMaxAirTemp</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-3118"></a>
<a name="ln-3119"></a>    <span class="k">ELSE</span>
<a name="ln-3120"></a><span class="k">      </span><span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3121"></a>    <span class="k">END IF</span>
<a name="ln-3122"></a><span class="k">  END IF</span>
<a name="ln-3123"></a>
<a name="ln-3124"></a><span class="k">  </span><span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CycRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-3125"></a>  <span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-3126"></a>  <span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-3127"></a>
<a name="ln-3128"></a>  <span class="k">RETURN</span>
<a name="ln-3129"></a><span class="k">END SUBROUTINE </span><span class="n">ControlMSHPOutput</span>
<a name="ln-3130"></a>
<a name="ln-3131"></a><span class="c">!******************************************************************************</span>
<a name="ln-3132"></a>
<a name="ln-3133"></a><span class="k">SUBROUTINE </span><span class="n">CalcMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">LoadMet</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3134"></a>                          <span class="n">QZnReq</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-3135"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3136"></a>            <span class="c">!       AUTHOR:          Lixing Gu, FSEC</span>
<a name="ln-3137"></a>            <span class="c">!       DATE WRITTEN:    June 2007</span>
<a name="ln-3138"></a>            <span class="c">!       MODIFIED         na</span>
<a name="ln-3139"></a>            <span class="c">!       RE-ENGINEERED    na</span>
<a name="ln-3140"></a>
<a name="ln-3141"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3142"></a>            <span class="c">!  This routine will calcultes MSHP performance based on given system load</span>
<a name="ln-3143"></a>
<a name="ln-3144"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3145"></a>            <span class="c">! na</span>
<a name="ln-3146"></a>
<a name="ln-3147"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-3148"></a>
<a name="ln-3149"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-3150"></a><span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>                    <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateFanComponents</span>
<a name="ln-3151"></a><span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-3152"></a><span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span>
<a name="ln-3153"></a><span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>                 <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimDXCoilMultiSpeed</span><span class="p">,</span><span class="n">DXCoilPartLoadRatio</span>
<a name="ln-3154"></a>
<a name="ln-3155"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3156"></a>
<a name="ln-3157"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3158"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MSHeatPumpNum</span>        <span class="c">! Engine driven heat pump number</span>
<a name="ln-3159"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>   <span class="c">! Flag for 1st HVAC iteration</span>
<a name="ln-3160"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SpeedNum</span>             <span class="c">! Speed number</span>
<a name="ln-3161"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SpeedRatio</span>           <span class="c">! Compressor speed ratio</span>
<a name="ln-3162"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PartLoadFrac</span>         <span class="c">! Compressor part load fraction</span>
<a name="ln-3163"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">LoadMet</span>              <span class="c">! Load met by unit (W)</span>
<a name="ln-3164"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QZnReq</span>               <span class="c">! Zone load (W)</span>
<a name="ln-3165"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>    <span class="c">! Ratio of compressor ON airflow to AVERAGE airflow over timestep</span>
<a name="ln-3166"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupHeaterLoad</span>        <span class="c">! supplemental heater load (W)</span>
<a name="ln-3167"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">CompOp</span>               <span class="c">! Compressor on/off; 1=on, 0=off</span>
<a name="ln-3168"></a>
<a name="ln-3169"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3170"></a><span class="c">!  INTEGER, PARAMETER  ::   On  = 1           ! Compressor on flag</span>
<a name="ln-3171"></a><span class="c">!  INTEGER, PARAMETER  ::   Off = 2           ! Compressor off flag</span>
<a name="ln-3172"></a>
<a name="ln-3173"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3174"></a>          <span class="c">! na</span>
<a name="ln-3175"></a>
<a name="ln-3176"></a>          <span class="c">! DERIVMS TYPE DEFINITIONS</span>
<a name="ln-3177"></a>          <span class="c">! na</span>
<a name="ln-3178"></a>
<a name="ln-3179"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3180"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OutletNode</span>        <span class="c">! MSHP air outlet node</span>
<a name="ln-3181"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">InletNode</span>         <span class="c">! MSHP air inlet node</span>
<a name="ln-3182"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MinHumRat</span>         <span class="c">! Minimum humidity ratio for sensible capacity calculation (kg/kg)</span>
<a name="ln-3183"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutsideDryBulbTemp</span> <span class="c">! Outdoor dry bulb temperature [C]</span>
<a name="ln-3184"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirMassFlow</span>       <span class="c">! Air mass flow rate [kg/s]</span>
<a name="ln-3185"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FanInletNode</span>      <span class="c">! MSHP air outlet node</span>
<a name="ln-3186"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FanOutletNode</span>     <span class="c">! MSHP air inlet node</span>
<a name="ln-3187"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SavePartloadRatio</span> <span class="c">!</span>
<a name="ln-3188"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SaveSpeedRatio</span>
<a name="ln-3189"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QCoilActual</span>   <span class="c">! coil load actually delivered returned to calling component</span>
<a name="ln-3190"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MdotSupp</span>      <span class="c">! suppleental coil hot water or steam flow rate</span>
<a name="ln-3191"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MinWaterFlow</span>  <span class="c">! minimum water flow rate</span>
<a name="ln-3192"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ErrorToler</span>    <span class="c">! supplemental heating coil convergence tollerance</span>
<a name="ln-3193"></a>
<a name="ln-3194"></a>  <span class="c">! FLOW</span>
<a name="ln-3195"></a>  <span class="n">OutletNode</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>
<a name="ln-3196"></a>  <span class="n">InletNode</span>  <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-3197"></a>  <span class="n">OutsideDryBulbTemp</span> <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-3198"></a>  <span class="n">FanOutletNode</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanOutletNode</span>
<a name="ln-3199"></a>  <span class="n">FanInletNode</span>  <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanInletNode</span>
<a name="ln-3200"></a>
<a name="ln-3201"></a>  <span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3202"></a>  <span class="n">SavePartloadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3203"></a>  <span class="n">MinWaterFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3204"></a>  <span class="n">ErrorToler</span> <span class="o">=</span> <span class="mf">0.001d0</span>
<a name="ln-3205"></a>  <span class="c">! Set inlet air mass flow rate based on PLR and compressor on/off air flow rates</span>
<a name="ln-3206"></a>  <span class="k">CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">SpeedNum</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">)</span>
<a name="ln-3207"></a>
<a name="ln-3208"></a>  <span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-3209"></a>  <span class="c">! if blow through, simulate fan then coils</span>
<a name="ln-3210"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanPlaceType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3211"></a><span class="k">    CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-3212"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3213"></a><span class="k">      IF</span><span class="p">(</span><span class="n">OutsideDryBulbTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3214"></a><span class="k">        CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,&amp;</span>
<a name="ln-3215"></a>                                 <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3216"></a>        <span class="n">SavePartloadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-3217"></a>        <span class="n">SaveSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-3218"></a>      <span class="k">ELSE</span>
<a name="ln-3219"></a><span class="k">        CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,&amp;</span>
<a name="ln-3220"></a>                                 <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3221"></a>      <span class="k">END IF</span>
<a name="ln-3222"></a><span class="k">      </span><span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="n">DXCoilPartLoadRatio</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilIndex</span><span class="p">)</span>
<a name="ln-3223"></a>    <span class="k">ELSE</span>
<a name="ln-3224"></a><span class="k">      CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,&amp;</span>
<a name="ln-3225"></a>                               <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3226"></a>    <span class="k">END IF</span>
<a name="ln-3227"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">MultiSpeedHeatingCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3228"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3229"></a><span class="k">        IF</span><span class="p">(</span><span class="n">OutsideDryBulbTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3230"></a><span class="k">          CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilName</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,&amp;</span>
<a name="ln-3231"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3232"></a>          <span class="n">SavePartloadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-3233"></a>          <span class="n">SaveSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-3234"></a>        <span class="k">ELSE</span>
<a name="ln-3235"></a><span class="k">          CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,&amp;</span>
<a name="ln-3236"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3237"></a>        <span class="k">END IF</span>
<a name="ln-3238"></a><span class="k">        </span><span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="n">DXCoilPartLoadRatio</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilIndex</span><span class="p">)</span>
<a name="ln-3239"></a>      <span class="k">ELSE</span>
<a name="ln-3240"></a><span class="k">        CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,&amp;</span>
<a name="ln-3241"></a>                                 <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3242"></a>      <span class="n">ENDIF</span>
<a name="ln-3243"></a>    <span class="n">ELSEIF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingElectric_MultiStage</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3244"></a>           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingGas_MultiStage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3245"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3246"></a><span class="k">        CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3247"></a>                                           <span class="n">CompIndex</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3248"></a>                                           <span class="n">FanOpMode</span>     <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-3249"></a>                                           <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3250"></a>                                           <span class="n">StageNum</span>      <span class="o">=</span> <span class="n">SpeedNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-3251"></a>                                           <span class="n">SpeedRatio</span>    <span class="o">=</span> <span class="n">SpeedRatio</span><span class="p">)</span>
<a name="ln-3252"></a>      <span class="k">ELSE</span>
<a name="ln-3253"></a><span class="k">        CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3254"></a>                                           <span class="n">CompIndex</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3255"></a>                                           <span class="n">FanOpMode</span>     <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-3256"></a>                                           <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-3257"></a>                                           <span class="n">StageNum</span>      <span class="o">=</span> <span class="n">SpeedNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-3258"></a>                                           <span class="n">SpeedRatio</span>    <span class="o">=</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-3259"></a>      <span class="n">ENDIF</span>
<a name="ln-3260"></a>    <span class="k">ELSE</span>
<a name="ln-3261"></a><span class="k">      CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QCoilActual</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-3262"></a>    <span class="k">END IF</span>
<a name="ln-3263"></a>    <span class="c">! Call twice to ensure the fan outlet conditions are updated</span>
<a name="ln-3264"></a>    <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-3265"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3266"></a><span class="k">      IF</span><span class="p">(</span><span class="n">OutsideDryBulbTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3267"></a><span class="k">        CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,&amp;</span>
<a name="ln-3268"></a>                                 <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3269"></a>        <span class="n">SavePartloadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-3270"></a>        <span class="n">SaveSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-3271"></a>      <span class="k">ELSE</span>
<a name="ln-3272"></a><span class="k">        CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,&amp;</span>
<a name="ln-3273"></a>                                 <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3274"></a>      <span class="k">END IF</span>
<a name="ln-3275"></a><span class="k">      </span><span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="n">DXCoilPartLoadRatio</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilIndex</span><span class="p">)</span>
<a name="ln-3276"></a>    <span class="k">ELSE</span>
<a name="ln-3277"></a><span class="k">      CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,&amp;</span>
<a name="ln-3278"></a>                               <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3279"></a>    <span class="k">END IF</span>
<a name="ln-3280"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">MultiSpeedHeatingCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3281"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3282"></a><span class="k">        IF</span><span class="p">(</span><span class="n">OutsideDryBulbTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3283"></a><span class="k">          CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilName</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,&amp;</span>
<a name="ln-3284"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3285"></a>          <span class="n">SavePartloadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-3286"></a>          <span class="n">SaveSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-3287"></a>        <span class="k">ELSE</span>
<a name="ln-3288"></a><span class="k">          CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,&amp;</span>
<a name="ln-3289"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3290"></a>        <span class="k">END IF</span>
<a name="ln-3291"></a><span class="k">        </span><span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="n">DXCoilPartLoadRatio</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilIndex</span><span class="p">)</span>
<a name="ln-3292"></a>      <span class="k">ELSE</span>
<a name="ln-3293"></a><span class="k">        CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,&amp;</span>
<a name="ln-3294"></a>                                 <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3295"></a>      <span class="k">END IF</span>
<a name="ln-3296"></a><span class="k">    </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingElectric_MultiStage</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3297"></a>           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingGas_MultiStage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3298"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3299"></a><span class="k">        CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3300"></a>                                           <span class="n">CompIndex</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3301"></a>                                           <span class="n">FanOpMode</span>     <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-3302"></a>                                           <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3303"></a>                                           <span class="n">StageNum</span>      <span class="o">=</span> <span class="n">SpeedNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-3304"></a>                                           <span class="n">SpeedRatio</span>    <span class="o">=</span> <span class="n">SpeedRatio</span><span class="p">)</span>
<a name="ln-3305"></a>      <span class="k">ELSE</span>
<a name="ln-3306"></a><span class="k">        CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3307"></a>                                           <span class="n">CompIndex</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3308"></a>                                           <span class="n">FanOpMode</span>     <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-3309"></a>                                           <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-3310"></a>                                           <span class="n">StageNum</span>      <span class="o">=</span> <span class="n">SpeedNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-3311"></a>                                           <span class="n">SpeedRatio</span>    <span class="o">=</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-3312"></a>      <span class="n">ENDIF</span>
<a name="ln-3313"></a>    <span class="k">ELSE</span>
<a name="ln-3314"></a><span class="k">      CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QCoilActual</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-3315"></a>    <span class="k">END IF</span>
<a name="ln-3316"></a>    <span class="c">!  Simulate supplemental heating coil for blow through fan</span>
<a name="ln-3317"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3318"></a><span class="k">      CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QCoilActual</span><span class="p">)</span>
<a name="ln-3319"></a>    <span class="n">ENDIF</span>
<a name="ln-3320"></a>  <span class="k">ELSE</span> <span class="c">! otherwise simulate DX coils then fan then supplemental heater</span>
<a name="ln-3321"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-3322"></a><span class="k">      IF</span><span class="p">(</span><span class="n">OutsideDryBulbTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3323"></a><span class="k">        CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,&amp;</span>
<a name="ln-3324"></a>                                 <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3325"></a>        <span class="n">SavePartloadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-3326"></a>        <span class="n">SaveSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-3327"></a>      <span class="k">ELSE</span>
<a name="ln-3328"></a><span class="k">        CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,&amp;</span>
<a name="ln-3329"></a>                                 <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3330"></a>      <span class="k">END IF</span>
<a name="ln-3331"></a><span class="k">      </span><span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="n">DXCoilPartLoadRatio</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilIndex</span><span class="p">)</span>
<a name="ln-3332"></a>    <span class="k">ELSE</span>
<a name="ln-3333"></a><span class="k">      CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,&amp;</span>
<a name="ln-3334"></a>                               <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXCoolCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3335"></a>    <span class="k">END IF</span>
<a name="ln-3336"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">MultiSpeedHeatingCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3337"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3338"></a><span class="k">        IF</span><span class="p">(</span><span class="n">OutsideDryBulbTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3339"></a><span class="k">          CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilName</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,&amp;</span>
<a name="ln-3340"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3341"></a>          <span class="n">SavePartloadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-3342"></a>          <span class="n">SaveSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-3343"></a>        <span class="k">ELSE</span>
<a name="ln-3344"></a><span class="k">          CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,&amp;</span>
<a name="ln-3345"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3346"></a>        <span class="k">END IF</span>
<a name="ln-3347"></a><span class="k">        </span><span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="n">DXCoilPartLoadRatio</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilIndex</span><span class="p">)</span>
<a name="ln-3348"></a>      <span class="k">ELSE</span>
<a name="ln-3349"></a><span class="k">        CALL </span><span class="n">SimDXCoilMultiSpeed</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilName</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,&amp;</span>
<a name="ln-3350"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">DXHeatCoilIndex</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">)</span>
<a name="ln-3351"></a>      <span class="k">END IF</span>
<a name="ln-3352"></a><span class="k">    </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingElectric_MultiStage</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3353"></a>           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingGas_MultiStage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3354"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3355"></a><span class="k">        CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3356"></a>                                           <span class="n">CompIndex</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3357"></a>                                           <span class="n">FanOpMode</span>     <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-3358"></a>                                           <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3359"></a>                                           <span class="n">StageNum</span>      <span class="o">=</span> <span class="n">SpeedNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-3360"></a>                                           <span class="n">SpeedRatio</span>    <span class="o">=</span> <span class="n">SpeedRatio</span><span class="p">)</span>
<a name="ln-3361"></a>      <span class="k">ELSE</span>
<a name="ln-3362"></a><span class="k">        CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3363"></a>                                           <span class="n">CompIndex</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3364"></a>                                           <span class="n">FanOpMode</span>     <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-3365"></a>                                           <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-3366"></a>                                           <span class="n">StageNum</span>      <span class="o">=</span> <span class="n">SpeedNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-3367"></a>                                           <span class="n">SpeedRatio</span>    <span class="o">=</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-3368"></a>      <span class="n">ENDIF</span>
<a name="ln-3369"></a>    <span class="k">ELSE</span>
<a name="ln-3370"></a><span class="k">      CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QCoilActual</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-3371"></a>    <span class="k">END IF</span>
<a name="ln-3372"></a><span class="k">    CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-3373"></a>    <span class="c">!  Simulate supplemental heating coil for draw through fan</span>
<a name="ln-3374"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3375"></a><span class="k">      CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">,</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QCoilActual</span><span class="p">)</span>
<a name="ln-3376"></a>    <span class="n">ENDIF</span>
<a name="ln-3377"></a>  <span class="k">END IF</span>
<a name="ln-3378"></a>
<a name="ln-3379"></a><span class="c">! calculate sensible load met using delta enthalpy at a constant (minimum) humidity ratio)</span>
<a name="ln-3380"></a>  <span class="n">MinHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-3381"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Node</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3382"></a>    <span class="n">MinHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-3383"></a>  <span class="n">LoadMet</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRat</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-3384"></a>         <span class="o">-</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRat</span><span class="p">))</span><span class="o">-</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoadLoss</span>
<a name="ln-3385"></a>
<a name="ln-3386"></a>  <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoadMet</span> <span class="o">=</span> <span class="n">LoadMet</span>
<a name="ln-3387"></a>
<a name="ln-3388"></a><span class="k">RETURN</span>
<a name="ln-3389"></a><span class="k">END SUBROUTINE </span><span class="n">CalcMSHeatPump</span>
<a name="ln-3390"></a>
<a name="ln-3391"></a>
<a name="ln-3392"></a><span class="c">!******************************************************************************</span>
<a name="ln-3393"></a>
<a name="ln-3394"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">MSHPCyclingResidual</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">Par</span><span class="p">)</span>
<a name="ln-3395"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-3396"></a>          <span class="c">!       AUTHOR         Lixing Gu</span>
<a name="ln-3397"></a>          <span class="c">!       DATE WRITTEN   June 2007</span>
<a name="ln-3398"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3399"></a>          <span class="c">!       RE-ENGINEERED  Revised for multispeed heat pump use based on DXCoilCyclingResidual</span>
<a name="ln-3400"></a>
<a name="ln-3401"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-3402"></a>          <span class="c">!  Calculates residual function ((ActualOutput - QZnReq)/QZnReq)</span>
<a name="ln-3403"></a>          <span class="c">!  MSHP output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-3404"></a>
<a name="ln-3405"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3406"></a>          <span class="c">!  Calls CalcMSHeatPump to get ActualOutput at the given part load ratio</span>
<a name="ln-3407"></a>          <span class="c">!  and calculates the residual as defined above</span>
<a name="ln-3408"></a>
<a name="ln-3409"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3410"></a>
<a name="ln-3411"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3412"></a>          <span class="c">! na</span>
<a name="ln-3413"></a>
<a name="ln-3414"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3415"></a>
<a name="ln-3416"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3417"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">PartLoadFrac</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-3418"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = MSHPNum</span>
<a name="ln-3419"></a>                                                  <span class="c">! par(2) = Zone Num</span>
<a name="ln-3420"></a>                                                  <span class="c">! par(3) = FirstHVACIteration</span>
<a name="ln-3421"></a>                                                  <span class="c">! par(4) = OpMode</span>
<a name="ln-3422"></a>                                                  <span class="c">! par(5) = QZnReq</span>
<a name="ln-3423"></a>                                                  <span class="c">! par(6) = OnOffAirFlowRatio</span>
<a name="ln-3424"></a>                                                  <span class="c">! par(7) = SupHeaterLoad</span>
<a name="ln-3425"></a>                                                  <span class="c">! par(9) = CompOp</span>
<a name="ln-3426"></a>
<a name="ln-3427"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-3428"></a>          <span class="c">!  na</span>
<a name="ln-3429"></a>
<a name="ln-3430"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3431"></a>          <span class="c">!  na</span>
<a name="ln-3432"></a>
<a name="ln-3433"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3434"></a>          <span class="c">!  na</span>
<a name="ln-3435"></a>
<a name="ln-3436"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3437"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MSHeatPumpNum</span>      <span class="c">! MSHP index</span>
<a name="ln-3438"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span>            <span class="c">! Zone index</span>
<a name="ln-3439"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! FirstHVACIteration flag</span>
<a name="ln-3440"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OpMode</span>             <span class="c">! Compressor operating mode</span>
<a name="ln-3441"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QZnReq</span>             <span class="c">! zone load (W)</span>
<a name="ln-3442"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! ratio of compressor ON airflow to average airflow over timestep</span>
<a name="ln-3443"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ActualOutput</span>       <span class="c">! delivered capacity of MSHP</span>
<a name="ln-3444"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupHeaterLoad</span>      <span class="c">! Supplemental heater load</span>
<a name="ln-3445"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CompOp</span>             <span class="c">! compressor operation; 1=on, 0=off</span>
<a name="ln-3446"></a>
<a name="ln-3447"></a>  <span class="n">MSHeatPumpNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3448"></a>  <span class="n">ZoneNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-3449"></a>  <span class="c">! FirstHVACIteration is a logical, Par is REAL(r64), so make 1.0=TRUE and 0.0=FALSE</span>
<a name="ln-3450"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3451"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3452"></a>  <span class="k">ELSE</span>
<a name="ln-3453"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3454"></a>  <span class="k">END IF</span>
<a name="ln-3455"></a><span class="k">  </span><span class="n">OpMode</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-3456"></a>  <span class="n">QZnReq</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-3457"></a>  <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-3458"></a>  <span class="n">SupHeaterLoad</span>     <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-3459"></a>  <span class="n">CompOp</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<a name="ln-3460"></a>
<a name="ln-3461"></a>  <span class="k">CALL </span><span class="n">CalcMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3462"></a>                       <span class="n">ActualOutput</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-3463"></a>
<a name="ln-3464"></a>  <span class="n">MSHPCyclingResidual</span> <span class="o">=</span> <span class="p">(</span><span class="n">ActualOutput</span> <span class="o">-</span> <span class="n">QZnReq</span><span class="p">)</span><span class="o">/</span><span class="n">QZnReq</span>
<a name="ln-3465"></a>  <span class="k">RETURN</span>
<a name="ln-3466"></a>
<a name="ln-3467"></a><span class="k">END FUNCTION </span><span class="n">MSHPCyclingResidual</span>
<a name="ln-3468"></a>
<a name="ln-3469"></a><span class="c">!******************************************************************************</span>
<a name="ln-3470"></a>
<a name="ln-3471"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">MSHPVarSpeedResidual</span><span class="p">(</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">Par</span><span class="p">)</span>
<a name="ln-3472"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-3473"></a>          <span class="c">!       AUTHOR         Lixing Gu</span>
<a name="ln-3474"></a>          <span class="c">!       DATE WRITTEN   June 2007</span>
<a name="ln-3475"></a>          <span class="c">!       MODIFIED       na L. Gu, Oct. 2006, revised for multispeed heat pump use</span>
<a name="ln-3476"></a>          <span class="c">!       RE-ENGINEERED  Revised for multispeed heat pump use based on DXCoilVarSpeedResidual</span>
<a name="ln-3477"></a>
<a name="ln-3478"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-3479"></a>          <span class="c">!  Calculates residual function ((ActualOutput - QZnReq)/QZnReq)</span>
<a name="ln-3480"></a>          <span class="c">!  MSHP output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-3481"></a>
<a name="ln-3482"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3483"></a>          <span class="c">!  Calls CalcMSHeatPump to get ActualOutput at the given speed ratio (partload ratio for high speed)</span>
<a name="ln-3484"></a>          <span class="c">!  and calculates the residual as defined above</span>
<a name="ln-3485"></a>
<a name="ln-3486"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3487"></a>
<a name="ln-3488"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3489"></a>          <span class="c">! na</span>
<a name="ln-3490"></a>
<a name="ln-3491"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3492"></a>
<a name="ln-3493"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3494"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SpeedRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-3495"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = MSHPNum</span>
<a name="ln-3496"></a>                                                  <span class="c">! par(2) = Zone Num</span>
<a name="ln-3497"></a>                                                  <span class="c">! par(3) = FirstHVACIteration</span>
<a name="ln-3498"></a>                                                  <span class="c">! par(4) = OpMode</span>
<a name="ln-3499"></a>                                                  <span class="c">! par(5) = QZnReq</span>
<a name="ln-3500"></a>                                                  <span class="c">! par(6) = OnOffAirFlowRatio</span>
<a name="ln-3501"></a>                                                  <span class="c">! par(7) = SupHeaterLoad</span>
<a name="ln-3502"></a>                                                  <span class="c">! par(8) = SpeedNum</span>
<a name="ln-3503"></a>                                                  <span class="c">! par(9) = CompOp</span>
<a name="ln-3504"></a>
<a name="ln-3505"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-3506"></a>          <span class="c">!  na</span>
<a name="ln-3507"></a>
<a name="ln-3508"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3509"></a>          <span class="c">!  na</span>
<a name="ln-3510"></a>
<a name="ln-3511"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3512"></a>          <span class="c">!  na</span>
<a name="ln-3513"></a>
<a name="ln-3514"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3515"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MSHeatPumpNum</span>      <span class="c">! MSHP index</span>
<a name="ln-3516"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span>            <span class="c">! Zone index</span>
<a name="ln-3517"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! FirstHVACIteration flag</span>
<a name="ln-3518"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OpMode</span>             <span class="c">! Compressor operating mode</span>
<a name="ln-3519"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QZnReq</span>             <span class="c">! zone load (W)</span>
<a name="ln-3520"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! ratio of compressor ON airflow to average airflow over timestep</span>
<a name="ln-3521"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ActualOutput</span>       <span class="c">! delivered capacity of MSHP</span>
<a name="ln-3522"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupHeaterLoad</span>      <span class="c">! Supplemental heater load</span>
<a name="ln-3523"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SpeedNum</span>           <span class="c">! Speed number</span>
<a name="ln-3524"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CompOp</span>             <span class="c">! compressor operation; 1=on, 0=off</span>
<a name="ln-3525"></a>
<a name="ln-3526"></a>  <span class="n">MSHeatPumpNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3527"></a>  <span class="n">ZoneNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-3528"></a>  <span class="c">! FirstHVACIteration is a logical, Par is REAL(r64), so make 1.0=TRUE and 0.0=FALSE</span>
<a name="ln-3529"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3530"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3531"></a>  <span class="k">ELSE</span>
<a name="ln-3532"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3533"></a>  <span class="k">END IF</span>
<a name="ln-3534"></a><span class="k">  </span><span class="n">OpMode</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-3535"></a>  <span class="n">QZnReq</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-3536"></a>  <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-3537"></a>  <span class="n">SupHeaterLoad</span>     <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-3538"></a>  <span class="n">SpeedNum</span>     <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-3539"></a>  <span class="n">CompOp</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<a name="ln-3540"></a>
<a name="ln-3541"></a>  <span class="k">CALL </span><span class="n">CalcMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3542"></a>                       <span class="n">ActualOutput</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-3543"></a>
<a name="ln-3544"></a>  <span class="n">MSHPVarSpeedResidual</span> <span class="o">=</span> <span class="p">(</span><span class="n">ActualOutput</span> <span class="o">-</span> <span class="n">QZnReq</span><span class="p">)</span><span class="o">/</span><span class="n">QZnReq</span>
<a name="ln-3545"></a>  <span class="k">RETURN</span>
<a name="ln-3546"></a>
<a name="ln-3547"></a><span class="k">END FUNCTION </span><span class="n">MSHPVarSpeedResidual</span>
<a name="ln-3548"></a>
<a name="ln-3549"></a><span class="c">!******************************************************************************</span>
<a name="ln-3550"></a>
<a name="ln-3551"></a><span class="k">SUBROUTINE </span><span class="n">UpdateMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span>
<a name="ln-3552"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3553"></a>            <span class="c">!       AUTHOR:          Lixing Gu, FSEC</span>
<a name="ln-3554"></a>            <span class="c">!       DATE WRITTEN:    June 2007</span>
<a name="ln-3555"></a>            <span class="c">!       MODIFIED         na</span>
<a name="ln-3556"></a>            <span class="c">!       RE-ENGINEERED    na</span>
<a name="ln-3557"></a>
<a name="ln-3558"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3559"></a>            <span class="c">!  This routine will update MSHP performance and calculate heat recovery rate and crankcase heater power</span>
<a name="ln-3560"></a>
<a name="ln-3561"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3562"></a>            <span class="c">! na</span>
<a name="ln-3563"></a>
<a name="ln-3564"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-3565"></a>
<a name="ln-3566"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-3567"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">LoopSystemOnMassFlowrate</span><span class="p">,</span><span class="n">LoopSystemOffMassFlowrate</span><span class="p">,</span><span class="n">LoopFanOperationMode</span><span class="p">,</span><span class="n">LoopOnOffFanPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3568"></a>                         <span class="n">LoopCompCycRatio</span>
<a name="ln-3569"></a>
<a name="ln-3570"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3571"></a>
<a name="ln-3572"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3573"></a>  <span class="kt">INTEGER</span>         <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MSHeatPumpNum</span>      <span class="c">! Engine driven heat pump number</span>
<a name="ln-3574"></a>
<a name="ln-3575"></a>  <span class="c">! Calculate heat recovery</span>
<a name="ln-3576"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecActive</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3577"></a><span class="k">    Call </span><span class="n">MSHPHeatRecovery</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span>
<a name="ln-3578"></a>  <span class="k">End If</span>
<a name="ln-3579"></a>
<a name="ln-3580"></a><span class="k">  </span><span class="n">LoopSystemOnMassFlowrate</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span>
<a name="ln-3581"></a>  <span class="n">LoopSystemOffMassFlowrate</span> <span class="o">=</span> <span class="n">CompOffMassFlow</span>
<a name="ln-3582"></a>  <span class="n">LoopFanOperationMode</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span>
<a name="ln-3583"></a>  <span class="n">LoopOnOffFanPartLoadRatio</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span>
<a name="ln-3584"></a>  <span class="n">LoopCompCycRatio</span> <span class="o">=</span> <span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CycRatio</span>
<a name="ln-3585"></a>
<a name="ln-3586"></a><span class="k">RETURN</span>
<a name="ln-3587"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateMSHeatPump</span>
<a name="ln-3588"></a><span class="c">!******************************************************************************</span>
<a name="ln-3589"></a>
<a name="ln-3590"></a><span class="k">SUBROUTINE </span><span class="n">ReportMSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span>
<a name="ln-3591"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3592"></a>            <span class="c">!       AUTHOR:          Lixing Gu, FSEC</span>
<a name="ln-3593"></a>            <span class="c">!       DATE WRITTEN:    June 2007</span>
<a name="ln-3594"></a>            <span class="c">!       MODIFIED         na</span>
<a name="ln-3595"></a>            <span class="c">!       RE-ENGINEERED    na</span>
<a name="ln-3596"></a>
<a name="ln-3597"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3598"></a>            <span class="c">!  This routine will write values to output variables in MSHP</span>
<a name="ln-3599"></a>
<a name="ln-3600"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3601"></a>            <span class="c">!</span>
<a name="ln-3602"></a>
<a name="ln-3603"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-3604"></a>
<a name="ln-3605"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-3606"></a>  <span class="k">Use </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-3607"></a>
<a name="ln-3608"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3609"></a>
<a name="ln-3610"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3611"></a>  <span class="kt">INTEGER</span>         <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MSHeatPumpNum</span>      <span class="c">! Engine driven heat pump number</span>
<a name="ln-3612"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3613"></a>          <span class="c">! na</span>
<a name="ln-3614"></a>
<a name="ln-3615"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3616"></a>          <span class="c">! na</span>
<a name="ln-3617"></a>
<a name="ln-3618"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3619"></a>          <span class="c">! na</span>
<a name="ln-3620"></a>
<a name="ln-3621"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3622"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReportingConstant</span>
<a name="ln-3623"></a>
<a name="ln-3624"></a>  <span class="n">ReportingConstant</span> <span class="o">=</span> <span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3625"></a>  <span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ElecPowerConsumption</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ElecPower</span><span class="o">*</span><span class="n">ReportingConstant</span> <span class="c">! + &amp;</span>
<a name="ln-3626"></a>  <span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecoveryEnergy</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecoveryRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3627"></a>
<a name="ln-3628"></a>  <span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxElecHeatConsumption</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3629"></a>  <span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxElecCoolConsumption</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3630"></a>
<a name="ln-3631"></a>  <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxElecPower</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxOnCyclePower</span><span class="o">*</span><span class="n">SaveCompressorPLR</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3632"></a>                                           <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxOffCyclePower</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SaveCompressorPLR</span><span class="p">)</span>
<a name="ln-3633"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">CoolingMode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3634"></a><span class="k">    </span><span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxElecCoolConsumption</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxOnCyclePower</span><span class="o">*</span><span class="n">SaveCompressorPLR</span> <span class="p">&amp;</span>
<a name="ln-3635"></a>                                                             <span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3636"></a>  <span class="k">End If</span>
<a name="ln-3637"></a><span class="k">  If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">HeatingMode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3638"></a><span class="k">    </span><span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxElecHeatConsumption</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxOnCyclePower</span><span class="o">*</span><span class="n">SaveCompressorPLR</span> <span class="p">&amp;</span>
<a name="ln-3639"></a>                                                             <span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3640"></a>  <span class="k">End If</span>
<a name="ln-3641"></a><span class="k">  If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="o">==</span> <span class="n">HeatingMode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3642"></a><span class="k">    </span><span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxElecHeatConsumption</span> <span class="o">=</span> <span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxElecHeatConsumption</span><span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3643"></a>                                <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxOffCyclePower</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SaveCompressorPLR</span><span class="p">)</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3644"></a>  <span class="k">Else</span>
<a name="ln-3645"></a><span class="k">    </span><span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxElecCoolConsumption</span> <span class="o">=</span> <span class="n">MSHeatPumpReport</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxElecCoolConsumption</span><span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3646"></a>                                <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AuxOffCyclePower</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SaveCompressorPLR</span><span class="p">)</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-3647"></a>  <span class="k">End If</span>
<a name="ln-3648"></a>
<a name="ln-3649"></a><span class="k">RETURN</span>
<a name="ln-3650"></a><span class="k">END SUBROUTINE </span><span class="n">ReportMSHeatPump</span>
<a name="ln-3651"></a>
<a name="ln-3652"></a><span class="k">SUBROUTINE </span><span class="n">MSHPHeatRecovery</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)</span>
<a name="ln-3653"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3654"></a>            <span class="c">!       AUTHOR:          Lixing Gu</span>
<a name="ln-3655"></a>            <span class="c">!       DATE WRITTEN:    June 2007</span>
<a name="ln-3656"></a>            <span class="c">!       MODIFIED:        na</span>
<a name="ln-3657"></a>            <span class="c">!       RE-ENGINEERED    Revised to calculate MSHP heat recovery rate based on EIR Chiller heat recovery subroutine</span>
<a name="ln-3658"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3659"></a>            <span class="c">!  Calculate the heat recovered from MSHP</span>
<a name="ln-3660"></a>
<a name="ln-3661"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3662"></a>            <span class="c">!  na</span>
<a name="ln-3663"></a>
<a name="ln-3664"></a>            <span class="c">! REFERENCES:</span>
<a name="ln-3665"></a>            <span class="c">!  na</span>
<a name="ln-3666"></a>
<a name="ln-3667"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-3668"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">MSHPWasteHeat</span>
<a name="ln-3669"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-3670"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-3671"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">SafeCopyPlantNode</span>
<a name="ln-3672"></a>
<a name="ln-3673"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3674"></a>
<a name="ln-3675"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3676"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MSHeatPumpNum</span> <span class="c">! Number of the current electric MSHP being simulated</span>
<a name="ln-3677"></a>
<a name="ln-3678"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3679"></a>          <span class="c">!  na</span>
<a name="ln-3680"></a>
<a name="ln-3681"></a>          <span class="c">! DERIVMS TYPE DEFINITIONS:</span>
<a name="ln-3682"></a>          <span class="c">!  na</span>
<a name="ln-3683"></a>
<a name="ln-3684"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3685"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HeatRecInNode</span>       <span class="c">! Node number of heat recovery water inlet node</span>
<a name="ln-3686"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HeatRecOutNode</span>      <span class="c">! Node number of heat recovery water outlet node</span>
<a name="ln-3687"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QHeatRec</span>              <span class="c">! Total heat recovered [W]</span>
<a name="ln-3688"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecInletTemp</span>    <span class="c">! Heat reclaim inlet temp [C]</span>
<a name="ln-3689"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecOutletTemp</span>   <span class="c">! Heat reclaim outlet temp [C]</span>
<a name="ln-3690"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecMassFlowRate</span> <span class="c">! Heat reclaim mass flow rate [m3/s]</span>
<a name="ln-3691"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CpHeatRec</span>           <span class="c">! Heat reclaim water inlet specific heat [J/kg-K]</span>
<a name="ln-3692"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatRecInletEnth</span>    <span class="c">! Heat reclaim water inlet enthalpy [J/kg]</span>
<a name="ln-3693"></a>
<a name="ln-3694"></a>  <span class="c">! Begin routine</span>
<a name="ln-3695"></a>  <span class="n">HeatRecInNode</span>  <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecInletNodeNum</span>
<a name="ln-3696"></a>  <span class="n">HeatRecOutNode</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecOutletNodeNum</span>
<a name="ln-3697"></a>
<a name="ln-3698"></a>   <span class="c">! Inlet node to the heat recovery heat exchanger</span>
<a name="ln-3699"></a>  <span class="n">HeatRecInletTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3700"></a>  <span class="n">HeatRecInletEnth</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInNode</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-3701"></a>
<a name="ln-3702"></a>   <span class="c">! Set heat recovery mass flow rates</span>
<a name="ln-3703"></a>  <span class="n">HeatRecMassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecInNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-3704"></a>
<a name="ln-3705"></a>  <span class="n">QHeatRec</span> <span class="o">=</span> <span class="n">MSHPWasteHeat</span>
<a name="ln-3706"></a>
<a name="ln-3707"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HeatRecMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3708"></a>
<a name="ln-3709"></a><span class="k">    </span><span class="n">CpHeatRec</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3710"></a>                                      <span class="n">HeatRecInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3711"></a>                                      <span class="n">PlantLoop</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HRLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3712"></a>                                      <span class="s1">&#39;MSHPHeatRecovery&#39;</span><span class="p">)</span>
<a name="ln-3713"></a>
<a name="ln-3714"></a>    <span class="n">HeatRecOutletTemp</span> <span class="o">=</span> <span class="n">QHeatRec</span><span class="o">/</span><span class="p">(</span><span class="n">HeatRecMassFlowRate</span><span class="o">*</span><span class="n">CpHeatRec</span><span class="p">)</span> <span class="o">+</span> <span class="n">HeatRecInletTemp</span>
<a name="ln-3715"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HeatRecOutletTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxHeatRecOutletTemp</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3716"></a>        <span class="n">HeatRecOutletTemp</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxHeatRecOutletTemp</span>
<a name="ln-3717"></a>  <span class="k">ELSE</span>
<a name="ln-3718"></a><span class="k">    </span><span class="n">HeatRecOutletTemp</span> <span class="o">=</span> <span class="n">HeatRecInletTemp</span>
<a name="ln-3719"></a>  <span class="k">END IF</span>
<a name="ln-3720"></a>
<a name="ln-3721"></a><span class="k">  CALL </span><span class="n">SafeCopyPlantNode</span><span class="p">(</span><span class="n">HeatRecInNode</span><span class="p">,</span> <span class="n">HeatRecOutNode</span><span class="p">)</span>
<a name="ln-3722"></a>  <span class="c">! changed outputs</span>
<a name="ln-3723"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">HeatRecOutNode</span><span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">HeatRecOutletTemp</span>
<a name="ln-3724"></a>
<a name="ln-3725"></a>  <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecoveryRate</span> <span class="o">=</span> <span class="n">QHeatRec</span>
<a name="ln-3726"></a>  <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecoveryInletTemp</span>  <span class="o">=</span> <span class="n">HeatRecInletTemp</span>
<a name="ln-3727"></a>  <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecoveryOutletTemp</span> <span class="o">=</span> <span class="n">HeatRecOutletTemp</span>
<a name="ln-3728"></a>  <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatRecoveryMassFlowRate</span> <span class="o">=</span> <span class="n">HeatRecMassFlowRate</span>
<a name="ln-3729"></a>
<a name="ln-3730"></a>
<a name="ln-3731"></a>  <span class="k">RETURN</span>
<a name="ln-3732"></a>
<a name="ln-3733"></a><span class="k">END SUBROUTINE </span><span class="n">MSHPHeatRecovery</span>
<a name="ln-3734"></a>
<a name="ln-3735"></a><span class="k">SUBROUTINE </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">)</span>
<a name="ln-3736"></a>
<a name="ln-3737"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3738"></a>          <span class="c">!       AUTHOR         Lixing</span>
<a name="ln-3739"></a>          <span class="c">!       DATE WRITTEN   June 2007</span>
<a name="ln-3740"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3741"></a>          <span class="c">!       RE-ENGINEERED  Resived to meet requirements of multispeed heat pump based on the same subroutine</span>
<a name="ln-3742"></a>          <span class="c">!                      in PTHP module</span>
<a name="ln-3743"></a>
<a name="ln-3744"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3745"></a>          <span class="c">! Set the average air mass flow rates using the part load fraction of the heat pump for this time step</span>
<a name="ln-3746"></a>          <span class="c">! Set OnOffAirFlowRatio to be used by DX coils</span>
<a name="ln-3747"></a>
<a name="ln-3748"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3749"></a>          <span class="c">! na</span>
<a name="ln-3750"></a>
<a name="ln-3751"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3752"></a>          <span class="c">! na</span>
<a name="ln-3753"></a>
<a name="ln-3754"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3755"></a>  <span class="k">USE </span><span class="n">DataZoneEnergyDemands</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurDeadBandOrSetback</span>
<a name="ln-3756"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">MSHPMassFlowRateLow</span><span class="p">,</span> <span class="n">MSHPMassFlowRateHigh</span>
<a name="ln-3757"></a>
<a name="ln-3758"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3759"></a>
<a name="ln-3760"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3761"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MSHeatPumpNum</span>      <span class="c">! Unit index</span>
<a name="ln-3762"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PartLoadRatio</span>      <span class="c">! unit part load ratio</span>
<a name="ln-3763"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! ratio of compressor ON airflow to average airflow over timestep</span>
<a name="ln-3764"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">),</span><span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">SpeedNum</span>     <span class="c">! Speed number</span>
<a name="ln-3765"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">),</span><span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>   <span class="c">! Speed ratio</span>
<a name="ln-3766"></a>
<a name="ln-3767"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3768"></a>          <span class="c">! na</span>
<a name="ln-3769"></a>
<a name="ln-3770"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3771"></a>          <span class="c">! na</span>
<a name="ln-3772"></a>
<a name="ln-3773"></a>          <span class="c">! DERIVMS TYPE DEFINITIONS</span>
<a name="ln-3774"></a>          <span class="c">! na</span>
<a name="ln-3775"></a>
<a name="ln-3776"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3777"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">InletNode</span>           <span class="c">! inlet node number for PTHPNum</span>
<a name="ln-3778"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">AverageUnitMassFlow</span> <span class="c">! average supply air mass flow rate over time step</span>
<a name="ln-3779"></a>
<a name="ln-3780"></a>  <span class="n">MSHPMassFlowRateLow</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! Mass flow rate at low speed</span>
<a name="ln-3781"></a>  <span class="n">MSHPMassFlowRateHigh</span> <span class="o">=</span> <span class="mf">0.0d0</span>            <span class="c">! Mass flow rate at high speed</span>
<a name="ln-3782"></a>
<a name="ln-3783"></a>
<a name="ln-3784"></a>  <span class="k">If</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CurDeadbandOrSetback</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">Present</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-3785"></a><span class="k">    If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">HeatingMode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3786"></a><span class="k">      If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3787"></a><span class="k">        </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-3788"></a>        <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-3789"></a>        <span class="n">MSHPMassFlowRateLow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3790"></a>        <span class="n">MSHPMassFlowRateHigh</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3791"></a>      <span class="k">Else If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3792"></a><span class="k">        </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3793"></a>                         <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3794"></a>        <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3795"></a>                         <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3796"></a>        <span class="n">MSHPMassFlowRateLow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3797"></a>        <span class="n">MSHPMassFlowRateHigh</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-3798"></a>      <span class="k">End If</span>
<a name="ln-3799"></a><span class="k">    Else If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">CoolingMode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3800"></a><span class="k">      If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3801"></a><span class="k">        </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-3802"></a>        <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-3803"></a>        <span class="n">MSHPMassFlowRateLow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3804"></a>        <span class="n">MSHPMassFlowRateHigh</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3805"></a>      <span class="k">Else If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3806"></a><span class="k">        </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3807"></a>                         <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3808"></a>        <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3809"></a>                         <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3810"></a>        <span class="n">MSHPMassFlowRateLow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3811"></a>        <span class="n">MSHPMassFlowRateHigh</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-3812"></a>      <span class="k">End If</span>
<a name="ln-3813"></a><span class="k">    End If</span>
<a name="ln-3814"></a><span class="k">  End If</span>
<a name="ln-3815"></a><span class="k">  </span><span class="n">InletNode</span>      <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-3816"></a>
<a name="ln-3817"></a>  <span class="c">! Set up fan flow rate during compressor off time</span>
<a name="ln-3818"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">Present</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-3819"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">UseCompressorOnFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CompOnMassFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3820"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">HeatingMode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3821"></a><span class="k">        </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-3822"></a>        <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-3823"></a>      <span class="k">ELSE</span>
<a name="ln-3824"></a><span class="k">        </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-3825"></a>        <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-3826"></a>      <span class="k">END IF</span>
<a name="ln-3827"></a><span class="k">    END IF</span>
<a name="ln-3828"></a><span class="k">  End If</span>
<a name="ln-3829"></a>
<a name="ln-3830"></a><span class="k">  If</span> <span class="p">(</span><span class="nb">Present</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-3831"></a><span class="k">    If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3832"></a><span class="k">      </span><span class="n">AverageUnitMassFlow</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span>
<a name="ln-3833"></a>      <span class="n">FanSpeedRatio</span>       <span class="o">=</span> <span class="n">CompOnFlowRatio</span>
<a name="ln-3834"></a>    <span class="k">Else</span>
<a name="ln-3835"></a><span class="k">      </span><span class="n">AverageUnitMassFlow</span> <span class="o">=</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">CompOnMassFlow</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">CompOffMassFlow</span><span class="p">)</span>
<a name="ln-3836"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">CompOffFlowRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3837"></a><span class="k">        </span><span class="n">FanSpeedRatio</span> <span class="o">=</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">CompOnFlowRatio</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">CompOffFlowRatio</span><span class="p">)</span>
<a name="ln-3838"></a>      <span class="k">ELSE</span>
<a name="ln-3839"></a><span class="k">        </span><span class="n">FanSpeedRatio</span>     <span class="o">=</span> <span class="n">CompOnFlowRatio</span>
<a name="ln-3840"></a>      <span class="k">END IF</span>
<a name="ln-3841"></a><span class="k">    End If</span>
<a name="ln-3842"></a><span class="k">  Else</span>
<a name="ln-3843"></a><span class="k">    </span><span class="n">AverageUnitMassFlow</span> <span class="o">=</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">CompOnMassFlow</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">CompOffMassFlow</span><span class="p">)</span>
<a name="ln-3844"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CompOffFlowRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3845"></a><span class="k">      </span><span class="n">FanSpeedRatio</span> <span class="o">=</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">CompOnFlowRatio</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">CompOffFlowRatio</span><span class="p">)</span>
<a name="ln-3846"></a>    <span class="k">ELSE</span>
<a name="ln-3847"></a><span class="k">      </span><span class="n">FanSpeedRatio</span>       <span class="o">=</span> <span class="n">CompOnFlowRatio</span>
<a name="ln-3848"></a>    <span class="k">END IF</span>
<a name="ln-3849"></a><span class="k">  End If</span>
<a name="ln-3850"></a>
<a name="ln-3851"></a><span class="c">!!!LKL Discrepancy with &gt; 0</span>
<a name="ln-3852"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">AvaiSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3853"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>              <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3854"></a>    <span class="n">OnOffAirFlowRatio</span>                         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3855"></a>  <span class="k">ELSE</span>
<a name="ln-3856"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>              <span class="o">=</span> <span class="n">AverageUnitMassFlow</span>
<a name="ln-3857"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>      <span class="o">=</span> <span class="n">AverageUnitMassFlow</span>
<a name="ln-3858"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">AverageUnitMassFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3859"></a><span class="k">      </span><span class="n">OnOffAirFlowRatio</span>                       <span class="o">=</span> <span class="n">CompOnMassFlow</span> <span class="o">/</span> <span class="n">AverageUnitMassFlow</span>
<a name="ln-3860"></a>    <span class="k">ELSE</span>
<a name="ln-3861"></a><span class="k">      </span><span class="n">OnOffAirFlowRatio</span>                       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3862"></a>    <span class="k">END IF</span>
<a name="ln-3863"></a><span class="k">  END IF</span>
<a name="ln-3864"></a>
<a name="ln-3865"></a><span class="k">  RETURN</span>
<a name="ln-3866"></a><span class="k">END SUBROUTINE </span><span class="n">SetAverageAirFlow</span>
<a name="ln-3867"></a>
<a name="ln-3868"></a><span class="k">SUBROUTINE </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatingLoad</span><span class="p">,</span><span class="n">FanMode</span><span class="p">,</span><span class="n">HeatCoilLoadmet</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-3869"></a>
<a name="ln-3870"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3871"></a>          <span class="c">!       AUTHOR         Bereket Nigusse, FSEC/UCF</span>
<a name="ln-3872"></a>          <span class="c">!       DATE WRITTEN   January 2012</span>
<a name="ln-3873"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3874"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3875"></a>
<a name="ln-3876"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3877"></a>          <span class="c">! This subroutine simulates the four non dx heating coil types: Gas, Electric, hot water and steam.</span>
<a name="ln-3878"></a>
<a name="ln-3879"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3880"></a>          <span class="c">! Simply calls the different heating coil component.  The hot water flow rate matching the coil load</span>
<a name="ln-3881"></a>          <span class="c">! is calculated iteratively.</span>
<a name="ln-3882"></a>
<a name="ln-3883"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3884"></a>          <span class="c">! na</span>
<a name="ln-3885"></a>
<a name="ln-3886"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3887"></a>
<a name="ln-3888"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>              <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span>
<a name="ln-3889"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>                <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-3890"></a>  <span class="k">USE </span><span class="n">SteamCoils</span><span class="p">,</span>                <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateSteamCoilComponents</span>
<a name="ln-3891"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-3892"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>                   <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-3893"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">SmallLoad</span>
<a name="ln-3894"></a>
<a name="ln-3895"></a>  <span class="k">IMPLICIT NONE</span>     <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3896"></a>
<a name="ln-3897"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3898"></a>  <span class="kt">INTEGER</span><span class="p">,</span>      <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MSHeatPumpNum</span>             <span class="c">! multispeed heatpump index</span>
<a name="ln-3899"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>      <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>        <span class="c">! flag for first HVAC iteration in the time step</span>
<a name="ln-3900"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatingLoad</span>             <span class="c">! supplemental coil load to be met by unit (watts)</span>
<a name="ln-3901"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">HeatCoilLoadmet</span>           <span class="c">! Heating Load Met</span>
<a name="ln-3902"></a>  <span class="kt">INTEGER</span><span class="p">,</span>      <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FanMode</span>                   <span class="c">! fan operation mode</span>
<a name="ln-3903"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span>    <span class="kd">::</span> <span class="n">PartLoadFrac</span>
<a name="ln-3904"></a>
<a name="ln-3905"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3906"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ErrTolerance</span> <span class="o">=</span> <span class="mf">0.001d0</span>    <span class="c">! convergence limit for hotwater coil</span>
<a name="ln-3907"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SolveMaxIter</span><span class="o">=</span><span class="mi">50</span>
<a name="ln-3908"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed&#39;</span>
<a name="ln-3909"></a>
<a name="ln-3910"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3911"></a>          <span class="c">! na</span>
<a name="ln-3912"></a>
<a name="ln-3913"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3914"></a>          <span class="c">! na</span>
<a name="ln-3915"></a>
<a name="ln-3916"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3917"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">QCoilRequired</span>   <span class="c">! heat addition required from an electric, gas, steam, or hot water coil</span>
<a name="ln-3918"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">QCoilActual</span>     <span class="c">! actual heating load met</span>
<a name="ln-3919"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">mdot</span>            <span class="c">! heating coil steam or hot water mass flow rate</span>
<a name="ln-3920"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">MinWaterFlow</span>    <span class="c">! coil minimum hot water mass flow rate, kg/s</span>
<a name="ln-3921"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">MaxHotWaterFlow</span> <span class="c">! coil maximum hot water mass flow rate, kg/s</span>
<a name="ln-3922"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">HotWaterMdot</span>    <span class="c">! actual hot water mass flow rate</span>
<a name="ln-3923"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Par</span>    <span class="c">!</span>
<a name="ln-3924"></a>  <span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">SolFlag</span>
<a name="ln-3925"></a>
<a name="ln-3926"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCoilName</span>  <span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-3927"></a>  <span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">HeatCoilType</span>
<a name="ln-3928"></a>  <span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">HeatCoilNum</span>
<a name="ln-3929"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">MaxCoilFluidFlow</span>
<a name="ln-3930"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">SteamCoilHeatingLoad</span>
<a name="ln-3931"></a>  <span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">CoilControlNode</span>
<a name="ln-3932"></a>  <span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">CoilOutletNode</span>
<a name="ln-3933"></a>  <span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">LoopNum</span>
<a name="ln-3934"></a>  <span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">LoopSide</span>
<a name="ln-3935"></a>  <span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">BranchNum</span>
<a name="ln-3936"></a>  <span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">CompNum</span>
<a name="ln-3937"></a>
<a name="ln-3938"></a>  <span class="n">QCoilActual</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3939"></a>
<a name="ln-3940"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3941"></a><span class="k">    </span><span class="n">HeatCoilType</span>     <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilType</span>
<a name="ln-3942"></a>    <span class="n">HeatCoilName</span>     <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilName</span>
<a name="ln-3943"></a>    <span class="n">HeatCoilNum</span>      <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HeatCoilNum</span>
<a name="ln-3944"></a>    <span class="n">MaxCoilFluidFlow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span>
<a name="ln-3945"></a>    <span class="n">CoilControlNode</span>  <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoilControlNode</span>
<a name="ln-3946"></a>    <span class="n">CoilOutletNode</span>   <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CoilOutletNode</span>
<a name="ln-3947"></a>    <span class="n">LoopNum</span>          <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopNum</span>
<a name="ln-3948"></a>    <span class="n">LoopSide</span>         <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">LoopSide</span>
<a name="ln-3949"></a>    <span class="n">BranchNum</span>        <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">BranchNum</span>
<a name="ln-3950"></a>    <span class="n">CompNum</span>          <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">CompNum</span>
<a name="ln-3951"></a>  <span class="k">ELSE</span>
<a name="ln-3952"></a><span class="k">    </span><span class="n">HeatCoilType</span>     <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span>
<a name="ln-3953"></a>    <span class="n">HeatCoilName</span>     <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span>
<a name="ln-3954"></a>    <span class="n">HeatCoilNum</span>      <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppHeatCoilNum</span>
<a name="ln-3955"></a>    <span class="n">MaxCoilFluidFlow</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span>
<a name="ln-3956"></a>    <span class="n">CoilControlNode</span>  <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span>
<a name="ln-3957"></a>    <span class="n">CoilOutletNode</span>   <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCoilOutletNode</span>
<a name="ln-3958"></a>    <span class="n">LoopNum</span>          <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopNum</span>
<a name="ln-3959"></a>    <span class="n">LoopSide</span>         <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppLoopSide</span>
<a name="ln-3960"></a>    <span class="n">BranchNum</span>        <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppBranchNum</span>
<a name="ln-3961"></a>    <span class="n">CompNum</span>          <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">SuppCompNum</span>
<a name="ln-3962"></a>  <span class="n">ENDIF</span>
<a name="ln-3963"></a>
<a name="ln-3964"></a>  <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterLoopNum</span>          <span class="o">=</span> <span class="n">LoopNum</span>
<a name="ln-3965"></a>  <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterLoopSide</span>         <span class="o">=</span> <span class="n">LoopSide</span>
<a name="ln-3966"></a>  <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterBranchNum</span>        <span class="o">=</span> <span class="n">BranchNum</span>
<a name="ln-3967"></a>  <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterCompNum</span>          <span class="o">=</span> <span class="n">CompNum</span>
<a name="ln-3968"></a>  <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterCoilControlNode</span>  <span class="o">=</span> <span class="n">CoilControlNode</span>
<a name="ln-3969"></a>  <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterCoilOutletNode</span>   <span class="o">=</span> <span class="n">CoilOutletNode</span>
<a name="ln-3970"></a>  <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterCoilName</span>         <span class="o">=</span> <span class="n">HeatCoilName</span>
<a name="ln-3971"></a>  <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterCoilNum</span>          <span class="o">=</span> <span class="n">HeatCoilNum</span>
<a name="ln-3972"></a>
<a name="ln-3973"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HeatingLoad</span> <span class="o">&gt;</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3974"></a>
<a name="ln-3975"></a><span class="k">   Select Case</span> <span class="p">(</span><span class="n">HeatCoilType</span><span class="p">)</span>
<a name="ln-3976"></a>    <span class="k">Case</span> <span class="p">(</span><span class="n">SuppHeatingCoilGas</span><span class="p">,</span> <span class="n">SuppHeatingCoilElec</span><span class="p">)</span>
<a name="ln-3977"></a>      <span class="k">CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3978"></a>                                         <span class="n">HeatingLoad</span><span class="p">,</span> <span class="n">HeatCoilNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3979"></a>                                         <span class="n">QCoilActual</span><span class="p">,</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span> <span class="n">FanMode</span><span class="p">)</span>
<a name="ln-3980"></a>    <span class="k">Case</span> <span class="p">(</span><span class="n">Coil_HeatingWater</span><span class="p">)</span>
<a name="ln-3981"></a>       <span class="k">If</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3982"></a><span class="k">         </span><span class="n">MaxHotWaterFlow</span> <span class="o">=</span> <span class="n">MaxCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadFrac</span>
<a name="ln-3983"></a>         <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span> <span class="n">MaxHotWaterFlow</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3984"></a>                                    <span class="n">CoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3985"></a>                                    <span class="n">CoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3986"></a>                                    <span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3987"></a>                                    <span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3988"></a>                                    <span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3989"></a>                                    <span class="n">CompNum</span><span class="p">)</span>
<a name="ln-3990"></a>         <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3991"></a>                                          <span class="n">HeatCoilNum</span><span class="p">,</span> <span class="n">QCoilActual</span><span class="p">,</span> <span class="n">FanMode</span><span class="p">)</span>
<a name="ln-3992"></a>       <span class="k">Else</span>
<a name="ln-3993"></a><span class="k">         </span><span class="n">MaxHotWaterFlow</span> <span class="o">=</span> <span class="n">MaxCoilFluidFlow</span>
<a name="ln-3994"></a>         <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span> <span class="n">MaxHotWaterFlow</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3995"></a>                                    <span class="n">CoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3996"></a>                                    <span class="n">CoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3997"></a>                                    <span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3998"></a>                                    <span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3999"></a>                                    <span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4000"></a>                                    <span class="n">CompNum</span><span class="p">)</span>
<a name="ln-4001"></a>         <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4002"></a>                                          <span class="n">HeatCoilNum</span><span class="p">,</span> <span class="n">QCoilActual</span><span class="p">,</span> <span class="n">FanMode</span><span class="p">)</span>
<a name="ln-4003"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">QCoilActual</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">HeatingLoad</span> <span class="o">+</span> <span class="n">SmallLoad</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4004"></a>            <span class="c">! control water flow to obtain output matching HeatingLoad</span>
<a name="ln-4005"></a>            <span class="n">SolFlag</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4006"></a>            <span class="n">MinWaterFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4007"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-4008"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4009"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-4010"></a>            <span class="k">ELSE</span>
<a name="ln-4011"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4012"></a>            <span class="k">END IF</span>
<a name="ln-4013"></a><span class="k">            </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">HeatingLoad</span>
<a name="ln-4014"></a>            <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">ErrTolerance</span><span class="p">,</span> <span class="n">SolveMaxIter</span><span class="p">,</span> <span class="n">SolFlag</span><span class="p">,</span> <span class="n">HotWaterMdot</span><span class="p">,</span> <span class="n">HotWaterCoilResidual</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4015"></a>                                  <span class="n">MinWaterFlow</span><span class="p">,</span> <span class="n">MaxHotWaterFlow</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-4016"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4017"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterCoilMaxIterIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4018"></a><span class="k">                CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;CalcNonDXHeatingCoils: Hot water coil control failed for &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4019"></a>                <span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4020"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4021"></a>                <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-4022"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Iteration limit [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SolveMaxIter</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4023"></a>                      <span class="s1">&#39;] exceeded in calculating hot water mass flow rate&#39;</span><span class="p">)</span>
<a name="ln-4024"></a>              <span class="n">ENDIF</span>
<a name="ln-4025"></a>              <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcNonDXHeatingCoils: Hot water coil control failed (iteration limit [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4026"></a>                    <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SolveMaxIter</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]) for &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4027"></a>                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterCoilMaxIterIndex</span><span class="p">)</span>
<a name="ln-4028"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4029"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterCoilMaxIterIndex2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4030"></a><span class="k">                CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;CalcNonDXHeatingCoils: Hot water coil control failed (maximum flow limits) for &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4031"></a>                      <span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4032"></a>                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4033"></a>                <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-4034"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Bad hot water maximum flow rate limits&#39;</span><span class="p">)</span>
<a name="ln-4035"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Given minimum water flow rate=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MinWaterFlow</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s&#39;</span><span class="p">)</span>
<a name="ln-4036"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Given maximum water flow rate=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxHotWaterFlow</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s&#39;</span><span class="p">)</span>
<a name="ln-4037"></a>              <span class="n">ENDIF</span>
<a name="ln-4038"></a>              <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcNonDXHeatingCoils: Hot water coil control failed (flow limits) for &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4039"></a>                    <span class="nb">trim</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4040"></a>                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4041"></a>                    <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterCoilMaxIterIndex2</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4042"></a>                    <span class="n">ReportMinOf</span><span class="o">=</span><span class="n">MinWaterFlow</span><span class="p">,</span><span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">MaxHotWaterFlow</span><span class="p">,</span><span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;[kg/s]&#39;</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;[kg/s]&#39;</span><span class="p">)</span>
<a name="ln-4043"></a>
<a name="ln-4044"></a>            <span class="k">END IF</span>
<a name="ln-4045"></a>          <span class="c">! simulate hot water supplemental heating coil</span>
<a name="ln-4046"></a>            <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4047"></a>                                           <span class="n">HeatCoilNum</span><span class="p">,</span> <span class="n">QCoilActual</span><span class="p">,</span> <span class="n">FanMode</span><span class="p">)</span>
<a name="ln-4048"></a>         <span class="n">ENDIF</span>
<a name="ln-4049"></a>       <span class="n">Endif</span>
<a name="ln-4050"></a>    <span class="k">Case</span> <span class="p">(</span><span class="n">Coil_HeatingSteam</span><span class="p">)</span>
<a name="ln-4051"></a>       <span class="k">If</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4052"></a><span class="k">         </span><span class="n">mdot</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span> <span class="o">*</span> <span class="n">PartLoadFrac</span>
<a name="ln-4053"></a>         <span class="n">SteamCoilHeatingLoad</span> <span class="o">=</span> <span class="n">HeatingLoad</span> <span class="o">*</span> <span class="n">PartLoadFrac</span>
<a name="ln-4054"></a>       <span class="k">Else</span>
<a name="ln-4055"></a><span class="k">         </span><span class="n">mdot</span> <span class="o">=</span> <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">MaxCoilFluidFlow</span>
<a name="ln-4056"></a>         <span class="n">SteamCoilHeatingLoad</span> <span class="o">=</span> <span class="n">HeatingLoad</span>
<a name="ln-4057"></a>       <span class="n">Endif</span>
<a name="ln-4058"></a>       <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span> <span class="n">mdot</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4059"></a>                                 <span class="n">CoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4060"></a>                                 <span class="n">CoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4061"></a>                                 <span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4062"></a>                                 <span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4063"></a>                                 <span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4064"></a>                                 <span class="n">CompNum</span><span class="p">)</span>
<a name="ln-4065"></a>       <span class="c">! simulate steam supplemental heating coil</span>
<a name="ln-4066"></a>       <span class="k">CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">HeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4067"></a>                                       <span class="n">FirstHVACIteration</span><span class="p">,</span>  <span class="n">SteamCoilHeatingLoad</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-4068"></a>                                       <span class="n">HeatCoilNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-4069"></a>                                       <span class="n">QCoilActual</span><span class="p">,</span> <span class="n">FanMode</span><span class="p">)</span>
<a name="ln-4070"></a>    <span class="k">END Select</span>
<a name="ln-4071"></a>
<a name="ln-4072"></a><span class="k">  ELSE</span>  <span class="c">! end of IF (HeatingLoad &gt; SmallLoad) THEN</span>
<a name="ln-4073"></a>
<a name="ln-4074"></a>    <span class="k">Select Case</span> <span class="p">(</span><span class="n">HeatCoilType</span><span class="p">)</span>
<a name="ln-4075"></a>     <span class="k">Case</span> <span class="p">(</span><span class="n">SuppHeatingCoilGas</span><span class="p">,</span> <span class="n">SuppHeatingCoilElec</span><span class="p">)</span>
<a name="ln-4076"></a>       <span class="k">CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4077"></a>                                          <span class="n">HeatingLoad</span><span class="p">,</span> <span class="n">HeatCoilNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4078"></a>                                          <span class="n">QCoilActual</span><span class="p">,</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span> <span class="n">FanMode</span><span class="p">)</span>
<a name="ln-4079"></a>     <span class="k">Case</span> <span class="p">(</span><span class="n">Coil_HeatingWater</span><span class="p">)</span>
<a name="ln-4080"></a>       <span class="n">mdot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4081"></a>       <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span> <span class="n">mdot</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4082"></a>                                  <span class="n">CoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4083"></a>                                  <span class="n">CoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4084"></a>                                  <span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4085"></a>                                  <span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4086"></a>                                  <span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4087"></a>                                  <span class="n">CompNum</span><span class="p">)</span>
<a name="ln-4088"></a>       <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">HeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4089"></a>                                         <span class="n">HeatCoilNum</span><span class="p">,</span> <span class="n">QCoilActual</span><span class="p">,</span> <span class="n">FanMode</span><span class="p">)</span>
<a name="ln-4090"></a>     <span class="k">Case</span> <span class="p">(</span><span class="n">Coil_HeatingSteam</span><span class="p">)</span>
<a name="ln-4091"></a>       <span class="n">mdot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4092"></a>       <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span> <span class="n">mdot</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4093"></a>                                  <span class="n">CoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4094"></a>                                  <span class="n">CoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4095"></a>                                  <span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4096"></a>                                  <span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4097"></a>                                  <span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4098"></a>                                  <span class="n">CompNum</span><span class="p">)</span>
<a name="ln-4099"></a>       <span class="c">! simulate the steam supplemental heating coil</span>
<a name="ln-4100"></a>       <span class="k">CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">HeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4101"></a>                                        <span class="n">FirstHVACIteration</span><span class="p">,</span>  <span class="n">HeatingLoad</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-4102"></a>                                        <span class="n">HeatCoilNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-4103"></a>                                        <span class="n">QCoilActual</span><span class="p">,</span> <span class="n">FanMode</span><span class="p">)</span>
<a name="ln-4104"></a>    <span class="k">END Select</span>
<a name="ln-4105"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-4106"></a>  <span class="n">HeatCoilLoadmet</span> <span class="o">=</span> <span class="n">QCoilActual</span>
<a name="ln-4107"></a>
<a name="ln-4108"></a> <span class="k">RETURN</span>
<a name="ln-4109"></a><span class="k">END SUBROUTINE </span><span class="n">CalcNonDXHeatingCoils</span>
<a name="ln-4110"></a>
<a name="ln-4111"></a><span class="k">FUNCTION </span><span class="n">HotWaterCoilResidual</span><span class="p">(</span><span class="n">HWFlow</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-4112"></a>
<a name="ln-4113"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-4114"></a>          <span class="c">!       AUTHOR         Bereket Nigusse, FSEC/UCF</span>
<a name="ln-4115"></a>          <span class="c">!       DATE WRITTEN   November 2011</span>
<a name="ln-4116"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-4117"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-4118"></a>
<a name="ln-4119"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-4120"></a>          <span class="c">! Calculates residual function (QCoilActual - SupHeatCoilLoad) / SupHeatCoilLoad</span>
<a name="ln-4121"></a>          <span class="c">! coil actual output depends on the hot water flow rate which is varied to minimize the</span>
<a name="ln-4122"></a>          <span class="c">! residual.</span>
<a name="ln-4123"></a>
<a name="ln-4124"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4125"></a>          <span class="c">! Calls HotWaterCoilResidual, and calculates the residual as defined above.</span>
<a name="ln-4126"></a>          <span class="c">!</span>
<a name="ln-4127"></a>
<a name="ln-4128"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4129"></a>
<a name="ln-4130"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4131"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-4132"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-4133"></a>
<a name="ln-4134"></a>
<a name="ln-4135"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4136"></a>
<a name="ln-4137"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4138"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">HWFlow</span>   <span class="c">! hot water flow rate in kg/s</span>
<a name="ln-4139"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span>      <span class="c">! Par(5) is the requested coil load</span>
<a name="ln-4140"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                                     <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-4141"></a>
<a name="ln-4142"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-4143"></a>          <span class="c">! na</span>
<a name="ln-4144"></a>
<a name="ln-4145"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-4146"></a>          <span class="c">! na</span>
<a name="ln-4147"></a>
<a name="ln-4148"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-4149"></a>          <span class="c">! na</span>
<a name="ln-4150"></a>
<a name="ln-4151"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4152"></a>  <span class="kt">INTEGER</span>               <span class="kd">::</span> <span class="n">MSHeatPumpNum</span>
<a name="ln-4153"></a>  <span class="kt">LOGICAL</span>               <span class="kd">::</span> <span class="n">FirstHVACSoln</span>
<a name="ln-4154"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">QCoilActual</span>             <span class="c">! delivered coild load, W</span>
<a name="ln-4155"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">HeatCoilLoad</span>         <span class="c">! requested coild load, W</span>
<a name="ln-4156"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">mdot</span>
<a name="ln-4157"></a>
<a name="ln-4158"></a>  <span class="n">MSHeatPumpNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4159"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4160"></a><span class="k">    </span><span class="n">FirstHVACSoln</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4161"></a>  <span class="k">ELSE</span>
<a name="ln-4162"></a><span class="k">    </span><span class="n">FirstHVACSoln</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4163"></a>  <span class="k">END IF</span>
<a name="ln-4164"></a><span class="k">  </span><span class="n">HeatCoilLoad</span> <span class="o">=</span>  <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4165"></a>  <span class="n">QCoilActual</span> <span class="o">=</span> <span class="n">HeatCoilLoad</span>
<a name="ln-4166"></a>  <span class="n">mdot</span> <span class="o">=</span> <span class="n">HWFlow</span>
<a name="ln-4167"></a>  <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span> <span class="n">mdot</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4168"></a>                             <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterCoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4169"></a>                             <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterCoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4170"></a>                             <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4171"></a>                             <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4172"></a>                             <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4173"></a>                             <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterCompNum</span><span class="p">)</span>
<a name="ln-4174"></a>  <span class="c">! simulate the hot water supplemental heating coil</span>
<a name="ln-4175"></a>  <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterCoilName</span><span class="p">,</span><span class="n">FirstHVACSoln</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4176"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">HotWaterCoilNum</span><span class="p">,</span> <span class="n">QCoilActual</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4177"></a>                                   <span class="n">MSHeatPump</span><span class="p">(</span><span class="n">MSHeatPumpNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">)</span>
<a name="ln-4178"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">HeatCoilLoad</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4179"></a><span class="k">    </span><span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">QCoilActual</span> <span class="o">-</span> <span class="n">HeatCoilLoad</span><span class="p">)</span><span class="o">/</span> <span class="n">HeatCoilLoad</span>
<a name="ln-4180"></a>  <span class="k">ELSE</span> <span class="c">!Objexx:Return Condition added to assure return value is set</span>
<a name="ln-4181"></a>    <span class="n">Residuum</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4182"></a>  <span class="n">ENDIF</span>
<a name="ln-4183"></a>  <span class="k">RETURN</span>
<a name="ln-4184"></a><span class="k">END FUNCTION </span><span class="n">HotWaterCoilResidual</span>
<a name="ln-4185"></a>
<a name="ln-4186"></a><span class="c">!     NOTICE</span>
<a name="ln-4187"></a><span class="c">!</span>
<a name="ln-4188"></a><span class="c">!     Copyright © 1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-4189"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-4190"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-4191"></a><span class="c">!</span>
<a name="ln-4192"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-4193"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-4194"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-4195"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-4196"></a><span class="c">!</span>
<a name="ln-4197"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-4198"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-4199"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-4200"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-4201"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-4202"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-4203"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-4204"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-4205"></a><span class="c">!     permit others to do so.</span>
<a name="ln-4206"></a><span class="c">!</span>
<a name="ln-4207"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-4208"></a><span class="c">!</span>
<a name="ln-4209"></a>
<a name="ln-4210"></a><span class="k">END MODULE </span><span class="n">HVACMultiSpeedHeatPump</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
